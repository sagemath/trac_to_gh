# Issue 5945: fastify factorization of inferior integers with flint

archive/issues_005945.json:
```json
{
    "body": "FLINT can factor faster than PARI for integers smaller than 2<sup>50</sup> or so.  So by default, we should use FLINT for this.\n\n**CC:**  @zimmermann6\n\n**Author:** Tom Boothby, Sebastian Pancratz\n\n**Reviewer:** Andr\u00e9 Apitzsch, Jeroen Demeyer\n\n**Merged:** sage-4.6.2.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/5945\n\n",
    "closed_at": "2011-01-19T22:19:17Z",
    "created_at": "2009-04-30T06:15:16Z",
    "labels": [
        "component: factorization",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "fastify factorization of inferior integers with flint",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5945",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```
FLINT can factor faster than PARI for integers smaller than 2<sup>50</sup> or so.  So by default, we should use FLINT for this.

**CC:**  @zimmermann6

**Author:** Tom Boothby, Sebastian Pancratz

**Reviewer:** André Apitzsch, Jeroen Demeyer

**Merged:** sage-4.6.2.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/5945





---

archive/issue_comments_050733.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-FLINT can factor faster than PARI for integers smaller than 2^50 or so.  So by default, we should use FLINT for this.\n+FLINT can factor faster than PARI for integers smaller than 2<sup>50</sup> or so.  So by default, we should use FLINT for this.\n``````\n",
    "created_at": "2009-04-30T06:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50733",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-FLINT can factor faster than PARI for integers smaller than 2^50 or so.  So by default, we should use FLINT for this.
+FLINT can factor faster than PARI for integers smaller than 2<sup>50</sup> or so.  So by default, we should use FLINT for this.
``````




---

archive/issue_comments_050734.json:
```json
{
    "body": "<a id='comment:2'></a>\nNote, we'll need an upgraded FLINT for this to work.  Among other things, FLINT exports a global variable named \"primes\".  And so does PARI.  And they don't play well with eachother.\n\nAlso, the attached code contains a bug.  And Factorization objects can be made with less overhead.",
    "created_at": "2009-04-30T06:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50734",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:2'></a>
Note, we'll need an upgraded FLINT for this to work.  Among other things, FLINT exports a global variable named "primes".  And so does PARI.  And they don't play well with eachother.

Also, the attached code contains a bug.  And Factorization objects can be made with less overhead.



---

archive/issue_events_018136.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "rename": {
        "from": "fastify factorization of inferior integers with flint",
        "to": "fastify factorization of inferior integers with flint [in progress, do not review]"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5945#event-18136"
}
```



---

archive/issue_comments_050735.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe attached fixes aforementioned bug.  New spkg coming soon.",
    "created_at": "2009-04-30T07:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50735",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:3'></a>
The attached fixes aforementioned bug.  New spkg coming soon.



---

archive/issue_events_018137.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-30T07:08:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "milestone": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5945#event-18137"
}
```



---

archive/issue_comments_050736.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [boothby](#comment%3A3):\n> The attached fixes aforementioned bug.  New spkg coming soon.\n\n\nWhat is the plan here? Right now from my end I want to get the latest released upstream into 3.4.2, so it would be nice if you got your code into FLINT and then get Bill to release it. That way the Debian people won't complain ;)\n\nCheers,\n\nMichael",
    "created_at": "2009-04-30T07:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50736",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
Replying to [boothby](#comment%3A3):
> The attached fixes aforementioned bug.  New spkg coming soon.


What is the plan here? Right now from my end I want to get the latest released upstream into 3.4.2, so it would be nice if you got your code into FLINT and then get Bill to release it. That way the Debian people won't complain ;)

Cheers,

Michael



---

archive/issue_comments_050737.json:
```json
{
    "body": "**Changing status** from new to needs_work.",
    "created_at": "2009-10-06T19:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50737",
    "user": "https://github.com/jasongrout"
}
```

**Changing status** from new to needs_work.



---

archive/issue_comments_050738.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2010-11-04T10:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50738",
    "user": "https://github.com/a-andre"
}
```

**Upstream:** N/A



---

archive/issue_comments_050739.json:
```json
{
    "body": "<a id='comment:6'></a>\nI created a new ticket #10211 for changes in long_extras.pxd, to get this fixed faster.",
    "created_at": "2010-11-04T10:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50739",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:6'></a>
I created a new ticket #10211 for changes in long_extras.pxd, to get this fixed faster.



---

archive/issue_comments_050740.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-11-08T09:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50740",
    "user": "https://github.com/a-andre"
}
```

**Changing status** from needs_work to needs_review.



---

archive/attachments_006882.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5945_check_improvements.sage",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/5945_check_improvements.sage",
    "created_at": "2010-11-08T09:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.sage",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050741.json:
```json
{
    "body": "<a id='comment:7'></a>\nI decided to move `flint_factor` to `fast_arith.pyx`, so it can be used for `int`, too.\nTo check the improvements use attachment:5945_check_improvements.patch, attachment:5945_check_improvements.sage and\n\n```\n(line(values_p)+line(values_f,color='red')).plot()\n(line(values_med_p)+line(values_med_f,color='red')).plot()\n```",
    "created_at": "2010-11-08T09:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50741",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:7'></a>
I decided to move `flint_factor` to `fast_arith.pyx`, so it can be used for `int`, too.
To check the improvements use attachment:5945_check_improvements.patch, attachment:5945_check_improvements.sage and

```
(line(values_p)+line(values_f,color='red')).plot()
(line(values_med_p)+line(values_med_f,color='red')).plot()
```



---

archive/issue_comments_050742.json:
```json
{
    "body": "**Author:** Andr\u00e9 Apitzsch",
    "created_at": "2010-11-08T09:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50742",
    "user": "https://github.com/a-andre"
}
```

**Author:** André Apitzsch



---

archive/issue_events_018138.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "rename": {
        "from": "fastify factorization of inferior integers with flint [in progress, do not review]",
        "to": "fastify factorization of inferior integers with flint"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5945#event-18138"
}
```



---

archive/attachments_006883.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945_flintfactor.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945_flintfactor.patch",
    "created_at": "2010-11-10T10:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050743.json:
```json
{
    "body": "apply only this patch; apply after #10211",
    "created_at": "2010-11-10T10:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50743",
    "user": "https://github.com/a-andre"
}
```

apply only this patch; apply after #10211



---

archive/attachments_006884.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5945_check_improvements.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/5945_check_improvements.patch",
    "created_at": "2010-11-10T10:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050744.json:
```json
{
    "body": "only to check improvements, not for release",
    "created_at": "2010-11-10T10:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50744",
    "user": "https://github.com/a-andre"
}
```

only to check improvements, not for release



---

archive/issue_comments_050745.json:
```json
{
    "body": "<a id='comment:10'></a>\npatch updated to fix problem buildbot has\n\n```\n2010-12-03 10:18:03 -0800\nhg qpush trac_5945_factor_flint.patch\napplying trac_5945_factor_flint.patch\npatching file sage/rings/arith.py\nHunk #2 FAILED at 2076\n1 out of 2 hunks FAILED -- saving rejects to file sage/rings/arith.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_5945_factor_flint.patch\npatch queue now empty\nNone\n2010-12-03 10:18:04 -0800\n0 seconds\n```",
    "created_at": "2010-12-06T15:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50745",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:10'></a>
patch updated to fix problem buildbot has

```
2010-12-03 10:18:03 -0800
hg qpush trac_5945_factor_flint.patch
applying trac_5945_factor_flint.patch
patching file sage/rings/arith.py
Hunk #2 FAILED at 2076
1 out of 2 hunks FAILED -- saving rejects to file sage/rings/arith.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_5945_factor_flint.patch
patch queue now empty
None
2010-12-03 10:18:04 -0800
0 seconds
```



---

archive/issue_comments_050746.json:
```json
{
    "body": "only apply this patch",
    "created_at": "2010-12-08T09:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50746",
    "user": "https://github.com/a-andre"
}
```

only apply this patch



---

archive/issue_comments_050747.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-01-08T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50747",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

**Changing status** from needs_review to needs_work.



---

archive/attachments_006885.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945_factor_flint.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945_factor_flint.patch",
    "created_at": "2011-01-08T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```



---

archive/issue_comments_050748.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks for doing this!\n\nLooking at the source code, the line ``flint_bits = int(FLINT_BITS)`` seems wrong.  You can (and should, I think) simply use FLINT_BITS directly.  Of course, this comment is rather minor.\n\nSebastian",
    "created_at": "2011-01-08T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50748",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:11'></a>
Thanks for doing this!

Looking at the source code, the line ``flint_bits = int(FLINT_BITS)`` seems wrong.  You can (and should, I think) simply use FLINT_BITS directly.  Of course, this comment is rather minor.

Sebastian



---

archive/issue_comments_050749.json:
```json
{
    "body": "**Changing author** from \"Andr\u00e9 Apitzsch\" to \"boothby, spancratz\".",
    "created_at": "2011-01-10T06:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50749",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

**Changing author** from "André Apitzsch" to "boothby, spancratz".



---

archive/issue_comments_050750.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-01-10T06:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50750",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_050751.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-01-10T07:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50751",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_050752.json:
```json
{
    "body": "<a id='comment:13'></a>\nsegfault in arith.py",
    "created_at": "2011-01-10T07:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50752",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:13'></a>
segfault in arith.py



---

archive/issue_comments_050753.json:
```json
{
    "body": "<a id='comment:14'></a>\nI tried to apply your patch to 4.6.1 rc1\n\n```\napplying /scratch/sage-4.6.1rc1/trac_5945bp.patch\npatching file sage/rings/arith.py\nHunk #2 FAILED at 2290\n1 out of 2 hunks FAILED -- saving rejects to file sage/rings/arith.py.rej\npatching file sage/rings/integer.pyx\nHunk #1 FAILED at 3139\n1 out of 1 hunks FAILED -- saving rejects to file sage/rings/integer.pyx.rej\nabort: patch failed to apply\n```",
    "created_at": "2011-01-10T14:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50753",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:14'></a>
I tried to apply your patch to 4.6.1 rc1

```
applying /scratch/sage-4.6.1rc1/trac_5945bp.patch
patching file sage/rings/arith.py
Hunk #2 FAILED at 2290
1 out of 2 hunks FAILED -- saving rejects to file sage/rings/arith.py.rej
patching file sage/rings/integer.pyx
Hunk #1 FAILED at 3139
1 out of 1 hunks FAILED -- saving rejects to file sage/rings/integer.pyx.rej
abort: patch failed to apply
```



---

archive/issue_comments_050754.json:
```json
{
    "body": "<a id='comment:15'></a>\nHi Andre,\n\nYes, that was an unfortunate case of Tom and I uploading the patch last night before combining it with another patch it relied on.  I have now uploaded a file ``trac_5945.patch``, which should combine everything and is to be applied on top of #10211.\n\nSebastian",
    "created_at": "2011-01-10T18:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50754",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:15'></a>
Hi Andre,

Yes, that was an unfortunate case of Tom and I uploading the patch last night before combining it with another patch it relied on.  I have now uploaded a file ``trac_5945.patch``, which should combine everything and is to be applied on top of #10211.

Sebastian



---

archive/issue_comments_050755.json:
```json
{
    "body": "<a id='comment:16'></a>\nJust in case this wasn't obvious, ``trac_5945.patch`` applies to 4.6 and ``trac_5945_461rc0.patch`` applies to 4.6.1.rc0.  Both of these depend on #10211.\n\nSebastian",
    "created_at": "2011-01-10T19:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50755",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:16'></a>
Just in case this wasn't obvious, ``trac_5945.patch`` applies to 4.6 and ``trac_5945_461rc0.patch`` applies to 4.6.1.rc0.  Both of these depend on #10211.

Sebastian



---

archive/issue_comments_050756.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-01-11T00:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50756",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_050757.json:
```json
{
    "body": "<a id='comment:18'></a>\nAfter some cleaning up, there is now a single patch ``trac_5945.patch`` that can be applied against 4.6.1.rc0 with #10211.\n\nMorally speaking, this should be good to go.  However, sage.math.washington is currently under heavy use by Jeroen and I'll wait until tomorrow before running the complete test suite.\n\nBest wishes,\nSebastian",
    "created_at": "2011-01-11T07:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50757",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:18'></a>
After some cleaning up, there is now a single patch ``trac_5945.patch`` that can be applied against 4.6.1.rc0 with #10211.

Morally speaking, this should be good to go.  However, sage.math.washington is currently under heavy use by Jeroen and I'll wait until tomorrow before running the complete test suite.

Best wishes,
Sebastian



---

archive/issue_comments_050758.json:
```json
{
    "body": "<a id='comment:19'></a>\nYou should use the variable `flint_depends` in **module_list.py** and\n\n```\nSAGE_LOCAL+'include/FLINT/'\n```\nor\n\n```\nSAGE_INC+'FLINT/'\n```\ninstead of\n\n```\nSAGE_ROOT+'/local/include/FLINT/'\n```\n\n**arith.py**:\nremove\n\n```\nif proof is None:\n    proof = True\n```\nand let `n.factor` handle `proof=None`.\n\n**integer.pyx**: I suggest using the global default for *proof* in factor()\n\nChange\n\n```\nF = [(Integer(f.p[i]), f.exp[i]) for i from 0 <= i < f.num]\n```\nto\n\n```\nF = [(Integer(f.p[i]), int(f.exp[i])) for i from 0 <= i < f.num]\n```\nthen only following doctests fail (otherwise even more would fail, e.g. arith.py):\n\n```\nsage/misc/sageinspect.py\nsage/structure/factorization.py\n```",
    "created_at": "2011-01-11T12:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50758",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:19'></a>
You should use the variable `flint_depends` in **module_list.py** and

```
SAGE_LOCAL+'include/FLINT/'
```
or

```
SAGE_INC+'FLINT/'
```
instead of

```
SAGE_ROOT+'/local/include/FLINT/'
```

**arith.py**:
remove

```
if proof is None:
    proof = True
```
and let `n.factor` handle `proof=None`.

**integer.pyx**: I suggest using the global default for *proof* in factor()

Change

```
F = [(Integer(f.p[i]), f.exp[i]) for i from 0 <= i < f.num]
```
to

```
F = [(Integer(f.p[i]), int(f.exp[i])) for i from 0 <= i < f.num]
```
then only following doctests fail (otherwise even more would fail, e.g. arith.py):

```
sage/misc/sageinspect.py
sage/structure/factorization.py
```



---

archive/issue_comments_050759.json:
```json
{
    "body": "<a id='comment:20'></a>\nHi Andre,\n\nThank you for the quick comments.  All of these are very sensible!  The only one I am not quite sure about is the last, where I thought the underlying FLINT structure already had f.exp[i] of the right type to that calling int(-) on it would not be necessary, but I might be wrong.\n\n(I'm not quite sure which time zone you are working in right now, so this comment might be more for Tom.)  I'm off to the gym now, but I'll have fixed this in time for lunch,\n\nSebastian",
    "created_at": "2011-01-11T16:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50759",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:20'></a>
Hi Andre,

Thank you for the quick comments.  All of these are very sensible!  The only one I am not quite sure about is the last, where I thought the underlying FLINT structure already had f.exp[i] of the right type to that calling int(-) on it would not be necessary, but I might be wrong.

(I'm not quite sure which time zone you are working in right now, so this comment might be more for Tom.)  I'm off to the gym now, but I'll have fixed this in time for lunch,

Sebastian



---

archive/attachments_006886.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945.2.patch",
    "created_at": "2011-01-12T04:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```



---

archive/issue_comments_050760.json:
```json
{
    "body": "<a id='comment:21'></a>\nI'm sorry for adding the duplicate file ``trac_5945.2.patch``, this can be deleted from here.  The other file ``trac_5945.patch`` should now apply cleanly to 4.6.1.rc0 and pass all tests.\n\nSebastian",
    "created_at": "2011-01-12T04:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50760",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:21'></a>
I'm sorry for adding the duplicate file ``trac_5945.2.patch``, this can be deleted from here.  The other file ``trac_5945.patch`` should now apply cleanly to 4.6.1.rc0 and pass all tests.

Sebastian



---

archive/issue_comments_050761.json:
```json
{
    "body": "<a id='comment:22'></a>\ntrac_5945.patch seems to be incomplete, e.g. `class IntegerFactorization(Factorization)` and comment changes are missing, thus I couldn't finish review.\n\nAnyway.\n\n*arith.py*:\nMaybe you should also pass `**kwds` to n.factor() if n is Integer, int or long, so `limit` can be used: `factor(8*49,limit=5)`",
    "created_at": "2011-01-12T13:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50761",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:22'></a>
trac_5945.patch seems to be incomplete, e.g. `class IntegerFactorization(Factorization)` and comment changes are missing, thus I couldn't finish review.

Anyway.

*arith.py*:
Maybe you should also pass `**kwds` to n.factor() if n is Integer, int or long, so `limit` can be used: `factor(8*49,limit=5)`



---

archive/issue_comments_050762.json:
```json
{
    "body": "<a id='comment:23'></a>\nCan you also fix #10602 for Integer.factor(). I only mention this because it's fixed in none of the last two patches.",
    "created_at": "2011-01-12T17:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50762",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:23'></a>
Can you also fix #10602 for Integer.factor(). I only mention this because it's fixed in none of the last two patches.



---

archive/attachments_006887.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945.patch",
    "created_at": "2011-01-12T19:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```



---

archive/issue_comments_050763.json:
```json
{
    "body": "Version for 4.6.0",
    "created_at": "2011-01-12T19:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50763",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

Version for 4.6.0



---

archive/attachments_006888.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945-461rc0.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945-461rc0.patch",
    "created_at": "2011-01-12T19:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```



---

archive/issue_comments_050764.json:
```json
{
    "body": "Version for 4.6.1.rc0",
    "created_at": "2011-01-12T19:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50764",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

Version for 4.6.1.rc0



---

archive/issue_comments_050765.json:
```json
{
    "body": "Fix for a remaining doctest failure in sageinspect.py",
    "created_at": "2011-01-12T20:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50765",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

Fix for a remaining doctest failure in sageinspect.py



---

archive/attachments_006889.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945_fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945_fix.patch",
    "created_at": "2011-01-12T20:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```



---

archive/issue_comments_050766.json:
```json
{
    "body": "<a id='comment:24'></a>\nHi Andre,\n\nI'm sorry for the earlier patch not including the IntegerFactorization class, I don't know how that happened.  Now, there are three things to do:\n\n- Apply #10211\n- Apply either trac_5945.patch or trac_5945-461rc0.patch, depending on the Sage version\n- Apply trac_5945_fix.patch\n\nTom, could you perhaps clean up this ticket and remove all other files that I or we added?\n\nSebastian",
    "created_at": "2011-01-12T20:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50766",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:24'></a>
Hi Andre,

I'm sorry for the earlier patch not including the IntegerFactorization class, I don't know how that happened.  Now, there are three things to do:

- Apply #10211
- Apply either trac_5945.patch or trac_5945-461rc0.patch, depending on the Sage version
- Apply trac_5945_fix.patch

Tom, could you perhaps clean up this ticket and remove all other files that I or we added?

Sebastian



---

archive/issue_comments_050767.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-01-13T11:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50767",
    "user": "https://github.com/a-andre"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_050768.json:
```json
{
    "body": "**Reviewer:** Andr\u00e9 Apitzsch",
    "created_at": "2011-01-13T11:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50768",
    "user": "https://github.com/a-andre"
}
```

**Reviewer:** André Apitzsch



---

archive/attachments_006890.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945_reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945_reviewer.patch",
    "created_at": "2011-01-13T11:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050769.json:
```json
{
    "body": "<a id='comment:25'></a>\nApply trac_5945_reviewer.patch after trac_5945_fix.patch\n\nVersion rc0 reviewed.\n\nAttached trac_5945_reviewer.patch handles doctest failure in *factorization.py*. I only changed the expected result but actually it should be a new test with old result.\n\n*sage/libs/flint/long_extras.pxd* contained `ctypedef struct factor_t:`... twice so I removed one.\n\nEverything else is okay.",
    "created_at": "2011-01-13T11:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50769",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:25'></a>
Apply trac_5945_reviewer.patch after trac_5945_fix.patch

Version rc0 reviewed.

Attached trac_5945_reviewer.patch handles doctest failure in *factorization.py*. I only changed the expected result but actually it should be a new test with old result.

*sage/libs/flint/long_extras.pxd* contained `ctypedef struct factor_t:`... twice so I removed one.

Everything else is okay.



---

archive/issue_comments_050770.json:
```json
{
    "body": "<a id='comment:26'></a>\nHi Andre,\n\nGreat, thank you for doing this!\n\nSebastian",
    "created_at": "2011-01-13T18:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50770",
    "user": "https://trac.sagemath.org/admin/accounts/users/spancratz"
}
```

<a id='comment:26'></a>
Hi Andre,

Great, thank you for doing this!

Sebastian



---

archive/attachments_006891.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945-462a0.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945-462a0.patch",
    "created_at": "2011-01-17T13:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050771.json:
```json
{
    "body": "",
    "created_at": "2011-01-17T13:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50771",
    "user": "https://github.com/a-andre"
}
```





---

archive/issue_comments_050772.json:
```json
{
    "body": "<a id='comment:27'></a>\nMerged patches into trac_5945-462a0.patch. So you only need to apply this one. Based on 4.6.2.alpha0.",
    "created_at": "2011-01-17T13:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50772",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:27'></a>
Merged patches into trac_5945-462a0.patch. So you only need to apply this one. Based on 4.6.2.alpha0.



---

archive/issue_comments_050773.json:
```json
{
    "body": "**Changing reviewer** from \"Andr\u00e9 Apitzsch\" to \"Andr\u00e9 Apitzsch, Jeroen Demeyer\".",
    "created_at": "2011-01-17T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50773",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "André Apitzsch" to "André Apitzsch, Jeroen Demeyer".



---

archive/issue_comments_050774.json:
```json
{
    "body": "<a id='comment:28'></a>\nThere are a few doctest failures:\n\n```\nThe following tests failed:\n\n        sage -t  -force_lib devel/sagenb-main/sagenb/misc/sageinspect.py # 1 doctests failed\n        sage -t  -force_lib devel/sage/doc/en/tutorial/programming.rst # 1 doctests failed\n        sage -t  -force_lib devel/sage/doc/fr/tutorial/programming.rst # 1 doctests failed\n```",
    "created_at": "2011-01-17T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50774",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
There are a few doctest failures:

```
The following tests failed:

        sage -t  -force_lib devel/sagenb-main/sagenb/misc/sageinspect.py # 1 doctests failed
        sage -t  -force_lib devel/sage/doc/en/tutorial/programming.rst # 1 doctests failed
        sage -t  -force_lib devel/sage/doc/fr/tutorial/programming.rst # 1 doctests failed
```



---

archive/issue_comments_050775.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2011-01-17T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50775",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_050776.json:
```json
{
    "body": "**Changing author** from \"boothby, spancratz\" to \"Tom Boothby, Sebastian Pancratz\".",
    "created_at": "2011-01-17T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50776",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "boothby, spancratz" to "Tom Boothby, Sebastian Pancratz".



---

archive/attachments_006892.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5945_doc_fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5945/trac_5945_doc_fix.patch",
    "created_at": "2011-01-18T09:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/a-andre"
}
```



---

archive/issue_comments_050777.json:
```json
{
    "body": "",
    "created_at": "2011-01-18T09:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50777",
    "user": "https://github.com/a-andre"
}
```





---

archive/issue_comments_050778.json:
```json
{
    "body": "<a id='comment:29'></a>\nApply trac_5945_sagenb.patch and trac_5945_doc_fix.patch after trac_5945-462a0.patch",
    "created_at": "2011-01-18T09:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50778",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:29'></a>
Apply trac_5945_sagenb.patch and trac_5945_doc_fix.patch after trac_5945-462a0.patch



---

archive/issue_comments_050779.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-01-18T09:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50779",
    "user": "https://github.com/a-andre"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_050780.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-01-19T01:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50780",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_050781.json:
```json
{
    "body": "<a id='comment:30'></a>\nDoctests are fixed.",
    "created_at": "2011-01-19T01:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50781",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Doctests are fixed.



---

archive/issue_events_018139.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:19:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5945#event-18139"
}
```



---

archive/issue_comments_050782.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha1",
    "created_at": "2011-01-19T22:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5945#issuecomment-50782",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha1
