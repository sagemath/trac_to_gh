# Issue 5110: rewrite diagonal_matrix to be more general

archive/issues_005110.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "See the patches at #3704, which rewrite diagonal_matrix.  On that ticket, however, we finally just went with a basic patch that fixed the specific bug mentioned.  There is good code in the other patches that ought to be used, though.  This ticket is here so that we eventually use the cleaner rewrite contained in the first patches at #3704.\n\nReviewer: **Samuel Leli\u00e8vre, Travis Scrimshaw**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5110_\n\n",
    "closed_at": "2019-12-27T22:09:24Z",
    "created_at": "2009-01-27T03:54:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/duplicate",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "rewrite diagonal_matrix to be more general",
    "type": "issue",
    "updated_at": "2019-12-27T22:09:24Z",
    "url": "https://github.com/sagemath/sage/issues/5110",
    "user": "https://github.com/jasongrout"
}
```
See the patches at #3704, which rewrite diagonal_matrix.  On that ticket, however, we finally just went with a basic patch that fixed the specific bug mentioned.  There is good code in the other patches that ought to be used, though.  This ticket is here so that we eventually use the cleaner rewrite contained in the first patches at #3704.

Reviewer: **Samuel Lelièvre, Travis Scrimshaw**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/5110_





---

archive/issue_events_059014.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-01-27T03:54:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59014"
}
```



---

archive/issue_events_059015.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-01-27T03:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59015"
}
```



---

archive/issue_events_059016.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-01-27T03:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59016"
}
```



---

archive/issue_events_059017.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-01-27T03:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59017"
}
```



---

archive/issue_events_059018.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-01-27T03:54:59Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "subject": "https://github.com/jasongrout",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59018"
}
```



---

archive/issue_events_059019.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59019"
}
```



---

archive/issue_events_059020.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59020"
}
```



---

archive/issue_events_059021.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59021"
}
```



---

archive/issue_events_059022.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59022"
}
```



---

archive/issue_events_059023.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59023"
}
```



---

archive/issue_events_059024.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59024"
}
```



---

archive/issue_events_059025.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59025"
}
```



---

archive/issue_events_059026.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59026"
}
```



---

archive/issue_comments_031145.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWhat exactly should be added to diagonal_matrix? I'd be happy to work on this ticket but it looks like the other patches in #3704 add doctests.",
    "created_at": "2018-05-26T14:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31145",
    "user": "https://github.com/black-stones"
}
```

<div id="comment:5" align="right">comment:5</div>

What exactly should be added to diagonal_matrix? I'd be happy to work on this ticket but it looks like the other patches in #3704 add doctests.



---

archive/issue_comments_031146.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI think the idea is to use [attachment: trac-3704-diagonal_matrix.patch:ticket:3704](https://github.com/sagemath/sage/files/ticket5110/916f8f49a8bd5e59bd1c58bdfab0c32e.gz) to make a more generally applicable function.\n\nThat said, there are probably more important tickets to work on, notably reviewing many in symbolics ...",
    "created_at": "2018-05-30T17:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31146",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

I think the idea is to use [attachment: trac-3704-diagonal_matrix.patch:ticket:3704](https://github.com/sagemath/sage/files/ticket5110/916f8f49a8bd5e59bd1c58bdfab0c32e.gz) to make a more generally applicable function.

That said, there are probably more important tickets to work on, notably reviewing many in symbolics ...



---

archive/issue_comments_031147.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI did see that patch, but looking at the source code for diagonal_matrix(), the differences seem to be\n\n1. Changing the parameters\n2. More comments and doctests\n3. Casting to Sequence\n\n1 could be a good fix since the current function uses \"arg0, arg1, arg2\" which is pretty bad, but in my opinion, 2 and 3 are not necessary (although if we do change 1 we will need to change 2).",
    "created_at": "2018-05-30T21:09:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31147",
    "user": "https://github.com/black-stones"
}
```

<div id="comment:7" align="right">comment:7</div>

I did see that patch, but looking at the source code for diagonal_matrix(), the differences seem to be

1. Changing the parameters
2. More comments and doctests
3. Casting to Sequence

1 could be a good fix since the current function uses "arg0, arg1, arg2" which is pretty bad, but in my opinion, 2 and 3 are not necessary (although if we do change 1 we will need to change 2).



---

archive/issue_events_059027.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-14T00:07:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59027"
}
```



---

archive/issue_comments_031148.json:
```json
{
    "body": "Reviewer: **Samuel Leli\u00e8vre**",
    "created_at": "2019-12-14T00:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31148",
    "user": "https://github.com/slel"
}
```

Reviewer: **Samuel Lelièvre**



---

archive/issue_events_059028.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-14T00:07:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59028"
}
```



---

archive/issue_comments_031149.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThis is probably solved by #10604 (please check).",
    "created_at": "2019-12-14T00:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31149",
    "user": "https://github.com/slel"
}
```

<div id="comment:8" align="right">comment:8</div>

This is probably solved by #10604 (please check).



---

archive/issue_events_059029.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-12-27T17:13:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59029"
}
```



---

archive/issue_events_059030.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-12-27T17:13:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59030"
}
```



---

archive/issue_comments_031150.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI think so as well.",
    "created_at": "2019-12-27T17:13:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31150",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

I think so as well.



---

archive/issue_comments_031151.json:
```json
{
    "body": "Changed reviewer from **Samuel Leli\u00e8vre** to **Samuel Leli\u00e8vre, Travis Scrimshaw**",
    "created_at": "2019-12-27T22:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5110#issuecomment-31151",
    "user": "https://github.com/slel"
}
```

Changed reviewer from **Samuel Lelièvre** to **Samuel Lelièvre, Travis Scrimshaw**



---

archive/issue_events_059031.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-27T22:09:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59031"
}
```



---

archive/issue_events_059032.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-27T22:09:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "c6c6c6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59032"
}
```



---

archive/issue_events_059033.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-27T22:09:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59033"
}
```



---

archive/issue_events_059034.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-12-27T22:09:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5110",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5110#event-59034"
}
```
