# Issue 5367: bug in composition of power series

archive/issues_005367.json:
```json
{
    "body": "The following returns an incorrect answer:\n\n```\nsage: S.<z> = QQ[[]]\nsage: p = 1 + O(z)\nsage: q = 1 + z\nsage: p(q)          # should return O(z^0)\n1\n```\n\nThis was reported via \"report a problem\" from the notebook.\n\n\nAssignee: tbd\n\nKeywords: power series composition\n\nResolution: duplicate\n\nReviewer: David Loeffler\n\nIssue created by migration from https://trac.sagemath.org/ticket/5367\n\n",
    "closed_at": "2011-07-19T17:37:31Z",
    "created_at": "2009-02-25T01:26:30Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "bug in composition of power series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5367",
    "user": "https://github.com/aghitza"
}
```
The following returns an incorrect answer:

```
sage: S.<z> = QQ[[]]
sage: p = 1 + O(z)
sage: q = 1 + z
sage: p(q)          # should return O(z^0)
1
```

This was reported via "report a problem" from the notebook.


Assignee: tbd

Keywords: power series composition

Resolution: duplicate

Reviewer: David Loeffler

Issue created by migration from https://trac.sagemath.org/ticket/5367





---

archive/issue_comments_044008.json:
```json
{
    "body": "<a id='comment:1'></a>\nAs pointed out by Ralf Hemmecke on sage-devel, the correct behaviour is not to return 1, but rather to raise an error if q has a constant term.",
    "created_at": "2009-02-25T22:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44008",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:1'></a>
As pointed out by Ralf Hemmecke on sage-devel, the correct behaviour is not to return 1, but rather to raise an error if q has a constant term.



---

archive/issue_comments_044009.json:
```json
{
    "body": "<a id='comment:2'></a>\nI just came across this, which is presumably related:\n\n```\nsage: R.<x> = QQ[[]]\nsage: f = 1 + 24*x^11 + 24*x^22 + O(x^33)\nsage: f(x^2)\n1 + 24*x^22 + 24*x^44 + O(x^86)\n```\n\nThe answer should clearly be 1 + 24*x^22 + 24*x^44 + O(x^66). (This is causing some headaches in trying to sort out degeneracy maps for modular forms.)",
    "created_at": "2009-04-30T11:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44009",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>
I just came across this, which is presumably related:

```
sage: R.<x> = QQ[[]]
sage: f = 1 + 24*x^11 + 24*x^22 + O(x^33)
sage: f(x^2)
1 + 24*x^22 + 24*x^44 + O(x^86)
```

The answer should clearly be 1 + 24*x^22 + 24*x^44 + O(x^66). (This is causing some headaches in trying to sort out degeneracy maps for modular forms.)



---

archive/issue_comments_044010.json:
```json
{
    "body": "<a id='comment:3'></a>\nSee also #3979.",
    "created_at": "2010-01-14T05:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44010",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:3'></a>
See also #3979.



---

archive/issue_comments_044011.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2010-01-14T05:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44011",
    "user": "https://github.com/robertwb"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_044012.json:
```json
{
    "body": "<a id='comment:4'></a>\nSince this is a duplicate of #3979, I think this ticket should be closed.",
    "created_at": "2010-05-19T08:18:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44012",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>
Since this is a duplicate of #3979, I think this ticket should be closed.



---

archive/issue_comments_044013.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [robertwb](#comment%3A3):\n> See also #3979.\n\n\nWhich now has a patch.",
    "created_at": "2011-07-18T12:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44013",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

<a id='comment:5'></a>
Replying to [robertwb](#comment%3A3):
> See also #3979.


Which now has a patch.



---

archive/issue_comments_044014.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-07-18T12:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44014",
    "user": "https://github.com/loefflerd"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_044015.json:
```json
{
    "body": "<a id='comment:6'></a>\nI concur that this should be closed as duplicate. I'll set it to \"positive review\" to bring this to the attention of the release manager.",
    "created_at": "2011-07-18T12:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44015",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:6'></a>
I concur that this should be closed as duplicate. I'll set it to "positive review" to bring this to the attention of the release manager.



---

archive/issue_comments_044016.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-07-18T12:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44016",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_021088.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-19T10:16:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5367#event-21088"
}
```



---

archive/issue_comments_044017.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2011-07-19T17:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44017",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_comments_044018.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Loeffler\"",
    "created_at": "2011-07-19T17:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5367#issuecomment-44018",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "David Loeffler"



---

archive/issue_events_021089.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-19T17:37:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5367",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5367#event-21089"
}
```
