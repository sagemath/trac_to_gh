# Issue 5779: _fast_floats_'s pow returns garbage for non-integral powers left of zero

archive/issues_005779.json:
```json
{
    "body": "I thought we had fixed this via fast_callable, but it is still there:\n\n```\nmabshoff@sage:/scratch/mabshoff/sage-3.4.1.rc3$ ./sage\n----------------------------------------------------------------------\n| Sage Version 3.4.1.rc2, Release Date: 2009-04-10                   |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: f=x^(1/3)\nsage: f._fast_float_(x)(-1.2)\nnan\nsage: \n```\nThis is exposed via a plotting failure on Solaris where NaNs pop up. Fixing that in the plotting code is a different ticket William will open shortly.\n\nCheers,\n\nMichael\n\n**Assignee:** @robertwb\n\n**CC:**  cwitty\n\nIssue created by migration from https://trac.sagemath.org/ticket/5779\n\n",
    "closed_at": "2009-04-16T07:41:28Z",
    "created_at": "2009-04-13T20:04:51Z",
    "labels": [
        "component: porting: solaris",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.4.1",
    "title": "_fast_floats_'s pow returns garbage for non-integral powers left of zero",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/5779",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```
I thought we had fixed this via fast_callable, but it is still there:

```
mabshoff@sage:/scratch/mabshoff/sage-3.4.1.rc3$ ./sage
----------------------------------------------------------------------
| Sage Version 3.4.1.rc2, Release Date: 2009-04-10                   |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: f=x^(1/3)
sage: f._fast_float_(x)(-1.2)
nan
sage: 
```
This is exposed via a plotting failure on Solaris where NaNs pop up. Fixing that in the plotting code is a different ticket William will open shortly.

Cheers,

Michael

**Assignee:** @robertwb

**CC:**  cwitty

Issue created by migration from https://trac.sagemath.org/ticket/5779





---

archive/issue_comments_038047.json:
```json
{
    "body": "**Changing assignee** from mabshoff to @robertwb.",
    "created_at": "2009-04-13T20:05:45Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38047",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing assignee** from mabshoff to @robertwb.



---

archive/issue_comments_038048.json:
```json
{
    "body": "<a id='comment:2'></a>\nHmm, the c library is involved here as shown by this on Solaris:\n\n```\n-bash-3.00$ ./sage\n----------------------------------------------------------------------\n| Sage Version 3.4.1.rc1, Release Date: 2009-04-05                   |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nLoading Sage library. Current Mercurial branch is: main-sol\nsage: f=x^(1/3)\nsage: f._fast_float_(x)(-1.2)\n-NaN\n```\n\nI am not so sure what is going on or if this is the real issue. I will talk to RobertWB in person about this on the next occasion.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-13T20:13:27Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38048",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
Hmm, the c library is involved here as shown by this on Solaris:

```
-bash-3.00$ ./sage
----------------------------------------------------------------------
| Sage Version 3.4.1.rc1, Release Date: 2009-04-05                   |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
Loading Sage library. Current Mercurial branch is: main-sol
sage: f=x^(1/3)
sage: f._fast_float_(x)(-1.2)
-NaN
```

I am not so sure what is going on or if this is the real issue. I will talk to RobertWB in person about this on the next occasion.

Cheers,

Michael



---

archive/issue_comments_038049.json:
```json
{
    "body": "<a id='comment:3'></a>\nHmm, the issue here might be plain and simply calling the math libraries pow() function.  So don't invalidate this ticket since we are definitely hitting some issue on Solaris here.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-13T21:53:48Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38049",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:3'></a>
Hmm, the issue here might be plain and simply calling the math libraries pow() function.  So don't invalidate this ticket since we are definitely hitting some issue on Solaris here.

Cheers,

Michael



---

archive/issue_comments_038050.json:
```json
{
    "body": "<a id='comment:4'></a>\nI fixed the new fast float (fast callable) not the old one. However, the old one is a simple fix too--I'll post a patch shortly.",
    "created_at": "2009-04-13T22:24:19Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38050",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:4'></a>
I fixed the new fast float (fast callable) not the old one. However, the old one is a simple fix too--I'll post a patch shortly.



---

archive/issue_comments_038051.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [robertwb](#comment%3A4):\n> I fixed the new fast float (fast callable) not the old one. However, the old one is a simple fix too--I'll post a patch shortly. \n\n\nCool, note that #5780 does fix an issue when the axes code in plotting encounters a NaN or Infinity, so you might want to apply that one before doctesting.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-13T22:59:18Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38051",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
Replying to [robertwb](#comment%3A4):
> I fixed the new fast float (fast callable) not the old one. However, the old one is a simple fix too--I'll post a patch shortly. 


Cool, note that #5780 does fix an issue when the axes code in plotting encounters a NaN or Infinity, so you might want to apply that one before doctesting.

Cheers,

Michael



---

archive/issue_events_036879.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2009-04-16T05:21:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5779#event-36879"
}
```



---

archive/attachments_006637.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5779-fast-float-pow.patch",
    "asset_url": "tarball://root/attachments/ticket5779/5779-fast-float-pow.patch",
    "created_at": "2009-04-16T05:21:10Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket5779/5779-fast-float-pow.patch",
    "user": "https://github.com/robertwb"
}
```



---

archive/issue_comments_038052.json:
```json
{
    "body": "<a id='comment:6'></a>\nAttachment [5779-fast-float-pow.patch](https://github.com/sagemath/sage/files/ticket5779/5779-fast-float-pow.patch) by @robertwb created at 2009-04-16 05:21:10\n\nOK, I did the same thing as for fast_callable.",
    "created_at": "2009-04-16T05:21:10Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38052",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:6'></a>
Attachment [5779-fast-float-pow.patch](https://github.com/sagemath/sage/files/ticket5779/5779-fast-float-pow.patch) by @robertwb created at 2009-04-16 05:21:10

OK, I did the same thing as for fast_callable.



---

archive/issue_events_036880.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-16T07:40:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5779#event-36880"
}
```



---

archive/issue_events_036881.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-16T07:40:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5779#event-36881"
}
```



---

archive/issue_comments_038053.json:
```json
{
    "body": "<a id='comment:7'></a>\nI am happy with this patch even though it likely introduces a slowdown which I did not measure. Since correctness is more important than speed especially in light of completely wrong results I give this patch a positive review. All doctests do pass, too :)\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T07:40:56Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38053",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
I am happy with this patch even though it likely introduces a slowdown which I did not measure. Since correctness is more important than speed especially in light of completely wrong results I give this patch a positive review. All doctests do pass, too :)

Cheers,

Michael



---

archive/issue_comments_038054.json:
```json
{
    "body": "<a id='comment:8'></a>\nMerged in Sage 3.4.1.rc3.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T07:41:28Z",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5779#issuecomment-38054",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:8'></a>
Merged in Sage 3.4.1.rc3.

Cheers,

Michael



---

archive/issue_events_036882.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-16T07:41:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5779#event-36882"
}
```



---

archive/issue_events_036883.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-16T07:41:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5779",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5779#event-36883"
}
```
