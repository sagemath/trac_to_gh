# Issue 5455: gap-4.4.12 -- workspaces broken on iras (itanium Linux)

archive/issues_005455.json:
```json
{
    "body": "Saving workspaces is broken in GAP SUSE Itanium. \n\n```\nsage: !gap\n    \n            #########           ######         ###########           ###  \n         #############          ######         ############         ####  \n        ##############         ########        #############       #####  \n       ###############         ########        #####   ######      #####  \n      ######         #         #########       #####    #####     ######  \n     ######                   ##########       #####    #####    #######  \n     #####                    ##### ####       #####   ######   ########  \n     ####                    #####  #####      #############   ###  ####  \n     #####     #######       ####    ####      ###########    ####  ####  \n     #####     #######      #####    #####     ######        ####   ####  \n     #####     #######      #####    #####     #####         #############\n      #####      #####     ################    #####         #############\n      ######     #####     ################    #####         #############\n      ################    ##################   #####                ####  \n       ###############    #####        #####   #####                ####  \n         #############    #####        #####   #####                ####  \n          #########      #####          #####  #####                ####  \n                                                                          \n     Information at:  http://www.gap-system.org\n     Try '?help' for help. See also  '?copyright' and  '?authors'\n    \n   Loading the library. Please be patient, this may take a while.\nGAP4, Version: 4.4.12 of 17-Dec-2008, ia64-unknown-linux-gnu-gcc\ngap> SaveWorkspace(\"a\");\ntrue\ngap>\nwstein@iras:/tmp/wstein/sage-3.4.alpha0-ia64-Linux/x> ls\n?\u01ce?\n```\n\nAssignee: mabshoff\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/5455\n\n",
    "closed_at": "2009-03-10T16:23:28Z",
    "created_at": "2009-03-08T05:53:51Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.4",
    "title": "gap-4.4.12 -- workspaces broken on iras (itanium Linux)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5455",
    "user": "https://github.com/williamstein"
}
```
Saving workspaces is broken in GAP SUSE Itanium. 

```
sage: !gap
    
            #########           ######         ###########           ###  
         #############          ######         ############         ####  
        ##############         ########        #############       #####  
       ###############         ########        #####   ######      #####  
      ######         #         #########       #####    #####     ######  
     ######                   ##########       #####    #####    #######  
     #####                    ##### ####       #####   ######   ########  
     ####                    #####  #####      #############   ###  ####  
     #####     #######       ####    ####      ###########    ####  ####  
     #####     #######      #####    #####     ######        ####   ####  
     #####     #######      #####    #####     #####         #############
      #####      #####     ################    #####         #############
      ######     #####     ################    #####         #############
      ################    ##################   #####                ####  
       ###############    #####        #####   #####                ####  
         #############    #####        #####   #####                ####  
          #########      #####          #####  #####                ####  
                                                                          
     Information at:  http://www.gap-system.org
     Try '?help' for help. See also  '?copyright' and  '?authors'
    
   Loading the library. Please be patient, this may take a while.
GAP4, Version: 4.4.12 of 17-Dec-2008, ia64-unknown-linux-gnu-gcc
gap> SaveWorkspace("a");
true
gap>
wstein@iras:/tmp/wstein/sage-3.4.alpha0-ia64-Linux/x> ls
?ǎ?
```

Assignee: mabshoff

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/5455





---

archive/issue_comments_050523.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Saving and loading workspaces is broke in gap Itanium (SUSE). Also, loading of any packages is now mysteriously broken:\n+Saving workspaces is broken in GAP SUSE Itanium. \n \n ```\n sage: !gap\n@@ -26,6 +26,9 @@\n     \n    Loading the library. Please be patient, this may take a while.\n GAP4, Version: 4.4.12 of 17-Dec-2008, ia64-unknown-linux-gnu-gcc\n-gap> LoadPackage(\"braid\");\n-fail\n+gap> SaveWorkspace(\"a\");\n+true\n+gap>\n+wstein@iras:/tmp/wstein/sage-3.4.alpha0-ia64-Linux/x> ls\n+?\u01ce?\n ```\n``````\n",
    "created_at": "2009-03-08T06:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50523",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Saving and loading workspaces is broke in gap Itanium (SUSE). Also, loading of any packages is now mysteriously broken:
+Saving workspaces is broken in GAP SUSE Itanium. 
 
 ```
 sage: !gap
@@ -26,6 +26,9 @@
     
    Loading the library. Please be patient, this may take a while.
 GAP4, Version: 4.4.12 of 17-Dec-2008, ia64-unknown-linux-gnu-gcc
-gap> LoadPackage("braid");
-fail
+gap> SaveWorkspace("a");
+true
+gap>
+wstein@iras:/tmp/wstein/sage-3.4.alpha0-ia64-Linux/x> ls
+?ǎ?
 ```
``````




---

archive/issue_events_016501.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "rename": {
        "from": "gap-4.4.12 -- broken on iras (itanium Linux)",
        "to": "gap-4.4.12 -- workspaces broken on iras (itanium Linux)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5455#event-16501"
}
```



---

archive/issue_comments_050524.json:
```json
{
    "body": "<a id='comment:2'></a>\nBasically the filename option to SaveWorkspace seems to be randomly corrupted.",
    "created_at": "2009-03-08T06:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50524",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>
Basically the filename option to SaveWorkspace seems to be randomly corrupted.



---

archive/issue_comments_050525.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2009-03-08T06:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50525",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_050526.json:
```json
{
    "body": "<a id='comment:3'></a>\nAttachment [trac_5455.patch](tarball://root/attachments/some-uuid/ticket5455/trac_5455.patch) by @williamstein created at 2009-03-08 06:13:18\n\nI've posted a patch that just disables the workspace caching optimization completely for Itanium.    I wrote workspace caching for gap (long ago) and it is 100% just an optimization -- things should be functionally equivalent but just the first time one does \"gap(...)\" it is slower.  \n\n\nNOTE: I also tried compiling gap with -O0 and that didn't fix this problem.",
    "created_at": "2009-03-08T06:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50526",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'></a>
Attachment [trac_5455.patch](tarball://root/attachments/some-uuid/ticket5455/trac_5455.patch) by @williamstein created at 2009-03-08 06:13:18

I've posted a patch that just disables the workspace caching optimization completely for Itanium.    I wrote workspace caching for gap (long ago) and it is 100% just an optimization -- things should be functionally equivalent but just the first time one does "gap(...)" it is slower.  


NOTE: I also tried compiling gap with -O0 and that didn't fix this problem.



---

archive/issue_comments_050527.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm testing my patch.  I noticed that this fails:\n\n```\nFile \"/home/wstein/iras/build/sage-3.4.alpha0/devel/sage/doc/en/constructions/linear_codes.rst\", line 29:\n    sage: C.minimum_distance()\nException raised:\n    RuntimeError: Gap produced error output\n    Variable: 'GeneratorMatCode' must have a value\n```\n\nI'm guessing the problem is that when use_workspace_cache is False, then certain packages don't get loaded, maybe.   This would be another separate bug in the gap interface.",
    "created_at": "2009-03-08T06:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50527",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:4'></a>
I'm testing my patch.  I noticed that this fails:

```
File "/home/wstein/iras/build/sage-3.4.alpha0/devel/sage/doc/en/constructions/linear_codes.rst", line 29:
    sage: C.minimum_distance()
Exception raised:
    RuntimeError: Gap produced error output
    Variable: 'GeneratorMatCode' must have a value
```

I'm guessing the problem is that when use_workspace_cache is False, then certain packages don't get loaded, maybe.   This would be another separate bug in the gap interface.



---

archive/issue_comments_050528.json:
```json
{
    "body": "<a id='comment:5'></a>\nPositive review.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-09T19:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50528",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
Positive review.

Cheers,

Michael



---

archive/issue_comments_050529.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2009-03-09T19:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50529",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_016502.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-09T19:45:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "milestone": "sage-3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5455#event-16502"
}
```



---

archive/issue_comments_050530.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged in Sage 3.4.final.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-10T16:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50530",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Merged in Sage 3.4.final.

Cheers,

Michael



---

archive/issue_comments_050531.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-03-10T16:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5455#issuecomment-50531",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_016503.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-10T16:23:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5455",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5455#event-16503"
}
```
