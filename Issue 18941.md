# Issue 18941: Make Coxeter3 a new-style spkg

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2015-09-09 23:04:48

Assignee: tscrim

CC:  sage-combinat nthiery aschilling jdemeyer vbraun saliola

Convert Coxeter3 to a new-style spkg.


---

Comment by tscrim created at 2015-09-12 02:32:02

Changing status from new to needs_review.


---

Comment by tscrim created at 2015-09-12 02:32:02

IIRC the source code in the spkg version of coxeter3 is a modified version on http://math.univ-lyon1.fr/~ducloux/coxeter/coxeter3/english/coxeter3_e.html. Nicolas, Anne, can one of you confirm this?
----
New commits:


---

Comment by chapoton created at 2015-09-15 14:21:26

The bot complains:

```
tar xf /tmp/tmp4V4cir/coxeter3-1.1.tar.gz -C /tmp/tmp4V4cir

gzip: stdin: not in gzip format
```



---

Attachment


---

Comment by git created at 2015-09-15 16:16:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-15 16:17:15

Hmm...I thought I did pass the gz flag. Perhaps this one will now work.


---

Comment by chapoton created at 2015-09-17 09:41:31

ok, it was just because the link in the description was not an upload link (it was attachment instead of raw-attachment).


---

Comment by aschilling created at 2015-09-19 04:47:08

I seem to get a lot of doctest failures after installing this package:

```
sage -t /Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 42, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.__init__
Failed example:
    TestSuite(CoxeterGroup(['A',2])).run()                    # optional - coxeter3
Expected nothing
Got:
    Failure in _test_associativity:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/semigroups.py", line 119, in _test_associativity
        tester.assert_((x * y) * z == x * (y * z))
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_has_descent:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 774, in _test_has_descent
        u = s[i] * s[j]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_inverse:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/groups.py", line 150, in _test_inverse
        tester.assertEquals(x * ~x, self.one())
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 488, in __invert__
        return self.parent()(~self.value)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_one:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 453, in _test_one
        tester.assert_(x * one == x)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_prod:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/monoids.py", line 195, in _test_prod
        tester.assert_(self.prod([x]) == x)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/monoids.py", line 166, in prod
        return prod(args, self.one())
      File "sage/misc/misc_c.pyx", line 146, in sage.misc.misc_c.prod (/Applications/sage/src/build/cythonized/sage/misc/misc_c.c:1966)
        prod = z * prod
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_reduced_word:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 382, in _test_reduced_word
        tester.assertEquals(self.from_reduced_word(red), x)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 365, in from_reduced_word
        return self.one().apply_simple_reflections(word, side = 'right')
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1459, in apply_simple_reflections
        self = self.apply_simple_reflection(i, side)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1562, in apply_simple_reflection
        return self.apply_simple_reflection_right(i)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1517, in apply_simple_reflection_right
        return self * s[i]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    Failure in _test_simple_projections:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 738, in _test_simple_projections
        tester.assert_(opi[i](w) == w.apply_simple_projection(i, side = side, length_increasing = False))
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 521, in <lambda>
        return lambda x: x.apply_simple_projection(i, side = side, length_increasing = length_increasing)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1374, in apply_simple_projection
        return self.apply_simple_reflection(i, side=side)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1564, in apply_simple_reflection
        return self.apply_simple_reflection_left(i)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/coxeter_groups.py", line 1489, in apply_simple_reflection_left
        return s[i] * self
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 2
    ------------------------------------------------------------
    The following tests failed: _test_associativity, _test_has_descent, _test_inverse, _test_one, _test_prod, _test_reduced_word, _test_simple_projections
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 89, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.index_set
Failed example:
    W.index_set()                                          # optional - coxeter3
Expected:
    [1, 2, 3]
Got:
    (1, 2, 3)
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 92, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.index_set
Failed example:
    C.index_set()                                           # optional - coxeter3
Expected:
    [0, 1, 2, 3]
Got:
    (0, 1, 2, 3)
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 144, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.simple_reflections
Failed example:
    s[2]*s[1]*s[2]                                          # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.simple_reflections[2]>", line 1, in <module>
        s[Integer(2)]*s[Integer(1)]*s[Integer(2)]                                          # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 356, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    W.parabolic_kazhdan_lusztig_polynomial([],[3,2],[1,3])                    # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[1]>", line 1, in <module>
        W.parabolic_kazhdan_lusztig_polynomial([],[Integer(3),Integer(2)],[Integer(1),Integer(3)])                    # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 358, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    W.parabolic_kazhdan_lusztig_polynomial([2],[2,1,3,2],[1,3])               # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[2]>", line 1, in <module>
        W.parabolic_kazhdan_lusztig_polynomial([Integer(2)],[Integer(2),Integer(1),Integer(3),Integer(2)],[Integer(1),Integer(3)])               # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 362, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial([],[1],[0])                        # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[4]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial([],[Integer(1)],[Integer(0)])                        # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type a and rank 4
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 364, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial([],[1,2,1],[0])                    # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[5]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial([],[Integer(1),Integer(2),Integer(1)],[Integer(0)])                    # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type a and rank 4
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 366, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial([],[0,1,0,1,2,1],[0])              # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[6]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial([],[Integer(0),Integer(1),Integer(0),Integer(1),Integer(2),Integer(1)],[Integer(0)])              # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type a and rank 4
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 370, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial(w,v,[1,3])                         # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[9]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial(w,v,[Integer(1),Integer(3)])                         # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type a and rank 4
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 372, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial(w,v,[1,3],constant_term_one=False) # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[10]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial(w,v,[Integer(1),Integer(3)],constant_term_one=False) # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type a and rank 4
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 378, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    type(W.parabolic_kazhdan_lusztig_polynomial([2],[],[1]))                  # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[12]>", line 1, in <module>
        type(W.parabolic_kazhdan_lusztig_polynomial([Integer(2)],[],[Integer(1)]))                  # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 388, in parabolic_kazhdan_lusztig_polynomial
        subgroup = [ z for z in self.weak_order_ideal(lambda x: set(x.descents()).issubset(set(J))) if (u*z).bruhat_le(v) ]
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/magmas.py", line 917, in __mul__
        return self._mul_(right)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 440, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element.coatoms
Failed example:
    w.coatoms()                                            # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element.coatoms[2]>", line 1, in <module>
        w.coatoms()                                            # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 444, in coatoms
        return [W(w) for w in self.value.coatoms()]
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type B and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 485, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element.__invert__
Failed example:
    ~w                                                      # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element.__invert__[2]>", line 1, in <module>
        ~w                                                      # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 488, in __invert__
        return self.parent()(~self.value)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
**********************************************************************
File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 514, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element._mul_
Failed example:
    s[1]._mul_(s[1])                                        # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.Element._mul_[2]>", line 1, in <module>
        s[Integer(1)]._mul_(s[Integer(1)])                                        # optional - coxeter3
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/libs/coxeter3/coxeter_group.py", line 520, in _mul_
        return self.parent()(result)
      File "sage/structure/parent.pyx", line 1093, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9808)
        mor = <map.Map> self._internal_convert_map_from(R)
      File "sage/structure/parent.pyx", line 2655, in sage.structure.parent.Parent._internal_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:20725)
        mor = self.discover_convert_map_from(S)
      File "sage/structure/parent.pyx", line 2693, in sage.structure.parent.Parent.discover_convert_map_from (/Applications/sage/src/build/cythonized/sage/structure/parent.c:21299)
        mor = self._generic_convert_map(S)
      File "sage/structure/parent.pyx", line 2164, in sage.structure.parent.Parent._generic_convert_map (/Applications/sage/src/build/cythonized/sage/structure/parent.c:17442)
        return coerce_maps.DefaultConvertMap_unique(S, self)
      File "sage/structure/coerce_maps.pyx", line 38, in sage.structure.coerce_maps.DefaultConvertMap.__init__ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:2810)
        domain = Set_PythonType(domain)
      File "sage/structure/parent.pyx", line 3034, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25744)
        cpdef Parent Set_PythonType(theType):
      File "sage/structure/parent.pyx", line 3065, in sage.structure.parent.Set_PythonType (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25645)
        _type_set_cache[theType] = theSet = Set_PythonType_class(theType)
      File "sage/structure/parent.pyx", line 3099, in sage.structure.parent.Set_PythonType_class.__init__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:25871)
        raise TypeError("must be intialized with a type, not %r" % theType)
    TypeError: must be intialized with a type, not Coxeter group of type A and rank 3
....
```


Also, there are deprecation warnings when installing this package:

```
gcc version 4.9.2 (GCC)
****************************************************
sed: 1: "directories.tmpl": extra characters at the end of d command
patching file makefile
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE affine.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE automata.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE bits.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE cells.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE commands.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE constants.cpp
In file included from commands.cpp:10:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE coxgroup.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE coxtypes.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE error.cpp
In file included from error.cpp:13:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
In file included from error.cpp:20:0:
version.h:12:22: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const NAME = "Coxeter";
                      ^
version.h:13:25: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const VERSION = "3.0_beta2";
                         ^
In file included from error.cpp:8:0:
error.cpp: In function 'void error::Error(int, ...)':
error.cpp:253:41: warning: 'const char* const' is promoted to 'const char*' when passed through '...'
       const char *const str = va_arg(ap,const char *const);
                                         ^
error.cpp:253:41: note: (so you should pass 'const char*' not 'const char* const' to 'va_arg')
error.cpp:253:41: note: if this code is reached, the program will abort
error.cpp:283:41: warning: 'const char* const' is promoted to 'const char*' when passed through '...'
       const char *const str = va_arg(ap,const char *const);
                                         ^
error.cpp:283:41: note: if this code is reached, the program will abort
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE fcoxgroup.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE files.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE general.cpp
In file included from files.cpp:11:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
In file included from files.cpp:13:0:
version.h:12:22: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const NAME = "Coxeter";
                      ^
version.h:13:25: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const VERSION = "3.0_beta2";
                         ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE graph.cpp
In file included from graph.cpp:10:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE help.cpp
In file included from help.cpp:11:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE interactive.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE interface.cpp
In file included from interactive.cpp:14:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE invkl.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE io.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE kl.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE klsupport.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE main.cpp
In file included from main.cpp:158:0:
version.h:12:22: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const NAME = "Coxeter";
                      ^
version.h:13:25: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const VERSION = "3.0_beta2";
                         ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE memory.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE minroots.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE posets.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE sage.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE schubert.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE special.cpp
In file included from special.cpp:10:0:
directories.h:27:31: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const COXMATRIX_DIR = "SAGE_LOCAL/coxeter/coxeter_matrices";
                               ^
directories.h:28:28: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const HEADER_DIR = "SAGE_LOCAL/coxeter/headers";
                            ^
directories.h:29:29: warning: deprecated conversion from string constant to 'char*' [-Wwrite-strings]
   char* const MESSAGE_DIR = "SAGE_LOCAL/coxeter/messages";
                             ^
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE transducer.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE type.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE typeA.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE uneqkl.cpp
g++ -c  -O2 -fPIC -g -DFAST -DALLTRUE wgraph.cpp
g++ -dynamiclib -Wl,-headerpad_max_install_names,-undefined,dynamic_lookup,-compatibility_version,3.0,-current_version,3.0,-install_name,/Applications/sage/local/lib/libcoxeter3.dylib -o
libcoxeter3.dylib affine.o automata.o bits.o cells.o commands.o constants.o coxgroup.o coxtypes.o error.o fcoxgroup.o files.o general.o graph.o help.o interactive.o interface.o invkl.o io.o kl.o
klsupport.o main.o memory.o minroots.o posets.o sage.o schubert.o special.o transducer.o type.o typeA.o uneqkl.o wgraph.o
g++ -o coxeter affine.o automata.o bits.o cells.o commands.o constants.o coxgroup.o coxtypes.o error.o fcoxgroup.o files.o general.o graph.o help.o interactive.o interface.o invkl.o io.o kl.o
klsupport.o main.o memory.o minroots.o posets.o sage.o schubert.o special.o transducer.o type.o typeA.o uneqkl.o wgraph.o
g++ -o coxeter affine.o automata.o bits.o cells.o commands.o constants.o coxgroup.o coxtypes.o error.o fcoxgroup.o files.o general.o graph.o help.o interactive.o interface.o invkl.o io.o kl.o
klsupport.o main.o memory.o minroots.o posets.o sage.o schubert.o special.o transducer.o type.o typeA.o uneqkl.o wgraph.o
cp coxeter "$SAGE_LOCAL/bin/"
cp libcoxeter3.dylib "$SAGE_LOCAL/lib"
if [ Darwin = "CYGWIN" ]; then                 \
	    cp  "$SAGE_LOCAL/lib/";  \
	fi
mkdir -p "$SAGE_LOCAL/coxeter/"
cp -r coxeter_matrices headers messages "$SAGE_LOCAL/coxeter/"
mkdir -p "$SAGE_LOCAL/include/coxeter/"
cp -r *.h *.hpp "$SAGE_LOCAL/include/coxeter/"

real	0m6.061s
user	0m19.145s
sys	0m1.691s
Successfully installed coxeter3-1.1
Deleting temporary build directory
/Applications/sage/local/var/tmp/sage/build/coxeter3-1.1
Finished installing coxeter3-1.1.spkg

real	0m6.637s
user	0m19.409s
sys	0m1.966s
Sage build/upgrade complete!
```



---

Comment by git created at 2015-09-19 15:24:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-19 15:28:25

Changes over the years to the coercion system have made it so that if an element has a `.parent()` method, then the object returned should be a subclass of `Parent`. Since `CoxGroupElement` is meant to be a backend interface, I made the less invasive change of renaming `_parent` and `parent()` to `_parent_group` and `parent_group()`. This fixes the issue.

I also renamed the `.pxi` file to `.pxd` because this is more standard now, and there were 3 other trivial doctest failures that I fixed.


---

Comment by git created at 2015-09-19 17:28:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-19 17:35:01

I couldn't resist going in and making some other improvements to the code:

```
sage: C = CoxeterGroup(['B', 5], implementation='coxeter3')
sage: %timeit L = [C.kazhdan_lusztig_polynomial(C.one(),w) for w in C]
1 loops, best of 3: 387 ms per loop
sage: %timeit L = [C.kazhdan_lusztig_polynomial(C.one(),w,False) for w in C]
1 loops, best of 3: 467 ms per loop
```

versus previously

```
sage: %timeit L = [C.kazhdan_lusztig_polynomial(C.one(),w) for w in C]
1 loops, best of 3: 772 ms per loop
sage: %timeit L = [C.kazhdan_lusztig_polynomial(C.one(),w,False) for w in C]
1 loops, best of 3: 857 ms per loop
```

In summary, I got a ~2x speedup from not converting to a string as an intermediate object (but I'm probably taking advantage of recent upgrades in cython to do so). I also avoiding creating things in the fraction field for the non-constant coefficient KL polynomials. There were some other micro-optimizations and things I changed for better practices.


---

Comment by tscrim created at 2015-09-19 17:36:01

I should also note that the non-constant coefficient KL polynomials are now sparse to avoid filling up memory with a lot of long lists full of 0's.


---

Comment by jdemeyer created at 2015-09-19 18:41:44

`.pxd` files are meant to be cimported, not included. So you should change `include ...` to `from ... cimport ...`


---

Comment by jdemeyer created at 2015-09-19 18:41:48

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-09-19 19:20:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-19 19:21:59

Replying to [comment:13 jdemeyer]:
> `.pxd` files are meant to be cimported, not included. So you should change `include ...` to `from ... cimport ...`

I see; so since everything seems to be used, I reverted it back to a `.pxi`.


---

Comment by tscrim created at 2015-09-19 19:21:59

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-09-19 21:52:32

Replying to [comment:16 tscrim]:
> so since everything seems to be used, I reverted it back to a `.pxi`.
Why is it relevant that _everything_ is used? Cython does support `from .decl cimport *`


---

Comment by tscrim created at 2015-09-19 22:22:33

Okay, there's still a few gaps in my cython knowledge. So I should change this to a pxd file and do `from .decl cimport *`? Does this behave differently than using `include "decl.pxi"`?


---

Comment by jdemeyer created at 2015-09-20 07:12:33

Replying to [comment:18 tscrim]:
> So I should change this to a pxd file and do `from .decl cimport *`?
I'm not really saying that you should, but it's a good thing to do.

> Does this behave differently than using `include "decl.pxi"`?
Yes. However, if you're lucky, it might just work. If not, look at the error messages and try to fix things.


---

Comment by tscrim created at 2015-09-20 16:56:35

Replying to [comment:19 jdemeyer]:
> Replying to [comment:18 tscrim]:
> > So I should change this to a pxd file and do `from .decl cimport *`?
> I'm not really saying that you should, but it's a good thing to do.

Then lets do it.

> > Does this behave differently than using `include "decl.pxi"`?
> Yes. However, if you're lucky, it might just work. If not, look at the error messages and try to fix things.

Nothing broke as far as I can see.


---

Comment by git created at 2015-09-20 17:44:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-23 16:26:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-23 16:37:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-23 16:38:35

I've added a patch which gets rid of the deprecation warnings.

Note, I have begun taking over the project as upstream and welcome help (I've updated `SPKG.txt` accordingly). However, for the time being, I think it would be a good idea to merge this ticket in since it is new-style, it gives us some nice speedups by improving the interaction, and the tarball posted here is the same as on Fokko's website. Is someone willing to finish the review?


---

Comment by jdemeyer created at 2015-09-23 16:45:20

Replying to [comment:24 tscrim]:
> Is someone willing to finish the review?
Sorry, not me. Preferably the review should be done by somebody who actually knows the package.


---

Comment by aschilling created at 2015-09-23 23:13:27

Franco is visiting me for a couple of days, so I am going to try to review this patch with him!


---

Comment by aschilling created at 2015-09-24 01:04:51

The weird thing is that when I run

```
sage -t coxeter_group.py
**********************************************************************
File "coxeter_group.py", line 322, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.kazhdan_lusztig_polynomial
Failed example:
    all(KL.P(1,w) == C.kazhdan_lusztig_polynomial([],w.reduced_word()) for w in W)  # optional - coxeter3  # long (15s)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.kazhdan_lusztig_polynomial[9]>", line 1, in <module>
        all(KL.P(Integer(1),w) == C.kazhdan_lusztig_polynomial([],w.reduced_word()) for w in W)  # optional - coxeter3  # long (15s)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.kazhdan_lusztig_polynomial[9]>", line 1, in <genexpr>
        all(KL.P(Integer(1),w) == C.kazhdan_lusztig_polynomial([],w.reduced_word()) for w in W)  # optional - coxeter3  # long (15s)
    NameError: global name 'KL' is not defined
**********************************************************************
File "coxeter_group.py", line 378, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial(w,v,[1,3])                         # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[7]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial(w,v,[Integer(1),Integer(3)])                         # optional - coxeter3
    NameError: name 'w' is not defined
**********************************************************************
File "coxeter_group.py", line 380, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
Failed example:
    C.parabolic_kazhdan_lusztig_polynomial(w,v,[1,3],constant_term_one=False) # optional - coxeter3
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial[8]>", line 1, in <module>
        C.parabolic_kazhdan_lusztig_polynomial(w,v,[Integer(1),Integer(3)],constant_term_one=False) # optional - coxeter3
    NameError: name 'w' is not defined
**********************************************************************
2 items had failures:
   1 of  11 in sage.libs.coxeter3.coxeter_group.CoxeterGroup.kazhdan_lusztig_polynomial
   2 of  12 in sage.libs.coxeter3.coxeter_group.CoxeterGroup.parabolic_kazhdan_lusztig_polynomial
    [124 tests, 3 failures, 0.38 s]
----------------------------------------------------------------------
sage -t coxeter_group.py  # 3 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.4 seconds
    cpu time: 0.4 seconds
    cumulative wall time: 0.4 seconds
```

I get errors. But I think this is due to the fact that it *only* runs the coxeter3 tests and not the other ones. Is this new? I do not remember that this is how it was before. Running

```
lolita:coxeter3 anne$ sage -t --optional=sage,coxeter3 --long *
too many failed tests, not using stored timings
Running doctests with ID 2015-09-23-18-04-02-5d5fd2e5.
Git branch: u/tscrim/coxeter3_new_style_spkg-19178
Using --optional=coxeter3,sage
Doctesting 5 files.
sage -t --long __init__.py
    [0 tests, 0.00 s]
sage -t --long coxeter.pxd
    [0 tests, 0.00 s]
sage -t --long coxeter.pyx
    [257 tests, 0.14 s]
sage -t --long coxeter_group.py
    [130 tests, 7.90 s]
sage -t --long decl.pxi
    [0 tests, 0.00 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 8.2 seconds
    cpu time: 8.0 seconds
    cumulative wall time: 8.0 seconds
```

works fine.


---

Comment by aschilling created at 2015-09-24 01:19:04

In `coxeter_group.py` line 400 seems superfluous. Can this be removed? (Franco found that!!)


---

Comment by saliola created at 2015-09-24 01:21:22

This looks good to me.

Please run pyflakes to detect unused variables (like the `q = ...` mentioned in comment:29) and unnecessary imports.

Then Anne can set it to positive review on my behalf. :-)


---

Comment by git created at 2015-09-24 02:15:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-24 02:23:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-24 02:25:42

Done.

Anne is correct, it was only running the `coxeter3` tests (I get those errors with `--optional=coxeter3`). Now, the `sage -t file` by default runs the tests with your currently installed optional spkgs:

```
travis`@`apricot:~/sage/src/sage/libs/coxeter3$ sage -t coxeter_group.py 
...
Using --optional=coxeter3,database_gap,dot2tex,gap_packages,lie,mpir,python2,sage
...
```

If you want to limit the optional tests, you can use `--optional=sage,coxeter3` or `--optional=sage` to run tests which are not marked with `# optional coxeter3`.


---

Comment by aschilling created at 2015-09-24 04:26:57

Changing keywords from "" to "coxeter3".


---

Comment by aschilling created at 2015-09-24 04:26:57

Changing status from needs_review to positive_review.


---

Comment by aschilling created at 2015-09-24 04:27:13

Looks good now.


---

Comment by tscrim created at 2015-09-24 13:04:20

Thank you to all.


---

Comment by vbraun created at 2015-09-25 07:52:54

Resolution: fixed
