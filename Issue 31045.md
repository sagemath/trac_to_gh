# Issue 31045: Allow to take the sign of a callable symbolic expression

Issue created by migration from https://trac.sagemath.org/ticket/31282

Original creator: rburing

Original creation time: 2021-01-22 11:48:32

CC:  @davewittemorris

Keywords: sign,callablesymbolicexpression

Reported in [Ask SageMath question #55417](https://ask.sagemath.org/question/55417/when-i-must-declare-f-or-fxy/):


```
sage: f(x) = x^2
sage: cos(f)
x |--> cos(x^2)
sage: log(f)
x |--> log(x^2)
sage: sign(x^2)
sgn(x^2)
sage: sign(f)
...
TypeError: cannot coerce arguments: no canonical coercion from Callable function ring with argument x to Symbolic Ring
```



---

Comment by vdelecroix created at 2021-01-24 20:44:41

Moreover, one can build the object in sage

```
sage: sgn(x^2).function(x)
x |--> sgn(x^2)
```



---

Comment by @bmlivin created at 2021-01-30 18:09:42

Set assignee to @bmlivin.


---

Comment by @bmlivin created at 2021-01-30 18:09:42

I think this can be fixed by renaming the  `sage.symbolics.expression.Expression.csgn` method to `sgn` and giving it the ``@`property` decorator. I'm going to test that out and see if it breaks anything.


---

Comment by @bmlivin created at 2021-02-01 02:47:41

Replying to [comment:2 gh-bmlivin]:
> I think this can be fixed by renaming the  `sage.symbolics.expression.Expression.csgn` method to `sgn` and giving it the ``@`property` decorator. I'm going to test that out and see if it breaks anything.

Never mind. That broke a number of tests, and it doesn't appear to do what it should anyway. I will continue to look for other ways to do this.


---

Comment by @bmlivin created at 2021-02-07 00:45:34

So I've attempted to make a `sage.symbolic.expression.Expression.sgn` method which returns `giac.sgn(self)`. This causes one of the tests in `src.sage.symbolic.expression` to fail:

`sage: unicode_art(SR(1.3 - I))` should return `1.3 - ⅈ`, but it instead returns `1.3 - 1.0⋅ⅈ`. I'm not sure whether this really matters, especially since there are other tests in that same method which return `1.0⋅x` instead of `x`, but is a test that technically fails.

I have a feeling there may some other formatting tests that this may cause to fail, and I'm not sure why.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by @bmlivin created at 2021-04-25 23:57:05

Remove assignee @bmlivin.


---

Comment by mkoeppe created at 2021-07-05 19:58:11

By the docstring, `FunctionSignum` seems intended to be used for real inputs only. But the various conversions also work for complex input. What's missing is a conversion to pynac's `csgn` (`FunctionSignum` is a `BuiltinFunction`, not a `GinacFunction`, for a reason unknown to me). Fixing this will likely also fix the issue on the ticket description.
