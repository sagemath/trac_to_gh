# Issue 17125: add guidelines for testing dicts to devel guide

Issue created by migration from https://trac.sagemath.org/ticket/17362

Original creator: kcrisman

Original creation time: 2014-11-18 13:33:19

[The developer guide](http://www.sagemath.org/doc/developer/coding_basics.html#writing-testable-examples) doesn't mention that dictionaries can come out platform-dependent or worse in Python.  New developers should have a good place to


---

Comment by kcrisman created at 2014-11-18 14:02:44

E.g. something along the lines of

```
sage: D = {1:2, 2:3} # possibly random order depending on hashing
sage: E = {2:3, 1:2}
sage: sorted(D.items()) # guaranteed
[(1, 2), (2, 3)]
sage: sorted(E.items()) == sorted(D.items())
True
```

but perhaps someone might have an actual example that had to be fixed for the Sage doc to test right, I am pretty sure Trac is full of these.


---

Comment by jdemeyer created at 2014-11-19 13:02:43

Replying to [ticket:17362 kcrisman]:
> dictionaries can come out platform-dependent or worse in Python.

Isn't this fixed by #16746?


---

Comment by kcrisman created at 2014-11-19 13:52:54

> > dictionaries can come out platform-dependent or worse in Python.
> 
> Isn't this fixed by #16746?

I didn't know about that aspect of it, only the graphics part.  So will doctests automatically fail if people put them in the order that their computer gives and it's not sorted?  That could be confusing!  So maybe it should still be mentioned in the guide, along with the graphics piece - which is not what the command line gives.

And, more relevant to my immediate concern, what if the keys themselves are dictionary-enough that _they_ are platform-dependent?  See #16331 for an explicit example of this.  It would be great if you could give some advice for that, because we haven't come to any useful consensus yet.


---

Comment by jdemeyer created at 2014-11-19 14:12:22

Replying to [comment:4 kcrisman]:
> So will doctests automatically fail if people put them in the order that their computer gives and it's not sorted?
There are 2 dict orders: the Python order and the IPython order. The Python order is what you get with `print` statements, the IPython order is the sorted order. The latter is used by the IPython interface, by sagenb and by doctests. So, I would say that the order in doctests after #16746 is actually the order that "their computer gives".


---

Comment by jdemeyer created at 2014-11-19 14:16:46

Replying to [comment:4 kcrisman]:
> And, more relevant to my immediate concern, what if the keys themselves are dictionary-enough that _they_ are platform-dependent?  See #16331 for an explicit example of this.  It would be great if you could give some advice for that, because we haven't come to any useful consensus yet.
Well, #16331 is special because you're sorting a list containing integers and strings. The problem is that the output of `sorted([3,"foo"])` isn't well-defined.


---

Comment by kcrisman created at 2014-11-19 14:24:47

> > And, more relevant to my immediate concern, what if the keys themselves are dictionary-enough that _they_ are platform-dependent?  See #16331 for an explicit example of this.  It would be great if you could give some advice for that, because we haven't come to any useful consensus yet.
> Well, #16331 is special because you're sorting a list containing integers and strings. The problem is that the output of `sorted([3,"foo"])` isn't well-defined.
Yikes, and apparently [isn't even allowed](http://www.peterbe.com/plog/sorting-mixed-type-lists-in-python-3) in Python 3.
> the IPython order is the sorted order.
Hmm, although I still think some updating could be done, I guess a ticket just for that or the graphics thing, which is now everywhere, probably isn't that worthwhile.


---

Comment by jdemeyer created at 2014-11-19 14:30:32

Close as "wontfix"?


---

Comment by jdemeyer created at 2014-11-19 14:30:32

Changing status from new to needs_review.


---

Comment by kcrisman created at 2014-11-19 14:55:37

ok


---

Comment by jdemeyer created at 2014-11-19 14:56:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-28 20:59:30

Resolution: wontfix
