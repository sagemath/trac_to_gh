# Issue 12988: upgrade cvxopt to 1.1.5

archive/issues_012988.json:
```json
{
    "body": "Assignee: tbd\n\nUpgrading cvxopt to 1.1.5 we can get rid of a patch to correct a wrong behavior that is obvious on OS X. Also I want to simplify the setup.py patch which give rise to overlinking (and in fact potential linking of multiple cblas libraries - yuk!). I am also attempting to install the documentation.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13160\n\n",
    "created_at": "2012-06-25T11:21:26Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "upgrade cvxopt to 1.1.5",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12988",
    "user": "@kiwifb"
}
```
Assignee: tbd

Upgrading cvxopt to 1.1.5 we can get rid of a patch to correct a wrong behavior that is obvious on OS X. Also I want to simplify the setup.py patch which give rise to overlinking (and in fact potential linking of multiple cblas libraries - yuk!). I am also attempting to install the documentation.

Issue created by migration from https://trac.sagemath.org/ticket/13160





---

archive/issue_comments_157002.json:
```json
{
    "body": "I have a spkg almost ready to upload. Changes are uncommitted yet. There are some kinks to check in the installation of the documentation.",
    "created_at": "2012-06-25T11:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157002",
    "user": "@kiwifb"
}
```

I have a spkg almost ready to upload. Changes are uncommitted yet. There are some kinks to check in the installation of the documentation.



---

archive/issue_comments_157003.json:
```json
{
    "body": "Experimental spkg now posted and linked in the description. The changes in the spkg have not been committed yet so I can still fiddle with it as necessary.",
    "created_at": "2012-06-26T22:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157003",
    "user": "@kiwifb"
}
```

Experimental spkg now posted and linked in the description. The changes in the spkg have not been committed yet so I can still fiddle with it as necessary.



---

archive/issue_comments_157004.json:
```json
{
    "body": "Looks good on OSX 10.6.8 and Sage 5.2.beta1 with #10508 applied.\nI tried both lapack/blas, the ones from Apple, and the ones from Atlas 3.10 from  #10508, with `SAGE_CHECK` on.\n\nBy the way, shouldn't #10508 be a dependence of this ticket? (I added it here, tentatively.)\n\nAlso, I wonder if there is anything to report upstream here.",
    "created_at": "2012-07-20T08:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157004",
    "user": "@dimpase"
}
```

Looks good on OSX 10.6.8 and Sage 5.2.beta1 with #10508 applied.
I tried both lapack/blas, the ones from Apple, and the ones from Atlas 3.10 from  #10508, with `SAGE_CHECK` on.

By the way, shouldn't #10508 be a dependence of this ticket? (I added it here, tentatively.)

Also, I wonder if there is anything to report upstream here.



---

archive/issue_comments_157005.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2012-07-20T08:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157005",
    "user": "@dimpase"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_157006.json:
```json
{
    "body": "#10508 doesn't change the layout of the ATLAS libraries, the current atlas-3.8.4 already provides the cblas library. If the cvxopt spkg were to link to the correct libraries only, it would work with both atlas-3.8.4 and atlas-3.10.0 spkgs.",
    "created_at": "2012-07-21T19:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157006",
    "user": "@vbraun"
}
```

#10508 doesn't change the layout of the ATLAS libraries, the current atlas-3.8.4 already provides the cblas library. If the cvxopt spkg were to link to the correct libraries only, it would work with both atlas-3.8.4 and atlas-3.10.0 spkgs.



---

archive/issue_comments_157007.json:
```json
{
    "body": "Replying to [comment:4 vbraun]:\n> #10508 doesn't change the layout of the ATLAS libraries, the current atlas-3.8.4 already provides the cblas library. If the cvxopt spkg were to link to the correct libraries only, it would work with both atlas-3.8.4 and atlas-3.10.0 spkgs.\n\nWhen you closed #10509 you said it is fixed by atlas-3.10.0 spkg. And #10508 is the one the provides atlas-3.10.0 spkg.",
    "created_at": "2012-07-22T04:37:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157007",
    "user": "@dimpase"
}
```

Replying to [comment:4 vbraun]:
> #10508 doesn't change the layout of the ATLAS libraries, the current atlas-3.8.4 already provides the cblas library. If the cvxopt spkg were to link to the correct libraries only, it would work with both atlas-3.8.4 and atlas-3.10.0 spkgs.

When you closed #10509 you said it is fixed by atlas-3.10.0 spkg. And #10508 is the one the provides atlas-3.10.0 spkg.



---

archive/issue_comments_157008.json:
```json
{
    "body": "The only thing really to check in this ticket is the installation of the documentation. Technically it needs sphinx to build but because up to date build documentation is shipped nothing is done. So the question is whether to require sphinx or just copy the already built documentation. Once I make an informed decision on that I'll finalize the spkg.",
    "created_at": "2012-07-22T21:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157008",
    "user": "@kiwifb"
}
```

The only thing really to check in this ticket is the installation of the documentation. Technically it needs sphinx to build but because up to date build documentation is shipped nothing is done. So the question is whether to require sphinx or just copy the already built documentation. Once I make an informed decision on that I'll finalize the spkg.



---

archive/issue_comments_157009.json:
```json
{
    "body": "OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.",
    "created_at": "2012-07-22T23:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157009",
    "user": "@kiwifb"
}
```

OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.



---

archive/issue_comments_157010.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-07-23T00:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157010",
    "user": "@kiwifb"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_157011.json:
```json
{
    "body": "Replying to [comment:7 fbissey]:\n> OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.\n\nShouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)\n\nAlso, I don't understand what you mean by \"dependence\" on sphinx. Isn't sphinx included in Sage?",
    "created_at": "2012-07-23T04:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157011",
    "user": "@dimpase"
}
```

Replying to [comment:7 fbissey]:
> OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.

Shouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)

Also, I don't understand what you mean by "dependence" on sphinx. Isn't sphinx included in Sage?



---

archive/issue_comments_157012.json:
```json
{
    "body": "Replying to [comment:9 dimpase]:\n> Replying to [comment:7 fbissey]:\n> > OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.\n> \n> Shouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)\n> \n> Also, I don't understand what you mean by \"dependence\" on sphinx. Isn't sphinx included in Sage?\n\nAs far as I know, you only install documentation for spkg if that variable is set. I may be wrong. \n\nYes sphinx is shipped with sage but if this spkg uses sphinx it has to be listed as one of its dependencies in spkg/standard/deps. In this particular case it is probably ok because cvxopt can be build after sage I think. But in the alternative there are problems as far as I remember from a previous upgrade of numpy way back.",
    "created_at": "2012-07-23T04:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157012",
    "user": "@kiwifb"
}
```

Replying to [comment:9 dimpase]:
> Replying to [comment:7 fbissey]:
> > OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.
> 
> Shouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)
> 
> Also, I don't understand what you mean by "dependence" on sphinx. Isn't sphinx included in Sage?

As far as I know, you only install documentation for spkg if that variable is set. I may be wrong. 

Yes sphinx is shipped with sage but if this spkg uses sphinx it has to be listed as one of its dependencies in spkg/standard/deps. In this particular case it is probably ok because cvxopt can be build after sage I think. But in the alternative there are problems as far as I remember from a previous upgrade of numpy way back.



---

archive/issue_comments_157013.json:
```json
{
    "body": "Replying to [comment:10 fbissey]:\n\nOK, I asked [on sage-devel](https://groups.google.com/d/msg/sage-devel/Y90TXgtSMcQ/SQ5aJm9Rr7EJ)",
    "created_at": "2012-07-23T05:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157013",
    "user": "@dimpase"
}
```

Replying to [comment:10 fbissey]:

OK, I asked [on sage-devel](https://groups.google.com/d/msg/sage-devel/Y90TXgtSMcQ/SQ5aJm9Rr7EJ)



---

archive/issue_comments_157014.json:
```json
{
    "body": "Replying to [comment:9 dimpase]:\n> Replying to [comment:7 fbissey]:\n> > OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.\n> \n> Shouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)\n\n??  #11197 has sort of delayed most packages actually implementing #10823.  I believe that we currently don't want docs installed by default outside of wherever the spkg lives.  Or maybe I'm misunderstanding the point of this discussion, my apologies if that's so.",
    "created_at": "2012-07-23T13:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157014",
    "user": "@kcrisman"
}
```

Replying to [comment:9 dimpase]:
> Replying to [comment:7 fbissey]:
> > OK I pushed a new spkg on google code it install the already built documentation and has a section commented out on how to build it in spkg-install.
> 
> Shouldn't it install docs by default? (Currently, you need to set `SAGE_SPKG_INSTALL_DOCS`)

??  #11197 has sort of delayed most packages actually implementing #10823.  I believe that we currently don't want docs installed by default outside of wherever the spkg lives.  Or maybe I'm misunderstanding the point of this discussion, my apologies if that's so.



---

archive/issue_comments_157015.json:
```json
{
    "body": "I didn't remember how the discussion had ended. Probably because I wasn't on the follow up ticket where things were discussed. Should I remove the section about documentation until one day we sort this out?\n\nWe should note that some packages already put their doc in $SAGE_LOCAL/share/doc:\n\n```\nfrb15@p2n14-c /hpc/scratch/frb15/sandbox/sage-5.1.beta5/local/share/doc :ll   \ntotal 1792\ndrwxr-xr-x 2 frb15 z001 131072 Jun 29 13:08 NTL\ndrwxr-xr-x 5 frb15 z001 131072 Jun 29 15:05 ipython\ndrwxr-xr-x 3 frb15 z001 131072 Jun 29 13:13 mpfr\ndrwxr-xr-x 3 frb15 z001 131072 Jun 29 15:12 networkx-1.2\ndrwxr-xr-x 3 frb15 z001 131072 Jun 29 13:53 ppl\ndrwxr-xr-x 3 frb15 z001 131072 Jun 29 13:53 pwl\ndrwxr-xr-x 2 frb15 z001 131072 Jun 29 15:49 sagetex\n```\n\nI am not even sure those obey SAGE_SPKG_INSTALL_DOCS and some are html. The cvxopt spkg linked in this ticket doesn't need sphinx because the doc is prebuilt in the tarball.",
    "created_at": "2012-07-23T21:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157015",
    "user": "@kiwifb"
}
```

I didn't remember how the discussion had ended. Probably because I wasn't on the follow up ticket where things were discussed. Should I remove the section about documentation until one day we sort this out?

We should note that some packages already put their doc in $SAGE_LOCAL/share/doc:

```
frb15@p2n14-c /hpc/scratch/frb15/sandbox/sage-5.1.beta5/local/share/doc :ll   
total 1792
drwxr-xr-x 2 frb15 z001 131072 Jun 29 13:08 NTL
drwxr-xr-x 5 frb15 z001 131072 Jun 29 15:05 ipython
drwxr-xr-x 3 frb15 z001 131072 Jun 29 13:13 mpfr
drwxr-xr-x 3 frb15 z001 131072 Jun 29 15:12 networkx-1.2
drwxr-xr-x 3 frb15 z001 131072 Jun 29 13:53 ppl
drwxr-xr-x 3 frb15 z001 131072 Jun 29 13:53 pwl
drwxr-xr-x 2 frb15 z001 131072 Jun 29 15:49 sagetex
```

I am not even sure those obey SAGE_SPKG_INSTALL_DOCS and some are html. The cvxopt spkg linked in this ticket doesn't need sphinx because the doc is prebuilt in the tarball.



---

archive/issue_comments_157016.json:
```json
{
    "body": "Replying to [comment:13 fbissey]:\n> I didn't remember how the discussion had ended. Probably because I wasn't on the follow up ticket where things were discussed. Should I remove the section about documentation until one day we sort this out?\n\nno, why, documentation is great to have. But why not remove the pre-built one and make it using sphynx?\n(the latter will need a trivial change in `SAGE_ROOT/spkg/standard/deps`).",
    "created_at": "2012-07-24T07:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157016",
    "user": "@dimpase"
}
```

Replying to [comment:13 fbissey]:
> I didn't remember how the discussion had ended. Probably because I wasn't on the follow up ticket where things were discussed. Should I remove the section about documentation until one day we sort this out?

no, why, documentation is great to have. But why not remove the pre-built one and make it using sphynx?
(the latter will need a trivial change in `SAGE_ROOT/spkg/standard/deps`).



---

archive/issue_comments_157017.json:
```json
{
    "body": "Can do that but I don't think it will be much different from the one shipped. The first thing that sphinx does when it is run is check whether what is already built is up to date. Rebuilding it again is just a waste of cpu cycles.\n\nI don't really care about it that much myself. So if people are quite happy about rebuilding the doc I'll just remove the pre build from the spkg to save space and produce the other needed patch.",
    "created_at": "2012-07-24T21:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157017",
    "user": "@kiwifb"
}
```

Can do that but I don't think it will be much different from the one shipped. The first thing that sphinx does when it is run is check whether what is already built is up to date. Rebuilding it again is just a waste of cpu cycles.

I don't really care about it that much myself. So if people are quite happy about rebuilding the doc I'll just remove the pre build from the spkg to save space and produce the other needed patch.



---

archive/issue_comments_157018.json:
```json
{
    "body": "There are leftovers of debugging in src/src/C/blas.c, starting from line 295, which reads\n\n```\n    printf(\"scal\\n\");\n```\n\n\nThis is very strange.\n\nEDIT: I checked the upstream, and they don't have these printfs...",
    "created_at": "2012-07-27T07:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157018",
    "user": "@dimpase"
}
```

There are leftovers of debugging in src/src/C/blas.c, starting from line 295, which reads

```
    printf("scal\n");
```


This is very strange.

EDIT: I checked the upstream, and they don't have these printfs...



---

archive/issue_comments_157019.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-07-27T07:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157019",
    "user": "@dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_157020.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> There are leftovers of debugging in src/src/C/blas.c, starting from line 295, which reads\n> {{{\n>     printf(\"scal\\n\");\n> }}}\n> \n> This is very strange.\n> \n> EDIT: I checked the upstream, and they don't have these printfs... \n\nMoreover, the upstream files base.c, blas.c, and sparse.c in src/src/C have earlier dates (and different sizes) than the ones in spkg.\nAnd replacing the spkg files by upstream files makes the package seemingly work on OSX10.6.8. I didn't test much, but the file `src/examples/doc/chap10/l1svc.py` which gives me crashes with the spkg, works OK with the upstream replacement.",
    "created_at": "2012-07-27T07:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157020",
    "user": "@dimpase"
}
```

Replying to [comment:16 dimpase]:
> There are leftovers of debugging in src/src/C/blas.c, starting from line 295, which reads
> {{{
>     printf("scal\n");
> }}}
> 
> This is very strange.
> 
> EDIT: I checked the upstream, and they don't have these printfs... 

Moreover, the upstream files base.c, blas.c, and sparse.c in src/src/C have earlier dates (and different sizes) than the ones in spkg.
And replacing the spkg files by upstream files makes the package seemingly work on OSX10.6.8. I didn't test much, but the file `src/examples/doc/chap10/l1svc.py` which gives me crashes with the spkg, works OK with the upstream replacement.



---

archive/issue_comments_157021.json:
```json
{
    "body": "Sorry wrong spkg I was tracking something on power7 I will correct the source today - hopefully.",
    "created_at": "2012-07-29T21:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157021",
    "user": "@kiwifb"
}
```

Sorry wrong spkg I was tracking something on power7 I will correct the source today - hopefully.



---

archive/issue_comments_157022.json:
```json
{
    "body": "Corrected the source. Sorry for the inconvenience.",
    "created_at": "2012-07-30T11:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157022",
    "user": "@kiwifb"
}
```

Corrected the source. Sorry for the inconvenience.



---

archive/issue_comments_157023.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-30T11:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157023",
    "user": "@kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_157024.json:
```json
{
    "body": "On Fedora 17 x86_64:\n\n```\nbuilding 'gsl' extension\ncreating build/temp.linux-x86_64-2.7\ncreating build/temp.linux-x86_64-2.7/C\ngcc -fno-strict-aliasing -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/vbraun/opt/sage-atlas/sage-5.2/local/include/gsl -I/home/vbraun/opt/sage-atlas/sage-5.2/local/include/python2.7 -c C/gsl.c -o build/temp.linux-x86_64-2.7/C/gsl.o\nC/gsl.c:28:25: fatal error: gsl/gsl_rng.h: No such file or directory\ncompilation terminated.\n```\n\nThe header is in Sage but the include path is wrong:\n\n```\n[vbraun@laptop sage-5.2]$ find | grep gsl_rng\n./local/include/gsl/gsl_rng.h\n```\n\nThe fix is to set If I edit `GSL_INC_DIR = SAGE_INCLUDE` in `setup.py`, and not `SAGE_INCLUDE/gsl`.\n\nI've updated the spkg (see description, only change is the `GSL_INC_DIR`) and it builds for me now.",
    "created_at": "2012-08-02T02:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157024",
    "user": "@vbraun"
}
```

On Fedora 17 x86_64:

```
building 'gsl' extension
creating build/temp.linux-x86_64-2.7
creating build/temp.linux-x86_64-2.7/C
gcc -fno-strict-aliasing -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/vbraun/opt/sage-atlas/sage-5.2/local/include/gsl -I/home/vbraun/opt/sage-atlas/sage-5.2/local/include/python2.7 -c C/gsl.c -o build/temp.linux-x86_64-2.7/C/gsl.o
C/gsl.c:28:25: fatal error: gsl/gsl_rng.h: No such file or directory
compilation terminated.
```

The header is in Sage but the include path is wrong:

```
[vbraun@laptop sage-5.2]$ find | grep gsl_rng
./local/include/gsl/gsl_rng.h
```

The fix is to set If I edit `GSL_INC_DIR = SAGE_INCLUDE` in `setup.py`, and not `SAGE_INCLUDE/gsl`.

I've updated the spkg (see description, only change is the `GSL_INC_DIR`) and it builds for me now.



---

archive/issue_comments_157025.json:
```json
{
    "body": "OK you beat me to it. I was going to post about it. I am guessing the problem is not visible if gsl is installed system wide.",
    "created_at": "2012-08-02T02:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157025",
    "user": "@kiwifb"
}
```

OK you beat me to it. I was going to post about it. I am guessing the problem is not visible if gsl is installed system wide.



---

archive/issue_comments_157026.json:
```json
{
    "body": "Just saw that we discovered the same bug within ~5mins. Coincidence? ;-)",
    "created_at": "2012-08-02T02:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157026",
    "user": "@vbraun"
}
```

Just saw that we discovered the same bug within ~5mins. Coincidence? ;-)



---

archive/issue_comments_157027.json:
```json
{
    "body": "John was the pointer for me really. Didn't notice it before - all the system I tested it with had gsl as standard. I need a box with nothing interesting on it really.",
    "created_at": "2012-08-02T02:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157027",
    "user": "@kiwifb"
}
```

John was the pointer for me really. Didn't notice it before - all the system I tested it with had gsl as standard. I need a box with nothing interesting on it really.



---

archive/issue_comments_157028.json:
```json
{
    "body": "On hawk, this builds if SAGE_ATLAS_LIB points to the system ATLAS, but not if I use the ATLAS spkg from #10508. [Log here.](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.5.log)",
    "created_at": "2012-08-02T03:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157028",
    "user": "@jhpalmieri"
}
```

On hawk, this builds if SAGE_ATLAS_LIB points to the system ATLAS, but not if I use the ATLAS spkg from #10508. [Log here.](http://sage.math.washington.edu/home/palmieri/misc/cvxopt-1.1.5.log)



---

archive/issue_comments_157029.json:
```json
{
    "body": "shouldn't be -lblas but -lf77blas I guess.",
    "created_at": "2012-08-02T03:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157029",
    "user": "@kiwifb"
}
```

shouldn't be -lblas but -lf77blas I guess.



---

archive/issue_comments_157030.json:
```json
{
    "body": "\n```\n+if os.environ['UNAME'] == 'CYGWIN':\n+  BLAS_LIB =['blas', 'gfortran']\n+elif os.environ['UNAME'] == 'Darwin':\n+  BLAS_LIB =['blas','gfortran','m']\n+else:\n+  BLAS_LIB =['blas','cblas','gfortran','atlas','m']\n+\n```\n\nshould really be \n\n```\n+if os.environ['UNAME'] == 'CYGWIN':\n+  BLAS_LIB =['blas', 'gfortran']\n+elif os.environ['UNAME'] == 'Darwin':\n+  BLAS_LIB =['blas','gfortran','m']\n+else:\n+  BLAS_LIB =['f77blas','cblas','gfortran','atlas','m']\n+\n```\n\nI think it may have escaped because we had libblas before #10508",
    "created_at": "2012-08-02T03:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157030",
    "user": "@kiwifb"
}
```


```
+if os.environ['UNAME'] == 'CYGWIN':
+  BLAS_LIB =['blas', 'gfortran']
+elif os.environ['UNAME'] == 'Darwin':
+  BLAS_LIB =['blas','gfortran','m']
+else:
+  BLAS_LIB =['blas','cblas','gfortran','atlas','m']
+
```

should really be 

```
+if os.environ['UNAME'] == 'CYGWIN':
+  BLAS_LIB =['blas', 'gfortran']
+elif os.environ['UNAME'] == 'Darwin':
+  BLAS_LIB =['blas','gfortran','m']
+else:
+  BLAS_LIB =['f77blas','cblas','gfortran','atlas','m']
+
```

I think it may have escaped because we had libblas before #10508



---

archive/issue_comments_157031.json:
```json
{
    "body": "I agree and just replaced the spkg (new md5sum = b155f7e4624c2869b9a0e5aa21803435)\n\nBuilds on Fedora 17",
    "created_at": "2012-08-02T03:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157031",
    "user": "@vbraun"
}
```

I agree and just replaced the spkg (new md5sum = b155f7e4624c2869b9a0e5aa21803435)

Builds on Fedora 17



---

archive/issue_comments_157032.json:
```json
{
    "body": "Builds and passes self-tests on hawk, both with the system ATLAS and the ATLAS spkg from #10508.",
    "created_at": "2012-08-02T03:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157032",
    "user": "@jhpalmieri"
}
```

Builds and passes self-tests on hawk, both with the system ATLAS and the ATLAS spkg from #10508.



---

archive/issue_comments_157033.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-02T03:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157033",
    "user": "@vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_157034.json:
```json
{
    "body": "Looks good to me!",
    "created_at": "2012-08-02T03:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157034",
    "user": "@vbraun"
}
```

Looks good to me!



---

archive/issue_comments_157035.json:
```json
{
    "body": "Thanks Volker for the last mile. I also just thought that we will need a follow up ticket if we allow people to use ATLAS on OS X.",
    "created_at": "2012-08-02T21:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157035",
    "user": "@kiwifb"
}
```

Thanks Volker for the last mile. I also just thought that we will need a follow up ticket if we allow people to use ATLAS on OS X.



---

archive/issue_comments_157036.json:
```json
{
    "body": "So on OS X, if people use the ATLAS spkg, then is this using a mix of Sage's ATLAS and the system's blas? (I'm in the process of building on OS X, including ATLAS from #10508, and cvxopt has built and passes its self-tests. The build hasn't completed, so Sage's test suite hasn't run yet.)",
    "created_at": "2012-08-03T05:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157036",
    "user": "@jhpalmieri"
}
```

So on OS X, if people use the ATLAS spkg, then is this using a mix of Sage's ATLAS and the system's blas? (I'm in the process of building on OS X, including ATLAS from #10508, and cvxopt has built and passes its self-tests. The build hasn't completed, so Sage's test suite hasn't run yet.)



---

archive/issue_comments_157037.json:
```json
{
    "body": "Replying to [comment:31 jhpalmieri]:\n> So on OS X, if people use the ATLAS spkg, then is this using a mix of Sage's ATLAS and the system's blas? (I'm in the process of building on OS X, including ATLAS from #10508, and cvxopt has built and passes its self-tests. The build hasn't completed, so Sage's test suite hasn't run yet.)\n\nI hope so. It would be a big speed digression to use GSL.",
    "created_at": "2012-08-03T05:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157037",
    "user": "@dimpase"
}
```

Replying to [comment:31 jhpalmieri]:
> So on OS X, if people use the ATLAS spkg, then is this using a mix of Sage's ATLAS and the system's blas? (I'm in the process of building on OS X, including ATLAS from #10508, and cvxopt has built and passes its self-tests. The build hasn't completed, so Sage's test suite hasn't run yet.)

I hope so. It would be a big speed digression to use GSL.



---

archive/issue_comments_157038.json:
```json
{
    "body": "From what I put in the spkg cvxopt will use the OS X accelerate framework instead of ATLAS. You should note that it is not the only spkg for which it will be the case. linbox will do that as well for example. iml also comes to mind as well and numpy and scipy should be checked.\nFrom the sage shell can you check the output of \n\n```\notool -L local/lib/python/site-packages/cvxopt/blas.so\n```\n\nIt should tell you against which library it was linked in some form.",
    "created_at": "2012-08-03T09:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157038",
    "user": "@kiwifb"
}
```

From what I put in the spkg cvxopt will use the OS X accelerate framework instead of ATLAS. You should note that it is not the only spkg for which it will be the case. linbox will do that as well for example. iml also comes to mind as well and numpy and scipy should be checked.
From the sage shell can you check the output of 

```
otool -L local/lib/python/site-packages/cvxopt/blas.so
```

It should tell you against which library it was linked in some form.



---

archive/issue_comments_157039.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-12T19:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12988",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12988#issuecomment-157039",
    "user": "@jdemeyer"
}
```

Resolution: fixed
