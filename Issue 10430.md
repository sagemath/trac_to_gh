# Issue 10430: Deprecate the misuse of symbolic variables as polynomial variable

Issue created by migration from https://trac.sagemath.org/ticket/10483

Original creator: SimonKing

Original creation time: 2010-12-16 13:51:16

Assignee: AlexGhitza

Keywords: deprecation symbolic polynomial variable

Relatively often on sage-support, users run into a problem since they mix symbolics and polynomials. Typically, they do

```
sage: z = var('z')
sage: P = QQ[z]
```

and expect that `z` is the generator of `P` - which is of course 
wrong and will soon mean trouble.

I find even worse that one can do

```
sage: QQ[x,gap,singular]
Multivariate Polynomial Ring in x, Gap, Singular over Rational Field
```

since the variable names are obtained from the string representation of the given objects.

It should be clear that the preferred way of constructing a polynomial (or quotient) ring together with its generators is

```
sage: R.<x,y,z> = QQ[]
```


Hence, it is quite amazing that in the documentation one occasionally finds the "wrong" usage

```
sage: x,y,z = var('x y z')
sage: P = QQ[x,y,z]
```


I suggest to deprecate the possibility of providing the variable names by anything but strings (potentially plus an integer, like `PolynomialRing(QQ,'x',5)`).

With my patch, one has

```
sage: QQ[x,gap,singular]
/mnt/local/king/SAGE/sage-4.6/local/bin/sage-ipython:1: DeprecationWarning: (Since Sage Version 4.6.1) Variable name 'x' should be a string, but we obtained <type 'sage.symbolic.expression.Expression'>.
In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
  #!/usr/bin/env python
/mnt/local/king/SAGE/sage-4.6/local/bin/sage-ipython:1: DeprecationWarning: (Since Sage Version 4.6.1) Variable name 'Gap' should be a string, but we obtained <class 'sage.interfaces.gap.Gap'>.
In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
  #!/usr/bin/env python
/mnt/local/king/SAGE/sage-4.6/local/bin/sage-ipython:1: DeprecationWarning: (Since Sage Version 4.6.1) Variable name 'Singular' should be a string, but we obtained <class 'sage.interfaces.singular.Singular'>.
In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
  #!/usr/bin/env python
Multivariate Polynomial Ring in x, Gap, Singular over Rational Field
```


I am not sure what component this ticket belongs. I try basic arithmetic.


---

Attachment


---

Comment by SimonKing created at 2010-12-16 14:51:34

Now the patch is attached. By the way: It also adds some doctests...


---

Comment by SimonKing created at 2010-12-16 14:51:34

Changing status from new to needs_review.


---

Comment by kcrisman created at 2011-01-11 16:30:53

Just a question - are the changes in symbolics because before the variables might or might not have been strings?

Also, is there an easy way to show what the generator of `P` would have been in the "bad" old case?  I think that's useful to point out, if one is going to make the remarks in the first place.


---

Comment by SimonKing created at 2011-01-11 18:25:32

Replying to [comment:2 kcrisman]:
> Just a question - are the changes in symbolics because before the variables might or might not have been strings?

As much as I know, the changes that I did in symbolics are indeed "replace a variable `v` by `repr(v)` when it is used to define a polynomial ring. 

> Also, is there an easy way to show what the generator of `P` would have been in the "bad" old case?  I think that's useful to point out, if one is going to make the remarks in the first place.  

I am not quite sure what you mean. By "remark", you probably mean

```
In earlier versions of Sage, the names have not necessarily been 
strings. Some users provided a symbolic variable instead of a string, 
and expected that this symbolic variable is the same as the generator 
of the resulting polynomial ring, which is of course not the case. 
This common mistake is now deprecated. 
```


So, you suggest to write something like this:

```
In earlier versions of Sage, the names have not necessarily been 
strings. Some users provided a symbolic variable instead of a string, 
and expected that this symbolic variable is the same as the generator 
of the resulting polynomial ring, which is of course not the case.

The following might be surpising for a user expecting the variable `x`
to be a polynomial::

    sage: P = QQ['x'] # here, some users wrote QQ[x], which is now deprecated
    sage: x == P(x)
    x == x
    sage: type(x == P(x))
    <type 'sage.symbolic.expression.Expression'>
    sage: parent(x+P(x)) == P
    False

```


I am not so convinced that the above text is good. Do you have a better suggesion?


---

Comment by kcrisman created at 2011-01-11 19:02:27

I'm just saying that the "of course is not the case" is not at all "of course" to me.  Current behavior:

```
sage: P = QQ[x]
sage: P.gen()
x
sage: P.gen() == x
x == x
sage: bool(P.gen() == x)
True
sage: P.gen() is x
False
```

So unless you think to do the last thing, that is pretty confusing - they have identical representation methods.  Which is of course why you want to change this, and introduce the deprecation.

So maybe you could say 

```
... resulting polynomial ring.  However, this was not the case; the generator of a polynomial ring is always a polynomial type, not a symbolic expression, so although they have the same representation, they are not the same.  This explains the following warning:

<deprecation warning doctest
```

Does that make any sense?


---

Comment by SimonKing created at 2011-01-11 19:29:39

Replying to [comment:4 kcrisman]:
> So maybe you could say 
> {{{
> ... resulting polynomial ring.  However, this was not the case; the generator of a polynomial ring is always a polynomial type, not a symbolic expression, so although they have the same representation, they are not the same.  This explains the following warning:
> 
> <deprecation warning doctest
> }}}
> Does that make any sense?

Yes, your formulation sounds much better than mine! Could you make a reviewer patch, changing the formulation?

Best regards, Simon


---

Comment by kcrisman created at 2011-01-11 19:48:31

Replying to [comment:5 SimonKing]:
> Replying to [comment:4 kcrisman]:
> > So maybe you could say 
> > {{{
> > ... resulting polynomial ring.  However, this was not the case; the generator of a polynomial ring is always a polynomial type, not a symbolic expression, so although they have the same representation, they are not the same.  This explains the following warning:
> > 
> > <deprecation warning doctest
> > }}}
> > Does that make any sense?
> 
> Yes, your formulation sounds much better than mine! Could you make a reviewer patch, changing the formulation?
> 

Umm... that might not happen for a little while.   I can do it, though.   But if I'm going to give it a formal review, I have to make sure I check that all those changes involving making things strings really catch what they are supposed to, and I don't have time to do that right now, and then make the reviewer patch, and I am slow on such things... sorry.

Also, I seem to recall there being some discussion about this on sage-devel.  It's enough of a change (particularly since there are doctests which use the old one) that it could inconvenience some heavy users to see the deprecation messages, so if you have a link to that discussion I'd be interested in reading through it.


---

Comment by kcrisman created at 2011-01-12 16:10:19

For reference, here is the [sage-devel discussion](http://groups.google.com/group/sage-devel/browse_thread/thread/b814e5a4c6d1023d).  Not that much noise, thankfully.


---

Comment by kcrisman created at 2011-01-12 19:55:49

Changing status from needs_review to needs_info.


---

Comment by kcrisman created at 2011-01-12 19:55:49

Upon further reflection, I think that one would have to change a lot more of the doctests where `x` is used.  This is because even though changing things so that they use `SR['x']` instead of `SR[x]` is good, the same potential for confusion remains.   The very first example in the patch provides the opportunity for this:

```
sage: R = SR['x']
sage: f = R([1/sqrt(2), 1/(4*sqrt(2))])
sage: f
1/8*sqrt(2)*x + 1/2*sqrt(2)
sage: type(f)
<class 'sage.rings.polynomial.polynomial_element_generic.Polynomial_generic_dense_field'>
sage: type(1/8*sqrt(2)*x + 1/2*sqrt(2))
<type 'sage.symbolic.expression.Expression'>
sage: type(x)
<type 'sage.symbolic.expression.Expression'>
sage: type(R.gen())
<class 'sage.rings.polynomial.polynomial_element_generic.Polynomial_generic_dense_field'>
```

I don't think we want to actually prohibit this - x is so conventional - but the doctests should all definitely be changed so that some variable other than the _one default variable actually pre-defined by Sage_ is used with polynomial rings!  And we might want to put more warnings about this in the polynomial ring generator docs anyway.  Not to mention the tutorial :)

So putting 'needs info' until we think about what the best course of action is.  But I don't want to just change these doctests, because it hides the real ambiguity, since 'x' is predefined as a variable when Sage initializes - which it should.


---

Comment by SimonKing created at 2011-05-28 09:14:55

--bump--

Any new info in the last 5 months?


---

Comment by rws created at 2014-01-29 06:45:11

Pardon my naivete, why not recreate the symbol as ring element (and discard the symbol) when the user, by using it in a polynomial context, expects it to behave as one?


---

Comment by nbruin created at 2014-01-29 07:13:23

Replying to [comment:11 rws]:
> Pardon my naivete, why not recreate the symbol as ring element (and discard the symbol) when the user, by using it in a polynomial context, expects it to behave as one?

The following two invocations cannot be distinguished by the code implementing polynomial ring constructions:

```
x,y,z=var('x,y,z'); R = Q[x,y,z]
```


```
R = Q[ SR('x'), SR('y'), SR('z')]
```

Hopefully you'll agree that in the second case there is no justification to try and reach into the global scope to rebind python names that happen to print as the corresponding strings `'x','y','z'`.

But thanks for bumping this ticket. Can we merge it?


---

Comment by kcrisman created at 2014-01-29 16:16:45

Like I said above (3 years ago?  wow), it would be best to think about making the default examples for polynomial rings not use x, since that is indeed already defined system-wide, and changing the examples to use the string won't help the confusion.  But I have no objection to the change in principle, just the potential for continuing confusion.


---

Comment by jdemeyer created at 2014-01-29 16:25:07

I also agree with the patch in principle, except I would use `str()` instead of `repr()`.


---

Comment by kcrisman created at 2014-11-14 21:00:48

I tried to rebase this but had some trouble, possibly because of user error.


---

Comment by rws created at 2014-11-25 15:29:26

Changing status from needs_info to needs_work.


---

Comment by rws created at 2014-11-25 15:29:26

Needed a bit of manual merging. Please review.
----
New commits:


---

Comment by rws created at 2014-11-25 15:29:47

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-11-25 16:17:25

Surely, all those `.orig` files are a mistake?


---

Comment by jdemeyer created at 2014-11-25 16:17:25

Changing status from needs_review to needs_work.


---

Comment by rws created at 2014-11-26 08:01:51

Replying to [comment:22 jdemeyer]:
> Surely, all those `.orig` files are a mistake?
Removed.
----
New commits:


---

Comment by rws created at 2014-11-26 08:01:51

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-11-26 13:39:02

In various places in the library files, you manually call `R[repr(x)]` or `R[str(x)]`. Is that really needed? Maybe in some cases it is justified, but you need to convince me.

Then some details:

```
x, y = 'x', 'y'
```

is confusing, just use `'x'` and `'y'` instead of `x` and `y`.

Replace

```
R = PolynomialRing(GF(2)['x'])
```

by

```
R = PolynomialRing(GF(2), 'x')
```


Change

```
from sage.misc.misc import deprecation
...
if do_something_deprecated():
    deprecation(..)
```

to

```
...
if do_something_deprecated():
    from sage.misc.misc import deprecation
    deprecation(..)
```



---

Comment by jdemeyer created at 2014-11-26 13:39:08

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-11-26 13:40:43

Also replace

```
R.<x> = ZZ[x]
```

by

```
R.<x> = ZZ[]
```



---

Comment by git created at 2014-11-26 17:39:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-11-26 17:40:33

Replying to [comment:26 jdemeyer]:
> In various places in the library files, you manually call `R[repr(x)]` or `R[str(x)]`. Is that really needed? Maybe in some cases it is justified, but you need to convince me.
Can you please give an example?


---

Comment by rws created at 2014-11-26 17:40:33

Changing status from needs_work to needs_review.


---

Comment by nbruin created at 2014-11-26 18:45:09

This example:

```
sage: R.<xx> = QuotientRing(QQ['x'], QQ['x'].ideal(x^2 + 1)); R
```

is still referring to a wild `x` for the ideal generator. The meaning of this code really depends on what `x` happens to be bound to before. I don't see another way than to write this code in multiple steps:

```
sage: P.<x> = QQ[]; R.<xx> = QuotientRing(P, P.ideal(x^2 + 1)); R
```

In fact, if you put that on one line, it's hardly longer anyway. It might be better style to split it, though.

For jdemeyer's comments: search for "str(" in the git diff view. Your uses looked probable at first glance, but you might want to check the context.


---

Comment by jdemeyer created at 2014-11-26 19:12:17

Replying to [comment:30 rws]:
> Can you please give an example?

```
R = ZZ_q[x if isinstance(x,basestring) else str(x)].quotient(quotient, x if isinstance(x,basestring) else str(x))
```



---

Comment by jdemeyer created at 2014-11-26 19:14:03

Replying to [comment:31 nbruin]:
> This example:
> {{{
> sage: R.<xx> = QuotientRing(QQ['x'], QQ['x'].ideal(x^2 + 1)); R
> }}}
> is still referring to a wild `x` for the ideal generator. The meaning of this code really depends on what `x` happens to be bound to before. I don't see another way than to write this code in multiple steps:
> {{{
> sage: P.<x> = QQ[]; R.<xx> = QuotientRing(P, P.ideal(x^2 + 1)); R
> }}}
> In fact, if you put that on one line, it's hardly longer anyway. It might be better style to split it, though.
Yes, please split it:

```
sage: P.<x> = QQ[]
sage: R.<xx> = QuotientRing(P, P.ideal(x^2 + 1))
sage: R
```



---

Comment by jdemeyer created at 2014-11-26 19:14:03

Changing status from needs_review to needs_work.


---

Comment by rws created at 2014-11-27 08:15:47

Replying to [comment:32 jdemeyer]:
> Replying to [comment:30 rws]:
> > Can you please give an example?
> {{{
> R = ZZ_q[x if isinstance(x,basestring) else str(x)].quotient(quotient, x if isinstance(x,basestring) else str(x))
> }}}
Well, it seems I cannot remove the `str` here, but reducing to `R = ZZ_q[str(x)].quotient(quotient, str(x))` is possible, as `x` is of type `Expression`.


---

Comment by jdemeyer created at 2014-11-27 10:08:28

Replying to [comment:34 rws]:
> Well, it seems I cannot remove the `str` here, but reducing to `R = ZZ_q[str(x)].quotient(quotient, str(x))` is possible, as `x` is of type `Expression`.
The fact that `quotient` should be of type `Expression` is a bug in itself. Instead of working around this bug, it should instead be fixed: #17406


---

Comment by jdemeyer created at 2014-11-27 10:38:39

I moved all the non-controversial doctest fixes to #17407, so we can concentrate here on the harder stuff.
----
New commits:


---

Comment by git created at 2014-11-27 11:33:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-11-27 11:34:51

There are still several doctest failures and some dubious uses of `str()`.


---

Comment by git created at 2014-11-27 13:46:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-11-27 13:49:57

Why do you change from public to private branch?
----
New commits:
|                                                                                                                                          |                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
|[47b6617](http://git.sagemath.org/sage.git/commit/?id=47b661781130e523b12fb93d7f8e1f2833d4b975)|`Merge branch 'public/17407' of trac.sagemath.org:sage into t/10483/ticket/10483`|
|[75e2a04](http://git.sagemath.org/sage.git/commit/?id=75e2a04227770247968a88f5fd9172d543710fba)|`10483: more fixes`|
Making `ptestlong` now...


---

Comment by jdemeyer created at 2014-11-27 15:04:50

Replying to [comment:43 rws]:
> Why do you change from public to private branch?
Because that's what happens by default when using the `./sage --dev` scripts.


---

Comment by git created at 2014-11-27 16:21:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-11-27 16:51:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-11-27 16:54:18

At this point nontrivial fails in the following files remain:

```
sage -t --long src/doc/en/constructions/calculus.rst  # 1 doctest failed
sage -t --long src/sage/algebras/commutative_dga.py  # 7 doctests failed
sage -t --long src/sage/coding/linear_code.py  # 1 doctest failed
sage -t --long src/sage/combinat/ncsf_qsym/qsym.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/root_lattice_realization_algebras.py  # 1 doctest failed
sage -t --long src/sage/combinat/subset.py  # 1 doctest failed
sage -t --long src/sage/doctest/forker.py  # 1 doctest failed
sage -t --long src/sage/functions/piecewise.py  # 2 doctests failed
sage -t --long src/sage/libs/singular/groebner_strategy.pyx  # 1 doctest failed
sage -t --long src/sage/modular/modform_hecketriangle/abstract_ring.py  # 1 doctest failed
sage -t --long src/sage/rings/ideal.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # 5 doctests failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/plural.pyx  # 5 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_element.pyx  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/polynomial_ring_constructor.py  # 2 doctests failed
sage -t --long src/sage/rings/quotient_ring.py  # 3 doctests failed
sage -t --long src/sage/rings/ring.pyx  # 1 doctest failed
sage -t --long src/sage/schemes/affine/affine_morphism.py  # 9 doctests failed
sage -t --long src/sage/schemes/affine/affine_point.py  # 4 doctests failed
sage -t --long src/sage/schemes/generic/algebraic_scheme.py  # 1 doctest failed
sage -t --long src/sage/schemes/product_projective/space.py  # 3 doctests failed
sage -t --long src/sage/schemes/projective/projective_morphism.py  # 9 doctests failed
sage -t --long src/sage/schemes/projective/projective_point.py  # 2 doctests failed
sage -t --long src/sage/structure/misc.pyx  # 1 doctest failed
sage -t --long src/sage/structure/parent_gens.pyx  # 1 doctest failed
sage -t --long src/sage/symbolic/expression_conversions.py  # 1 doctest failed
sage -t --long src/sage/symbolic/relation.py  # 3 doctests failed
```



---

Comment by rws created at 2014-11-27 17:03:38

Replying to [comment:44 jdemeyer]:
> Replying to [comment:43 rws]:
> > Why do you change from public to private branch?
> Because that's what happens by default when using the `./sage --dev` scripts.
With `git trac` the default is to push to the branch you downloaded from.

Regarding that TODO list above, I completely underestimated what had amassed since Simon uploaded the patch. I will do work on `rings/` next.


---

Comment by git created at 2014-11-28 17:02:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-11-29 14:34:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-11-29 14:37:43

Changing status from needs_work to needs_review.


---

Comment by rws created at 2014-11-29 14:37:43

There is still one fail that is unrelated and pops up only in bulk testing. As this is in a Cython file, I have some problems to resolve it. Can you help please?

```
File "src/sage/structure/misc.pyx", line 81, in sage.structure.misc.AttributeEr
rorMessage
Failed example:
    isinstance(ElementError.message, sage.structure.misc.AttributeErrorMessage)
Expected:
    True
Got:
    doctest:1: DeprecationWarning: BaseException.message has been deprecated as
 of Python 2.6
    True
```



---

Comment by jdemeyer created at 2014-11-30 08:29:24

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-11-30 08:29:24


```
sage -t --long src/sage/tests/french_book/mpoly.py
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 273, in sage.tests.french_book.mpoly
Failed example:
    fig = add((eq(t=k/5)*QQ[x,y]).plot() for k in (-15..15))
Expected nothing
Got:
    doctest:867: DeprecationWarning: Variable name 'x' should be a string, but we obtained <type 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
    doctest:867: DeprecationWarning: Variable name 'y' should be a string, but we obtained <type 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
1 item had failures:
   1 of 148 in sage.tests.french_book.mpoly
    [147 tests, 1 failure, 6.33 s]
sage -t --long src/sage/tests/french_book/polynomes.py
**********************************************************************
File "src/sage/tests/french_book/polynomes.py", line 51, in sage.tests.french_book.polynomes
Failed example:
    x = polygen(QQ); y = polygen(QQ[x], 'y')
Expected nothing
Got:
    doctest:867: DeprecationWarning: Variable name 'x' should be a string, but we obtained <type 'sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
1 item had failures:
   1 of 108 in sage.tests.french_book.polynomes
    [107 tests, 1 failure, 1.13 s]
sage -t --long src/sage/structure/misc.pyx
**********************************************************************
File "src/sage/structure/misc.pyx", line 81, in sage.structure.misc.AttributeErrorMessage
Failed example:
    isinstance(ElementError.message, sage.structure.misc.AttributeErrorMessage)
Expected:
    True
Got:
    doctest:1: DeprecationWarning: BaseException.message has been deprecated as of Python 2.6
    True
**********************************************************************
1 item had failures:
   1 of  17 in sage.structure.misc.AttributeErrorMessage
    [52 tests, 1 failure, 1.67 s]
sage -t --long src/sage/modules/free_module_element.pyx
**********************************************************************
File "src/sage/modules/free_module_element.pyx", line 2479, in sage.modules.free_module_element.FreeModuleElement.pairwise_product
Failed example:
    parent(vector(ZZ[x],[1,2,3,4]).pairwise_product(vector(QQ,[1,2,3,4])))
Expected:
    Ambient free module of rank 4 over the principal ideal domain Univariate Polynomial Ring in x over Rational Field
Got:
    doctest:867: DeprecationWarning: Variable name 'x' should be a string, but we obtained <type 'sage.symbolic.expression.Expression'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
    Ambient free module of rank 4 over the principal ideal domain Univariate Polynomial Ring in x over Rational Field
**********************************************************************
File "src/sage/modules/free_module_element.pyx", line 2486, in sage.modules.free_module_element.FreeModuleElement.pairwise_product
Failed example:
    parent(vector(ZZ[x][y],[1,2,3,4]).pairwise_product(vector(QQ,[1,2,3,4])))
Expected:
    Ambient free module of rank 4 over the integral domain Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
Got:
    doctest:867: DeprecationWarning: Variable name 'y' should be a string, but we obtained <type 'sage.symbolic.expression.Expression'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
    Ambient free module of rank 4 over the integral domain Univariate Polynomial Ring in y over Univariate Polynomial Ring in x over Rational Field
**********************************************************************
1 item had failures:
   2 of  32 in sage.modules.free_module_element.FreeModuleElement.pairwise_product
    [873 tests, 2 failures, 4.50 s]
sage -t --long src/sage/misc/latex.py
**********************************************************************
File "src/sage/misc/latex.py", line 1901, in sage.misc.latex.MathJax.__call__
Failed example:
    str(MathJax().eval(ZZ[x], mode='display')) == str(MathJax()(ZZ[x]))
Expected:
    True
Got:
    doctest:867: DeprecationWarning: Variable name 'x' should be a string, but we obtained <type 'sage.symbolic.expression.Expression'>.
    In an interactive session, you should use a definition of the form 'R.<x,y,z>=QQ[]'.
    See http://trac.sagemath.org/10483 for details.
    True
**********************************************************************
```



---

Comment by jdemeyer created at 2014-11-30 08:38:11

I might work more on this ticket, but not before #17406 and #17407 are merged.


---

Comment by jdemeyer created at 2014-11-30 08:48:05

Note that my repeated comments about the adding of `str()` have not yet been addressed.

Ideally, this patch would only deal with the deprecation of `ZZ[x]` and not with adding `str()` in so many places. In the one case I looked at, the fact that `str()` was needed was clearly a bug, and that's now #17406. For the other places where you are adding `str()`, you should also check whether the adding of `str()` is hiding a bug.


---

Comment by jdemeyer created at 2014-11-30 08:53:24

To be clear: I'm not against adding `str()`, I am against adding of `str()` without justification.


---

Comment by rws created at 2014-11-30 10:01:14

Replying to [comment:56 jdemeyer]:
> To be clear: I'm not against adding `str()`, I am against adding of `str()` without justification.
OK, you are right. For example, the case in `coding/linear_code.py(3004)` where the preconditions to `weight_enumerator()` state ```name2`` - string or symbolic variable`. Do we change the precondition to `string` instead of converting everything?


---

Comment by jdemeyer created at 2014-11-30 10:50:09

Replying to [comment:57 rws]:
> Do we change the precondition to `string` instead of converting everything?
Yes, that's indeed the right thing to do. It's much more in the spirit of this ticket.


---

Comment by git created at 2014-11-30 16:46:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-11-30 21:16:50

What's with all the spacing changes in `src/sage/rings/polynomial/plural.pyx`? Please don't do that. It's fine to do a few corrections nearby edits that you're making anyway, but changing a whole file for no reason isn't right.


---

Comment by jdemeyer created at 2014-11-30 21:17:38

And like I said on #17407, I would keep the doctests for the `french_book` and just add the deprecation message.


---

Comment by git created at 2014-12-01 08:38:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-01-15 07:44:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-01-15 07:45:19

Changing status from needs_work to needs_review.


---

Comment by git created at 2017-02-20 08:14:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-03-21 08:57:25

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-03-21 08:57:25

Patchbot is not happy.


---

Comment by jdemeyer created at 2017-03-21 08:58:09

Also, there are some unintended files added. In order to clean up this mess, please squash and rebase.


---

Comment by rws created at 2017-04-10 07:24:53

New commits:


---

Comment by rws created at 2017-04-10 07:24:53

Changing status from needs_work to needs_review.


---

Comment by git created at 2017-04-13 06:44:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-06-26 15:14:51

New commits:


---

Comment by jdemeyer created at 2017-06-26 15:15:15

Merged latest beta.


---

Comment by jdemeyer created at 2017-06-26 15:22:38

See [comment:26] and [comment:55]


---

Comment by jdemeyer created at 2017-06-26 15:22:38

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-06-26 15:23:59

The very first file in the diff already has this problem:

```diff
diff --git a/src/sage/categories/rings.py b/src/sage/categories/rings.py
index 72c253a..27625b8 100644
--- a/src/sage/categories/rings.py
+++ b/src/sage/categories/rings.py
             # 2. Otherwise, try to return a polynomial ring
 
             from sage.rings.polynomial.polynomial_ring_constructor import PolynomialRing
-            return PolynomialRing(self, elts)
+            return PolynomialRing(self, list(str(elt) for elt in elts))
```



---

Comment by git created at 2017-06-27 15:32:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-06-27 15:36:30

My that was long ago. This commit is part of upcoming fixes, which leaves cfinite_sequence.py (much work, separate ticket if you insist on removing `str()`), rings/polynomial/flatten.py where I have no idea how to fix, and symbolic/expression.pyx (tomorrow).


---

Comment by jdemeyer created at 2017-06-28 10:37:45

In `src/sage/coding/linear_code.py`, I don't see why you have an explicit check. I would remove that and just let `PolynomialRing()` raise the exception.


---

Comment by jdemeyer created at 2017-06-28 10:40:54

Note that `basestring` does not exist in Python 3: use `six.string_types` instead. In Cython code, `basestring` is fine.


---

Comment by jdemeyer created at 2017-06-28 11:22:06

The function `PolynomialRing()` is really messy. It does too much checking which really should be delegated to `normalize_names()`. I feel like it would be better to fix this first in a separate ticket. I'm willing to do this, but then this ticket would need to be rebased on that. I also think that the deprecation warning from this ticket should really be in `normalize_names()` then. Thoughts?


---

Comment by rws created at 2017-06-29 06:48:22

Replying to [comment:79 jdemeyer]:
> I feel like it would be better to fix this first in a separate ticket. I'm willing to do this, but then this ticket would need to be rebased on that.

NP. Please go ahead.


---

Comment by git created at 2017-06-29 08:31:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-06-29 08:32:51

I wouldn't want to change anything in symbolic, after some thought.


---

Comment by jdemeyer created at 2017-06-29 11:49:12

OK, please stop working on this ticket for now. I will make some changes and split one or two tickets from this one.


---

Comment by git created at 2017-06-29 11:54:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-06-29 12:03:58

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-06-29 12:18:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-06-29 12:19:21

First step: I moved some non-controversial changes to a new ticket #23337. Those changes can be applied independently.


---

Comment by jdemeyer created at 2017-06-29 12:22:27

I'm still working on this, but I already have some comments:

1. `src/sage/matrix/matrix2.pyx`: `cyclic_subspace` is explicitly documented to support variables as argument.

2. `src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py`: `smooth_critical_ideal` is explicitly documented to support variables as argument.


---

Comment by tscrim created at 2017-06-29 12:26:40

Replying to [comment:79 jdemeyer]:
> The function `PolynomialRing()` is really messy. It does too much checking which really should be delegated to `normalize_names()`. I feel like it would be better to fix this first in a separate ticket. I'm willing to do this, but then this ticket would need to be rebased on that. I also think that the deprecation warning from this ticket should really be in `normalize_names()` then. Thoughts?

From a somewhat quick look, it doesn't seem like it is doing so much what `normalize_names()` is doing. Yes, some of it is there, but it also needs to know of what the input is before proceeding. So I don't see as good of a utility for `normalize_names()`. However, I am willing to review any such ticket.


---

Comment by jdemeyer created at 2017-06-29 12:43:44

Replying to [comment:89 tscrim]:
> From a somewhat quick look, it doesn't seem like it is doing so much what `normalize_names()` is doing. Yes, some of it is there, but it also needs to know of what the input is before proceeding. So I don't see as good of a utility for `normalize_names()`. However, I am willing to review any such ticket.

It's not just `normalize_names()`. It needs to be cleaned up in many ways. I opened #23338 and I'm working on that right now.


---

Comment by jdemeyer created at 2017-06-29 15:32:38

After working on #23338 a bit, it seems that the `PolynomialRing()` constructor itself would not need to be changed in this ticket. I am using `normalize_names()` to deal with parsing the variable names. So this ticket would need to change `normalize_names()` instead of `PolynomialRing()`.


---

Comment by git created at 2017-06-30 09:04:59

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-07-06 08:21:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-07-06 08:24:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-07-06 08:33:42

New commits:


---

Comment by git created at 2017-08-18 08:06:59

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-08-18 08:07:52

Rebased on top of #23377. This still needs work though, there are various failing doctests.


---

Comment by jdemeyer created at 2017-08-18 08:13:24

All doctest failures in `src/sage/rings`:

```
sage -t src/sage/rings/qqbar.py
**********************************************************************
File "src/sage/rings/qqbar.py", line 3827, in sage.rings.qqbar.AlgebraicNumber_base.radical_expression
Failed example:
    a = QQ[x](x^7 - x - 1).roots(AA, False)[0]
Expected nothing
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.qqbar.AlgebraicNumber_base.radical_expression[3]>", line 1, in <module>
        a = QQ[x](x**Integer(7) - x - Integer(1)).roots(AA, False)[Integer(0)]
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/categories/rings.py", line 1075, in __getitem__
        return PolynomialRing(self, elts)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
1 item had failures:
   1 of  19 in sage.rings.qqbar.AlgebraicNumber_base.radical_expression
    [1395 tests, 1 failure, 10.66 s]
sage -t src/sage/rings/cfinite_sequence.py
**********************************************************************
File "src/sage/rings/cfinite_sequence.py", line 17, in sage.rings.cfinite_sequence
Failed example:
    fibo = CFiniteSequence(x/(1-x-x^2))        # the Fibonacci sequence
Expected nothing
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.cfinite_sequence[0]>", line 1, in <module>
        fibo = CFiniteSequence(x/(Integer(1)-x-x**Integer(2)))        # the Fibonacci sequence
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 329, in __classcall_private__
        parent = CFiniteSequences(QQ, variables)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 170, in CFiniteSequences
        return CFiniteSequences_generic(polynomial_ring, category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1021, in __classcall__
        instance = typecall(cls, *args, **options)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 933, in __init__
        CommutativeRing.__init__(self,base_ring, self._polynomial_ring.gens(), category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint'>
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
File "src/sage/rings/cfinite_sequence.py", line 35, in sage.rings.cfinite_sequence
Failed example:
    CFiniteSequence(y/(1-y-y^2))
Expected:
    C-finite sequence, generated by y/(-y^2 - y + 1)
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.cfinite_sequence[10]>", line 1, in <module>
        CFiniteSequence(y/(Integer(1)-y-y**Integer(2)))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 329, in __classcall_private__
        parent = CFiniteSequences(QQ, variables)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 170, in CFiniteSequences
        return CFiniteSequences_generic(polynomial_ring, category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1021, in __classcall__
        instance = typecall(cls, *args, **options)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 933, in __init__
        CommutativeRing.__init__(self,base_ring, self._polynomial_ring.gens(), category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name y should be a string, not <type 'sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint'>
    See http://trac.sagemath.org/10483 for details.
    C-finite sequence, generated by y/(-y^2 - y + 1)
**********************************************************************
File "src/sage/rings/cfinite_sequence.py", line 212, in sage.rings.cfinite_sequence.CFiniteSequence
Failed example:
    CFiniteSequence(1/(1-X))
Expected:
    C-finite sequence, generated by 1/(-X + 1)
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.cfinite_sequence.CFiniteSequence[8]>", line 1, in <module>
        CFiniteSequence(Integer(1)/(Integer(1)-X))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 329, in __classcall_private__
        parent = CFiniteSequences(QQ, variables)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 170, in CFiniteSequences
        return CFiniteSequences_generic(polynomial_ring, category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1021, in __classcall__
        instance = typecall(cls, *args, **options)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 933, in __init__
        CommutativeRing.__init__(self,base_ring, self._polynomial_ring.gens(), category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name X should be a string, not <type 'sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint'>
    See http://trac.sagemath.org/10483 for details.
    C-finite sequence, generated by 1/(-X + 1)
**********************************************************************
File "src/sage/rings/cfinite_sequence.py", line 919, in sage.rings.cfinite_sequence.CFiniteSequences_generic.__init__
Failed example:
    C.<x> = CFiniteSequences(ZZ); C
Expected:
    The ring of C-Finite sequences in x over Integer Ring
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.cfinite_sequence.CFiniteSequences_generic.__init__[2]>", line 1, in <module>
        C = CFiniteSequences(ZZ, names=('x',)); (x,) = C._first_ngens(1); C
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 170, in CFiniteSequences
        return CFiniteSequences_generic(polynomial_ring, category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1021, in __classcall__
        instance = typecall(cls, *args, **options)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/cfinite_sequence.py", line 933, in __init__
        CommutativeRing.__init__(self,base_ring, self._polynomial_ring.gens(), category)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>
    See http://trac.sagemath.org/10483 for details.
    The ring of C-Finite sequences in x over Integer Ring
**********************************************************************
File "src/sage/rings/cfinite_sequence.py", line 1104, in sage.rings.cfinite_sequence.CFiniteSequences_generic._coerce_map_from_
Failed example:
    C.has_coerce_map_from(QQ[x])
Expected:
    True
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.cfinite_sequence.CFiniteSequences_generic._coerce_map_from_[3]>", line 1, in <module>
        C.has_coerce_map_from(QQ[x])
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/categories/rings.py", line 1075, in __getitem__
        return PolynomialRing(self, elts)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint'>
    See http://trac.sagemath.org/10483 for details.
    True
**********************************************************************
4 items had failures:
   2 of  21 in sage.rings.cfinite_sequence
   1 of  24 in sage.rings.cfinite_sequence.CFiniteSequence
   1 of   6 in sage.rings.cfinite_sequence.CFiniteSequences_generic.__init__
   1 of   6 in sage.rings.cfinite_sequence.CFiniteSequences_generic._coerce_map_from_
    [257 tests, 5 failures, 2.66 s]
sage -t src/sage/rings/polynomial/polynomial_ring.py
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring.py", line 397, in sage.rings.polynomial.polynomial_ring.PolynomialRing_general.?
Failed example:
    QQbar[x](x^6+x^5+x^4-x^3+x^2-x+2/5)
Expected:
    x^6 + x^5 + x^4 - x^3 + x^2 - x + 2/5
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_ring.PolynomialRing_general.?[33]>", line 1, in <module>
        QQbar[x](x**Integer(6)+x**Integer(5)+x**Integer(4)-x**Integer(3)+x**Integer(2)-x+Integer(2)/Integer(5))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/categories/rings.py", line 1075, in __getitem__
        return PolynomialRing(self, elts)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
    x^6 + x^5 + x^4 - x^3 + x^2 - x + 2/5
**********************************************************************
1 item had failures:
   1 of  35 in sage.rings.polynomial.polynomial_ring.PolynomialRing_general.?
    [416 tests, 1 failure, 1.94 s]
sage -t src/sage/rings/multi_power_series_ring_element.py
**********************************************************************
File "src/sage/rings/multi_power_series_ring_element.py", line 1041, in sage.rings.multi_power_series_ring_element.MPowerSeries._l_action_
Failed example:
    g = f._l_action_(1/2); g
Expected:
    1/2 + 1/2*s + 1/2*t + 1/2*s*t + O(s, t)^3
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.multi_power_series_ring_element.MPowerSeries._l_action_[2]>", line 1, in <module>
        g = f._l_action_(Integer(1)/Integer(2)); g
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/multi_power_series_ring_element.py", line 1062, in _l_action_
        new_parent = PowerSeriesRing(f.base_ring().base_ring(), num_gens = f.base_ring().ngens(), names = f.base_ring().gens())
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/power_series_ring.py", line 338, in PowerSeriesRing
        order=order, default_prec=default_prec, sparse=sparse)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/power_series_ring.py", line 418, in _multi_variate
        names = normalize_names(num_gens, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name s should be a string, not <type 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular'>
    See http://trac.sagemath.org/10483 for details.
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.multi_power_series_ring_element.MPowerSeries._l_action_[2]>", line 1, in <module>
        g = f._l_action_(Integer(1)/Integer(2)); g
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/multi_power_series_ring_element.py", line 1062, in _l_action_
        new_parent = PowerSeriesRing(f.base_ring().base_ring(), num_gens = f.base_ring().ngens(), names = f.base_ring().gens())
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/power_series_ring.py", line 338, in PowerSeriesRing
        order=order, default_prec=default_prec, sparse=sparse)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/power_series_ring.py", line 418, in _multi_variate
        names = normalize_names(num_gens, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name t should be a string, not <type 'sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular'>
    See http://trac.sagemath.org/10483 for details.
    1/2 + 1/2*s + 1/2*t + 1/2*s*t + O(s, t)^3
**********************************************************************
1 item had failures:
   1 of  10 in sage.rings.multi_power_series_ring_element.MPowerSeries._l_action_
    [456 tests, 1 failure, 1.26 s]
sage -t src/sage/rings/polynomial/polynomial_ring_constructor.py
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring_constructor.py", line 400, in sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing
Failed example:
    PolynomialRing(ZZ, [x, singular])
Expected:
    Multivariate Polynomial Ring in x, Singular over Integer Ring
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing[62]>", line 1, in <module>
        PolynomialRing(ZZ, [x, singular])
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing[62]>", line 1, in <module>
        PolynomialRing(ZZ, [x, singular])
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name Singular should be a string, not <class 'sage.interfaces.singular.Singular'>
    See http://trac.sagemath.org/10483 for details.
    Multivariate Polynomial Ring in x, Singular over Integer Ring
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring_constructor.py", line 405, in sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing
Failed example:
    B = PolynomialRing(ZZ, name=t)
Expected nothing
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing[65]>", line 1, in <module>
        B = PolynomialRing(ZZ, name=t)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 583, in PolynomialRing
        names = normalize_names(n, names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name t should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
1 item had failures:
   2 of  93 in sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing
    [116 tests, 2 failures, 0.54 s]
sage -t src/sage/rings/multi_power_series_ring.py
**********************************************************************
File "src/sage/rings/multi_power_series_ring.py", line 730, in sage.rings.multi_power_series_ring.MPowerSeriesRing_generic._coerce_map_from_
Failed example:
    M._coerce_map_from_(PowerSeriesRing(ZZ,x))
Expected:
    True
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.multi_power_series_ring.MPowerSeriesRing_generic._coerce_map_from_[12]>", line 1, in <module>
        M._coerce_map_from_(PowerSeriesRing(ZZ,x))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/power_series_ring.py", line 374, in PowerSeriesRing
        name = normalize_names(1, name)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
    True
**********************************************************************
1 item had failures:
   1 of  25 in sage.rings.multi_power_series_ring.MPowerSeriesRing_generic._coerce_map_from_
    [225 tests, 1 failure, 0.89 s]
sage -t src/sage/rings/quotient_ring.py
**********************************************************************
File "src/sage/rings/quotient_ring.py", line 283, in sage.rings.quotient_ring.QuotientRing
Failed example:
    Q = P.quotient(P*[a*b],[x,singular])
Expected:
    doctest:...: DeprecationWarning: Variable name 'x' should be a string, but we obtained <type 'sage.symbolic.expression.Expression'>.
    In an interactive session, you should use a definition of the form 'Q.<x,y,z>=R.quo(I)'.
    See http://trac.sagemath.org/10483 for details.
    ...
Got:
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.quotient_ring.QuotientRing[43]>", line 1, in <module>
        Q = P.quotient(P*[a*b],[x,singular])
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 307, in QuotientRing
        names = normalize_names(R.ngens(), names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name x should be a string, not <type 'sage.symbolic.expression.Expression'>
    See http://trac.sagemath.org/10483 for details.
    doctest:warning
      File "/usr/local/src/sage-config/src/bin/sage-runtests", line 98, in <module>
        err = DC.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1150, in run
        self.run_doctests()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/control.py", line 874, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1774, in dispatch
        self.parallel_dispatch()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1664, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1940, in start
        super(DocTestWorker, self).start()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/local/src/sage-config/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1913, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2215, in __call__
        result = runner.run(test)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 660, in run
        return self._run(test, compileflags, out)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.quotient_ring.QuotientRing[43]>", line 1, in <module>
        Q = P.quotient(P*[a*b],[x,singular])
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 307, in QuotientRing
        names = normalize_names(R.ngens(), names)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: variable name Singular should be a string, not <class 'sage.interfaces.singular.Singular'>
    See http://trac.sagemath.org/10483 for details.
**********************************************************************
1 item had failures:
   1 of  45 in sage.rings.quotient_ring.QuotientRing
    [284 tests, 1 failure, 0.87 s]
----------------------------------------------------------------------
sage -t src/sage/rings/qqbar.py  # 1 doctest failed
sage -t src/sage/rings/cfinite_sequence.py  # 5 doctests failed
sage -t src/sage/rings/polynomial/polynomial_ring.py  # 1 doctest failed
sage -t src/sage/rings/multi_power_series_ring_element.py  # 1 doctest failed
sage -t src/sage/rings/polynomial/polynomial_ring_constructor.py  # 2 doctests failed
sage -t src/sage/rings/multi_power_series_ring.py  # 1 doctest failed
sage -t src/sage/rings/quotient_ring.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by jdemeyer created at 2017-08-18 08:20:01

As discussed in some other ticket (I don't remember which), I want to require that names are of type `str`, as opposed to `six.string_types` which would include `unicode` in Python 2. This is mainly to keep the code simpler and because I see no advantage to allowing both `str` and `unicode` on Python 2.


---

Comment by git created at 2017-08-18 08:48:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-08-18 08:57:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-08-18 09:08:35

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-08-18 09:10:20

Since the deprecation has now moved to `normalize_names`, I removed the added doctests in `linear_code.py` and `quotient_ring.py` which test the deprecation.


---

Comment by git created at 2017-08-18 09:16:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-08-18 09:17:48

New commits:


---

Comment by jdemeyer created at 2017-08-18 09:26:02

I'm going to leave this ticket be for now. So, if other people want to fix things, please go ahead.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
