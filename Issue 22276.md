# Issue 22276: package polymake beta

Issue created by migration from https://trac.sagemath.org/ticket/22513

Original creator: moritz

Original creation time: 2017-03-04 10:58:32

CC:  vdelecroix mkoeppe

Keywords: days84, polymake

With my configuration, the configure script of polymake 3.0 is not working, probably due to a new version of perl:


```
$ ./configure 
checking C++ compiler ... ok (g++ is GCC 6.3.0)
checking C++ library ... ok (GNU stdlibc++ 20170218, C++ 201402)
determining architecture ... Undefined subroutine &Polymake::Configure::platform_name called at support/configure.pl line 538.
```


Let's package the beta version of polymake.


---

Comment by moritz created at 2017-03-05 09:36:00

The tar ball, which should be put in the folder `upstream` can be found here: [http://page.mi.fu-berlin.de/moritz/pkgs/polymake-3.1-beta2.tar.bz2](http://page.mi.fu-berlin.de/moritz/pkgs/polymake-3.1-beta2.tar.bz2)


---

Comment by mkoeppe created at 2017-03-05 10:54:41

Before you deleted the branch, I pulled it and built successfully on Mac OS.


---

Comment by moritz created at 2017-03-05 10:58:19

New commits:


---

Comment by moritz created at 2017-03-05 11:12:53

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2017-03-05 11:14:15

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2017-03-05 11:58:56

This package *completely* breaks pypolymake. Don't you want to make a different package?


---

Comment by vdelecroix created at 2017-03-05 12:04:45

Moreover, it is not nice to package yourself upstream. I pushed Moritz to make this package for testing purposes. I am very much against its inclusion in Sage.


---

Comment by mkoeppe created at 2017-03-05 12:43:35

Changing status from positive_review to needs_work.


---

Comment by mkoeppe created at 2017-03-05 12:43:35

OK, I agree


---

Comment by mkoeppe created at 2017-03-05 15:54:23

Also, the Singular build seems to fail with this beta version of polymake installed.


---

Comment by vdelecroix created at 2017-03-07 09:00:11

Replying to [comment:11 mkoeppe]:
> Also, the Singular build seems to fail with this beta version of polymake installed.

For the record, this can be fixed with

```diff
diff --git a/build/pkgs/singular/spkg-install b/build/pkgs/singular/spkg-install
index 373bd0852b..b172b0ec1f 100755
--- a/build/pkgs/singular/spkg-install
+++ b/build/pkgs/singular/spkg-install
@@ -93,6 +93,7 @@ config()
                 --with-ntl="$SAGE_LOCAL" \
                 --with-flint="$SAGE_LOCAL" \
                 --enable-gfanlib \
+                --disable-polymake \
                 --enable-Singular \
                 --enable-factory \
                 --disable-doc \
```



---

Comment by mkoeppe created at 2017-03-28 17:02:45

(this fix to Singular is #22606.)


---

Comment by mkoeppe created at 2017-03-28 17:18:21

This new version also breaks #22683. Apparently polymake has changed its mind about some important properties:

```
    TypeError: initial check failed: dimension mismatch between LINEALITY_SPACE and CONE_AMBIENT_DIM
```



---

Comment by mkoeppe created at 2017-03-28 17:23:00

Polymake 3.1 was just released. We should repurpose this ticket for the upgrade.

Vincent -- objections to upgrading (if it builds OK) even if pypolymake is not ready yet for that version?


---

Comment by mkoeppe created at 2017-03-28 18:57:08

A possible upstream issue: 
[Polymake 3.1: Empty polytope has dimension 1](https://forum.polymake.org/viewtopic.php?f=8&t=545)


---

Comment by mkoeppe created at 2017-03-29 02:47:15

Replying to [comment:19 mkoeppe]:
> A possible upstream issue: 
> [Polymake 3.1: Empty polytope has dimension 1](https://forum.polymake.org/viewtopic.php?f=8&t=545)

It was easy to work around this in #22658.
----
New commits:


---

Comment by mkoeppe created at 2017-03-29 02:47:57

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2017-03-29 09:41:41

Simon worked well: all tests of the interface (#22452) pass with this new version of polymake!


---

Comment by vdelecroix created at 2017-03-29 09:43:45

(hopefully the beta branch of pypolymake should be close to be working with polymake 3.1)


---

Comment by vdelecroix created at 2017-03-29 09:43:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-03-30 22:34:46

Resolution: fixed
