# Issue 10477: De Bruijn Sequence construction for combinat

archive/issues_010477.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat tmonteil\n\nI have written an implementation of De Bruijn sequences for combinat. It can currently generate one sequence for an alphabet (or arity) and substring length. It can also calculate cardinality.\n\nIssue created by migration from https://trac.sagemath.org/ticket/10530\n\n",
    "created_at": "2010-12-29T02:58:33Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "De Bruijn Sequence construction for combinat",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10477",
    "user": "https://github.com/eviatarbach"
}
```
Assignee: sage-combinat

CC:  sage-combinat tmonteil

I have written an implementation of De Bruijn sequences for combinat. It can currently generate one sequence for an alphabet (or arity) and substring length. It can also calculate cardinality.

Issue created by migration from https://trac.sagemath.org/ticket/10530





---

archive/issue_comments_108875.json:
```json
{
    "body": "Attachment [15057.patch](tarball://root/attachments/some-uuid/ticket10530/15057.patch) by @eviatarbach created at 2010-12-29 03:26:50",
    "created_at": "2010-12-29T03:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108875",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [15057.patch](tarball://root/attachments/some-uuid/ticket10530/15057.patch) by @eviatarbach created at 2010-12-29 03:26:50



---

archive/issue_comments_108876.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-29T03:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108876",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_108877.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-12-29T22:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108877",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_108878.json:
```json
{
    "body": "Hi!\n\nI just had a quick look at your patch. This sounds good!\n\nA couple micro comments (before an actual review):\n\n- CombinatorialClass is deprecated. Please use the\n  FiniteEnumeratedSets category. For an example, see:\n\n      sage: C = FiniteEnumeratedSets().example()\n      sage: C??\n      File:\t\t/opt/sage/local/lib/python2.6/site-packages/sage/categories/examples/finite_enumerated_sets.py\n\n  (sorry, we still have a lot of old code giving bad hints to the\n  newcomers)\n\n- What about just implementing _an_element_? (no __iter__, no first).\n\n  Actually at this point DeBruijnSequences(alphabet, n) should just\n  be in the category FiniteSets(). However the later does not exist\n  yet, so Sets() will do.\n\n- Rather than defining an attribute self.k_is_alphabet, I would setup\n  two attributes self.k and self.alphabet once for all in the\n  __init__. Then no more branching needs to be done later on.\n\n  Maybe rename the parameter k to alphabet (which is more explicit)\n\n- DeBruijnSequence_evaluation -> DeBruijnSequences\n\n  No need for the DeBruijnSequence function at this point.\n\n- The length of the sequence is known in advance, right? Then it\n  should be faster to allocate a bit list right away, and then fill\n  it up, rather than using append.\n\n- In the long run, we might want to provide an iterator over the\n  sequence (once cython will support iterators)\n\n- debruijn.py -> debruijn_sequence.py\n\n- The speed difference is impressive :-) I don't know if we want to\n  mention it in the doc though (this may change in the future).\n\nCheers,\n\t\t\tNicolas",
    "created_at": "2010-12-29T22:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108878",
    "user": "https://github.com/nthiery"
}
```

Hi!

I just had a quick look at your patch. This sounds good!

A couple micro comments (before an actual review):

- CombinatorialClass is deprecated. Please use the
  FiniteEnumeratedSets category. For an example, see:

      sage: C = FiniteEnumeratedSets().example()
      sage: C??
      File:		/opt/sage/local/lib/python2.6/site-packages/sage/categories/examples/finite_enumerated_sets.py

  (sorry, we still have a lot of old code giving bad hints to the
  newcomers)

- What about just implementing _an_element_? (no __iter__, no first).

  Actually at this point DeBruijnSequences(alphabet, n) should just
  be in the category FiniteSets(). However the later does not exist
  yet, so Sets() will do.

- Rather than defining an attribute self.k_is_alphabet, I would setup
  two attributes self.k and self.alphabet once for all in the
  __init__. Then no more branching needs to be done later on.

  Maybe rename the parameter k to alphabet (which is more explicit)

- DeBruijnSequence_evaluation -> DeBruijnSequences

  No need for the DeBruijnSequence function at this point.

- The length of the sequence is known in advance, right? Then it
  should be faster to allocate a bit list right away, and then fill
  it up, rather than using append.

- In the long run, we might want to provide an iterator over the
  sequence (once cython will support iterators)

- debruijn.py -> debruijn_sequence.py

- The speed difference is impressive :-) I don't know if we want to
  mention it in the doc though (this may change in the future).

Cheers,
			Nicolas



---

archive/issue_comments_108879.json:
```json
{
    "body": "Thank you for the comments. I have a few questions:\n\n*Rather than defining an attribute self.k_is_alphabet, I would setup two attributes self.k and self.alphabet once for all in the init. Then no more branching needs to be done later on.*\n\nI know it looks ugly. The point of having k_is_alphabet is to check whether the input *k* is an alphabet or an arity, as the processing is different in either case. I was thinking of removing the alphabet functionality; maybe just the arity would suffice? One could always map values onto the digits after.\n\n*The length of the sequence is known in advance, right? Then it should be faster to allocate a bit list right away, and then fill it up, rather than using append.*\n\nI'm not clear on this. Are you suggesting I compute the length of the array in advance, create *sequence* full of zeros to that length, and then use indeces to change the values? Is append that much slower that creating a long list and then filling it would be faster?\n\nOr are you suggesting that I declare sequence as an int array in C, then fill it? This was my initial idea, but I couldn't find a way to insert arguments into the declaration. This returns a traceback:\n\ncdef sequence[k^n]\n\nThanks again!",
    "created_at": "2010-12-30T01:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108879",
    "user": "https://github.com/eviatarbach"
}
```

Thank you for the comments. I have a few questions:

*Rather than defining an attribute self.k_is_alphabet, I would setup two attributes self.k and self.alphabet once for all in the init. Then no more branching needs to be done later on.*

I know it looks ugly. The point of having k_is_alphabet is to check whether the input *k* is an alphabet or an arity, as the processing is different in either case. I was thinking of removing the alphabet functionality; maybe just the arity would suffice? One could always map values onto the digits after.

*The length of the sequence is known in advance, right? Then it should be faster to allocate a bit list right away, and then fill it up, rather than using append.*

I'm not clear on this. Are you suggesting I compute the length of the array in advance, create *sequence* full of zeros to that length, and then use indeces to change the values? Is append that much slower that creating a long list and then filling it would be faster?

Or are you suggesting that I declare sequence as an int array in C, then fill it? This was my initial idea, but I couldn't find a way to insert arguments into the declaration. This returns a traceback:

cdef sequence[k^n]

Thanks again!



---

archive/issue_comments_108880.json:
```json
{
    "body": "Replying to [comment:4 eviatarbach]:\n> Thank you for the comments. I have a few questions:\n> \n> *Rather than defining an attribute self.k_is_alphabet, I would setup two attributes self.k and self.alphabet once for all in the init. Then no more branching needs to be done later on.*\n> \n> I know it looks ugly. The point of having k_is_alphabet is to check whether the input *k* is an alphabet or an arity, as the processing is different in either case. \n\nIt feels only marginaly different. For example, if alphabet is set to\n[0,...,k-1], then the last ``if`` becomes unnecessary; granted, there\nis an overhead of an indexed lookup in an array, but I assume it\nshould be negligible (to be checked with timeit though!).\n\n> I was thinking of removing the alphabet functionality; maybe just the arity would suffice? One could always map values onto the digits after.\n\nAs you feel like; that functionality can indeed be added later.\n\n> *The length of the sequence is known in advance, right? Then it should be faster to allocate a bit list right away, and then fill it up, rather than using append.*\n\n> I'm not clear on this. Are you suggesting I compute the length of the array in advance, create *sequence* full of zeros to that length, and then use indeces to change the values?\n\nYes.\n\n> Is append that much slower that creating a long list and then filling it would be faster?\n\nWith append, Python needs to regularly reallocate the list in memory,\nrequiring a copy of it each time. In principle, Python uses\n\"exponential\" reallocation so the theoretical complexity of append is\n\"amortized O(1)\", but there still is an overhead.\n\nI recommend trying both, and benchmarking with timeit (and post here\nthe result for our instruction).\n\n> Or are you suggesting that I declare sequence as an int array in C,\n> then fill it? This was my initial idea, but I couldn't find a way to\n> insert arguments into the declaration. This returns a traceback:\n> \n> cdef sequence[k^n]\n\nI don't know what's the canonical way to allocate C arrays in\nCython. Probably via malloc or something. It will be in the Cython\ndoc. Anyway, since the result will be returned as a list, I assume\nthat copying back the result into a list would ruin the benefit of\nhaving used a C array in the first place.\n\n\nAh, by the way: please add tests for all the base cases: k=0,\nalphabet=0, ...\n\nAlso please add tests for the direct call to ``debruijn_cython``.\nSpeaking of which I suggest renaming it to debruijn_sequence, and\nadding a link back to DeBruijnSequences.\n\nCheers,",
    "created_at": "2010-12-30T08:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108880",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:4 eviatarbach]:
> Thank you for the comments. I have a few questions:
> 
> *Rather than defining an attribute self.k_is_alphabet, I would setup two attributes self.k and self.alphabet once for all in the init. Then no more branching needs to be done later on.*
> 
> I know it looks ugly. The point of having k_is_alphabet is to check whether the input *k* is an alphabet or an arity, as the processing is different in either case. 

It feels only marginaly different. For example, if alphabet is set to
[0,...,k-1], then the last ``if`` becomes unnecessary; granted, there
is an overhead of an indexed lookup in an array, but I assume it
should be negligible (to be checked with timeit though!).

> I was thinking of removing the alphabet functionality; maybe just the arity would suffice? One could always map values onto the digits after.

As you feel like; that functionality can indeed be added later.

> *The length of the sequence is known in advance, right? Then it should be faster to allocate a bit list right away, and then fill it up, rather than using append.*

> I'm not clear on this. Are you suggesting I compute the length of the array in advance, create *sequence* full of zeros to that length, and then use indeces to change the values?

Yes.

> Is append that much slower that creating a long list and then filling it would be faster?

With append, Python needs to regularly reallocate the list in memory,
requiring a copy of it each time. In principle, Python uses
"exponential" reallocation so the theoretical complexity of append is
"amortized O(1)", but there still is an overhead.

I recommend trying both, and benchmarking with timeit (and post here
the result for our instruction).

> Or are you suggesting that I declare sequence as an int array in C,
> then fill it? This was my initial idea, but I couldn't find a way to
> insert arguments into the declaration. This returns a traceback:
> 
> cdef sequence[k^n]

I don't know what's the canonical way to allocate C arrays in
Cython. Probably via malloc or something. It will be in the Cython
doc. Anyway, since the result will be returned as a list, I assume
that copying back the result into a list would ruin the benefit of
having used a C array in the first place.


Ah, by the way: please add tests for all the base cases: k=0,
alphabet=0, ...

Also please add tests for the direct call to ``debruijn_cython``.
Speaking of which I suggest renaming it to debruijn_sequence, and
adding a link back to DeBruijnSequences.

Cheers,



---

archive/issue_comments_108881.json:
```json
{
    "body": "Append is marginally faster (by about one microsecond), probably because for the other I had to declare a global *index* variable in Python.\n\nLet me get this straight:\n\n## Python\nFilename: debruijn_sequence.py\nClass name: DeBruijnSequence (DeBruijnSequences wouldn't make sense since only one is generated)\n\n\n## Cython\nFilename: debruijn_sequence.pyx\nFunction name: debruijn_sequence\n\nIs this correct?\n\nAlso, for some reason, when I use underscores in debruijn_sequence.py, I get this error:\n\n\n```\nImportError: dynamic module does not define init function (initdebruijn_sequence)\n```\n\n\nThank you!",
    "created_at": "2010-12-30T20:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108881",
    "user": "https://github.com/eviatarbach"
}
```

Append is marginally faster (by about one microsecond), probably because for the other I had to declare a global *index* variable in Python.

Let me get this straight:

## Python
Filename: debruijn_sequence.py
Class name: DeBruijnSequence (DeBruijnSequences wouldn't make sense since only one is generated)


## Cython
Filename: debruijn_sequence.pyx
Function name: debruijn_sequence

Is this correct?

Also, for some reason, when I use underscores in debruijn_sequence.py, I get this error:


```
ImportError: dynamic module does not define init function (initdebruijn_sequence)
```


Thank you!



---

archive/issue_comments_108882.json:
```json
{
    "body": "Replying to [comment:6 eviatarbach]:\n> Append is marginally faster (by about one microsecond), probably\n> because for the other I had to declare a global *index* variable\n> in Python.\n\nInteresting to know! Have you tried with large output? Say, a sequence of length 10^5 or 10^6?\n\nFor the following, see also the discussion on:\n\nhttp://groups.google.com/group/sage-combinat-devel/browse_thread/thread/bf20e88681bc557b\n\n> Let me get this straight:\n> \n> == Python ==\n> Filename: debruijn_sequence.py\n> Class name: DeBruijnSequence (DeBruijnSequences wouldn't make sense since only one is generated)\n\nClass name: DeBruijnSequences (it models the set of all such sequences)\nFilename: debruijn_sequences.py (for consistency with the name of the class; granted this convention is not yet followed consistently across combinat; that should eventually be fixed)\n\n> == Cython ==\n> Filename: debruijn_sequence.pyx\n> Function name: debruijn_sequence\n\n+1\n\nPossibly debruijn_sequences_cython.pyx in case you expect other\nfunctionalities on de Bruijn sequences to be implemented in cython.\n\n> Also, for some reason, when I use underscores in debruijn_sequence.py, I get this error:\n> \n> {{{\n> ImportError: dynamic module does not define init function (initdebruijn_sequence)\n> }}}\n\nHmm, as far as I know this should work. Please double check all\nreferences to the f,ile and that everything was recompiled\nproperly. Also, there might be some old files that have not been\ncleaned up and that cython tries to recompile.\n\nCheers,\n\t\t\t\t\tNicolas",
    "created_at": "2011-01-02T10:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108882",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:6 eviatarbach]:
> Append is marginally faster (by about one microsecond), probably
> because for the other I had to declare a global *index* variable
> in Python.

Interesting to know! Have you tried with large output? Say, a sequence of length 10^5 or 10^6?

For the following, see also the discussion on:

http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/bf20e88681bc557b

> Let me get this straight:
> 
> == Python ==
> Filename: debruijn_sequence.py
> Class name: DeBruijnSequence (DeBruijnSequences wouldn't make sense since only one is generated)

Class name: DeBruijnSequences (it models the set of all such sequences)
Filename: debruijn_sequences.py (for consistency with the name of the class; granted this convention is not yet followed consistently across combinat; that should eventually be fixed)

> == Cython ==
> Filename: debruijn_sequence.pyx
> Function name: debruijn_sequence

+1

Possibly debruijn_sequences_cython.pyx in case you expect other
functionalities on de Bruijn sequences to be implemented in cython.

> Also, for some reason, when I use underscores in debruijn_sequence.py, I get this error:
> 
> {{{
> ImportError: dynamic module does not define init function (initdebruijn_sequence)
> }}}

Hmm, as far as I know this should work. Please double check all
references to the f,ile and that everything was recompiled
properly. Also, there might be some old files that have not been
cleaned up and that cython tries to recompile.

Cheers,
					Nicolas



---

archive/issue_comments_108883.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-02-11T20:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108883",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_108884.json:
```json
{
    "body": "Attachment [15454.patch](tarball://root/attachments/some-uuid/ticket10530/15454.patch) by @eviatarbach created at 2011-02-11 20:19:53\n\nSorry for taking so long, but here is the updated patch. The changes are as follows:\n\n- sanity-checks the input; corresponding tests added in the docstring\n- filenames changed\n- option for alphabet removed; not really useful and having an additional keyword argument may confuse\n\nI tried to allocate the length of the sequence length beforehand and tested with larger inputs, as you suggested, but it is still slower. I don't know much about algorithmic efficiency, but that's what I observed in my tests. For one input, I got around 50 ms and 120 ms, respectively.\n\nI decided to not have the sequences as words, to leave the option open for generation of all possible sequences open.\n\nThanks in advance!",
    "created_at": "2011-02-11T20:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108884",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [15454.patch](tarball://root/attachments/some-uuid/ticket10530/15454.patch) by @eviatarbach created at 2011-02-11 20:19:53

Sorry for taking so long, but here is the updated patch. The changes are as follows:

- sanity-checks the input; corresponding tests added in the docstring
- filenames changed
- option for alphabet removed; not really useful and having an additional keyword argument may confuse

I tried to allocate the length of the sequence length beforehand and tested with larger inputs, as you suggested, but it is still slower. I don't know much about algorithmic efficiency, but that's what I observed in my tests. For one input, I got around 50 ms and 120 ms, respectively.

I decided to not have the sequences as words, to leave the option open for generation of all possible sequences open.

Thanks in advance!



---

archive/issue_comments_108885.json:
```json
{
    "body": "By the way, it was built on Sage 4.6.2.alpha4.",
    "created_at": "2011-02-11T20:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108885",
    "user": "https://github.com/eviatarbach"
}
```

By the way, it was built on Sage 4.6.2.alpha4.



---

archive/issue_comments_108886.json:
```json
{
    "body": "Hi,\nsight remark: are you sure about the cardinality part? I think a factorial is missing...\n( see e.g. your reference or http://en.wikipedia.org/wiki/De_Bruijn_sequence )",
    "created_at": "2011-02-12T15:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108886",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

Hi,
sight remark: are you sure about the cardinality part? I think a factorial is missing...
( see e.g. your reference or http://en.wikipedia.org/wiki/De_Bruijn_sequence )



---

archive/issue_comments_108887.json:
```json
{
    "body": "Yes, you're correct. It seems that the formula I was looking at only applies when k=2. I uploaded a new patch.",
    "created_at": "2011-02-12T21:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108887",
    "user": "https://github.com/eviatarbach"
}
```

Yes, you're correct. It seems that the formula I was looking at only applies when k=2. I uploaded a new patch.



---

archive/issue_comments_108888.json:
```json
{
    "body": "To be applied on top of previous patch",
    "created_at": "2011-02-12T21:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108888",
    "user": "https://github.com/eviatarbach"
}
```

To be applied on top of previous patch



---

archive/issue_comments_108889.json:
```json
{
    "body": "Attachment [15455.patch](tarball://root/attachments/some-uuid/ticket10530/15455.patch) by ylchapuy created at 2011-02-15 17:45:32\n\nAnother slight remark:\nin debruijn_sequence, in the inner function gen, you should \"cdef int j\" for a nice speedup.",
    "created_at": "2011-02-15T17:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108889",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

Attachment [15455.patch](tarball://root/attachments/some-uuid/ticket10530/15455.patch) by ylchapuy created at 2011-02-15 17:45:32

Another slight remark:
in debruijn_sequence, in the inner function gen, you should "cdef int j" for a nice speedup.



---

archive/issue_comments_108890.json:
```json
{
    "body": "Attachment [15456.patch](tarball://root/attachments/some-uuid/ticket10530/15456.patch) by @eviatarbach created at 2011-02-16 01:07:10\n\nTo be applied on top of previous.",
    "created_at": "2011-02-16T01:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108890",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [15456.patch](tarball://root/attachments/some-uuid/ticket10530/15456.patch) by @eviatarbach created at 2011-02-16 01:07:10

To be applied on top of previous.



---

archive/issue_comments_108891.json:
```json
{
    "body": "Changing assignee from sage-combinat to @eviatarbach.",
    "created_at": "2011-02-16T01:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108891",
    "user": "https://github.com/eviatarbach"
}
```

Changing assignee from sage-combinat to @eviatarbach.



---

archive/issue_comments_108892.json:
```json
{
    "body": "That is a significant speedup! Thank you!\n\nNew patch uploaded.",
    "created_at": "2011-02-16T01:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108892",
    "user": "https://github.com/eviatarbach"
}
```

That is a significant speedup! Thank you!

New patch uploaded.



---

archive/issue_comments_108893.json:
```json
{
    "body": "Hello !\n\nSeveral superficial remarks :\n\n* As in your other patch, the lines should be kept to less than 80 characters\n* Some functions are not documented \n     {{{\n/home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence*\n----------------------------------------------------------------------\ndebruijn_sequence.pyx\nSCORE debruijn_sequence.pyx: 0% (0 of 2)\n\nMissing documentation:\n* gen(int t, int p):\n\n\nMissing doctests:\n* debruijn_sequence(int k, int n):\n\n----------------------------------------------------------------------\n\n----------------------------------------------------------------------\ndebruijn_sequences.py\nERROR: Please add a `TestSuite(s).run()` doctest.\nSCORE debruijn_sequences.py: 75% (3 of 4)\n\nMissing documentation:\n* __init__(self, k,n):\n\n----------------------------------------------------------------------\n\n/home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence.pyx \n----------------------------------------------------------------------\ndebruijn_sequence.pyx\nSCORE debruijn_sequence.pyx: 0% (0 of 2)\n\nMissing documentation:\n* gen(int t, int p):\n\n\nMissing doctests:\n* debruijn_sequence(int k, int n):\n\n----------------------------------------------------------------------\n         }}}\n         Let's keep this to 100% lest we write other patches later to improve it `:-)`\n* The \"NOTE::\" environment is misused. Look at other places in the source code where it is used. You can see it doesn't display properly when building the documentation\n  {{{\n  sage -docbuild reference html\n  }}}\n\n* Same for the \"reference\" environment and citations.The best is to look at other places in the souce code `:-)`\n\n* The \"cardinality\" method, for instance, is not doctested.\n\n* It would be good to add a reference to the book \"Combinatorial Generation\" in the file containing the actual implementaion of the algorithm\n\n* There are 4 patches on this ticket.\n   * If the ticket's name is a number, let it be the ticket's number\n   * In this kind of situation, it's also very nice to produce \"flattened\" patched. Sometimes it is better to update the current patch than to create another one to apply on top. You may need to use \"Mercurial Queue\" if you're not used to it.\n\nShort of all this, thank you for this patch ! As usual, there's much more work in dealing with the programming standards than with the actual math content, but it quickly becomes natural. Thank you very much also, because of you I spend yesterday reading random parts of Combinatorial Generation, and learned very nice things `:-)`\n\n(send me an email if I can be of any help)\n\nNathann",
    "created_at": "2011-05-08T15:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108893",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

Several superficial remarks :

* As in your other patch, the lines should be kept to less than 80 characters
* Some functions are not documented 
     {{{
/home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence*
----------------------------------------------------------------------
debruijn_sequence.pyx
SCORE debruijn_sequence.pyx: 0% (0 of 2)

Missing documentation:
* gen(int t, int p):


Missing doctests:
* debruijn_sequence(int k, int n):

----------------------------------------------------------------------

----------------------------------------------------------------------
debruijn_sequences.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE debruijn_sequences.py: 75% (3 of 4)

Missing documentation:
* __init__(self, k,n):

----------------------------------------------------------------------

/home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence.pyx 
----------------------------------------------------------------------
debruijn_sequence.pyx
SCORE debruijn_sequence.pyx: 0% (0 of 2)

Missing documentation:
* gen(int t, int p):


Missing doctests:
* debruijn_sequence(int k, int n):

----------------------------------------------------------------------
         }}}
         Let's keep this to 100% lest we write other patches later to improve it `:-)`
* The "NOTE::" environment is misused. Look at other places in the source code where it is used. You can see it doesn't display properly when building the documentation
  {{{
  sage -docbuild reference html
  }}}

* Same for the "reference" environment and citations.The best is to look at other places in the souce code `:-)`

* The "cardinality" method, for instance, is not doctested.

* It would be good to add a reference to the book "Combinatorial Generation" in the file containing the actual implementaion of the algorithm

* There are 4 patches on this ticket.
   * If the ticket's name is a number, let it be the ticket's number
   * In this kind of situation, it's also very nice to produce "flattened" patched. Sometimes it is better to update the current patch than to create another one to apply on top. You may need to use "Mercurial Queue" if you're not used to it.

Short of all this, thank you for this patch ! As usual, there's much more work in dealing with the programming standards than with the actual math content, but it quickly becomes natural. Thank you very much also, because of you I spend yesterday reading random parts of Combinatorial Generation, and learned very nice things `:-)`

(send me an email if I can be of any help)

Nathann



---

archive/issue_comments_108894.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-08T15:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108894",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_108895.json:
```json
{
    "body": "Replying to [comment:15 ncohen]:\n> Hello !\n> \n> Several superficial remarks :\n> \n>     * As in your other patch, the lines should be kept to less than 80 characters\n>     * Some functions are not documented \n>          {{{\n> /home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence*\n> ----------------------------------------------------------------------\n> debruijn_sequence.pyx\n> SCORE debruijn_sequence.pyx: 0% (0 of 2)\n> \n> Missing documentation:\n> \t * gen(int t, int p):\n> \n> \n> Missing doctests:\n> \t * debruijn_sequence(int k, int n):\n> \n> ----------------------------------------------------------------------\n> \n> ----------------------------------------------------------------------\n> debruijn_sequences.py\n> ERROR: Please add a `TestSuite(s).run()` doctest.\n> SCORE debruijn_sequences.py: 75% (3 of 4)\n> \n> Missing documentation:\n> \t * __init__(self, k,n):\n> \n> ----------------------------------------------------------------------\n> \n> /home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence.pyx \n> ----------------------------------------------------------------------\n> debruijn_sequence.pyx\n> SCORE debruijn_sequence.pyx: 0% (0 of 2)\n> \n> Missing documentation:\n> \t * gen(int t, int p):\n> \n> \n> Missing doctests:\n> \t * debruijn_sequence(int k, int n):\n> \n> ----------------------------------------------------------------------\n>          }}}\n>          Let's keep this to 100% lest we write other patches later to improve it `:-)`\n>     * The \"NOTE::\" environment is misused. Look at other places in the source code where it is used. You can see it doesn't display properly when building the documentation\n>       {{{\n>       sage -docbuild reference html\n>       }}}\n> \n>     * Same for the \"reference\" environment and citations.The best is to look at other places in the souce code `:-)`\n> \n>     * The \"cardinality\" method, for instance, is not doctested.\n> \n>     * It would be good to add a reference to the book \"Combinatorial Generation\" in the file containing the actual implementaion of the algorithm\n> \n>     * There are 4 patches on this ticket.\n>        * If the ticket's name is a number, let it be the ticket's number\n>        * In this kind of situation, it's also very nice to produce \"flattened\" patched. Sometimes it is better to update the current patch than to create another one to apply on top. You may need to use \"Mercurial Queue\" if you're not used to it.\n> \n> Short of all this, thank you for this patch ! As usual, there's much more work in dealing with the programming standards than with the actual math content, but it quickly becomes natural. Thank you very much also, because of you I spend yesterday reading random parts of Combinatorial Generation, and learned very nice things `:-)`\n> \n> (send me an email if I can be of any help)\n> \n> Nathann\n>       \nThank you, I was afraid nobody would review it! I will make the changes ASAP.",
    "created_at": "2011-05-13T06:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108895",
    "user": "https://github.com/eviatarbach"
}
```

Replying to [comment:15 ncohen]:
> Hello !
> 
> Several superficial remarks :
> 
>     * As in your other patch, the lines should be kept to less than 80 characters
>     * Some functions are not documented 
>          {{{
> /home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence*
> ----------------------------------------------------------------------
> debruijn_sequence.pyx
> SCORE debruijn_sequence.pyx: 0% (0 of 2)
> 
> Missing documentation:
> 	 * gen(int t, int p):
> 
> 
> Missing doctests:
> 	 * debruijn_sequence(int k, int n):
> 
> ----------------------------------------------------------------------
> 
> ----------------------------------------------------------------------
> debruijn_sequences.py
> ERROR: Please add a `TestSuite(s).run()` doctest.
> SCORE debruijn_sequences.py: 75% (3 of 4)
> 
> Missing documentation:
> 	 * __init__(self, k,n):
> 
> ----------------------------------------------------------------------
> 
> /home/ncohen/sage/devel/sage-1/sage/combinat$ sage -coverage debruijn_sequence.pyx 
> ----------------------------------------------------------------------
> debruijn_sequence.pyx
> SCORE debruijn_sequence.pyx: 0% (0 of 2)
> 
> Missing documentation:
> 	 * gen(int t, int p):
> 
> 
> Missing doctests:
> 	 * debruijn_sequence(int k, int n):
> 
> ----------------------------------------------------------------------
>          }}}
>          Let's keep this to 100% lest we write other patches later to improve it `:-)`
>     * The "NOTE::" environment is misused. Look at other places in the source code where it is used. You can see it doesn't display properly when building the documentation
>       {{{
>       sage -docbuild reference html
>       }}}
> 
>     * Same for the "reference" environment and citations.The best is to look at other places in the souce code `:-)`
> 
>     * The "cardinality" method, for instance, is not doctested.
> 
>     * It would be good to add a reference to the book "Combinatorial Generation" in the file containing the actual implementaion of the algorithm
> 
>     * There are 4 patches on this ticket.
>        * If the ticket's name is a number, let it be the ticket's number
>        * In this kind of situation, it's also very nice to produce "flattened" patched. Sometimes it is better to update the current patch than to create another one to apply on top. You may need to use "Mercurial Queue" if you're not used to it.
> 
> Short of all this, thank you for this patch ! As usual, there's much more work in dealing with the programming standards than with the actual math content, but it quickly becomes natural. Thank you very much also, because of you I spend yesterday reading random parts of Combinatorial Generation, and learned very nice things `:-)`
> 
> (send me an email if I can be of any help)
> 
> Nathann
>       
Thank you, I was afraid nobody would review it! I will make the changes ASAP.



---

archive/issue_comments_108896.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-14T22:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108896",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_108897.json:
```json
{
    "body": "Patch uploaded. Thank you again.\n\nOh, and yes, \"Combinatorial Generation\" is very interesting.",
    "created_at": "2011-05-14T22:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108897",
    "user": "https://github.com/eviatarbach"
}
```

Patch uploaded. Thank you again.

Oh, and yes, "Combinatorial Generation" is very interesting.



---

archive/issue_comments_108898.json:
```json
{
    "body": "To be applied on top of previous",
    "created_at": "2011-05-15T05:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108898",
    "user": "https://github.com/eviatarbach"
}
```

To be applied on top of previous



---

archive/issue_comments_108899.json:
```json
{
    "body": "Attachment [15469.patch](tarball://root/attachments/some-uuid/ticket10530/15469.patch) by @eviatarbach created at 2011-05-15 05:18:14\n\nFixed a problem in the documentation.\n\nSorry for making two patches, but I couldn't figure out how to merge them. I will use Mercurial queues in the future.",
    "created_at": "2011-05-15T05:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108899",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [15469.patch](tarball://root/attachments/some-uuid/ticket10530/15469.patch) by @eviatarbach created at 2011-05-15 05:18:14

Fixed a problem in the documentation.

Sorry for making two patches, but I couldn't figure out how to merge them. I will use Mercurial queues in the future.



---

archive/issue_comments_108900.json:
```json
{
    "body": "Hello again !\n\n* doctest coverage still isn't to 100% (even though only the __init__ is missing.\n\n* The first line in the docstring of a method should be a description of what it does. It is missing in many methods.\n\n* It would be nice to add a formal definition of what a DeBruijn sequence is. A \"sequence that incorporates all substrings of a certain length of an alphabet\" is a bit vague. And even when it is made clear that they are contiguous substrings, there is something to mention about the fact that is actually does *not* contain them all, are one has to assume there is a sequence of trailing zeroes.\n\n  {{{\n  sage: DeBruijnSequences(2,3).an_element()\n  [0, 0, 0, 1, 0, 1, 1, 1]\n  }}}\n \n  Here the sequences 110 and 100 do not appear, except when considering trailing zeroes, and even though I think this is what is called a de Bruijn sequence, it has to be made clear somewhere (perhaps the best is in ``DeBruijnSequences?``).\n\n* We usually push the TESTS section of each docstring to the end, as it is usually long and the least relevant to the user.\n\n* References (bibliography) are still wrong\n\n* Couldn't the debruijn_sequence function (in Cython) be improved by defining the recursive method outside, as a cdef function ? Here I fear the recursive calls are made in Python. \n\n* I remember Minh  telling me that we should stick to \n\n  {{{\n  raise ValueError(\"message\")\n  }}}\n  instead of\n\n  {{{\n  raise ValueError, \"message\"\n  }}}\n\n  It has something to do with the next version of Python that we may have to use somewhere in the distant future.\n\n* There is a warning when building documentation \n\n  {{{\n     /home/ncohen/.Sage/local/lib/python2.6/site-packages/sage/combinat/debruijn_sequences.py:docstring of sage.combinat.debruijn_sequences.DeBruijnSequences:4: (WARNING/2) Bullet list ends without a blank line; unexpected unindent.\n  }}}\n\nNathann",
    "created_at": "2011-05-15T09:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108900",
    "user": "https://github.com/nathanncohen"
}
```

Hello again !

* doctest coverage still isn't to 100% (even though only the __init__ is missing.

* The first line in the docstring of a method should be a description of what it does. It is missing in many methods.

* It would be nice to add a formal definition of what a DeBruijn sequence is. A "sequence that incorporates all substrings of a certain length of an alphabet" is a bit vague. And even when it is made clear that they are contiguous substrings, there is something to mention about the fact that is actually does *not* contain them all, are one has to assume there is a sequence of trailing zeroes.

  {{{
  sage: DeBruijnSequences(2,3).an_element()
  [0, 0, 0, 1, 0, 1, 1, 1]
  }}}
 
  Here the sequences 110 and 100 do not appear, except when considering trailing zeroes, and even though I think this is what is called a de Bruijn sequence, it has to be made clear somewhere (perhaps the best is in ``DeBruijnSequences?``).

* We usually push the TESTS section of each docstring to the end, as it is usually long and the least relevant to the user.

* References (bibliography) are still wrong

* Couldn't the debruijn_sequence function (in Cython) be improved by defining the recursive method outside, as a cdef function ? Here I fear the recursive calls are made in Python. 

* I remember Minh  telling me that we should stick to 

  {{{
  raise ValueError("message")
  }}}
  instead of

  {{{
  raise ValueError, "message"
  }}}

  It has something to do with the next version of Python that we may have to use somewhere in the distant future.

* There is a warning when building documentation 

  {{{
     /home/ncohen/.Sage/local/lib/python2.6/site-packages/sage/combinat/debruijn_sequences.py:docstring of sage.combinat.debruijn_sequences.DeBruijnSequences:4: (WARNING/2) Bullet list ends without a blank line; unexpected unindent.
  }}}

Nathann



---

archive/issue_comments_108901.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-15T09:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108901",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_108902.json:
```json
{
    "body": "Hello,\n\nI made all the changes you suggested. However, De Bruijn sequences *do* incorporate all subsequences of a certain length--it's just that the sequence is cyclic. So, for example, 00010111 would be equal to\n00101110\n01011100\netc., so you can see where 100 and 110 show up.\n\nI am not getting the error you say when building documentation; maybe it is fixed?\n\nThank you again for reviewing. I am learning a lot and I will refer back here every time I submit a patch.",
    "created_at": "2011-05-21T17:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108902",
    "user": "https://github.com/eviatarbach"
}
```

Hello,

I made all the changes you suggested. However, De Bruijn sequences *do* incorporate all subsequences of a certain length--it's just that the sequence is cyclic. So, for example, 00010111 would be equal to
00101110
01011100
etc., so you can see where 100 and 110 show up.

I am not getting the error you say when building documentation; maybe it is fixed?

Thank you again for reviewing. I am learning a lot and I will refer back here every time I submit a patch.



---

archive/issue_comments_108903.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-21T17:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108903",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_108904.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-05-22T16:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108904",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_108905.json:
```json
{
    "body": "I haven't been able to check the documentation was correctly geenrated, something's wrong with my Sage install and I should be able to do that tomorrow. Meanwhile, I wrote a patch which does the following :\n\n* Add some documentation and examples at the top of DeBruijn_sequences file, to illustrate what it does\n* Wrote a is_debruijn_sequence to test the correctness of the answers given\n* Wrote a __contains__ method in the DeBruijn_Sequences class\n* Fixed several docstrings on the following point : an object of the class DeBruijnSequences represents ALL the DeBruijn Sequences, even though its main point for now is to be able to generate them. For instance, the documentation sometimes implied that such an object *was* a DeBruijn sequence.\n* The current implementation returned sequences of length 0 when k = 0, regardless of the value of n. In this patch it returns [0] * n. Do we agree on that ?\n* The \"references\" field did not follow the good syntax\n* The cardinality formula was wrong\n\nI also wondered whether there was any reason to have two files instead of one. What about just having a debruijn_sequences.pyx with everything inside, instead of two files ?\n\nNathann",
    "created_at": "2011-05-22T16:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108905",
    "user": "https://github.com/nathanncohen"
}
```

I haven't been able to check the documentation was correctly geenrated, something's wrong with my Sage install and I should be able to do that tomorrow. Meanwhile, I wrote a patch which does the following :

* Add some documentation and examples at the top of DeBruijn_sequences file, to illustrate what it does
* Wrote a is_debruijn_sequence to test the correctness of the answers given
* Wrote a __contains__ method in the DeBruijn_Sequences class
* Fixed several docstrings on the following point : an object of the class DeBruijnSequences represents ALL the DeBruijn Sequences, even though its main point for now is to be able to generate them. For instance, the documentation sometimes implied that such an object *was* a DeBruijn sequence.
* The current implementation returned sequences of length 0 when k = 0, regardless of the value of n. In this patch it returns [0] * n. Do we agree on that ?
* The "references" field did not follow the good syntax
* The cardinality formula was wrong

I also wondered whether there was any reason to have two files instead of one. What about just having a debruijn_sequences.pyx with everything inside, instead of two files ?

Nathann



---

archive/issue_comments_108906.json:
```json
{
    "body": "The contains method is great!\n\nSorry about the wrong algorithm. It looks like I was using an outdated revision to make the last patch.\n\nAs for the case when k=0 and length 0, I assume you mean k=1 and length 1? I do not think this is correct, as it is a cyclic sequence. Therefore, a De Bruijn sequence [0] would include any substring of length n for alphabet [0]. This can also be verified by the length formula k^n: 1^n=1.\n\nI assumed that I had to split the Cython code from Python. I guess it would be easier to have it all in one file. I will do so.\n\nOther than some minor grammatical errors everything else seems good. Thank you very much for the improvements!",
    "created_at": "2011-05-23T03:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108906",
    "user": "https://github.com/eviatarbach"
}
```

The contains method is great!

Sorry about the wrong algorithm. It looks like I was using an outdated revision to make the last patch.

As for the case when k=0 and length 0, I assume you mean k=1 and length 1? I do not think this is correct, as it is a cyclic sequence. Therefore, a De Bruijn sequence [0] would include any substring of length n for alphabet [0]. This can also be verified by the length formula k^n: 1^n=1.

I assumed that I had to split the Cython code from Python. I guess it would be easier to have it all in one file. I will do so.

Other than some minor grammatical errors everything else seems good. Thank you very much for the improvements!



---

archive/issue_comments_108907.json:
```json
{
    "body": "Should be 1**n=1; the formatting looks strange there.",
    "created_at": "2011-05-23T03:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108907",
    "user": "https://github.com/eviatarbach"
}
```

Should be 1**n=1; the formatting looks strange there.



---

archive/issue_comments_108908.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-05-23T10:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108908",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_108909.json:
```json
{
    "body": "Patch updated so that ``k=1`` still returns the sequence ``[0]``. Your turn now ! `:-)`\n\nNathann",
    "created_at": "2011-05-23T10:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108909",
    "user": "https://github.com/nathanncohen"
}
```

Patch updated so that ``k=1`` still returns the sequence ``[0]``. Your turn now ! `:-)`

Nathann



---

archive/issue_comments_108910.json:
```json
{
    "body": "trying to help the build bot :\n\nApply 10530.2.patch trac_10530-reviewer.patch",
    "created_at": "2011-06-13T18:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108910",
    "user": "https://github.com/fchapoton"
}
```

trying to help the build bot :

Apply 10530.2.patch trac_10530-reviewer.patch



---

archive/issue_comments_108911.json:
```json
{
    "body": "Please make sure that the first lines of the patches contains the ticket number with a # prefix (it should be exactly #10530).\n\nThen hopefully the bot will go green.",
    "created_at": "2011-06-13T19:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108911",
    "user": "https://github.com/fchapoton"
}
```

Please make sure that the first lines of the patches contains the ticket number with a # prefix (it should be exactly #10530).

Then hopefully the bot will go green.



---

archive/issue_comments_108912.json:
```json
{
    "body": "Thanks. This should also be done for the main patch 10530.2.patch : The **first** line of the header should contain the ticket number #10530 (in this exact form).",
    "created_at": "2011-06-24T20:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108912",
    "user": "https://github.com/fchapoton"
}
```

Thanks. This should also be done for the main patch 10530.2.patch : The **first** line of the header should contain the ticket number #10530 (in this exact form).



---

archive/issue_comments_108913.json:
```json
{
    "body": "Attachment [10530.2.patch](tarball://root/attachments/some-uuid/ticket10530/10530.2.patch) by @eviatarbach created at 2011-06-25 23:55:17",
    "created_at": "2011-06-25T23:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108913",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [10530.2.patch](tarball://root/attachments/some-uuid/ticket10530/10530.2.patch) by @eviatarbach created at 2011-06-25 23:55:17



---

archive/issue_comments_108914.json:
```json
{
    "body": "Done! I think everything should be fine now. I couldn't find the grammatical mistake I mentioned before.",
    "created_at": "2011-06-25T23:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108914",
    "user": "https://github.com/eviatarbach"
}
```

Done! I think everything should be fine now. I couldn't find the grammatical mistake I mentioned before.



---

archive/issue_comments_108915.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-06-25T23:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108915",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_108916.json:
```json
{
    "body": "Why \"need_info\" ? It was your turn to review my latest patch, and you talked about merging thetwo files.... `O_o`\n\nNathann",
    "created_at": "2011-06-26T08:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108916",
    "user": "https://github.com/nathanncohen"
}
```

Why "need_info" ? It was your turn to review my latest patch, and you talked about merging thetwo files.... `O_o`

Nathann



---

archive/issue_comments_108917.json:
```json
{
    "body": "Hum, sorry, but it seems that I was not clear enough. The ticket number has to be written not exactly on the first line  of the patch, but on the first line after the automatic data (the 5 lines starting with # HG etc until # Parent). Please compare what you have done (which is not correct) to what has been done for the reviewer patch.",
    "created_at": "2011-06-26T15:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108917",
    "user": "https://github.com/fchapoton"
}
```

Hum, sorry, but it seems that I was not clear enough. The ticket number has to be written not exactly on the first line  of the patch, but on the first line after the automatic data (the 5 lines starting with # HG etc until # Parent). Please compare what you have done (which is not correct) to what has been done for the reviewer patch.



---

archive/issue_comments_108918.json:
```json
{
    "body": "Sorry, I wasn't sure what status to use. I have merged the files and I will upload an all-inclusive patch after.\n\nNathann, there is a problem with your is_debruijn_sequence. For example, this\n\n[0,0,0,1,0,1,1,1] in DeBruijnSequences(2,3)\n\nreturns True, while this\n\n[1,0,0,0,1,0,1,1] in DeBruijnSequences(2,3)\n\nreturns False.",
    "created_at": "2011-06-26T20:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108918",
    "user": "https://github.com/eviatarbach"
}
```

Sorry, I wasn't sure what status to use. I have merged the files and I will upload an all-inclusive patch after.

Nathann, there is a problem with your is_debruijn_sequence. For example, this

[0,0,0,1,0,1,1,1] in DeBruijnSequences(2,3)

returns True, while this

[1,0,0,0,1,0,1,1] in DeBruijnSequences(2,3)

returns False.



---

archive/issue_comments_108919.json:
```json
{
    "body": "> Nathann, there is a problem with your is_debruijn_sequence.\n\nOops, you are right ! \n\nThe initialization was done with \n\n```\ncurrent = kk * current + s[-n+i]\n```\n\n\ninstead of \n\n```\ncurrent = kk * current + s[-n+i+1]\n```\n\n\nIt was no problem for the string ending with ones only, but it was of course incorrect.... Thank youuuuuu ! `:-)`\n\n(patch updated)\n\nNathann",
    "created_at": "2011-06-27T14:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108919",
    "user": "https://github.com/nathanncohen"
}
```

> Nathann, there is a problem with your is_debruijn_sequence.

Oops, you are right ! 

The initialization was done with 

```
current = kk * current + s[-n+i]
```


instead of 

```
current = kk * current + s[-n+i+1]
```


It was no problem for the string ending with ones only, but it was of course incorrect.... Thank youuuuuu ! `:-)`

(patch updated)

Nathann



---

archive/issue_comments_108920.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-06-27T14:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108920",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_108921.json:
```json
{
    "body": "Attachment [trac_10530-reviewer.patch](tarball://root/attachments/some-uuid/ticket10530/trac_10530-reviewer.patch) by @fchapoton created at 2011-06-28 07:52:27\n\nfor the bot:\n\nApply 10530.2.patch trac_10530-reviewer.patch",
    "created_at": "2011-06-28T07:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108921",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_10530-reviewer.patch](tarball://root/attachments/some-uuid/ticket10530/trac_10530-reviewer.patch) by @fchapoton created at 2011-06-28 07:52:27

for the bot:

Apply 10530.2.patch trac_10530-reviewer.patch



---

archive/issue_comments_108922.json:
```json
{
    "body": "Sorry for taking so long with the patch, but I'm having a hard time learning Mercurial queues.",
    "created_at": "2011-06-30T07:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108922",
    "user": "https://github.com/eviatarbach"
}
```

Sorry for taking so long with the patch, but I'm having a hard time learning Mercurial queues.



---

archive/issue_comments_108923.json:
```json
{
    "body": "Merged the two files, other fixes. Only one patch to apply now!",
    "created_at": "2011-06-30T22:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108923",
    "user": "https://github.com/eviatarbach"
}
```

Merged the two files, other fixes. Only one patch to apply now!



---

archive/issue_comments_108924.json:
```json
{
    "body": "Hello !!\n\nFirst, it is my mistake as it appeared in my previous patch, but clearly the second doctest should be changed `:-)`\n\n\n```\nif not True:\n```\n\n\nSomething like \n\n\n```\nD.an_element() in D\n```\n\n\nWould be much better !\n\nThen, do you get a warning when you build the documentation ? Here's what I get :\n\n\n```\n/home/ncohen/sage/devel/sage-4$ sage -docbuild reference html\n...\nreading sources... [100%] sage/combinat/debruijn_sequence                                                                                                                                                                                                                        \ndocstring of sage.combinat.debruijn_sequence:35: (WARNING/2) Inline interpreted text or phrase reference start-string without end-string.\n```\n\n\nBut sometimes this kind of bug just comes from having built the documentation many times while adding/removing files from it... `O_o`\n\nNathann",
    "created_at": "2011-07-01T13:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108924",
    "user": "https://github.com/nathanncohen"
}
```

Hello !!

First, it is my mistake as it appeared in my previous patch, but clearly the second doctest should be changed `:-)`


```
if not True:
```


Something like 


```
D.an_element() in D
```


Would be much better !

Then, do you get a warning when you build the documentation ? Here's what I get :


```
/home/ncohen/sage/devel/sage-4$ sage -docbuild reference html
...
reading sources... [100%] sage/combinat/debruijn_sequence                                                                                                                                                                                                                        
docstring of sage.combinat.debruijn_sequence:35: (WARNING/2) Inline interpreted text or phrase reference start-string without end-string.
```


But sometimes this kind of bug just comes from having built the documentation many times while adding/removing files from it... `O_o`

Nathann



---

archive/issue_comments_108925.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-01T13:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108925",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_108926.json:
```json
{
    "body": "I can never get it to build the documentation properly. It ignores debruijn_sequences.pyx for some reason.\n\nDo you have any idea what that warning could mean?",
    "created_at": "2011-07-02T02:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108926",
    "user": "https://github.com/eviatarbach"
}
```

I can never get it to build the documentation properly. It ignores debruijn_sequences.pyx for some reason.

Do you have any idea what that warning could mean?



---

archive/issue_comments_108927.json:
```json
{
    "body": "No idea `:-/`\n\nI've never been friends with Sphinx. When this kind of things happen, I usually swear a lot and reinstall Sage from scratch `^^;`\n\nNathann",
    "created_at": "2011-07-02T12:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108927",
    "user": "https://github.com/nathanncohen"
}
```

No idea `:-/`

I've never been friends with Sphinx. When this kind of things happen, I usually swear a lot and reinstall Sage from scratch `^^;`

Nathann



---

archive/issue_comments_108928.json:
```json
{
    "body": "Replying to [comment:45 ncohen]:\n> No idea `:-/`\n> \n> I've never been friends with Sphinx. When this kind of things happen, I usually swear a lot and reinstall Sage from scratch `^^;`\n\nDeleting doc/output (or sometimes just doc/output/doctrees is still quite brute force but usually works.\n\nJust to make sure: debruijn_sequences.pyx is referenced in doc/en/reference/combinat/index.rst?",
    "created_at": "2011-07-02T13:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108928",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:45 ncohen]:
> No idea `:-/`
> 
> I've never been friends with Sphinx. When this kind of things happen, I usually swear a lot and reinstall Sage from scratch `^^;`

Deleting doc/output (or sometimes just doc/output/doctrees is still quite brute force but usually works.

Just to make sure: debruijn_sequences.pyx is referenced in doc/en/reference/combinat/index.rst?



---

archive/issue_comments_108929.json:
```json
{
    "body": "Nathann, I can relate. That's what I'm going to do now. Unfortunately my computer takes ages to build the documentation.\n\ndebruijn_sequence.pyx is referenced in index.rst.",
    "created_at": "2011-07-02T17:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108929",
    "user": "https://github.com/eviatarbach"
}
```

Nathann, I can relate. That's what I'm going to do now. Unfortunately my computer takes ages to build the documentation.

debruijn_sequence.pyx is referenced in index.rst.



---

archive/issue_comments_108930.json:
```json
{
    "body": "Hello Nathann,\n\nI tried building the documentation, and I'm getting the same warning. Do you think it would be okay to submit it anyways?\n\nWhat's the point of this test?\n\n    sage: for n in range(1, 7):\n...      for k in range(1, 7):\n...         D = DeBruijnSequences(k, n)\n...         if not True:\n...             print \"Something's dead wrong (n = \", n, \"k =\", k, \") !\"\n...             break\n\nI don't see how this can fail.",
    "created_at": "2011-07-08T01:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108930",
    "user": "https://github.com/eviatarbach"
}
```

Hello Nathann,

I tried building the documentation, and I'm getting the same warning. Do you think it would be okay to submit it anyways?

What's the point of this test?

    sage: for n in range(1, 7):
...      for k in range(1, 7):
...         D = DeBruijnSequences(k, n)
...         if not True:
...             print "Something's dead wrong (n = ", n, "k =", k, ") !"
...             break

I don't see how this can fail.



---

archive/issue_comments_108931.json:
```json
{
    "body": "Yooooo !\n\n> I tried building the documentation, and I'm getting the same warning. Do you think it would be okay to submit it anyways?\n\nNo, it has to be fixed ! The release manager will set it back to needs/work otherwise anyway `;-)`\n\n> What's the point of this test?\n\nAs I trold you during my latest review, the \n\n\n```\nif not True:\n```\n\n\nShould be repaced by \n\n\n```\nD.an_element() in D\n```\n\n\nThe aim is to check that all the small DeBruijnSequences that the code return are indeed valid `:-)`\n\nNathann",
    "created_at": "2011-07-08T07:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108931",
    "user": "https://github.com/nathanncohen"
}
```

Yooooo !

> I tried building the documentation, and I'm getting the same warning. Do you think it would be okay to submit it anyways?

No, it has to be fixed ! The release manager will set it back to needs/work otherwise anyway `;-)`

> What's the point of this test?

As I trold you during my latest review, the 


```
if not True:
```


Should be repaced by 


```
D.an_element() in D
```


The aim is to check that all the small DeBruijnSequences that the code return are indeed valid `:-)`

Nathann



---

archive/issue_comments_108932.json:
```json
{
    "body": "Replying to [comment:49 ncohen]:\n> {{{\n> D.an_element() in D\n> }}}\n\nFor the record: this is among the generic sanity checks that ``TestSuite(D).run()`` does.",
    "created_at": "2011-07-11T08:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108932",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:49 ncohen]:
> {{{
> D.an_element() in D
> }}}

For the record: this is among the generic sanity checks that ``TestSuite(D).run()`` does.



---

archive/issue_comments_108933.json:
```json
{
    "body": "I fixed the docbuild warning (had to quarantine successive parts of the documentation in order to isolate the problem!). It was due to the whitespace before the URL for the Wikipedia link.\n\nI also fixed the doctest.",
    "created_at": "2011-07-12T05:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108933",
    "user": "https://github.com/eviatarbach"
}
```

I fixed the docbuild warning (had to quarantine successive parts of the documentation in order to isolate the problem!). It was due to the whitespace before the URL for the Wikipedia link.

I also fixed the doctest.



---

archive/issue_comments_108934.json:
```json
{
    "body": "Attachment [10530.patch](tarball://root/attachments/some-uuid/ticket10530/10530.patch) by @eviatarbach created at 2011-07-12 06:01:46",
    "created_at": "2011-07-12T06:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108934",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [10530.patch](tarball://root/attachments/some-uuid/ticket10530/10530.patch) by @eviatarbach created at 2011-07-12 06:01:46



---

archive/issue_comments_108935.json:
```json
{
    "body": "yeahhhhhhhhhhhhhh !\n\nPositive review to this patch `:-)` \n\nNice job debugging the Sphinx warning. I'll keep that in mind for my future patch : I very often spend 10 minutes on each of those `;-)`\n\nNathann",
    "created_at": "2011-07-12T08:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108935",
    "user": "https://github.com/nathanncohen"
}
```

yeahhhhhhhhhhhhhh !

Positive review to this patch `:-)` 

Nice job debugging the Sphinx warning. I'll keep that in mind for my future patch : I very often spend 10 minutes on each of those `;-)`

Nathann



---

archive/issue_comments_108936.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-07-12T08:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108936",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_108937.json:
```json
{
    "body": "Yes! Finally :)",
    "created_at": "2011-07-12T08:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108937",
    "user": "https://github.com/eviatarbach"
}
```

Yes! Finally :)



---

archive/issue_comments_108938.json:
```json
{
    "body": "Thank you Nathann and Nicolas for reviewing!",
    "created_at": "2011-07-12T19:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108938",
    "user": "https://github.com/eviatarbach"
}
```

Thank you Nathann and Nicolas for reviewing!



---

archive/issue_comments_108939.json:
```json
{
    "body": "for the bot\n\nApply 10530.patch",
    "created_at": "2011-07-22T19:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108939",
    "user": "https://github.com/fchapoton"
}
```

for the bot

Apply 10530.patch



---

archive/issue_events_010607.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:02:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10477#event-10607"
}
```



---

archive/issue_comments_108940.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-08-18T22:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10477#issuecomment-108940",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
