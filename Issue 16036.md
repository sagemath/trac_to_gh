# Issue 16036: update README

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2014-05-01 18:28:26




---

Comment by vbraun created at 2014-05-01 19:19:16

Changing type from PLEASE CHANGE to enhancement.


---

Comment by vbraun created at 2014-05-01 19:19:16

New commits:


---

Comment by vbraun created at 2014-05-01 19:19:16

Changing component from PLEASE CHANGE to documentation.


---

Comment by vbraun created at 2014-05-01 19:19:16

Changing status from new to needs_review.


---

Comment by was created at 2014-05-01 19:38:02

Fantastic!  Here's a few very small remarks/typos (see below).  Once addressed, this should get a positive review.

- Could we change "6. OPTIONAL: Type "make ptest" to test all examples in the documentation (over 93,000 lines of input!)" to "6. OPTIONAL: Type "make ptest" to test all examples in the documentation (over 200,000 lines of input!)", since:


```
/usr/local/sage/current/src/sage$ grep -r sage: * | grep -v \.c: | grep -v \.cpp | wc -l
212574
```


- "First, install OpenSSL and the OpenSSL development headers on your system if they are not already." --> "First, install OpenSSL and the OpenSSL development headers on your system if they are not already installed." 

- "install.log       Full intall log" -> "install.log       Full install log"

- I'm glad there is a "DIRECTORY LAYOUT" section.  It's not quite perfect, though.   For example, my first question to sage-devel is "where is the temporary build directory when installing packages? (used to be spkg/build)". Looking at DIRECTORY LAYOUT one finds that SAGE_ROOT/tmp is described as "Temporary files when building Sage", which suggests that should be the answer to my question.  However, it just isn't, since, e.g., R is built in "local/var/tmp/sage/build/r-3.0.2.p1".  And there's no symlink involved here either.   This question isn't answered either: "where are the databases? (used to be data/)".


---

Comment by was created at 2014-05-01 19:38:09

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2014-05-01 19:43:10

I just don't think that many people want to hear where temporary files are during build. If something goes wrong then the error log already tells you where to go to try to fix it up.


---

Comment by ohanar created at 2014-05-01 19:51:38

I actually don't think `SAGE_ROOT/tmp` is used in the build process (anymore?). At least I don't recall seeing anything about it (other than its creation) when working on the git transition.


---

Comment by git created at 2014-05-01 19:53:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2014-05-01 19:54:48

Replying to [comment:6 ohanar]:
> I actually don't think `SAGE_ROOT/tmp` is used in the build process 

Agree, seems to be unnecessary.


---

Comment by jhpalmieri created at 2014-05-01 20:18:12

The build directory is documented (somewhat) in the installation guide, but it's out-of-date: look at http://www.sagemath.org/doc/installation/source.html#environment-variables, under `SAGE_BUILD_DIR` and also `SAGE_KEEP_BUILT_SPKGS`. (The discussion of the variable `SAGE_SERVER` also refers to the `spkg` directory, by the way, and there are two references to the `devel` directory.) That should be fixed, too. Here? Another ticket?


---

Comment by jhpalmieri created at 2014-05-01 20:30:03

Here are some suggested changes to the installation guide. 

```diff
diff --git a/src/doc/en/installation/source.rst b/src/doc/en/installation/source.rst
index a848cc2..a7d2c2b 100644
--- a/src/doc/en/installation/source.rst
+++ b/src/doc/en/installation/source.rst
`@``@` -886,9 +886,10 `@``@` Here are some of the more commonly used variables affecting the build process:
   and uses more memory and disk space than using MathJax.
 
 - :envvar:`SAGE_BUILD_DIR` - the default behavior is to build each spkg in a
-  subdirectory of :file:`$SAGE_ROOT/spkg/build/`; for example, build
+  subdirectory of :file:`$SAGE_ROOT/local/var/tmp/sage/build/`; for
+  example, build
   :file:`atlas-3.8.3.p12.spkg` in the directory
-  :file:`$SAGE_ROOT/spkg/build/atlas-3.8.3.p12/`.
+  :file:`$SAGE_ROOT/local/var/tmp/sage/build/atlas-3.8.3.p12/`.
   If this variable is set, then build in
   :file:`$SAGE_BUILD_DIR/atlas-3.8.3.p12/` instead.
   If the directory :file:`$SAGE_BUILD_DIR` does not exist, it is created.
`@``@` -909,7 +910,8 `@``@` Here are some of the more commonly used variables affecting the build process:
 
 - :envvar:`SAGE_KEEP_BUILT_SPKGS` - the default behavior is to delete each
   build directory -- the appropriate subdirectory of
-  :file:`$SAGE_ROOT/spkg/build` or :file:`$SAGE_BUILD_DIR` -- after each spkg
+  :file:`$SAGE_ROOT/local/var/tmp/sage/build` or
+  :file:`$SAGE_BUILD_DIR` -- after each spkg
   is successfully built, and to keep it if there were errors installing the
   spkg.
   Set this variable to ``yes`` to keep the subdirectory regardless.
`@``@` -917,7 +919,8 `@``@` Here are some of the more commonly used variables affecting the build process:
   corresponding subdirectory, for example left over from a previous build,
   then the default behavior is to delete that old subdirectory.
   If this variable is set to ``yes``, then the old subdirectory is moved to
-  :file:`$SAGE_ROOT/spkg/build/old/` (or :file:`$SAGE_BUILD_DIR/old`),
+  :file:`$SAGE_ROOT/local/var/tmp/sage/build/old/`
+  (or :file:`$SAGE_BUILD_DIR/old`),
   overwriting any already existing file or directory with the same name.
 
   .. note::
`@``@` -1106,13 +1109,13 `@``@` Sage uses the following environment variables when it runs:
   If you wish to set up your own server, then note that Sage will search the
   directories:
 
-  - ``SAGE_SERVER/packages/standard/``,
-  - ``SAGE_SERVER/packages/optional/``,
-  - ``SAGE_SERVER/packages/experimental/``,
-  - and ``SAGE_SERVER/packages/archive/``
+  - ``SAGE_SERVER/spkg/standard/``,
+  - ``SAGE_SERVER/spkg/optional/``,
+  - ``SAGE_SERVER/spkg/experimental/``,
+  - and ``SAGE_SERVER/spkg/archive/``
 
   for packages.
-  See the script :file:`$SAGE_ROOT/spkg/bin/sage-spkg` for the implementation.
+  See the script :file:`$SAGE_ROOT/src/bin/sage-spkg` for the implementation.
 
 - :envvar:`SAGE_PATH` - a colon-separated list of directories which Sage
   searches when trying to locate Python libraries.
`@``@` -1129,7 +1132,7 `@``@` Sage uses the following environment variables when it runs:
   set the :envvar:`DYLD_LIBRARY_PATH` variable.
 
 - :envvar:`SAGE_CBLAS` - used in the file
-  :file:`SAGE_ROOT/devel/sage/sage/misc/cython.py`.
+  :file:`SAGE_ROOT/src/sage/misc/cython.py`.
   Set this to the base name of the BLAS library file on your system if you want
   to override the default setting.
   That is, if the relevant file is called :file:`libcblas_new.so` or
`@``@` -1159,7 +1162,7 `@``@` Variables dealing with doctesting:
   jar, set this to something non-empty and run the doctest suite.
   See the documentation for the functions :func:`picklejar` and
   :func:`unpickle_all` in
-  :file:`$SAGE_ROOT/devel/sage/sage/structure/sage_object.pyx`, online
+  :file:`$SAGE_ROOT/src/sage/structure/sage_object.pyx`, online
   `here (picklejar)
   <http://sagemath.org/doc/reference/sage/structure/sage_object.html#sage.structure.sage_object.picklejar>`_
   and `here (unpickle_all)
`@``@` -1287,4 +1290,4 `@``@` would be appropriate if you have a Core i3/5/7 processor with AVX support.
 
 
 
-**This page was last updated in October 2013 (Sage 5.12).**
+**This page was last updated in May 2014 (Sage 6.2).**
```

There are other parts which are probably outdated:

```
  As of this writing (Sage 4.8), when building the standard Sage packages,
  1.5 gigabytes of free space are required in this directory (or more if
  ``SAGE_KEEP_BUILT_SPKGS=yes`` -- see below); the exact amount of required
  space varies from platform to platform.
```

and

```
      After a full build of Sage (as of version 4.8), these subdirectories can
      take up to 6 gigabytes of storage, in total, depending on the platform
      and the block size of the file system.
```

I don't know what these storage requirements should be now, but it's not as important as the other changes being discussed here.


---

Comment by vbraun created at 2014-05-01 21:58:54

John: sounds good to me, are you going to push your branch?


---

Comment by vbraun created at 2014-05-01 22:15:41

Changing priority from major to blocker.


---

Comment by jhpalmieri created at 2014-05-01 23:44:03

Okay, here are my changes. Does this still need work, or have the issues been fixed?
----
New commits:


---

Comment by jhpalmieri created at 2014-05-01 23:45:10

Sorry, I'm still not used to git. I thought my branch would include Volker's original changes, but it didn't. What should I have done differently?


---

Comment by vbraun created at 2014-05-02 19:02:53

No, you did everything correctly. Your commit is on top of mine...


---

Comment by vbraun created at 2014-05-02 19:02:53

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-05-04 13:56:22

Resolution: fixed


---

Comment by kcrisman created at 2014-05-20 18:37:09

Did anything here help with #5505?  Just askin'.
