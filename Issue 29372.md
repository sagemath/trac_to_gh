# Issue 29372: Compute the Conway mass directly from the genus symbol.

Issue created by migration from https://trac.sagemath.org/ticket/29609

Original creator: sbrandhorst

Original creation time: 2020-04-28 12:22:16

Conway and Sloana's formalism to compute the mass starts with their genus symbol. 
Currently the quadratic forms code does this in a detour. 

This ticket moves this functionality to the genus class where it really belongs.


---

Comment by sbrandhorst created at 2020-04-28 22:27:20

Changing status from new to needs_review.


---

Comment by sbrandhorst created at 2020-04-28 22:27:20

New commits:


---

Comment by chapoton created at 2020-04-29 06:46:12

patchbot's pyflakes plugin is not happy


---

Comment by chapoton created at 2020-04-29 07:34:35

typo "are taken crom"

Better avoid unicode dash between pages numbers in the reference file


---

Comment by sbrandhorst created at 2020-04-29 10:11:18

Note:
The mass computation should be correct. I compared mass computations for all genera of rank 3 and 4 and determinant < 1000 with magma.


---

Comment by git created at 2020-04-29 11:02:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2020-04-29 11:06:39

I guess in a follow up one could deprecate

```
conway_species_list_at_odd_prime, \
conway_species_list_at_2, \
conway_octane_of_this_unimodular_Jordan_block_at_2, \
conway_diagonal_factor, \
conway_cross_product_doubled_power, \
conway_type_factor, \
conway_p_mass, \
conway_standard_p_mass, \
conway_standard_mass, \
```

From my point of view the functions above have no value for themselves they are just intermediate results of the mass computation.


---

Comment by chapoton created at 2020-04-29 18:42:01

a few more comments:

* Do you really need srange ?

* The comment "# By conway-sloane we have to compensate the missing euler factors" could use capitals for names.

* The 3 new raise statements must be doctested, for example `raise ValueError("Genus must be definite.")`


---

Comment by chapoton created at 2020-05-01 07:48:06

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-05-01 17:59:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2020-05-01 18:00:14

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2020-05-01 18:28:57

You need only a single colon after TESTS here

```
+        TESTS::
+
+        Check a random genus magma::
```


Why did you keep the import of srange ?


---

Comment by git created at 2020-05-01 18:32:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2020-05-01 18:32:55

Forgot to commit. Hope it is okay now.


---

Comment by chapoton created at 2020-05-02 06:16:32

ok, let it be. Too bad that you need the symbolic ring.


---

Comment by chapoton created at 2020-05-02 06:16:32

Changing status from needs_review to positive_review.


---

Comment by sbrandhorst created at 2020-05-03 15:03:39

Do you think it slows down things a lot? 
I guess one could get rid of SR when combining factors correctly. But it is more work.


---

Comment by vbraun created at 2020-05-04 06:40:49

Resolution: fixed
