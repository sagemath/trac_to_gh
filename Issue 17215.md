# Issue 17215: LinearCode should check the rank

archive/issues_017215.json:
```json
{
    "body": "CC:  @wdjoyner\n\nHi,\n\nIn [a question on ask.sagemath.org](http://ask.sagemath.org/question/24504/a-bug-in-computing-minimum-distance-coding-theory/) was presented the following problem\n\n```\nsage: K = GF(4,\"a\")\nsage: a = K.gen()\nsage: G = Matrix([[a, a + 1, 1, a + 1, 1, 0, 0],\n....:             [0, a, a + 1, 1, a + 1, 1, 0],\n....:             [0, 0, a, a + 1, 1, a + 1, 1],\n....:             [a + 1, 0, 1, 0, a + 1, 1, a + 1],\n....:             [a, a + 1, a + 1, 0, 0, a + 1, 1],\n....:             [a + 1, a, a, 1, 0, 0, a + 1],\n....:             [a, a + 1, 1, a + 1, 1, 0, 0]])\nsage: C = LinearCode(G)\nsage: C.minimum_distance()\n5\n```\n\nwhereas the code has distance 3. The problem is that the input matrix does not has full rank... but this is never tested!\n\nIssue created by migration from https://trac.sagemath.org/ticket/17452\n\n",
    "created_at": "2014-12-06T23:32:22Z",
    "labels": [
        "coding theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "LinearCode should check the rank",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17215",
    "user": "@videlec"
}
```
CC:  @wdjoyner

Hi,

In [a question on ask.sagemath.org](http://ask.sagemath.org/question/24504/a-bug-in-computing-minimum-distance-coding-theory/) was presented the following problem

```
sage: K = GF(4,"a")
sage: a = K.gen()
sage: G = Matrix([[a, a + 1, 1, a + 1, 1, 0, 0],
....:             [0, a, a + 1, 1, a + 1, 1, 0],
....:             [0, 0, a, a + 1, 1, a + 1, 1],
....:             [a + 1, 0, 1, 0, a + 1, 1, a + 1],
....:             [a, a + 1, a + 1, 0, 0, a + 1, 1],
....:             [a + 1, a, a, 1, 0, 0, a + 1],
....:             [a, a + 1, 1, a + 1, 1, 0, 0]])
sage: C = LinearCode(G)
sage: C.minimum_distance()
5
```

whereas the code has distance 3. The problem is that the input matrix does not has full rank... but this is never tested!

Issue created by migration from https://trac.sagemath.org/ticket/17452





---

archive/issue_comments_229007.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-12-07T00:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229007",
    "user": "@videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_229008.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-12-07T00:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229008",
    "user": "@videlec"
}
```

New commits:



---

archive/issue_comments_229009.json:
```json
{
    "body": "Wow. Thank you for fixing that and cleaning the code a bit, it was really ugly. It took me a long time only to understand what it did, and I had your commit to help me `O_o`\n\nI do not get why that code would return a `d` equal to zero, however... What is the meaning of that ?\n\nIt is not really a problem for the review, that's what the code deals with already... But I would be glad to understand.\n\nI would also be glad to understand why the GAP function is so complicated and takes this 'i' as a parameter, but well `O_o`\n\nNathann",
    "created_at": "2014-12-23T15:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229009",
    "user": "@nathanncohen"
}
```

Wow. Thank you for fixing that and cleaning the code a bit, it was really ugly. It took me a long time only to understand what it did, and I had your commit to help me `O_o`

I do not get why that code would return a `d` equal to zero, however... What is the meaning of that ?

It is not really a problem for the review, that's what the code deals with already... But I would be glad to understand.

I would also be glad to understand why the GAP function is so complicated and takes this 'i' as a parameter, but well `O_o`

Nathann



---

archive/issue_comments_229010.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-12-23T15:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229010",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_229011.json:
```json
{
    "body": "Wonderful. Thanks!\n\nVincent",
    "created_at": "2014-12-23T16:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229011",
    "user": "@videlec"
}
```

Wonderful. Thanks!

Vincent



---

archive/issue_comments_229012.json:
```json
{
    "body": "To answer your question, I guess that the GAP function `AClosestVectorCombinationsMatFFEVecFFECoords` is really stupid: it just runs through all possible linear combinations with no zero coefficient (though, I did not look at the source code). Anyway, it is fast enough on reasonable input. From this function, if you obtain a 0 it means that your input vectors were not linearly independent (and its perfectly fine from the specification above). It perhaps would be safer to through an error there instead of silently ignore it.\n\nVincent",
    "created_at": "2014-12-23T18:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229012",
    "user": "@videlec"
}
```

To answer your question, I guess that the GAP function `AClosestVectorCombinationsMatFFEVecFFECoords` is really stupid: it just runs through all possible linear combinations with no zero coefficient (though, I did not look at the source code). Anyway, it is fast enough on reasonable input. From this function, if you obtain a 0 it means that your input vectors were not linearly independent (and its perfectly fine from the specification above). It perhaps would be safer to through an error there instead of silently ignore it.

Vincent



---

archive/issue_comments_229013.json:
```json
{
    "body": "HMmmmm... Okay... If it is that stupid perhaps we should rewrite it ourselves someday.... `O_o`\n\nWeird.\n\nNathann",
    "created_at": "2014-12-23T18:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229013",
    "user": "@nathanncohen"
}
```

HMmmmm... Okay... If it is that stupid perhaps we should rewrite it ourselves someday.... `O_o`

Weird.

Nathann



---

archive/issue_comments_229014.json:
```json
{
    "body": "I just looked at gap source code. My rough idea was right but there is a bunch of optimizations to minimize arithmetic operations. Why would you like to duplicate something like that?\n\nVincent",
    "created_at": "2014-12-23T18:14:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229014",
    "user": "@videlec"
}
```

I just looked at gap source code. My rough idea was right but there is a bunch of optimizations to minimize arithmetic operations. Why would you like to duplicate something like that?

Vincent



---

archive/issue_comments_229015.json:
```json
{
    "body": "> I just looked at gap source code. My rough idea was right but there is a bunch of optimizations to minimize arithmetic operations. Why would you like to duplicate something like that?\n\nDon't know... Perhaps only to not have to give the matrix to gap, then get vectors back... Things like that. I would not object if the interface was cleaner perhaps, but those matrices encoded as strings are too much for me `:-P`\n\nNathann",
    "created_at": "2014-12-23T18:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229015",
    "user": "@nathanncohen"
}
```

> I just looked at gap source code. My rough idea was right but there is a bunch of optimizations to minimize arithmetic operations. Why would you like to duplicate something like that?

Don't know... Perhaps only to not have to give the matrix to gap, then get vectors back... Things like that. I would not object if the interface was cleaner perhaps, but those matrices encoded as strings are too much for me `:-P`

Nathann



---

archive/issue_comments_229016.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-02T15:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17215#issuecomment-229016",
    "user": "@vbraun"
}
```

Resolution: fixed
