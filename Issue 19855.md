# Issue 19855: Inconsistent doc for Graph.matching()

Issue created by migration from Trac.

Original creator: egunawan

Original creation time: 2016-02-21 17:23:26

CC:  tscrim ncohen

Keywords: matching, graph

In the method Graph.matching(), the doc says:

```
- ``use_edge_labels`` -- boolean (default: ``False``)
```

But in fact `use_edge_labels` is set to True by default.

Question: Should the doc be changed or should the default value be changed?

Currently working with Sage version 7.1.beta3


---

Comment by ncohen created at 2016-02-21 18:02:05

To me, having it fixed in any way is good for as long as it is fixed. I would personally enforce in the code what the doc says, for I expect graph functions to not try to understand the labels unless I explicitly want it to. I'm likely to have my edges labelled with things that make sense to me (color classes for example) and that would not make any sense if understood as a weight.

Though that's only me.

Nathann


---

Comment by tscrim created at 2016-02-23 23:05:57

IMO the least surprising thing (i.e., least likely to break 3rd party code) is to change the default listed in doc so that it matches the code. However, given the extra data that needs to be processed and Nathann's comment (plus my own personal use cases), I think the best thing to do is just change the default value to `False`.


---

Comment by egunawan created at 2016-02-29 00:30:45

New commits:


---

Comment by egunawan created at 2016-02-29 00:30:45

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-02-29 06:20:14

Can you explain what the bug was (including the code which resulted in the bug)? Also could you explain this change to me? I don't see the point in creating a new graph and if this is necessary, why don't you cal `copy`?

```diff
-                g = self.networkx_graph(copy=False)
+                g = Graph(self.edges(labels=False))
+                g = g.networkx_graph(copy=False)
```

Also I don't think this change is good

```diff
-                    return Integer(len(d)/2)
+                    return len(d)/2
```

as now the output is not guaranteed to be a Sage integer. We try to make sure python `int`s don't escape to the user.


---

Comment by egunawan created at 2016-02-29 06:58:36

This is the bug: currently the method takes into account the weights of the edges, if `use_edge_labels=False`:

```
sage: g=Graph([(0,1),(1,2),(2,3)])
sage: g.matching()
[(0, 1, None), (2, 3, None)]

sage: gw=Graph([(0,1,1),(1,2,99),(2,3,1)])
sage: gw.matching(use_edge_labels=False)
[(1, 2, 99)]
```



---

Comment by egunawan created at 2016-02-29 06:58:58

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-02-29 07:08:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-03-02 15:11:29

Changing type from PLEASE CHANGE to defect.


---

Comment by tscrim created at 2016-03-02 15:11:29

I made some changes (and rebased to 7.1.beta5) to improve the speed/memory usage, standardize the doc, and make the output types more consistent/compatible. If you agree with my changes, then you can set a positive review.
----
New commits:


---

Comment by tscrim created at 2016-03-02 15:11:29

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-01-05 12:49:08

ok, let it be


---

Comment by chapoton created at 2017-01-05 12:49:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-18 20:39:58

Resolution: fixed
