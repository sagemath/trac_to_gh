# Issue 15040: CartanMatrix to DynkinDiagram adds edges with zeros

archive/issues_015040.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @anneschilling @nthiery\n\nKeywords: Cartan matrix Dynkin diagram\n\nCurrently we have:\n\n```\nsage: CM = CartanMatrix([[2,-1,0,0],[-3,2,-2,-2],[0,-1,2,-1],[0,-1,-1,2]])\nsage: CM\n[ 2 -1  0  0]\n[-3  2 -2 -2]\n[ 0 -1  2 -1]\n[ 0 -1 -1  2]\nsage: CM.dynkin_diagram().edges()\n[(0, 1, 3),\n (0, 2, 0),\n (0, 3, 0),\n (1, 0, 1),\n (1, 2, 1),\n (1, 3, 1),\n (2, 0, 0),\n (2, 1, 2),\n (2, 3, 1),\n (3, 0, 0),\n (3, 1, 2),\n (3, 2, 1)]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15277\n\n",
    "created_at": "2013-10-14T02:23:56Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "CartanMatrix to DynkinDiagram adds edges with zeros",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15040",
    "user": "https://github.com/tscrim"
}
```
Assignee: sage-combinat

CC:  sage-combinat @anneschilling @nthiery

Keywords: Cartan matrix Dynkin diagram

Currently we have:

```
sage: CM = CartanMatrix([[2,-1,0,0],[-3,2,-2,-2],[0,-1,2,-1],[0,-1,-1,2]])
sage: CM
[ 2 -1  0  0]
[-3  2 -2 -2]
[ 0 -1  2 -1]
[ 0 -1 -1  2]
sage: CM.dynkin_diagram().edges()
[(0, 1, 3),
 (0, 2, 0),
 (0, 3, 0),
 (1, 0, 1),
 (1, 2, 1),
 (1, 3, 1),
 (2, 0, 0),
 (2, 1, 2),
 (2, 3, 1),
 (3, 0, 0),
 (3, 1, 2),
 (3, 2, 1)]
```


Issue created by migration from https://trac.sagemath.org/ticket/15277





---

archive/issue_comments_191995.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-14T02:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-191995",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_191996.json:
```json
{
    "body": "Sounds good!\n\nWhile we are at it, what about using the following idiom:\n\n```\n    for (i,j) in M.nonzero_positions():\n        ...\n```\n\n\nGranted, exploiting sparseness here is essentially an eye candy:\nwe are not really likely to compute the dynkin diagrams of many large sparse cartan matrices where this would actually do a difference timewise. But still an eye candy :-)",
    "created_at": "2013-10-14T07:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-191996",
    "user": "https://github.com/nthiery"
}
```

Sounds good!

While we are at it, what about using the following idiom:

```
    for (i,j) in M.nonzero_positions():
        ...
```


Granted, exploiting sparseness here is essentially an eye candy:
we are not really likely to compute the dynkin diagrams of many large sparse cartan matrices where this would actually do a difference timewise. But still an eye candy :-)



---

archive/issue_comments_191997.json:
```json
{
    "body": "Attachment [trac_15277-dynkin_diagram_fix-ts.patch](tarball://root/attachments/some-uuid/ticket15277/trac_15277-dynkin_diagram_fix-ts.patch) by @tscrim created at 2013-10-14 16:18:41\n\nDone.",
    "created_at": "2013-10-14T16:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-191997",
    "user": "https://github.com/tscrim"
}
```

Attachment [trac_15277-dynkin_diagram_fix-ts.patch](tarball://root/attachments/some-uuid/ticket15277/trac_15277-dynkin_diagram_fix-ts.patch) by @tscrim created at 2013-10-14 16:18:41

Done.



---

archive/issue_comments_191998.json:
```json
{
    "body": "Attachment [trac_15277_review.patch](tarball://root/attachments/some-uuid/ticket15277/trac_15277_review.patch) by @fchapoton created at 2013-10-14 18:13:49\n\nHello,\n\nLooks good to me. I have added a small review patch.\n\n1) removing an unused import of sgn\n\n2) computing the value of ct, where it was needed\n\n3) removing the variable n\n\nIf you agree with these details (found with pyflakes), you can set positive review",
    "created_at": "2013-10-14T18:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-191998",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_15277_review.patch](tarball://root/attachments/some-uuid/ticket15277/trac_15277_review.patch) by @fchapoton created at 2013-10-14 18:13:49

Hello,

Looks good to me. I have added a small review patch.

1) removing an unused import of sgn

2) computing the value of ct, where it was needed

3) removing the variable n

If you agree with these details (found with pyflakes), you can set positive review



---

archive/issue_comments_191999.json:
```json
{
    "body": "I'm happy with it. Nicolas?",
    "created_at": "2013-10-14T18:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-191999",
    "user": "https://github.com/tscrim"
}
```

I'm happy with it. Nicolas?



---

archive/issue_comments_192000.json:
```json
{
    "body": "The changes to please pyflakes are not directly related with this ticket; but if there is no ongoing ticket which conflicts with this one, this occasion is as good as another. Thanks Travis and Frederic.",
    "created_at": "2013-10-14T19:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-192000",
    "user": "https://github.com/nthiery"
}
```

The changes to please pyflakes are not directly related with this ticket; but if there is no ongoing ticket which conflicts with this one, this occasion is as good as another. Thanks Travis and Frederic.



---

archive/issue_comments_192001.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-14T19:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-192001",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_192002.json:
```json
{
    "body": "This is the only ticket I know of that is changing `dynkin_diagram.py`, so I'm going to set this to positive review. Thanks Nicolas and Frederic.",
    "created_at": "2013-10-14T19:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-192002",
    "user": "https://github.com/tscrim"
}
```

This is the only ticket I know of that is changing `dynkin_diagram.py`, so I'm going to set this to positive review. Thanks Nicolas and Frederic.



---

archive/issue_events_014729.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2013-10-19T09:21:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15040#event-14729"
}
```



---

archive/issue_comments_192003.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-19T09:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15040#issuecomment-192003",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
