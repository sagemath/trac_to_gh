# Issue 10669: computing support of sum of two divisors doesn't work due to careless error

Issue created by migration from Trac.

Original creator: was

Original creation time: 2011-02-03 00:22:28

Assignee: AlexGhitza


```

sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)sage: pts = C.rational_points()
sage: D = C.divisor([(2,pts[0])])
sage: D.support()
[(0 : 4 : 1)]
sage: (D+D).support()
Traceback (most recent call last):...
```



---

Comment by AlexGhitza created at 2014-04-18 22:52:34

Changing status from new to needs_review.


---

Comment by AlexGhitza created at 2014-04-18 22:52:34

New commits:


---

Comment by chapoton created at 2014-04-20 08:57:15

It should be `This checks that :trac:` and not `This checks that trac::`


---

Comment by chapoton created at 2014-04-20 08:57:15

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-04-22 22:20:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by AlexGhitza created at 2014-04-22 22:21:14

Changing status from needs_work to needs_review.


---

Comment by pbruin created at 2014-04-23 11:26:27

I haven't looked at this in detail, but you use the method `rational_points()` of the subscheme defined by the divisor.  Wouldn't `irreducible_components()` be the right thing to use, to handle the case where the support contains non-rational points?


---

Comment by AlexGhitza created at 2014-04-24 06:30:41

I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).

How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.


---

Comment by pbruin created at 2014-04-24 11:19:48

Replying to [comment:10 AlexGhitza]:
> I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).
Wow, and there doesn't even seem to be a ticket for it!  I'm not sure if I agree with the TODO; I would say a divisor is a sum of prime divisors (closed points of the scheme), and if you want arbitrary sums of _L_-rational points you have to base change to _L_.
> How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.
That is a good idea.  Could you also delete the trailing whitespace in the first empty line after the function?  Then you can set it to positive review.


---

Comment by pbruin created at 2014-04-24 11:29:41

Replying to [comment:11 pbruin]:
> there doesn't even seem to be a ticket for it
This is now #16225.


---

Comment by git created at 2014-04-24 13:09:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by AlexGhitza created at 2014-04-24 13:10:27

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-25 14:20:51

Resolution: fixed
