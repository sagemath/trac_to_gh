# Issue 10669: computing support of sum of two divisors doesn't work due to careless error

archive/issues_010669.json:
```json
{
    "body": "Assignee: @aghitza\n\n\n```\n\nsage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)sage: pts = C.rational_points()\nsage: D = C.divisor([(2,pts[0])])\nsage: D.support()\n[(0 : 4 : 1)]\nsage: (D+D).support()\nTraceback (most recent call last):...\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10732\n\n",
    "created_at": "2011-02-03T00:22:28Z",
    "labels": [
        "algebraic geometry",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "computing support of sum of two divisors doesn't work due to careless error",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10669",
    "user": "@williamstein"
}
```
Assignee: @aghitza


```

sage: R.<x,y,z> = GF(5)[]; C = Curve(x^7 + y^7 + z^7)sage: pts = C.rational_points()
sage: D = C.divisor([(2,pts[0])])
sage: D.support()
[(0 : 4 : 1)]
sage: (D+D).support()
Traceback (most recent call last):...
```


Issue created by migration from https://trac.sagemath.org/ticket/10732





---

archive/issue_comments_112074.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-18T22:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112074",
    "user": "@aghitza"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_112075.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-04-18T22:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112075",
    "user": "@aghitza"
}
```

New commits:



---

archive/issue_comments_112076.json:
```json
{
    "body": "It should be `This checks that :trac:` and not `This checks that trac::`",
    "created_at": "2014-04-20T08:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112076",
    "user": "@fchapoton"
}
```

It should be `This checks that :trac:` and not `This checks that trac::`



---

archive/issue_comments_112077.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-20T08:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112077",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_112078.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-22T22:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112078",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_112079.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-22T22:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112079",
    "user": "@aghitza"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_112080.json:
```json
{
    "body": "I haven't looked at this in detail, but you use the method `rational_points()` of the subscheme defined by the divisor.  Wouldn't `irreducible_components()` be the right thing to use, to handle the case where the support contains non-rational points?",
    "created_at": "2014-04-23T11:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112080",
    "user": "@pjbruin"
}
```

I haven't looked at this in detail, but you use the method `rational_points()` of the subscheme defined by the divisor.  Wouldn't `irreducible_components()` be the right thing to use, to handle the case where the support contains non-rational points?



---

archive/issue_comments_112081.json:
```json
{
    "body": "I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).\n\nHow about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.",
    "created_at": "2014-04-24T06:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112081",
    "user": "@aghitza"
}
```

I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).

How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.



---

archive/issue_comments_112082.json:
```json
{
    "body": "Replying to [comment:10 AlexGhitza]:\n> I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).\nWow, and there doesn't even seem to be a ticket for it!  I'm not sure if I agree with the TODO; I would say a divisor is a sum of prime divisors (closed points of the scheme), and if you want arbitrary sums of *L*-rational points you have to base change to *L*.\n> How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.\nThat is a good idea.  Could you also delete the trailing whitespace in the first empty line after the function?  Then you can set it to positive review.",
    "created_at": "2014-04-24T11:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112082",
    "user": "@pjbruin"
}
```

Replying to [comment:10 AlexGhitza]:
> I agree that this would be better, however Sage can't yet deal with divisors containing non-rational points (see the TODO in the docstring of `Divisor_curve` in `sage/schemes/generic/divisor.py`).
Wow, and there doesn't even seem to be a ticket for it!  I'm not sure if I agree with the TODO; I would say a divisor is a sum of prime divisors (closed points of the scheme), and if you want arbitrary sums of *L*-rational points you have to base change to *L*.
> How about a comment in the new code saying that we should use `irreducible_components()` as soon as non-rational points can be dealt with?  I'd rather not postpone fixing an existing issue while we wait for new functionality that could take a while to arrive.
That is a good idea.  Could you also delete the trailing whitespace in the first empty line after the function?  Then you can set it to positive review.



---

archive/issue_comments_112083.json:
```json
{
    "body": "Replying to [comment:11 pbruin]:\n> there doesn't even seem to be a ticket for it\nThis is now #16225.",
    "created_at": "2014-04-24T11:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112083",
    "user": "@pjbruin"
}
```

Replying to [comment:11 pbruin]:
> there doesn't even seem to be a ticket for it
This is now #16225.



---

archive/issue_comments_112084.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-24T13:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112084",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_112085.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-24T13:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112085",
    "user": "@aghitza"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_112086.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-25T14:20:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10669#issuecomment-112086",
    "user": "@vbraun"
}
```

Resolution: fixed
