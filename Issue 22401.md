# Issue 22401: "python" = python2 even with SAGE_PYTHON3=yes

archive/issues_022401.json:
```json
{
    "body": "CC:  chapoton\n\nWhen installing Sage with `SAGE_PYTHON3=yes`, the program `python` points to `python2`. This causes build-time problems like\n\n```\n[sagelib-7.6.rc1] ************************************************************************\n[sagelib-7.6.rc1] Traceback (most recent call last):\n[sagelib-7.6.rc1]   File \"setup.py\", line 54, in <module>\n[sagelib-7.6.rc1]     import sage.env\n[sagelib-7.6.rc1]   File \"/usr/local/src/sage-config/src/sage/env.py\", line 87, in <module>\n[sagelib-7.6.rc1]     _add_variable_or_fallback('UNAME',           os.uname()[0])\n[sagelib-7.6.rc1]   File \"/usr/local/src/sage-config/src/sage/env.py\", line 71, in _add_variable_or_fallback\n[sagelib-7.6.rc1]     import six\n[sagelib-7.6.rc1] ImportError: No module named six\n[sagelib-7.6.rc1] ************************************************************************\n[sagelib-7.6.rc1] Error building the Sage library\n[sagelib-7.6.rc1] ************************************************************************\n[sagelib-7.6.rc1] Please email sage-devel (http://groups.google.com/group/sage-devel)\n[sagelib-7.6.rc1] explaining the problem and including the relevant part of the log file\n[sagelib-7.6.rc1]   /usr/local/src/sage-config/logs/pkgs/sagelib-7.6.rc1.log\n[sagelib-7.6.rc1] Describe your computer, operating system, etc.\n[sagelib-7.6.rc1] ************************************************************************\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22638\n\n",
    "created_at": "2017-03-18T14:25:27Z",
    "labels": [
        "python3",
        "major",
        "bug"
    ],
    "title": "\"python\" = python2 even with SAGE_PYTHON3=yes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22401",
    "user": "jdemeyer"
}
```
CC:  chapoton

When installing Sage with `SAGE_PYTHON3=yes`, the program `python` points to `python2`. This causes build-time problems like

```
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Traceback (most recent call last):
[sagelib-7.6.rc1]   File "setup.py", line 54, in <module>
[sagelib-7.6.rc1]     import sage.env
[sagelib-7.6.rc1]   File "/usr/local/src/sage-config/src/sage/env.py", line 87, in <module>
[sagelib-7.6.rc1]     _add_variable_or_fallback('UNAME',           os.uname()[0])
[sagelib-7.6.rc1]   File "/usr/local/src/sage-config/src/sage/env.py", line 71, in _add_variable_or_fallback
[sagelib-7.6.rc1]     import six
[sagelib-7.6.rc1] ImportError: No module named six
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Error building the Sage library
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Please email sage-devel (http://groups.google.com/group/sage-devel)
[sagelib-7.6.rc1] explaining the problem and including the relevant part of the log file
[sagelib-7.6.rc1]   /usr/local/src/sage-config/logs/pkgs/sagelib-7.6.rc1.log
[sagelib-7.6.rc1] Describe your computer, operating system, etc.
[sagelib-7.6.rc1] ************************************************************************
```


Issue created by migration from https://trac.sagemath.org/ticket/22638





---

archive/issue_comments_311906.json:
```json
{
    "body": "Seems like python2 takes it upon itself to overwrite the symlink even when there is already one. So this is a race between python2 and python3 build, which is why I can't reproduce it.",
    "created_at": "2017-03-18T15:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311906",
    "user": "vbraun"
}
```

Seems like python2 takes it upon itself to overwrite the symlink even when there is already one. So this is a race between python2 and python3 build, which is why I can't reproduce it.



---

archive/issue_comments_311907.json:
```json
{
    "body": "Btw in #22582 I'm explictly using pip2 or pip3 to install dependencies instead of trusting some python/pip symlink. That way you can event install both py2/py3 versions of dependencies simultaneously, which is imho useful for testing and debugging.",
    "created_at": "2017-03-18T16:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311907",
    "user": "vbraun"
}
```

Btw in #22582 I'm explictly using pip2 or pip3 to install dependencies instead of trusting some python/pip symlink. That way you can event install both py2/py3 versions of dependencies simultaneously, which is imho useful for testing and debugging.



---

archive/issue_comments_311908.json:
```json
{
    "body": "Ops, I got confused with the local/lib/python symlink, ignore comment:5. \n\nPEP394 says that \"for the time being, all distributions should ensure that python refers to the same target as python2\".",
    "created_at": "2017-03-18T16:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311908",
    "user": "vbraun"
}
```

Ops, I got confused with the local/lib/python symlink, ignore comment:5. 

PEP394 says that "for the time being, all distributions should ensure that python refers to the same target as python2".



---

archive/issue_comments_311909.json:
```json
{
    "body": "I think that #22764 might fix this problem. Please try it.",
    "created_at": "2017-04-06T20:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311909",
    "user": "jhpalmieri"
}
```

I think that #22764 might fix this problem. Please try it.



---

archive/issue_comments_311910.json:
```json
{
    "body": "Is this ticket pertinent for the current problem with python3 build ?\n\nhttps://groups.google.com/forum/#!topic/sage-devel/FqR-37Fu3tY",
    "created_at": "2017-05-20T12:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311910",
    "user": "chapoton"
}
```

Is this ticket pertinent for the current problem with python3 build ?

https://groups.google.com/forum/#!topic/sage-devel/FqR-37Fu3tY



---

archive/issue_comments_311911.json:
```json
{
    "body": "Volker was very insistent at #22582 that `python` should always be `python2`, because that is a Python convention. So whether this has to do with the python3 build, there will be resistance to changing it. Perhaps this ticket should be closed, or perhaps it should be repurposed to using `sage-python23` in more places in the build process to call a version of Python depending on the setting of `SAGE_PYTHON3`.",
    "created_at": "2017-05-20T15:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311911",
    "user": "jhpalmieri"
}
```

Volker was very insistent at #22582 that `python` should always be `python2`, because that is a Python convention. So whether this has to do with the python3 build, there will be resistance to changing it. Perhaps this ticket should be closed, or perhaps it should be repurposed to using `sage-python23` in more places in the build process to call a version of Python depending on the setting of `SAGE_PYTHON3`.



---

archive/issue_comments_311912.json:
```json
{
    "body": "Can we close this one now ?",
    "created_at": "2017-08-18T11:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311912",
    "user": "chapoton"
}
```

Can we close this one now ?



---

archive/issue_comments_311913.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-19T12:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311913",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_311914.json:
```json
{
    "body": "It's okay with me to close it. Jeroen, any objections?",
    "created_at": "2017-08-20T20:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311914",
    "user": "jhpalmieri"
}
```

It's okay with me to close it. Jeroen, any objections?



---

archive/issue_comments_311915.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-07T11:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311915",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_311916.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22401",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22401#issuecomment-311916",
    "user": "embray"
}
```

Resolution: wontfix
