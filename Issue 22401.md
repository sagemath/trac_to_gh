# Issue 22401: "python" = python2 even with SAGE_PYTHON3=yes

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-03-18 14:25:27

CC:  chapoton

When installing Sage with `SAGE_PYTHON3=yes`, the program `python` points to `python2`. This causes build-time problems like

```
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Traceback (most recent call last):
[sagelib-7.6.rc1]   File "setup.py", line 54, in <module>
[sagelib-7.6.rc1]     import sage.env
[sagelib-7.6.rc1]   File "/usr/local/src/sage-config/src/sage/env.py", line 87, in <module>
[sagelib-7.6.rc1]     _add_variable_or_fallback('UNAME',           os.uname()[0])
[sagelib-7.6.rc1]   File "/usr/local/src/sage-config/src/sage/env.py", line 71, in _add_variable_or_fallback
[sagelib-7.6.rc1]     import six
[sagelib-7.6.rc1] ImportError: No module named six
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Error building the Sage library
[sagelib-7.6.rc1] ************************************************************************
[sagelib-7.6.rc1] Please email sage-devel (http://groups.google.com/group/sage-devel)
[sagelib-7.6.rc1] explaining the problem and including the relevant part of the log file
[sagelib-7.6.rc1]   /usr/local/src/sage-config/logs/pkgs/sagelib-7.6.rc1.log
[sagelib-7.6.rc1] Describe your computer, operating system, etc.
[sagelib-7.6.rc1] ************************************************************************
```



---

Comment by vbraun created at 2017-03-18 15:53:05

Seems like python2 takes it upon itself to overwrite the symlink even when there is already one. So this is a race between python2 and python3 build, which is why I can't reproduce it.


---

Comment by vbraun created at 2017-03-18 16:06:30

Btw in #22582 I'm explictly using pip2 or pip3 to install dependencies instead of trusting some python/pip symlink. That way you can event install both py2/py3 versions of dependencies simultaneously, which is imho useful for testing and debugging.


---

Comment by vbraun created at 2017-03-18 16:49:39

Ops, I got confused with the local/lib/python symlink, ignore comment:5. 

PEP394 says that "for the time being, all distributions should ensure that python refers to the same target as python2".


---

Comment by jhpalmieri created at 2017-04-06 20:32:15

I think that #22764 might fix this problem. Please try it.


---

Comment by chapoton created at 2017-05-20 12:24:44

Is this ticket pertinent for the current problem with python3 build ?

https://groups.google.com/forum/#!topic/sage-devel/FqR-37Fu3tY


---

Comment by jhpalmieri created at 2017-05-20 15:24:47

Volker was very insistent at #22582 that `python` should always be `python2`, because that is a Python convention. So whether this has to do with the python3 build, there will be resistance to changing it. Perhaps this ticket should be closed, or perhaps it should be repurposed to using `sage-python23` in more places in the build process to call a version of Python depending on the setting of `SAGE_PYTHON3`.


---

Comment by chapoton created at 2017-08-18 11:16:38

Can we close this one now ?


---

Comment by chapoton created at 2017-08-19 12:45:14

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2017-08-20 20:21:50

It's okay with me to close it. Jeroen, any objections?


---

Comment by jdemeyer created at 2017-09-07 11:38:12

Changing status from needs_review to positive_review.


---

Comment by embray created at 2017-12-12 08:23:33

Resolution: wontfix
