# Issue 30698: Fix IP is none error in doctests

Issue created by migration from https://trac.sagemath.org/ticket/30935

Original creator: @tobiasdiez

Original creation time: 2020-11-18 10:12:45

CC:  mkoeppe dimpase

While working on #30371 I run into an error that `IP = get_ipython` was none. This is fixed by adding a check for none.


---

Comment by @tobiasdiez created at 2020-11-18 10:12:52

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-11-23 02:42:48

Could you expand the ticket description please? How does one provoke this error?


---

Comment by @tobiasdiez created at 2020-11-23 08:54:34

The error happened while running

```
import sage.all
import sage.doctest.control
sage.doctest.control.run_doctests(sage)
```

via the VS Code "Run Python file in terminal". (I know that is a somewhat none-standard form to run the doctests.) Stack trace:

```
Traceback (most recent call last):
  File "/mnt/d/Programming/Projects/sage/src/test_docs.py", line 3, in <module>
    sage.doctest.control.run_doctests(sage)
  File "/mnt/d/Programming/Projects/sage/src/sage/doctest/control.py", line 1305, in run_doctests
    old_color = IP.colors
AttributeError: 'NoneType' object has no attribute 'colors'
```



---

Comment by mkoeppe created at 2020-11-24 23:38:52

Changing status from needs_review to positive_review.


---

Comment by @tobiasdiez created at 2020-11-25 10:18:52

Thanks!


---

Comment by vbraun created at 2020-12-05 22:13:04

Resolution: fixed
