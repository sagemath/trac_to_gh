# Issue 29697: Run test suite for product

archive/issues_029697.json:
```json
{
    "body": "Keywords: polyhedra, test suite, product\n\nWe implement a method that tests the construction of the product.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29934\n\n",
    "created_at": "2020-06-22T12:47:15Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Run test suite for product",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29697",
    "user": "@kliem"
}
```
Keywords: polyhedra, test suite, product

We implement a method that tests the construction of the product.

Issue created by migration from https://trac.sagemath.org/ticket/29934





---

archive/issue_comments_421625.json:
```json
{
    "body": "And another bug discovered:\n\n\n```\nsage: P = polytopes.regular_polygon(5, exact=True)\nsage: P1 = polytopes.regular_polygon(5, exact=False)\nsage: P*P1\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9946)()\n   1195         try:\n-> 1196             action = self._action_maps.get(xp, yp, op)\n   1197         except KeyError:\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce_dict.pyx in sage.structure.coerce_dict.TripleDict.get (build/cythonized/sage/structure/coerce_dict.c:7917)()\n   1327         if not valid(cursor.key_id1):\n-> 1328             raise KeyError((k1, k2, k3))\n   1329         value = <object>cursor.value\n\nKeyError: (Polyhedra in AA^2, Polyhedra in RDF^2, <built-in function mul>)\n\nDuring handling of the above exception, another exception occurred:\n\nValueError                                Traceback (most recent call last)\n<ipython-input-4-69ee963b1fc0> in <module>()\n----> 1 P*P1\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12029)()\n   1515             return (<Element>left)._mul_(right)\n   1516         if BOTH_ARE_ELEMENT(cl):\n-> 1517             return coercion_model.bin_op(left, right, mul)\n   1518 \n   1519         cdef long value\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9996)()\n   1196             action = self._action_maps.get(xp, yp, op)\n   1197         except KeyError:\n-> 1198             action = self.get_action(xp, yp, op, x, y)\n   1199         if action is not None:\n   1200             if (<Action>action)._is_left:\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.get_action (build/cythonized/sage/structure/coerce.c:16783)()\n   1724         except KeyError:\n   1725             pass\n-> 1726         action = self.discover_action(R, S, op, r, s)\n   1727         action = self.verify_action(action, R, S, op)\n   1728         self._action_maps.set(R, S, op, action)\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.discover_action (build/cythonized/sage/structure/coerce.c:18201)()\n   1855         \"\"\"\n   1856         if isinstance(R, Parent):\n-> 1857             action = (<Parent>R).get_action(S, op, True, r, s)\n   1858             if action is not None:\n   1859                 return action\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.get_action (build/cythonized/sage/structure/parent.c:19745)()\n   2457         action = self._get_action_(S, op, self_on_left)\n   2458         if action is None:\n-> 2459             action = self.discover_action(S, op, self_on_left, self_el, S_el)\n   2460 \n   2461         if action is not None:\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_action (build/cythonized/sage/structure/parent.c:20722)()\n   2536                 # detect actions defined by _rmul_, _lmul_, _act_on_, and _acted_upon_ methods\n   2537                 from .coerce_actions import detect_element_action\n-> 2538                 action = detect_element_action(self, S, self_on_left, self_el, S_el)\n   2539                 if action is not None:\n   2540                     return action\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce_actions.pyx in sage.structure.coerce_actions.detect_element_action (build/cythonized/sage/structure/coerce_actions.c:5360)()\n    229     if isinstance(Y, Parent):\n    230         try:\n--> 231             if x._acted_upon_(y, X_on_left) is not None:\n    232                 return ActedUponAction(Y, X, not X_on_left, False)\n    233         except CoercionException:\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element._acted_upon_ (build/cythonized/sage/structure/element.c:8604)()\n    925         return None\n    926 \n--> 927     cpdef _acted_upon_(self, x, bint self_on_left):\n    928         \"\"\"\n    929         Use this method to implement ``self`` acted on by x.\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in _acted_upon_(self, actor, self_on_left)\n   4299         \"\"\"\n   4300         if is_Polyhedron(actor):\n-> 4301             return self.product(actor)\n   4302         if is_Vector(actor):\n   4303             return self.translation(actor)\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in product(self, other)\n   3993 \n   3994         parent = self.parent().change_ring(new_ring, ambient_dim=self.ambient_dim() + other.ambient_dim())\n-> 3995         return parent.element_class(parent, [new_vertices, new_rays, new_lines], None)\n   3996 \n   3997     _mul_ = product\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in __init__(self, parent, Vrep, Hrep, **kwds)\n    459             sage: TestSuite(p).run()\n    460         \"\"\"\n--> 461         Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in __init__(self, parent, Vrep, Hrep, **kwds)\n    120             vertices, rays, lines = Vrep\n    121             if vertices or rays or lines:\n--> 122                 self._init_from_Vrepresentation(vertices, rays, lines, **kwds)\n    123             else:\n    124                 self._init_empty_polyhedron()\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _init_from_Vrepresentation(self, vertices, rays, lines, verbose)\n     61         from .cdd_file_format import cdd_Vrepresentation\n     62         s = cdd_Vrepresentation(self._cdd_type, vertices, rays, lines)\n---> 63         s = self._run_cdd(s, '--redcheck', verbose=verbose)\n     64         s = self._run_cdd(s, '--repall', verbose=verbose)\n     65         self._init_from_cdd_output(s)\n\n/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _run_cdd(self, cdd_input_string, cmdline_arg, verbose)\n    163         if 'Error:' in ans + err:\n    164             # cdd reports errors on stdout and misc information on stderr\n--> 165             raise ValueError(ans.strip())\n    166         return ans\n    167 \n\nValueError: *Input Error: Input format is not correct.\n*Format:\n begin\n   m   n  NumberType(real, rational or integer)\n   b  -A\n end\n```\n\n\nThis is also present with #29568 on the current develop branch.",
    "created_at": "2020-06-22T13:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421625",
    "user": "@kliem"
}
```

And another bug discovered:


```
sage: P = polytopes.regular_polygon(5, exact=True)
sage: P1 = polytopes.regular_polygon(5, exact=False)
sage: P*P1
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9946)()
   1195         try:
-> 1196             action = self._action_maps.get(xp, yp, op)
   1197         except KeyError:

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce_dict.pyx in sage.structure.coerce_dict.TripleDict.get (build/cythonized/sage/structure/coerce_dict.c:7917)()
   1327         if not valid(cursor.key_id1):
-> 1328             raise KeyError((k1, k2, k3))
   1329         value = <object>cursor.value

KeyError: (Polyhedra in AA^2, Polyhedra in RDF^2, <built-in function mul>)

During handling of the above exception, another exception occurred:

ValueError                                Traceback (most recent call last)
<ipython-input-4-69ee963b1fc0> in <module>()
----> 1 P*P1

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12029)()
   1515             return (<Element>left)._mul_(right)
   1516         if BOTH_ARE_ELEMENT(cl):
-> 1517             return coercion_model.bin_op(left, right, mul)
   1518 
   1519         cdef long value

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9996)()
   1196             action = self._action_maps.get(xp, yp, op)
   1197         except KeyError:
-> 1198             action = self.get_action(xp, yp, op, x, y)
   1199         if action is not None:
   1200             if (<Action>action)._is_left:

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.get_action (build/cythonized/sage/structure/coerce.c:16783)()
   1724         except KeyError:
   1725             pass
-> 1726         action = self.discover_action(R, S, op, r, s)
   1727         action = self.verify_action(action, R, S, op)
   1728         self._action_maps.set(R, S, op, action)

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.discover_action (build/cythonized/sage/structure/coerce.c:18201)()
   1855         """
   1856         if isinstance(R, Parent):
-> 1857             action = (<Parent>R).get_action(S, op, True, r, s)
   1858             if action is not None:
   1859                 return action

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.get_action (build/cythonized/sage/structure/parent.c:19745)()
   2457         action = self._get_action_(S, op, self_on_left)
   2458         if action is None:
-> 2459             action = self.discover_action(S, op, self_on_left, self_el, S_el)
   2460 
   2461         if action is not None:

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_action (build/cythonized/sage/structure/parent.c:20722)()
   2536                 # detect actions defined by _rmul_, _lmul_, _act_on_, and _acted_upon_ methods
   2537                 from .coerce_actions import detect_element_action
-> 2538                 action = detect_element_action(self, S, self_on_left, self_el, S_el)
   2539                 if action is not None:
   2540                     return action

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/coerce_actions.pyx in sage.structure.coerce_actions.detect_element_action (build/cythonized/sage/structure/coerce_actions.c:5360)()
    229     if isinstance(Y, Parent):
    230         try:
--> 231             if x._acted_upon_(y, X_on_left) is not None:
    232                 return ActedUponAction(Y, X, not X_on_left, False)
    233         except CoercionException:

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element._acted_upon_ (build/cythonized/sage/structure/element.c:8604)()
    925         return None
    926 
--> 927     cpdef _acted_upon_(self, x, bint self_on_left):
    928         """
    929         Use this method to implement ``self`` acted on by x.

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in _acted_upon_(self, actor, self_on_left)
   4299         """
   4300         if is_Polyhedron(actor):
-> 4301             return self.product(actor)
   4302         if is_Vector(actor):
   4303             return self.translation(actor)

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in product(self, other)
   3993 
   3994         parent = self.parent().change_ring(new_ring, ambient_dim=self.ambient_dim() + other.ambient_dim())
-> 3995         return parent.element_class(parent, [new_vertices, new_rays, new_lines], None)
   3996 
   3997     _mul_ = product

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in __init__(self, parent, Vrep, Hrep, **kwds)
    459             sage: TestSuite(p).run()
    460         """
--> 461         Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in __init__(self, parent, Vrep, Hrep, **kwds)
    120             vertices, rays, lines = Vrep
    121             if vertices or rays or lines:
--> 122                 self._init_from_Vrepresentation(vertices, rays, lines, **kwds)
    123             else:
    124                 self._init_empty_polyhedron()

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _init_from_Vrepresentation(self, vertices, rays, lines, verbose)
     61         from .cdd_file_format import cdd_Vrepresentation
     62         s = cdd_Vrepresentation(self._cdd_type, vertices, rays, lines)
---> 63         s = self._run_cdd(s, '--redcheck', verbose=verbose)
     64         s = self._run_cdd(s, '--repall', verbose=verbose)
     65         self._init_from_cdd_output(s)

/srv/public/shared/sage-9.0/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _run_cdd(self, cdd_input_string, cmdline_arg, verbose)
    163         if 'Error:' in ans + err:
    164             # cdd reports errors on stdout and misc information on stderr
--> 165             raise ValueError(ans.strip())
    166         return ans
    167 

ValueError: *Input Error: Input format is not correct.
*Format:
 begin
   m   n  NumberType(real, rational or integer)
   b  -A
 end
```


This is also present with #29568 on the current develop branch.



---

archive/issue_comments_421626.json:
```json
{
    "body": "Apparently this introduced when improving products.\n\nEdited: No, I can actually trace it back at least to sage 7.4",
    "created_at": "2020-06-22T13:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421626",
    "user": "@kliem"
}
```

Apparently this introduced when improving products.

Edited: No, I can actually trace it back at least to sage 7.4



---

archive/issue_comments_421627.json:
```json
{
    "body": "One more\n\n\n```\nsage: P1 = polytopes.regular_polygon(5, exact=False)\nsage: P2 = Polyhedron()\nsage: P1*P2\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9942)()\n   1195         try:\n-> 1196             action = self._action_maps.get(xp, yp, op)\n   1197         except KeyError:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce_dict.pyx in sage.structure.coerce_dict.TripleDict.get (build/cythonized/sage/structure/coerce_dict.c:7916)()\n   1327         if not valid(cursor.key_id1):\n-> 1328             raise KeyError((k1, k2, k3))\n   1329         value = <object>cursor.value\n\nKeyError: (Polyhedra in RDF^2, Polyhedra in ZZ^0, <built-in function mul>)\n\nDuring handling of the above exception, another exception occurred:\n\nTypeError                                 Traceback (most recent call last)\n<ipython-input-10-1f01e20e65dd> in <module>()\n----> 1 P1*P2\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12225)()\n   1535             return (<Element>left)._mul_(right)\n   1536         if BOTH_ARE_ELEMENT(cl):\n-> 1537             return coercion_model.bin_op(left, right, mul)\n   1538 \n   1539         cdef long value\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9992)()\n   1196             action = self._action_maps.get(xp, yp, op)\n   1197         except KeyError:\n-> 1198             action = self.get_action(xp, yp, op, x, y)\n   1199         if action is not None:\n   1200             if (<Action>action)._is_left:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.get_action (build/cythonized/sage/structure/coerce.c:16779)()\n   1725         except KeyError:\n   1726             pass\n-> 1727         action = self.discover_action(R, S, op, r, s)\n   1728         action = self.verify_action(action, R, S, op)\n   1729         self._action_maps.set(R, S, op, action)\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.discover_action (build/cythonized/sage/structure/coerce.c:18197)()\n   1856         \"\"\"\n   1857         if isinstance(R, Parent):\n-> 1858             action = (<Parent>R).get_action(S, op, True, r, s)\n   1859             if action is not None:\n   1860                 return action\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.get_action (build/cythonized/sage/structure/parent.c:19900)()\n   2475         action = self._get_action_(S, op, self_on_left)\n   2476         if action is None:\n-> 2477             action = self.discover_action(S, op, self_on_left, self_el, S_el)\n   2478 \n   2479         if action is not None:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_action (build/cythonized/sage/structure/parent.c:20877)()\n   2554                 # detect actions defined by _rmul_, _lmul_, _act_on_, and _acted_upon_ methods\n   2555                 from .coerce_actions import detect_element_action\n-> 2556                 action = detect_element_action(self, S, self_on_left, self_el, S_el)\n   2557                 if action is not None:\n   2558                     return action\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce_actions.pyx in sage.structure.coerce_actions.detect_element_action (build/cythonized/sage/structure/coerce_actions.c:5358)()\n    229     if isinstance(Y, Parent):\n    230         try:\n--> 231             if x._acted_upon_(y, X_on_left) is not None:\n    232                 return ActedUponAction(Y, X, not X_on_left, False)\n    233         except CoercionException:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element._acted_upon_ (build/cythonized/sage/structure/element.c:8800)()\n    945         return None\n    946 \n--> 947     cpdef _acted_upon_(self, x, bint self_on_left):\n    948         \"\"\"\n    949         Use this method to implement ``self`` acted on by x.\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in _acted_upon_(self, actor, self_on_left)\n   4959         \"\"\"\n   4960         if is_Polyhedron(actor):\n-> 4961             return self.product(actor)\n   4962         elif is_Vector(actor):\n   4963             return self.translation(actor)\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in product(self, other)\n   4487         return parent.element_class(parent, [new_vertices, rays, lines],\n   4488                                     [ieqs, eqns],\n-> 4489                                     Vrep_minimal=True, Hrep_minimal=True, pref_rep=pref_rep)\n   4490 \n   4491     _mul_ = product\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in __init__(self, parent, Vrep, Hrep, **kwds)\n    518             sage: TestSuite(p).run()\n    519         \"\"\"\n--> 520         Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)\n    521 \n    522     def _init_from_Vrepresentation_and_Hrepresentation(self, Vrep, Hrep, verbose=False):\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in __init__(self, parent, Vrep, Hrep, Vrep_minimal, Hrep_minimal, pref_rep, **kwds)\n    206                                  \" and Vrep_minimal and Hrep_minimal must both be True\")\n    207             if hasattr(self, \"_init_from_Vrepresentation_and_Hrepresentation\"):\n--> 208                 self._init_from_Vrepresentation_and_Hrepresentation(Vrep, Hrep)\n    209                 return\n    210             else:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _init_from_Vrepresentation_and_Hrepresentation(self, Vrep, Hrep, verbose)\n    632             simplefilter(\"error\")\n    633             try:\n--> 634                 try_init(prim)\n    635             except UserWarning:\n    636                 simplefilter(\"once\")  # Only print the first warning.\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in try_init(rep)\n    603             if rep == \"Vrep\":\n    604                 from .cdd_file_format import cdd_Vrepresentation\n--> 605                 s = cdd_Vrepresentation(self._cdd_type, vertices, rays, lines)\n    606             else:\n    607                 # We have to add a trivial inequality, in case the polyhedron is the universe.\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/cdd_file_format.py in cdd_Vrepresentation(cdd_type, vertices, rays, lines, file_output)\n     60     # cdd implicitly assumes that the origin is a vertex if none is given\n     61     if vertices is None:\n---> 62         vertices = [[0]*ambient_dim]\n     63         num += 1\n     64 \n\nTypeError: can't multiply sequence by non-int of type 'NoneType'\n```\n",
    "created_at": "2020-06-22T13:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421627",
    "user": "@kliem"
}
```

One more


```
sage: P1 = polytopes.regular_polygon(5, exact=False)
sage: P2 = Polyhedron()
sage: P1*P2
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9942)()
   1195         try:
-> 1196             action = self._action_maps.get(xp, yp, op)
   1197         except KeyError:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce_dict.pyx in sage.structure.coerce_dict.TripleDict.get (build/cythonized/sage/structure/coerce_dict.c:7916)()
   1327         if not valid(cursor.key_id1):
-> 1328             raise KeyError((k1, k2, k3))
   1329         value = <object>cursor.value

KeyError: (Polyhedra in RDF^2, Polyhedra in ZZ^0, <built-in function mul>)

During handling of the above exception, another exception occurred:

TypeError                                 Traceback (most recent call last)
<ipython-input-10-1f01e20e65dd> in <module>()
----> 1 P1*P2

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12225)()
   1535             return (<Element>left)._mul_(right)
   1536         if BOTH_ARE_ELEMENT(cl):
-> 1537             return coercion_model.bin_op(left, right, mul)
   1538 
   1539         cdef long value

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:9992)()
   1196             action = self._action_maps.get(xp, yp, op)
   1197         except KeyError:
-> 1198             action = self.get_action(xp, yp, op, x, y)
   1199         if action is not None:
   1200             if (<Action>action)._is_left:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.get_action (build/cythonized/sage/structure/coerce.c:16779)()
   1725         except KeyError:
   1726             pass
-> 1727         action = self.discover_action(R, S, op, r, s)
   1728         action = self.verify_action(action, R, S, op)
   1729         self._action_maps.set(R, S, op, action)

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.discover_action (build/cythonized/sage/structure/coerce.c:18197)()
   1856         """
   1857         if isinstance(R, Parent):
-> 1858             action = (<Parent>R).get_action(S, op, True, r, s)
   1859             if action is not None:
   1860                 return action

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.get_action (build/cythonized/sage/structure/parent.c:19900)()
   2475         action = self._get_action_(S, op, self_on_left)
   2476         if action is None:
-> 2477             action = self.discover_action(S, op, self_on_left, self_el, S_el)
   2478 
   2479         if action is not None:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.discover_action (build/cythonized/sage/structure/parent.c:20877)()
   2554                 # detect actions defined by _rmul_, _lmul_, _act_on_, and _acted_upon_ methods
   2555                 from .coerce_actions import detect_element_action
-> 2556                 action = detect_element_action(self, S, self_on_left, self_el, S_el)
   2557                 if action is not None:
   2558                     return action

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce_actions.pyx in sage.structure.coerce_actions.detect_element_action (build/cythonized/sage/structure/coerce_actions.c:5358)()
    229     if isinstance(Y, Parent):
    230         try:
--> 231             if x._acted_upon_(y, X_on_left) is not None:
    232                 return ActedUponAction(Y, X, not X_on_left, False)
    233         except CoercionException:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element._acted_upon_ (build/cythonized/sage/structure/element.c:8800)()
    945         return None
    946 
--> 947     cpdef _acted_upon_(self, x, bint self_on_left):
    948         """
    949         Use this method to implement ``self`` acted on by x.

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in _acted_upon_(self, actor, self_on_left)
   4959         """
   4960         if is_Polyhedron(actor):
-> 4961             return self.product(actor)
   4962         elif is_Vector(actor):
   4963             return self.translation(actor)

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in product(self, other)
   4487         return parent.element_class(parent, [new_vertices, rays, lines],
   4488                                     [ieqs, eqns],
-> 4489                                     Vrep_minimal=True, Hrep_minimal=True, pref_rep=pref_rep)
   4490 
   4491     _mul_ = product

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in __init__(self, parent, Vrep, Hrep, **kwds)
    518             sage: TestSuite(p).run()
    519         """
--> 520         Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)
    521 
    522     def _init_from_Vrepresentation_and_Hrepresentation(self, Vrep, Hrep, verbose=False):

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py in __init__(self, parent, Vrep, Hrep, Vrep_minimal, Hrep_minimal, pref_rep, **kwds)
    206                                  " and Vrep_minimal and Hrep_minimal must both be True")
    207             if hasattr(self, "_init_from_Vrepresentation_and_Hrepresentation"):
--> 208                 self._init_from_Vrepresentation_and_Hrepresentation(Vrep, Hrep)
    209                 return
    210             else:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in _init_from_Vrepresentation_and_Hrepresentation(self, Vrep, Hrep, verbose)
    632             simplefilter("error")
    633             try:
--> 634                 try_init(prim)
    635             except UserWarning:
    636                 simplefilter("once")  # Only print the first warning.

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/backend_cdd.py in try_init(rep)
    603             if rep == "Vrep":
    604                 from .cdd_file_format import cdd_Vrepresentation
--> 605                 s = cdd_Vrepresentation(self._cdd_type, vertices, rays, lines)
    606             else:
    607                 # We have to add a trivial inequality, in case the polyhedron is the universe.

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/cdd_file_format.py in cdd_Vrepresentation(cdd_type, vertices, rays, lines, file_output)
     60     # cdd implicitly assumes that the origin is a vertex if none is given
     61     if vertices is None:
---> 62         vertices = [[0]*ambient_dim]
     63         num += 1
     64 

TypeError: can't multiply sequence by non-int of type 'NoneType'
```




---

archive/issue_comments_421628.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2020-06-22T13:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421628",
    "user": "@kliem"
}
```

Last 10 new commits:



---

archive/issue_comments_421629.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-08-10T15:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421629",
    "user": "@kliem"
}
```

New commits:



---

archive/issue_comments_421630.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-10T15:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421630",
    "user": "@kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_421631.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-10T15:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421631",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_421632.json:
```json
{
    "body": "pyflakes has a complaint about unused variable R, but I think it's fine.",
    "created_at": "2020-08-11T15:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421632",
    "user": "mkoeppe"
}
```

pyflakes has a complaint about unused variable R, but I think it's fine.



---

archive/issue_comments_421633.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-11T15:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421633",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_421634.json:
```json
{
    "body": "Thank you.",
    "created_at": "2020-08-11T16:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421634",
    "user": "@kliem"
}
```

Thank you.



---

archive/issue_comments_421635.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-08-23T22:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421635",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_421636.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2020-08-23T22:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421636",
    "user": "vbraun"
}
```

Merge conflict



---

archive/issue_comments_421637.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-24T06:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421637",
    "user": "@kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_421638.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-08-24T06:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421638",
    "user": "@kliem"
}
```

New commits:



---

archive/issue_comments_421639.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-24T15:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421639",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_421640.json:
```json
{
    "body": "Thanks.",
    "created_at": "2020-08-24T15:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421640",
    "user": "@kliem"
}
```

Thanks.



---

archive/issue_comments_421641.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-30T08:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29697#issuecomment-421641",
    "user": "vbraun"
}
```

Resolution: fixed
