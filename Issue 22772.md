# Issue 22772: Some .. -directives to Sphinx

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2017-05-16 09:46:42

CC:  tscrim chapoton

As an example the warning at `make_confluent` at `finitely_presented.html` is not shown. This patch corrects some of those.


---

Comment by jmantysalo created at 2017-05-16 09:50:05

Please see `src/sage/plot/animate.py` and the line `.. REFERENCES (not rendered as a section, but linked inline):`. What is meant there?
----
New commits:


---

Comment by jmantysalo created at 2017-05-16 09:50:05

Changing status from new to needs_info.


---

Comment by chapoton created at 2017-05-16 09:57:13

No idea. I guess it should be replaced by a standard REFERENCES (with no .. at the beginning of every line inside)


---

Comment by git created at 2017-05-16 10:13:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-05-16 10:15:08

you mean

```
No other block shall be used as a directive
```



---

Comment by jmantysalo created at 2017-05-16 10:30:18

Replying to [comment:5 chapoton]:
> you mean
> {{{
> No other block shall be used as a directive
> }}}

True, must correct that.

 * * *

I have never before looked at the patchbot plugins code. The triple colon plugin seems to be simple:


```
exclude_new(ticket, regex=r':\s*::', msg="Triple colon (:::)", **kwds)
```


Is it possible to add a plugin to check for Sphinx directives?


---

Comment by jhpalmieri created at 2017-05-16 15:24:35

Regarding "There are exactly five Sphinx directives used in Sage:" I also found `.. MATH::`, `.. RUBRIC::`, `.. AUTOMETHOD::`, `.. TOPIC::`. There may be others. 

See http://www.sphinx-doc.org/en/stable/rest.html#directives, http://www.sphinx-doc.org/en/stable/markup/index.html#sphinxmarkup, and http://www.sphinx-doc.org/en/stable/extensions.html?highlight=math for some more reST/Sphinx directives. I couldn't find a single comprehensive list anywhere, but I didn't look that hard.


---

Comment by jmantysalo created at 2017-05-16 15:45:15

Replying to [comment:7 jhpalmieri]:
> Regarding "There are exactly five Sphinx directives used in Sage:" I also found `.. MATH::`, `.. RUBRIC::`, `.. AUTOMETHOD::`, `.. TOPIC::`. There may be others. 

I forgot `.. MATH::`, thanks. Are others used in Sage?

Is it possible to add own pre-defined directives? It is odd that we have "special" markup `.. NOTE::` but no `.. ALGORITHM::`.

Do we have "substructures" in logical sense? I mean something like having a `NOTE` explaining something in `INPUT` section, some `WARNING` inside `ALGORITHM` etc?


---

Comment by jhpalmieri created at 2017-05-16 16:05:27

Replying to [comment:8 jmantysalo]:
> Replying to [comment:7 jhpalmieri]:
> > Regarding "There are exactly five Sphinx directives used in Sage:" I also found `.. MATH::`, `.. RUBRIC::`, `.. AUTOMETHOD::`, `.. TOPIC::`. There may be others. 
> 
> I forgot `.. MATH::`, thanks. Are others used in Sage?

Yes: within Sage, do `search_src('\.\. [A-Z]*::')`.
 
> Is it possible to add own pre-defined directives? It is odd that we have "special" markup `.. NOTE::` but no `.. ALGORITHM::`.

I expect that it is, but I've never tried. In another reality, we could have much more structured docstrings, with `.. ALGORITHM::`, `.. EXAMPLES::`, `.. TESTS::`, etc.

> Do we have "substructures" in logical sense? I mean something like having a `NOTE` explaining something in `INPUT` section, some `WARNING` inside `ALGORITHM` etc?

I don't know.


---

Comment by chapoton created at 2017-05-26 08:07:31

New commits:


---

Comment by chapoton created at 2017-05-26 08:07:59

I made a somehwat "large scale cleanup". We should check that doc still builds.


---

Comment by jmantysalo created at 2017-05-26 08:42:40

Changing status from needs_info to needs_work.


---

Comment by jmantysalo created at 2017-05-26 08:42:40

At least "No other block shall not be used" -error is still there.

Compiling and testing now.


---

Comment by jmantysalo created at 2017-05-26 09:26:21

"use this feature for all - -" should start with a capital letter.

(Sidenote: "In a recent paper" is not good, as we of course suppose [SageMath](SageMath) to be used for decades to come. `:=)`.)

Anyways, this compiles and the documentation compiles. I will run some doctests. I guess we can mark Frédéric as author and I put myself as reviewer. Travis, is this OK?


---

Comment by jmantysalo created at 2017-05-26 10:03:21

Changing status from needs_work to positive_review.


---

Comment by jmantysalo created at 2017-05-26 10:03:21

Passed short tests for all files and long tests for modified file. I think this is OK.


---

Comment by jhpalmieri created at 2017-05-26 14:31:14

What about comment:13?


---

Comment by jmantysalo created at 2017-05-27 09:56:26

Replying to [comment:16 jhpalmieri]:
> What about comment:13?

Arghs, forgot that.


---

Comment by jmantysalo created at 2017-05-27 09:56:26

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-05-27 12:56:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-05-27 12:56:39

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-05-27 12:56:39

ok, I changed the formulation slightly.


---

Comment by jmantysalo created at 2017-05-27 17:17:59

Changing status from needs_review to positive_review.


---

Comment by jmantysalo created at 2017-05-27 17:17:59

LGTM.


---

Comment by vbraun created at 2017-05-28 08:22:48

Resolution: fixed
