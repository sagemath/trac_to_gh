# Issue 30910: GH Actions: Fixes for WSL workflow

archive/issues_030673.json:
```json
{
    "body": "Like the other workflows, it now runs only on tags and pushes to branch having \"wsl\" in the name (to ease testing if the workflow has to be changed).\n\nCurrently it dies if a system package does not exist - even for optional packages.\nThis is fixed with this ticket.\nhttps://github.com/tobiasdiez/sage/runs/1405834030?check_suite_focus=true\n\n\n\n\n**CC:**  @tobiasdiez\n\n**Branch/Commit:** [3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Tobias Diez\n\n**Dependencies:** #30923\n\nIssue created by migration from https://trac.sagemath.org/ticket/30910\n\n",
    "closed_at": "2020-11-29T11:58:03Z",
    "created_at": "2020-11-13T21:15:12Z",
    "labels": [
        "component: porting",
        "critical",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "GH Actions: Fixes for WSL workflow",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30910",
    "user": "https://github.com/mkoeppe"
}
```
Like the other workflows, it now runs only on tags and pushes to branch having "wsl" in the name (to ease testing if the workflow has to be changed).

Currently it dies if a system package does not exist - even for optional packages.
This is fixed with this ticket.
https://github.com/tobiasdiez/sage/runs/1405834030?check_suite_focus=true




**CC:**  @tobiasdiez

**Branch/Commit:** [3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)

**Reviewer:** Matthias Koeppe

**Author:** Tobias Diez

**Dependencies:** #30923

Issue created by migration from https://trac.sagemath.org/ticket/30910





---

archive/issue_comments_585250.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/942149ee76a97628046042b7255a2d31630e7721\">942149e</a></td><td><code>Add confirmation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75ecd11e878e34a4c508d2f983b6d7527e689f94\">75ecd11</a></td><td><code>tox.ini (local-sudo): Also use ...-bootstrap.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0dc79eb4b542a11aa8c226ca8cf9f0e2306698eb\">0dc79eb</a></td><td><code>build/bin/sage-print-system-package-command: Handle --no-install-recommends, --yes for systems for which write-dockerfile.sh knows these flags</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/050dcb8275b3a7e0db4c7ae3503428107bb5bf17\">050dcb8</a></td><td><code>tox.ini (local-sudo): Use --yes --no-install-recommends</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8fbe0beaec3a404d330aaebdf37186e9c6becec\">c8fbe0b</a></td><td><code>tox.ini (local-sudo): Ignore errors when IGNORE_MISSING_SYSTEM_PACKAGES=yes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff34897cac35061afd348cc08a6559f95f406f14\">ff34897</a></td><td><code>tox.ini (local): Guess the package system if it is not provided as a factor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e27ff19a5969919ceb43fe910fc8d43cfb0c7bf0\">e27ff19</a></td><td><code>Merge branch 'u/mkoeppe/tox_ini__add_environments_local_sudo_ubuntu_standard__etc_' of git://trac.sagemath.org/sage into public/build/fixwsl</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ff45c41ce97531cc845456941a982c9b583d5f7\">6ff45c4</a></td><td><code>Cleanup workflow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53481440a24a3914430dcbf1cf4e19e4aab5267c\">5348144</a></td><td><code>Replace texlive-generic-extra</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9\">0fd029f</a></td><td><code>Narrow down events that trigger the workflow</code></td></tr></table>\n",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585250",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:1'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/942149ee76a97628046042b7255a2d31630e7721">942149e</a></td><td><code>Add confirmation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75ecd11e878e34a4c508d2f983b6d7527e689f94">75ecd11</a></td><td><code>tox.ini (local-sudo): Also use ...-bootstrap.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0dc79eb4b542a11aa8c226ca8cf9f0e2306698eb">0dc79eb</a></td><td><code>build/bin/sage-print-system-package-command: Handle --no-install-recommends, --yes for systems for which write-dockerfile.sh knows these flags</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/050dcb8275b3a7e0db4c7ae3503428107bb5bf17">050dcb8</a></td><td><code>tox.ini (local-sudo): Use --yes --no-install-recommends</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8fbe0beaec3a404d330aaebdf37186e9c6becec">c8fbe0b</a></td><td><code>tox.ini (local-sudo): Ignore errors when IGNORE_MISSING_SYSTEM_PACKAGES=yes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff34897cac35061afd348cc08a6559f95f406f14">ff34897</a></td><td><code>tox.ini (local): Guess the package system if it is not provided as a factor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e27ff19a5969919ceb43fe910fc8d43cfb0c7bf0">e27ff19</a></td><td><code>Merge branch 'u/mkoeppe/tox_ini__add_environments_local_sudo_ubuntu_standard__etc_' of git://trac.sagemath.org/sage into public/build/fixwsl</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ff45c41ce97531cc845456941a982c9b583d5f7">6ff45c4</a></td><td><code>Cleanup workflow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53481440a24a3914430dcbf1cf4e19e4aab5267c">5348144</a></td><td><code>Replace texlive-generic-extra</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9">0fd029f</a></td><td><code>Narrow down events that trigger the workflow</code></td></tr></table>




---

archive/issue_comments_585251.json:
```json
{
    "body": "**Commit:** [0fd029f1e2b1e8384d14995c361f90e331b784b9](https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9)",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585251",
    "user": "https://github.com/tobiasdiez"
}
```

**Commit:** [0fd029f1e2b1e8384d14995c361f90e331b784b9](https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9)



---

archive/issue_comments_585252.json:
```json
{
    "body": "**Branch:** [public/build/fixwsl](https://github.com/sagemath/sagetrac-mirror/tree/public/build/fixwsl)",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585252",
    "user": "https://github.com/tobiasdiez"
}
```

**Branch:** [public/build/fixwsl](https://github.com/sagemath/sagetrac-mirror/tree/public/build/fixwsl)



---

archive/issue_comments_585253.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n-It should only run on tags, like the other workflows\n+Like the other workflows, it now runs only on tags and pushes to branch having \"wsl\" in the name (to ease testing if the workflow has to be changed).\n \n-Currently it dies if a system package does not exist - even for optional packages - https://github.com/sagemath/sage/runs/1368397973?check_suite_focus=true\n+Currently it dies if a system package does not exist - even for optional packages.\n+This is fixed with this ticket.\n+https://github.com/tobiasdiez/sage/runs/1405834030?check_suite_focus=true\n \n \n \n-\n``````\n",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585253",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
-It should only run on tags, like the other workflows
+Like the other workflows, it now runs only on tags and pushes to branch having "wsl" in the name (to ease testing if the workflow has to be changed).
 
-Currently it dies if a system package does not exist - even for optional packages - https://github.com/sagemath/sage/runs/1368397973?check_suite_focus=true
+Currently it dies if a system package does not exist - even for optional packages.
+This is fixed with this ticket.
+https://github.com/tobiasdiez/sage/runs/1405834030?check_suite_focus=true
 
 
 
-
``````




---

archive/issue_comments_585254.json:
```json
{
    "body": "**Dependencies:** #30923",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585254",
    "user": "https://github.com/tobiasdiez"
}
```

**Dependencies:** #30923



---

archive/issue_comments_585255.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585255",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_585256.json:
```json
{
    "body": "**Author:** Tobias Diez",
    "created_at": "2020-11-16T10:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585256",
    "user": "https://github.com/tobiasdiez"
}
```

**Author:** Tobias Diez



---

archive/issue_comments_585257.json:
```json
{
    "body": "<a id='comment:2'></a>\nI don't think `texlive-plain-generic` is the right package. We use latex, not plain tex",
    "created_at": "2020-11-16T20:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585257",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
I don't think `texlive-plain-generic` is the right package. We use latex, not plain tex



---

archive/issue_comments_585258.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2020-11-16T20:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585258",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_585259.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm also not sure, but looking at https://packages.ubuntu.com/bionic/texlive-generic-extra it looks like `texlive-generic-extra` is a (deprecated) wrapper around `texlive-plain-generic`.\n\n(The dependency might actually be there not for the pdf/latex docs but for the html docs, which requires bibtex to generate the aux.)",
    "created_at": "2020-11-16T20:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585259",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>
I'm also not sure, but looking at https://packages.ubuntu.com/bionic/texlive-generic-extra it looks like `texlive-generic-extra` is a (deprecated) wrapper around `texlive-plain-generic`.

(The dependency might actually be there not for the pdf/latex docs but for the html docs, which requires bibtex to generate the aux.)



---

archive/issue_comments_585260.json:
```json
{
    "body": "<a id='comment:5'></a>\nI think I would go for `texlive-latex-extra` - https://packages.ubuntu.com/groovy/texlive-latex-extra",
    "created_at": "2020-11-16T20:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585260",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
I think I would go for `texlive-latex-extra` - https://packages.ubuntu.com/groovy/texlive-latex-extra



---

archive/issue_comments_585261.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe\">3ccae02</a></td><td><code>build/pkgs/_recommended/distros/debian.txt: Update latex package</code></td></tr></table>\n",
    "created_at": "2020-11-17T02:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe">3ccae02</a></td><td><code>build/pkgs/_recommended/distros/debian.txt: Update latex package</code></td></tr></table>




---

archive/issue_comments_585262.json:
```json
{
    "body": "**Changing commit** from \"[0fd029f1e2b1e8384d14995c361f90e331b784b9](https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9)\" to \"[3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)\".",
    "created_at": "2020-11-17T02:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0fd029f1e2b1e8384d14995c361f90e331b784b9](https://github.com/sagemath/sagetrac-mirror/commit/0fd029f1e2b1e8384d14995c361f90e331b784b9)" to "[3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)".



---

archive/issue_comments_585263.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-11-17T02:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585263",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_585264.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks!",
    "created_at": "2020-11-20T19:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585264",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'></a>
Thanks!



---

archive/issue_events_091269.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-29T11:58:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30910#event-91269"
}
```



---

archive/issue_comments_585265.json:
```json
{
    "body": "**Changing branch** from \"[public/build/fixwsl](https://github.com/sagemath/sagetrac-mirror/tree/public/build/fixwsl)\" to \"[3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)\".",
    "created_at": "2020-11-29T11:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30910#issuecomment-585265",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/build/fixwsl](https://github.com/sagemath/sagetrac-mirror/tree/public/build/fixwsl)" to "[3ccae0258309b682d6429cafbc656e90894d6ebe](https://github.com/sagemath/sagetrac-mirror/commit/3ccae0258309b682d6429cafbc656e90894d6ebe)".
