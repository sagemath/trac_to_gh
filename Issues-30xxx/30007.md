# Issue 30007: Allow regular partition tuples to have different \ell values on different components

archive/issues_029770.json:
```json
{
    "body": "Regular partition tuples are common in enumerating bases of infinite dimensional vector spaces coming from representation theory. It is often useful to have different \\ell values for different components. For example. For example, the basis for the Fock space of two free Bosons and three free Fermions would have a basis parametrized for partition tuples of level 5 where only three components would need to be 2-regular and 2 components would not need to be regular. This ticket implements that. If one passes to PartitionTuples both a level and a tuple as regular value (instead of just a number) it returns a class \"VectorRegularPartitionTuples\"\n\nKeywords: partition tuples\n\nBranch/Commit: bbf40b84f9aebad14ec4148c0ed72001b41506ef\n\nReviewer: Travis Scrimshaw\n\nAuthor: Reimundo Heluani\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30007\n\n",
    "closed_at": "2020-07-08T19:33:02Z",
    "created_at": "2020-06-28T10:01:50Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Allow regular partition tuples to have different \\ell values on different components",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30007",
    "user": "https://github.com/heluani"
}
```
Regular partition tuples are common in enumerating bases of infinite dimensional vector spaces coming from representation theory. It is often useful to have different \ell values for different components. For example. For example, the basis for the Fock space of two free Bosons and three free Fermions would have a basis parametrized for partition tuples of level 5 where only three components would need to be 2-regular and 2 components would not need to be regular. This ticket implements that. If one passes to PartitionTuples both a level and a tuple as regular value (instead of just a number) it returns a class "VectorRegularPartitionTuples"

Keywords: partition tuples

Branch/Commit: bbf40b84f9aebad14ec4148c0ed72001b41506ef

Reviewer: Travis Scrimshaw

Author: Reimundo Heluani

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30007





---

archive/issue_comments_422369.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-28T10:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422369",
    "user": "https://github.com/heluani"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_422370.json:
```json
{
    "body": "<a id='comment:2'></a>This seems quite redundant with the current regular partition tuples. I think it would be better to simply extend that functionality to convert a single level into the vector case (by copying the level to each entry) and extend the current code to handle the tuple. Perhaps a special value (either `None` or `0` for those that need not be regular?",
    "created_at": "2020-06-29T01:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422370",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>This seems quite redundant with the current regular partition tuples. I think it would be better to simply extend that functionality to convert a single level into the vector case (by copying the level to each entry) and extend the current code to handle the tuple. Perhaps a special value (either `None` or `0` for those that need not be regular?



---

archive/issue_comments_422371.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 tscrim]:\n> This seems quite redundant with the current regular partition tuples. I think it would be better to simply extend that functionality to convert a single level into the vector case (by copying the level to each entry) and extend the current code to handle the tuple. Perhaps a special value (either `None` or `0` for those that need not be regular?\n\n\nI agree, originally I was trying to touch as little as possible existing code. \n\nThe main issue that drove me to write a separate class is the level 1 case: partition tuples of level 1 return Partitions. This breaks code like VertexAlgebras that rely on having a PartitionTuple. By including this functionality in the existing code and passing a parameter regular as a tuple of length 1, the natural thing to do would be to return a RegularPartition. \n\nIf that is the case I'll need to refactor on vertex algebras to import RegularPartitionTuples_level directly. But I wanted to express here my preference that Partition tuples of level 1 should be Partition Tuples and not Partitions. It makes unnecessarily harder to write generic code that works with partition tuples of a fixed level to try the level 1 case differently. \n\nOn the other hand changing this behaviour could break existing code, hence my choice to add a small separate class.",
    "created_at": "2020-06-29T01:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422371",
    "user": "https://github.com/heluani"
}
```

<a id='comment:3'></a>Replying to [comment:2 tscrim]:
> This seems quite redundant with the current regular partition tuples. I think it would be better to simply extend that functionality to convert a single level into the vector case (by copying the level to each entry) and extend the current code to handle the tuple. Perhaps a special value (either `None` or `0` for those that need not be regular?


I agree, originally I was trying to touch as little as possible existing code. 

The main issue that drove me to write a separate class is the level 1 case: partition tuples of level 1 return Partitions. This breaks code like VertexAlgebras that rely on having a PartitionTuple. By including this functionality in the existing code and passing a parameter regular as a tuple of length 1, the natural thing to do would be to return a RegularPartition. 

If that is the case I'll need to refactor on vertex algebras to import RegularPartitionTuples_level directly. But I wanted to express here my preference that Partition tuples of level 1 should be Partition Tuples and not Partitions. It makes unnecessarily harder to write generic code that works with partition tuples of a fixed level to try the level 1 case differently. 

On the other hand changing this behaviour could break existing code, hence my choice to add a small separate class.



---

archive/issue_comments_422372.json:
```json
{
    "body": "<a id='comment:4'></a>I don't think that is a good enough reason to duplicate all of the code. The reason we this is done this way is because partitions have more information that can be used and there is very little functional difference between the two in terms of methods. (Of course, we you are iterating over a partition tuple, this is a problem.) I had the same issue when doing the Fock space implementation, but I just had cases in my code to handle the level 1 case separately.\n\nOne way you can work around this is if the level is given as a tuple of size 1, then it returns a partition tuple of level 1 for that very special input. This would be the minimal change that does not effect existing code, but it does introduce a slight discrepancy between similar-but-not-equal inputs. However, I think this is justified, provided you put a `.. NOTE::`/`.. WARNING::` in the doc making this clear.\n\nI wouldn't worry too much about not touching existing code. Duplication causes more issues with consistency and more work to things to fix later on (this would be what is called technical debt).",
    "created_at": "2020-06-29T02:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422372",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>I don't think that is a good enough reason to duplicate all of the code. The reason we this is done this way is because partitions have more information that can be used and there is very little functional difference between the two in terms of methods. (Of course, we you are iterating over a partition tuple, this is a problem.) I had the same issue when doing the Fock space implementation, but I just had cases in my code to handle the level 1 case separately.

One way you can work around this is if the level is given as a tuple of size 1, then it returns a partition tuple of level 1 for that very special input. This would be the minimal change that does not effect existing code, but it does introduce a slight discrepancy between similar-but-not-equal inputs. However, I think this is justified, provided you put a `.. NOTE::`/`.. WARNING::` in the doc making this clear.

I wouldn't worry too much about not touching existing code. Duplication causes more issues with consistency and more work to things to fix later on (this would be what is called technical debt).



---

archive/issue_comments_422373.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-29T17:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422374.json:
```json
{
    "body": "<a id='comment:6'></a>I think this version does what you suggested. It seems from that diff that I was working over an old version of the file, there are some changes that I didn't include. I'll rebase it",
    "created_at": "2020-06-29T17:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422374",
    "user": "https://github.com/heluani"
}
```

<a id='comment:6'></a>I think this version does what you suggested. It seems from that diff that I was working over an old version of the file, there are some changes that I didn't include. I'll rebase it



---

archive/issue_comments_422375.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-29T18:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422376.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-30T17:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422376",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422377.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-03T03:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422378.json:
```json
{
    "body": "<a id='comment:10'></a>I made some reviewer changes. If my changes are good, then you can set a positive review.",
    "created_at": "2020-07-03T04:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422378",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>I made some reviewer changes. If my changes are good, then you can set a positive review.



---

archive/issue_comments_422379.json:
```json
{
    "body": "<a id='comment:11'></a>The case `regular=0`, that's why it's a positive integer or a tuple of non-negative integers. So I rephrased the description of the class `PartitionTuples` where this is relevant. In the regular classes that's fine cause all those classes receive a tuple, and for tuples `0` is allowed. I also added a couple of missing spaces in the errors raised. Let me know if this is fine.",
    "created_at": "2020-07-03T19:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422379",
    "user": "https://github.com/heluani"
}
```

<a id='comment:11'></a>The case `regular=0`, that's why it's a positive integer or a tuple of non-negative integers. So I rephrased the description of the class `PartitionTuples` where this is relevant. In the regular classes that's fine cause all those classes receive a tuple, and for tuples `0` is allowed. I also added a couple of missing spaces in the errors raised. Let me know if this is fine.



---

archive/issue_comments_422380.json:
```json
{
    "body": "<a id='comment:12'></a>Are there changes you were going to push or is this just explaining your previous commits?",
    "created_at": "2020-07-03T22:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422380",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>Are there changes you were going to push or is this just explaining your previous commits?



---

archive/issue_comments_422381.json:
```json
{
    "body": "<a id='comment:13'></a>That was just explaining the previous commit, I wasn't sure if that would be alright with you",
    "created_at": "2020-07-03T23:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422381",
    "user": "https://github.com/heluani"
}
```

<a id='comment:13'></a>That was just explaining the previous commit, I wasn't sure if that would be alright with you



---

archive/issue_comments_422382.json:
```json
{
    "body": "<a id='comment:14'></a>Then if you are fine with my changes, you can set a positive review.",
    "created_at": "2020-07-03T23:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422382",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>Then if you are fine with my changes, you can set a positive review.



---

archive/issue_comments_422383.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 tscrim]:\n> Then if you are fine with my changes, you can set a positive review.\n\nOh crap my push never went through! Here's a commit with the change I mentioned. I apologize.",
    "created_at": "2020-07-04T00:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422383",
    "user": "https://github.com/heluani"
}
```

<a id='comment:15'></a>Replying to [comment:14 tscrim]:
> Then if you are fine with my changes, you can set a positive review.

Oh crap my push never went through! Here's a commit with the change I mentioned. I apologize.



---

archive/issue_comments_422384.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-04T00:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422384",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422385.json:
```json
{
    "body": "<a id='comment:17'></a>This is not quite right. Perhaps this:\n\n```diff\n     - ``regular`` -- a positive integer or a tuple of non-negative\n       integers; if an integer, the highest multiplicity an entry may\n-      have in a component plus `1`.\n+      have in a component plus `1`\n \n     If a level `k` is specified and ``regular`` is a tuple of integers\n     `\\ell_1, \\ldots, \\ell_k`, then this specifies partition tuples `\\mu`\n-    such that `\\mu_i` is `\\ell_i`-regular. If ``regular`` is an integer\n-    `\\ell`, then we set `\\ell_i = \\ell` for all `i`, with `0`\n-    representing `\\infty`-regular (equivalently, partitions without\n-    restrictions)\n+    such that `\\mu_i` is `\\ell_i`-regular, where `0` here\n+    represents `\\infty`-regular partitions (equivalently, partitions\n+    without restrictions). If ``regular`` is an integer `\\ell`, then\n+    we set `\\ell_i = \\ell` for all `i`.\n```\n(Note also the periods.)",
    "created_at": "2020-07-04T01:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422385",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>This is not quite right. Perhaps this:

```diff
     - ``regular`` -- a positive integer or a tuple of non-negative
       integers; if an integer, the highest multiplicity an entry may
-      have in a component plus `1`.
+      have in a component plus `1`
 
     If a level `k` is specified and ``regular`` is a tuple of integers
     `\ell_1, \ldots, \ell_k`, then this specifies partition tuples `\mu`
-    such that `\mu_i` is `\ell_i`-regular. If ``regular`` is an integer
-    `\ell`, then we set `\ell_i = \ell` for all `i`, with `0`
-    representing `\infty`-regular (equivalently, partitions without
-    restrictions)
+    such that `\mu_i` is `\ell_i`-regular, where `0` here
+    represents `\infty`-regular partitions (equivalently, partitions
+    without restrictions). If ``regular`` is an integer `\ell`, then
+    we set `\ell_i = \ell` for all `i`.
```
(Note also the periods.)



---

archive/issue_comments_422386.json:
```json
{
    "body": "<a id='comment:18'></a>That looks good to me",
    "created_at": "2020-07-04T15:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422386",
    "user": "https://github.com/heluani"
}
```

<a id='comment:18'></a>That looks good to me



---

archive/issue_comments_422387.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-04T18:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422388.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-04T18:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422388",
    "user": "https://github.com/heluani"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_422389.json:
```json
{
    "body": "<a id='comment:21'></a>Assigning it to review again so that it is picked by the bot even though I just made your change",
    "created_at": "2020-07-05T03:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422389",
    "user": "https://github.com/heluani"
}
```

<a id='comment:21'></a>Assigning it to review again so that it is picked by the bot even though I just made your change



---

archive/issue_comments_422390.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-07-05T03:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422390",
    "user": "https://github.com/heluani"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_422391.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-05T03:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422391",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_422392.json:
```json
{
    "body": "<a id='comment:22'></a>I tested it and it was fine.",
    "created_at": "2020-07-05T03:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422392",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>I tested it and it was fine.



---

archive/issue_events_077112.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:33:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30007#event-77112"
}
```



---

archive/issue_comments_422393.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30007#issuecomment-422393",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
