# Issue 30893: Replace sage autodoc extension by built-in one

archive/issues_030656.json:
```json
{
    "body": "Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.\n\nThe following customizations need to be removed for this:\n\n- providing argspecs for decorators (sage_wraps): #30884\n- using argspecs instead of signature \n- dealing with cached function(methods) callers\n- dealing with nested classes\n- dealing with classcall metaclass\n- dealing with class aliases\n- skipping lazy imports to avoid deprecation warnings\n\n\n\n\n\n\n\n\nCC:  @jhpalmieri @kwankyu\n\nWork_Issues: Make docbuild pass\n\nAuthor: Tobias Diez\n\nBranch: public/documentation/replaceautodoc\n\nStatus: needs_work\n\nDependencies: #30884\n\nCommit: ca98b7a0dda77b3474dd4dae610574deef05e76b\n\nIssue created by migration from https://trac.sagemath.org/ticket/30893\n\n",
    "created_at": "2020-11-11T16:17:25Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Replace sage autodoc extension by built-in one",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30893",
    "user": "https://github.com/tobiasdiez"
}
```
Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.

The following customizations need to be removed for this:

- providing argspecs for decorators (sage_wraps): #30884
- using argspecs instead of signature 
- dealing with cached function(methods) callers
- dealing with nested classes
- dealing with classcall metaclass
- dealing with class aliases
- skipping lazy imports to avoid deprecation warnings








CC:  @jhpalmieri @kwankyu

Work_Issues: Make docbuild pass

Author: Tobias Diez

Branch: public/documentation/replaceautodoc

Status: needs_work

Dependencies: #30884

Commit: ca98b7a0dda77b3474dd4dae610574deef05e76b

Issue created by migration from https://trac.sagemath.org/ticket/30893





---

archive/issue_comments_467477.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-11-11T16:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467477",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_467478.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-11T16:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_467479.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n-Replaces sage's custom autodoc extension by the built-in one. \n+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.\n \n For some reason, my local installation only wants to build the documentation for the manifold package. For this, I verified that the newly generated documentation is on par with the old one. This was the case except for parameters added with the \\`\\`@\\`output\\` decorator. This should be fixed with #30884.\n-Please let me know if there are other customization in the sage autodoc file except for the \\`sage_wraps\\` decorator support.\n+Please let me know if there are other customization in the sage autodoc file except for the \\`sage_wraps\\` decorator support. \n \n Branch: public/documentation/replaceautodoc\n \n```\n",
    "created_at": "2020-11-11T16:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467479",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,7 +1,7 @@
-Replaces sage's custom autodoc extension by the built-in one. 
+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.
 
 For some reason, my local installation only wants to build the documentation for the manifold package. For this, I verified that the newly generated documentation is on par with the old one. This was the case except for parameters added with the \`\`@\`output\` decorator. This should be fixed with #30884.
-Please let me know if there are other customization in the sage autodoc file except for the \`sage_wraps\` decorator support.
+Please let me know if there are other customization in the sage autodoc file except for the \`sage_wraps\` decorator support. 
 
 Branch: public/documentation/replaceautodoc
 
```




---

archive/issue_comments_467480.json:
```json
{
    "body": "<a id='comment:6'></a>Building the docs fails immediately for me, because text roles like `:arxiv:`, `:trac:`, etc. are no longer defined.\n\nI think it would be better, at least as a first step, to update `sage_autodoc` to incorporate the recent changes in Sphinx's `autodoc`.",
    "created_at": "2020-11-11T18:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467480",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>Building the docs fails immediately for me, because text roles like `:arxiv:`, `:trac:`, etc. are no longer defined.

I think it would be better, at least as a first step, to update `sage_autodoc` to incorporate the recent changes in Sphinx's `autodoc`.



---

archive/issue_comments_467481.json:
```json
{
    "body": "<a id='comment:7'></a>My understanding is that one of the main reasons for using our own version of `autodoc` is to be able to include Cython files in the documentation, and this requires customization of the introspection code. So that is something you should test when experimenting with this: how is autodoc working on Cython files?",
    "created_at": "2020-11-11T18:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467481",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>My understanding is that one of the main reasons for using our own version of `autodoc` is to be able to include Cython files in the documentation, and this requires customization of the introspection code. So that is something you should test when experimenting with this: how is autodoc working on Cython files?



---

archive/issue_comments_467482.json:
```json
{
    "body": "<a id='comment:8'></a>Thanks for the input `@`jhpalmieri.\n\n> Building the docs fails immediately for me, because text roles like `:arxiv:`, `:trac:`, etc. are no longer defined.\n\n\nThat should be fixed now.\n\n> I think it would be better, at least as a first step, to update `sage_autodoc` to incorporate the recent changes in Sphinx's `autodoc`.\n\n\nI tried rebasing first, but there were quite a few changes which made it rather difficult. So I thought replacing it completely, and then implement the necessary changes elsewhere would be easier.\n\n> should test when experimenting with this: how is autodoc working on Cython files? \n\n\nI will do so! I just figured out how to convince sage to produce the documentation for something else then the manifold package. After playing around a bit, I realized that there might be quite some changes necessary (e.g. `instancedoc` doesn't play nicely with Python's `inspect`). Will keep you updated.",
    "created_at": "2020-11-11T22:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467482",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'></a>Thanks for the input `@`jhpalmieri.

> Building the docs fails immediately for me, because text roles like `:arxiv:`, `:trac:`, etc. are no longer defined.


That should be fixed now.

> I think it would be better, at least as a first step, to update `sage_autodoc` to incorporate the recent changes in Sphinx's `autodoc`.


I tried rebasing first, but there were quite a few changes which made it rather difficult. So I thought replacing it completely, and then implement the necessary changes elsewhere would be easier.

> should test when experimenting with this: how is autodoc working on Cython files? 


I will do so! I just figured out how to convince sage to produce the documentation for something else then the manifold package. After playing around a bit, I realized that there might be quite some changes necessary (e.g. `instancedoc` doesn't play nicely with Python's `inspect`). Will keep you updated.



---

archive/issue_comments_467483.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-11-11T22:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467483",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_467484.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-11T22:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_080637.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80637"
}
```



---

archive/issue_comments_467485.json:
```json
{
    "body": "<a id='comment:10'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467485",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_080638.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80638"
}
```



---

archive/issue_events_080639.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80639"
}
```



---

archive/issue_comments_467486.json:
```json
{
    "body": "<a id='comment:11'></a>Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467486",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_080640.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80640"
}
```



---

archive/issue_events_080641.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80641"
}
```



---

archive/issue_events_080642.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80642"
}
```



---

archive/issue_events_080643.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80643"
}
```



---

archive/issue_events_080644.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80644"
}
```



---

archive/issue_events_080645.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30893#event-80645"
}
```



---

archive/issue_comments_467487.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.\n \n+The following customizations need to be removed for this:\n+- skipping lazy imports to avoid deprecation warnings\n+- providing argspecs for decorators (sage_wraps): #30884\n+- dealing with nested classes\n+- dealing with cached function(methods) callers\n+- dealing with classcall metaclass\n+- dealing with class aliases\n+- using argspecs instead of signature \n \n Branch: public/documentation/replaceautodoc\n \n```\n",
    "created_at": "2022-11-10T20:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467487",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.
 
+The following customizations need to be removed for this:
+- skipping lazy imports to avoid deprecation warnings
+- providing argspecs for decorators (sage_wraps): #30884
+- dealing with nested classes
+- dealing with cached function(methods) callers
+- dealing with classcall metaclass
+- dealing with class aliases
+- using argspecs instead of signature 
 
 Branch: public/documentation/replaceautodoc
 
```




---

archive/issue_comments_467488.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,20 @@\n+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.\n+\n+The following customizations need to be removed for this:\n+\n+- providing argspecs for decorators (sage_wraps): #30884\n+- using argspecs instead of signature \n+- dealing with cached function(methods) callers\n+- dealing with nested classes\n+- dealing with classcall metaclass\n+- dealing with class aliases\n+- skipping lazy imports to avoid deprecation warnings\n+\n+\n+\n+\n+\n+\n \n \n Branch: public/documentation/replaceautodoc\n```\n",
    "created_at": "2022-11-11T00:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30893#issuecomment-467488",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,20 @@
+Replaces sage's custom autodoc extension by the built-in one. The motivation is to add support for typing information in the documentation in #30894.
+
+The following customizations need to be removed for this:
+
+- providing argspecs for decorators (sage_wraps): #30884
+- using argspecs instead of signature 
+- dealing with cached function(methods) callers
+- dealing with nested classes
+- dealing with classcall metaclass
+- dealing with class aliases
+- skipping lazy imports to avoid deprecation warnings
+
+
+
+
+
+
 
 
 Branch: public/documentation/replaceautodoc
```

