# Issue 30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*

archive/issues_029958.json:
```json
{
    "body": "The `docker-nobootstrap` option uses `bootstrap -D`; thus, autotools are not required on the host for the build.\n\nThis enables building with `centos-6` and the `manylinux` images based on `centos-6` (https://github.com/pypa/manylinux).\n\nExamples:\n\n```\ntox -e docker-manylinux-2014-standard\ntox -e docker-manylinux-2014-standard-python3.9\ntox -e docker-manylinux-2010-standard-i686-python3.8\n```\n\n\n\nCC:  @kliem @slel\n\nReviewer: Jonathan Kliem\n\nAuthor: Matthias Koeppe\n\nBranch: 14da64d27c43ad7f3328da208ee942a54b889b5b\n\nDependencies: #29929\n\nCommit: 14da64d27c43ad7f3328da208ee942a54b889b5b\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30195\n\n",
    "closed_at": "2020-07-28T22:32:03Z",
    "created_at": "2020-07-22T02:39:12Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "tox.ini: Add centos-6, docker-nobootstrap, manylinux-*",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30195",
    "user": "https://github.com/mkoeppe"
}
```
The `docker-nobootstrap` option uses `bootstrap -D`; thus, autotools are not required on the host for the build.

This enables building with `centos-6` and the `manylinux` images based on `centos-6` (https://github.com/pypa/manylinux).

Examples:

```
tox -e docker-manylinux-2014-standard
tox -e docker-manylinux-2014-standard-python3.9
tox -e docker-manylinux-2010-standard-i686-python3.8
```



CC:  @kliem @slel

Reviewer: Jonathan Kliem

Author: Matthias Koeppe

Branch: 14da64d27c43ad7f3328da208ee942a54b889b5b

Dependencies: #29929

Commit: 14da64d27c43ad7f3328da208ee942a54b889b5b

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30195





---

archive/issue_comments_425169.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-22T04:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425169",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425170.json:
```json
{
    "body": "<a id='comment:3'></a>Branch is 1 commit on top of #29929, which also needs review\n\n---\nLast 10 new commits:",
    "created_at": "2020-07-22T04:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425170",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Branch is 1 commit on top of #29929, which also needs review

---
Last 10 new commits:



---

archive/issue_comments_425171.json:
```json
{
    "body": "<a id='comment:4'></a>Can you provide an example of this at work?\n\nAccording to the readme, only CPython up to 3.8 are provided with manylinux. Why have you configured python3.9?",
    "created_at": "2020-07-22T07:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425171",
    "user": "https://github.com/kliem"
}
```

<a id='comment:4'></a>Can you provide an example of this at work?

According to the readme, only CPython up to 3.8 are provided with manylinux. Why have you configured python3.9?



---

archive/issue_comments_425172.json:
```json
{
    "body": "<a id='comment:5'></a>The readme does not seem to be up to date. On an actual docker image:\n\n```\n[root@4185c8d9310b /]# /opt/python/cp3 TAB\ncp35-cp35m/ cp36-cp36m/ cp37-cp37m/ cp38-cp38/  cp39-cp39/  \n```",
    "created_at": "2020-07-22T07:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425172",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>The readme does not seem to be up to date. On an actual docker image:

```
[root@4185c8d9310b /]# /opt/python/cp3 TAB
cp35-cp35m/ cp36-cp36m/ cp37-cp37m/ cp38-cp38/  cp39-cp39/  
```



---

archive/issue_comments_425173.json:
```json
{
    "body": "<a id='comment:6'></a>That was one of my guesses.\n\nDo the new environments work with github actions? If you haven't tested it yet, I have free capacities and can just test this ticket.",
    "created_at": "2020-07-22T07:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425173",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>That was one of my guesses.

Do the new environments work with github actions? If you haven't tested it yet, I have free capacities and can just test this ticket.



---

archive/issue_comments_425174.json:
```json
{
    "body": "<a id='comment:7'></a>They should work, just add them to tox.yml for testing. I haven't tested them widely yet, only one run of `docker-manylinux-2014-standard` on my computer. Best to test together with #30173",
    "created_at": "2020-07-22T07:43:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425174",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>They should work, just add them to tox.yml for testing. I haven't tested them widely yet, only one run of `docker-manylinux-2014-standard` on my computer. Best to test together with #30173



---

archive/issue_comments_425175.json:
```json
{
    "body": "<a id='comment:8'></a>\n```\n File \"/usr/lib/python3/dist-packages/tox/session.py\", line 38, in main\n    config = prepare(args)\n  File \"/usr/lib/python3/dist-packages/tox/session.py\", line 26, in prepare\n    config = parseconfig(args)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 239, in parseconfig\n    parseini(config, inipath)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 760, in __init__\n    self.make_envconfig(name, section, reader._subs, config)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 791, in make_envconfig\n    res = meth(env_attr.name, env_attr.default)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 964, in getargvlist\n    return _ArgvlistReader.getargvlist(self, s)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1134, in getargvlist\n    commands.append(cls.processcommand(reader, current_command))\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1164, in processcommand\n    new_word = reader._replace(word)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1008, in _replace\n    return Replacer(self, crossonly=crossonly).do_replace(value)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1028, in do_replace\n    return self.RE_ITEM_REF.sub(self._replace_match, x)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1057, in _replace_match\n    return self._replace_env(match)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1077, in _replace_env\n    (envkey, envkey))\ntox.ConfigError: ConfigError: substitution env:'BOOTSTRAP': unknown environment variable 'BOOTSTRAP'  or recursive definition.\n##[error]Process completed with exit code 1.\n```\n\nhttps://github.com/kliem/sage/runs/897566509?check_suite_focus=true",
    "created_at": "2020-07-22T09:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425175",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>
```
 File "/usr/lib/python3/dist-packages/tox/session.py", line 38, in main
    config = prepare(args)
  File "/usr/lib/python3/dist-packages/tox/session.py", line 26, in prepare
    config = parseconfig(args)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 239, in parseconfig
    parseini(config, inipath)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 760, in __init__
    self.make_envconfig(name, section, reader._subs, config)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 791, in make_envconfig
    res = meth(env_attr.name, env_attr.default)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 964, in getargvlist
    return _ArgvlistReader.getargvlist(self, s)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1134, in getargvlist
    commands.append(cls.processcommand(reader, current_command))
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1164, in processcommand
    new_word = reader._replace(word)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1008, in _replace
    return Replacer(self, crossonly=crossonly).do_replace(value)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1028, in do_replace
    return self.RE_ITEM_REF.sub(self._replace_match, x)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1057, in _replace_match
    return self._replace_env(match)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1077, in _replace_env
    (envkey, envkey))
tox.ConfigError: ConfigError: substitution env:'BOOTSTRAP': unknown environment variable 'BOOTSTRAP'  or recursive definition.
##[error]Process completed with exit code 1.
```

https://github.com/kliem/sage/runs/897566509?check_suite_focus=true



---

archive/issue_comments_425176.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-22T15:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425177.json:
```json
{
    "body": "<a id='comment:10'></a>Thanks for catching this",
    "created_at": "2020-07-22T15:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425177",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Thanks for catching this



---

archive/issue_comments_425178.json:
```json
{
    "body": "<a id='comment:11'></a>Centos 6 seems to work in the way that it fails to buil `mpir`.\n\nThere are many errors with manylinux like\n\n```\n   File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1008, in _replace\n    return Replacer(self, crossonly=crossonly).do_replace(value)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1028, in do_replace\n    return self.RE_ITEM_REF.sub(self._replace_match, x)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1057, in _replace_match\n    return self._replace_env(match)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1071, in _replace_env\n    envvalue = self.reader.get_environ_value(envkey)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 903, in get_environ_value\n    return self._setenv.get(name)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 286, in get\n    self.resolved[name] = res = self.reader._replace(val)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1008, in _replace\n    return Replacer(self, crossonly=crossonly).do_replace(value)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1028, in do_replace\n    return self.RE_ITEM_REF.sub(self._replace_match, x)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1057, in _replace_match\n    return self._replace_env(match)\n  File \"/usr/lib/python3/dist-packages/tox/config.py\", line 1077, in _replace_env\n    (envkey, envkey))\ntox.ConfigError: ConfigError: substitution env:'BASE_IMAGE': unknown environment variable 'BASE_IMAGE'  or recursive definition.\n```\n\nhttps://github.com/kliem/sage/runs/899346008?check_suite_focus=true\n\nand \n\n```\n Step 14/18 : RUN ${BOOTSTRAP}\n ---> Running in d5c9ccb6ceb3\nrm -rf config configure build/make/Makefile-auto.in\nrm -f src/doc/en/installation/*.txt\nrm -rf src/doc/en/reference/spkg/*.rst\nrm -f src/doc/en/reference/repl/*.txt\nTraceback (most recent call last):\n  File \"/sage/build/bin/sage-download-file\", line 27, in ?\n    from sage_bootstrap.download.cmdline import run_safe\n  File \"/sage/build/bin/../sage_bootstrap/download/__init__.py\", line 7, in ?\n    from sage_bootstrap.download.transfer import Download\n  File \"/sage/build/bin/../sage_bootstrap/download/transfer.py\", line 43\n    n = 0 if chunks_so_far == 0 else self.length // 2\n           ^\nSyntaxError: invalid syntax\nError: downloading configure-339b4599590f3dc3acec5eace4b7a82f210d3219.tar.gz failed\n```\n\nhttps://github.com/kliem/sage/runs/899346035?check_suite_focus=true\n\nShould they be fixed here?",
    "created_at": "2020-07-23T17:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425178",
    "user": "https://github.com/kliem"
}
```

<a id='comment:11'></a>Centos 6 seems to work in the way that it fails to buil `mpir`.

There are many errors with manylinux like

```
   File "/usr/lib/python3/dist-packages/tox/config.py", line 1008, in _replace
    return Replacer(self, crossonly=crossonly).do_replace(value)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1028, in do_replace
    return self.RE_ITEM_REF.sub(self._replace_match, x)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1057, in _replace_match
    return self._replace_env(match)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1071, in _replace_env
    envvalue = self.reader.get_environ_value(envkey)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 903, in get_environ_value
    return self._setenv.get(name)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 286, in get
    self.resolved[name] = res = self.reader._replace(val)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1008, in _replace
    return Replacer(self, crossonly=crossonly).do_replace(value)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1028, in do_replace
    return self.RE_ITEM_REF.sub(self._replace_match, x)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1057, in _replace_match
    return self._replace_env(match)
  File "/usr/lib/python3/dist-packages/tox/config.py", line 1077, in _replace_env
    (envkey, envkey))
tox.ConfigError: ConfigError: substitution env:'BASE_IMAGE': unknown environment variable 'BASE_IMAGE'  or recursive definition.
```

https://github.com/kliem/sage/runs/899346008?check_suite_focus=true

and 

```
 Step 14/18 : RUN ${BOOTSTRAP}
 ---> Running in d5c9ccb6ceb3
rm -rf config configure build/make/Makefile-auto.in
rm -f src/doc/en/installation/*.txt
rm -rf src/doc/en/reference/spkg/*.rst
rm -f src/doc/en/reference/repl/*.txt
Traceback (most recent call last):
  File "/sage/build/bin/sage-download-file", line 27, in ?
    from sage_bootstrap.download.cmdline import run_safe
  File "/sage/build/bin/../sage_bootstrap/download/__init__.py", line 7, in ?
    from sage_bootstrap.download.transfer import Download
  File "/sage/build/bin/../sage_bootstrap/download/transfer.py", line 43
    n = 0 if chunks_so_far == 0 else self.length // 2
           ^
SyntaxError: invalid syntax
Error: downloading configure-339b4599590f3dc3acec5eace4b7a82f210d3219.tar.gz failed
```

https://github.com/kliem/sage/runs/899346035?check_suite_focus=true

Should they be fixed here?



---

archive/issue_comments_425179.json:
```json
{
    "body": "<a id='comment:12'></a>I'll look into the tox config error first.",
    "created_at": "2020-07-23T17:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425179",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>I'll look into the tox config error first.



---

archive/issue_comments_425180.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-07-23T17:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425180",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_425181.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 gh-kliem]:\n> Centos 6 seems to work in the way that it fails to buil `mpir`.\n\n\nRight... errors from an ancient assembler version.\n\n```\ntmp-mul_1.s: Assembler messages:\ntmp-mul_1.s:94: Error: no such instruction: `mulx (%rsi),%r9,%r8'\ntmp-mul_1.s:95: Error: no such instruction: `mulx 8(%rsi),%r11,%r10'\ntmp-mul_1.s:96: Error: no such instruction: `mulx 16(%rsi),%rcx,%r12'\n```\nWe'll definitely not try to support `centos-6` and shouldn't be adding it to `tox.yml`.",
    "created_at": "2020-07-23T23:13:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425181",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Replying to [comment:11 gh-kliem]:
> Centos 6 seems to work in the way that it fails to buil `mpir`.


Right... errors from an ancient assembler version.

```
tmp-mul_1.s: Assembler messages:
tmp-mul_1.s:94: Error: no such instruction: `mulx (%rsi),%r9,%r8'
tmp-mul_1.s:95: Error: no such instruction: `mulx 8(%rsi),%r11,%r10'
tmp-mul_1.s:96: Error: no such instruction: `mulx 16(%rsi),%rcx,%r12'
```
We'll definitely not try to support `centos-6` and shouldn't be adding it to `tox.yml`.



---

archive/issue_comments_425182.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:11 gh-kliem]:\n> Centos 6 seems to work in the way that it fails to buil `mpir`.\n> \n> There are many errors with manylinux like\n> \n> \n> ```\n> tox.ConfigError: ConfigError: substitution env:'BASE_IMAGE': unknown environment variable 'BASE_IMAGE'  or recursive definition.\n> ```\n\n\nThis is just caused by me not adding documentation and leaving you to guess what is supported. `manylinux` is not a configuration - only `manylinux-1`, `manylinux-2010`, `manylinux-2014` are.\n\nI'll make `manylinux` an alias for `manylinux-2014` and add some documentation.",
    "created_at": "2020-07-23T23:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425182",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:11 gh-kliem]:
> Centos 6 seems to work in the way that it fails to buil `mpir`.
> 
> There are many errors with manylinux like
> 
> 
> ```
> tox.ConfigError: ConfigError: substitution env:'BASE_IMAGE': unknown environment variable 'BASE_IMAGE'  or recursive definition.
> ```


This is just caused by me not adding documentation and leaving you to guess what is supported. `manylinux` is not a configuration - only `manylinux-1`, `manylinux-2010`, `manylinux-2014` are.

I'll make `manylinux` an alias for `manylinux-2014` and add some documentation.



---

archive/issue_comments_425183.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-23T23:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425184.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:11 gh-kliem]:\n> {{{\n>   File \"/sage/build/bin/../sage_bootstrap/download/transfer.py\", line 43\n>     n = 0 if chunks_so_far == 0 else self.length // 2\n>            ^\n> SyntaxError: invalid syntax\n> Error: downloading configure-339b4599590f3dc3acec5eace4b7a82f210d3219.tar.gz failed\n> }}}\n> \n> https://github.com/kliem/sage/runs/899346035?check_suite_focus=true\n\n\nThe added comments also explain this one -- `manylinux-1` is too old, after all, and sage cannot build on it",
    "created_at": "2020-07-23T23:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425184",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:11 gh-kliem]:
> {{{
>   File "/sage/build/bin/../sage_bootstrap/download/transfer.py", line 43
>     n = 0 if chunks_so_far == 0 else self.length // 2
>            ^
> SyntaxError: invalid syntax
> Error: downloading configure-339b4599590f3dc3acec5eace4b7a82f210d3219.tar.gz failed
> }}}
> 
> https://github.com/kliem/sage/runs/899346035?check_suite_focus=true


The added comments also explain this one -- `manylinux-1` is too old, after all, and sage cannot build on it



---

archive/issue_comments_425185.json:
```json
{
    "body": "<a id='comment:17'></a>On `manylinux-2010-minimal` (https://github.com/kliem/sage/runs/899346056), building python3 fails with `./python: error while loading shared libraries: libcrypt.so.2: cannot open shared object file: No such file or directory` (related to #29012?)\n... but actually it was intended to use the installed python3 in `/opt`. Looks like I need to make adjustments for `-2010`.",
    "created_at": "2020-07-23T23:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425185",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>On `manylinux-2010-minimal` (https://github.com/kliem/sage/runs/899346056), building python3 fails with `./python: error while loading shared libraries: libcrypt.so.2: cannot open shared object file: No such file or directory` (related to #29012?)
... but actually it was intended to use the installed python3 in `/opt`. Looks like I need to make adjustments for `-2010`.



---

archive/issue_comments_425186.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-24T01:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425187.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-24T01:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425187",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_425188.json:
```json
{
    "body": "<a id='comment:20'></a>When you have a chance, please test this version again. See above on my comments on the supported tox environments. Also note the images for non-x86 archs can't work on Linux Docker (and thus on GH Actions) because they are not multi-arch images. They work on macOS Docker Desktop because they are running inside of an emulator.",
    "created_at": "2020-07-24T01:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425188",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>When you have a chance, please test this version again. See above on my comments on the supported tox environments. Also note the images for non-x86 archs can't work on Linux Docker (and thus on GH Actions) because they are not multi-arch images. They work on macOS Docker Desktop because they are running inside of an emulator.



---

archive/issue_comments_425189.json:
```json
{
    "body": "<a id='comment:21'></a>https://github.com/kliem/sage/actions/runs/180807074\n\nThat is what I'm testing for now:\n\n```\n tox_system_factor: [ubuntu-focal, debian-buster, centos-8, manylinux-1, manylinux-2010, manylinux-2014, manylinux-2014-python3.7]\n```\n\nmanylinux-1 will of course fail.",
    "created_at": "2020-07-24T06:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425189",
    "user": "https://github.com/kliem"
}
```

<a id='comment:21'></a>https://github.com/kliem/sage/actions/runs/180807074

That is what I'm testing for now:

```
 tox_system_factor: [ubuntu-focal, debian-buster, centos-8, manylinux-1, manylinux-2010, manylinux-2014, manylinux-2014-python3.7]
```

manylinux-1 will of course fail.



---

archive/issue_comments_425190.json:
```json
{
    "body": "<a id='comment:22'></a>I'm getting configure failures with minimal. Will this be a subject of this ticket or of another one?\n\nOtherwise it's looking fine.",
    "created_at": "2020-07-24T11:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425190",
    "user": "https://github.com/kliem"
}
```

<a id='comment:22'></a>I'm getting configure failures with minimal. Will this be a subject of this ticket or of another one?

Otherwise it's looking fine.



---

archive/issue_comments_425191.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-24T15:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425192.json:
```json
{
    "body": "<a id='comment:24'></a>manylinux-2014-python3.7, minimal still fails at configuration.\n\nhttps://github.com/kliem/sage/runs/908012032?check_suite_focus=true\n\nMaybe I just got the name scheme wrong.",
    "created_at": "2020-07-24T19:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425192",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'></a>manylinux-2014-python3.7, minimal still fails at configuration.

https://github.com/kliem/sage/runs/908012032?check_suite_focus=true

Maybe I just got the name scheme wrong.



---

archive/issue_comments_425193.json:
```json
{
    "body": "<a id='comment:25'></a>`minimal` with `python3.7` cannot work because python3 dependencies such as sqlite3 are not available from the system and therefore it cannot use system python3.",
    "created_at": "2020-07-24T19:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425193",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>`minimal` with `python3.7` cannot work because python3 dependencies such as sqlite3 are not available from the system and therefore it cannot use system python3.



---

archive/issue_comments_425194.json:
```json
{
    "body": "<a id='comment:26'></a>https://github.com/kliem/sage/actions/runs/181590963\n\nThis seems to work well. At least according to the timings we are well in the build process. Any failures are probably subject to different tickets now.\n\nIf the run turns out to your satisfaction, you can put it on positive review on my behalf.",
    "created_at": "2020-07-24T21:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425194",
    "user": "https://github.com/kliem"
}
```

<a id='comment:26'></a>https://github.com/kliem/sage/actions/runs/181590963

This seems to work well. At least according to the timings we are well in the build process. Any failures are probably subject to different tickets now.

If the run turns out to your satisfaction, you can put it on positive review on my behalf.



---

archive/issue_comments_425195.json:
```json
{
    "body": "<a id='comment:27'></a>Thank you!",
    "created_at": "2020-07-25T01:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425195",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>Thank you!



---

archive/issue_comments_425196.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-25T01:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425196",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_077928.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-28T22:32:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30195#event-77928"
}
```



---

archive/issue_comments_425197.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-28T22:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30195#issuecomment-425197",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
