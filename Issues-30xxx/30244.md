# Issue 30244: Use _matmul_ operator (@) for matrix multiplication, map composition, tensor contraction

archive/issues_030007.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n#22760 added support for `__matmul__` in the coercion model.\n\nWe should start using it.\n\nFirst step: Review the semantics of this operator in major Python software for matrix and tensor computation (NumPy, Numba, TensorFlow, PyTorch, ...) so that we do not paint ourselves into a corner.\n\nFollow-up tickets:\n- #32212 `sage.geometry.hyperbolic_space`\n\n\n\nCC:  @tscrim @egourgoulhon\n\nComponent: **linear algebra**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[u/mkoeppe/use__matmul__operator____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/use__matmul__operator____) @ [`da5104c`](https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30244_\n\n",
    "created_at": "2020-07-29T01:15:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Use _matmul_ operator (@) for matrix multiplication, map composition, tensor contraction",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/30244",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

#22760 added support for `__matmul__` in the coercion model.

We should start using it.

First step: Review the semantics of this operator in major Python software for matrix and tensor computation (NumPy, Numba, TensorFlow, PyTorch, ...) so that we do not paint ourselves into a corner.

Follow-up tickets:
- #32212 `sage.geometry.hyperbolic_space`



CC:  @tscrim @egourgoulhon

Component: **linear algebra**

Author: **Matthias Koeppe**

Branch/Commit: **[u/mkoeppe/use__matmul__operator____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/use__matmul__operator____) @ [`da5104c`](https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98)**

_Issue created by migration from https://trac.sagemath.org/ticket/30244_





---

archive/issue_events_413518.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-29T01:15:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413518"
}
```



---

archive/issue_events_413519.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-29T01:15:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413519"
}
```



---

archive/issue_events_413520.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-29T01:15:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413520"
}
```



---

archive/issue_events_413521.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-29T01:15:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413521"
}
```



---

archive/issue_comments_479575.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI think in most cases we *don't* need it. In a matrix algebra, it's pretty clear that multiplication means matrix multiplication; not Hadamard product.\n\nThe first place I'd see a possible application is for self-maps of a ring, where one may want to consider both composition and point-wise products.",
    "created_at": "2020-07-30T07:29:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479575",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:1" align="right">comment:1</div>

I think in most cases we *don't* need it. In a matrix algebra, it's pretty clear that multiplication means matrix multiplication; not Hadamard product.

The first place I'd see a possible application is for self-maps of a ring, where one may want to consider both composition and point-wise products.



---

archive/issue_comments_479576.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nReplying to [@nbruin](#comment%3A1):\n> The first place I'd see a possible application is for self-maps of a ring, where one may want to consider both composition and point-wise products.\n\n+1. Wondering now if we need a category of @-itive semigroups.",
    "created_at": "2020-07-30T10:49:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479576",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Replying to [@nbruin](#comment%3A1):
> The first place I'd see a possible application is for self-maps of a ring, where one may want to consider both composition and point-wise products.

+1. Wondering now if we need a category of @-itive semigroups.



---

archive/issue_comments_479577.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.",
    "created_at": "2020-07-30T17:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479577",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

I think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.



---

archive/issue_comments_479578.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jhpalmieri](#comment%3A3):\n> I think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.\n\n+1 for this. This would be a good place to start providing an implementation.",
    "created_at": "2020-07-30T23:36:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479578",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jhpalmieri](#comment%3A3):
> I think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.

+1 for this. This would be a good place to start providing an implementation.



---

archive/issue_comments_479579.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI think '@' for tensor products would be very confusing for other uses in python. While it was introduced non-prescriptively as another binary operator, the implementation name `__matmul__` suggests otherwise, and the numpy reason for requesting it was very solidly for matrix multiplication, i.e., map composition.\n\nIt would seem to me that the place where having operator notation for tensor products might be interesting is for Kronecker products of matrices. That's exactly the place where it directly clashes with numpy notation!! I also think it's very inefficient for multivariate Kronecker products, because the infix notation necessitates the construction of intermediate results.\n\nFor modules, I would expect tensor products and homs to be equally prevalent, so keeping a symmetry in their notation seems like a desirable thing to have.\n\nSo, I think \"@\" is a poor fit for tensor product.",
    "created_at": "2020-08-03T20:21:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479579",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:6" align="right">comment:6</div>

I think '@' for tensor products would be very confusing for other uses in python. While it was introduced non-prescriptively as another binary operator, the implementation name `__matmul__` suggests otherwise, and the numpy reason for requesting it was very solidly for matrix multiplication, i.e., map composition.

It would seem to me that the place where having operator notation for tensor products might be interesting is for Kronecker products of matrices. That's exactly the place where it directly clashes with numpy notation!! I also think it's very inefficient for multivariate Kronecker products, because the infix notation necessitates the construction of intermediate results.

For modules, I would expect tensor products and homs to be equally prevalent, so keeping a symmetry in their notation seems like a desirable thing to have.

So, I think "@" is a poor fit for tensor product.



---

archive/issue_comments_479580.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n+1 on giving the \"map composition\" priority for this operator.\n\nIn the realm of tensors, matrix multiplication would generalize to tensor contraction, not tensor product.",
    "created_at": "2020-08-03T20:27:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479580",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

+1 on giving the "map composition" priority for this operator.

In the realm of tensors, matrix multiplication would generalize to tensor contraction, not tensor product.



---

archive/issue_comments_479581.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@mkoeppe](#comment%3A2):\n> Wondering now if we need a category of @-itive semigroups.\n\nAny thoughts on this? Do we need a category `SemigroupsWithRespectToMatmul`?",
    "created_at": "2020-08-03T20:29:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479581",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@mkoeppe](#comment%3A2):
> Wondering now if we need a category of @-itive semigroups.

Any thoughts on this? Do we need a category `SemigroupsWithRespectToMatmul`?



---

archive/issue_comments_479582.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI'd say no, for the same reason why we don't have this for \"|\", \"&\", \"<<\", \">>\", and other binary operators that python provides. I think we first need a convincing use-case before we start building infrastructure. Code is a burden, not an asset :-).",
    "created_at": "2020-08-03T22:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479582",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:9" align="right">comment:9</div>

I'd say no, for the same reason why we don't have this for "|", "&", "<<", ">>", and other binary operators that python provides. I think we first need a convincing use-case before we start building infrastructure. Code is a burden, not an asset :-).



---

archive/issue_comments_479583.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nNote that these other binary operators do not actually participate in the coercion framework...\n\nBut great point, of course, that we should start with something concrete first.",
    "created_at": "2020-08-03T23:20:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479583",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Note that these other binary operators do not actually participate in the coercion framework...

But great point, of course, that we should start with something concrete first.



---

archive/issue_comments_479584.json:
```json
{
    "body": "Branch: **[u/mkoeppe/use__matmul__operator____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/use__matmul__operator____)**",
    "created_at": "2020-08-04T02:57:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479584",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/use__matmul__operator____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/use__matmul__operator____)**



---

archive/issue_comments_479585.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI think you may want to reconsider #22760 in the light of possible usage scenarios. The coercion framework is particularly designed to figure out common parents into which the operands can be coerced so that the operation can be applied. This does not apply to all cases; for instance, for actions there is no appropriate *common* parent. For actions, other procedures are followed (and generally, less powerful ones; which is appropriate).\n\nIf `@` is going to be composition, it's going to be mostly a partial operation if regarded as, say, an operation on homomorphisms between modules over a field. Alternatively, it's an operation that combines objects in DIFFERENT parents (e.g., a pairing $\\mathrm{Hom}(A,B) \\times \\mathrm{Hom}(B,C) \\to \\mathrm{Hom(}A,C)$) in which case the coercion framework probably doesn't have an appropriate setting yet. I think you really want to know what the coercion framework is supposed to accomplish for you before you try and hook `@` into it. If the only scenarios where things work are the cases where `_matmul_` already knows what to do, then there's no benefit from an extra indirection layer: you could just put the login into `__matmul__` directly.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea74b6ffc5d7d50e62bb95065c41da4ffe73888c\"><code>ea74b6f</code></a></td><td><code>Add support for `__matmul__` in the coercion model</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d939b2cee7f1992745c11cb3440729b519833e19\"><code>d939b2c</code></a></td><td><code>Update doctests for py3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8d79249b5d8aa939dd9cd134a696784f0ef17e5\"><code>e8d7924</code></a></td><td><code>Merge branch 't/22760/add_support_for___matmul___in_the_coercion_model' into t/30244/use__matmul__operator____</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86\"><code>a982dd8</code></a></td><td><code>sage.categories.map.Map: Add __matmul__</code></td></tr></table>\n",
    "created_at": "2020-08-04T04:14:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479585",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:12" align="right">comment:12</div>

I think you may want to reconsider #22760 in the light of possible usage scenarios. The coercion framework is particularly designed to figure out common parents into which the operands can be coerced so that the operation can be applied. This does not apply to all cases; for instance, for actions there is no appropriate *common* parent. For actions, other procedures are followed (and generally, less powerful ones; which is appropriate).

If `@` is going to be composition, it's going to be mostly a partial operation if regarded as, say, an operation on homomorphisms between modules over a field. Alternatively, it's an operation that combines objects in DIFFERENT parents (e.g., a pairing $\mathrm{Hom}(A,B) \times \mathrm{Hom}(B,C) \to \mathrm{Hom(}A,C)$) in which case the coercion framework probably doesn't have an appropriate setting yet. I think you really want to know what the coercion framework is supposed to accomplish for you before you try and hook `@` into it. If the only scenarios where things work are the cases where `_matmul_` already knows what to do, then there's no benefit from an extra indirection layer: you could just put the login into `__matmul__` directly.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea74b6ffc5d7d50e62bb95065c41da4ffe73888c"><code>ea74b6f</code></a></td><td><code>Add support for `__matmul__` in the coercion model</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d939b2cee7f1992745c11cb3440729b519833e19"><code>d939b2c</code></a></td><td><code>Update doctests for py3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8d79249b5d8aa939dd9cd134a696784f0ef17e5"><code>e8d7924</code></a></td><td><code>Merge branch 't/22760/add_support_for___matmul___in_the_coercion_model' into t/30244/use__matmul__operator____</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86"><code>a982dd8</code></a></td><td><code>sage.categories.map.Map: Add __matmul__</code></td></tr></table>




---

archive/issue_comments_479586.json:
```json
{
    "body": "Commit: **[`a982dd8`](https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86)**",
    "created_at": "2020-08-04T04:14:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479586",
    "user": "https://github.com/nbruin"
}
```

Commit: **[`a982dd8`](https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86)**



---

archive/issue_comments_479587.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThis is a great point. \n\nOn this branch, as you perhaps saw, I am already overriding the (double-underscore) `__matmul__` operator, so the coercion framework is not actually involved at all when it comes to the `@` operation between two `Map`s. So in this case, I don't think there is actually any overhead/indirection.",
    "created_at": "2020-08-04T05:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479587",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

This is a great point. 

On this branch, as you perhaps saw, I am already overriding the (double-underscore) `__matmul__` operator, so the coercion framework is not actually involved at all when it comes to the `@` operation between two `Map`s. So in this case, I don't think there is actually any overhead/indirection.



---

archive/issue_comments_479588.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nBut a concern is that by overriding it, it is disabling coerce actions...",
    "created_at": "2020-08-04T05:15:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479588",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

But a concern is that by overriding it, it is disabling coerce actions...



---

archive/issue_comments_479589.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI don't think there is any harm in #22760 by adding the hook for it. However, I thought the coercion framework was designed to also handle actions. For example, you need coercion for `z * A` when `z` is an integer but `A` only has a `QQ`-action. I also thought the coercion framework was what called the different actions to see what was appropriate too.\n\nThat being said, I see your point about `_matmul_` potentially not being so useful by itself. However, we might as well include it in case someone does have a use case for it.",
    "created_at": "2020-08-04T05:39:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479589",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

I don't think there is any harm in #22760 by adding the hook for it. However, I thought the coercion framework was designed to also handle actions. For example, you need coercion for `z * A` when `z` is an integer but `A` only has a `QQ`-action. I also thought the coercion framework was what called the different actions to see what was appropriate too.

That being said, I see your point about `_matmul_` potentially not being so useful by itself. However, we might as well include it in case someone does have a use case for it.



---

archive/issue_comments_479590.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@mkoeppe](#comment%3A7):\n> \n> In the realm of tensors, matrix multiplication would generalize to tensor contraction, not tensor product.\n\n+1",
    "created_at": "2020-08-04T06:52:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479590",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@mkoeppe](#comment%3A7):
> 
> In the realm of tensors, matrix multiplication would generalize to tensor contraction, not tensor product.

+1



---

archive/issue_comments_479591.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment%3A15):\n> I don't think there is any harm in #22760 by adding the hook for it. However, I thought the coercion framework was designed to also handle actions. For example, you need coercion for `z * A` when `z` is an integer but `A` only has a `QQ`-action. I also thought the coercion framework was what called the different actions to see what was appropriate too.\n\nIndeed, some coercion steps are possible for actions, but not nearly as much as for operations internal to structures. For instance, for addition between `ZZ[x,y]` and `QQ[z]`, the coercion system will construct a common covering structure `QQ[x,y,z]` by combining a sequence of \"construction functors\" according to certain (heuristic!) rules. I don't think the rules for actions are nearly as advanced -- probably no coercions on the acted-upon set are tried at all; and probably shouldn't.\n\nI'd hope there are better tools available for exploring what coercion to take than to query and see \"what works\". If that's actually what happens, then applying it to partial operators such as composition is definitely inappropriate.\n\nIn general, I'm not so sure coercion will help for `@` if it goes the composition route, and then having the hook in the system is going to be counterproductive, because people will stumble on it and do unhelpful things with it. So I disagree with the idea that putting hooks just in case someone finds a use for it is harmless. Not making a design decision on it now can also mean not making a design mistake now. Avoiding mistakes has benefits.",
    "created_at": "2020-08-04T20:52:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479591",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment%3A15):
> I don't think there is any harm in #22760 by adding the hook for it. However, I thought the coercion framework was designed to also handle actions. For example, you need coercion for `z * A` when `z` is an integer but `A` only has a `QQ`-action. I also thought the coercion framework was what called the different actions to see what was appropriate too.

Indeed, some coercion steps are possible for actions, but not nearly as much as for operations internal to structures. For instance, for addition between `ZZ[x,y]` and `QQ[z]`, the coercion system will construct a common covering structure `QQ[x,y,z]` by combining a sequence of "construction functors" according to certain (heuristic!) rules. I don't think the rules for actions are nearly as advanced -- probably no coercions on the acted-upon set are tried at all; and probably shouldn't.

I'd hope there are better tools available for exploring what coercion to take than to query and see "what works". If that's actually what happens, then applying it to partial operators such as composition is definitely inappropriate.

In general, I'm not so sure coercion will help for `@` if it goes the composition route, and then having the hook in the system is going to be counterproductive, because people will stumble on it and do unhelpful things with it. So I disagree with the idea that putting hooks just in case someone finds a use for it is harmless. Not making a design decision on it now can also mean not making a design mistake now. Avoiding mistakes has benefits.



---

archive/issue_comments_479592.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI think I will try out an alternative implementation of composition as a coerce-action (keeping the inherited `__mul__` operator). Then we can experiment with this a little to gather more insights.",
    "created_at": "2020-08-04T21:40:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479592",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

I think I will try out an alternative implementation of composition as a coerce-action (keeping the inherited `__mul__` operator). Then we can experiment with this a little to gather more insights.



---

archive/issue_events_413522.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-05T14:23:41Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "title_is": "Use _matmul_ operator (@) for matrix multiplication, map composition, tensor contraction",
    "title_was": "Use _matmul_ operator (@)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413522"
}
```



---

archive/issue_comments_479593.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jhpalmieri](#comment%3A3):\n> I think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.\n\nAs notation for tensor products, perhaps we can use a different operator ... how about the bitwise-and operator `&`?",
    "created_at": "2020-08-05T14:27:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479593",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jhpalmieri](#comment%3A3):
> I think using `@` for tensor products would be nicer than `tensor([M1,M2,M3])`. Aside from the fact that it's shorter, Sage's current implementation is a bit of a mess. For example, I can never remember that it should be `tensor([M1, M2, M3])`, not `tensor(M1, M2, M3)`, or you could use `M1.tensor(M2, M3)` but not `M1.tensor([M2, M3])`.

As notation for tensor products, perhaps we can use a different operator ... how about the bitwise-and operator `&`?



---

archive/issue_events_413523.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413523"
}
```



---

archive/issue_events_413524.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413524"
}
```



---

archive/issue_events_413525.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413525"
}
```



---

archive/issue_events_413526.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413526"
}
```



---

archive/issue_comments_479594.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479594",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_479595.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8\"><code>c08e5b5</code></a></td><td><code>sage.categories.map.Map: Add __matmul__</code></td></tr></table>\n",
    "created_at": "2021-07-14T22:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479595",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8"><code>c08e5b5</code></a></td><td><code>sage.categories.map.Map: Add __matmul__</code></td></tr></table>




---

archive/issue_comments_479596.json:
```json
{
    "body": "Changed commit from **[`a982dd8`](https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86)** to **[`c08e5b5`](https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8)**",
    "created_at": "2021-07-14T22:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479596",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a982dd8`](https://github.com/sagemath/sagetrac-mirror/commit/a982dd81253277c909d7f29b2e0615d5e90e9d86)** to **[`c08e5b5`](https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8)**



---

archive/issue_comments_479597.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d263307c9ba5fcb0a18ea1445dcfcfdc1198754a\"><code>d263307</code></a></td><td><code>IdentityMorphism: Override `__matmul__`, not __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9808f811d7778f536efbd5bc2c1c4743c61e0b2\"><code>b9808f8</code></a></td><td><code>PoorManMap: Add `__matmul__`, let `__mul__` just call __matmul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3efa472cec033774d244cc0bfc1021c82bf981b0\"><code>3efa472</code></a></td><td><code>ActionEndomorphism: Override `__matmul__`, not __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/430dad524dbb1fad4839d933ba168ebae62b7399\"><code>430dad5</code></a></td><td><code>ConstructionFunctor: Switch to `__matmul__` for functor composition; delegate from `__mul__` to __matmul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14ad8cde34741f5ece637c8d0b9d70697f39672a\"><code>14ad8cd</code></a></td><td><code>WordMorphism: Also define __matmul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c85802681fb1917aefae46b5ade6d020ff612d2\"><code>9c85802</code></a></td><td><code>MatrixSpace._get_action_: Handle matmul for matrix-matrix actions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d1dccd92ccb0ba88d21af0b72cee6ce8a644405\"><code>9d1dccd</code></a></td><td><code>Matrix.__matmul__: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e84a7dc094b992ae9bb11071ab22182612d87023\"><code>e84a7dc</code></a></td><td><code>MatrixMorphism_abstract: Define `__matmul__`, not __mul__; use @ in examples</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66206f9f55fe92cf855e2a7d922cbd1ec06707b5\"><code>66206f9</code></a></td><td><code>FanMorphism: Define `__matmul__`, not __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0\"><code>63b8892</code></a></td><td><code>HyperbolicIsometry: Split out _composition from `__mul__` so that also @ between isometries works</code></td></tr></table>\n",
    "created_at": "2021-07-16T01:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479597",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d263307c9ba5fcb0a18ea1445dcfcfdc1198754a"><code>d263307</code></a></td><td><code>IdentityMorphism: Override `__matmul__`, not __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9808f811d7778f536efbd5bc2c1c4743c61e0b2"><code>b9808f8</code></a></td><td><code>PoorManMap: Add `__matmul__`, let `__mul__` just call __matmul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3efa472cec033774d244cc0bfc1021c82bf981b0"><code>3efa472</code></a></td><td><code>ActionEndomorphism: Override `__matmul__`, not __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/430dad524dbb1fad4839d933ba168ebae62b7399"><code>430dad5</code></a></td><td><code>ConstructionFunctor: Switch to `__matmul__` for functor composition; delegate from `__mul__` to __matmul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14ad8cde34741f5ece637c8d0b9d70697f39672a"><code>14ad8cd</code></a></td><td><code>WordMorphism: Also define __matmul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c85802681fb1917aefae46b5ade6d020ff612d2"><code>9c85802</code></a></td><td><code>MatrixSpace._get_action_: Handle matmul for matrix-matrix actions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d1dccd92ccb0ba88d21af0b72cee6ce8a644405"><code>9d1dccd</code></a></td><td><code>Matrix.__matmul__: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e84a7dc094b992ae9bb11071ab22182612d87023"><code>e84a7dc</code></a></td><td><code>MatrixMorphism_abstract: Define `__matmul__`, not __mul__; use @ in examples</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66206f9f55fe92cf855e2a7d922cbd1ec06707b5"><code>66206f9</code></a></td><td><code>FanMorphism: Define `__matmul__`, not __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0"><code>63b8892</code></a></td><td><code>HyperbolicIsometry: Split out _composition from `__mul__` so that also @ between isometries works</code></td></tr></table>




---

archive/issue_comments_479598.json:
```json
{
    "body": "Changed commit from **[`c08e5b5`](https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8)** to **[`63b8892`](https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0)**",
    "created_at": "2021-07-16T01:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479598",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c08e5b5`](https://github.com/sagemath/sagetrac-mirror/commit/c08e5b5718a1f7a3e3ae2da578a92ab2c4848cf8)** to **[`63b8892`](https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0)**



---

archive/issue_comments_479599.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90\"><code>9588f52</code></a></td><td><code>FiniteSetEndoMap*: Define `__matmul__`, delegate to it from __mul__</code></td></tr></table>\n",
    "created_at": "2021-07-16T02:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479599",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90"><code>9588f52</code></a></td><td><code>FiniteSetEndoMap*: Define `__matmul__`, delegate to it from __mul__</code></td></tr></table>




---

archive/issue_comments_479600.json:
```json
{
    "body": "Changed commit from **[`63b8892`](https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0)** to **[`9588f52`](https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90)**",
    "created_at": "2021-07-16T02:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479600",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`63b8892`](https://github.com/sagemath/sagetrac-mirror/commit/63b8892628388ebb0dd5e6b313b211b00c223ff0)** to **[`9588f52`](https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90)**



---

archive/issue_events_413527.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-16T02:17:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413527"
}
```



---

archive/issue_comments_479601.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-07-16T02:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479601",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_479602.json:
```json
{
    "body": "Changed commit from **[`9588f52`](https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90)** to **[`f626394`](https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf)**",
    "created_at": "2021-07-16T02:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479602",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9588f52`](https://github.com/sagemath/sagetrac-mirror/commit/9588f52a880461173a4c48475ba933cb74cdac90)** to **[`f626394`](https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf)**



---

archive/issue_comments_479603.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf\"><code>f626394</code></a></td><td><code>TensorWithIndices: Make `__matmul__` an alias of __mul__</code></td></tr></table>\n",
    "created_at": "2021-07-16T02:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479603",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf"><code>f626394</code></a></td><td><code>TensorWithIndices: Make `__matmul__` an alias of __mul__</code></td></tr></table>




---

archive/issue_comments_479604.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3006833b25db04d37d79162ff40db45bc7386e27\"><code>3006833</code></a></td><td><code>FiniteSetEndoMap*: Define `__matmul__`, delegate to it from __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de14c348f592c9bda659bc45faad6d09c3ef4381\"><code>de14c34</code></a></td><td><code>TensorWithIndices: Make `__matmul__` an alias of __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5\"><code>451eb95</code></a></td><td><code>Map.__mul__: Add doctest output</code></td></tr></table>\n",
    "created_at": "2021-07-16T18:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479604",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3006833b25db04d37d79162ff40db45bc7386e27"><code>3006833</code></a></td><td><code>FiniteSetEndoMap*: Define `__matmul__`, delegate to it from __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de14c348f592c9bda659bc45faad6d09c3ef4381"><code>de14c34</code></a></td><td><code>TensorWithIndices: Make `__matmul__` an alias of __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5"><code>451eb95</code></a></td><td><code>Map.__mul__: Add doctest output</code></td></tr></table>




---

archive/issue_comments_479605.json:
```json
{
    "body": "Changed commit from **[`f626394`](https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf)** to **[`451eb95`](https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5)**",
    "created_at": "2021-07-16T18:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479605",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f626394`](https://github.com/sagemath/sagetrac-mirror/commit/f62639491c5605ba478791727f44bb3bca14ecdf)** to **[`451eb95`](https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5)**



---

archive/issue_comments_479606.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d\"><code>348f680</code></a></td><td><code>TensorWithIndices: Update doctests</code></td></tr></table>\n",
    "created_at": "2021-07-16T18:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479606",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d"><code>348f680</code></a></td><td><code>TensorWithIndices: Update doctests</code></td></tr></table>




---

archive/issue_comments_479607.json:
```json
{
    "body": "Changed commit from **[`451eb95`](https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5)** to **[`348f680`](https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d)**",
    "created_at": "2021-07-16T18:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479607",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`451eb95`](https://github.com/sagemath/sagetrac-mirror/commit/451eb95ea1467a4f0ceb468e2c081686efccbcc5)** to **[`348f680`](https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d)**



---

archive/issue_comments_479608.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/878e9238ee39dfeb2ce115d5447f0b1eb69fa622\"><code>878e923</code></a></td><td><code>CoercionModel.verify_coercion_maps: Use @ instead of * for composition</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98\"><code>da5104c</code></a></td><td><code>PrecomposedAction.__init__: Use @ instead of * for composition</code></td></tr></table>\n",
    "created_at": "2021-07-16T23:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479608",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/878e9238ee39dfeb2ce115d5447f0b1eb69fa622"><code>878e923</code></a></td><td><code>CoercionModel.verify_coercion_maps: Use @ instead of * for composition</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98"><code>da5104c</code></a></td><td><code>PrecomposedAction.__init__: Use @ instead of * for composition</code></td></tr></table>




---

archive/issue_comments_479609.json:
```json
{
    "body": "Changed commit from **[`348f680`](https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d)** to **[`da5104c`](https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98)**",
    "created_at": "2021-07-16T23:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479609",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`348f680`](https://github.com/sagemath/sagetrac-mirror/commit/348f6805894373fa8036afbd0db7423af127bb2d)** to **[`da5104c`](https://github.com/sagemath/sagetrac-mirror/commit/da5104cc5c3b00d2ccc68b76b65c2d1c2c56fa98)**



---

archive/issue_comments_479610.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,7 @@\n \n First step: Review the semantics of this operator in major Python software for matrix and tensor computation (NumPy, Numba, TensorFlow, PyTorch, ...) so that we do not paint ourselves into a corner.\n \n+Follow-up tickets:\n+- #32212 `sage.geometry.hyperbolic_space`\n \n \n-\n``````\n",
    "created_at": "2021-07-16T23:09:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479610",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,7 @@
 
 First step: Review the semantics of this operator in major Python software for matrix and tensor computation (NumPy, Numba, TensorFlow, PyTorch, ...) so that we do not paint ourselves into a corner.
 
+Follow-up tickets:
+- #32212 `sage.geometry.hyperbolic_space`
 
 
-
``````




---

archive/issue_comments_479611.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nNot sure if @ should also be used for matrix-vector multiplication. The current code on the branch does not do this; but scipy seems to think so (see for example https://docs.scipy.org/doc/scipy/reference/optimize.linprog-highs.html)",
    "created_at": "2021-07-26T18:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30244#issuecomment-479611",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Not sure if @ should also be used for matrix-vector multiplication. The current code on the branch does not do this; but scipy seems to think so (see for example https://docs.scipy.org/doc/scipy/reference/optimize.linprog-highs.html)



---

archive/issue_events_413528.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413528"
}
```



---

archive/issue_events_413529.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413529"
}
```



---

archive/issue_events_413530.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-14T00:52:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413530"
}
```



---

archive/issue_events_413531.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-14T00:52:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413531"
}
```



---

archive/issue_events_413532.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413532"
}
```



---

archive/issue_events_413533.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413533"
}
```



---

archive/issue_events_413534.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413534"
}
```



---

archive/issue_events_413535.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413535"
}
```



---

archive/issue_events_413536.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413536"
}
```



---

archive/issue_events_413537.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413537"
}
```



---

archive/issue_events_413538.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413538"
}
```



---

archive/issue_events_413539.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30244",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30244#event-413539"
}
```
