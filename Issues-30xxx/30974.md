# Issue 30974: sage --package create PACKAGE --pypi

archive/issues_030737.json:
```json
{
    "assignees": [],
    "body": "We add a simple command that creates a normal package from PyPI.\n\n```\n$ ./sage -package create scikit_spatial --pypi\nDownloading tarball to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/upstream/scikit-spatial-5.0.0.tar.gz\n[......................................................................]\n$ ls build/pkgs/scikit_spatial/\nSPKG.rst\t\tdependencies\t\tpackage-version.txt\ttype\nchecksums.ini\t\tinstall-requires.txt\tspkg-install.in\n$ cat build/pkgs/scikit_spatial/SPKG.rst \nscikit_spatial\n==============\n\nDescription\n-----------\n\nSpatial objects and computations based on NumPy arrays.\n\nLicense\n-------\n\nBSD license\n\nUpstream Contact\n----------------\n\nhttps://pypi.org/project/scikit-spatial/\n```\n\n\nAdditionally, we fix the following error that occurs in `sage --package create` when `--type` is not set:\n\n```\n./sage -package create jupyter_jsmol --tarball jupyter_jsmol-VERSION.tar.gz --url https://pypi.io/packages/source/j/jupyter-jsmol/jupyter_jsmol-VERSION.tar.gz --version 0.2.4\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/bin/../sage_bootstrap/package.py\", line 291, in _init_type\n    with open(os.path.join(self.path, 'type')) as f:\nIOError: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/jupyter_jsmol/type'\n```\nThe fix just uses type `optional` in this situation, which is a good default.\n\n\n\n\n\nCC:  @seblabbe @jhpalmieri @malb\n\nComponent: **build**\n\nKeywords: **sd111**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**\n\nReviewer: **S\u00e9bastien Labb\u00e9**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30974_\n\n",
    "closed_at": "2020-12-14T23:53:17Z",
    "created_at": "2020-11-29T06:40:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage --package create PACKAGE --pypi",
    "type": "issue",
    "updated_at": "2020-12-14T23:53:17Z",
    "url": "https://github.com/sagemath/sage/issues/30974",
    "user": "https://github.com/mkoeppe"
}
```
We add a simple command that creates a normal package from PyPI.

```
$ ./sage -package create scikit_spatial --pypi
Downloading tarball to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/upstream/scikit-spatial-5.0.0.tar.gz
[......................................................................]
$ ls build/pkgs/scikit_spatial/
SPKG.rst		dependencies		package-version.txt	type
checksums.ini		install-requires.txt	spkg-install.in
$ cat build/pkgs/scikit_spatial/SPKG.rst 
scikit_spatial
==============

Description
-----------

Spatial objects and computations based on NumPy arrays.

License
-------

BSD license

Upstream Contact
----------------

https://pypi.org/project/scikit-spatial/
```


Additionally, we fix the following error that occurs in `sage --package create` when `--type` is not set:

```
./sage -package create jupyter_jsmol --tarball jupyter_jsmol-VERSION.tar.gz --url https://pypi.io/packages/source/j/jupyter-jsmol/jupyter_jsmol-VERSION.tar.gz --version 0.2.4
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/bin/../sage_bootstrap/package.py", line 291, in _init_type
    with open(os.path.join(self.path, 'type')) as f:
IOError: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/jupyter_jsmol/type'
```
The fix just uses type `optional` in this situation, which is a good default.





CC:  @seblabbe @jhpalmieri @malb

Component: **build**

Keywords: **sd111**

Author: **Matthias Koeppe**

Branch/Commit: **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**

Reviewer: **Sébastien Labbé**

_Issue created by migration from https://trac.sagemath.org/ticket/30974_





---

archive/issue_events_424011.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-29T06:40:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424011"
}
```



---

archive/issue_events_424012.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-29T06:40:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424012"
}
```



---

archive/issue_events_424013.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-29T06:40:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424013"
}
```



---

archive/issue_events_424014.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-29T06:40:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424014"
}
```



---

archive/issue_comments_496245.json:
```json
{
    "body": "Branch: **[u/mkoeppe/improve_sage___package_create](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/improve_sage___package_create)**",
    "created_at": "2020-12-05T20:41:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496245",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/improve_sage___package_create](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/improve_sage___package_create)**



---

archive/issue_comments_496246.json:
```json
{
    "body": "Commit: **[`c2f5781`](https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e)**",
    "created_at": "2020-12-05T20:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496246",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`c2f5781`](https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e)**



---

archive/issue_comments_496247.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHelp on this ticket is welcome\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e\"><code>c2f5781</code></a></td><td><code>WIP</code></td></tr></table>\n",
    "created_at": "2020-12-05T20:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496247",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Help on this ticket is welcome

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e"><code>c2f5781</code></a></td><td><code>WIP</code></td></tr></table>




---

archive/issue_comments_496248.json:
```json
{
    "body": "Changed commit from **[`c2f5781`](https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e)** to **[`879b042`](https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb)**",
    "created_at": "2020-12-06T03:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496248",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c2f5781`](https://github.com/sagemath/sagetrac-mirror/commit/c2f578100bbb49bb5b12d764c71c35ed9fa3111e)** to **[`879b042`](https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb)**



---

archive/issue_comments_496249.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ff85e7599705a0965817d1c0c958989758ea954\"><code>3ff85e7</code></a></td><td><code>sage_bootstrap.pypi.PyPiVersion: Add properties tarball, package_url, license, summary</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c81ddf65f3fb853447e655876d28fe0c05f04a5f\"><code>c81ddf6</code></a></td><td><code>sage_bootstrap.creator.PackageCreator.set_description: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb\"><code>879b042</code></a></td><td><code>sage --package create: Add options to set the contents of SPKG.rst, and to get data from PyPI</code></td></tr></table>\n",
    "created_at": "2020-12-06T03:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496249",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ff85e7599705a0965817d1c0c958989758ea954"><code>3ff85e7</code></a></td><td><code>sage_bootstrap.pypi.PyPiVersion: Add properties tarball, package_url, license, summary</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c81ddf65f3fb853447e655876d28fe0c05f04a5f"><code>c81ddf6</code></a></td><td><code>sage_bootstrap.creator.PackageCreator.set_description: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb"><code>879b042</code></a></td><td><code>sage --package create: Add options to set the contents of SPKG.rst, and to get data from PyPI</code></td></tr></table>




---

archive/issue_comments_496250.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3\"><code>0622e20</code></a></td><td><code>sage --package create: If --pypi is given, also write default dependencies, spkg-install.in, and install-requires.txt</code></td></tr></table>\n",
    "created_at": "2020-12-06T03:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496250",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3"><code>0622e20</code></a></td><td><code>sage --package create: If --pypi is given, also write default dependencies, spkg-install.in, and install-requires.txt</code></td></tr></table>




---

archive/issue_comments_496251.json:
```json
{
    "body": "Changed commit from **[`879b042`](https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb)** to **[`0622e20`](https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3)**",
    "created_at": "2020-12-06T03:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496251",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`879b042`](https://github.com/sagemath/sagetrac-mirror/commit/879b042a260001fb7b351095edc247e8fc9660cb)** to **[`0622e20`](https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3)**



---

archive/issue_comments_496252.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781\"><code>f0102d3</code></a></td><td><code>sage --package create --pypi: Use the canonical package name in install-requires.txt</code></td></tr></table>\n",
    "created_at": "2020-12-06T04:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496252",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781"><code>f0102d3</code></a></td><td><code>sage --package create --pypi: Use the canonical package name in install-requires.txt</code></td></tr></table>




---

archive/issue_comments_496253.json:
```json
{
    "body": "Changed commit from **[`0622e20`](https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3)** to **[`f0102d3`](https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781)**",
    "created_at": "2020-12-06T04:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496253",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0622e20`](https://github.com/sagemath/sagetrac-mirror/commit/0622e205672b00538af05ebdddd3c1828e4a9ba3)** to **[`f0102d3`](https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781)**



---

archive/issue_comments_496254.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c54a33f288052d61301a70a0a97e38f32891156a\"><code>c54a33f</code></a></td><td><code>sage --package create: If a tarball is set, provide a default to 'type'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d\"><code>3ebccc2</code></a></td><td><code>sage --package cerate: Refuse to create packages with dashes in their name</code></td></tr></table>\n",
    "created_at": "2020-12-06T04:21:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496254",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c54a33f288052d61301a70a0a97e38f32891156a"><code>c54a33f</code></a></td><td><code>sage --package create: If a tarball is set, provide a default to 'type'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d"><code>3ebccc2</code></a></td><td><code>sage --package cerate: Refuse to create packages with dashes in their name</code></td></tr></table>




---

archive/issue_comments_496255.json:
```json
{
    "body": "Changed commit from **[`f0102d3`](https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781)** to **[`3ebccc2`](https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d)**",
    "created_at": "2020-12-06T04:21:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496255",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f0102d3`](https://github.com/sagemath/sagetrac-mirror/commit/f0102d3bb859b0bd243532336938552fb7fca781)** to **[`3ebccc2`](https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d)**



---

archive/issue_comments_496256.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff\"><code>e82fe48</code></a></td><td><code>sage --package create: Refuse to create packages with dashes in their name</code></td></tr></table>\n",
    "created_at": "2020-12-06T04:22:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496256",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff"><code>e82fe48</code></a></td><td><code>sage --package create: Refuse to create packages with dashes in their name</code></td></tr></table>




---

archive/issue_comments_496257.json:
```json
{
    "body": "Changed commit from **[`3ebccc2`](https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d)** to **[`e82fe48`](https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff)**",
    "created_at": "2020-12-06T04:22:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496257",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3ebccc2`](https://github.com/sagemath/sagetrac-mirror/commit/3ebccc256992f716175707ba41d722046da0816d)** to **[`e82fe48`](https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff)**



---

archive/issue_events_424015.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T04:27:47Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "title_is": "sage --package create PACKAGE --pypi",
    "title_was": "Improve sage --package create",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424015"
}
```



---

archive/issue_comments_496258.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-12-06T04:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496258",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_424016.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T04:27:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424016"
}
```



---

archive/issue_comments_496259.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,34 @@\n+We add a simple command that creates a normal package from PyPI.\n+\n+```\n+$ ./sage -package create scikit_spatial --pypi\n+Downloading tarball to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/upstream/scikit-spatial-5.0.0.tar.gz\n+[......................................................................]\n+$ ls build/pkgs/scikit_spatial/\n+SPKG.rst\t\tdependencies\t\tpackage-version.txt\ttype\n+checksums.ini\t\tinstall-requires.txt\tspkg-install.in\n+$ cat build/pkgs/scikit_spatial/SPKG.rst \n+scikit_spatial\n+==============\n+\n+Description\n+-----------\n+\n+Spatial objects and computations based on NumPy arrays.\n+\n+License\n+-------\n+\n+BSD license\n+\n+Upstream Contact\n+----------------\n+\n+https://pypi.org/project/scikit-spatial/\n+```\n+\n+\n+Additionally, we fix the following error that occurs in `sage --package create` when `--type` is not set:\n \n ```\n ./sage -package create jupyter_jsmol --tarball jupyter_jsmol-VERSION.tar.gz --url https://pypi.io/packages/source/j/jupyter-jsmol/jupyter_jsmol-VERSION.tar.gz --version 0.2.4\n@@ -5,7 +36,8 @@\n     with open(os.path.join(self.path, 'type')) as f:\n IOError: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/jupyter_jsmol/type'\n ```\n-\n-Additionally, we should have a simple command that creates a package from PyPI, including creating a `README.rst` file.\n+The fix just uses type `optional` in this situation, which is a good default.\n \n \n+\n+\n``````\n",
    "created_at": "2020-12-06T04:27:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496259",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,34 @@
+We add a simple command that creates a normal package from PyPI.
+
+```
+$ ./sage -package create scikit_spatial --pypi
+Downloading tarball to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/upstream/scikit-spatial-5.0.0.tar.gz
+[......................................................................]
+$ ls build/pkgs/scikit_spatial/
+SPKG.rst		dependencies		package-version.txt	type
+checksums.ini		install-requires.txt	spkg-install.in
+$ cat build/pkgs/scikit_spatial/SPKG.rst 
+scikit_spatial
+==============
+
+Description
+-----------
+
+Spatial objects and computations based on NumPy arrays.
+
+License
+-------
+
+BSD license
+
+Upstream Contact
+----------------
+
+https://pypi.org/project/scikit-spatial/
+```
+
+
+Additionally, we fix the following error that occurs in `sage --package create` when `--type` is not set:
 
 ```
 ./sage -package create jupyter_jsmol --tarball jupyter_jsmol-VERSION.tar.gz --url https://pypi.io/packages/source/j/jupyter-jsmol/jupyter_jsmol-VERSION.tar.gz --version 0.2.4
@@ -5,7 +36,8 @@
     with open(os.path.join(self.path, 'type')) as f:
 IOError: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/jupyter_jsmol/type'
 ```
-
-Additionally, we should have a simple command that creates a package from PyPI, including creating a `README.rst` file.
+The fix just uses type `optional` in this situation, which is a good default.
 
 
+
+
``````




---

archive/issue_comments_496260.json:
```json
{
    "body": "Changed commit from **[`e82fe48`](https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff)** to **[`e904464`](https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a)**",
    "created_at": "2020-12-06T05:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496260",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e82fe48`](https://github.com/sagemath/sagetrac-mirror/commit/e82fe48bca9295256e00053145787fc8b99725ff)** to **[`e904464`](https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a)**



---

archive/issue_comments_496261.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d07bb5e33c14635f84553f79b77a3e3964a6c5c\"><code>8d07bb5</code></a></td><td><code>src/doc/en/developer/packaging.rst: Mention upstream_url</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86e048fc1ec5c2bf04f7eb46319f53b283a079fe\"><code>86e048f</code></a></td><td><code>src/doc/en/developer/packaging.rst: Trimming mirror list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/401ca7cd193644747778215ea7727b230c719655\"><code>401ca7c</code></a></td><td><code>Merge commit '86e048fc1ec5c2bf04f7eb46319f53b283a079fe' of git://trac.sagemath.org/sage into t/30974/improve_sage___package_create</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a\"><code>e904464</code></a></td><td><code>src/doc/en/developer/packaging.rst: Document sage --package create --pypi</code></td></tr></table>\n",
    "created_at": "2020-12-06T05:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496261",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d07bb5e33c14635f84553f79b77a3e3964a6c5c"><code>8d07bb5</code></a></td><td><code>src/doc/en/developer/packaging.rst: Mention upstream_url</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86e048fc1ec5c2bf04f7eb46319f53b283a079fe"><code>86e048f</code></a></td><td><code>src/doc/en/developer/packaging.rst: Trimming mirror list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/401ca7cd193644747778215ea7727b230c719655"><code>401ca7c</code></a></td><td><code>Merge commit '86e048fc1ec5c2bf04f7eb46319f53b283a079fe' of git://trac.sagemath.org/sage into t/30974/improve_sage___package_create</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a"><code>e904464</code></a></td><td><code>src/doc/en/developer/packaging.rst: Document sage --package create --pypi</code></td></tr></table>




---

archive/issue_comments_496262.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2\"><code>0c42490</code></a></td><td><code>sage --package create PACKAGE --pypi --source=pip</code></td></tr></table>\n",
    "created_at": "2020-12-06T17:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496262",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2"><code>0c42490</code></a></td><td><code>sage --package create PACKAGE --pypi --source=pip</code></td></tr></table>




---

archive/issue_comments_496263.json:
```json
{
    "body": "Changed commit from **[`e904464`](https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a)** to **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**",
    "created_at": "2020-12-06T17:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496263",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e904464`](https://github.com/sagemath/sagetrac-mirror/commit/e904464680eecebba2235c2f9fdc3729432f922a)** to **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**



---

archive/issue_comments_496264.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496264",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_496265.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496265",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_events_424017.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-12-09T11:02:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424017"
}
```



---

archive/issue_events_424018.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-12-09T11:02:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424018"
}
```



---

archive/issue_comments_496266.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI tested it with my own optional package which I should include in the list of sage optional package at some point...\n\nIt looks good:\n\n```\n$ sage -package create slabbe --pypi --type optional\nDownloading tarball to /home/slabbe/GitBox/sage/upstream/slabbe-0.6.1.tar.gz\n[......................................................................]\n$ git status\nSur la branche 30974\nFichiers non suivis:\n  (utilisez \"git add <fichier>...\" pour inclure dans ce qui sera valid\u00e9)\n\n\tbuild/pkgs/slabbe/\n\naucune modification ajout\u00e9e \u00e0 la validation mais des fichiers non suivis sont pr\u00e9sents (utilisez \"git add\" pour les suivre)\nslabbe@miami sage $ cd build/pkgs/slabbe/\nslabbe@miami slabbe $ ls\nchecksums.ini  install-requires.txt  spkg-install.in  type\ndependencies   package-version.txt   SPKG.rst\n```\n\nThe content of the following is:\n\n```\n$ cat install-requires.txt \nslabbe\n```\n\nBut, my package does depend on two other packages:\n\n```\n$ grep requires ~/GitBox/slabbe/setup.py \n    install_requires=['pytimeparse', 'roman'],\n    #install_requires=['cython','cysignals'], # this causes update of cysignals\n```\nI guess we do not want the create command to be recursive, but should the content of `install-requires.txt` depend on the content of the `install_requires` variable of the `setup.py` of the package?",
    "created_at": "2020-12-09T11:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496266",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:13" align="right">comment:13</div>

I tested it with my own optional package which I should include in the list of sage optional package at some point...

It looks good:

```
$ sage -package create slabbe --pypi --type optional
Downloading tarball to /home/slabbe/GitBox/sage/upstream/slabbe-0.6.1.tar.gz
[......................................................................]
$ git status
Sur la branche 30974
Fichiers non suivis:
  (utilisez "git add <fichier>..." pour inclure dans ce qui sera validé)

	build/pkgs/slabbe/

aucune modification ajoutée à la validation mais des fichiers non suivis sont présents (utilisez "git add" pour les suivre)
slabbe@miami sage $ cd build/pkgs/slabbe/
slabbe@miami slabbe $ ls
checksums.ini  install-requires.txt  spkg-install.in  type
dependencies   package-version.txt   SPKG.rst
```

The content of the following is:

```
$ cat install-requires.txt 
slabbe
```

But, my package does depend on two other packages:

```
$ grep requires ~/GitBox/slabbe/setup.py 
    install_requires=['pytimeparse', 'roman'],
    #install_requires=['cython','cysignals'], # this causes update of cysignals
```
I guess we do not want the create command to be recursive, but should the content of `install-requires.txt` depend on the content of the `install_requires` variable of the `setup.py` of the package?



---

archive/issue_comments_496267.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nNow testing as a pip package rather than a normal package:\n\n```\n$ mv slabbe slabbe-1\n$ cd ../..\n$ sage -package create slabbe --pypi --source pip --type optional\n$ git status\nSur la branche 30974\nFichiers non suivis:\n  (utilisez \"git add <fichier>...\" pour inclure dans ce qui sera valid\u00e9)\n\n\tbuild/pkgs/slabbe-1/\n\tbuild/pkgs/slabbe/\n\n$ cd build/pkgs/slabbe\n$ ls\ndependencies  requirements.txt  SPKG.rst  type\n$ cat dependencies \n$(PYTHON) | $(PYTHON_TOOLCHAIN)\n\n----------\nAll lines of this file are ignored except the first.\n$ cat requirements.txt \nslabbe\n$ cat type \noptional\n```\n\nAgain, should `install_requires=['pytimeparse', 'roman'],` be considered in the content of the above?",
    "created_at": "2020-12-09T11:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496267",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:14" align="right">comment:14</div>

Now testing as a pip package rather than a normal package:

```
$ mv slabbe slabbe-1
$ cd ../..
$ sage -package create slabbe --pypi --source pip --type optional
$ git status
Sur la branche 30974
Fichiers non suivis:
  (utilisez "git add <fichier>..." pour inclure dans ce qui sera validé)

	build/pkgs/slabbe-1/
	build/pkgs/slabbe/

$ cd build/pkgs/slabbe
$ ls
dependencies  requirements.txt  SPKG.rst  type
$ cat dependencies 
$(PYTHON) | $(PYTHON_TOOLCHAIN)

----------
All lines of this file are ignored except the first.
$ cat requirements.txt 
slabbe
$ cat type 
optional
```

Again, should `install_requires=['pytimeparse', 'roman'],` be considered in the content of the above?



---

archive/issue_comments_496268.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nNo, I think it's out of the scope of the ticket to determine dependencies by looking into the tarball",
    "created_at": "2020-12-09T20:49:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496268",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

No, I think it's out of the scope of the ticket to determine dependencies by looking into the tarball



---

archive/issue_events_424019.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-09T20:50:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424019"
}
```



---

archive/issue_events_424020.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-09T20:50:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424020"
}
```



---

archive/issue_events_424021.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-12-11T21:16:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424021"
}
```



---

archive/issue_events_424022.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2020-12-11T21:16:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424022"
}
```



---

archive/issue_comments_496269.json:
```json
{
    "body": "Reviewer: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2020-12-11T21:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496269",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Sébastien Labbé**



---

archive/issue_comments_496270.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOk.\n\nI tested the creation (2 ways: spkg + pip). I chacked that installation (`sage -i`) works in both cases.",
    "created_at": "2020-12-11T21:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496270",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:17" align="right">comment:17</div>

Ok.

I tested the creation (2 ways: spkg + pip). I chacked that installation (`sage -i`) works in both cases.



---

archive/issue_comments_496271.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThank you!",
    "created_at": "2020-12-11T21:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496271",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Thank you!



---

archive/issue_events_424023.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-14T23:53:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424023"
}
```



---

archive/issue_events_424024.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d297724750b907d25b567504125ac4a6df748844",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-12-14T23:53:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30974#event-424024"
}
```



---

archive/issue_comments_496272.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/improve_sage___package_create](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/improve_sage___package_create)** to **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**",
    "created_at": "2020-12-14T23:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30974#issuecomment-496272",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/improve_sage___package_create](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/improve_sage___package_create)** to **[`0c42490`](https://github.com/sagemath/sagetrac-mirror/commit/0c4249072d1ab781a83a69e5503d4a88aa2f9db2)**
