# Issue 30039: Implement weighted version of 2Dsweep and DiFUB

archive/issues_029802.json:
```json
{
    "body": "This ticket aims to implement weighted version of `2Dsweep` and `DiFUB`\n\nCC:  @dcoudert\n\nKeywords: gsoc2020\n\nBranch/Commit: [7bcd9db9dd80f8902a6bc938b34486a6801ac7c0](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)\n\nReviewer: David Coudert\n\nAuthor: Vipul Gupta\n\nDependencies: #29422\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30039\n\n",
    "closed_at": "2020-08-02T08:20:46Z",
    "created_at": "2020-07-01T12:59:19Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Implement weighted version of 2Dsweep and DiFUB",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30039",
    "user": "https://github.com/vipul79321"
}
```
This ticket aims to implement weighted version of `2Dsweep` and `DiFUB`

CC:  @dcoudert

Keywords: gsoc2020

Branch/Commit: [7bcd9db9dd80f8902a6bc938b34486a6801ac7c0](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)

Reviewer: David Coudert

Author: Vipul Gupta

Dependencies: #29422

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30039





---

archive/issue_comments_590982.json:
```json
{
    "body": "Changing branch from \"\" to \"public/graphs/30039_weighted_difub\"",
    "created_at": "2020-07-01T13:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590982",
    "user": "https://github.com/vipul79321"
}
```

Changing branch from "" to "public/graphs/30039_weighted_difub"



---

archive/issue_comments_590983.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-01T13:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590983",
    "user": "https://github.com/vipul79321"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_590984.json:
```json
{
    "body": "Changing commit from \"\" to \"2d53b3edca6ef352aeaf12b4ff1221ac6b18f534\"",
    "created_at": "2020-07-01T13:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590984",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "2d53b3edca6ef352aeaf12b4ff1221ac6b18f534"



---

archive/issue_comments_590985.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------|\n|[ef68ef3](https://github.com/sagemath/sagetrac-mirror/commit/ef68ef391b8cba890af4ef872ff08de47071ed52)|`code added`|\n|[8546f52](https://github.com/sagemath/sagetrac-mirror/commit/8546f52d3af19b6437f8c5b325fb76d5de2b791e)|`documentation added`|\n|[0c73b63](https://github.com/sagemath/sagetrac-mirror/commit/0c73b6387f926480a7db45b2a62a0c787cc8ae2e)|`trac #29422: merged with 9.2.beta2`|\n|[eb335a5](https://github.com/sagemath/sagetrac-mirror/commit/eb335a5cc0787fc19863311d0e9ce25452b3c793)|`trac #29422: review commit`|\n|[d0697f8](https://github.com/sagemath/sagetrac-mirror/commit/d0697f89c42f0894ab1178c39d8ab0264dfebe05)|`Exposed in  digraph.py and fixed patchbots issues`|\n|[2d53b3e](https://github.com/sagemath/sagetrac-mirror/commit/2d53b3edca6ef352aeaf12b4ff1221ac6b18f534)|` weighted 2Dsweep added`|",
    "created_at": "2020-07-01T13:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[ef68ef3](https://github.com/sagemath/sagetrac-mirror/commit/ef68ef391b8cba890af4ef872ff08de47071ed52)|`code added`|
|[8546f52](https://github.com/sagemath/sagetrac-mirror/commit/8546f52d3af19b6437f8c5b325fb76d5de2b791e)|`documentation added`|
|[0c73b63](https://github.com/sagemath/sagetrac-mirror/commit/0c73b6387f926480a7db45b2a62a0c787cc8ae2e)|`trac #29422: merged with 9.2.beta2`|
|[eb335a5](https://github.com/sagemath/sagetrac-mirror/commit/eb335a5cc0787fc19863311d0e9ce25452b3c793)|`trac #29422: review commit`|
|[d0697f8](https://github.com/sagemath/sagetrac-mirror/commit/d0697f89c42f0894ab1178c39d8ab0264dfebe05)|`Exposed in  digraph.py and fixed patchbots issues`|
|[2d53b3e](https://github.com/sagemath/sagetrac-mirror/commit/2d53b3edca6ef352aeaf12b4ff1221ac6b18f534)|` weighted 2Dsweep added`|



---

archive/issue_comments_590986.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [git](#comment%3A2):\n> |                                                                                                                                           |                         |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n> |[2d53b3e](https://github.com/sagemath/sagetrac-mirror/commit/2d53b3edca6ef352aeaf12b4ff1221ac6b18f534)|` weighted 2Dsweep added`|\n\n\nHello David, \n\nI have added weighted version of `2Dsweep` and wrapper method for `diameter` computation similar to in `distances_all_pairs.pyx`. Its not final yet, I just wanted to keep you updated with how I have decided to organize it.\n\nKindly take a look at it. Any suggestions will be helpful.\n\nI will hopefully complete the weighted version of `DiFUB` by tomorrow.\n\nVipul",
    "created_at": "2020-07-01T13:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590986",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:3'></a>
Replying to [git](#comment%3A2):
> |                                                                                                                                           |                         |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
> |[2d53b3e](https://github.com/sagemath/sagetrac-mirror/commit/2d53b3edca6ef352aeaf12b4ff1221ac6b18f534)|` weighted 2Dsweep added`|


Hello David, 

I have added weighted version of `2Dsweep` and wrapper method for `diameter` computation similar to in `distances_all_pairs.pyx`. Its not final yet, I just wanted to keep you updated with how I have decided to organize it.

Kindly take a look at it. Any suggestions will be helpful.

I will hopefully complete the weighted version of `DiFUB` by tomorrow.

Vipul



---

archive/issue_comments_590987.json:
```json
{
    "body": "<a id='comment:4'></a>\nYou don't compute distances from antipodes...",
    "created_at": "2020-07-01T15:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590987",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>
You don't compute distances from antipodes...



---

archive/issue_comments_590988.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [dcoudert](#comment%3A4):\n> You don't compute distances from antipodes...\n> \n> \n\nI didnt quite understand what you are saying, are you suggesting to stop 2Dsweep after 2nd step. But i would like to mention that we have followed the same steps in unweighted version of 2Dsweep. \n\nSorry to bother you.. But can you please expalin you are saying.",
    "created_at": "2020-07-01T17:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590988",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:5'></a>
Replying to [dcoudert](#comment%3A4):
> You don't compute distances from antipodes...
> 
> 

I didnt quite understand what you are saying, are you suggesting to stop 2Dsweep after 2nd step. But i would like to mention that we have followed the same steps in unweighted version of 2Dsweep. 

Sorry to bother you.. But can you please expalin you are saying.



---

archive/issue_comments_590989.json:
```json
{
    "body": "<a id='comment:6'></a>\nI missed these lines\n\n```\n+    source_1 = antipode_1\n+    source_2 = antipode_2\n```\nso it's ok.",
    "created_at": "2020-07-01T17:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590989",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>
I missed these lines

```
+    source_1 = antipode_1
+    source_2 = antipode_2
```
so it's ok.



---

archive/issue_comments_590990.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[867a0a8](https://github.com/sagemath/sagetrac-mirror/commit/867a0a8dd653dc70b0280ec1f8532a781ece1a95)|`weighted difub added and exposed in digraph.py`|",
    "created_at": "2020-07-02T13:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[867a0a8](https://github.com/sagemath/sagetrac-mirror/commit/867a0a8dd653dc70b0280ec1f8532a781ece1a95)|`weighted difub added and exposed in digraph.py`|



---

archive/issue_comments_590991.json:
```json
{
    "body": "Changing commit from \"2d53b3edca6ef352aeaf12b4ff1221ac6b18f534\" to \"867a0a8dd653dc70b0280ec1f8532a781ece1a95\"",
    "created_at": "2020-07-02T13:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590991",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2d53b3edca6ef352aeaf12b4ff1221ac6b18f534" to "867a0a8dd653dc70b0280ec1f8532a781ece1a95"



---

archive/issue_comments_590992.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [git](#comment%3A7):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n> |[867a0a8](https://github.com/sagemath/sagetrac-mirror/commit/867a0a8dd653dc70b0280ec1f8532a781ece1a95)|`weighted difub added and exposed in digraph.py`|\n\n\nP.S. - I have made the changes in `eccentricity` method in `digraph.py` similar to `graph.py`",
    "created_at": "2020-07-02T13:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590992",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:8'></a>
Replying to [git](#comment%3A7):
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                |
> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
> |[867a0a8](https://github.com/sagemath/sagetrac-mirror/commit/867a0a8dd653dc70b0280ec1f8532a781ece1a95)|`weighted difub added and exposed in digraph.py`|


P.S. - I have made the changes in `eccentricity` method in `digraph.py` similar to `graph.py`



---

archive/issue_comments_590993.json:
```json
{
    "body": "<a id='comment:9'></a>\n\n```diff\n-    Returns lower bound on the diamter of weighted digraph using the weighted\n-    version of the algorithm proposed in [Broder2000]_.\n+    Return a lower bound on the diameter of `G`.\n+    \n+    This method implements the weighted version of the algorithm proposed\n+    in [Broder2000]_ to compute a lower bound of the weighted digraph `G`.\n```\n\nThis should work and be slightly faster (ok, minor improvement)\n\n```diff\n-        order_1.push_back(pair[double, v_index](distances[v], v))\n+        order_1.emplace_back(distances[v], v)\n```\n\n```diff\n-            computed diameter. They also works with negative weight, if there is\n+            computed diameter. They also work with negative weight, if there is\n```\n\nThe documentation you added in `digraph.py` suggests that we don't have a basic method for weighted digraphs, but we do.\n\nIn the comparison of methods, you can compare DiFUB with any exact algorithm based on eccentricity.",
    "created_at": "2020-07-02T15:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590993",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>

```diff
-    Returns lower bound on the diamter of weighted digraph using the weighted
-    version of the algorithm proposed in [Broder2000]_.
+    Return a lower bound on the diameter of `G`.
+    
+    This method implements the weighted version of the algorithm proposed
+    in [Broder2000]_ to compute a lower bound of the weighted digraph `G`.
```

This should work and be slightly faster (ok, minor improvement)

```diff
-        order_1.push_back(pair[double, v_index](distances[v], v))
+        order_1.emplace_back(distances[v], v)
```

```diff
-            computed diameter. They also works with negative weight, if there is
+            computed diameter. They also work with negative weight, if there is
```

The documentation you added in `digraph.py` suggests that we don't have a basic method for weighted digraphs, but we do.

In the comparison of methods, you can compare DiFUB with any exact algorithm based on eccentricity.



---

archive/issue_comments_590994.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[14e44ec](https://github.com/sagemath/sagetrac-mirror/commit/14e44ec709d3daf6bb3b849febb419605a400d57)|`minor changes in documentation`|",
    "created_at": "2020-07-03T11:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[14e44ec](https://github.com/sagemath/sagetrac-mirror/commit/14e44ec709d3daf6bb3b849febb419605a400d57)|`minor changes in documentation`|



---

archive/issue_comments_590995.json:
```json
{
    "body": "Changing commit from \"867a0a8dd653dc70b0280ec1f8532a781ece1a95\" to \"14e44ec709d3daf6bb3b849febb419605a400d57\"",
    "created_at": "2020-07-03T11:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "867a0a8dd653dc70b0280ec1f8532a781ece1a95" to "14e44ec709d3daf6bb3b849febb419605a400d57"



---

archive/issue_comments_590996.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [dcoudert](#comment%3A9):\n> \n\n\n> This should work and be slightly faster (ok, minor improvement)\n> \n> ```diff\n> -        order_1.push_back(pair[double, v_index](distances[v], v))\n> +        order_1.emplace_back(distances[v], v)\n> ```\n> \n\nThis threw an error, so I kept the previous version.\n\n> The documentation you added in `digraph.py` suggests that we don't have a basic method for weighted digraphs, but we do.\n> \n\nI have made changes for that, but i am not sure are those changes sufficient?\n\n> In the comparison of methods, you can compare DiFUB with any exact algorithm based on eccentricity.\n\n\nDone.",
    "created_at": "2020-07-03T11:14:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590996",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:11'></a>
Replying to [dcoudert](#comment%3A9):
> 


> This should work and be slightly faster (ok, minor improvement)
> 
> ```diff
> -        order_1.push_back(pair[double, v_index](distances[v], v))
> +        order_1.emplace_back(distances[v], v)
> ```
> 

This threw an error, so I kept the previous version.

> The documentation you added in `digraph.py` suggests that we don't have a basic method for weighted digraphs, but we do.
> 

I have made changes for that, but i am not sure are those changes sufficient?

> In the comparison of methods, you can compare DiFUB with any exact algorithm based on eccentricity.


Done.



---

archive/issue_comments_590997.json:
```json
{
    "body": "<a id='comment:12'></a>\nhave also a look at the errors reported by the patchbot.",
    "created_at": "2020-07-03T11:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590997",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>
have also a look at the errors reported by the patchbot.



---

archive/issue_comments_590998.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[4fe3d4a](https://github.com/sagemath/sagetrac-mirror/commit/4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591)|`Patchbot issues fixed`|",
    "created_at": "2020-07-05T17:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590998",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[4fe3d4a](https://github.com/sagemath/sagetrac-mirror/commit/4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591)|`Patchbot issues fixed`|



---

archive/issue_comments_590999.json:
```json
{
    "body": "Changing commit from \"14e44ec709d3daf6bb3b849febb419605a400d57\" to \"4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591\"",
    "created_at": "2020-07-05T17:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-590999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "14e44ec709d3daf6bb3b849febb419605a400d57" to "4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591"



---

archive/issue_comments_591000.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [dcoudert](#comment%3A12):\n> have also a look at the errors reported by the patchbot.\n\nDone",
    "created_at": "2020-07-05T17:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591000",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:14'></a>
Replying to [dcoudert](#comment%3A12):
> have also a look at the errors reported by the patchbot.

Done



---

archive/issue_comments_591001.json:
```json
{
    "body": "<a id='comment:15'></a>\nactually, one of these issue should be fixed in #29422, right ?",
    "created_at": "2020-07-05T17:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591001",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:15'></a>
actually, one of these issue should be fixed in #29422, right ?



---

archive/issue_comments_591002.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [dcoudert](#comment%3A15):\n> actually, one of these issue should be fixed in #29422, right ?\n\nYeah, i will do the same update there too.",
    "created_at": "2020-07-05T17:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591002",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:16'></a>
Replying to [dcoudert](#comment%3A15):
> actually, one of these issue should be fixed in #29422, right ?

Yeah, i will do the same update there too.



---

archive/issue_comments_591003.json:
```json
{
    "body": "<a id='comment:17'></a>\nWhile running doctests on the graph module, I get the following error.\n\n```\nsage -t src/sage/graphs/base/boost_graph.pyx\n**********************************************************************\nFile \"src/sage/graphs/base/boost_graph.pyx\", line 2121, in sage.graphs.base.boost_graph.?\nFailed example:\n    diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])\nExpected:\n    2.0\nGot:\n    Traceback (most recent call last):\n      File \"sage/graphs/base/boost_graph.pyx\", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)\n    cysignals.signals.SignalError: Segmentation fault\n    Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'\n    Traceback (most recent call last):\n      File \"sage/graphs/base/boost_graph.pyx\", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)\n    cysignals.signals.SignalError: Segmentation fault\n    0.0\n```\n\nAlso, you could add specific doctests for `2Dsweep` and `DiFUB`.",
    "created_at": "2020-07-08T07:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591003",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>
While running doctests on the graph module, I get the following error.

```
sage -t src/sage/graphs/base/boost_graph.pyx
**********************************************************************
File "src/sage/graphs/base/boost_graph.pyx", line 2121, in sage.graphs.base.boost_graph.?
Failed example:
    diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])
Expected:
    2.0
Got:
    Traceback (most recent call last):
      File "sage/graphs/base/boost_graph.pyx", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)
    cysignals.signals.SignalError: Segmentation fault
    Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'
    Traceback (most recent call last):
      File "sage/graphs/base/boost_graph.pyx", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)
    cysignals.signals.SignalError: Segmentation fault
    0.0
```

Also, you could add specific doctests for `2Dsweep` and `DiFUB`.



---

archive/issue_comments_591004.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [dcoudert](#comment%3A17):\n> While running doctests on the graph module, I get the following error.\n> \n> ```\n> sage -t src/sage/graphs/base/boost_graph.pyx\n> **********************************************************************\n> File \"src/sage/graphs/base/boost_graph.pyx\", line 2121, in sage.graphs.base.boost_graph.?\n> Failed example:\n>     diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])\n> Expected:\n>     2.0\n> Got:\n>     Traceback (most recent call last):\n>       File \"sage/graphs/base/boost_graph.pyx\", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)\n>     cysignals.signals.SignalError: Segmentation fault\n>     Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'\n>     Traceback (most recent call last):\n>       File \"sage/graphs/base/boost_graph.pyx\", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)\n>     cysignals.signals.SignalError: Segmentation fault\n>     0.0\n> ```\n> \n\nThat's weird, when ran doctest on my system it passed with no error. I have checked it again. Still no problem.\n\n```\nsage: from sage.graphs.base.boost_graph import diameter\nsage: G = DiGraph([(0,1,2), (1,0,-1)])\nsage: diameter(G, algorithm='DiFUB')\n1.0\nsage: diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])\n2.0\n```\n\n---\n\n```\nvipul@vipul-Predator-G3-572:~/sage$ ./sage -t src/sage/graphs/base/boost_graph.pyx\nRunning doctests with ID 2020-07-08-13-24-51-0d1b09f6.\nGit branch: weighted_difub\nUsing --optional=build,dochtml,memlimit,python_openid,sage,speaklater\nDoctesting 1 file.\nsage -t --warn-long 45.7 src/sage/graphs/base/boost_graph.pyx\n    [135 tests, 0.37 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.4 seconds\n    cpu time: 0.4 seconds\n    cumulative wall time: 0.4 seconds\n```\n\n\nP.S - I am currently on latest beta release.",
    "created_at": "2020-07-08T07:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591004",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:18'></a>
Replying to [dcoudert](#comment%3A17):
> While running doctests on the graph module, I get the following error.
> 
> ```
> sage -t src/sage/graphs/base/boost_graph.pyx
> **********************************************************************
> File "src/sage/graphs/base/boost_graph.pyx", line 2121, in sage.graphs.base.boost_graph.?
> Failed example:
>     diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])
> Expected:
>     2.0
> Got:
>     Traceback (most recent call last):
>       File "sage/graphs/base/boost_graph.pyx", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)
>     cysignals.signals.SignalError: Segmentation fault
>     Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'
>     Traceback (most recent call last):
>       File "sage/graphs/base/boost_graph.pyx", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)
>     cysignals.signals.SignalError: Segmentation fault
>     0.0
> ```
> 

That's weird, when ran doctest on my system it passed with no error. I have checked it again. Still no problem.

```
sage: from sage.graphs.base.boost_graph import diameter
sage: G = DiGraph([(0,1,2), (1,0,-1)])
sage: diameter(G, algorithm='DiFUB')
1.0
sage: diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])
2.0
```

---

```
vipul@vipul-Predator-G3-572:~/sage$ ./sage -t src/sage/graphs/base/boost_graph.pyx
Running doctests with ID 2020-07-08-13-24-51-0d1b09f6.
Git branch: weighted_difub
Using --optional=build,dochtml,memlimit,python_openid,sage,speaklater
Doctesting 1 file.
sage -t --warn-long 45.7 src/sage/graphs/base/boost_graph.pyx
    [135 tests, 0.37 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.4 seconds
    cpu time: 0.4 seconds
    cumulative wall time: 0.4 seconds
```


P.S - I am currently on latest beta release.



---

archive/issue_comments_591005.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [dcoudert](#comment%3A17):\n> While running doctests on the graph module, I get the following error.\n> \n> ```\n> sage -t src/sage/graphs/base/boost_graph.pyx\n> **********************************************************************\n> File \"src/sage/graphs/base/boost_graph.pyx\", line 2121, in sage.graphs.base.boost_graph.?\n> Failed example:\n>     diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])\n> Expected:\n>     2.0\n> Got:\n>     Traceback (most recent call last):\n>       File \"sage/graphs/base/boost_graph.pyx\", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)\n>     cysignals.signals.SignalError: Segmentation fault\n>     Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'\n> ```\n\n\nOne more thing, I would like to ask is why the execption is being ignored. Why it is not raising exception in that method itself.\n\n> Also, you could add specific doctests for `2Dsweep` and `DiFUB`.\n\n\nOk",
    "created_at": "2020-07-08T07:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591005",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:19'></a>
Replying to [dcoudert](#comment%3A17):
> While running doctests on the graph module, I get the following error.
> 
> ```
> sage -t src/sage/graphs/base/boost_graph.pyx
> **********************************************************************
> File "src/sage/graphs/base/boost_graph.pyx", line 2121, in sage.graphs.base.boost_graph.?
> Failed example:
>     diameter(G, algorithm='DiFUB', weight_function=lambda e:e[2])
> Expected:
>     2.0
> Got:
>     Traceback (most recent call last):
>       File "sage/graphs/base/boost_graph.pyx", line 1869, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20737)
>     cysignals.signals.SignalError: Segmentation fault
>     Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'
> ```


One more thing, I would like to ask is why the execption is being ignored. Why it is not raising exception in that method itself.

> Also, you could add specific doctests for `2Dsweep` and `DiFUB`.


Ok



---

archive/issue_comments_591006.json:
```json
{
    "body": "<a id='comment:20'></a>\nThis is due to default value of `antipode_2` in `2Dsweep`. Indeed, to find the antipode, you initialize `LB_2 = 0`. But with this graph, the eccentricity of vertex 1 is -1. So `antipode_2` stays at the default value (depends on the system).\n\nIf I change the weights, I can get the error with `antipode_1`\n\n```\nsage: G = DiGraph([(0,1,-1), (1,0,2)])\nsage: diameter(G, algorithm='2Dsweep', weight_function=lambda e:e[2])\n---------------------------------------------------------------------------\nSignalError                               Traceback (most recent call last)\n<ipython-input-6-283ef9f979bc> in <module>()\n----> 1 diameter(G, algorithm='2Dsweep', weight_function=lambda e:e[Integer(2)])\n\n/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter (build/cythonized/sage/graphs/base/boost_graph.cpp:23444)()\n   2077     return LB\n   2078 \n-> 2079 cpdef diameter(G, algorithm=None, source=None,\n   2080                weight_function=None, check_weight=True):\n   2081     r\"\"\"\n\n/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter (build/cythonized/sage/graphs/base/boost_graph.cpp:23145)()\n   2188 \n   2189     if algorithm == '2Dsweep':\n-> 2190         LB = diameter_lower_bound_2Dsweep(g_boost, rev_g_boost,\n   2191                                             isource, algo)[0]\n   2192 \n\n/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20568)()\n   1847     # maximum backward distance. LB_1 will be Backward eccentricity of source_1.\n   1848     if algorithm == 'Bellman-Ford':\n-> 1849         sig_on()\n   1850         result_1 = rev_g_boost.bellman_ford_shortest_paths(source_1)\n   1851         sig_off()\n\nSignalError: Segmentation fault\n```",
    "created_at": "2020-07-08T08:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591006",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:20'></a>
This is due to default value of `antipode_2` in `2Dsweep`. Indeed, to find the antipode, you initialize `LB_2 = 0`. But with this graph, the eccentricity of vertex 1 is -1. So `antipode_2` stays at the default value (depends on the system).

If I change the weights, I can get the error with `antipode_1`

```
sage: G = DiGraph([(0,1,-1), (1,0,2)])
sage: diameter(G, algorithm='2Dsweep', weight_function=lambda e:e[2])
---------------------------------------------------------------------------
SignalError                               Traceback (most recent call last)
<ipython-input-6-283ef9f979bc> in <module>()
----> 1 diameter(G, algorithm='2Dsweep', weight_function=lambda e:e[Integer(2)])

/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter (build/cythonized/sage/graphs/base/boost_graph.cpp:23444)()
   2077     return LB
   2078 
-> 2079 cpdef diameter(G, algorithm=None, source=None,
   2080                weight_function=None, check_weight=True):
   2081     r"""

/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter (build/cythonized/sage/graphs/base/boost_graph.cpp:23145)()
   2188 
   2189     if algorithm == '2Dsweep':
-> 2190         LB = diameter_lower_bound_2Dsweep(g_boost, rev_g_boost,
   2191                                             isource, algo)[0]
   2192 

/Users/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:20568)()
   1847     # maximum backward distance. LB_1 will be Backward eccentricity of source_1.
   1848     if algorithm == 'Bellman-Ford':
-> 1849         sig_on()
   1850         result_1 = rev_g_boost.bellman_ford_shortest_paths(source_1)
   1851         sig_off()

SignalError: Segmentation fault
```



---

archive/issue_comments_591007.json:
```json
{
    "body": "Changing commit from \"4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591\" to \"e9a452008ac35064258f7889851d72ac640eb083\"",
    "created_at": "2020-07-09T05:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4fe3d4ac2c6bcfe8891bea8b2accfa2237a2c591" to "e9a452008ac35064258f7889851d72ac640eb083"



---

archive/issue_comments_591008.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|\n|[7a8552f](https://github.com/sagemath/sagetrac-mirror/commit/7a8552fc4e775ba0fde59228aadc84b500371ff8)|`Merge branch 'public/graphs/30039_weighted_difub' of git://trac.sagemath.org/sage into weighted_difub`|\n|[e9a4520](https://github.com/sagemath/sagetrac-mirror/commit/e9a452008ac35064258f7889851d72ac640eb083)|`Fixed segmentation fault in 2dsweep`|",
    "created_at": "2020-07-09T05:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
|[7a8552f](https://github.com/sagemath/sagetrac-mirror/commit/7a8552fc4e775ba0fde59228aadc84b500371ff8)|`Merge branch 'public/graphs/30039_weighted_difub' of git://trac.sagemath.org/sage into weighted_difub`|
|[e9a4520](https://github.com/sagemath/sagetrac-mirror/commit/e9a452008ac35064258f7889851d72ac640eb083)|`Fixed segmentation fault in 2dsweep`|



---

archive/issue_comments_591009.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [git](#comment%3A21):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n\n\n> |                                                                                                                                           |                                     |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n> |[e9a4520](https://github.com/sagemath/sagetrac-mirror/commit/e9a452008ac35064258f7889851d72ac640eb083)|`Fixed segmentation fault in 2dsweep`|\n\n\nI have added equality while looking for antipode. So that atleast one vertex will be made antipode and i think it will solve it.\n\nPlease check that it works (because i am unable to confirm it).\n\nVipul",
    "created_at": "2020-07-09T05:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591009",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:22'></a>
Replying to [git](#comment%3A21):
> Branch pushed to git repo; I updated commit sha1. New commits:


> |                                                                                                                                           |                                     |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
> |[e9a4520](https://github.com/sagemath/sagetrac-mirror/commit/e9a452008ac35064258f7889851d72ac640eb083)|`Fixed segmentation fault in 2dsweep`|


I have added equality while looking for antipode. So that atleast one vertex will be made antipode and i think it will solve it.

Please check that it works (because i am unable to confirm it).

Vipul



---

archive/issue_comments_591010.json:
```json
{
    "body": "Changing commit from \"e9a452008ac35064258f7889851d72ac640eb083\" to \"f7e1ad5313c6e861f8bcdd06d62ce76e96492154\"",
    "created_at": "2020-07-09T13:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e9a452008ac35064258f7889851d72ac640eb083" to "f7e1ad5313c6e861f8bcdd06d62ce76e96492154"



---

archive/issue_comments_591011.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[09dc6be](https://github.com/sagemath/sagetrac-mirror/commit/09dc6beed39075d71aeabb936e7111505370062f)|`trac #30039: merged with 9.2.beta4`|\n|[f7e1ad5](https://github.com/sagemath/sagetrac-mirror/commit/f7e1ad5313c6e861f8bcdd06d62ce76e96492154)|`trac 30039: review commit`|",
    "created_at": "2020-07-09T13:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591011",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[09dc6be](https://github.com/sagemath/sagetrac-mirror/commit/09dc6beed39075d71aeabb936e7111505370062f)|`trac #30039: merged with 9.2.beta4`|
|[f7e1ad5](https://github.com/sagemath/sagetrac-mirror/commit/f7e1ad5313c6e861f8bcdd06d62ce76e96492154)|`trac 30039: review commit`|



---

archive/issue_comments_591012.json:
```json
{
    "body": "<a id='comment:24'></a>\ncheck that.",
    "created_at": "2020-07-09T13:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591012",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:24'></a>
check that.



---

archive/issue_comments_591013.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[d033760](https://github.com/sagemath/sagetrac-mirror/commit/d033760a973be8fd73d49377c4a00f75ea6f40e5)|`minor improvements`|",
    "created_at": "2020-07-10T05:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591013",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[d033760](https://github.com/sagemath/sagetrac-mirror/commit/d033760a973be8fd73d49377c4a00f75ea6f40e5)|`minor improvements`|



---

archive/issue_comments_591014.json:
```json
{
    "body": "Changing commit from \"f7e1ad5313c6e861f8bcdd06d62ce76e96492154\" to \"d033760a973be8fd73d49377c4a00f75ea6f40e5\"",
    "created_at": "2020-07-10T05:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591014",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f7e1ad5313c6e861f8bcdd06d62ce76e96492154" to "d033760a973be8fd73d49377c4a00f75ea6f40e5"



---

archive/issue_comments_591015.json:
```json
{
    "body": "<a id='comment:26'></a>\n\n```\nsage: G = DiGraph([(0,1,-2), (1,0,1)])\nsage: G.diameter(by_weight=True)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:22068)()\n   2012         sig_off()\n   2013     if not result_1.distances.size():\n-> 2014         raise ValueError(\"the graph contains a negative cycle\")\n   2015 \n   2016     LB_1 = -sys.float_info.max\n\nValueError: the graph contains a negative cycle\nException ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'\nTraceback (most recent call last):\n  File \"sage/graphs/base/boost_graph.pyx\", line 2014, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:22068)\nValueError: the graph contains a negative cycle\n0.0\n\n```\n\nIs there anyway we can properly get an error and not printing 0.0 ?",
    "created_at": "2020-07-10T05:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591015",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:26'></a>

```
sage: G = DiGraph([(0,1,-2), (1,0,1)])
sage: G.diameter(by_weight=True)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:22068)()
   2012         sig_off()
   2013     if not result_1.distances.size():
-> 2014         raise ValueError("the graph contains a negative cycle")
   2015 
   2016     LB_1 = -sys.float_info.max

ValueError: the graph contains a negative cycle
Exception ignored in: 'sage.graphs.base.boost_graph.diameter_DiFUB'
Traceback (most recent call last):
  File "sage/graphs/base/boost_graph.pyx", line 2014, in sage.graphs.base.boost_graph.diameter_lower_bound_2Dsweep (build/cythonized/sage/graphs/base/boost_graph.cpp:22068)
ValueError: the graph contains a negative cycle
0.0

```

Is there anyway we can properly get an error and not printing 0.0 ?



---

archive/issue_comments_591016.json:
```json
{
    "body": "<a id='comment:27'></a>\nI don't understand why the 0.0 is printed. It should not be the case. I don't understand either why it is written that an exception is ignored in `DiFUB`. Which one ? the issue occurs in `2Dsweep`. Have you localized when is 0.0 returned ?",
    "created_at": "2020-07-10T07:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591016",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:27'></a>
I don't understand why the 0.0 is printed. It should not be the case. I don't understand either why it is written that an exception is ignored in `DiFUB`. Which one ? the issue occurs in `2Dsweep`. Have you localized when is 0.0 returned ?



---

archive/issue_comments_591017.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [dcoudert](#comment%3A27):\n>Have you localized when is 0.0 returned ?\n\nIt will occur only via `DiFUB` and this will occur only when there is an error raised in `2DSweep`.\n\nI am also unable to understand it properly since it is receiving error, instead of terminating right then, it is ignoring it and sending garbage value stored in LB(on my system it is 0.0) without executing remaining part of code.\n\nI am guessing if you run this example on your system you might encounter different value than 0.0(as it has previously happened in case of antipode).",
    "created_at": "2020-07-10T16:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591017",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:28'></a>
Replying to [dcoudert](#comment%3A27):
>Have you localized when is 0.0 returned ?

It will occur only via `DiFUB` and this will occur only when there is an error raised in `2DSweep`.

I am also unable to understand it properly since it is receiving error, instead of terminating right then, it is ignoring it and sending garbage value stored in LB(on my system it is 0.0) without executing remaining part of code.

I am guessing if you run this example on your system you might encounter different value than 0.0(as it has previously happened in case of antipode).



---

archive/issue_comments_591018.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[9b6163b](https://github.com/sagemath/sagetrac-mirror/commit/9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1)|`trac #30039: fix error message and some compilation warnings`|",
    "created_at": "2020-07-11T13:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591018",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[9b6163b](https://github.com/sagemath/sagetrac-mirror/commit/9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1)|`trac #30039: fix error message and some compilation warnings`|



---

archive/issue_comments_591019.json:
```json
{
    "body": "Changing commit from \"d033760a973be8fd73d49377c4a00f75ea6f40e5\" to \"9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1\"",
    "created_at": "2020-07-11T13:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d033760a973be8fd73d49377c4a00f75ea6f40e5" to "9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1"



---

archive/issue_comments_591020.json:
```json
{
    "body": "<a id='comment:30'></a>\ngot it ! the error was not correctly transmitted to caller method. So the solution was:\n\n```diff\n-                           str algorithm):\n+                           str algorithm) except? -1:\n```\nSee https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values for more details. \n\nOn the way, I fixed some compilation warnings (got bored of them).",
    "created_at": "2020-07-11T13:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591020",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:30'></a>
got it ! the error was not correctly transmitted to caller method. So the solution was:

```diff
-                           str algorithm):
+                           str algorithm) except? -1:
```
See https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values for more details. 

On the way, I fixed some compilation warnings (got bored of them).



---

archive/issue_comments_591021.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Coudert\"",
    "created_at": "2020-07-11T13:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591021",
    "user": "https://github.com/dcoudert"
}
```

Changing reviewer from "" to "David Coudert"



---

archive/issue_comments_591022.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[002b8c2](https://github.com/sagemath/sagetrac-mirror/commit/002b8c2ea12b30b05231c35fe6a39997f422d5a3)|`doc test added`|",
    "created_at": "2020-07-12T10:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[002b8c2](https://github.com/sagemath/sagetrac-mirror/commit/002b8c2ea12b30b05231c35fe6a39997f422d5a3)|`doc test added`|



---

archive/issue_comments_591023.json:
```json
{
    "body": "Changing commit from \"9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1\" to \"002b8c2ea12b30b05231c35fe6a39997f422d5a3\"",
    "created_at": "2020-07-12T10:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591023",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9b6163b9d58dcd0bc917a34d858d4cfe38f4f9d1" to "002b8c2ea12b30b05231c35fe6a39997f422d5a3"



---

archive/issue_comments_591024.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [dcoudert](#comment%3A30):\n> got it ! the error was not correctly transmitted to caller method. So the solution was:\n> \n> ```diff\n> -                           str algorithm):\n> +                           str algorithm) except? -1:\n> ```\n> See https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values for more details. \n\nOk.\n> \n> On the way, I fixed some compilation warnings (got bored of them).\n\nWell, that's some relief to eyes. \n\nI have added a doctest for `DiFUB` and I think there is nothing more to do.",
    "created_at": "2020-07-12T10:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591024",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:33'></a>
Replying to [dcoudert](#comment%3A30):
> got it ! the error was not correctly transmitted to caller method. So the solution was:
> 
> ```diff
> -                           str algorithm):
> +                           str algorithm) except? -1:
> ```
> See https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values for more details. 

Ok.
> 
> On the way, I fixed some compilation warnings (got bored of them).

Well, that's some relief to eyes. 

I have added a doctest for `DiFUB` and I think there is nothing more to do.



---

archive/issue_comments_591025.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-12T12:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591025",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_591026.json:
```json
{
    "body": "<a id='comment:34'></a>\nLGTM. Successfully tested over 9.2.beta5.",
    "created_at": "2020-07-12T12:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591026",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:34'></a>
LGTM. Successfully tested over 9.2.beta5.



---

archive/issue_comments_591027.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-07-15T12:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591027",
    "user": "https://github.com/dcoudert"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_591028.json:
```json
{
    "body": "<a id='comment:35'></a>\na small edit is needed.",
    "created_at": "2020-07-15T12:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591028",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:35'></a>
a small edit is needed.



---

archive/issue_comments_591029.json:
```json
{
    "body": "<a id='comment:36'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[f6db6a5](https://github.com/sagemath/sagetrac-mirror/commit/f6db6a55c45606f41d2f5abf997bc66875673f10)|`trac #30039: use edges instead of edge_iterator`|",
    "created_at": "2020-07-15T12:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[f6db6a5](https://github.com/sagemath/sagetrac-mirror/commit/f6db6a55c45606f41d2f5abf997bc66875673f10)|`trac #30039: use edges instead of edge_iterator`|



---

archive/issue_comments_591030.json:
```json
{
    "body": "Changing commit from \"002b8c2ea12b30b05231c35fe6a39997f422d5a3\" to \"f6db6a55c45606f41d2f5abf997bc66875673f10\"",
    "created_at": "2020-07-15T12:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "002b8c2ea12b30b05231c35fe6a39997f422d5a3" to "f6db6a55c45606f41d2f5abf997bc66875673f10"



---

archive/issue_comments_591031.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-07-15T12:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591031",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_591032.json:
```json
{
    "body": "<a id='comment:37'></a>\nsmall modification to use `.edges` instead of `edge_iterator` (see #30145).",
    "created_at": "2020-07-15T12:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591032",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:37'></a>
small modification to use `.edges` instead of `edge_iterator` (see #30145).



---

archive/issue_comments_591033.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-07-15T22:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591033",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_591034.json:
```json
{
    "body": "<a id='comment:38'></a>\nMerge conflict",
    "created_at": "2020-07-15T22:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591034",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:38'></a>
Merge conflict



---

archive/issue_comments_591035.json:
```json
{
    "body": "<a id='comment:39'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[7bcd9db](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)|`merge conflict fixed`|",
    "created_at": "2020-07-27T16:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591035",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[7bcd9db](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)|`merge conflict fixed`|



---

archive/issue_comments_591036.json:
```json
{
    "body": "Changing commit from \"f6db6a55c45606f41d2f5abf997bc66875673f10\" to \"7bcd9db9dd80f8902a6bc938b34486a6801ac7c0\"",
    "created_at": "2020-07-27T16:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591036",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f6db6a55c45606f41d2f5abf997bc66875673f10" to "7bcd9db9dd80f8902a6bc938b34486a6801ac7c0"



---

archive/issue_comments_591037.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [git](#comment%3A39):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                      |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n> |[7bcd9db](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)|`merge conflict fixed`|\n\n\nSolved merge conflict in `boost_graph.pyx`.",
    "created_at": "2020-07-27T16:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591037",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:40'></a>
Replying to [git](#comment%3A39):
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                      |
> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
> |[7bcd9db](https://github.com/sagemath/sagetrac-mirror/commit/7bcd9db9dd80f8902a6bc938b34486a6801ac7c0)|`merge conflict fixed`|


Solved merge conflict in `boost_graph.pyx`.



---

archive/issue_comments_591038.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-27T16:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591038",
    "user": "https://github.com/vipul79321"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_591039.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-27T21:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591039",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_591040.json:
```json
{
    "body": "<a id='comment:41'></a>\nLGTM.",
    "created_at": "2020-07-27T21:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591040",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:41'></a>
LGTM.



---

archive/issue_events_087136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-02T08:20:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30039#event-87136"
}
```



---

archive/issue_comments_591041.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-02T08:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591041",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_591042.json:
```json
{
    "body": "Changing branch from \"public/graphs/30039_weighted_difub\" to \"7bcd9db9dd80f8902a6bc938b34486a6801ac7c0\"",
    "created_at": "2020-08-02T08:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30039#issuecomment-591042",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/graphs/30039_weighted_difub" to "7bcd9db9dd80f8902a6bc938b34486a6801ac7c0"
