# Issue 30139: Metaticket - SageManifolds Code Improvement Discussion

archive/issues_029902.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThe main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readability, debugging and compatibility.\n\nI for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.\n\nI am looking forward to the discussion! :)\n\n**Tasks:**\n\n- #29234: Remove code redundancies between `Section` and `TensorField`\n\nCC:  @egourgoulhon @tscrim @tobiasdiez @fchapoton @mkoeppe @nthiery\n\nComponent: **manifolds**\n\nKeywords: **sagemanifolds**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30139_\n\n",
    "created_at": "2020-07-14T11:02:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20manifolds",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Metaticket - SageManifolds Code Improvement Discussion",
    "type": "issue",
    "updated_at": "2022-08-31T16:33:45Z",
    "url": "https://github.com/sagemath/sage/issues/30139",
    "user": "https://github.com/mjungmath"
}
```
<div id="comment:0"></div>

The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readability, debugging and compatibility.

I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.

I am looking forward to the discussion! :)

**Tasks:**

- #29234: Remove code redundancies between `Section` and `TensorField`

CC:  @egourgoulhon @tscrim @tobiasdiez @fchapoton @mkoeppe @nthiery

Component: **manifolds**

Keywords: **sagemanifolds**

_Issue created by migration from https://trac.sagemath.org/ticket/30139_





---

archive/issue_events_411941.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-14T11:02:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411941"
}
```



---

archive/issue_events_411942.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-14T11:02:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411942"
}
```



---

archive/issue_events_411943.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-14T11:02:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411943"
}
```



---

archive/issue_comments_477174.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAllow me to start the discussion. In my opinion, the highest priority has the removal of code duplication. The new feature of vector bundles, for example, came with a cost: code duplication and redundancies. This is certainly unwanted (see ticket #29234). Take sections and tensor fields. They share a lot of common code snippets and methods. For example the method `restrict` which is more or less the same. Bugs for sections must now be fixed for tensor fields, and vice versa. But a simple inheritation comes with a problem: we have to drop most of the preexisting documentation. Imho, this would be sad, and I like to discuss how we deal with that.\n\nOf course, this issue is not only restricted to vector bundles. As I modified tensor fields, I had to make changes in three different files simultaneously which had a very similar setup with similar code snippets: `manifolds/differentiable/tensorfield.py`, `manifolds/differentiable/tensorfield_paral.py` and `tensor/modules/free_module_tensor.py`. I had to copy the very same lines over and over again. It was a tedious task not only to modify the code but also to understand how it was built up. A simplification would be desireable, even though I have no clue how. If I look through the code, I am sure, I will find further examples.\n\nAnother thing I am bothering with is the invocation of private variables via `._private_variable`. I think, these variables are private for a reason, and in my opinion, to keep the code as clean as possible, they should be invoced by methods and not directly. But I think, this has low priority because it has not such a tremendous impact. However, it would be nice, I guess.",
    "created_at": "2020-07-14T12:21:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477174",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:1" align="right">comment:1</div>

Allow me to start the discussion. In my opinion, the highest priority has the removal of code duplication. The new feature of vector bundles, for example, came with a cost: code duplication and redundancies. This is certainly unwanted (see ticket #29234). Take sections and tensor fields. They share a lot of common code snippets and methods. For example the method `restrict` which is more or less the same. Bugs for sections must now be fixed for tensor fields, and vice versa. But a simple inheritation comes with a problem: we have to drop most of the preexisting documentation. Imho, this would be sad, and I like to discuss how we deal with that.

Of course, this issue is not only restricted to vector bundles. As I modified tensor fields, I had to make changes in three different files simultaneously which had a very similar setup with similar code snippets: `manifolds/differentiable/tensorfield.py`, `manifolds/differentiable/tensorfield_paral.py` and `tensor/modules/free_module_tensor.py`. I had to copy the very same lines over and over again. It was a tedious task not only to modify the code but also to understand how it was built up. A simplification would be desireable, even though I have no clue how. If I look through the code, I am sure, I will find further examples.

Another thing I am bothering with is the invocation of private variables via `._private_variable`. I think, these variables are private for a reason, and in my opinion, to keep the code as clean as possible, they should be invoced by methods and not directly. But I think, this has low priority because it has not such a tremendous impact. However, it would be nice, I guess.



---

archive/issue_comments_477175.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code, which do not involve bugfixes or new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.\n+The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.\n \n I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.\n \n``````\n",
    "created_at": "2020-07-14T12:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477175",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code, which do not involve bugfixes or new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.
+The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.
 
 I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.
 
``````




---

archive/issue_events_411944.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-14T17:03:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411944"
}
```



---

archive/issue_events_411945.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-14T17:03:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20manifolds",
    "label_color": "0000ff",
    "label_name": "c: manifolds",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411945"
}
```



---

archive/issue_comments_477176.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nLet me preface my comments: I have only very recently started to look into sage-manifolds and my understanding of this code is very shallow.\n\nReplying to [@mjungmath](#comment%3A1):\n>  The new feature of vector bundles, for example, came with a cost: code duplication and redundancies. This is certainly unwanted (see ticket #29234). Take sections and tensor fields. They share a lot of common code snippets and methods. For example the method `restrict` which is more or less the same. Bugs for sections must now be fixed for tensor fields, and vice versa. But a simple inheritation comes with a problem: we have to drop most of the preexisting documentation. Imho, this would be sad, and I like to discuss how we deal with that.\n\nIf you are concerned about removing doctests (rather than documentation) as a byproduct of removing code duplications:  There is a solution by moving many tests from doctests to `_test...` methods. These are inherited by subclasses and therefore test coverage can be improved.\n\nI did this in the `sage.numerical.backends` modules in #20323 and follow-up tickets, and recently `gh-kliem` started to do the same in `sage.geometry.polyhedra` (see for example #29918).\n\nIn `sage.numerical.backends.logging_backend` I have some code that assists with transforming doctests to `_test...` methods, which could be generalized easily.",
    "created_at": "2020-07-14T17:18:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477176",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Let me preface my comments: I have only very recently started to look into sage-manifolds and my understanding of this code is very shallow.

Replying to [@mjungmath](#comment%3A1):
>  The new feature of vector bundles, for example, came with a cost: code duplication and redundancies. This is certainly unwanted (see ticket #29234). Take sections and tensor fields. They share a lot of common code snippets and methods. For example the method `restrict` which is more or less the same. Bugs for sections must now be fixed for tensor fields, and vice versa. But a simple inheritation comes with a problem: we have to drop most of the preexisting documentation. Imho, this would be sad, and I like to discuss how we deal with that.

If you are concerned about removing doctests (rather than documentation) as a byproduct of removing code duplications:  There is a solution by moving many tests from doctests to `_test...` methods. These are inherited by subclasses and therefore test coverage can be improved.

I did this in the `sage.numerical.backends` modules in #20323 and follow-up tickets, and recently `gh-kliem` started to do the same in `sage.geometry.polyhedra` (see for example #29918).

In `sage.numerical.backends.logging_backend` I have some code that assists with transforming doctests to `_test...` methods, which could be generalized easily.



---

archive/issue_comments_477177.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@mkoeppe](#comment%3A4):\n> If you are concerned about removing doctests (rather than documentation) as a byproduct of removing code duplications:  There is a solution by moving many tests from doctests to `_test...` methods. These are inherited by subclasses and therefore test coverage can be improved.\n\nThank you. This is good to know and definitely an important point. My concern, however, is also the documentation itself. Tensor fields and sections are declared slighly differently. For example, sections are constructed by using an instance of the vector bundle. Tensor fields, on the other hand, are declared by using an instance of the manifold. Therefore, it would be good to have separate closed minimal examples and hence distinct documentations.\n\nWhat about something like this:\n\n```python\n\nclass MyClass(ParentClass)\n    r\"\"\"\n    Blabla\n    \"\"\"\n\n    my_method(self, a, b, c='c'):\n        r\"\"\"\n        Overwritten docstring\n        \"\"\"\n        return ParentClass.my_method(self, a, b, c=c)\n```\n\nOr is that too nasty?",
    "created_at": "2020-07-14T17:52:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477177",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@mkoeppe](#comment%3A4):
> If you are concerned about removing doctests (rather than documentation) as a byproduct of removing code duplications:  There is a solution by moving many tests from doctests to `_test...` methods. These are inherited by subclasses and therefore test coverage can be improved.

Thank you. This is good to know and definitely an important point. My concern, however, is also the documentation itself. Tensor fields and sections are declared slighly differently. For example, sections are constructed by using an instance of the vector bundle. Tensor fields, on the other hand, are declared by using an instance of the manifold. Therefore, it would be good to have separate closed minimal examples and hence distinct documentations.

What about something like this:

```python

class MyClass(ParentClass)
    r"""
    Blabla
    """

    my_method(self, a, b, c='c'):
        r"""
        Overwritten docstring
        """
        return ParentClass.my_method(self, a, b, c=c)
```

Or is that too nasty?



---

archive/issue_comments_477178.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nNothing wrong with that, I would say. (Of course, one would use `super()` instead of referring to the parent class by name.)\nThe performance impact should be minimal.",
    "created_at": "2020-07-14T18:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477178",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Nothing wrong with that, I would say. (Of course, one would use `super()` instead of referring to the parent class by name.)
The performance impact should be minimal.



---

archive/issue_comments_477179.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nJust one caveat: it makes it more complicated to look at the code of the method by introspection.\n\nI don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.\n\nMatthias: glad to see _test methods being adopted at a large scale, with additional tooling :-)",
    "created_at": "2020-07-14T19:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477179",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:7" align="right">comment:7</div>

Just one caveat: it makes it more complicated to look at the code of the method by introspection.

I don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.

Matthias: glad to see _test methods being adopted at a large scale, with additional tooling :-)



---

archive/issue_comments_477180.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIn a different direction: The (multi)linear algebra in `sage.tensor` that was developed for sage-manifolds has a much better design than the linear algebra provided by `sage.matrix` (see, for example, #30091).\n\nIt would be nice to be able to use it for computational (exact and inexact) (multi)linear algebra. In #30061, Eric already did some improvements that makes better use of sparsity. \n\nIn addition to such speedups, it would be good to be able to use different backends for storing tensors instead of the current dictionary backend. \n\nOn the one hand, for special cases such as vectors and matrices by existing special implementations; for the special case of fully symmetric tensors, using fast implementations of multivariate polynomials. \n\nOn the other hand, for general numerical tensors using mainstream accelerated frameworks like PyTorch (see #30096).",
    "created_at": "2020-07-14T19:20:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477180",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

In a different direction: The (multi)linear algebra in `sage.tensor` that was developed for sage-manifolds has a much better design than the linear algebra provided by `sage.matrix` (see, for example, #30091).

It would be nice to be able to use it for computational (exact and inexact) (multi)linear algebra. In #30061, Eric already did some improvements that makes better use of sparsity. 

In addition to such speedups, it would be good to be able to use different backends for storing tensors instead of the current dictionary backend. 

On the one hand, for special cases such as vectors and matrices by existing special implementations; for the special case of fully symmetric tensors, using fast implementations of multivariate polynomials. 

On the other hand, for general numerical tensors using mainstream accelerated frameworks like PyTorch (see #30096).



---

archive/issue_comments_477181.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mkoeppe](#comment%3A6):\n> Nothing wrong with that, I would say. (Of course, one would use `super()` instead of referring to the parent class by name.)\n\nI would have thought that referring to the parent class by name is more robust against changes and increases readability. Is there a particular reason to prefer `super()`?\n\n> The performance impact should be minimal.\n\nThat's good.\n\nReplying to [@nthiery](#comment%3A7):\n> Just one caveat: it makes it more complicated to look at the code of the method by introspection.\n\nWhat exactly do you mean by that?\n\n> I don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.\n\nI'd guess this would contradict the well-documented philosophy of Sage, wouldn't it?",
    "created_at": "2020-07-14T20:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477181",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mkoeppe](#comment%3A6):
> Nothing wrong with that, I would say. (Of course, one would use `super()` instead of referring to the parent class by name.)

I would have thought that referring to the parent class by name is more robust against changes and increases readability. Is there a particular reason to prefer `super()`?

> The performance impact should be minimal.

That's good.

Replying to [@nthiery](#comment%3A7):
> Just one caveat: it makes it more complicated to look at the code of the method by introspection.

What exactly do you mean by that?

> I don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.

I'd guess this would contradict the well-documented philosophy of Sage, wouldn't it?



---

archive/issue_comments_477182.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mjungmath](#comment%3A9):\n> Replying to [@mkoeppe](#comment%3A6):\n> > (Of course, one would use `super()` instead of referring to the parent class by name.)\n> \n> \n> I would have thought that referring to the parent class by name is more robust against changes and increases readability. Is there a particular reason to prefer `super()`?\n\nFor classes with single inheritance, it is merely a matter of style. But as soon as multiple inheritance enters, using `super()` ensures that methods of all superclasses are called (and called in the right order)",
    "created_at": "2020-07-17T18:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477182",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mjungmath](#comment%3A9):
> Replying to [@mkoeppe](#comment%3A6):
> > (Of course, one would use `super()` instead of referring to the parent class by name.)
> 
> 
> I would have thought that referring to the parent class by name is more robust against changes and increases readability. Is there a particular reason to prefer `super()`?

For classes with single inheritance, it is merely a matter of style. But as soon as multiple inheritance enters, using `super()` ensures that methods of all superclasses are called (and called in the right order)



---

archive/issue_comments_477183.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.\n+The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readability, debugging and compatibility.\n \n I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.\n \n``````\n",
    "created_at": "2020-07-17T18:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477183",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readibility, debugging and compatibility.
+The main purpose of this ticket is a discussion and coordination platform regarding general code improvements of the preexisting SageManifolds code apart from bugfixes and new features. That is, for instance, the removal of existing code duplication, and strategies to improve readability, debugging and compatibility.
 
 I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.
 
``````




---

archive/issue_comments_477184.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAs someone who's new to sage, but would like to get involved in SageManifolds: how can I help?",
    "created_at": "2020-07-22T04:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477184",
    "user": "https://github.com/bollu"
}
```

<div id="comment:12" align="right">comment:12</div>

As someone who's new to sage, but would like to get involved in SageManifolds: how can I help?



---

archive/issue_comments_477185.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@bollu](#comment%3A12):\n> As someone who's new to sage, but would like to get involved in SageManifolds: how can I help? \n\nWelcome to the project!\nThere are various ways to contribute, see \nhttps://sagemanifolds.obspm.fr/contrib.html. \n\nIf you take a look at the metaticket #18528, you'll see that various tickets are in stalled state (mostly the blue ones), are therefore are open for development. For instance, #18786 about complex structures. You could pick one of those or create a brand new ticket about a topic that you like.",
    "created_at": "2020-07-22T14:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477185",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@bollu](#comment%3A12):
> As someone who's new to sage, but would like to get involved in SageManifolds: how can I help? 

Welcome to the project!
There are various ways to contribute, see 
https://sagemanifolds.obspm.fr/contrib.html. 

If you take a look at the metaticket #18528, you'll see that various tickets are in stalled state (mostly the blue ones), are therefore are open for development. For instance, #18786 about complex structures. You could pick one of those or create a brand new ticket about a topic that you like.



---

archive/issue_comments_477186.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,7 @@\n I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.\n \n I am looking forward to the discussion! :)\n+\n+**Tasks:**\n+\n+- #29234: Remove code redundancies between `Section` and `TensorField`\n``````\n",
    "created_at": "2020-07-24T11:52:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477186",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,7 @@
 I for myself do not have much experience in this field. However, I am eager to improve this nice piece of package as much as I can, so that anyone can benefit from it. In any case, this is not a one man task and I appreciate any support in this matter.
 
 I am looking forward to the discussion! :)
+
+**Tasks:**
+
+- #29234: Remove code redundancies between `Section` and `TensorField`
``````




---

archive/issue_comments_477187.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@mjungmath](#comment%3A5):\n> Replying to [@mkoeppe](#comment%3A4):\n> \n> What about something like this:\n> \n> ```python\n> \n> class MyClass(ParentClass)\n>     r\"\"\"\n>     Blabla\n>     \"\"\"\n> \n>     my_method(self, a, b, c='c'):\n>         r\"\"\"\n>         Overwritten docstring\n>         \"\"\"\n>         return ParentClass.my_method(self, a, b, c=c)\n> ```\n> \n> Or is that too nasty?\n\nThis is code duplication and should be avoided IMHO, cf. [comment:6](https://github.com/sagemath/sage/issues/29234#comment:6) in #29234 for the case of sections vs. tensor fields.",
    "created_at": "2020-07-24T12:21:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477187",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@mjungmath](#comment%3A5):
> Replying to [@mkoeppe](#comment%3A4):
> 
> What about something like this:
> 
> ```python
> 
> class MyClass(ParentClass)
>     r"""
>     Blabla
>     """
> 
>     my_method(self, a, b, c='c'):
>         r"""
>         Overwritten docstring
>         """
>         return ParentClass.my_method(self, a, b, c=c)
> ```
> 
> Or is that too nasty?

This is code duplication and should be avoided IMHO, cf. [comment:6](https://github.com/sagemath/sage/issues/29234#comment:6) in #29234 for the case of sections vs. tensor fields.



---

archive/issue_comments_477188.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@nthiery](#comment%3A7):\n> \n> I don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.\n\n+1",
    "created_at": "2020-07-24T12:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477188",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@nthiery](#comment%3A7):
> 
> I don't have a good solution though. The best approximation I can come it is to include both the examples/doc of vector bundles and tensor fields in the documentation of the method. It makes it a bit long for the reader. But points out the similarity, which is not bad per se.

+1



---

archive/issue_comments_477189.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nTobias had a very nice idea how to deal with some code duplication, in particular the restriction process: introduce sheafs (cf. [comment:7](https://github.com/sagemath/sage/issues/29234#comment:7) in #29234).\n\nI like that idea and I think this is something we definitely should aim for. However, this task is not as easy as one might think on the first glimpse. My first attempt would be utilizing the morphism framework of Sage. Unfortunately, my experience with morphisms in Sage is very limited. What do you think? Any further ideas?",
    "created_at": "2020-07-27T10:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477189",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:17" align="right">comment:17</div>

Tobias had a very nice idea how to deal with some code duplication, in particular the restriction process: introduce sheafs (cf. [comment:7](https://github.com/sagemath/sage/issues/29234#comment:7) in #29234).

I like that idea and I think this is something we definitely should aim for. However, this task is not as easy as one might think on the first glimpse. My first attempt would be utilizing the morphism framework of Sage. Unfortunately, my experience with morphisms in Sage is very limited. What do you think? Any further ideas?



---

archive/issue_comments_477190.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mjungmath](#comment%3A9):\n> Replying to [@nthiery](#comment%3A7):\n> > Just one caveat: it makes it more complicated to look at the code of the method by introspection.\n> \n> \n> What exactly do you mean by that?\n\nI guess Nicolas means that if the user would like to take a look at the source code via `t.my_method??`, he/she would get `return ParentClass.my_method(self, a, b, c=c)`, i.e.\nuseless information.",
    "created_at": "2020-07-27T13:39:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477190",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mjungmath](#comment%3A9):
> Replying to [@nthiery](#comment%3A7):
> > Just one caveat: it makes it more complicated to look at the code of the method by introspection.
> 
> 
> What exactly do you mean by that?

I guess Nicolas means that if the user would like to take a look at the source code via `t.my_method??`, he/she would get `return ParentClass.my_method(self, a, b, c=c)`, i.e.
useless information.



---

archive/issue_events_411946.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411946"
}
```



---

archive/issue_events_411947.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411947"
}
```



---

archive/issue_comments_477191.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI thought a bit about optimizations and the first thing that came to my mind: Cythonize code. Of course, one has to check with prun etc. whether it's worth it. However, Cythonizing `comp.py` and/or the algebraic part in the tensor module should be doable.\n\nOne thing that could definitely be Cythonized is the way of how names, i.e. strings, are concatenated, for example in `format_utilities.py`. I can imagine that this could improve speed a lot. Of course, this needs to be investigated with some performance checks before, too.\n\nEric, what do you think?",
    "created_at": "2021-01-17T19:34:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477191",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:20" align="right">comment:20</div>

I thought a bit about optimizations and the first thing that came to my mind: Cythonize code. Of course, one has to check with prun etc. whether it's worth it. However, Cythonizing `comp.py` and/or the algebraic part in the tensor module should be doable.

One thing that could definitely be Cythonized is the way of how names, i.e. strings, are concatenated, for example in `format_utilities.py`. I can imagine that this could improve speed a lot. Of course, this needs to be investigated with some performance checks before, too.

Eric, what do you think?



---

archive/issue_comments_477192.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@mjungmath](#comment%3A20):\n> I thought a bit about optimizations and the first thing that came to my mind: Cythonize code. Of course, one has to check with prun etc. whether it's worth it. However, Cythonizing `comp.py` and/or the algebraic part in the tensor module should be doable.\n> \n> One thing that could definitely be Cythonized is the way of how names, i.e. strings, are concatenated, for example in `format_utilities.py`. I can imagine that this could improve speed a lot. Of course, this needs to be investigated with some performance checks before, too.\n> \n> Eric, what do you think?\n\nCythonizing the algebraic part of tensor calculus will unfortunately not help much to improve the computational speed on manifolds. The reason is that the main bottleneck is symbolic calculus on the tensor field components and more specifically the simplification process, which is performed via Maxima (default backend, Lisp based) or by SymPy (optional backend, Python based). To really gain in performance, one shall rely on parallelization rather than cythonization. A real limitation in this respect is #27492, which forbids parallelization with symbolic functions (side note: certainly Sage's symbolic functions require some major rewritting, see #31047)",
    "created_at": "2021-01-18T09:15:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477192",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@mjungmath](#comment%3A20):
> I thought a bit about optimizations and the first thing that came to my mind: Cythonize code. Of course, one has to check with prun etc. whether it's worth it. However, Cythonizing `comp.py` and/or the algebraic part in the tensor module should be doable.
> 
> One thing that could definitely be Cythonized is the way of how names, i.e. strings, are concatenated, for example in `format_utilities.py`. I can imagine that this could improve speed a lot. Of course, this needs to be investigated with some performance checks before, too.
> 
> Eric, what do you think?

Cythonizing the algebraic part of tensor calculus will unfortunately not help much to improve the computational speed on manifolds. The reason is that the main bottleneck is symbolic calculus on the tensor field components and more specifically the simplification process, which is performed via Maxima (default backend, Lisp based) or by SymPy (optional backend, Python based). To really gain in performance, one shall rely on parallelization rather than cythonization. A real limitation in this respect is #27492, which forbids parallelization with symbolic functions (side note: certainly Sage's symbolic functions require some major rewritting, see #31047)



---

archive/issue_comments_477193.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nPerhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?",
    "created_at": "2021-01-18T09:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477193",
    "user": "https://github.com/bollu"
}
```

<div id="comment:22" align="right">comment:22</div>

Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?



---

archive/issue_comments_477194.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@bollu](#comment%3A22):\n> Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?\n\nThanks for pointing this! This is certainly worth to investigate. Especially SymEngine's README says: *Python wrappers allow easy usage from Python and integration with SymPy and Sage (the symengine.py repository)*.",
    "created_at": "2021-01-18T10:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477194",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@bollu](#comment%3A22):
> Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?

Thanks for pointing this! This is certainly worth to investigate. Especially SymEngine's README says: *Python wrappers allow easy usage from Python and integration with SymPy and Sage (the symengine.py repository)*.



---

archive/issue_comments_477195.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nIf one were to attempt to integrate/use SymEngine for the purpose of making the algebra faster, what should one do? I'd imagine\n1. Pull in SymEngine into SAGE\n2. Replace the calls to Maxima to call to SymEngine\n3. Benchmark?",
    "created_at": "2021-01-18T10:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477195",
    "user": "https://github.com/bollu"
}
```

<div id="comment:24" align="right">comment:24</div>

If one were to attempt to integrate/use SymEngine for the purpose of making the algebra faster, what should one do? I'd imagine
1. Pull in SymEngine into SAGE
2. Replace the calls to Maxima to call to SymEngine
3. Benchmark?



---

archive/issue_comments_477196.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@bollu](#comment%3A22):\n> Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?\n\nThat looks extremely promising. It's definitely worth investigating. And who knows, perhaps it could even replace the entire symbolic backend in Sage.\n\nPerhaps we should post this in the sage-devel group and initiate a discussion.",
    "created_at": "2021-01-18T12:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477196",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@bollu](#comment%3A22):
> Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?

That looks extremely promising. It's definitely worth investigating. And who knows, perhaps it could even replace the entire symbolic backend in Sage.

Perhaps we should post this in the sage-devel group and initiate a discussion.



---

archive/issue_comments_477197.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@mjungmath](#comment%3A25):\n> Replying to [@bollu](#comment%3A22):\n> > Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?\n> \n> \n> That looks extremely promising. It's definitely worth investigating. And who knows, perhaps it could even replace the entire symbolic backend in Sage.\n\nIndeed, this is all the more relevant, given that the main developer of Pynac (Sage's symbolic backend) has resigned:\nhttps://groups.google.com/g/sage-devel/c/JVLHRy2mxUI\n> \n> Perhaps we should post this in the sage-devel group and initiate a discussion.\n\nYes this is certainly the right place to initiate the discussion.",
    "created_at": "2021-01-18T13:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477197",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@mjungmath](#comment%3A25):
> Replying to [@bollu](#comment%3A22):
> > Perhaps I am missing something. SymPy has a new C++ backend called SymEngine [https://github.com/symengine/symengine](https://github.com/symengine/symengine). Would that improve performance by some degree?
> 
> 
> That looks extremely promising. It's definitely worth investigating. And who knows, perhaps it could even replace the entire symbolic backend in Sage.

Indeed, this is all the more relevant, given that the main developer of Pynac (Sage's symbolic backend) has resigned:
https://groups.google.com/g/sage-devel/c/JVLHRy2mxUI
> 
> Perhaps we should post this in the sage-devel group and initiate a discussion.

Yes this is certainly the right place to initiate the discussion.



---

archive/issue_comments_477198.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI've created a thread on sage-devel about moving to  SymEngine [https://groups.google.com/g/sage-devel/c/sY3zh-pq8T4](https://groups.google.com/g/sage-devel/c/sY3zh-pq8T4)",
    "created_at": "2021-01-18T13:41:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477198",
    "user": "https://github.com/bollu"
}
```

<div id="comment:27" align="right">comment:27</div>

I've created a thread on sage-devel about moving to  SymEngine [https://groups.google.com/g/sage-devel/c/sY3zh-pq8T4](https://groups.google.com/g/sage-devel/c/sY3zh-pq8T4)



---

archive/issue_events_411948.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-27T02:13:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411948"
}
```



---

archive/issue_events_411949.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-27T02:13:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411949"
}
```



---

archive/issue_comments_477199.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-27T02:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477199",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_477200.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nIndeed, it would be nice to (co)homology of manifolds. There are two approaches I see right now:\n\n- Morse homology\n- \u010cech cohomology\n**\n\u010cech cohomology** sounds promising since it can (more or less) directly be obtained from charts and their transition maps (see e.g. https://webspace.science.uu.nl/~caval101/homepage/Differential_geometry_2014_files/notes%20on%20Cech%20cohomology.pdf).\n\nAs for **Morse homology** I'd like to refer to https://www.sciencedirect.com/science/article/pii/S0723086905000642. With the orientation implementation we already have, this could be doable, even though there are some immediate problems that I can think of:\n\n- How do we check whether a function is Morse?\n- How can we obtain all critial points? How do we determine their indices?\n\nIs there perhaps a nice class of Morse functions we can easily deal with?\n\nOpinions, comments, hints, references and ideas are welcome! :)",
    "created_at": "2021-04-07T08:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477200",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:29" align="right">comment:29</div>

Indeed, it would be nice to (co)homology of manifolds. There are two approaches I see right now:

- Morse homology
- Čech cohomology
**
Čech cohomology** sounds promising since it can (more or less) directly be obtained from charts and their transition maps (see e.g. https://webspace.science.uu.nl/~caval101/homepage/Differential_geometry_2014_files/notes%20on%20Cech%20cohomology.pdf).

As for **Morse homology** I'd like to refer to https://www.sciencedirect.com/science/article/pii/S0723086905000642. With the orientation implementation we already have, this could be doable, even though there are some immediate problems that I can think of:

- How do we check whether a function is Morse?
- How can we obtain all critial points? How do we determine their indices?

Is there perhaps a nice class of Morse functions we can easily deal with?

Opinions, comments, hints, references and ideas are welcome! :)



---

archive/issue_comments_477201.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI would probably start with \u010cech cohomology since it is more straightforward.\n\nFor finding the critical points in Morse homology, I think you can compute them on each chart individually since they are suppose to be isolated IIRC and then remove redundancies. From there, you can check the degeneracy condition.",
    "created_at": "2021-04-07T21:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477201",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:30" align="right">comment:30</div>

I would probably start with Čech cohomology since it is more straightforward.

For finding the critical points in Morse homology, I think you can compute them on each chart individually since they are suppose to be isolated IIRC and then remove redundancies. From there, you can check the degeneracy condition.



---

archive/issue_comments_477202.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@tscrim](#comment%3A30):\n> I would probably start with \u010cech cohomology since it is more straightforward.\n\nFor that, we need \"good covers\" consisting of contractible sets, and all its intersections being contractible. Thus we need a way to check contractibility for open subsets. Is that worth a post in sage-devel?",
    "created_at": "2021-04-27T12:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477202",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@tscrim](#comment%3A30):
> I would probably start with Čech cohomology since it is more straightforward.

For that, we need "good covers" consisting of contractible sets, and all its intersections being contractible. Thus we need a way to check contractibility for open subsets. Is that worth a post in sage-devel?



---

archive/issue_comments_477203.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThe manifolds code is growing steadily and more files are added. Do you think it is time that we consider refactoring the folder structure of the manifolds module?",
    "created_at": "2021-04-27T12:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477203",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:32" align="right">comment:32</div>

The manifolds code is growing steadily and more files are added. Do you think it is time that we consider refactoring the folder structure of the manifolds module?



---

archive/issue_comments_477204.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@mjungmath](#comment%3A32):\n> The manifolds code is growing steadily and more files are added. Do you think it is time that we consider refactoring the folder structure of the manifolds module?\n\nSome of the things added as part of #31740 (Meta-ticket: Families, posets, complexes of manifold subsets) could certainly be moved into a subpackage `sage.manifolds.subsets`:\n- from #31653: `sage.manifolds.continuous_map_image` -> `sage.manifolds.subsets.continuous_map_image`\n- likewise #31644, #31688",
    "created_at": "2021-04-27T17:20:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477204",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@mjungmath](#comment%3A32):
> The manifolds code is growing steadily and more files are added. Do you think it is time that we consider refactoring the folder structure of the manifolds module?

Some of the things added as part of #31740 (Meta-ticket: Families, posets, complexes of manifold subsets) could certainly be moved into a subpackage `sage.manifolds.subsets`:
- from #31653: `sage.manifolds.continuous_map_image` -> `sage.manifolds.subsets.continuous_map_image`
- likewise #31644, #31688



---

archive/issue_comments_477205.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nOpened #32274 for the structuring issue.",
    "created_at": "2021-07-25T08:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30139#issuecomment-477205",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:34" align="right">comment:34</div>

Opened #32274 for the structuring issue.



---

archive/issue_events_411950.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411950"
}
```



---

archive/issue_events_411951.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411951"
}
```



---

archive/issue_events_411952.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411952"
}
```



---

archive/issue_events_411953.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411953"
}
```



---

archive/issue_events_411954.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411954"
}
```



---

archive/issue_events_411955.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411955"
}
```



---

archive/issue_events_411956.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411956"
}
```



---

archive/issue_events_411957.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30139",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30139#event-411957"
}
```
