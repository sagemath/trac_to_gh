# Issue 30274: Immutability of Tensor Fields

archive/issues_030037.json:
```json
{
    "body": "See #30261.\n\nThe immutability behavior for tensor fields appears a little bit tricky.\n\nFollow up: #31255\n\nCC:  @egourgoulhon @tscrim @mkoeppe\n\nKeywords: immutability\n\nReviewer: Matthias Koeppe\n\nAuthor: Michael Jung\n\nBranch: 1b599b2871b327dfe64acb355d0fbae135f0ca97\n\nDependencies: #30181\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30274\n\n",
    "closed_at": "2020-08-09T08:47:19Z",
    "created_at": "2020-08-02T18:58:43Z",
    "labels": [
        "component: manifolds"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Immutability of Tensor Fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30274",
    "user": "https://github.com/mjungmath"
}
```
See #30261.

The immutability behavior for tensor fields appears a little bit tricky.

Follow up: #31255

CC:  @egourgoulhon @tscrim @mkoeppe

Keywords: immutability

Reviewer: Matthias Koeppe

Author: Michael Jung

Branch: 1b599b2871b327dfe64acb355d0fbae135f0ca97

Dependencies: #30181

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30274





---

archive/issue_comments_595782.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-08-03T10:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595782",
    "user": "https://github.com/mjungmath"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_595783.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to manifolds.",
    "created_at": "2020-08-03T10:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595783",
    "user": "https://github.com/mjungmath"
}
```

Changing component from PLEASE CHANGE to manifolds.



---

archive/issue_comments_595784.json:
```json
{
    "body": "Changing keywords from \"\" to \"immutability\".",
    "created_at": "2020-08-03T10:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595784",
    "user": "https://github.com/mjungmath"
}
```

Changing keywords from "" to "immutability".



---

archive/issue_comments_595785.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n+See #30261.\n \n+The immutability behavior for tensor fields appears a little bit tricky. I will upload a proposal soon.\n``````\n",
    "created_at": "2020-08-03T10:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595785",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
+See #30261.
 
+The immutability behavior for tensor fields appears a little bit tricky. I will upload a proposal soon.
``````




---

archive/issue_comments_595786.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-mjungmath/immutability_of_tensor_fields\"",
    "created_at": "2020-08-03T10:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595786",
    "user": "https://github.com/mjungmath"
}
```

Changing branch from "" to "u/gh-mjungmath/immutability_of_tensor_fields"



---

archive/issue_comments_595787.json:
```json
{
    "body": "<a id='comment:3'></a>\nNew commits:\n|                                                                                                                                          |                                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[286d3c6](https://git.sagemath.org/sage.git/commit?id=286d3c604d0fe9aa2f78b5c09773c4af3bb3369b)|`FreeModuleTensor, Vector: Subclass a new class ModuleElementWithMutability`|\n|[9df3d22](https://git.sagemath.org/sage.git/commit?id=9df3d22ca84da6b604226d5b88d2a581b0cc53ca)|`sage.tensor.modules: Make all zero() and one() elements immutable`|\n|[4373ea2](https://git.sagemath.org/sage.git/commit?id=4373ea269d9d426163fa3d1e72bdf6e20c412f87)|`FreeModuleTensor: Replace special casing of the immutable zero by is_immutable`|\n|[a2ee8be](https://git.sagemath.org/sage.git/commit?id=a2ee8beb504477a3215e002391e44a51b2957ca2)|`ModuleElementWithMutability.is_immutable, is_mutable: Change def to cpdef`|\n|[fa6bd69](https://git.sagemath.org/sage.git/commit?id=fa6bd695c3653f55afffdc4530fa8dd03cc1ddd5)|`Trac #30274: Merge branch 't/30181/immutable_elements_of_freemoduletensor' into t/30274/immutability_of_tensor_fields`|\n|[0ba933a](https://git.sagemath.org/sage.git/commit?id=0ba933a0b0aa4734e979f0e22b6d458790ff0d49)|`Trac #30274: first trial of immutability`|",
    "created_at": "2020-08-03T10:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595787",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:3'></a>
New commits:
|                                                                                                                                          |                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[286d3c6](https://git.sagemath.org/sage.git/commit?id=286d3c604d0fe9aa2f78b5c09773c4af3bb3369b)|`FreeModuleTensor, Vector: Subclass a new class ModuleElementWithMutability`|
|[9df3d22](https://git.sagemath.org/sage.git/commit?id=9df3d22ca84da6b604226d5b88d2a581b0cc53ca)|`sage.tensor.modules: Make all zero() and one() elements immutable`|
|[4373ea2](https://git.sagemath.org/sage.git/commit?id=4373ea269d9d426163fa3d1e72bdf6e20c412f87)|`FreeModuleTensor: Replace special casing of the immutable zero by is_immutable`|
|[a2ee8be](https://git.sagemath.org/sage.git/commit?id=a2ee8beb504477a3215e002391e44a51b2957ca2)|`ModuleElementWithMutability.is_immutable, is_mutable: Change def to cpdef`|
|[fa6bd69](https://git.sagemath.org/sage.git/commit?id=fa6bd695c3653f55afffdc4530fa8dd03cc1ddd5)|`Trac #30274: Merge branch 't/30181/immutable_elements_of_freemoduletensor' into t/30274/immutability_of_tensor_fields`|
|[0ba933a](https://git.sagemath.org/sage.git/commit?id=0ba933a0b0aa4734e979f0e22b6d458790ff0d49)|`Trac #30274: first trial of immutability`|



---

archive/issue_comments_595788.json:
```json
{
    "body": "Changing commit from \"\" to \"0ba933a0b0aa4734e979f0e22b6d458790ff0d49\"",
    "created_at": "2020-08-03T10:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595788",
    "user": "https://github.com/mjungmath"
}
```

Changing commit from "" to "0ba933a0b0aa4734e979f0e22b6d458790ff0d49"



---

archive/issue_comments_595789.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-03T10:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595789",
    "user": "https://github.com/mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_595790.json:
```json
{
    "body": "Changing author from \"\" to \"Michael Jung\"",
    "created_at": "2020-08-03T10:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595790",
    "user": "https://github.com/mjungmath"
}
```

Changing author from "" to "Michael Jung"



---

archive/issue_comments_595791.json:
```json
{
    "body": "<a id='comment:5'></a>\nLet's wait for the patchbot.\n\nI had to make some modifications for automorphism fields. My doctests all passed.",
    "created_at": "2020-08-03T10:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595791",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:5'></a>
Let's wait for the patchbot.

I had to make some modifications for automorphism fields. My doctests all passed.



---

archive/issue_comments_595792.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30181\"",
    "created_at": "2020-08-03T10:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595792",
    "user": "https://github.com/mjungmath"
}
```

Changing dependencies from "" to "#30181"



---

archive/issue_comments_595793.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n See #30261.\n \n-The immutability behavior for tensor fields appears a little bit tricky. I will upload a proposal soon.\n+The immutability behavior for tensor fields appears a little bit tricky.\n``````\n",
    "created_at": "2020-08-03T11:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595793",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 See #30261.
 
-The immutability behavior for tensor fields appears a little bit tricky. I will upload a proposal soon.
+The immutability behavior for tensor fields appears a little bit tricky.
``````




---

archive/issue_comments_595794.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[1b599b2](https://git.sagemath.org/sage.git/commit/?id=1b599b2871b327dfe64acb355d0fbae135f0ca97)|`Trac #30274: patchbot complaints fixed`|",
    "created_at": "2020-08-04T07:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[1b599b2](https://git.sagemath.org/sage.git/commit/?id=1b599b2871b327dfe64acb355d0fbae135f0ca97)|`Trac #30274: patchbot complaints fixed`|



---

archive/issue_comments_595795.json:
```json
{
    "body": "Changing commit from \"0ba933a0b0aa4734e979f0e22b6d458790ff0d49\" to \"1b599b2871b327dfe64acb355d0fbae135f0ca97\"",
    "created_at": "2020-08-04T07:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0ba933a0b0aa4734e979f0e22b6d458790ff0d49" to "1b599b2871b327dfe64acb355d0fbae135f0ca97"



---

archive/issue_comments_595796.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-04T14:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595796",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_595797.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-08-04T14:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595797",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_595798.json:
```json
{
    "body": "<a id='comment:9'></a>\nLGTM.",
    "created_at": "2020-08-04T14:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595798",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
LGTM.



---

archive/issue_comments_595799.json:
```json
{
    "body": "<a id='comment:10'></a>\nA quick remark: You define a `copy` method here (and looking through `sage.manifolds` I see several `copy` methods). You may want to consider (on a separate ticket) to provide `__copy__` methods as well.",
    "created_at": "2020-08-04T14:56:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595799",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
A quick remark: You define a `copy` method here (and looking through `sage.manifolds` I see several `copy` methods). You may want to consider (on a separate ticket) to provide `__copy__` methods as well.



---

archive/issue_comments_595800.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you for the review.\n\nReplying to [mkoeppe](#comment%3A10):\n> A quick remark: You define a `copy` method here (and looking through `sage.manifolds` I see several `copy` methods). You may want to consider (on a separate ticket) to provide `__copy__` methods as well.\n\n\nWhat is the difference, or what is the advantage?",
    "created_at": "2020-08-04T15:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595800",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:11'></a>
Thank you for the review.

Replying to [mkoeppe](#comment%3A10):
> A quick remark: You define a `copy` method here (and looking through `sage.manifolds` I see several `copy` methods). You may want to consider (on a separate ticket) to provide `__copy__` methods as well.


What is the difference, or what is the advantage?



---

archive/issue_comments_595801.json:
```json
{
    "body": "<a id='comment:12'></a>\nsee https://docs.python.org/3/library/copy.html",
    "created_at": "2020-08-04T15:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595801",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
see https://docs.python.org/3/library/copy.html



---

archive/issue_comments_595802.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-09T08:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595802",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_078320.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-09T08:47:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30274#event-78320"
}
```



---

archive/issue_comments_595803.json:
```json
{
    "body": "Changing branch from \"u/gh-mjungmath/immutability_of_tensor_fields\" to \"1b599b2871b327dfe64acb355d0fbae135f0ca97\"",
    "created_at": "2020-08-09T08:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595803",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gh-mjungmath/immutability_of_tensor_fields" to "1b599b2871b327dfe64acb355d0fbae135f0ca97"



---

archive/issue_comments_595804.json:
```json
{
    "body": "Changing commit from \"1b599b2871b327dfe64acb355d0fbae135f0ca97\" to \"\"",
    "created_at": "2021-01-17T12:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595804",
    "user": "https://github.com/mjungmath"
}
```

Changing commit from "1b599b2871b327dfe64acb355d0fbae135f0ca97" to ""



---

archive/issue_comments_595805.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n See #30261.\n \n The immutability behavior for tensor fields appears a little bit tricky.\n+\n+Follow up: #31255\n``````\n",
    "created_at": "2021-01-17T12:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30274#issuecomment-595805",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 See #30261.
 
 The immutability behavior for tensor fields appears a little bit tricky.
+
+Follow up: #31255
``````

