# Issue 30234: Refactor SR through a wrapper class for symbolic equations, inequalities

archive/issues_029997.json:
```json
{
    "body": "We create a \"subring\" of the Symbolic \"Ring\" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.\n\nCompare:\n\n```\nsage: s = SR('x') == 1                                                                                                                                                           \nsage: s                                                                                                                                                                          \nx == 1\nsage: s in SR                                                                                                                                                                    \nTrue\n```\nwith:\n\n```\nsage: SymbolicValuesRing(SR('x'))\nx\nsage: SymbolicValuesRing(SR('x') >= 1)\nerror - cannot convert\nsage: SymbolicValuesRing('x') >= 1\nerror - cannot decide\nsage: assume(x >= 2)\nsage: SymbolicValuesRing('x') >= 1\nTrue\n```\n\nThis could then be used for example with `Polyhedron(..., backend='field')`.\n\n\nApproach 1 to implement this is to wrap elements of `SR` in some wrapper class. \n\n\n\nApproach 2 is to implement it through refactoring:\n\n- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. \n\n- The magic behavior of comparison operators for `SR` elements, creating relations, will be implemented in a wrapper class. \nIdeally, this will be unified with the separate implementation of this functionality in `sage.numerical.linear_functions`.\n\n\nHere we do Approach 1.\n\n\nCC:  @mjungmath @egourgoulhon @davewittemorris @yuan-zhou\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/30234\n\n",
    "created_at": "2020-07-27T19:52:55Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Refactor SR through a wrapper class for symbolic equations, inequalities",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30234",
    "user": "https://github.com/mkoeppe"
}
```
We create a "subring" of the Symbolic "Ring" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.

Compare:

```
sage: s = SR('x') == 1                                                                                                                                                           
sage: s                                                                                                                                                                          
x == 1
sage: s in SR                                                                                                                                                                    
True
```
with:

```
sage: SymbolicValuesRing(SR('x'))
x
sage: SymbolicValuesRing(SR('x') >= 1)
error - cannot convert
sage: SymbolicValuesRing('x') >= 1
error - cannot decide
sage: assume(x >= 2)
sage: SymbolicValuesRing('x') >= 1
True
```

This could then be used for example with `Polyhedron(..., backend='field')`.


Approach 1 to implement this is to wrap elements of `SR` in some wrapper class. 



Approach 2 is to implement it through refactoring:

- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. 

- The magic behavior of comparison operators for `SR` elements, creating relations, will be implemented in a wrapper class. 
Ideally, this will be unified with the separate implementation of this functionality in `sage.numerical.linear_functions`.


Here we do Approach 1.


CC:  @mjungmath @egourgoulhon @davewittemorris @yuan-zhou

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/30234





---

archive/issue_comments_454470.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n-... which implements the behavior of comparison operators similar to what is (separately) implemented in \\`SR\\` and in \\`sage.numerical.linear_functions\\`.\n+We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. \n+\n+The magic behavior of comparison operators for \\`SR\\` elements, creating relations, will be implemented in a wrapper class. \n+Ideally, this will be unified with the separate implementation of this functionality in \\`sage.numerical.linear_functions\\`.\n+\n+\n \n Summary: Wrapper class for symbolic equations, inequalities\n \n```\n",
    "created_at": "2020-11-02T22:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30234#issuecomment-454470",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,9 @@
-... which implements the behavior of comparison operators similar to what is (separately) implemented in \`SR\` and in \`sage.numerical.linear_functions\`.
+We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. 
+
+The magic behavior of comparison operators for \`SR\` elements, creating relations, will be implemented in a wrapper class. 
+Ideally, this will be unified with the separate implementation of this functionality in \`sage.numerical.linear_functions\`.
+
+
 
 Summary: Wrapper class for symbolic equations, inequalities
 
```




---

archive/issue_comments_454471.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,39 @@\n+We create a \"subring\" of the Symbolic \"Ring\" that only includes value objects and has eager evaluation of relational operators.\n+\n+Compare:\n+\n+\\`\\`\\`\n+sage: s = SR('x') == 1                                                                                                                                                           \n+sage: s                                                                                                                                                                          \n+x == 1\n+sage: s in SR                                                                                                                                                                    \n+True\n+\\`\\`\\`\n+with:\n+\n+\\`\\`\\`\n+sage: SymbolicValuesRing(SR('x'))\n+x\n+sage: SymbolicValuesRing(SR('x') >= 1)\n+error - cannot convert\n+sage: SymbolicValuesRing('x') >= 1\n+error - cannot decide\n+sage: assume(x >= 2)\n+sage: SymbolicValuesRing('x') >= 1\n+True\n+\\`\\`\\`\n+\n+Approach 1 to implement this is to wrap elements of \\`SR\\` in some wrapper class.\n+\n+\n+\n+Approach 2 is to implement it through refactoring:\n+\n+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. \n+\n+- The magic behavior of comparison operators for \\`SR\\` elements, creating relations, will be implemented in a wrapper class. \n+Ideally, this will be unified with the separate implementation of this functionality in \\`sage.numerical.linear_functions\\`.\n+\n \n \n Summary: Wrapper class for symbolic equations, inequalities\n```\n",
    "created_at": "2021-02-09T21:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30234#issuecomment-454471",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,39 @@
+We create a "subring" of the Symbolic "Ring" that only includes value objects and has eager evaluation of relational operators.
+
+Compare:
+
+\`\`\`
+sage: s = SR('x') == 1                                                                                                                                                           
+sage: s                                                                                                                                                                          
+x == 1
+sage: s in SR                                                                                                                                                                    
+True
+\`\`\`
+with:
+
+\`\`\`
+sage: SymbolicValuesRing(SR('x'))
+x
+sage: SymbolicValuesRing(SR('x') >= 1)
+error - cannot convert
+sage: SymbolicValuesRing('x') >= 1
+error - cannot decide
+sage: assume(x >= 2)
+sage: SymbolicValuesRing('x') >= 1
+True
+\`\`\`
+
+Approach 1 to implement this is to wrap elements of \`SR\` in some wrapper class.
+
+
+
+Approach 2 is to implement it through refactoring:
+
+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. 
+
+- The magic behavior of comparison operators for \`SR\` elements, creating relations, will be implemented in a wrapper class. 
+Ideally, this will be unified with the separate implementation of this functionality in \`sage.numerical.linear_functions\`.
+
 
 
 Summary: Wrapper class for symbolic equations, inequalities
```




---

archive/issue_comments_454472.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,39 @@\n+We create a \"subring\" of the Symbolic \"Ring\" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.\n+\n+Compare:\n+\n+\\`\\`\\`\n+sage: s = SR('x') == 1                                                                                                                                                           \n+sage: s                                                                                                                                                                          \n+x == 1\n+sage: s in SR                                                                                                                                                                    \n+True\n+\\`\\`\\`\n+with:\n+\n+\\`\\`\\`\n+sage: SymbolicValuesRing(SR('x'))\n+x\n+sage: SymbolicValuesRing(SR('x') >= 1)\n+error - cannot convert\n+sage: SymbolicValuesRing('x') >= 1\n+error - cannot decide\n+sage: assume(x >= 2)\n+sage: SymbolicValuesRing('x') >= 1\n+True\n+\\`\\`\\`\n+\n+Approach 1 to implement this is to wrap elements of \\`SR\\` in some wrapper class.\n+\n+\n+\n+Approach 2 is to implement it through refactoring:\n+\n+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. \n+\n+- The magic behavior of comparison operators for \\`SR\\` elements, creating relations, will be implemented in a wrapper class. \n+Ideally, this will be unified with the separate implementation of this functionality in \\`sage.numerical.linear_functions\\`.\n+\n \n \n Summary: Wrapper class for symbolic equations, inequalities\n```\n",
    "created_at": "2022-09-02T02:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30234#issuecomment-454472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,39 @@
+We create a "subring" of the Symbolic "Ring" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.
+
+Compare:
+
+\`\`\`
+sage: s = SR('x') == 1                                                                                                                                                           
+sage: s                                                                                                                                                                          
+x == 1
+sage: s in SR                                                                                                                                                                    
+True
+\`\`\`
+with:
+
+\`\`\`
+sage: SymbolicValuesRing(SR('x'))
+x
+sage: SymbolicValuesRing(SR('x') >= 1)
+error - cannot convert
+sage: SymbolicValuesRing('x') >= 1
+error - cannot decide
+sage: assume(x >= 2)
+sage: SymbolicValuesRing('x') >= 1
+True
+\`\`\`
+
+Approach 1 to implement this is to wrap elements of \`SR\` in some wrapper class.
+
+
+
+Approach 2 is to implement it through refactoring:
+
+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. 
+
+- The magic behavior of comparison operators for \`SR\` elements, creating relations, will be implemented in a wrapper class. 
+Ideally, this will be unified with the separate implementation of this functionality in \`sage.numerical.linear_functions\`.
+
 
 
 Summary: Wrapper class for symbolic equations, inequalities
```




---

archive/issue_comments_454473.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,44 @@\n+We create a \"subring\" of the Symbolic \"Ring\" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.\n+\n+Compare:\n+\n+\\`\\`\\`\n+sage: s = SR('x') == 1                                                                                                                                                           \n+sage: s                                                                                                                                                                          \n+x == 1\n+sage: s in SR                                                                                                                                                                    \n+True\n+\\`\\`\\`\n+with:\n+\n+\\`\\`\\`\n+sage: SymbolicValuesRing(SR('x'))\n+x\n+sage: SymbolicValuesRing(SR('x') >= 1)\n+error - cannot convert\n+sage: SymbolicValuesRing('x') >= 1\n+error - cannot decide\n+sage: assume(x >= 2)\n+sage: SymbolicValuesRing('x') >= 1\n+True\n+\\`\\`\\`\n+\n+This could then be used for example with \\`Polyhedron(..., backend='field')\\`.\n+\n+\n+Approach 1 to implement this is to wrap elements of \\`SR\\` in some wrapper class. \n+\n+\n+\n+Approach 2 is to implement it through refactoring:\n+\n+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. \n+\n+- The magic behavior of comparison operators for \\`SR\\` elements, creating relations, will be implemented in a wrapper class. \n+Ideally, this will be unified with the separate implementation of this functionality in \\`sage.numerical.linear_functions\\`.\n+\n+\n+Here we do Approach 1.\n \n \n Summary: Wrapper class for symbolic equations, inequalities\n```\n",
    "created_at": "2022-09-02T02:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30234#issuecomment-454473",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,44 @@
+We create a "subring" of the Symbolic "Ring" that only includes value objects without variables (like SymbolicConstantsRing) and has eager evaluation of relational operators.
+
+Compare:
+
+\`\`\`
+sage: s = SR('x') == 1                                                                                                                                                           
+sage: s                                                                                                                                                                          
+x == 1
+sage: s in SR                                                                                                                                                                    
+True
+\`\`\`
+with:
+
+\`\`\`
+sage: SymbolicValuesRing(SR('x'))
+x
+sage: SymbolicValuesRing(SR('x') >= 1)
+error - cannot convert
+sage: SymbolicValuesRing('x') >= 1
+error - cannot decide
+sage: assume(x >= 2)
+sage: SymbolicValuesRing('x') >= 1
+True
+\`\`\`
+
+This could then be used for example with \`Polyhedron(..., backend='field')\`.
+
+
+Approach 1 to implement this is to wrap elements of \`SR\` in some wrapper class. 
+
+
+
+Approach 2 is to implement it through refactoring:
+
+- We refactor the Symbolic Ring so that there is a convenient parent class for symbolic expressions with normal Python comparison semantics instead of creating relations. 
+
+- The magic behavior of comparison operators for \`SR\` elements, creating relations, will be implemented in a wrapper class. 
+Ideally, this will be unified with the separate implementation of this functionality in \`sage.numerical.linear_functions\`.
+
+
+Here we do Approach 1.
 
 
 Summary: Wrapper class for symbolic equations, inequalities
```

