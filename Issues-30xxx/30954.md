# Issue 30954: Implement a proper equality check for polyhedron representation objects

archive/issues_030717.json:
```json
{
    "body": "\n```\nsage: P = (1/2)*polytopes.cube()                                                                                                                                                    \nsage: Q = (1/2)*polytopes.cube(backend='field')                                                                                                                                     \nsage: for p in P.inequalities(): \n....:     assert p in Q.inequalities() \n....:                                                                                                                                                                               \n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\n<ipython-input-16-d0a8f3fbfdbb> in <module>\n      1 for p in P.inequalities():\n----> 2     assert p in Q.inequalities()\n      3 \n\nAssertionError: \n```\nThis isn't acceptable. Those inequalites are the same, only the defining vector differs by a positive scalar.\n\nWe also define a method `is_facet_defining_inequality` that checks whether `self` could replace an inequality of the polyhedron `other`. This is useful, when `other` is not full-dimensional and inequalities aren't unique (only after `affine_hull_projection`).\n\nCC:  @jplab @laisrast\n\nKeywords: scalars, polyhedra\n\nBranch/Commit: [9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)\n\nReviewer: Jean-Philippe Labb\u00e9\n\nAuthor: Jonathan Kliem\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30954\n\n",
    "closed_at": "2020-12-05T22:13:02Z",
    "created_at": "2020-11-23T20:09:26Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Implement a proper equality check for polyhedron representation objects",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30954",
    "user": "https://github.com/kliem"
}
```

```
sage: P = (1/2)*polytopes.cube()                                                                                                                                                    
sage: Q = (1/2)*polytopes.cube(backend='field')                                                                                                                                     
sage: for p in P.inequalities(): 
....:     assert p in Q.inequalities() 
....:                                                                                                                                                                               
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-16-d0a8f3fbfdbb> in <module>
      1 for p in P.inequalities():
----> 2     assert p in Q.inequalities()
      3 

AssertionError: 
```
This isn't acceptable. Those inequalites are the same, only the defining vector differs by a positive scalar.

We also define a method `is_facet_defining_inequality` that checks whether `self` could replace an inequality of the polyhedron `other`. This is useful, when `other` is not full-dimensional and inequalities aren't unique (only after `affine_hull_projection`).

CC:  @jplab @laisrast

Keywords: scalars, polyhedra

Branch/Commit: [9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)

Reviewer: Jean-Philippe Labbé

Author: Jonathan Kliem

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30954





---

archive/issue_comments_614697.json:
```json
{
    "body": "Commit: [4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)",
    "created_at": "2020-11-23T21:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614697",
    "user": "https://github.com/kliem"
}
```

Commit: [4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)



---

archive/issue_comments_614698.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[4c1f295](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)|`scale rays, lines, inequalities and equations for comparison`|",
    "created_at": "2020-11-23T21:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614698",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[4c1f295](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)|`scale rays, lines, inequalities and equations for comparison`|



---

archive/issue_events_091087.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "rename": {
        "from": "Implement a proper equality check for representation objects",
        "to": "Implement a proper equality check for polyhedron representation objects"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30954#event-91087"
}
```



---

archive/issue_comments_614699.json:
```json
{
    "body": "Branch: [public/30954](https://github.com/sagemath/sagetrac-mirror/tree/public/30954)",
    "created_at": "2020-11-23T21:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614699",
    "user": "https://github.com/kliem"
}
```

Branch: [public/30954](https://github.com/sagemath/sagetrac-mirror/tree/public/30954)



---

archive/issue_comments_614700.json:
```json
{
    "body": "Changing commit from \"[4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)\" to \"[b1eac2c770c01961979580283c4500c42b56971b](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)\"",
    "created_at": "2020-11-24T11:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614700",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b](https://github.com/sagemath/sagetrac-mirror/commit/4c1f2950e60a4d0a0ff4f46ebf5adb4247c20a7b)" to "[b1eac2c770c01961979580283c4500c42b56971b](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)"



---

archive/issue_comments_614701.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[b1eac2c](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)|`implement is_facet_defining_inequality`|",
    "created_at": "2020-11-24T11:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[b1eac2c](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)|`implement is_facet_defining_inequality`|



---

archive/issue_comments_614702.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,5 @@\n AssertionError: \n ```\n This isn't acceptable. Those inequalites are the same, only the defining vector differs by a positive scalar.\n+\n+We also define a method `is_facet_defining_inequality` that checks whether `self` could replace an inequality of the polyhedron `other`. This is useful, when `other` is not full-dimensional and inequalities aren't unique (only after `affine_hull_projection`).\n``````\n",
    "created_at": "2020-11-24T11:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614702",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,5 @@
 AssertionError: 
 ```
 This isn't acceptable. Those inequalites are the same, only the defining vector differs by a positive scalar.
+
+We also define a method `is_facet_defining_inequality` that checks whether `self` could replace an inequality of the polyhedron `other`. This is useful, when `other` is not full-dimensional and inequalities aren't unique (only after `affine_hull_projection`).
``````




---

archive/issue_comments_614703.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-11-24T11:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614703",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_614704.json:
```json
{
    "body": "Reviewer: Jean-Philippe Labb\u00e9",
    "created_at": "2020-11-24T13:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614704",
    "user": "https://github.com/jplab"
}
```

Reviewer: Jean-Philippe Labbé



---

archive/issue_comments_614705.json:
```json
{
    "body": "<a id='comment:4'></a>\nMinor things:\n\n```diff\n-        cross_slack_matrix = self_matrix*hom_Vrep\n+        cross_slack_matrix = self_matrix * hom_Vrep\n```\n\n```diff\n-        if any(self.A()*line.vector() for line in other.lines()):\n+        if any(self.A() * line.vector() for line in other.lines()):\n```\n\nIn the TEST block, I would remove the `QQ(*)` to save some space... (could you also indent/line split?)\n\nWhy is there a lonely `::` ?:\n\n```diff\n+            False\n+\n+        ::\n+\n+            sage: P = Polyhedron(vertices=[[0,0,0],[0,1,0]], lines=[[1,0,0]])\n```",
    "created_at": "2020-11-24T13:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614705",
    "user": "https://github.com/jplab"
}
```

<a id='comment:4'></a>
Minor things:

```diff
-        cross_slack_matrix = self_matrix*hom_Vrep
+        cross_slack_matrix = self_matrix * hom_Vrep
```

```diff
-        if any(self.A()*line.vector() for line in other.lines()):
+        if any(self.A() * line.vector() for line in other.lines()):
```

In the TEST block, I would remove the `QQ(*)` to save some space... (could you also indent/line split?)

Why is there a lonely `::` ?:

```diff
+            False
+
+        ::
+
+            sage: P = Polyhedron(vertices=[[0,0,0],[0,1,0]], lines=[[1,0,0]])
```



---

archive/issue_comments_614706.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [jipilab](#comment%3A4):\n> \n> Why is there a lonely `::` ?:\n> \n> \n> ```diff\n> +            False\n> +\n> +        ::\n> +\n> +            sage: P = Polyhedron(vertices=[[0,0,0],[0,1,0]], lines=[[1,0,0]])\n> ```\n> \n\nPeople use it to group examples, when they are too lazy to write down a nice sentence for each example.",
    "created_at": "2020-11-24T14:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614706",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>
Replying to [jipilab](#comment%3A4):
> 
> Why is there a lonely `::` ?:
> 
> 
> ```diff
> +            False
> +
> +        ::
> +
> +            sage: P = Polyhedron(vertices=[[0,0,0],[0,1,0]], lines=[[1,0,0]])
> ```
> 

People use it to group examples, when they are too lazy to write down a nice sentence for each example.



---

archive/issue_comments_614707.json:
```json
{
    "body": "<a id='comment:6'></a>\nIt's just a new example, I redefine `P`, I redefine `Q`.",
    "created_at": "2020-11-24T14:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614707",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>
It's just a new example, I redefine `P`, I redefine `Q`.



---

archive/issue_comments_614708.json:
```json
{
    "body": "<a id='comment:7'></a>\nYou forgot `# optional - pynormaliz` in the test-block.",
    "created_at": "2020-11-24T14:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614708",
    "user": "https://github.com/jplab"
}
```

<a id='comment:7'></a>
You forgot `# optional - pynormaliz` in the test-block.



---

archive/issue_comments_614709.json:
```json
{
    "body": "Changing commit from \"[b1eac2c770c01961979580283c4500c42b56971b](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)\" to \"[9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)\"",
    "created_at": "2020-11-24T14:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[b1eac2c770c01961979580283c4500c42b56971b](https://github.com/sagemath/sagetrac-mirror/commit/b1eac2c770c01961979580283c4500c42b56971b)" to "[9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)"



---

archive/issue_comments_614710.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[9ee3335](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)|`reviewers comments`|",
    "created_at": "2020-11-24T14:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614710",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[9ee3335](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)|`reviewers comments`|



---

archive/issue_comments_614711.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-25T15:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614711",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_614712.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks! Looks good and will be useful!",
    "created_at": "2020-11-25T15:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614712",
    "user": "https://github.com/jplab"
}
```

<a id='comment:9'></a>
Thanks! Looks good and will be useful!



---

archive/issue_events_091088.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-05T22:13:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30954#event-91088"
}
```



---

archive/issue_comments_614713.json:
```json
{
    "body": "Changing branch from \"[public/30954](https://github.com/sagemath/sagetrac-mirror/tree/public/30954)\" to \"[9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)\"",
    "created_at": "2020-12-05T22:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614713",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[public/30954](https://github.com/sagemath/sagetrac-mirror/tree/public/30954)" to "[9ee33351d8a20008f4ed6d24205962917c180561](https://github.com/sagemath/sagetrac-mirror/commit/9ee33351d8a20008f4ed6d24205962917c180561)"



---

archive/issue_comments_614714.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-05T22:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30954",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30954#issuecomment-614714",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
