# Issue 30944: tox: Improve local-sudo-ubuntu-standard

archive/issues_030707.json:
```json
{
    "body": "As a follow up to #30923, we improve the `local-sudo-...` environments as follows:\n- Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)\n- Use `configure --enable-build-as-root` for `local-root`\n- Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)\n- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of also invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).\n\n\nCC:  @mkoeppe @dimpase @kliem\n\nBranch/Commit: [ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)\n\nReviewer: Jonathan Kliem\n\nAuthor: Matthias Koeppe\n\nDependencies: #29124\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30944\n\n",
    "closed_at": "2021-01-24T10:38:10Z",
    "created_at": "2020-11-22T17:52:52Z",
    "labels": [
        "component: porting",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "tox: Improve local-sudo-ubuntu-standard",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30944",
    "user": "https://github.com/tobiasdiez"
}
```
As a follow up to #30923, we improve the `local-sudo-...` environments as follows:
- Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)
- Use `configure --enable-build-as-root` for `local-root`
- Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)
- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of also invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).


CC:  @mkoeppe @dimpase @kliem

Branch/Commit: [ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)

Reviewer: Jonathan Kliem

Author: Matthias Koeppe

Dependencies: #29124

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30944





---

archive/issue_comments_614415.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe variant could be called `local-root-ubuntu-standard`, I guess",
    "created_at": "2020-11-22T19:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614415",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
The variant could be called `local-root-ubuntu-standard`, I guess



---

archive/issue_comments_614416.json:
```json
{
    "body": "Branch: [u/mkoeppe/tox__improve_local_sudo_ubuntu_standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox__improve_local_sudo_ubuntu_standard)",
    "created_at": "2020-11-22T20:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614416",
    "user": "https://github.com/mkoeppe"
}
```

Branch: [u/mkoeppe/tox__improve_local_sudo_ubuntu_standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox__improve_local_sudo_ubuntu_standard)



---

archive/issue_comments_614417.json:
```json
{
    "body": "Replying to [ticket:30944 gh-tobiasdiez]:\n> - Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)\n\n\nRight, I forgot about the mess with `TARGETS_PRE` and `TARGETS_OPTIONAL` in `tox.ini`, which do not get the same defaults for `local` as they do for `docker` - I'll fix this\n\n---\nNew commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[30e624a](https://github.com/sagemath/sagetrac-mirror/commit/30e624abbc52b5a5a060a4eca801e8fda303937f)|`tox.ini: Add local-sudo`|\n|[75ecd11](https://github.com/sagemath/sagetrac-mirror/commit/75ecd11e878e34a4c508d2f983b6d7527e689f94)|`tox.ini (local-sudo): Also use ...-bootstrap.txt`|\n|[0dc79eb](https://github.com/sagemath/sagetrac-mirror/commit/0dc79eb4b542a11aa8c226ca8cf9f0e2306698eb)|`build/bin/sage-print-system-package-command: Handle --no-install-recommends, --yes for systems for which write-dockerfile.sh knows these flags`|\n|[050dcb8](https://github.com/sagemath/sagetrac-mirror/commit/050dcb8275b3a7e0db4c7ae3503428107bb5bf17)|`tox.ini (local-sudo): Use --yes --no-install-recommends`|\n|[c8fbe0b](https://github.com/sagemath/sagetrac-mirror/commit/c8fbe0beaec3a404d330aaebdf37186e9c6becec)|`tox.ini (local-sudo): Ignore errors when IGNORE_MISSING_SYSTEM_PACKAGES=yes`|\n|[ff34897](https://github.com/sagemath/sagetrac-mirror/commit/ff34897cac35061afd348cc08a6559f95f406f14)|`tox.ini (local): Guess the package system if it is not provided as a factor`|\n|[e9e5d47](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)|`build/bin/sage-print-system-package-command (debian --yes): Use DEBIAN_FRONTEND=noninteractive`|",
    "created_at": "2020-11-22T20:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614417",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [ticket:30944 gh-tobiasdiez]:
> - Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)


Right, I forgot about the mess with `TARGETS_PRE` and `TARGETS_OPTIONAL` in `tox.ini`, which do not get the same defaults for `local` as they do for `docker` - I'll fix this

---
New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[30e624a](https://github.com/sagemath/sagetrac-mirror/commit/30e624abbc52b5a5a060a4eca801e8fda303937f)|`tox.ini: Add local-sudo`|
|[75ecd11](https://github.com/sagemath/sagetrac-mirror/commit/75ecd11e878e34a4c508d2f983b6d7527e689f94)|`tox.ini (local-sudo): Also use ...-bootstrap.txt`|
|[0dc79eb](https://github.com/sagemath/sagetrac-mirror/commit/0dc79eb4b542a11aa8c226ca8cf9f0e2306698eb)|`build/bin/sage-print-system-package-command: Handle --no-install-recommends, --yes for systems for which write-dockerfile.sh knows these flags`|
|[050dcb8](https://github.com/sagemath/sagetrac-mirror/commit/050dcb8275b3a7e0db4c7ae3503428107bb5bf17)|`tox.ini (local-sudo): Use --yes --no-install-recommends`|
|[c8fbe0b](https://github.com/sagemath/sagetrac-mirror/commit/c8fbe0beaec3a404d330aaebdf37186e9c6becec)|`tox.ini (local-sudo): Ignore errors when IGNORE_MISSING_SYSTEM_PACKAGES=yes`|
|[ff34897](https://github.com/sagemath/sagetrac-mirror/commit/ff34897cac35061afd348cc08a6559f95f406f14)|`tox.ini (local): Guess the package system if it is not provided as a factor`|
|[e9e5d47](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)|`build/bin/sage-print-system-package-command (debian --yes): Use DEBIAN_FRONTEND=noninteractive`|



---

archive/issue_comments_614418.json:
```json
{
    "body": "Commit: [e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)",
    "created_at": "2020-11-22T20:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614418",
    "user": "https://github.com/mkoeppe"
}
```

Commit: [e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)



---

archive/issue_comments_614419.json:
```json
{
    "body": "Dependencies: #30923",
    "created_at": "2020-11-23T02:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614419",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: #30923



---

archive/issue_comments_614420.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mkoeppe](#comment%3A1):\n> The variant could be called `local-root-ubuntu-standard`, I guess\n\nAdding this in #29124",
    "created_at": "2020-11-24T05:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614420",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Replying to [mkoeppe](#comment%3A1):
> The variant could be called `local-root-ubuntu-standard`, I guess

Adding this in #29124



---

archive/issue_comments_614421.json:
```json
{
    "body": "Changing dependencies from \"#30923\" to \"#30923, #29124\"",
    "created_at": "2020-11-24T18:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614421",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30923" to "#30923, #29124"



---

archive/issue_comments_614422.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [gh-tobiasdiez in #29124](https://trac.sagemath.org/ticket/29124?replyto=22#comment:22):\n> I'm not sure about the naming of the `local-` environments. Why should I expect as a developer that `local-sudo` installs system packages? What about `local-system-packages-ubuntu` (for root) and `local-sudo-system-packages-ubuntu` (for sudo)?\n\nAll of these environments install system packages... The only one that does not is `local-direct`",
    "created_at": "2020-11-24T18:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614422",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Replying to [gh-tobiasdiez in #29124](https://trac.sagemath.org/ticket/29124?replyto=22#comment:22):
> I'm not sure about the naming of the `local-` environments. Why should I expect as a developer that `local-sudo` installs system packages? What about `local-system-packages-ubuntu` (for root) and `local-sudo-system-packages-ubuntu` (for sudo)?

All of these environments install system packages... The only one that does not is `local-direct`



---

archive/issue_comments_614423.json:
```json
{
    "body": "<a id='comment:9'></a>\nAh ok...than it makes sense.",
    "created_at": "2020-11-25T16:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614423",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>
Ah ok...than it makes sense.



---

archive/issue_comments_614424.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[d318067](https://github.com/sagemath/sagetrac-mirror/commit/d3180678ca52abca94e0444b5324234803de417f)|`build/pkgs/_prereq/spkg-configure.m4: New`|\n|[85f8ce5](https://github.com/sagemath/sagetrac-mirror/commit/85f8ce5225c9ad690af813f805bb31e1985ed4eb)|`src/doc/bootstrap: Remove special casing of build/pkgs/$SYSTEM.txt - _prereq is now just a standard package with spkg-configure.m4`|\n|[0e97683](https://github.com/sagemath/sagetrac-mirror/commit/0e97683f28c32d89f4b76b8be2de7653734ae277)|`tox.ini: Simplify, use sage-get-system-packages, sage-package list`|\n|[da3f657](https://github.com/sagemath/sagetrac-mirror/commit/da3f657f5757276943b58a1c840bb45854d8b053)|`tox.ini: Fixup - always include _bootstrap`|\n|[8fde1dc](https://github.com/sagemath/sagetrac-mirror/commit/8fde1dc625f281fbdde361e58d2d9115a1ac0fe0)|`build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt`|\n|[8d725b8](https://github.com/sagemath/sagetrac-mirror/commit/8d725b8f8ca7e55a3fd09e9adb8d807ceed8ff84)|`src/doc/en/developer/portability_testing.rst: Update paths in documentation`|\n|[bd7f66c](https://github.com/sagemath/sagetrac-mirror/commit/bd7f66c9e388b84aab870c382bfd9dc46a4af6de)|`Makefile (configure): Update dependency on moved files build/pkgs/*.txt`|\n|[c18e935](https://github.com/sagemath/sagetrac-mirror/commit/c18e935abaffefbfee6abbcfacdf1d9e4516e96c)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|\n|[f18f849](https://github.com/sagemath/sagetrac-mirror/commit/f18f849be44167cc84002045bbb24a8d1f979128)|`tox.ini: Add local-root`|\n|[fd47bc3](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)|`tox.ini (local-root): Pass --enable-build-as-root to configure`|",
    "created_at": "2020-11-25T22:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[d318067](https://github.com/sagemath/sagetrac-mirror/commit/d3180678ca52abca94e0444b5324234803de417f)|`build/pkgs/_prereq/spkg-configure.m4: New`|
|[85f8ce5](https://github.com/sagemath/sagetrac-mirror/commit/85f8ce5225c9ad690af813f805bb31e1985ed4eb)|`src/doc/bootstrap: Remove special casing of build/pkgs/$SYSTEM.txt - _prereq is now just a standard package with spkg-configure.m4`|
|[0e97683](https://github.com/sagemath/sagetrac-mirror/commit/0e97683f28c32d89f4b76b8be2de7653734ae277)|`tox.ini: Simplify, use sage-get-system-packages, sage-package list`|
|[da3f657](https://github.com/sagemath/sagetrac-mirror/commit/da3f657f5757276943b58a1c840bb45854d8b053)|`tox.ini: Fixup - always include _bootstrap`|
|[8fde1dc](https://github.com/sagemath/sagetrac-mirror/commit/8fde1dc625f281fbdde361e58d2d9115a1ac0fe0)|`build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt`|
|[8d725b8](https://github.com/sagemath/sagetrac-mirror/commit/8d725b8f8ca7e55a3fd09e9adb8d807ceed8ff84)|`src/doc/en/developer/portability_testing.rst: Update paths in documentation`|
|[bd7f66c](https://github.com/sagemath/sagetrac-mirror/commit/bd7f66c9e388b84aab870c382bfd9dc46a4af6de)|`Makefile (configure): Update dependency on moved files build/pkgs/*.txt`|
|[c18e935](https://github.com/sagemath/sagetrac-mirror/commit/c18e935abaffefbfee6abbcfacdf1d9e4516e96c)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|
|[f18f849](https://github.com/sagemath/sagetrac-mirror/commit/f18f849be44167cc84002045bbb24a8d1f979128)|`tox.ini: Add local-root`|
|[fd47bc3](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)|`tox.ini (local-root): Pass --enable-build-as-root to configure`|



---

archive/issue_comments_614425.json:
```json
{
    "body": "Changing commit from \"[e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)\" to \"[fd47bc39793be3d917f0ab1aac14ecce13970704](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)\"",
    "created_at": "2020-11-25T22:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8](https://github.com/sagemath/sagetrac-mirror/commit/e9e5d47d5e936fe7f28bcb7a0e8ba5c0711deea8)" to "[fd47bc39793be3d917f0ab1aac14ecce13970704](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)"



---

archive/issue_comments_614426.json:
```json
{
    "body": "Author: Matthias Koeppe",
    "created_at": "2020-11-25T22:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614426",
    "user": "https://github.com/mkoeppe"
}
```

Author: Matthias Koeppe



---

archive/issue_comments_614427.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n-As a follow up to #30923, we improve the `local-sudo-ubuntu-standard` environment as follows:\n-- Remove `sudo` requirement (which is not installed on github actions and not needed there)\n+As a follow up to #30923, we improve the `local-sudo-...` environments as follows:\n+- Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)\n+- Use `configure --enable-build-as-root` for `local-root`\n - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)\n - Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)\n-- Enable `--enable-build-as-root` for tox (Tobias: not sure about this one)\n+\n``````\n",
    "created_at": "2020-11-25T22:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614427",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
-As a follow up to #30923, we improve the `local-sudo-ubuntu-standard` environment as follows:
-- Remove `sudo` requirement (which is not installed on github actions and not needed there)
+As a follow up to #30923, we improve the `local-sudo-...` environments as follows:
+- Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)
+- Use `configure --enable-build-as-root` for `local-root`
 - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)
 - Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)
-- Enable `--enable-build-as-root` for tox (Tobias: not sure about this one)
+
``````




---

archive/issue_comments_614428.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[d700ab2](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)|`Merge tag '9.3.beta2' into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-11-25T22:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[d700ab2](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)|`Merge tag '9.3.beta2' into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614429.json:
```json
{
    "body": "Changing commit from \"[fd47bc39793be3d917f0ab1aac14ecce13970704](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)\" to \"[d700ab293a857397e964334baeb8207d083daca9](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)\"",
    "created_at": "2020-11-25T22:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[fd47bc39793be3d917f0ab1aac14ecce13970704](https://github.com/sagemath/sagetrac-mirror/commit/fd47bc39793be3d917f0ab1aac14ecce13970704)" to "[d700ab293a857397e964334baeb8207d083daca9](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)"



---

archive/issue_comments_614430.json:
```json
{
    "body": "<a id='comment:13'></a>\nTo simplify the build rule for `local`, the next step is to do #30721 so we can eliminate the separate `make base-toolchain` step.",
    "created_at": "2020-11-25T22:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614430",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
To simplify the build rule for `local`, the next step is to do #30721 so we can eliminate the separate `make base-toolchain` step.



---

archive/issue_comments_614431.json:
```json
{
    "body": "Changing dependencies from \"#30923, #29124\" to \"#30923, #29124, #30721\"",
    "created_at": "2020-11-25T22:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614431",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30923, #29124" to "#30923, #29124, #30721"



---

archive/issue_comments_614432.json:
```json
{
    "body": "Changing commit from \"[d700ab293a857397e964334baeb8207d083daca9](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)\" to \"[9414be10c519113c5f77b99504447d8ead4074e5](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)\"",
    "created_at": "2020-11-25T22:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[d700ab293a857397e964334baeb8207d083daca9](https://github.com/sagemath/sagetrac-mirror/commit/d700ab293a857397e964334baeb8207d083daca9)" to "[9414be10c519113c5f77b99504447d8ead4074e5](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)"



---

archive/issue_comments_614433.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|\n|[5e9366d](https://github.com/sagemath/sagetrac-mirror/commit/5e9366d545d744840c2de716dd6d070c97555b13)|`Merge tag '9.3.beta2' into t/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_`|\n|[6b9f3a3](https://github.com/sagemath/sagetrac-mirror/commit/6b9f3a36ff57a3384be8ba63f6ff5b2e17a8cbdb)|`Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[9414be1](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-11-25T22:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
|[5e9366d](https://github.com/sagemath/sagetrac-mirror/commit/5e9366d545d744840c2de716dd6d070c97555b13)|`Merge tag '9.3.beta2' into t/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_`|
|[6b9f3a3](https://github.com/sagemath/sagetrac-mirror/commit/6b9f3a36ff57a3384be8ba63f6ff5b2e17a8cbdb)|`Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[9414be1](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614434.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|\n|[e959873](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)|`tox.ini (local): Do not build the toolchain when posargs = config.status or posargs = configure`|",
    "created_at": "2020-11-26T05:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614434",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
|[e959873](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)|`tox.ini (local): Do not build the toolchain when posargs = config.status or posargs = configure`|



---

archive/issue_comments_614435.json:
```json
{
    "body": "Changing commit from \"[9414be10c519113c5f77b99504447d8ead4074e5](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)\" to \"[e959873490b161ab53e0400d32612401e9db2d0c](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)\"",
    "created_at": "2020-11-26T05:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[9414be10c519113c5f77b99504447d8ead4074e5](https://github.com/sagemath/sagetrac-mirror/commit/9414be10c519113c5f77b99504447d8ead4074e5)" to "[e959873490b161ab53e0400d32612401e9db2d0c](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)"



---

archive/issue_comments_614436.json:
```json
{
    "body": "Changing dependencies from \"#30923, #29124, #30721\" to \"#30923, #29124\"",
    "created_at": "2020-11-26T05:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614436",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30923, #29124, #30721" to "#30923, #29124"



---

archive/issue_comments_614437.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [mkoeppe](#comment%3A13):\n> To simplify the build rule for `local`, the next step is to do #30721 so we can eliminate the separate `make base-toolchain` step.\n\nWell, I'll work on that another time. For now I have implemented it in a different way, special casing on \"config*\" targets.",
    "created_at": "2020-11-26T05:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614437",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Replying to [mkoeppe](#comment%3A13):
> To simplify the build rule for `local`, the next step is to do #30721 so we can eliminate the separate `make base-toolchain` step.

Well, I'll work on that another time. For now I have implemented it in a different way, special casing on "config*" targets.



---

archive/issue_comments_614438.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-11-26T05:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614438",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_614439.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks! Looks good to me, as far as I understand the changes.\n\nJust to make sure:\n> Make tox -e local-sudo-standard -- config.status stop after configure\n\n\nIs fixed as well?",
    "created_at": "2020-11-26T08:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614439",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:17'></a>
Thanks! Looks good to me, as far as I understand the changes.

Just to make sure:
> Make tox -e local-sudo-standard -- config.status stop after configure


Is fixed as well?



---

archive/issue_comments_614440.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [gh-tobiasdiez](#comment%3A17):\n> Thanks! Looks good to me, as far as I understand the changes.\n> \n> Just to make sure:\n> > Make tox -e local-sudo-standard -- config.status stop after configure\n\n> \n> Is fixed as well?\n\n\nYes. This is what I meant in the previous comment - \"special casing on `config*` targets\"",
    "created_at": "2020-11-26T18:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614440",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Replying to [gh-tobiasdiez](#comment%3A17):
> Thanks! Looks good to me, as far as I understand the changes.
> 
> Just to make sure:
> > Make tox -e local-sudo-standard -- config.status stop after configure

> 
> Is fixed as well?


Yes. This is what I meant in the previous comment - "special casing on `config*` targets"



---

archive/issue_comments_614441.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [mkoeppe](#comment%3A18):\n> Replying to [gh-tobiasdiez](#comment%3A17):\n> > Thanks! Looks good to me, as far as I understand the changes.\n> > \n> > Just to make sure:\n> > > Make tox -e local-sudo-standard -- config.status stop after configure\n\n> > \n> > Is fixed as well?\n\n> \n> Yes. This is what I meant in the previous comment - \"special casing on `config*` targets\"\n\n\nOk, then is good! Me with my limited bash knowledge thought that the final `make` that builds the sage packages is still invoked even though `-- config.status` is specified.",
    "created_at": "2020-11-26T20:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614441",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:19'></a>
Replying to [mkoeppe](#comment%3A18):
> Replying to [gh-tobiasdiez](#comment%3A17):
> > Thanks! Looks good to me, as far as I understand the changes.
> > 
> > Just to make sure:
> > > Make tox -e local-sudo-standard -- config.status stop after configure

> > 
> > Is fixed as well?

> 
> Yes. This is what I meant in the previous comment - "special casing on `config*` targets"


Ok, then is good! Me with my limited bash knowledge thought that the final `make` that builds the sage packages is still invoked even though `-- config.status` is specified.



---

archive/issue_comments_614442.json:
```json
{
    "body": "<a id='comment:20'></a>\nIt's only invoked on nonempty `$TARGETS_OPTIONAL`",
    "created_at": "2020-11-26T21:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614442",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
It's only invoked on nonempty `$TARGETS_OPTIONAL`



---

archive/issue_comments_614443.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-02T20:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614443",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_614444.json:
```json
{
    "body": "<a id='comment:21'></a>\nRunning `tox -e local-sudo-ubuntu-standard -- SAGE_NUM_THREADS=16 build` (in WLS) yields\n\n```\nReading package lists... Done\nE: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\nE: Unable to lock directory /var/lib/apt/lists/\nW: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\nW: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\nERROR: InvocationError for command /usr/bin/bash -c '$(build/bin/sage-print-system-package-command debian update) #' (exited with code 100)\n```\nRunning the same command with sudo is successful, so I guess a `--sudo` is missing somewhere.\n\n\nMoreover, `./bootstrap` didn't run with following error:\n\n```\n/mnt/d/Programming/sage/src/bin/sage-env: line 133: cd: /mnt/d/Programming/Projects/sage: No such file or directory\nWarning: overwriting SAGE_ROOT environment variable:\nOld SAGE_ROOT=/mnt/d/Programming/Projects/sage\nNew SAGE_ROOT=\nError: You must set either the SAGE_LOCAL or SAGE_SCRIPTS_DIR environment variable to run this\nError setting environment variables by sourcing '/mnt/d/Programming/sage/src/bin/sage-env';\npossibly contact sage-devel (see http://groups.google.com/group/sage-devel).\n```\nuntil I deleted src/bin/sage-env manually. And the root version `sudo tox -e local-root-ubuntu-standard -- SAGE_NUM_THREADS=10 build` yields\n\n```\nlocal-root-ubuntu-standard run-test: commands[2] | bash -c 'PACKAGES=$(build/bin/sage-get-system-packages debian $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap); $(build/bin/sage-print-system-package-command debian  --yes --no-install-recommends install $PACKAGES) || [ \"$IGNORE_MISSING_SYSTEM_PACKAGES\" = yes ] && echo \"(ignoring errors)\" '\n/usr/bin/bash: DEBIAN_FRONTEND=noninteractive: command not found\nERROR: InvocationError for command /usr/bin/bash -c 'PACKAGES=$(build/bin/sage-get-system-packages debian $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap); $(build/bin/sage-print-system-package-command debian  --yes --no-install-recommends install $PACKAGES) || [ \"$IGNORE_MISSING_SYSTEM_PACKAGES\" = yes ] && echo \"(ignoring errors)\" ' (exited with code 1)\n```",
    "created_at": "2020-12-02T20:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614444",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:21'></a>
Running `tox -e local-sudo-ubuntu-standard -- SAGE_NUM_THREADS=16 build` (in WLS) yields

```
Reading package lists... Done
E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)
E: Unable to lock directory /var/lib/apt/lists/
W: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)
W: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)
ERROR: InvocationError for command /usr/bin/bash -c '$(build/bin/sage-print-system-package-command debian update) #' (exited with code 100)
```
Running the same command with sudo is successful, so I guess a `--sudo` is missing somewhere.


Moreover, `./bootstrap` didn't run with following error:

```
/mnt/d/Programming/sage/src/bin/sage-env: line 133: cd: /mnt/d/Programming/Projects/sage: No such file or directory
Warning: overwriting SAGE_ROOT environment variable:
Old SAGE_ROOT=/mnt/d/Programming/Projects/sage
New SAGE_ROOT=
Error: You must set either the SAGE_LOCAL or SAGE_SCRIPTS_DIR environment variable to run this
Error setting environment variables by sourcing '/mnt/d/Programming/sage/src/bin/sage-env';
possibly contact sage-devel (see http://groups.google.com/group/sage-devel).
```
until I deleted src/bin/sage-env manually. And the root version `sudo tox -e local-root-ubuntu-standard -- SAGE_NUM_THREADS=10 build` yields

```
local-root-ubuntu-standard run-test: commands[2] | bash -c 'PACKAGES=$(build/bin/sage-get-system-packages debian $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap); $(build/bin/sage-print-system-package-command debian  --yes --no-install-recommends install $PACKAGES) || [ "$IGNORE_MISSING_SYSTEM_PACKAGES" = yes ] && echo "(ignoring errors)" '
/usr/bin/bash: DEBIAN_FRONTEND=noninteractive: command not found
ERROR: InvocationError for command /usr/bin/bash -c 'PACKAGES=$(build/bin/sage-get-system-packages debian $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap); $(build/bin/sage-print-system-package-command debian  --yes --no-install-recommends install $PACKAGES) || [ "$IGNORE_MISSING_SYSTEM_PACKAGES" = yes ] && echo "(ignoring errors)" ' (exited with code 1)
```



---

archive/issue_comments_614445.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[27368b1](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)|`tox.ini (local-sudo): Run apt-get update with sudo`|",
    "created_at": "2020-12-02T21:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[27368b1](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)|`tox.ini (local-sudo): Run apt-get update with sudo`|



---

archive/issue_comments_614446.json:
```json
{
    "body": "Changing commit from \"[e959873490b161ab53e0400d32612401e9db2d0c](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)\" to \"[27368b1bc6e9ed5a117005674025747af78b4227](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)\"",
    "created_at": "2020-12-02T21:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614446",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[e959873490b161ab53e0400d32612401e9db2d0c](https://github.com/sagemath/sagetrac-mirror/commit/e959873490b161ab53e0400d32612401e9db2d0c)" to "[27368b1bc6e9ed5a117005674025747af78b4227](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)"



---

archive/issue_comments_614447.json:
```json
{
    "body": "Changing dependencies from \"#30923, #29124\" to \"#30923, #29124, #22731\"",
    "created_at": "2020-12-03T01:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614447",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30923, #29124" to "#30923, #29124, #22731"



---

archive/issue_comments_614448.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [gh-tobiasdiez](#comment%3A21):\n> Moreover, `./bootstrap` didn't run with following error:\n> \n> ```\n> /mnt/d/Programming/sage/src/bin/sage-env: line 133: cd: /mnt/d/Programming/Projects/sage: No such file or directory\n> Warning: overwriting SAGE_ROOT environment variable:\n> Old SAGE_ROOT=/mnt/d/Programming/Projects/sage\n> New SAGE_ROOT=\n> Error: You must set either the SAGE_LOCAL or SAGE_SCRIPTS_DIR environment variable to run this\n> Error setting environment variables by sourcing '/mnt/d/Programming/sage/src/bin/sage-env';\n> possibly contact sage-devel (see http://groups.google.com/group/sage-devel).\n> ```\n> until I deleted src/bin/sage-env manually.\n\n\nThis is fixed by #22731, I think. I'll merge it",
    "created_at": "2020-12-03T01:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614448",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
Replying to [gh-tobiasdiez](#comment%3A21):
> Moreover, `./bootstrap` didn't run with following error:
> 
> ```
> /mnt/d/Programming/sage/src/bin/sage-env: line 133: cd: /mnt/d/Programming/Projects/sage: No such file or directory
> Warning: overwriting SAGE_ROOT environment variable:
> Old SAGE_ROOT=/mnt/d/Programming/Projects/sage
> New SAGE_ROOT=
> Error: You must set either the SAGE_LOCAL or SAGE_SCRIPTS_DIR environment variable to run this
> Error setting environment variables by sourcing '/mnt/d/Programming/sage/src/bin/sage-env';
> possibly contact sage-devel (see http://groups.google.com/group/sage-devel).
> ```
> until I deleted src/bin/sage-env manually.


This is fixed by #22731, I think. I'll merge it



---

archive/issue_comments_614449.json:
```json
{
    "body": "Changing commit from \"[27368b1bc6e9ed5a117005674025747af78b4227](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)\" to \"[7216c677975a520343df6ab9dad5fdf0fc09cfcc](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)\"",
    "created_at": "2020-12-03T01:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614449",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[27368b1bc6e9ed5a117005674025747af78b4227](https://github.com/sagemath/sagetrac-mirror/commit/27368b1bc6e9ed5a117005674025747af78b4227)" to "[7216c677975a520343df6ab9dad5fdf0fc09cfcc](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)"



---

archive/issue_comments_614450.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[8f88709](https://github.com/sagemath/sagetrac-mirror/commit/8f88709ed014c3af84ae5b3cbb26f1a1dbbbe53d)|`src/bin/sage: Only source sage-env-config if it exists`|\n|[ab2655e](https://github.com/sagemath/sagetrac-mirror/commit/ab2655ea81257c333d3fdf2613d99c4ec2b343d7)|`src/bin/sage: Use python3 etc. from PATH instead of using SAGE_LOCAL`|\n|[4577f37](https://github.com/sagemath/sagetrac-mirror/commit/4577f37111f99e5733dd1c909e6e3a79dfe2163d)|`src/bin/sage-env: Make sage-env-config optional`|\n|[c35c170](https://github.com/sagemath/sagetrac-mirror/commit/c35c170a7b7607187a5b5bb03f3bc3863555eb52)|`sage.env: Add SAGE_VENV`|\n|[c585d94](https://github.com/sagemath/sagetrac-mirror/commit/c585d94b95c5675f5a68690d13fa6a949642c48f)|`src/sage: Replace some SAGE_LOCAL by SAGE_VENV`|\n|[2fd195f](https://github.com/sagemath/sagetrac-mirror/commit/2fd195f5f044d125b0d5a743fec9d79e449126af)|`src/bin/sage: Fix reference to trac ticket`|\n|[f3b7a9c](https://github.com/sagemath/sagetrac-mirror/commit/f3b7a9cce247457f07ef42069cdadb3f6409b008)|`src/sage/env.py: Add documentation`|\n|[1fe77a8](https://github.com/sagemath/sagetrac-mirror/commit/1fe77a819d2477bf4b53d228388a4ff3e2c7c45d)|`src/bin/sage-env: Do not set SAGE_SCRIPTS_DIR`|\n|[38eebc3](https://github.com/sagemath/sagetrac-mirror/commit/38eebc3d9f790c81b8ffcc963cf2513184c9ae6a)|`Merge tag '9.3.beta2' into t/22731/22731`|\n|[7216c67](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)|`Merge branch 'u/mkoeppe/22731' of git://trac.sagemath.org/sage into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-12-03T01:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[8f88709](https://github.com/sagemath/sagetrac-mirror/commit/8f88709ed014c3af84ae5b3cbb26f1a1dbbbe53d)|`src/bin/sage: Only source sage-env-config if it exists`|
|[ab2655e](https://github.com/sagemath/sagetrac-mirror/commit/ab2655ea81257c333d3fdf2613d99c4ec2b343d7)|`src/bin/sage: Use python3 etc. from PATH instead of using SAGE_LOCAL`|
|[4577f37](https://github.com/sagemath/sagetrac-mirror/commit/4577f37111f99e5733dd1c909e6e3a79dfe2163d)|`src/bin/sage-env: Make sage-env-config optional`|
|[c35c170](https://github.com/sagemath/sagetrac-mirror/commit/c35c170a7b7607187a5b5bb03f3bc3863555eb52)|`sage.env: Add SAGE_VENV`|
|[c585d94](https://github.com/sagemath/sagetrac-mirror/commit/c585d94b95c5675f5a68690d13fa6a949642c48f)|`src/sage: Replace some SAGE_LOCAL by SAGE_VENV`|
|[2fd195f](https://github.com/sagemath/sagetrac-mirror/commit/2fd195f5f044d125b0d5a743fec9d79e449126af)|`src/bin/sage: Fix reference to trac ticket`|
|[f3b7a9c](https://github.com/sagemath/sagetrac-mirror/commit/f3b7a9cce247457f07ef42069cdadb3f6409b008)|`src/sage/env.py: Add documentation`|
|[1fe77a8](https://github.com/sagemath/sagetrac-mirror/commit/1fe77a819d2477bf4b53d228388a4ff3e2c7c45d)|`src/bin/sage-env: Do not set SAGE_SCRIPTS_DIR`|
|[38eebc3](https://github.com/sagemath/sagetrac-mirror/commit/38eebc3d9f790c81b8ffcc963cf2513184c9ae6a)|`Merge tag '9.3.beta2' into t/22731/22731`|
|[7216c67](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)|`Merge branch 'u/mkoeppe/22731' of git://trac.sagemath.org/sage into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614451.json:
```json
{
    "body": "Changing commit from \"[7216c677975a520343df6ab9dad5fdf0fc09cfcc](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)\" to \"[1c2dfc62c731c586d569c3e9eae6cd806c25a960](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)\"",
    "created_at": "2020-12-03T01:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[7216c677975a520343df6ab9dad5fdf0fc09cfcc](https://github.com/sagemath/sagetrac-mirror/commit/7216c677975a520343df6ab9dad5fdf0fc09cfcc)" to "[1c2dfc62c731c586d569c3e9eae6cd806c25a960](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)"



---

archive/issue_comments_614452.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|\n|[1c2dfc6](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)|`tox.ini (local-root, local-sudo): Run output of sage-print-system-package-command through eval`|",
    "created_at": "2020-12-03T01:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
|[1c2dfc6](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)|`tox.ini (local-root, local-sudo): Run output of sage-print-system-package-command through eval`|



---

archive/issue_comments_614453.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-03T01:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614453",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_614454.json:
```json
{
    "body": "Changing commit from \"[1c2dfc62c731c586d569c3e9eae6cd806c25a960](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)\" to \"[3c7e5c482e1c54ba140c3d134ebfc909bd943a3d](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)\"",
    "created_at": "2020-12-06T21:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614454",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[1c2dfc62c731c586d569c3e9eae6cd806c25a960](https://github.com/sagemath/sagetrac-mirror/commit/1c2dfc62c731c586d569c3e9eae6cd806c25a960)" to "[3c7e5c482e1c54ba140c3d134ebfc909bd943a3d](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)"



---

archive/issue_comments_614455.json:
```json
{
    "body": "<a id='comment:27'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|\n|[35241e7](https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57)|`src/doc/en/developer/portability_testing.rst: Update paths in documentation`|\n|[68baff1](https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249)|`Makefile (configure): Update dependency on moved files build/pkgs/*.txt`|\n|[fae4bd0](https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2)|`bootstrap: Remove --enable-_recommended etc.`|\n|[a9bd145](https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830)|`m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary`|\n|[93f5e32](https://github.com/sagemath/sagetrac-mirror/commit/93f5e32272d0f5082fce05406f99d6487d1a50fc)|`build/bin/sage-print-system-package-command (debian --yes): Use DEBIAN_FRONTEND=noninteractive`|\n|[898758d](https://github.com/sagemath/sagetrac-mirror/commit/898758da497ca4b57c5e8b609cf2439d215018a7)|`tox.ini: Add local-root`|\n|[559dd8e](https://github.com/sagemath/sagetrac-mirror/commit/559dd8e7acd647224b2b320a9e77e95e0737bc04)|`tox.ini (local-root): Pass --enable-build-as-root to configure`|\n|[a85f41c](https://github.com/sagemath/sagetrac-mirror/commit/a85f41c9220d9b71f0033faf1cb9010a8626ede1)|`tox.ini (local): Do not build the toolchain when posargs = config.status or posargs = configure`|\n|[1de912a](https://github.com/sagemath/sagetrac-mirror/commit/1de912a69f441c80e4d4c64a627f0707e5807442)|`tox.ini (local-sudo): Run apt-get update with sudo`|\n|[3c7e5c4](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)|`tox.ini (local-root, local-sudo): Run output of sage-print-system-package-command through eval`|",
    "created_at": "2020-12-06T21:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614455",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
|[35241e7](https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57)|`src/doc/en/developer/portability_testing.rst: Update paths in documentation`|
|[68baff1](https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249)|`Makefile (configure): Update dependency on moved files build/pkgs/*.txt`|
|[fae4bd0](https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2)|`bootstrap: Remove --enable-_recommended etc.`|
|[a9bd145](https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830)|`m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary`|
|[93f5e32](https://github.com/sagemath/sagetrac-mirror/commit/93f5e32272d0f5082fce05406f99d6487d1a50fc)|`build/bin/sage-print-system-package-command (debian --yes): Use DEBIAN_FRONTEND=noninteractive`|
|[898758d](https://github.com/sagemath/sagetrac-mirror/commit/898758da497ca4b57c5e8b609cf2439d215018a7)|`tox.ini: Add local-root`|
|[559dd8e](https://github.com/sagemath/sagetrac-mirror/commit/559dd8e7acd647224b2b320a9e77e95e0737bc04)|`tox.ini (local-root): Pass --enable-build-as-root to configure`|
|[a85f41c](https://github.com/sagemath/sagetrac-mirror/commit/a85f41c9220d9b71f0033faf1cb9010a8626ede1)|`tox.ini (local): Do not build the toolchain when posargs = config.status or posargs = configure`|
|[1de912a](https://github.com/sagemath/sagetrac-mirror/commit/1de912a69f441c80e4d4c64a627f0707e5807442)|`tox.ini (local-sudo): Run apt-get update with sudo`|
|[3c7e5c4](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)|`tox.ini (local-root, local-sudo): Run output of sage-print-system-package-command through eval`|



---

archive/issue_comments_614456.json:
```json
{
    "body": "<a id='comment:28'></a>\nRebased on top of 9.3.beta3 and rebased #29124",
    "created_at": "2020-12-06T21:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614456",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
Rebased on top of 9.3.beta3 and rebased #29124



---

archive/issue_comments_614457.json:
```json
{
    "body": "Changing dependencies from \"#30923, #29124, #22731\" to \"#29124\"",
    "created_at": "2020-12-06T21:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614457",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30923, #29124, #22731" to "#29124"



---

archive/issue_comments_614458.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|\n|[184ae6d](https://github.com/sagemath/sagetrac-mirror/commit/184ae6d63c28e4462ec3711dc60c6d357218c3c8)|`Merge tag '9.3.beta3' into t/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_`|\n|[084fbf6](https://github.com/sagemath/sagetrac-mirror/commit/084fbf6b995e304d126000e5be2797b51fbd4592)|`src/doc/bootstrap: Use ./sage`|\n|[571cc49](https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d)|`Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[f7ff30c](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-12-10T06:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614458",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
|[184ae6d](https://github.com/sagemath/sagetrac-mirror/commit/184ae6d63c28e4462ec3711dc60c6d357218c3c8)|`Merge tag '9.3.beta3' into t/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_`|
|[084fbf6](https://github.com/sagemath/sagetrac-mirror/commit/084fbf6b995e304d126000e5be2797b51fbd4592)|`src/doc/bootstrap: Use ./sage`|
|[571cc49](https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d)|`Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[f7ff30c](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614459.json:
```json
{
    "body": "Changing commit from \"[3c7e5c482e1c54ba140c3d134ebfc909bd943a3d](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)\" to \"[f7ff30c92e59308d84377411ea4edd9173c4cd75](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)\"",
    "created_at": "2020-12-10T06:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[3c7e5c482e1c54ba140c3d134ebfc909bd943a3d](https://github.com/sagemath/sagetrac-mirror/commit/3c7e5c482e1c54ba140c3d134ebfc909bd943a3d)" to "[f7ff30c92e59308d84377411ea4edd9173c4cd75](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)"



---

archive/issue_comments_614460.json:
```json
{
    "body": "Changing commit from \"[f7ff30c92e59308d84377411ea4edd9173c4cd75](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)\" to \"[e9ca2c1d848708c0a626bc412844043b005c985a](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)\"",
    "created_at": "2020-12-16T23:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[f7ff30c92e59308d84377411ea4edd9173c4cd75](https://github.com/sagemath/sagetrac-mirror/commit/f7ff30c92e59308d84377411ea4edd9173c4cd75)" to "[e9ca2c1d848708c0a626bc412844043b005c985a](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)"



---

archive/issue_comments_614461.json:
```json
{
    "body": "<a id='comment:30'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|\n|[c529729](https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000)|`Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[b73d6f0](https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6)|`Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[e9ca2c1](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-12-16T23:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
|[c529729](https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000)|`Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[b73d6f0](https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6)|`Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[e9ca2c1](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614462.json:
```json
{
    "body": "<a id='comment:31'></a>\nMerged newest version of #29124. Still needs review",
    "created_at": "2020-12-16T23:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614462",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
Merged newest version of #29124. Still needs review



---

archive/issue_comments_614463.json:
```json
{
    "body": "<a id='comment:33'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[3cf5ee4](https://github.com/sagemath/sagetrac-mirror/commit/3cf5ee46cde574170859d9d8ce90abef990e7969)|`Merge commit 'a50ddf88975086b14a49895e371477df00fd57b5' of git://trac.sagemath.org/sage into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|\n|[b4927e1](https://github.com/sagemath/sagetrac-mirror/commit/b4927e1574e6f856f5dda78b888713f0358b16da)|`sage.misc.package: Remove/adjust non-robust doctests`|\n|[e5fe752](https://github.com/sagemath/sagetrac-mirror/commit/e5fe7522a2ad03b23553d696e7a941e9f4fa3271)|`Merge tag '9.3.beta4' into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|\n|[78ff9d5](https://github.com/sagemath/sagetrac-mirror/commit/78ff9d580f5f0c1396e1f8a5421858170999957a)|`src/sage/misc/package.py: Add one more # optional - build`|\n|[a44042f](https://github.com/sagemath/sagetrac-mirror/commit/a44042f86577431358fb3ea95875cd949f971984)|`Merge branch 't/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available' into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[64bde5f](https://github.com/sagemath/sagetrac-mirror/commit/64bde5f887ac115b1e40b7905ad30cc00d8de363)|`Merge tag '9.3.beta5' into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|\n|[e9a7572](https://github.com/sagemath/sagetrac-mirror/commit/e9a7572a37b228f4a74c35f680190e6b237f48d8)|`src/sage/misc/package.py: Improve source formatting`|\n|[c7bcda9](https://github.com/sagemath/sagetrac-mirror/commit/c7bcda971b925201891d60d13c6b6e879c888301)|`Merge branch 't/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available' into t/29124/script-packages-prereq-toolchain-bootstrap`|\n|[9988c5f](https://github.com/sagemath/sagetrac-mirror/commit/9988c5fab43adc6f5784a124248887637475d67c)|`ci-cygwin*.yml: Adjust to new script packages _bootstrap, _prereq`|\n|[ab19133](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|",
    "created_at": "2020-12-29T19:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614463",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[3cf5ee4](https://github.com/sagemath/sagetrac-mirror/commit/3cf5ee46cde574170859d9d8ce90abef990e7969)|`Merge commit 'a50ddf88975086b14a49895e371477df00fd57b5' of git://trac.sagemath.org/sage into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|
|[b4927e1](https://github.com/sagemath/sagetrac-mirror/commit/b4927e1574e6f856f5dda78b888713f0358b16da)|`sage.misc.package: Remove/adjust non-robust doctests`|
|[e5fe752](https://github.com/sagemath/sagetrac-mirror/commit/e5fe7522a2ad03b23553d696e7a941e9f4fa3271)|`Merge tag '9.3.beta4' into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|
|[78ff9d5](https://github.com/sagemath/sagetrac-mirror/commit/78ff9d580f5f0c1396e1f8a5421858170999957a)|`src/sage/misc/package.py: Add one more # optional - build`|
|[a44042f](https://github.com/sagemath/sagetrac-mirror/commit/a44042f86577431358fb3ea95875cd949f971984)|`Merge branch 't/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available' into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[64bde5f](https://github.com/sagemath/sagetrac-mirror/commit/64bde5f887ac115b1e40b7905ad30cc00d8de363)|`Merge tag '9.3.beta5' into t/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available`|
|[e9a7572](https://github.com/sagemath/sagetrac-mirror/commit/e9a7572a37b228f4a74c35f680190e6b237f48d8)|`src/sage/misc/package.py: Improve source formatting`|
|[c7bcda9](https://github.com/sagemath/sagetrac-mirror/commit/c7bcda971b925201891d60d13c6b6e879c888301)|`Merge branch 't/30940/src_bin_sage_list_packages__make_it_work_if_sage_root_is_not_available' into t/29124/script-packages-prereq-toolchain-bootstrap`|
|[9988c5f](https://github.com/sagemath/sagetrac-mirror/commit/9988c5fab43adc6f5784a124248887637475d67c)|`ci-cygwin*.yml: Adjust to new script packages _bootstrap, _prereq`|
|[ab19133](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)|`Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30944/tox__improve_local_sudo_ubuntu_standard`|



---

archive/issue_comments_614464.json:
```json
{
    "body": "Changing commit from \"[e9ca2c1d848708c0a626bc412844043b005c985a](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)\" to \"[ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)\"",
    "created_at": "2020-12-29T19:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614464",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[e9ca2c1d848708c0a626bc412844043b005c985a](https://github.com/sagemath/sagetrac-mirror/commit/e9ca2c1d848708c0a626bc412844043b005c985a)" to "[ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)"



---

archive/issue_comments_614465.json:
```json
{
    "body": "<a id='comment:34'></a>\nMerged newest #29124, needs review",
    "created_at": "2020-12-29T19:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614465",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
Merged newest #29124, needs review



---

archive/issue_comments_614466.json:
```json
{
    "body": "<a id='comment:35'></a>\nLet's get this in please (dependency of #31064 and #31099)",
    "created_at": "2021-01-06T19:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614466",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Let's get this in please (dependency of #31064 and #31099)



---

archive/issue_comments_614467.json:
```json
{
    "body": "<a id='comment:36'></a>\nI think #29124 isn't merged completely.",
    "created_at": "2021-01-06T20:04:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614467",
    "user": "https://github.com/kliem"
}
```

<a id='comment:36'></a>
I think #29124 isn't merged completely.



---

archive/issue_comments_614468.json:
```json
{
    "body": "<a id='comment:37'></a>\nWhat does\n\n```diff\n+    local:             case \"{posargs:}\" in \\\n+    local:                 config*) ;; \\\n+    local:                 *)       make -k V=0 base-toolchain ;; \\\n+    local:             esac && \\\n-    local:                     make -k V=0 base-toolchain && \\\n```\n\ndo? (That is not the diff, but I think morally it is.)",
    "created_at": "2021-01-06T20:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614468",
    "user": "https://github.com/kliem"
}
```

<a id='comment:37'></a>
What does

```diff
+    local:             case "{posargs:}" in \
+    local:                 config*) ;; \
+    local:                 *)       make -k V=0 base-toolchain ;; \
+    local:             esac && \
-    local:                     make -k V=0 base-toolchain && \
```

do? (That is not the diff, but I think morally it is.)



---

archive/issue_comments_614469.json:
```json
{
    "body": "<a id='comment:38'></a>\nIt implements the last bullet point of the ticket description: \nWhen something like `config.status` is given as the target, `make base-toolchain` should not be run.",
    "created_at": "2021-01-06T20:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614469",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
It implements the last bullet point of the ticket description: 
When something like `config.status` is given as the target, `make base-toolchain` should not be run.



---

archive/issue_comments_614470.json:
```json
{
    "body": "<a id='comment:39'></a>\nThanks. But does it stop then or are the other things still run?:\n\n```diff\n+    local:             make -k V=0 SAGE_SPKG=\"sage-spkg -y -o\" SAGE_CHECK=warn SAGE_CHECK_PACKAGES=\"!cython,!r,!python3,!nose,!gap,!cysignals,!linbox,!git,!ppl,!cmake,!networkx,!symengine_py\" {env:TARGETS_PRE:} {posargs:build} && \\\n+    local:             ([ -z \"{env:TARGETS_OPTIONAL:}\" ] || make -k V=0 SAGE_SPKG=\"sage-spkg -y -o\" SAGE_CHECK=warn SAGE_CHECK_PACKAGES=\"!cython,!r,!python3,!nose,!gap,!cysignals,!linbox,!git,!ppl,!cmake\" {env:TARGETS_OPTIONAL:} || echo \"(error ignored)\" ) '\n }}}",
    "created_at": "2021-01-06T20:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614470",
    "user": "https://github.com/kliem"
}
```

<a id='comment:39'></a>
Thanks. But does it stop then or are the other things still run?:

```diff
+    local:             make -k V=0 SAGE_SPKG="sage-spkg -y -o" SAGE_CHECK=warn SAGE_CHECK_PACKAGES="!cython,!r,!python3,!nose,!gap,!cysignals,!linbox,!git,!ppl,!cmake,!networkx,!symengine_py" {env:TARGETS_PRE:} {posargs:build} && \
+    local:             ([ -z "{env:TARGETS_OPTIONAL:}" ] || make -k V=0 SAGE_SPKG="sage-spkg -y -o" SAGE_CHECK=warn SAGE_CHECK_PACKAGES="!cython,!r,!python3,!nose,!gap,!cysignals,!linbox,!git,!ppl,!cmake" {env:TARGETS_OPTIONAL:} || echo "(error ignored)" ) '
 }}}



---

archive/issue_comments_614471.json:
```json
{
    "body": "<a id='comment:40'></a>\nI have reworded the ticket description to clarify it.",
    "created_at": "2021-01-06T21:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614471",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
I have reworded the ticket description to clarify it.



---

archive/issue_comments_614472.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n - Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)\n - Use `configure --enable-build-as-root` for `local-root`\n - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)\n-- Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)\n+- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).\n \n``````\n",
    "created_at": "2021-01-06T21:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 - Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)
 - Use `configure --enable-build-as-root` for `local-root`
 - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)
-- Make `tox -e local-sudo-standard -- config.status` stop after `configure` (and don't run `make`)
+- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).
 
``````




---

archive/issue_comments_614473.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n - Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)\n - Use `configure --enable-build-as-root` for `local-root`\n - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)\n-- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).\n+- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of also invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).\n \n``````\n",
    "created_at": "2021-01-06T21:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614473",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 - Provide alternative environments `local-root...`, which assume that we are already root, removing the `sudo` requirement (which is not installed on github actions and not needed there)
 - Use `configure --enable-build-as-root` for `local-root`
 - Add `DEBIAN_FRONTEND: noninteractive` to the installation of packages via `apt get` (otherwise installation of `tzdata` blocks CI)
-- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).
+- Make `tox -e local-sudo-standard -- config.status` only build `config.status` instead of also invoking `make base-toolchain` (which is run as the required first step of the Sage build system before something like `make numpy` can be run; see #30721).
 
``````




---

archive/issue_comments_614474.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-07T06:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614474",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_614475.json:
```json
{
    "body": "Reviewer: Jonathan Kliem",
    "created_at": "2021-01-07T06:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614475",
    "user": "https://github.com/kliem"
}
```

Reviewer: Jonathan Kliem



---

archive/issue_comments_614476.json:
```json
{
    "body": "<a id='comment:42'></a>\nLGTM.",
    "created_at": "2021-01-07T06:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614476",
    "user": "https://github.com/kliem"
}
```

<a id='comment:42'></a>
LGTM.



---

archive/issue_comments_614477.json:
```json
{
    "body": "<a id='comment:43'></a>\nThank you!",
    "created_at": "2021-01-07T06:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614477",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>
Thank you!



---

archive/issue_events_091051.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-24T10:38:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30944#event-91051"
}
```



---

archive/issue_comments_614478.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-24T10:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614478",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_614479.json:
```json
{
    "body": "Changing branch from \"[u/mkoeppe/tox__improve_local_sudo_ubuntu_standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox__improve_local_sudo_ubuntu_standard)\" to \"[ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)\"",
    "created_at": "2021-01-24T10:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30944",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30944#issuecomment-614479",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/mkoeppe/tox__improve_local_sudo_ubuntu_standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox__improve_local_sudo_ubuntu_standard)" to "[ab191339dfa275b3466f530a59268c756f5d1b05](https://github.com/sagemath/sagetrac-mirror/commit/ab191339dfa275b3466f530a59268c756f5d1b05)"
