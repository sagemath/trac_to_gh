# Issue 30478: Update suitesparse to 5.10.1 to fix build failure with cuda 11

archive/issues_030241.json:
```json
{
    "assignees": [],
    "body": "Sage 9.1 fails to build with cuda 11, as cuda 11 no longer supports the \"architecture\" compute_30.\n\nUpstream ticket: https://github.com/DrTimothyAldenDavis/SuiteSparse/issues/56\n\nA fix would be to remove compute_30 from the build commands.\n\nCC:  @kiwifb @embray @dimpase @orlitzky @kliem\n\nBranch: **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe, Fran\u00e7ois Bissey**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30478_\n\n",
    "closed_at": "2021-07-23T20:11:54Z",
    "created_at": "2020-08-31T07:53:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update suitesparse to 5.10.1 to fix build failure with cuda 11",
    "type": "issue",
    "updated_at": "2021-08-07T11:46:13Z",
    "url": "https://github.com/sagemath/sage/issues/30478",
    "user": "https://github.com/sagetrac-johan"
}
```
Sage 9.1 fails to build with cuda 11, as cuda 11 no longer supports the "architecture" compute_30.

Upstream ticket: https://github.com/DrTimothyAldenDavis/SuiteSparse/issues/56

A fix would be to remove compute_30 from the build commands.

CC:  @kiwifb @embray @dimpase @orlitzky @kliem

Branch: **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe, François Bissey**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/30478_





---

archive/issue_events_420155.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420155"
}
```



---

archive/issue_events_420156.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420156"
}
```



---

archive/issue_events_420157.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420157"
}
```



---

archive/issue_comments_485778.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHow to replicate the build failure?",
    "created_at": "2020-08-31T15:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485778",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

How to replicate the build failure?



---

archive/issue_comments_485779.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI am not sure what your environment is, but the following is the contents of a small dockerfile to replicate the build failure:\n\n```\nFROM nvidia/cuda:11.0-devel-ubuntu20.04\n\nSHELL [\"/bin/bash\", \"-c\"]\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install --yes build-essential m4 dpkg-dev gettext automake apt-utils git cmake pkg-config python\n\nRUN adduser user < /dev/null\n\nUSER user\nWORKDIR /home/user/\n\nRUN mkdir Sage && \\\n    git clone git://git.sagemath.org/sage.git Sage && \\\n    cd Sage && \\\n    git checkout 9.1\n\nRUN cd Sage && \\\n    make -j 4 |& tee build_log.txt || true\n```\n\n\nAfter the build, the file /home/user/Sage/logs/pkgs/suitesparse-5.6.0.log contains the following, near the end:\n\n```\n/usr/local/cuda/bin/nvcc -I../../AMD/Include -I../../AMD/Source -I../../COLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CCOLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CAMD/Include -I../Include -I../../SuiteSparse_config -I/usr/local/cuda/include/ -Xcompiler -fPIC -O3 -gencode=arch=compute_30,code=sm_30 -gencode=arch=compute_35,code=sm_35 -gencode=arch=compute_50,code=sm_50 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_60,code=compute_60 -c ../GPU/cholmod_gpu_kernels.cu\nnvcc fatal   : Unsupported gpu architecture 'compute_30'\n```\n\nMy GPU happens to support compute_60, but the build statement looks very generic, so I assume it might not even matter that I have a GPU, for the purposes of replicating the build failure.",
    "created_at": "2020-09-01T07:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485779",
    "user": "https://github.com/sagetrac-johan"
}
```

<div id="comment:2" align="right">comment:2</div>

I am not sure what your environment is, but the following is the contents of a small dockerfile to replicate the build failure:

```
FROM nvidia/cuda:11.0-devel-ubuntu20.04

SHELL ["/bin/bash", "-c"]

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get install --yes build-essential m4 dpkg-dev gettext automake apt-utils git cmake pkg-config python

RUN adduser user < /dev/null

USER user
WORKDIR /home/user/

RUN mkdir Sage && \
    git clone git://git.sagemath.org/sage.git Sage && \
    cd Sage && \
    git checkout 9.1

RUN cd Sage && \
    make -j 4 |& tee build_log.txt || true
```


After the build, the file /home/user/Sage/logs/pkgs/suitesparse-5.6.0.log contains the following, near the end:

```
/usr/local/cuda/bin/nvcc -I../../AMD/Include -I../../AMD/Source -I../../COLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CCOLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CAMD/Include -I../Include -I../../SuiteSparse_config -I/usr/local/cuda/include/ -Xcompiler -fPIC -O3 -gencode=arch=compute_30,code=sm_30 -gencode=arch=compute_35,code=sm_35 -gencode=arch=compute_50,code=sm_50 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_60,code=compute_60 -c ../GPU/cholmod_gpu_kernels.cu
nvcc fatal   : Unsupported gpu architecture 'compute_30'
```

My GPU happens to support compute_60, but the build statement looks very generic, so I assume it might not even matter that I have a GPU, for the purposes of replicating the build failure.



---

archive/issue_comments_485780.json:
```json
{
    "body": "Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**",
    "created_at": "2020-09-01T17:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485780",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**



---

archive/issue_comments_485781.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.",
    "created_at": "2020-09-01T17:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485781",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.



---

archive/issue_comments_485782.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to none",
    "created_at": "2020-09-01T17:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485782",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to none



---

archive/issue_comments_485783.json:
```json
{
    "body": "Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**",
    "created_at": "2020-09-01T17:35:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485783",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**



---

archive/issue_comments_485784.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084\">40a47b4</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr></table>\n",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485784",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084">40a47b4</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr></table>




---

archive/issue_comments_485785.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485785",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_485786.json:
```json
{
    "body": "Commit: **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)**",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485786",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)**



---

archive/issue_comments_485787.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSomeone should prepare a pull request for upstream.",
    "created_at": "2020-09-01T18:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485787",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Someone should prepare a pull request for upstream.



---

archive/issue_comments_485788.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThere was a new commit to upstream pushed to github yesterday, and it seems to have removed references to compute_30 from the build files.\n\nNew contents in the file named \"ChangeLog\" in the commit:\n\n May 17, 2021, SuiteSparse 5.10.1\n\n* CUDA: remove sm_30 from SuiteSparse_config.mk\n* GraphBLAS v5.0.5: minor bug fix\n* minor changes to Makefiles\n\n\nA rebuild of Sage with SuiteSparse version 5.10.1, or with its master branch (which is currently probably the same), would be interesting.",
    "created_at": "2021-05-19T13:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485788",
    "user": "https://github.com/sagetrac-johan"
}
```

<div id="comment:8" align="right">comment:8</div>

There was a new commit to upstream pushed to github yesterday, and it seems to have removed references to compute_30 from the build files.

New contents in the file named "ChangeLog" in the commit:

 May 17, 2021, SuiteSparse 5.10.1

* CUDA: remove sm_30 from SuiteSparse_config.mk
* GraphBLAS v5.0.5: minor bug fix
* minor changes to Makefiles


A rebuild of Sage with SuiteSparse version 5.10.1, or with its master branch (which is currently probably the same), would be interesting.



---

archive/issue_events_420158.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-19T15:21:20Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "title_is": "Update suitesparse to 5.10.1 to fix build failure with cuda 11",
    "title_was": "Suitesparse build failure with cuda 11. (sage 9.1)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420158"
}
```



---

archive/issue_comments_485789.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nLooks like we have to wait for an actual release - https://github.com/DrTimothyAldenDavis/SuiteSparse/releases is still at 5.10.0",
    "created_at": "2021-05-19T15:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485789",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Looks like we have to wait for an actual release - https://github.com/DrTimothyAldenDavis/SuiteSparse/releases is still at 5.10.0



---

archive/issue_comments_485790.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2021-05-19T15:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485790",
    "user": "https://github.com/mkoeppe"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_events_420159.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-19T15:25:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420159"
}
```



---

archive/issue_comments_485791.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe upstream github page your refer to now says that 5.10.1 was released 10 hours ago.",
    "created_at": "2021-05-25T09:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485791",
    "user": "https://github.com/sagetrac-johan"
}
```

<div id="comment:12" align="right">comment:12</div>

The upstream github page your refer to now says that 5.10.1 was released 10 hours ago.



---

archive/issue_comments_485792.json:
```json
{
    "body": "Changed commit from **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)** to **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)**",
    "created_at": "2021-05-25T16:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485792",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)** to **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)**



---

archive/issue_comments_485793.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52c250565b372a9de0ee49444dc5361f1eb4df09\">52c2505</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a\">975ff86</a></td><td><code>build/pkgs/suitesparse: Update to 5.10.1</code></td></tr></table>\n",
    "created_at": "2021-05-25T16:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485793",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52c250565b372a9de0ee49444dc5361f1eb4df09">52c2505</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a">975ff86</a></td><td><code>build/pkgs/suitesparse: Update to 5.10.1</code></td></tr></table>




---

archive/issue_comments_485794.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nPatches need to be updated or removed.",
    "created_at": "2021-05-25T16:35:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485794",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Patches need to be updated or removed.



---

archive/issue_comments_485795.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI will try to have a look today.",
    "created_at": "2021-05-25T19:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485795",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

I will try to have a look today.



---

archive/issue_comments_485796.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI have cuda 11.2 on Debian Testing (Bullseye) and I can no longer build Sage 9.3 or Sage develop branch from git. I get the error reported here: \"nvcc fatal   : Unsupported gpu architecture 'compute_30' \"\n\n[Johan writes]: \"A fix would be to remove compute_30 from the build commands.\"\n\nHow can I temporarily patch Sage develop code to remove compute_30? \n\nWhat I want to do is: \n\n1) pull the latest git source code from develop branch.\n\n2) patch my locally cloned and checked out git develop code, removing compute_30 (I do not need it).\n\n3) ./configure and make to get a working sage again.",
    "created_at": "2021-06-01T16:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485796",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

<div id="comment:17" align="right">comment:17</div>

I have cuda 11.2 on Debian Testing (Bullseye) and I can no longer build Sage 9.3 or Sage develop branch from git. I get the error reported here: "nvcc fatal   : Unsupported gpu architecture 'compute_30' "

[Johan writes]: "A fix would be to remove compute_30 from the build commands."

How can I temporarily patch Sage develop code to remove compute_30? 

What I want to do is: 

1) pull the latest git source code from develop branch.

2) patch my locally cloned and checked out git develop code, removing compute_30 (I do not need it).

3) ./configure and make to get a working sage again.



---

archive/issue_comments_485797.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485797",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)**



---

archive/issue_comments_485798.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAt long last I fixed the patches to work with this version of suitesparse. Works on local linux box but OS X and windows need to be checked to see if new work is needed on those.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367\">32f9966</a></td><td><code>update the patches for 5.10.1</code></td></tr></table>\n",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485798",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

At long last I fixed the patches to work with this version of suitesparse. Works on local linux box but OS X and windows need to be checked to see if new work is needed on those.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367">32f9966</a></td><td><code>update the patches for 5.10.1</code></td></tr></table>




---

archive/issue_comments_485799.json:
```json
{
    "body": "Changed commit from **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)** to **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485799",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)** to **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)**



---

archive/issue_comments_485800.json:
```json
{
    "body": "Changed author from **Matthias Koeppe** to **Matthias Koeppe, Fran\u00e7ois Bissey**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485800",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Matthias Koeppe** to **Matthias Koeppe, François Bissey**



---

archive/issue_events_420160.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-08T01:32:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420160"
}
```



---

archive/issue_comments_485801.json:
```json
{
    "body": "Reviewer: **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968**",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485801",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968**



---

archive/issue_comments_485802.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485802",
    "user": "https://github.com/mkoeppe"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_485803.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mkoeppe](#comment:4):\n> I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.\n\nWith this branch, this now succeeds.\n\nRunning it on GH Actions now",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485803",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mkoeppe](#comment:4):
> I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.

With this branch, this now succeeds.

Running it on GH Actions now



---

archive/issue_events_420161.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-19T18:30:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420161"
}
```



---

archive/issue_events_420162.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-19T18:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420162"
}
```



---

archive/issue_comments_485804.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOn `ubuntu-trusty-standard` (https://github.com/mkoeppe/sage/runs/2770535461?check_suite_focus=true) and similar:\n\n```\n  [suitesparse-5.10.1]   gcc -O2 -g    -O3 -fexceptions -fPIC -fopenmp -I../Include -I../../COLAMD/Include -I../../AMD/Include -I../../SuiteSparse_config  -c ../Source/slip_create_mpfr_array.c\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c: In function 'slip_create_mpfr_array':\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: error: 'for' loop initial declarations are only allowed in C99 mode\n  [suitesparse-5.10.1]        for (int64_t i = 0; i < n; i++)\n  [suitesparse-5.10.1]        ^\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: note: use option -std=c99 or -std=gnu99 to compile your code\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:39:13: error: 'for' loop initial declarations are only allowed in C99 mode\n  [suitesparse-5.10.1]                for (int64_t j = 0; j < n; j++)\n  [suitesparse-5.10.1]                ^\n  [suitesparse-5.10.1]   make[8]: *** [slip_create_mpfr_array.o] Error 1\n```",
    "created_at": "2021-06-19T18:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485804",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

On `ubuntu-trusty-standard` (https://github.com/mkoeppe/sage/runs/2770535461?check_suite_focus=true) and similar:

```
  [suitesparse-5.10.1]   gcc -O2 -g    -O3 -fexceptions -fPIC -fopenmp -I../Include -I../../COLAMD/Include -I../../AMD/Include -I../../SuiteSparse_config  -c ../Source/slip_create_mpfr_array.c
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c: In function 'slip_create_mpfr_array':
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: error: 'for' loop initial declarations are only allowed in C99 mode
  [suitesparse-5.10.1]        for (int64_t i = 0; i < n; i++)
  [suitesparse-5.10.1]        ^
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: note: use option -std=c99 or -std=gnu99 to compile your code
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:39:13: error: 'for' loop initial declarations are only allowed in C99 mode
  [suitesparse-5.10.1]                for (int64_t j = 0; j < n; j++)
  [suitesparse-5.10.1]                ^
  [suitesparse-5.10.1]   make[8]: *** [slip_create_mpfr_array.o] Error 1
```



---

archive/issue_comments_485805.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOn `cygwin-standard` (https://github.com/mkoeppe/sage/runs/2771235514?check_suite_focus=true)\n\n```\n( cd /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib ; ln -sf cyglibsliplu-1.dll  )\nln: 'cyglibsliplu-1.dll' and './cyglibsliplu-1.dll' are the same file\nmake[6]: *** [Makefile:73: /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib/cyglibsliplu-1.dll] Error 1\n```",
    "created_at": "2021-06-19T18:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485805",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

On `cygwin-standard` (https://github.com/mkoeppe/sage/runs/2771235514?check_suite_focus=true)

```
( cd /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib ; ln -sf cyglibsliplu-1.dll  )
ln: 'cyglibsliplu-1.dll' and './cyglibsliplu-1.dll' are the same file
make[6]: *** [Makefile:73: /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib/cyglibsliplu-1.dll] Error 1
```



---

archive/issue_comments_485806.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n@kiwifb - do you have a repo from which you generated the updated patches?",
    "created_at": "2021-06-19T20:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485806",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

@kiwifb - do you have a repo from which you generated the updated patches?



---

archive/issue_comments_485807.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@mkoeppe](#comment:22):\n> @kiwifb - do you have a repo from which you generated the updated patches?\n\nNo. Not those. Gentoo has historically split suitesparse, and I have somewhat inherited that effort lately. **It is not a winning strategy so far**. Upstream has somewhat inconsistent upkeep of the versioning of the sub-packages and has done source changes without version bump of the sub-package concerned (because of minor mistake in the original release). I also inherited broken GPU support in cholmod that I haven't ever found the time to fix.\n\nThe failure on ubuntu trusty is probably because gcc does not default to C99, that can be fixed but do we really want to continue supporting 14.04?\n\nI have had no hand in writing the original cygwin patch. Someone familiar with it should inspect it.\nThe updated patch is strictly an update on the sage patches I and other wrote over the years.",
    "created_at": "2021-06-19T21:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485807",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@mkoeppe](#comment:22):
> @kiwifb - do you have a repo from which you generated the updated patches?

No. Not those. Gentoo has historically split suitesparse, and I have somewhat inherited that effort lately. **It is not a winning strategy so far**. Upstream has somewhat inconsistent upkeep of the versioning of the sub-packages and has done source changes without version bump of the sub-package concerned (because of minor mistake in the original release). I also inherited broken GPU support in cholmod that I haven't ever found the time to fix.

The failure on ubuntu trusty is probably because gcc does not default to C99, that can be fixed but do we really want to continue supporting 14.04?

I have had no hand in writing the original cygwin patch. Someone familiar with it should inspect it.
The updated patch is strictly an update on the sage patches I and other wrote over the years.



---

archive/issue_comments_485808.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI see why cygwin failed, there is a new sub-package SLIP_LU that didn't exist before so it isn't patched. It is not used by anything so we could just skip it for now.",
    "created_at": "2021-06-19T21:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485808",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

I see why cygwin failed, there is a new sub-package SLIP_LU that didn't exist before so it isn't patched. It is not used by anything so we could just skip it for now.



---

archive/issue_comments_485809.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@kiwifb](#comment:23):\n> do we really want to continue supporting 14.04?\n\nYes, I think we still need to support it (and similar systems) for a while - see #31526",
    "created_at": "2021-06-19T21:35:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485809",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@kiwifb](#comment:23):
> do we really want to continue supporting 14.04?

Yes, I think we still need to support it (and similar systems) for a while - see #31526



---

archive/issue_comments_485810.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@mkoeppe](#comment:25):\n> Replying to [@kiwifb](#comment:23):\n> > do we really want to continue supporting 14.04?\n\n> \n> Yes, I think we still need to support it (and similar systems) for a while - see #31526\n\nOK, sage should set up a C99 compiler, I just have to pass it. I think I may be able to ape the cygwin stuff (cross fingers).",
    "created_at": "2021-06-19T21:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485810",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@mkoeppe](#comment:25):
> Replying to [@kiwifb](#comment:23):
> > do we really want to continue supporting 14.04?

> 
> Yes, I think we still need to support it (and similar systems) for a while - see #31526

OK, sage should set up a C99 compiler, I just have to pass it. I think I may be able to ape the cygwin stuff (cross fingers).



---

archive/issue_comments_485811.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true",
    "created_at": "2021-06-19T22:41:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485811",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true



---

archive/issue_comments_485812.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@mkoeppe](#comment:27):\n> I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true\n\nThis is most curious. Patch says the top Makefile is not found. Either you are not in right directory or something is cleaning it after the checkout.",
    "created_at": "2021-06-20T01:18:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485812",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@mkoeppe](#comment:27):
> I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true

This is most curious. Patch says the top Makefile is not found. Either you are not in right directory or something is cleaning it after the checkout.



---

archive/issue_comments_485813.json:
```json
{
    "body": "Changed commit from **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)** to **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)**",
    "created_at": "2021-06-20T01:24:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485813",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)** to **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)**



---

archive/issue_comments_485814.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b2558372686609cc7f57ccfb0acba428f76adf6\">9b25583</a></td><td><code>update cygwin patch to include SLIP_LU</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0\">0b51340</a></td><td><code>Make sure C99 is used</code></td></tr></table>\n",
    "created_at": "2021-06-20T01:24:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485814",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b2558372686609cc7f57ccfb0acba428f76adf6">9b25583</a></td><td><code>update cygwin patch to include SLIP_LU</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0">0b51340</a></td><td><code>Make sure C99 is used</code></td></tr></table>




---

archive/issue_events_420163.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-20T01:27:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420163"
}
```



---

archive/issue_events_420164.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-20T01:27:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420164"
}
```



---

archive/issue_comments_485815.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nOk, this should take care of the two issues spotted in the review workflow. Patching for C99 may be heavy handed, it could be passed to Make.",
    "created_at": "2021-06-20T01:27:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485815",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">comment:30</div>

Ok, this should take care of the two issues spotted in the review workflow. Patching for C99 may be heavy handed, it could be passed to Make.



---

archive/issue_comments_485816.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@kiwifb](#comment:28):\n> Replying to [@mkoeppe](#comment:27):\n> > our patches do not seem to apply to suitesparse `master`\n\n> \n> This is most curious. Patch says the top Makefile is not found. \n\nSorry for the noise - this was just a stupid mistake in my script",
    "created_at": "2021-06-20T05:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485816",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@kiwifb](#comment:28):
> Replying to [@mkoeppe](#comment:27):
> > our patches do not seem to apply to suitesparse `master`

> 
> This is most curious. Patch says the top Makefile is not found. 

Sorry for the noise - this was just a stupid mistake in my script



---

archive/issue_comments_485817.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968** to **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786**",
    "created_at": "2021-06-20T05:42:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485817",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968** to **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786**



---

archive/issue_comments_485818.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nUsing suitesparse master, with my corrected workflow run, I see on `debian-stretch-standard` in https://github.com/mkoeppe/SuiteSparse/runs/2867609846?check_suite_focus=true:\n\n```\n  [suitesparse-git]   ranlib libsliplu.a\n  [suitesparse-git]   SLIP_gmp.o: In function `SLIP_mpfr_get_q':\n  [suitesparse-git]   /sage/local/var/tmp/sage/build/suitesparse-git/src/SLIP_LU/Lib/../Source/SLIP_gmp.c:1526: undefined reference to `mpfr_get_q'\n  [suitesparse-git]   collect2: error: ld returned 1 exit status\n  [suitesparse-git]   Makefile:69: recipe for target '/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2' failed\n  [suitesparse-git]   make[6]: *** [/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2] Error 1\n  [suitesparse-git]   make[6]: Target 'install' not remade because of errors.\n```\nLooks like we are missing some dependencies.\n(I don't know yet if this also affects the release that we are using.)",
    "created_at": "2021-06-20T05:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485818",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Using suitesparse master, with my corrected workflow run, I see on `debian-stretch-standard` in https://github.com/mkoeppe/SuiteSparse/runs/2867609846?check_suite_focus=true:

```
  [suitesparse-git]   ranlib libsliplu.a
  [suitesparse-git]   SLIP_gmp.o: In function `SLIP_mpfr_get_q':
  [suitesparse-git]   /sage/local/var/tmp/sage/build/suitesparse-git/src/SLIP_LU/Lib/../Source/SLIP_gmp.c:1526: undefined reference to `mpfr_get_q'
  [suitesparse-git]   collect2: error: ld returned 1 exit status
  [suitesparse-git]   Makefile:69: recipe for target '/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2' failed
  [suitesparse-git]   make[6]: *** [/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2] Error 1
  [suitesparse-git]   make[6]: Target 'install' not remade because of errors.
```
Looks like we are missing some dependencies.
(I don't know yet if this also affects the release that we are using.)



---

archive/issue_comments_485819.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nIn `SLIP_LU/Lib/Makefile` one can see that it needs `mpfr` and `gmp`",
    "created_at": "2021-06-20T06:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485819",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

In `SLIP_LU/Lib/Makefile` one can see that it needs `mpfr` and `gmp`



---

archive/issue_comments_485820.json:
```json
{
    "body": "Changed branch from **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)** to **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)**",
    "created_at": "2021-06-20T06:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485820",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)** to **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)**



---

archive/issue_comments_485821.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786** to **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334**",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485821",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786** to **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334**



---

archive/issue_comments_485822.json:
```json
{
    "body": "Changed commit from **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)** to **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)**",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485822",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)** to **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)**



---

archive/issue_comments_485823.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f\">7fa5381</a></td><td><code>build/pkgs/suitesparse/dependencies: Add mpfr, $(MP_LIBRARY) for SLIP_LU</code></td></tr></table>\n",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485823",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f">7fa5381</a></td><td><code>build/pkgs/suitesparse/dependencies: Add mpfr, $(MP_LIBRARY) for SLIP_LU</code></td></tr></table>




---

archive/issue_comments_485824.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nUpstream PR adding the ci-sage workflow at: https://github.com/DrTimothyAldenDavis/SuiteSparse/pull/95",
    "created_at": "2021-06-20T06:33:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485824",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>

Upstream PR adding the ci-sage workflow at: https://github.com/DrTimothyAldenDavis/SuiteSparse/pull/95



---

archive/issue_comments_485825.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI totally missed that dependency. It didn't connect in my head that suitesparse didn't depend on those so far. Good catch from those workflows.",
    "created_at": "2021-06-20T08:14:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485825",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:38" align="right">comment:38</div>

I totally missed that dependency. It didn't connect in my head that suitesparse didn't depend on those so far. Good catch from those workflows.



---

archive/issue_comments_485826.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74\">8d62aae</a></td><td><code>Merge tag '9.4.beta2' into t/30478/suitesparse-5.10.1</code></td></tr></table>\n",
    "created_at": "2021-06-20T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485826",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74">8d62aae</a></td><td><code>Merge tag '9.4.beta2' into t/30478/suitesparse-5.10.1</code></td></tr></table>




---

archive/issue_comments_485827.json:
```json
{
    "body": "Changed commit from **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)** to **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)**",
    "created_at": "2021-06-20T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485827",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)** to **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)**



---

archive/issue_comments_485828.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334** to **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657**",
    "created_at": "2021-06-20T20:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485828",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334** to **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657**



---

archive/issue_comments_485829.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nAnother round of testing on top of the current beta",
    "created_at": "2021-06-20T20:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485829",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Another round of testing on top of the current beta



---

archive/issue_events_420165.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T16:29:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420165"
}
```



---

archive/issue_events_420166.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T16:29:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420166"
}
```



---

archive/issue_comments_485830.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nOn `macos-homebrew-minimal-default-11.0` (https://github.com/mkoeppe/sage/runs/2870369436?check_suite_focus=true):\n\n```\n  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_type.cpp\n  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'\n  [suitesparse-5.10.1]   make[7]: *** [spqr_type.o] Error 1\n  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_tol.cpp\n  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'\n  [suitesparse-5.10.1]   make[7]: *** [spqr_tol.o] Error 1\n```",
    "created_at": "2021-07-11T16:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485830",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

On `macos-homebrew-minimal-default-11.0` (https://github.com/mkoeppe/sage/runs/2870369436?check_suite_focus=true):

```
  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_type.cpp
  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'
  [suitesparse-5.10.1]   make[7]: *** [spqr_type.o] Error 1
  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_tol.cpp
  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'
  [suitesparse-5.10.1]   make[7]: *** [spqr_tol.o] Error 1
```



---

archive/issue_comments_485831.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88e7d95ddd4e7a640f8c9077977478fbce51d98b\">88e7d95</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Stop suitesparse from using -std=c99 with C++ compilers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529\">5d26de7</a></td><td><code>Merge tag '9.4.beta4' into t/30478/suitesparse-5.10.1</code></td></tr></table>\n",
    "created_at": "2021-07-11T17:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485831",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88e7d95ddd4e7a640f8c9077977478fbce51d98b">88e7d95</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Stop suitesparse from using -std=c99 with C++ compilers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529">5d26de7</a></td><td><code>Merge tag '9.4.beta4' into t/30478/suitesparse-5.10.1</code></td></tr></table>




---

archive/issue_comments_485832.json:
```json
{
    "body": "Changed commit from **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)** to **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)**",
    "created_at": "2021-07-11T17:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485832",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)** to **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)**



---

archive/issue_events_420167.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:53:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420167"
}
```



---

archive/issue_events_420168.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:53:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420168"
}
```



---

archive/issue_comments_485833.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nOK c99 is an own goal. I enabled it that way because it was required for some of the libraries. So a better approach may be to remove the patch `05-c99.patch` and to set `CC=\"$CC -std-c99\"`.",
    "created_at": "2021-07-11T19:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485833",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:45" align="right">comment:45</div>

OK c99 is an own goal. I enabled it that way because it was required for some of the libraries. So a better approach may be to remove the patch `05-c99.patch` and to set `CC="$CC -std-c99"`.



---

archive/issue_comments_485834.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOK c99 was needed for ubuntu 14.04 not some libraries.",
    "created_at": "2021-07-11T19:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485834",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:46" align="right">comment:46</div>

OK c99 was needed for ubuntu 14.04 not some libraries.



---

archive/issue_comments_485835.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nHa, this explains why I didn't find the c99 stuff in upstream github...",
    "created_at": "2021-07-11T20:03:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485835",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:47" align="right">comment:47</div>

Ha, this explains why I didn't find the c99 stuff in upstream github...



---

archive/issue_comments_485836.json:
```json
{
    "body": "<div id=\"comment:48\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51b3c8b31d137f8535bbbb34e6cadf6587942dbe\">51b3c8b</a></td><td><code>Revert \"Make sure C99 is used\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603\">f2d21ed</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Put -std=c99 in CC (not CF)</code></td></tr></table>\n",
    "created_at": "2021-07-11T20:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485836",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:48"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51b3c8b31d137f8535bbbb34e6cadf6587942dbe">51b3c8b</a></td><td><code>Revert "Make sure C99 is used"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603">f2d21ed</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Put -std=c99 in CC (not CF)</code></td></tr></table>




---

archive/issue_comments_485837.json:
```json
{
    "body": "Changed commit from **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**",
    "created_at": "2021-07-11T20:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485837",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**



---

archive/issue_comments_485838.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nOK, this works on `local-homebrew-macos-minimal`.",
    "created_at": "2021-07-11T20:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485838",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

OK, this works on `local-homebrew-macos-minimal`.



---

archive/issue_comments_485839.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657** to **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726**",
    "created_at": "2021-07-11T20:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485839",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657** to **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726**



---

archive/issue_comments_485840.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nthere are some weird \"unable to build wheels\" messages, e.g.\n\n```\n [fpylll-0.5.6]   Failed to build fpylll\n2843\n  [fpylll-0.5.6]   ERROR: Failed to build one or more wheels\n```\nin https://github.com/mkoeppe/sage/runs/3041607937",
    "created_at": "2021-07-18T08:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485840",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

there are some weird "unable to build wheels" messages, e.g.

```
 [fpylll-0.5.6]   Failed to build fpylll
2843
  [fpylll-0.5.6]   ERROR: Failed to build one or more wheels
```
in https://github.com/mkoeppe/sage/runs/3041607937



---

archive/issue_comments_485841.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nand on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:\n\n```\n[pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'\n```",
    "created_at": "2021-07-18T08:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485841",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:52" align="right">comment:52</div>

and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:

```
[pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'
```



---

archive/issue_comments_485842.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@dimpase](#comment:52):\n> and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:\n> \n> ```\n> [pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'\n> ```\n\nThat's already broken in 9.4.beta4, see #32001",
    "created_at": "2021-07-18T17:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485842",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@dimpase](#comment:52):
> and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:
> 
> ```
> [pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'
> ```

That's already broken in 9.4.beta4, see #32001



---

archive/issue_comments_485843.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@dimpase](#comment:51):\n> there are some weird \"unable to build wheels\" messages, e.g.\n> \n> ```\n>  [fpylll-0.5.6]   Failed to build fpylll\n> 2843\n>   [fpylll-0.5.6]   ERROR: Failed to build one or more wheels\n> ```\n> in https://github.com/mkoeppe/sage/runs/3041607937\n\nThat log is from the configuration `homebrew-macos-python3_xcode-nokegonly`, which tests what happens without running `.homebrew-build-env` before the build...",
    "created_at": "2021-07-18T17:23:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485843",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@dimpase](#comment:51):
> there are some weird "unable to build wheels" messages, e.g.
> 
> ```
>  [fpylll-0.5.6]   Failed to build fpylll
> 2843
>   [fpylll-0.5.6]   ERROR: Failed to build one or more wheels
> ```
> in https://github.com/mkoeppe/sage/runs/3041607937

That log is from the configuration `homebrew-macos-python3_xcode-nokegonly`, which tests what happens without running `.homebrew-build-env` before the build...



---

archive/issue_events_420169.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-19T17:19:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420169"
}
```



---

archive/issue_events_420170.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-19T17:19:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420170"
}
```



---

archive/issue_comments_485844.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nlgtm",
    "created_at": "2021-07-19T17:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485844",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

lgtm



---

archive/issue_comments_485845.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726** to **Dima Pasechnik**",
    "created_at": "2021-07-19T17:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485845",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726** to **Dima Pasechnik**



---

archive/issue_comments_485846.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nThanks!",
    "created_at": "2021-07-19T19:36:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485846",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:56" align="right">comment:56</div>

Thanks!



---

archive/issue_events_420171.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T19:37:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420171"
}
```



---

archive/issue_events_420172.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T19:37:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420172"
}
```



---

archive/issue_events_420173.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-23T20:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420173"
}
```



---

archive/issue_events_420174.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bd6e0188b9e765073acb1218ca4b9086f6a4eed5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-23T20:11:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-420174"
}
```



---

archive/issue_comments_485847.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**",
    "created_at": "2021-07-23T20:11:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485847",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**



---

archive/issue_comments_485848.json:
```json
{
    "body": "Changed commit from **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)** to none",
    "created_at": "2021-08-07T11:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485848",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

Changed commit from **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)** to none



---

archive/issue_comments_485849.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nSage version 9.4.rc0 works for me with CUDA 11.2, compiled from git develop branch using Linux Debian testing (Bullseye).",
    "created_at": "2021-08-07T11:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-485849",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

<div id="comment:59" align="right">comment:59</div>

Sage version 9.4.rc0 works for me with CUDA 11.2, compiled from git develop branch using Linux Debian testing (Bullseye).
