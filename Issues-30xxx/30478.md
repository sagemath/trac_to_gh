# Issue 30478: Update suitesparse to 5.10.1 to fix build failure with cuda 11

archive/issues_030241.json:
```json
{
    "assignees": [],
    "body": "Sage 9.1 fails to build with cuda 11, as cuda 11 no longer supports the \"architecture\" compute_30.\n\nUpstream ticket: https://github.com/DrTimothyAldenDavis/SuiteSparse/issues/56\n\nA fix would be to remove compute_30 from the build commands.\n\nCC:  @kiwifb @embray @dimpase @orlitzky @kliem\n\nBranch: **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe, Fran\u00e7ois Bissey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30478_\n\n",
    "closed_at": "2021-07-23T20:11:54Z",
    "created_at": "2020-08-31T07:53:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update suitesparse to 5.10.1 to fix build failure with cuda 11",
    "type": "issue",
    "updated_at": "2021-08-07T11:46:13Z",
    "url": "https://github.com/sagemath/sage/issues/30478",
    "user": "https://github.com/sagetrac-johan"
}
```
Sage 9.1 fails to build with cuda 11, as cuda 11 no longer supports the "architecture" compute_30.

Upstream ticket: https://github.com/DrTimothyAldenDavis/SuiteSparse/issues/56

A fix would be to remove compute_30 from the build commands.

CC:  @kiwifb @embray @dimpase @orlitzky @kliem

Branch: **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe, François Bissey**

_Issue created by migration from https://trac.sagemath.org/ticket/30478_





---

archive/issue_events_388190.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388190"
}
```



---

archive/issue_events_388191.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388191"
}
```



---

archive/issue_events_388192.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388192"
}
```



---

archive/issue_events_388193.json:
```json
{
    "actor": "https://github.com/sagetrac-johan",
    "created_at": "2020-08-31T07:53:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388193"
}
```



---

archive/issue_comments_488679.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nHow to replicate the build failure?",
    "created_at": "2020-08-31T15:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488679",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'>Comment 1:</a>
How to replicate the build failure?



---

archive/issue_comments_488680.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nI am not sure what your environment is, but the following is the contents of a small dockerfile to replicate the build failure:\n\n```\nFROM nvidia/cuda:11.0-devel-ubuntu20.04\n\nSHELL [\"/bin/bash\", \"-c\"]\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install --yes build-essential m4 dpkg-dev gettext automake apt-utils git cmake pkg-config python\n\nRUN adduser user < /dev/null\n\nUSER user\nWORKDIR /home/user/\n\nRUN mkdir Sage && \\\n    git clone git://git.sagemath.org/sage.git Sage && \\\n    cd Sage && \\\n    git checkout 9.1\n\nRUN cd Sage && \\\n    make -j 4 |& tee build_log.txt || true\n```\n\n\nAfter the build, the file /home/user/Sage/logs/pkgs/suitesparse-5.6.0.log contains the following, near the end:\n\n```\n/usr/local/cuda/bin/nvcc -I../../AMD/Include -I../../AMD/Source -I../../COLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CCOLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CAMD/Include -I../Include -I../../SuiteSparse_config -I/usr/local/cuda/include/ -Xcompiler -fPIC -O3 -gencode=arch=compute_30,code=sm_30 -gencode=arch=compute_35,code=sm_35 -gencode=arch=compute_50,code=sm_50 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_60,code=compute_60 -c ../GPU/cholmod_gpu_kernels.cu\nnvcc fatal   : Unsupported gpu architecture 'compute_30'\n```\n\nMy GPU happens to support compute_60, but the build statement looks very generic, so I assume it might not even matter that I have a GPU, for the purposes of replicating the build failure.",
    "created_at": "2020-09-01T07:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488680",
    "user": "https://github.com/sagetrac-johan"
}
```

<a id='comment:2'>Comment 2:</a>
I am not sure what your environment is, but the following is the contents of a small dockerfile to replicate the build failure:

```
FROM nvidia/cuda:11.0-devel-ubuntu20.04

SHELL ["/bin/bash", "-c"]

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get install --yes build-essential m4 dpkg-dev gettext automake apt-utils git cmake pkg-config python

RUN adduser user < /dev/null

USER user
WORKDIR /home/user/

RUN mkdir Sage && \
    git clone git://git.sagemath.org/sage.git Sage && \
    cd Sage && \
    git checkout 9.1

RUN cd Sage && \
    make -j 4 |& tee build_log.txt || true
```


After the build, the file /home/user/Sage/logs/pkgs/suitesparse-5.6.0.log contains the following, near the end:

```
/usr/local/cuda/bin/nvcc -I../../AMD/Include -I../../AMD/Source -I../../COLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CCOLAMD/Include -I/home/user/Sage/local/var/tmp/sage/build/suitesparse-5.6.0/src/CAMD/Include -I../Include -I../../SuiteSparse_config -I/usr/local/cuda/include/ -Xcompiler -fPIC -O3 -gencode=arch=compute_30,code=sm_30 -gencode=arch=compute_35,code=sm_35 -gencode=arch=compute_50,code=sm_50 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_53,code=sm_53 -gencode=arch=compute_60,code=compute_60 -c ../GPU/cholmod_gpu_kernels.cu
nvcc fatal   : Unsupported gpu architecture 'compute_30'
```

My GPU happens to support compute_60, but the build statement looks very generic, so I assume it might not even matter that I have a GPU, for the purposes of replicating the build failure.



---

archive/issue_comments_488681.json:
```json
{
    "body": "Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**",
    "created_at": "2020-09-01T17:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488681",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**



---

archive/issue_comments_488682.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.",
    "created_at": "2020-09-01T17:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488682",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>Comment 4:</a>
I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.



---

archive/issue_comments_488683.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to none",
    "created_at": "2020-09-01T17:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488683",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to none



---

archive/issue_comments_488684.json:
```json
{
    "body": "Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**",
    "created_at": "2020-09-01T17:35:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488684",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)**



---

archive/issue_comments_488685.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084\">40a47b4</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr></table>\n",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488685",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'>Comment 6:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084">40a47b4</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr></table>




---

archive/issue_comments_488686.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488686",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_488687.json:
```json
{
    "body": "Commit: **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)**",
    "created_at": "2020-09-01T17:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488687",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)**



---

archive/issue_comments_488688.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nSomeone should prepare a pull request for upstream.",
    "created_at": "2020-09-01T18:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488688",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>Comment 7:</a>
Someone should prepare a pull request for upstream.



---

archive/issue_comments_488689.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThere was a new commit to upstream pushed to github yesterday, and it seems to have removed references to compute_30 from the build files.\n\nNew contents in the file named \"ChangeLog\" in the commit:\n\n May 17, 2021, SuiteSparse 5.10.1\n\n* CUDA: remove sm_30 from SuiteSparse_config.mk\n* GraphBLAS v5.0.5: minor bug fix\n* minor changes to Makefiles\n\n\nA rebuild of Sage with SuiteSparse version 5.10.1, or with its master branch (which is currently probably the same), would be interesting.",
    "created_at": "2021-05-19T13:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488689",
    "user": "https://github.com/sagetrac-johan"
}
```

<a id='comment:8'>Comment 8:</a>
There was a new commit to upstream pushed to github yesterday, and it seems to have removed references to compute_30 from the build files.

New contents in the file named "ChangeLog" in the commit:

 May 17, 2021, SuiteSparse 5.10.1

* CUDA: remove sm_30 from SuiteSparse_config.mk
* GraphBLAS v5.0.5: minor bug fix
* minor changes to Makefiles


A rebuild of Sage with SuiteSparse version 5.10.1, or with its master branch (which is currently probably the same), would be interesting.



---

archive/issue_events_388194.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-19T15:21:20Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "title_is": "Update suitesparse to 5.10.1 to fix build failure with cuda 11",
    "title_was": "Suitesparse build failure with cuda 11. (sage 9.1)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388194"
}
```



---

archive/issue_comments_488690.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nLooks like we have to wait for an actual release - https://github.com/DrTimothyAldenDavis/SuiteSparse/releases is still at 5.10.0",
    "created_at": "2021-05-19T15:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488690",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'>Comment 10:</a>
Looks like we have to wait for an actual release - https://github.com/DrTimothyAldenDavis/SuiteSparse/releases is still at 5.10.0



---

archive/issue_comments_488691.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2021-05-19T15:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488691",
    "user": "https://github.com/mkoeppe"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_events_388195.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-19T15:25:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388195"
}
```



---

archive/issue_comments_488692.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThe upstream github page your refer to now says that 5.10.1 was released 10 hours ago.",
    "created_at": "2021-05-25T09:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488692",
    "user": "https://github.com/sagetrac-johan"
}
```

<a id='comment:12'>Comment 12:</a>
The upstream github page your refer to now says that 5.10.1 was released 10 hours ago.



---

archive/issue_comments_488693.json:
```json
{
    "body": "Changed commit from **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)** to **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)**",
    "created_at": "2021-05-25T16:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488693",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[40a47b4](https://github.com/sagemath/sagetrac-mirror/commit/40a47b401a5a0b672d06d5f4b4486ef341b8e084)** to **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)**



---

archive/issue_comments_488694.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52c250565b372a9de0ee49444dc5361f1eb4df09\">52c2505</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a\">975ff86</a></td><td><code>build/pkgs/suitesparse: Update to 5.10.1</code></td></tr></table>\n",
    "created_at": "2021-05-25T16:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488694",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52c250565b372a9de0ee49444dc5361f1eb4df09">52c2505</a></td><td><code>tox.ini: Add nvidia-cuda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a">975ff86</a></td><td><code>build/pkgs/suitesparse: Update to 5.10.1</code></td></tr></table>




---

archive/issue_comments_488695.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nPatches need to be updated or removed.",
    "created_at": "2021-05-25T16:35:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488695",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>Comment 14:</a>
Patches need to be updated or removed.



---

archive/issue_comments_488696.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI will try to have a look today.",
    "created_at": "2021-05-25T19:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488696",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'>Comment 15:</a>
I will try to have a look today.



---

archive/issue_comments_488697.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI have cuda 11.2 on Debian Testing (Bullseye) and I can no longer build Sage 9.3 or Sage develop branch from git. I get the error reported here: \"nvcc fatal   : Unsupported gpu architecture 'compute_30' \"\n\n[Johan writes]: \"A fix would be to remove compute_30 from the build commands.\"\n\nHow can I temporarily patch Sage develop code to remove compute_30? \n\nWhat I want to do is: \n\n1) pull the latest git source code from develop branch.\n\n2) patch my locally cloned and checked out git develop code, removing compute_30 (I do not need it).\n\n3) ./configure and make to get a working sage again.",
    "created_at": "2021-06-01T16:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488697",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

<a id='comment:17'>Comment 17:</a>
I have cuda 11.2 on Debian Testing (Bullseye) and I can no longer build Sage 9.3 or Sage develop branch from git. I get the error reported here: "nvcc fatal   : Unsupported gpu architecture 'compute_30' "

[Johan writes]: "A fix would be to remove compute_30 from the build commands."

How can I temporarily patch Sage develop code to remove compute_30? 

What I want to do is: 

1) pull the latest git source code from develop branch.

2) patch my locally cloned and checked out git develop code, removing compute_30 (I do not need it).

3) ./configure and make to get a working sage again.



---

archive/issue_comments_488698.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488698",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse_build_failure_with_cuda_11___sage_9_1_)** to **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)**



---

archive/issue_comments_488699.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nAt long last I fixed the patches to work with this version of suitesparse. Works on local linux box but OS X and windows need to be checked to see if new work is needed on those.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367\">32f9966</a></td><td><code>update the patches for 5.10.1</code></td></tr></table>\n",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488699",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'>Comment 18:</a>
At long last I fixed the patches to work with this version of suitesparse. Works on local linux box but OS X and windows need to be checked to see if new work is needed on those.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367">32f9966</a></td><td><code>update the patches for 5.10.1</code></td></tr></table>




---

archive/issue_comments_488700.json:
```json
{
    "body": "Changed commit from **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)** to **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488700",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[975ff86](https://github.com/sagemath/sagetrac-mirror/commit/975ff8659afdb7ac5d30c377391396685ab8c67a)** to **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)**



---

archive/issue_comments_488701.json:
```json
{
    "body": "Changed author from **Matthias Koeppe** to **Matthias Koeppe, Fran\u00e7ois Bissey**",
    "created_at": "2021-06-08T01:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488701",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Matthias Koeppe** to **Matthias Koeppe, François Bissey**



---

archive/issue_events_388196.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-08T01:32:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388196"
}
```



---

archive/issue_comments_488702.json:
```json
{
    "body": "Reviewer: **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968**",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488702",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968**



---

archive/issue_comments_488703.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488703",
    "user": "https://github.com/mkoeppe"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_488704.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@mkoeppe](#comment%3A4):\n> I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.\n\nWith this branch, this now succeeds.\n\nRunning it on GH Actions now",
    "created_at": "2021-06-08T05:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488704",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@mkoeppe](#comment%3A4):
> I was able to replicate the build error using `tox -e docker-ubuntu-focal-nvidia-cuda-11.0-standard -- suitesparse`.

With this branch, this now succeeds.

Running it on GH Actions now



---

archive/issue_events_388197.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-19T18:30:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388197"
}
```



---

archive/issue_events_388198.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-19T18:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388198"
}
```



---

archive/issue_comments_488705.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nOn `ubuntu-trusty-standard` (https://github.com/mkoeppe/sage/runs/2770535461?check_suite_focus=true) and similar:\n\n```\n  [suitesparse-5.10.1]   gcc -O2 -g    -O3 -fexceptions -fPIC -fopenmp -I../Include -I../../COLAMD/Include -I../../AMD/Include -I../../SuiteSparse_config  -c ../Source/slip_create_mpfr_array.c\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c: In function 'slip_create_mpfr_array':\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: error: 'for' loop initial declarations are only allowed in C99 mode\n  [suitesparse-5.10.1]        for (int64_t i = 0; i < n; i++)\n  [suitesparse-5.10.1]        ^\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: note: use option -std=c99 or -std=gnu99 to compile your code\n  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:39:13: error: 'for' loop initial declarations are only allowed in C99 mode\n  [suitesparse-5.10.1]                for (int64_t j = 0; j < n; j++)\n  [suitesparse-5.10.1]                ^\n  [suitesparse-5.10.1]   make[8]: *** [slip_create_mpfr_array.o] Error 1\n```",
    "created_at": "2021-06-19T18:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488705",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'>Comment 20:</a>
On `ubuntu-trusty-standard` (https://github.com/mkoeppe/sage/runs/2770535461?check_suite_focus=true) and similar:

```
  [suitesparse-5.10.1]   gcc -O2 -g    -O3 -fexceptions -fPIC -fopenmp -I../Include -I../../COLAMD/Include -I../../AMD/Include -I../../SuiteSparse_config  -c ../Source/slip_create_mpfr_array.c
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c: In function 'slip_create_mpfr_array':
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: error: 'for' loop initial declarations are only allowed in C99 mode
  [suitesparse-5.10.1]        for (int64_t i = 0; i < n; i++)
  [suitesparse-5.10.1]        ^
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:34:5: note: use option -std=c99 or -std=gnu99 to compile your code
  [suitesparse-5.10.1]   ../Source/slip_create_mpfr_array.c:39:13: error: 'for' loop initial declarations are only allowed in C99 mode
  [suitesparse-5.10.1]                for (int64_t j = 0; j < n; j++)
  [suitesparse-5.10.1]                ^
  [suitesparse-5.10.1]   make[8]: *** [slip_create_mpfr_array.o] Error 1
```



---

archive/issue_comments_488706.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nOn `cygwin-standard` (https://github.com/mkoeppe/sage/runs/2771235514?check_suite_focus=true)\n\n```\n( cd /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib ; ln -sf cyglibsliplu-1.dll  )\nln: 'cyglibsliplu-1.dll' and './cyglibsliplu-1.dll' are the same file\nmake[6]: *** [Makefile:73: /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib/cyglibsliplu-1.dll] Error 1\n```",
    "created_at": "2021-06-19T18:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488706",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>Comment 21:</a>
On `cygwin-standard` (https://github.com/mkoeppe/sage/runs/2771235514?check_suite_focus=true)

```
( cd /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib ; ln -sf cyglibsliplu-1.dll  )
ln: 'cyglibsliplu-1.dll' and './cyglibsliplu-1.dll' are the same file
make[6]: *** [Makefile:73: /opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/inst/opt/sage-c532fcc49d77cd3e9b397ae3e38102498967c798/var/tmp/sage/build/suitesparse-5.10.1/src/lib/cyglibsliplu-1.dll] Error 1
```



---

archive/issue_comments_488707.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n@kiwifb - do you have a repo from which you generated the updated patches?",
    "created_at": "2021-06-19T20:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488707",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>Comment 22:</a>
@kiwifb - do you have a repo from which you generated the updated patches?



---

archive/issue_comments_488708.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [@mkoeppe](#comment%3A22):\n> @kiwifb - do you have a repo from which you generated the updated patches?\n\nNo. Not those. Gentoo has historically split suitesparse, and I have somewhat inherited that effort lately. **It is not a winning strategy so far**. Upstream has somewhat inconsistent upkeep of the versioning of the sub-packages and has done source changes without version bump of the sub-package concerned (because of minor mistake in the original release). I also inherited broken GPU support in cholmod that I haven't ever found the time to fix.\n\nThe failure on ubuntu trusty is probably because gcc does not default to C99, that can be fixed but do we really want to continue supporting 14.04?\n\nI have had no hand in writing the original cygwin patch. Someone familiar with it should inspect it.\nThe updated patch is strictly an update on the sage patches I and other wrote over the years.",
    "created_at": "2021-06-19T21:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488708",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [@mkoeppe](#comment%3A22):
> @kiwifb - do you have a repo from which you generated the updated patches?

No. Not those. Gentoo has historically split suitesparse, and I have somewhat inherited that effort lately. **It is not a winning strategy so far**. Upstream has somewhat inconsistent upkeep of the versioning of the sub-packages and has done source changes without version bump of the sub-package concerned (because of minor mistake in the original release). I also inherited broken GPU support in cholmod that I haven't ever found the time to fix.

The failure on ubuntu trusty is probably because gcc does not default to C99, that can be fixed but do we really want to continue supporting 14.04?

I have had no hand in writing the original cygwin patch. Someone familiar with it should inspect it.
The updated patch is strictly an update on the sage patches I and other wrote over the years.



---

archive/issue_comments_488709.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nI see why cygwin failed, there is a new sub-package SLIP_LU that didn't exist before so it isn't patched. It is not used by anything so we could just skip it for now.",
    "created_at": "2021-06-19T21:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488709",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:24'>Comment 24:</a>
I see why cygwin failed, there is a new sub-package SLIP_LU that didn't exist before so it isn't patched. It is not used by anything so we could just skip it for now.



---

archive/issue_comments_488710.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nReplying to [@kiwifb](#comment%3A23):\n> do we really want to continue supporting 14.04?\n\nYes, I think we still need to support it (and similar systems) for a while - see #31526",
    "created_at": "2021-06-19T21:35:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488710",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'>Comment 25:</a>
Replying to [@kiwifb](#comment%3A23):
> do we really want to continue supporting 14.04?

Yes, I think we still need to support it (and similar systems) for a while - see #31526



---

archive/issue_comments_488711.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nReplying to [@mkoeppe](#comment%3A25):\n> Replying to [@kiwifb](#comment%3A23):\n> > do we really want to continue supporting 14.04?\n\n> \n> Yes, I think we still need to support it (and similar systems) for a while - see #31526\n\nOK, sage should set up a C99 compiler, I just have to pass it. I think I may be able to ape the cygwin stuff (cross fingers).",
    "created_at": "2021-06-19T21:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488711",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'>Comment 26:</a>
Replying to [@mkoeppe](#comment%3A25):
> Replying to [@kiwifb](#comment%3A23):
> > do we really want to continue supporting 14.04?

> 
> Yes, I think we still need to support it (and similar systems) for a while - see #31526

OK, sage should set up a C99 compiler, I just have to pass it. I think I may be able to ape the cygwin stuff (cross fingers).



---

archive/issue_comments_488712.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nI've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true",
    "created_at": "2021-06-19T22:41:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488712",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'>Comment 27:</a>
I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true



---

archive/issue_comments_488713.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nReplying to [@mkoeppe](#comment%3A27):\n> I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true\n\nThis is most curious. Patch says the top Makefile is not found. Either you are not in right directory or something is cleaning it after the checkout.",
    "created_at": "2021-06-20T01:18:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488713",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'>Comment 28:</a>
Replying to [@mkoeppe](#comment%3A27):
> I've create a GH Actions workflow for SuiteSparse https://github.com/mkoeppe/SuiteSparse/blob/master/.github/workflows/ci-sage.yml but our patches do not seem to apply to suitesparse `master` - https://github.com/mkoeppe/SuiteSparse/runs/2866504038?check_suite_focus=true

This is most curious. Patch says the top Makefile is not found. Either you are not in right directory or something is cleaning it after the checkout.



---

archive/issue_comments_488714.json:
```json
{
    "body": "Changed commit from **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)** to **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)**",
    "created_at": "2021-06-20T01:24:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488714",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[32f9966](https://github.com/sagemath/sagetrac-mirror/commit/32f9966a2bcb029727ff4f1f51c6b945fbeac367)** to **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)**



---

archive/issue_comments_488715.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b2558372686609cc7f57ccfb0acba428f76adf6\">9b25583</a></td><td><code>update cygwin patch to include SLIP_LU</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0\">0b51340</a></td><td><code>Make sure C99 is used</code></td></tr></table>\n",
    "created_at": "2021-06-20T01:24:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488715",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>Comment 29:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b2558372686609cc7f57ccfb0acba428f76adf6">9b25583</a></td><td><code>update cygwin patch to include SLIP_LU</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0">0b51340</a></td><td><code>Make sure C99 is used</code></td></tr></table>




---

archive/issue_events_388199.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-20T01:27:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388199"
}
```



---

archive/issue_events_388200.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-20T01:27:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388200"
}
```



---

archive/issue_comments_488716.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nOk, this should take care of the two issues spotted in the review workflow. Patching for C99 may be heavy handed, it could be passed to Make.",
    "created_at": "2021-06-20T01:27:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488716",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:30'>Comment 30:</a>
Ok, this should take care of the two issues spotted in the review workflow. Patching for C99 may be heavy handed, it could be passed to Make.



---

archive/issue_comments_488717.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nReplying to [@kiwifb](#comment%3A28):\n> Replying to [@mkoeppe](#comment%3A27):\n> > our patches do not seem to apply to suitesparse `master`\n\n> \n> This is most curious. Patch says the top Makefile is not found. \n\nSorry for the noise - this was just a stupid mistake in my script",
    "created_at": "2021-06-20T05:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488717",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'>Comment 31:</a>
Replying to [@kiwifb](#comment%3A28):
> Replying to [@mkoeppe](#comment%3A27):
> > our patches do not seem to apply to suitesparse `master`

> 
> This is most curious. Patch says the top Makefile is not found. 

Sorry for the noise - this was just a stupid mistake in my script



---

archive/issue_comments_488718.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968** to **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786**",
    "created_at": "2021-06-20T05:42:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488718",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/917160969, https://github.com/mkoeppe/sage/actions/runs/917160968** to **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786**



---

archive/issue_comments_488719.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nUsing suitesparse master, with my corrected workflow run, I see on `debian-stretch-standard` in https://github.com/mkoeppe/SuiteSparse/runs/2867609846?check_suite_focus=true:\n\n```\n  [suitesparse-git]   ranlib libsliplu.a\n  [suitesparse-git]   SLIP_gmp.o: In function `SLIP_mpfr_get_q':\n  [suitesparse-git]   /sage/local/var/tmp/sage/build/suitesparse-git/src/SLIP_LU/Lib/../Source/SLIP_gmp.c:1526: undefined reference to `mpfr_get_q'\n  [suitesparse-git]   collect2: error: ld returned 1 exit status\n  [suitesparse-git]   Makefile:69: recipe for target '/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2' failed\n  [suitesparse-git]   make[6]: *** [/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2] Error 1\n  [suitesparse-git]   make[6]: Target 'install' not remade because of errors.\n```\nLooks like we are missing some dependencies.\n(I don't know yet if this also affects the release that we are using.)",
    "created_at": "2021-06-20T05:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488719",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'>Comment 33:</a>
Using suitesparse master, with my corrected workflow run, I see on `debian-stretch-standard` in https://github.com/mkoeppe/SuiteSparse/runs/2867609846?check_suite_focus=true:

```
  [suitesparse-git]   ranlib libsliplu.a
  [suitesparse-git]   SLIP_gmp.o: In function `SLIP_mpfr_get_q':
  [suitesparse-git]   /sage/local/var/tmp/sage/build/suitesparse-git/src/SLIP_LU/Lib/../Source/SLIP_gmp.c:1526: undefined reference to `mpfr_get_q'
  [suitesparse-git]   collect2: error: ld returned 1 exit status
  [suitesparse-git]   Makefile:69: recipe for target '/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2' failed
  [suitesparse-git]   make[6]: *** [/sage/local/var/tmp/sage/build/suitesparse-git/inst/sage/local/var/tmp/sage/build/suitesparse-git/src/lib/libsliplu.so.1.0.2] Error 1
  [suitesparse-git]   make[6]: Target 'install' not remade because of errors.
```
Looks like we are missing some dependencies.
(I don't know yet if this also affects the release that we are using.)



---

archive/issue_comments_488720.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nIn `SLIP_LU/Lib/Makefile` one can see that it needs `mpfr` and `gmp`",
    "created_at": "2021-06-20T06:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488720",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'>Comment 34:</a>
In `SLIP_LU/Lib/Makefile` one can see that it needs `mpfr` and `gmp`



---

archive/issue_comments_488721.json:
```json
{
    "body": "Changed branch from **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)** to **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)**",
    "created_at": "2021-06-20T06:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488721",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/fbissey/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/suitesparse-5.10.1)** to **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)**



---

archive/issue_comments_488722.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786** to **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334**",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488722",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953848774, https://github.com/mkoeppe/sage/actions/runs/953848786** to **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334**



---

archive/issue_comments_488723.json:
```json
{
    "body": "Changed commit from **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)** to **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)**",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488723",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[0b51340](https://github.com/sagemath/sagetrac-mirror/commit/0b51340f704eef2992641b1c3dbcf76f36a76eb0)** to **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)**



---

archive/issue_comments_488724.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f\">7fa5381</a></td><td><code>build/pkgs/suitesparse/dependencies: Add mpfr, $(MP_LIBRARY) for SLIP_LU</code></td></tr></table>\n",
    "created_at": "2021-06-20T06:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488724",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'>Comment 36:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f">7fa5381</a></td><td><code>build/pkgs/suitesparse/dependencies: Add mpfr, $(MP_LIBRARY) for SLIP_LU</code></td></tr></table>




---

archive/issue_comments_488725.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nUpstream PR adding the ci-sage workflow at: https://github.com/DrTimothyAldenDavis/SuiteSparse/pull/95",
    "created_at": "2021-06-20T06:33:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488725",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'>Comment 37:</a>
Upstream PR adding the ci-sage workflow at: https://github.com/DrTimothyAldenDavis/SuiteSparse/pull/95



---

archive/issue_comments_488726.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nI totally missed that dependency. It didn't connect in my head that suitesparse didn't depend on those so far. Good catch from those workflows.",
    "created_at": "2021-06-20T08:14:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488726",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:38'>Comment 38:</a>
I totally missed that dependency. It didn't connect in my head that suitesparse didn't depend on those so far. Good catch from those workflows.



---

archive/issue_comments_488727.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74\">8d62aae</a></td><td><code>Merge tag '9.4.beta2' into t/30478/suitesparse-5.10.1</code></td></tr></table>\n",
    "created_at": "2021-06-20T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488727",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74">8d62aae</a></td><td><code>Merge tag '9.4.beta2' into t/30478/suitesparse-5.10.1</code></td></tr></table>




---

archive/issue_comments_488728.json:
```json
{
    "body": "Changed commit from **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)** to **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)**",
    "created_at": "2021-06-20T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488728",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7fa5381](https://github.com/sagemath/sagetrac-mirror/commit/7fa53817e5aa1d3e13e6cf32dec056541ce6af9f)** to **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)**



---

archive/issue_comments_488729.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334** to **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657**",
    "created_at": "2021-06-20T20:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488729",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/953899332, https://github.com/mkoeppe/sage/actions/runs/953899334** to **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657**



---

archive/issue_comments_488730.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nAnother round of testing on top of the current beta",
    "created_at": "2021-06-20T20:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488730",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'>Comment 40:</a>
Another round of testing on top of the current beta



---

archive/issue_events_388201.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T16:29:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388201"
}
```



---

archive/issue_events_388202.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T16:29:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388202"
}
```



---

archive/issue_comments_488731.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nOn `macos-homebrew-minimal-default-11.0` (https://github.com/mkoeppe/sage/runs/2870369436?check_suite_focus=true):\n\n```\n  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_type.cpp\n  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'\n  [suitesparse-5.10.1]   make[7]: *** [spqr_type.o] Error 1\n  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_tol.cpp\n  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'\n  [suitesparse-5.10.1]   make[7]: *** [spqr_tol.o] Error 1\n```",
    "created_at": "2021-07-11T16:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488731",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'>Comment 41:</a>
On `macos-homebrew-minimal-default-11.0` (https://github.com/mkoeppe/sage/runs/2870369436?check_suite_focus=true):

```
  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_type.cpp
  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'
  [suitesparse-5.10.1]   make[7]: *** [spqr_type.o] Error 1
  [suitesparse-5.10.1]   g++ -std=gnu++11 -std=c99 -O2 -g -march=native   -O3 -fexceptions -fPIC -fno-common   -DNPARTITION -DNPARTITION -I../../CHOLMOD/Include -I../../SuiteSparse_config -I../Include -c ../Source/spqr_tol.cpp
  [suitesparse-5.10.1]   error: invalid argument '-std=c99' not allowed with 'C++'
  [suitesparse-5.10.1]   make[7]: *** [spqr_tol.o] Error 1
```



---

archive/issue_comments_488732.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88e7d95ddd4e7a640f8c9077977478fbce51d98b\">88e7d95</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Stop suitesparse from using -std=c99 with C++ compilers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529\">5d26de7</a></td><td><code>Merge tag '9.4.beta4' into t/30478/suitesparse-5.10.1</code></td></tr></table>\n",
    "created_at": "2021-07-11T17:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488732",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:42'>Comment 42:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88e7d95ddd4e7a640f8c9077977478fbce51d98b">88e7d95</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Stop suitesparse from using -std=c99 with C++ compilers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529">5d26de7</a></td><td><code>Merge tag '9.4.beta4' into t/30478/suitesparse-5.10.1</code></td></tr></table>




---

archive/issue_comments_488733.json:
```json
{
    "body": "Changed commit from **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)** to **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)**",
    "created_at": "2021-07-11T17:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488733",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8d62aae](https://github.com/sagemath/sagetrac-mirror/commit/8d62aaee76f26be3ef12350409e5dbf2cf222c74)** to **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)**



---

archive/issue_events_388203.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:53:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388203"
}
```



---

archive/issue_events_388204.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:53:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388204"
}
```



---

archive/issue_comments_488734.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nOK c99 is an own goal. I enabled it that way because it was required for some of the libraries. So a better approach may be to remove the patch `05-c99.patch` and to set `CC=\"$CC -std-c99\"`.",
    "created_at": "2021-07-11T19:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488734",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:45'>Comment 45:</a>
OK c99 is an own goal. I enabled it that way because it was required for some of the libraries. So a better approach may be to remove the patch `05-c99.patch` and to set `CC="$CC -std-c99"`.



---

archive/issue_comments_488735.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nOK c99 was needed for ubuntu 14.04 not some libraries.",
    "created_at": "2021-07-11T19:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488735",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:46'>Comment 46:</a>
OK c99 was needed for ubuntu 14.04 not some libraries.



---

archive/issue_comments_488736.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nHa, this explains why I didn't find the c99 stuff in upstream github...",
    "created_at": "2021-07-11T20:03:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488736",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'>Comment 47:</a>
Ha, this explains why I didn't find the c99 stuff in upstream github...



---

archive/issue_comments_488737.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51b3c8b31d137f8535bbbb34e6cadf6587942dbe\">51b3c8b</a></td><td><code>Revert \"Make sure C99 is used\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603\">f2d21ed</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Put -std=c99 in CC (not CF)</code></td></tr></table>\n",
    "created_at": "2021-07-11T20:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488737",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:48'>Comment 48:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51b3c8b31d137f8535bbbb34e6cadf6587942dbe">51b3c8b</a></td><td><code>Revert "Make sure C99 is used"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603">f2d21ed</a></td><td><code>build/pkgs/suitesparse/spkg-install.in: Put -std=c99 in CC (not CF)</code></td></tr></table>




---

archive/issue_comments_488738.json:
```json
{
    "body": "Changed commit from **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**",
    "created_at": "2021-07-11T20:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488738",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5d26de7](https://github.com/sagemath/sagetrac-mirror/commit/5d26de79a98460653935a9b00e9224be5943a529)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**



---

archive/issue_comments_488739.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nOK, this works on `local-homebrew-macos-minimal`.",
    "created_at": "2021-07-11T20:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488739",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'>Comment 49:</a>
OK, this works on `local-homebrew-macos-minimal`.



---

archive/issue_comments_488740.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657** to **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726**",
    "created_at": "2021-07-11T20:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488740",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/955127652, https://github.com/mkoeppe/sage/actions/runs/955127657** to **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726**



---

archive/issue_comments_488741.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nthere are some weird \"unable to build wheels\" messages, e.g.\n\n```\n [fpylll-0.5.6]   Failed to build fpylll\n2843\n  [fpylll-0.5.6]   ERROR: Failed to build one or more wheels\n```\nin https://github.com/mkoeppe/sage/runs/3041607937",
    "created_at": "2021-07-18T08:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488741",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'>Comment 51:</a>
there are some weird "unable to build wheels" messages, e.g.

```
 [fpylll-0.5.6]   Failed to build fpylll
2843
  [fpylll-0.5.6]   ERROR: Failed to build one or more wheels
```
in https://github.com/mkoeppe/sage/runs/3041607937



---

archive/issue_comments_488742.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nand on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:\n\n```\n[pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'\n```",
    "created_at": "2021-07-18T08:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488742",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:52'>Comment 52:</a>
and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:

```
[pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'
```



---

archive/issue_comments_488743.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nReplying to [@dimpase](#comment%3A52):\n> and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:\n> \n> ```\n> [pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'\n> ```\n\nThat's already broken in 9.4.beta4, see #32001",
    "created_at": "2021-07-18T17:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488743",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'>Comment 53:</a>
Replying to [@dimpase](#comment%3A52):
> and on cygwin (https://github.com/mkoeppe/sage/actions/runs/1020782726) it fails in pynac:
> 
> ```
> [pynac-0.7.29]   /opt/sage-eabc953c0be7b71fd331c182a8fb31b31c3310b0/var/tmp/sage/build/pynac-0.7.29/src/ginac/mpoly-singular.cpp:92: undefined reference to `operator-(CanonicalForm const&)'
> ```

That's already broken in 9.4.beta4, see #32001



---

archive/issue_comments_488744.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nReplying to [@dimpase](#comment%3A51):\n> there are some weird \"unable to build wheels\" messages, e.g.\n> \n> ```\n>  [fpylll-0.5.6]   Failed to build fpylll\n> 2843\n>   [fpylll-0.5.6]   ERROR: Failed to build one or more wheels\n> ```\n> in https://github.com/mkoeppe/sage/runs/3041607937\n\nThat log is from the configuration `homebrew-macos-python3_xcode-nokegonly`, which tests what happens without running `.homebrew-build-env` before the build...",
    "created_at": "2021-07-18T17:23:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488744",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'>Comment 54:</a>
Replying to [@dimpase](#comment%3A51):
> there are some weird "unable to build wheels" messages, e.g.
> 
> ```
>  [fpylll-0.5.6]   Failed to build fpylll
> 2843
>   [fpylll-0.5.6]   ERROR: Failed to build one or more wheels
> ```
> in https://github.com/mkoeppe/sage/runs/3041607937

That log is from the configuration `homebrew-macos-python3_xcode-nokegonly`, which tests what happens without running `.homebrew-build-env` before the build...



---

archive/issue_events_388205.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-19T17:19:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388205"
}
```



---

archive/issue_events_388206.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-19T17:19:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388206"
}
```



---

archive/issue_comments_488745.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nlgtm",
    "created_at": "2021-07-19T17:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488745",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'>Comment 55:</a>
lgtm



---

archive/issue_comments_488746.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726** to **Dima Pasechnik**",
    "created_at": "2021-07-19T17:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488746",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/1020782720, https://github.com/mkoeppe/sage/actions/runs/1020782726** to **Dima Pasechnik**



---

archive/issue_comments_488747.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nThanks!",
    "created_at": "2021-07-19T19:36:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488747",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:56'>Comment 56:</a>
Thanks!



---

archive/issue_events_388207.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T19:37:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388207"
}
```



---

archive/issue_events_388208.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T19:37:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388208"
}
```



---

archive/issue_events_388209.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-23T20:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388209"
}
```



---

archive/issue_events_388210.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bd6e0188b9e765073acb1218ca4b9086f6a4eed5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-23T20:11:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30478#event-388210"
}
```



---

archive/issue_comments_488748.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**",
    "created_at": "2021-07-23T20:11:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488748",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/suitesparse-5.10.1](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/suitesparse-5.10.1)** to **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)**



---

archive/issue_comments_488749.json:
```json
{
    "body": "Changed commit from **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)** to none",
    "created_at": "2021-08-07T11:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488749",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

Changed commit from **[f2d21ed](https://github.com/sagemath/sagetrac-mirror/commit/f2d21ed02f001674c5e168af2741056b029b6603)** to none



---

archive/issue_comments_488750.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nSage version 9.4.rc0 works for me with CUDA 11.2, compiled from git develop branch using Linux Debian testing (Bullseye).",
    "created_at": "2021-08-07T11:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30478#issuecomment-488750",
    "user": "https://github.com/KarlMagnusLarsson"
}
```

<a id='comment:59'>Comment 59:</a>
Sage version 9.4.rc0 works for me with CUDA 11.2, compiled from git develop branch using Linux Debian testing (Bullseye).
