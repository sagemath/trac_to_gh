# Issue 30062: Rename MetricSpaces parent method metric to metric_function, add EuclideanSpace to category of metric spaces

archive/issues_029825.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: from sage.categories.metric_spaces import MetricSpaces\nsage: QQ in MetricSpaces()\nTrue\nsage: RR in MetricSpaces()\nTrue\nsage: ZZ in MetricSpaces()\nTrue\nsage: AA in MetricSpaces()\nFalse\nsage: QuadraticField(5) in MetricSpaces()\nFalse\nsage: M = Matrix(QQ,[[2,1,0],[1,2,1],[0,1,2]])\nsage: V = VectorSpace(QQ,3,inner_product_matrix=M)\nsage: V in MetricSpaces()\nFalse\nsage: E = EuclideanSpace(3)\nsage: E in MetricSpaces()\nFalse\n```\n\nOn this ticket, we add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) to the category.\n\nTo do this, we rename the `MetricSpaces` parent method `metric` to `metric_function`.\n\nThe other examples from above will be taken care of in #30092 (which adds inner product spaces) and #30219 (real embedded number fields).\n\n\n\n\nCC:  @tscrim @egourgoulhon\n\nBranch/Commit: **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**\n\nReviewer: **Matthias Koeppe, Travis Scrimshaw**\n\nAuthor: **Eric Gourgoulhon, Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30062_\n\n",
    "closed_at": "2020-08-02T08:20:40Z",
    "created_at": "2020-07-04T06:35:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20categories",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Rename MetricSpaces parent method metric to metric_function, add EuclideanSpace to category of metric spaces",
    "type": "issue",
    "updated_at": "2020-08-02T08:20:40Z",
    "url": "https://github.com/sagemath/sage/issues/30062",
    "user": "https://github.com/mkoeppe"
}
```

```
sage: from sage.categories.metric_spaces import MetricSpaces
sage: QQ in MetricSpaces()
True
sage: RR in MetricSpaces()
True
sage: ZZ in MetricSpaces()
True
sage: AA in MetricSpaces()
False
sage: QuadraticField(5) in MetricSpaces()
False
sage: M = Matrix(QQ,[[2,1,0],[1,2,1],[0,1,2]])
sage: V = VectorSpace(QQ,3,inner_product_matrix=M)
sage: V in MetricSpaces()
False
sage: E = EuclideanSpace(3)
sage: E in MetricSpaces()
False
```

On this ticket, we add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) to the category.

To do this, we rename the `MetricSpaces` parent method `metric` to `metric_function`.

The other examples from above will be taken care of in #30092 (which adds inner product spaces) and #30219 (real embedded number fields).




CC:  @tscrim @egourgoulhon

Branch/Commit: **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**

Reviewer: **Matthias Koeppe, Travis Scrimshaw**

Author: **Eric Gourgoulhon, Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/30062_





---

archive/issue_events_395697.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T06:35:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395697"
}
```



---

archive/issue_events_395698.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T06:35:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20categories",
    "label_color": "0000ff",
    "label_name": "component: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395698"
}
```



---

archive/issue_events_395699.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T06:35:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395699"
}
```



---

archive/issue_events_395700.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T06:35:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395700"
}
```



---

archive/issue_comments_478828.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,5 @@\n sage: V in MetricSpaces()\n ```\n \n+also add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) and possibly other manifold classes.\n+\n``````\n",
    "created_at": "2020-07-08T22:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478828",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,5 @@
 sage: V in MetricSpaces()
 ```
 
+also add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) and possibly other manifold classes.
+
``````




---

archive/issue_comments_478829.json:
```json
{
    "body": "Branch: **[public/manifolds/euclidean_metric_space](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/euclidean_metric_space)**",
    "created_at": "2020-07-11T15:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478829",
    "user": "https://github.com/egourgoulhon"
}
```

Branch: **[public/manifolds/euclidean_metric_space](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/euclidean_metric_space)**



---

archive/issue_comments_478830.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4\">1f4f942</a></td><td><code>Provide EuclideanSpace with dist() method and add it to category of metric space</code></td></tr></table>\n",
    "created_at": "2020-07-11T15:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478830",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4">1f4f942</a></td><td><code>Provide EuclideanSpace with dist() method and add it to category of metric space</code></td></tr></table>




---

archive/issue_comments_478831.json:
```json
{
    "body": "Commit: **[1f4f942](https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4)**",
    "created_at": "2020-07-11T15:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478831",
    "user": "https://github.com/egourgoulhon"
}
```

Commit: **[1f4f942](https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4)**



---

archive/issue_comments_478832.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThe above commit is a first attempt to add `EuclideanSpace` to the category of metric spaces. It endows the class `EuclideanSpace` with the method `dist()`, which computes the Euclidean distance between two points. However, `TestSuite(E).run()` fails with `_test_metric` because of the name clash between \n- the method `metric()` of `EuclideanSpace`, which is inheritated from `PseudoRiemannianManifold` and which returns the metric tensor (first fundamental form)\n- the method `metric()` of `ParentMethods` in `MetricSpaces`, which is supposed to be the distance function.\n\nIt seems difficult to change the name of `PseudoRiemannianManifold.metric()`, even with a proper deprecation notice, because it is heavily used and it is the natural name in the context of differential geometry. On the other side, could the parent method `metric()` of `MetricSpaces` be changed to something else? e.g. `distance_function`? Also, it seems quite redundant with the other parent method `dist()`. Indeed, by default, the parent method `metric()` is defined as \n\n```\n        def metric(self):\n            return lambda a,b: a.dist(b)\n```\nwith `a.dist(b)` being `self.parent().dist(self, b)`, so at the end of the day, if `M` is a metric space, `M.metric()(a,b)` ends to `M.dist(a,b)`.",
    "created_at": "2020-07-11T16:23:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478832",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'>Comment 4:</a>
The above commit is a first attempt to add `EuclideanSpace` to the category of metric spaces. It endows the class `EuclideanSpace` with the method `dist()`, which computes the Euclidean distance between two points. However, `TestSuite(E).run()` fails with `_test_metric` because of the name clash between 
- the method `metric()` of `EuclideanSpace`, which is inheritated from `PseudoRiemannianManifold` and which returns the metric tensor (first fundamental form)
- the method `metric()` of `ParentMethods` in `MetricSpaces`, which is supposed to be the distance function.

It seems difficult to change the name of `PseudoRiemannianManifold.metric()`, even with a proper deprecation notice, because it is heavily used and it is the natural name in the context of differential geometry. On the other side, could the parent method `metric()` of `MetricSpaces` be changed to something else? e.g. `distance_function`? Also, it seems quite redundant with the other parent method `dist()`. Indeed, by default, the parent method `metric()` is defined as 

```
        def metric(self):
            return lambda a,b: a.dist(b)
```
with `a.dist(b)` being `self.parent().dist(self, b)`, so at the end of the day, if `M` is a metric space, `M.metric()(a,b)` ends to `M.dist(a,b)`.



---

archive/issue_comments_478833.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nAnother remark about `MetricSpaces`: it defines an element method `abs()`, which returns the distance to the zero element. For `EuclideanSpace`, the zero element could be defined as the element of Cartesian coordinates `(0,0,...,0)`, but in general, metric spaces (which are not necessarily algebraic structures) do not have any natural \"zero\" element, do they?",
    "created_at": "2020-07-11T16:28:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478833",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:5'>Comment 5:</a>
Another remark about `MetricSpaces`: it defines an element method `abs()`, which returns the distance to the zero element. For `EuclideanSpace`, the zero element could be defined as the element of Cartesian coordinates `(0,0,...,0)`, but in general, metric spaces (which are not necessarily algebraic structures) do not have any natural "zero" element, do they?



---

archive/issue_comments_478834.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nRegarding the addition of Riemannian manifolds beyond `EuclideanSpace` to the category `MetricSpaces`, this seems computationaly difficult. It is true that any connected Riemannian manifold can be turned into a metric space by defining the distance function as the infinimum of the lengths of the paths connecting two points, but the latter is not computable in practice.",
    "created_at": "2020-07-11T16:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478834",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'>Comment 6:</a>
Regarding the addition of Riemannian manifolds beyond `EuclideanSpace` to the category `MetricSpaces`, this seems computationaly difficult. It is true that any connected Riemannian manifold can be turned into a metric space by defining the distance function as the infinimum of the lengths of the paths connecting two points, but the latter is not computable in practice.



---

archive/issue_comments_478835.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@egourgoulhon](#comment%3A4):\n> The above commit is a first attempt to add `EuclideanSpace` to the category of metric spaces. It endows the class `EuclideanSpace` with the method `dist()`, which computes the Euclidean distance between two points.\n\nGreat!\n\n> However, `TestSuite(E).run()` fails with `_test_metric` because of the name clash between \n> - the method `metric()` of `EuclideanSpace`, which is inheritated from `PseudoRiemannianManifold` and which returns the metric tensor (first fundamental form)\n> - the method `metric()` of `ParentMethods` in `MetricSpaces`, which is supposed to be the distance function.\n> \n> It seems difficult to change the name of `PseudoRiemannianManifold.metric()`, even with a proper deprecation notice, because it is heavily used and it is the natural name in the context of differential geometry.\n\nI agree.\n\n> On the other side, could the parent method `metric()` of `MetricSpaces` be changed to something else?\n\nOverall, this category seems not very well developed, and I would be surprised if it was used much in user code. I think it will be safe to make changes to it (with deprecation).\n\n> e.g. `distance_function`? \n\nSounds good to me. But perhaps we can just deprecate the parent method `metric` altogether until a clear need for it arises?",
    "created_at": "2020-07-11T17:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478835",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@egourgoulhon](#comment%3A4):
> The above commit is a first attempt to add `EuclideanSpace` to the category of metric spaces. It endows the class `EuclideanSpace` with the method `dist()`, which computes the Euclidean distance between two points.

Great!

> However, `TestSuite(E).run()` fails with `_test_metric` because of the name clash between 
> - the method `metric()` of `EuclideanSpace`, which is inheritated from `PseudoRiemannianManifold` and which returns the metric tensor (first fundamental form)
> - the method `metric()` of `ParentMethods` in `MetricSpaces`, which is supposed to be the distance function.
> 
> It seems difficult to change the name of `PseudoRiemannianManifold.metric()`, even with a proper deprecation notice, because it is heavily used and it is the natural name in the context of differential geometry.

I agree.

> On the other side, could the parent method `metric()` of `MetricSpaces` be changed to something else?

Overall, this category seems not very well developed, and I would be surprised if it was used much in user code. I think it will be safe to make changes to it (with deprecation).

> e.g. `distance_function`? 

Sounds good to me. But perhaps we can just deprecate the parent method `metric` altogether until a clear need for it arises?



---

archive/issue_comments_478836.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [@egourgoulhon](#comment%3A5):\n> Another remark about `MetricSpaces`: it defines an element method `abs()`, which returns the distance to the zero element. For `EuclideanSpace`, the zero element could be defined as the element of Cartesian coordinates `(0,0,...,0)`, but in general, metric spaces (which are not necessarily algebraic structures) do not have any natural \"zero\" element, do they? \n\nI would propose to deprecate this element method, exactly for this reason. Probably when the category was written, the author was thinking of normed spaces; but these should become a separate category.",
    "created_at": "2020-07-11T17:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478836",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [@egourgoulhon](#comment%3A5):
> Another remark about `MetricSpaces`: it defines an element method `abs()`, which returns the distance to the zero element. For `EuclideanSpace`, the zero element could be defined as the element of Cartesian coordinates `(0,0,...,0)`, but in general, metric spaces (which are not necessarily algebraic structures) do not have any natural "zero" element, do they? 

I would propose to deprecate this element method, exactly for this reason. Probably when the category was written, the author was thinking of normed spaces; but these should become a separate category.



---

archive/issue_comments_478837.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@egourgoulhon](#comment%3A6):\n> Regarding the addition of Riemannian manifolds beyond `EuclideanSpace` to the category `MetricSpaces`, this seems computationaly difficult. It is true that any connected Riemannian manifold can be turned into a metric space by defining the distance function as the infinimum of the lengths of the paths connecting two points, but the latter is not computable in practice. \n\nGood point about the needed hypothesis of connectedness. That alone is already a good enough reason not to add Riemannian manifolds to the category. So we can ignore the more subtle question whether it makes sense to add it to the category but have the `dist` method raise `NotImplementedError` for nontrivial inputs.",
    "created_at": "2020-07-11T18:01:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478837",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@egourgoulhon](#comment%3A6):
> Regarding the addition of Riemannian manifolds beyond `EuclideanSpace` to the category `MetricSpaces`, this seems computationaly difficult. It is true that any connected Riemannian manifold can be turned into a metric space by defining the distance function as the infinimum of the lengths of the paths connecting two points, but the latter is not computable in practice. 

Good point about the needed hypothesis of connectedness. That alone is already a good enough reason not to add Riemannian manifolds to the category. So we can ignore the more subtle question whether it makes sense to add it to the category but have the `dist` method raise `NotImplementedError` for nontrivial inputs.



---

archive/issue_comments_478838.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nIndeed, I was conflating metric spaces and normed spaces, which should be separated into 2 separate categories (with normed spaces being a subcategory of metric spaces of course).\n\nJust to note: We do have an axiom for connected and the category `Manifolds().Connected()`.\n\nI am -1 for removing the element and parent methods `dist` and the `metric` method. `a.dist(b)` is natural and easier to work with when you don't want to explicitly specify the parent of `a` (and `b`). It is also more conceptual when you don't want to care about the exact metric as long as there is some metric. Similarly, when you want to specify which metric (space) you want to use `M.dist(a,b)` or `M.metric()(a,b)` becomes the more natural choice. Additionally, sometimes you want to explicitly work or pass the metric, so `M.metric()` is something useful too. There should not be any conflict here and having extra (natural) methods doesn't hurt anything.\n\nI would also be wary of saying there is no need just because something is not used in the Sage code: It could be used in a user's code and it feels natural from a teaching perspective. Additionally, me being the (dumb) non-geometer that I am, I would expect asking for the `metric()` of a metric space to return the metric function `d: X x X -> R`.\n\nAs Eric said in [comment:4](#comment%3A4), the real issue is the name conflict. From some wikipedia searching, what is currently called a metric in the manifolds code is really a (very common) shorthand name for \"metric tensor,\" whereas \"metric\" is the standard name for the function that defines a metric space. Of course, the metric tensor allows one to define a metric as Eric said, and it is clear from the context of the different fields what one means. Unfortunately there is not a good way to resolve this other than possibly replacing `metric` with `metric_tensor` in the manifolds code. However, I think it is reasonable to not put the connected Riemannian manifolds in the `MetricSpaces` category because of the computational infeasibility of the metric function.",
    "created_at": "2020-07-12T03:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478838",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
Indeed, I was conflating metric spaces and normed spaces, which should be separated into 2 separate categories (with normed spaces being a subcategory of metric spaces of course).

Just to note: We do have an axiom for connected and the category `Manifolds().Connected()`.

I am -1 for removing the element and parent methods `dist` and the `metric` method. `a.dist(b)` is natural and easier to work with when you don't want to explicitly specify the parent of `a` (and `b`). It is also more conceptual when you don't want to care about the exact metric as long as there is some metric. Similarly, when you want to specify which metric (space) you want to use `M.dist(a,b)` or `M.metric()(a,b)` becomes the more natural choice. Additionally, sometimes you want to explicitly work or pass the metric, so `M.metric()` is something useful too. There should not be any conflict here and having extra (natural) methods doesn't hurt anything.

I would also be wary of saying there is no need just because something is not used in the Sage code: It could be used in a user's code and it feels natural from a teaching perspective. Additionally, me being the (dumb) non-geometer that I am, I would expect asking for the `metric()` of a metric space to return the metric function `d: X x X -> R`.

As Eric said in [comment:4](#comment%3A4), the real issue is the name conflict. From some wikipedia searching, what is currently called a metric in the manifolds code is really a (very common) shorthand name for "metric tensor," whereas "metric" is the standard name for the function that defines a metric space. Of course, the metric tensor allows one to define a metric as Eric said, and it is clear from the context of the different fields what one means. Unfortunately there is not a good way to resolve this other than possibly replacing `metric` with `metric_tensor` in the manifolds code. However, I think it is reasonable to not put the connected Riemannian manifolds in the `MetricSpaces` category because of the computational infeasibility of the metric function.



---

archive/issue_comments_478839.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nJust a quick note:\n\nReplying to [@tscrim](#comment%3A10):\n> I am -1 for removing the element and parent methods `dist` and the `metric` method. `a.dist(b)` is natural and easier to work with when you don't want to explicitly specify the parent of `a` (and `b`). \n\nThere is no problem with the element method `dist`. The only problem is the clash of the parent method `metric`.",
    "created_at": "2020-07-12T05:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478839",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'>Comment 11:</a>
Just a quick note:

Replying to [@tscrim](#comment%3A10):
> I am -1 for removing the element and parent methods `dist` and the `metric` method. `a.dist(b)` is natural and easier to work with when you don't want to explicitly specify the parent of `a` (and `b`). 

There is no problem with the element method `dist`. The only problem is the clash of the parent method `metric`.



---

archive/issue_comments_478840.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@tscrim](#comment%3A10):\n> \n> I would also be wary of saying there is no need just because something is not used in the Sage code: It could be used in a user's code and it feels natural from a teaching perspective. Additionally, me being the (dumb) non-geometer that I am, I would expect asking for the `metric()` of a metric space to return the metric function `d: X x X -> R`.\n> \n\nI agree this quite natural.\n\n> As Eric said in [comment:4](#comment%3A4), the real issue is the name conflict. From some wikipedia searching, what is currently called a metric in the manifolds code is really a (very common) shorthand name for \"metric tensor,\" whereas \"metric\" is the standard name for the function that defines a metric space. Of course, the metric tensor allows one to define a metric as Eric said, and it is clear from the context of the different fields what one means. \n\nIndeed, both usages of *metric* are natural in their respective contexts. \n\n>Unfortunately there is not a good way to resolve this other than possibly replacing `metric` with `metric_tensor` in the manifolds code. \n\nAnother option is to replace `metric` by `metric_function` in `MetricSpaces`. I would favor that one. From a teaching perspective, it is as easy to discover by TAB completion as `metric` (contrary to `distance_function`, which I proposed in [comment:4](#comment%3A4)). Moreover, the `MetricSpaces`'s `metric()` is much less used in Sage's code than the manifold one: `grep -r \"\\.metric()\"` in `src/sage` returns 5 lines for metric spaces, versus 127 lines for manifolds. \n\n>However, I think it is reasonable to not put the connected Riemannian manifolds in the `MetricSpaces` category because of the computational infeasibility of the metric function.\n\nI agree, but this does not solve the clash issue for `EuclideanSpace`, since the latter is considered as a Riemannian manifold (with a flat metric tensor).",
    "created_at": "2020-07-12T12:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478840",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@tscrim](#comment%3A10):
> 
> I would also be wary of saying there is no need just because something is not used in the Sage code: It could be used in a user's code and it feels natural from a teaching perspective. Additionally, me being the (dumb) non-geometer that I am, I would expect asking for the `metric()` of a metric space to return the metric function `d: X x X -> R`.
> 

I agree this quite natural.

> As Eric said in [comment:4](#comment%3A4), the real issue is the name conflict. From some wikipedia searching, what is currently called a metric in the manifolds code is really a (very common) shorthand name for "metric tensor," whereas "metric" is the standard name for the function that defines a metric space. Of course, the metric tensor allows one to define a metric as Eric said, and it is clear from the context of the different fields what one means. 

Indeed, both usages of *metric* are natural in their respective contexts. 

>Unfortunately there is not a good way to resolve this other than possibly replacing `metric` with `metric_tensor` in the manifolds code. 

Another option is to replace `metric` by `metric_function` in `MetricSpaces`. I would favor that one. From a teaching perspective, it is as easy to discover by TAB completion as `metric` (contrary to `distance_function`, which I proposed in [comment:4](#comment%3A4)). Moreover, the `MetricSpaces`'s `metric()` is much less used in Sage's code than the manifold one: `grep -r "\.metric()"` in `src/sage` returns 5 lines for metric spaces, versus 127 lines for manifolds. 

>However, I think it is reasonable to not put the connected Riemannian manifolds in the `MetricSpaces` category because of the computational infeasibility of the metric function.

I agree, but this does not solve the clash issue for `EuclideanSpace`, since the latter is considered as a Riemannian manifold (with a flat metric tensor).



---

archive/issue_comments_478841.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@egourgoulhon](#comment%3A12):\n> Another option is to replace `metric` by `metric_function` in `MetricSpaces`. I would favor that one. From a teaching perspective, it is as easy to discover by TAB completion as `metric` (contrary to `distance_function`, which I proposed in [comment:4](#comment%3A4)). Moreover, the `MetricSpaces`'s `metric()` is much less used in Sage's code than the manifold one: `grep -r \"\\.metric()\"` in `src/sage` returns 5 lines for metric spaces, versus 127 lines for manifolds. \n\n+1 on `metric_function` (with deprecation for `metric`) in `MetricSpaces`. I think this is a good compromise.",
    "created_at": "2020-07-12T17:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478841",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@egourgoulhon](#comment%3A12):
> Another option is to replace `metric` by `metric_function` in `MetricSpaces`. I would favor that one. From a teaching perspective, it is as easy to discover by TAB completion as `metric` (contrary to `distance_function`, which I proposed in [comment:4](#comment%3A4)). Moreover, the `MetricSpaces`'s `metric()` is much less used in Sage's code than the manifold one: `grep -r "\.metric()"` in `src/sage` returns 5 lines for metric spaces, versus 127 lines for manifolds. 

+1 on `metric_function` (with deprecation for `metric`) in `MetricSpaces`. I think this is a good compromise.



---

archive/issue_comments_478842.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI agree that renaming `metric()` -> `metric_function()` and using that internally is good. However, I might also advocate for doing `metric()` -> `metric_tensor()` in the manifold code as it is basically just one sed command, as well as providing `metric()` as a shorthand.\n\nThe slightly trickier question would be should we allow `MetricSpaces` to have `metric()` be a shorthand whose semantics could change?",
    "created_at": "2020-07-12T23:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478842",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>Comment 14:</a>
I agree that renaming `metric()` -> `metric_function()` and using that internally is good. However, I might also advocate for doing `metric()` -> `metric_tensor()` in the manifold code as it is basically just one sed command, as well as providing `metric()` as a shorthand.

The slightly trickier question would be should we allow `MetricSpaces` to have `metric()` be a shorthand whose semantics could change?



---

archive/issue_comments_478843.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7\">7a92b60</a></td><td><code>sage.categories.metric_spaces.MetricSpaces: Rename metric to metric_function with deprecation</code></td></tr></table>\n",
    "created_at": "2020-07-17T07:19:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478843",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7">7a92b60</a></td><td><code>sage.categories.metric_spaces.MetricSpaces: Rename metric to metric_function with deprecation</code></td></tr></table>




---

archive/issue_comments_478844.json:
```json
{
    "body": "Changed commit from **[1f4f942](https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4)** to **[7a92b60](https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7)**",
    "created_at": "2020-07-17T07:19:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478844",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1f4f942](https://github.com/sagemath/sagetrac-mirror/commit/1f4f9422e393844eb2edbcbd59b8a8b0b4f5daa4)** to **[7a92b60](https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7)**



---

archive/issue_comments_478845.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@tscrim](#comment%3A10):\n> Indeed, I was conflating metric spaces and normed spaces, which should be separated into 2 separate categories (with normed spaces being a subcategory of metric spaces of course).\n\nLet's fix this in #30092.",
    "created_at": "2020-07-17T19:24:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478845",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@tscrim](#comment%3A10):
> Indeed, I was conflating metric spaces and normed spaces, which should be separated into 2 separate categories (with normed spaces being a subcategory of metric spaces of course).

Let's fix this in #30092.



---

archive/issue_comments_478846.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,17 @@\n sage: M = Matrix(QQ,[[2,1,0],[1,2,1],[0,1,2]])\n sage: V = VectorSpace(QQ,3,inner_product_matrix=M)\n sage: V in MetricSpaces()\n+False\n+sage: E = EuclideanSpace(3)\n+sage: E in MetricSpaces()\n+False\n ```\n \n-also add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) and possibly other manifold classes.\n+On this ticket, we add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) to the category.\n \n+To do this, we rename the `MetricSpaces` parent method `metric` to `metric_function`.\n+\n+The other examples from above will be taken care of in #30092 (which adds inner product spaces) and #30219 (real embedded number fields).\n+\n+\n+\n``````\n",
    "created_at": "2020-07-25T21:21:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478846",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,17 @@
 sage: M = Matrix(QQ,[[2,1,0],[1,2,1],[0,1,2]])
 sage: V = VectorSpace(QQ,3,inner_product_matrix=M)
 sage: V in MetricSpaces()
+False
+sage: E = EuclideanSpace(3)
+sage: E in MetricSpaces()
+False
 ```
 
-also add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) and possibly other manifold classes.
+On this ticket, we add (from [#30061 comment:44](https://github.com/sagemath/sage/issues/30061#comment:44)) `EuclideanSpace` (implementing the distance function by means of the Cartesian chart) to the category.
 
+To do this, we rename the `MetricSpaces` parent method `metric` to `metric_function`.
+
+The other examples from above will be taken care of in #30092 (which adds inner product spaces) and #30219 (real embedded number fields).
+
+
+
``````




---

archive/issue_events_395701.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-25T21:21:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "title_is": "Rename MetricSpaces parent method metric to metric_function, add EuclideanSpace to category of metric spaces",
    "title_was": "Add to category of metric spaces",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395701"
}
```



---

archive/issue_comments_478847.json:
```json
{
    "body": "Author: **Eric Gourgoulhon, Matthias Koeppe**",
    "created_at": "2020-07-25T21:23:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478847",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Eric Gourgoulhon, Matthias Koeppe**



---

archive/issue_events_395702.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-25T21:23:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395702"
}
```



---

archive/issue_comments_478848.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nWhile I am not fully convinced that we should not have an ambiguous `metric` method, it is not a strong enough opinion to warrant asking for further discussion. So if a patchbot comes back (morally) green, then positive review.",
    "created_at": "2020-07-25T22:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478848",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'>Comment 19:</a>
While I am not fully convinced that we should not have an ambiguous `metric` method, it is not a strong enough opinion to warrant asking for further discussion. So if a patchbot comes back (morally) green, then positive review.



---

archive/issue_comments_478849.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2020-07-25T22:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478849",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_478850.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nSome test failures that look like this\n\n```\nsage -t --long src/sage/rings/padics/padic_base_leaves.py\n**********************************************************************\nFile \"src/sage/rings/padics/padic_base_leaves.py\", line 237, in sage.rings.padics.padic_base_leaves.pAdicRingCappedRelative.__init__\nFailed example:\n    R._test_metric(elements = [R.random_element() for i in range(2^3)]) # long time\nException raised:\n    Traceback (most recent call last):\n      File \"sage/structure/category_object.pyx\", line 838, in sage.structure.category_object.CategoryObject.getattr_from_category (build/cythonized/sage/structure/category_object.c:6954)\n        return self.__cached_methods[name]\n    KeyError: '_test_metric'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 707, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1131, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.padics.padic_base_leaves.pAdicRingCappedRelative.__init__[5]>\", line 1, in <module>\n        R._test_metric(elements = [R.random_element() for i in range(Integer(2)**Integer(3))]) # long time\n      File \"sage/structure/category_object.pyx\", line 832, in sage.structure.category_object.CategoryObject.__getattr__ (build/cythonized/sage/structure/category_object.c:6876)\n        return self.getattr_from_category(name)\n      File \"sage/structure/category_object.pyx\", line 847, in sage.structure.category_object.CategoryObject.getattr_from_category (build/cythonized/sage/structure/category_object.c:7039)\n        attr = getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 389, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2548)\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'pAdicRingCappedRelative_with_category' object has no attribute '_test_metric'\n**********************************************************************\n```\n... and some others",
    "created_at": "2020-07-26T00:17:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478850",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'>Comment 20:</a>
Some test failures that look like this

```
sage -t --long src/sage/rings/padics/padic_base_leaves.py
**********************************************************************
File "src/sage/rings/padics/padic_base_leaves.py", line 237, in sage.rings.padics.padic_base_leaves.pAdicRingCappedRelative.__init__
Failed example:
    R._test_metric(elements = [R.random_element() for i in range(2^3)]) # long time
Exception raised:
    Traceback (most recent call last):
      File "sage/structure/category_object.pyx", line 838, in sage.structure.category_object.CategoryObject.getattr_from_category (build/cythonized/sage/structure/category_object.c:6954)
        return self.__cached_methods[name]
    KeyError: '_test_metric'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 707, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1131, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.padics.padic_base_leaves.pAdicRingCappedRelative.__init__[5]>", line 1, in <module>
        R._test_metric(elements = [R.random_element() for i in range(Integer(2)**Integer(3))]) # long time
      File "sage/structure/category_object.pyx", line 832, in sage.structure.category_object.CategoryObject.__getattr__ (build/cythonized/sage/structure/category_object.c:6876)
        return self.getattr_from_category(name)
      File "sage/structure/category_object.pyx", line 847, in sage.structure.category_object.CategoryObject.getattr_from_category (build/cythonized/sage/structure/category_object.c:7039)
        attr = getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 389, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2548)
        raise AttributeError(dummy_error_message)
    AttributeError: 'pAdicRingCappedRelative_with_category' object has no attribute '_test_metric'
**********************************************************************
```
... and some others



---

archive/issue_events_395703.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:17:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395703"
}
```



---

archive/issue_events_395704.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:17:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395704"
}
```



---

archive/issue_comments_478851.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n\n```\nsage -t --long src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst\", line 31, in doc.en.thematic_tutorials.vector_calculus.vector_calc_advanced\nFailed example:\n    E.category()\nExpected:\n    Category of smooth manifolds over Real Field with 53 bits of precision\nGot:\n    Join of Category of differentiable manifolds over Real Field with 53 bits of precision and Category of metric spaces\n```\nIs the change from \"smooth\" to \"differentiable\" expected here?",
    "created_at": "2020-07-26T00:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478851",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>Comment 22:</a>

```
sage -t --long src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst", line 31, in doc.en.thematic_tutorials.vector_calculus.vector_calc_advanced
Failed example:
    E.category()
Expected:
    Category of smooth manifolds over Real Field with 53 bits of precision
Got:
    Join of Category of differentiable manifolds over Real Field with 53 bits of precision and Category of metric spaces
```
Is the change from "smooth" to "differentiable" expected here?



---

archive/issue_events_395705.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:29:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395705"
}
```



---

archive/issue_events_395706.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:29:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395706"
}
```



---

archive/issue_comments_478852.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ec6e62e08648d465b4e64eeb567a4db1f341f7f\">4ec6e62</a></td><td><code>Merge tag '9.2.beta6' into t/30062/public/manifolds/euclidean_metric_space</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b\">d99aeda</a></td><td><code>src/sage/rings/padics/padic_base_leaves.py: Update use of _test_metric</code></td></tr></table>\n",
    "created_at": "2020-07-26T00:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478852",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ec6e62e08648d465b4e64eeb567a4db1f341f7f">4ec6e62</a></td><td><code>Merge tag '9.2.beta6' into t/30062/public/manifolds/euclidean_metric_space</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b">d99aeda</a></td><td><code>src/sage/rings/padics/padic_base_leaves.py: Update use of _test_metric</code></td></tr></table>




---

archive/issue_comments_478853.json:
```json
{
    "body": "Changed commit from **[7a92b60](https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7)** to **[d99aeda](https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b)**",
    "created_at": "2020-07-26T00:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478853",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7a92b60](https://github.com/sagemath/sagetrac-mirror/commit/7a92b60ad53cc25a20ea86e29ef82fb52f2babc7)** to **[d99aeda](https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b)**



---

archive/issue_comments_478854.json:
```json
{
    "body": "Changed commit from **[d99aeda](https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b)** to **[a1389d8](https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361)**",
    "created_at": "2020-07-26T00:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478854",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d99aeda](https://github.com/sagemath/sagetrac-mirror/commit/d99aedae454ab73e0a587fd661609e6e3046bd4b)** to **[a1389d8](https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361)**



---

archive/issue_comments_478855.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93facad6b5da6e8fdfb3f432226a505f556aecc4\">93facad</a></td><td><code>src/sage/structure/category_object.pyx: Update use of _test_metric</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361\">a1389d8</a></td><td><code>src/doc/en/thematic_tutorials/vector_calculus: Update categories in doctest</code></td></tr></table>\n",
    "created_at": "2020-07-26T00:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478855",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93facad6b5da6e8fdfb3f432226a505f556aecc4">93facad</a></td><td><code>src/sage/structure/category_object.pyx: Update use of _test_metric</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361">a1389d8</a></td><td><code>src/doc/en/thematic_tutorials/vector_calculus: Update categories in doctest</code></td></tr></table>




---

archive/issue_events_395707.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:33:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395707"
}
```



---

archive/issue_events_395708.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-26T00:33:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395708"
}
```



---

archive/issue_comments_478856.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nReplying to [@mkoeppe](#comment%3A22):\n> \n> ```\n> sage -t --long src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst\n> **********************************************************************\n> File \"src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst\", line 31, in doc.en.thematic_tutorials.vector_calculus.vector_calc_advanced\n> Failed example:\n>     E.category()\n> Expected:\n>     Category of smooth manifolds over Real Field with 53 bits of precision\n> Got:\n>     Join of Category of differentiable manifolds over Real Field with 53 bits of precision and Category of metric spaces\n> ```\n> Is the change from \"smooth\" to \"differentiable\" expected here?\n\n\nYou explicitly changed the default category to only be differentiable rather than smooth:\n\n```diff\n+        if category is None:\n+            category = Manifolds(RR).Differentiable() & MetricSpaces()\n```\nSee `sage.manifolds.differentiable.manifold.DifferentiableManifold.__init__`. So I think you need to change\n\n```diff\n-            category = Manifolds(RR).Differentiable() & MetricSpaces()\n+            category = Manifolds(RR).Smooth() & MetricSpaces()\n```",
    "created_at": "2020-07-26T02:28:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478856",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'>Comment 27:</a>
Replying to [@mkoeppe](#comment%3A22):
> 
> ```
> sage -t --long src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst
> **********************************************************************
> File "src/doc/en/thematic_tutorials/vector_calculus/vector_calc_advanced.rst", line 31, in doc.en.thematic_tutorials.vector_calculus.vector_calc_advanced
> Failed example:
>     E.category()
> Expected:
>     Category of smooth manifolds over Real Field with 53 bits of precision
> Got:
>     Join of Category of differentiable manifolds over Real Field with 53 bits of precision and Category of metric spaces
> ```
> Is the change from "smooth" to "differentiable" expected here?


You explicitly changed the default category to only be differentiable rather than smooth:

```diff
+        if category is None:
+            category = Manifolds(RR).Differentiable() & MetricSpaces()
```
See `sage.manifolds.differentiable.manifold.DifferentiableManifold.__init__`. So I think you need to change

```diff
-            category = Manifolds(RR).Differentiable() & MetricSpaces()
+            category = Manifolds(RR).Smooth() & MetricSpaces()
```



---

archive/issue_comments_478857.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nEric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional",
    "created_at": "2020-07-26T02:31:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478857",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'>Comment 28:</a>
Eric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional



---

archive/issue_comments_478858.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@mkoeppe](#comment%3A28):\n> Eric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional\n\nAh, sorry, I thought it was on one of your commits.",
    "created_at": "2020-07-26T04:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478858",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@mkoeppe](#comment%3A28):
> Eric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional

Ah, sorry, I thought it was on one of your commits.



---

archive/issue_comments_478859.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nReplying to [@mkoeppe](#comment%3A28):\n> Eric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional\n\nSorry it is a mistake from my side; of course, for Euclidean spaces, the category shall be `Manifolds(RR).Smooth()`.",
    "created_at": "2020-07-26T12:42:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478859",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:30'>Comment 30:</a>
Replying to [@mkoeppe](#comment%3A28):
> Eric's commit 1f4f9422 did this, so I guess my question is to him whether this change was intentional

Sorry it is a mistake from my side; of course, for Euclidean spaces, the category shall be `Manifolds(RR).Smooth()`.



---

archive/issue_comments_478860.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nSince we are on it, we could also add that the Euclidean space is in the category of complete metric spaces:\n\n```\n    category = Manifolds(RR).Smooth() & MetricSpaces().Complete()\n```\nwith hopefully some day `RR` replaced by a better representation of the real field, as proposed in #24456.",
    "created_at": "2020-07-26T12:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478860",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:31'>Comment 31:</a>
Since we are on it, we could also add that the Euclidean space is in the category of complete metric spaces:

```
    category = Manifolds(RR).Smooth() & MetricSpaces().Complete()
```
with hopefully some day `RR` replaced by a better representation of the real field, as proposed in #24456.



---

archive/issue_comments_478861.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [@egourgoulhon](#comment%3A31):\n> Since we are on it, we could also add that the Euclidean space is in the category of complete metric spaces:\n> \n> ```\n>     category = Manifolds(RR).Smooth() & MetricSpaces().Complete()\n> ```\n> with hopefully some day `RR` replaced by a better representation of the real field, as proposed in #24456.\n\nI'll add a commit implementing this soon (EDIT: this is the commit in [comment:33](#comment%3A33)).",
    "created_at": "2020-07-26T13:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478861",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [@egourgoulhon](#comment%3A31):
> Since we are on it, we could also add that the Euclidean space is in the category of complete metric spaces:
> 
> ```
>     category = Manifolds(RR).Smooth() & MetricSpaces().Complete()
> ```
> with hopefully some day `RR` replaced by a better representation of the real field, as proposed in #24456.

I'll add a commit implementing this soon (EDIT: this is the commit in [comment:33](#comment%3A33)).



---

archive/issue_comments_478862.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3\">d785c0d</a></td><td><code>Better category for Euclidean spaces</code></td></tr></table>\n",
    "created_at": "2020-07-26T14:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478862",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:33'>Comment 33:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3">d785c0d</a></td><td><code>Better category for Euclidean spaces</code></td></tr></table>




---

archive/issue_comments_478863.json:
```json
{
    "body": "Changed commit from **[a1389d8](https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361)** to **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**",
    "created_at": "2020-07-26T14:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478863",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a1389d8](https://github.com/sagemath/sagetrac-mirror/commit/a1389d8b139b76a4b284b746e69f845da25a4361)** to **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**



---

archive/issue_comments_478864.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Matthias Koeppe, Travis Scrimshaw**",
    "created_at": "2020-07-26T17:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478864",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Travis Scrimshaw** to **Matthias Koeppe, Travis Scrimshaw**



---

archive/issue_comments_478865.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nLooks great to me, thanks very much.\n\nPatchbot is green too. (There is one patchbot that is not feeling well, unrelated to this ticket.)",
    "created_at": "2020-07-26T17:27:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478865",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'>Comment 35:</a>
Looks great to me, thanks very much.

Patchbot is green too. (There is one patchbot that is not feeling well, unrelated to this ticket.)



---

archive/issue_comments_478866.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nThank you.",
    "created_at": "2020-07-27T03:39:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478866",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'>Comment 36:</a>
Thank you.



---

archive/issue_events_395709.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-07-27T03:39:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395709"
}
```



---

archive/issue_events_395710.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-07-27T03:39:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395710"
}
```



---

archive/issue_events_395711.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-02T08:20:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395711"
}
```



---

archive/issue_events_395712.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "653d0f4d75b3d587d5b09a2eb4df44caa583b0af",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-02T08:20:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30062#event-395712"
}
```



---

archive/issue_comments_478867.json:
```json
{
    "body": "Changed branch from **[public/manifolds/euclidean_metric_space](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/euclidean_metric_space)** to **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**",
    "created_at": "2020-08-02T08:20:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30062#issuecomment-478867",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/manifolds/euclidean_metric_space](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/euclidean_metric_space)** to **[d785c0d](https://github.com/sagemath/sagetrac-mirror/commit/d785c0d05c92d9ea96cdaa63df9f52824fa03ce3)**
