# Issue 30913: sagelib: Generate pyproject.toml and setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile

archive/issues_030676.json:
```json
{
    "assignees": [],
    "body": "After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n\nAs of Sage 9.3.beta8, `sagelib` is published as a source distribution on PyPI (https://pypi.org/project/sagemath-standard), but the package does not have proper dependency information yet. \n\nAs part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n\n(Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n\n**To test - use `./bootstrap` and then configure and build the Sage distribution.**  Then follow the instructions in `build/pkgs/sagelib/src/tox.ini`:\n\n```\n    #\n    # SUPPORTED ENVIRONMENTS:\n    #\n    # Build dependencies according to requirements.txt (all versions fixed).\n    # Use ONLY the wheels built and stored by the Sage distribution (no PyPI):\n    #\n    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'\n    #\n    python-sagewheels-nopypi,\n    #\n    # Build and test without using the concrete dependencies specified by requirements.txt,\n    # using the dependencies declared in pyproject.toml and setup.cfg (install-requires) only:\n    # Still use ONLY the wheels built and stored by the Sage distribution (no PyPI).\n    #\n    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi-norequirements)'\n    #\n    python-sagewheels-nopypi-norequirements,\n    #\n```\n**Related or follow-up tickets:**\n- #31377 `./configure --enable-editable`\n- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n- #28752 Make sagelib pip-installable in a conda environment\n- #30371 In-place (editable) installs of sagelib in a venv\n- #29041 `sage_bootstrap`: Add command \"sage -package list --output={install-requires,requirements,pipfile,debian,....}\"\n- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n\nReferences:\n- https://snarky.ca/what-the-heck-is-pyproject-toml/\n\n\n\n\n\nCC:  @dimpase @tobiasdiez @jhpalmieri @videlec @kiwifb @malb\n\nKeywords: **sd111**\n\nBranch/Commit: **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30913_\n\n",
    "closed_at": "2021-05-27T20:30:52Z",
    "created_at": "2020-11-14T07:21:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sagelib: Generate pyproject.toml and setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile",
    "type": "issue",
    "updated_at": "2021-05-27T20:30:52Z",
    "url": "https://github.com/sagemath/sage/issues/30913",
    "user": "https://github.com/mkoeppe"
}
```
After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  

As of Sage 9.3.beta8, `sagelib` is published as a source distribution on PyPI (https://pypi.org/project/sagemath-standard), but the package does not have proper dependency information yet. 

As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.

(Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)

**To test - use `./bootstrap` and then configure and build the Sage distribution.**  Then follow the instructions in `build/pkgs/sagelib/src/tox.ini`:

```
    #
    # SUPPORTED ENVIRONMENTS:
    #
    # Build dependencies according to requirements.txt (all versions fixed).
    # Use ONLY the wheels built and stored by the Sage distribution (no PyPI):
    #
    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'
    #
    python-sagewheels-nopypi,
    #
    # Build and test without using the concrete dependencies specified by requirements.txt,
    # using the dependencies declared in pyproject.toml and setup.cfg (install-requires) only:
    # Still use ONLY the wheels built and stored by the Sage distribution (no PyPI).
    #
    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi-norequirements)'
    #
    python-sagewheels-nopypi-norequirements,
    #
```
**Related or follow-up tickets:**
- #31377 `./configure --enable-editable`
- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
- #28752 Make sagelib pip-installable in a conda environment
- #30371 In-place (editable) installs of sagelib in a venv
- #29041 `sage_bootstrap`: Add command "sage -package list --output={install-requires,requirements,pipfile,debian,....}"
- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.

References:
- https://snarky.ca/what-the-heck-is-pyproject-toml/





CC:  @dimpase @tobiasdiez @jhpalmieri @videlec @kiwifb @malb

Keywords: **sd111**

Branch/Commit: **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/30913_





---

archive/issue_events_426367.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T07:21:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426367"
}
```



---

archive/issue_events_426368.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T07:21:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426368"
}
```



---

archive/issue_events_426369.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T07:21:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426369"
}
```



---

archive/issue_events_426370.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T07:21:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426370"
}
```



---

archive/issue_comments_495199.json:
```json
{
    "body": "Changed dependencies from **#30578, #30912** to **#30578, #30912, #30719**",
    "created_at": "2020-11-15T01:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495199",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30578, #30912** to **#30578, #30912, #30719**



---

archive/issue_comments_495200.json:
```json
{
    "body": "Branch: **[u/mkoeppe/sagelib__add_setup_cfg__install_requires_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sagelib__add_setup_cfg__install_requires_)**",
    "created_at": "2020-11-15T03:40:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495200",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/sagelib__add_setup_cfg__install_requires_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sagelib__add_setup_cfg__install_requires_)**



---

archive/issue_comments_495201.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-11-15T03:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495201",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_495202.json:
```json
{
    "body": "Commit: **[b0f5cd2](https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d)**",
    "created_at": "2020-11-15T03:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495202",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[b0f5cd2](https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d)**



---

archive/issue_comments_495203.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n+As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.\n \n``````\n",
    "created_at": "2020-11-15T03:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495203",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
+As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.
 
``````




---

archive/issue_comments_495204.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e61929d7c568167e2e5b77d9f3b7e4ae9eb80556\">e61929d</a></td><td><code>build/pkgs/sphinx/install-requires.txt: Update from gentoo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fe0e35aae5e3064bf77a2a0192487fb50f11826\">8fe0e35</a></td><td><code>build/pkgs/python_openid: Unused, remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba1d913e2e340c8ec5c533ecb26d2f3d835b4eb9\">ba1d913</a></td><td><code>build/pkgs/itsdangerous: Unused, remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb6c4ae829c6c6f55d305e64833a5b85d50fc205\">bb6c4ae</a></td><td><code>build/pkgs/tox/install-requires.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d50750123c5368874f99a05626f33fade165b246\">d507501</a></td><td><code>build/pkgs/networkx/install-requires.txt: Update from gentoo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3a9352acb3f87d8afdb5d9b0d61611cc30fefaa\">c3a9352</a></td><td><code>build/pkgs/pathpy/install-requires.txt: Package removed in #30611, remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebd4610519f9794aef64e8f283adcc827addf6f5\">ebd4610</a></td><td><code>build/pkgs/pynac/install-requires.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ec00dd002b41c4fe9b91233f2cebe37c87144d9\">6ec00dd</a></td><td><code>build/pkgs/{numpy,pillow}/install-requires.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6bff345de3c65be0d73595179b607f610974dbb1\">6bff345</a></td><td><code>Merge branch 't/30719/add_build_pkgs_spkg_install_requires_txt_for_all_python_packages' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d\">b0f5cd2</a></td><td><code>bootstrap: Generate build/pkgs/sagelib/src/setup.cfg with m4</code></td></tr></table>\n",
    "created_at": "2020-11-15T03:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495204",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e61929d7c568167e2e5b77d9f3b7e4ae9eb80556">e61929d</a></td><td><code>build/pkgs/sphinx/install-requires.txt: Update from gentoo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fe0e35aae5e3064bf77a2a0192487fb50f11826">8fe0e35</a></td><td><code>build/pkgs/python_openid: Unused, remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba1d913e2e340c8ec5c533ecb26d2f3d835b4eb9">ba1d913</a></td><td><code>build/pkgs/itsdangerous: Unused, remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb6c4ae829c6c6f55d305e64833a5b85d50fc205">bb6c4ae</a></td><td><code>build/pkgs/tox/install-requires.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d50750123c5368874f99a05626f33fade165b246">d507501</a></td><td><code>build/pkgs/networkx/install-requires.txt: Update from gentoo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3a9352acb3f87d8afdb5d9b0d61611cc30fefaa">c3a9352</a></td><td><code>build/pkgs/pathpy/install-requires.txt: Package removed in #30611, remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebd4610519f9794aef64e8f283adcc827addf6f5">ebd4610</a></td><td><code>build/pkgs/pynac/install-requires.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ec00dd002b41c4fe9b91233f2cebe37c87144d9">6ec00dd</a></td><td><code>build/pkgs/{numpy,pillow}/install-requires.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6bff345de3c65be0d73595179b607f610974dbb1">6bff345</a></td><td><code>Merge branch 't/30719/add_build_pkgs_spkg_install_requires_txt_for_all_python_packages' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d">b0f5cd2</a></td><td><code>bootstrap: Generate build/pkgs/sagelib/src/setup.cfg with m4</code></td></tr></table>




---

archive/issue_events_426371.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-15T03:43:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426371"
}
```



---

archive/issue_comments_495205.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002\">6094c68</a></td><td><code>build/pkgs/cypari/install-requires.txt: cypari2, not cypari</code></td></tr></table>\n",
    "created_at": "2020-11-15T04:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495205",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002">6094c68</a></td><td><code>build/pkgs/cypari/install-requires.txt: cypari2, not cypari</code></td></tr></table>




---

archive/issue_comments_495206.json:
```json
{
    "body": "Changed commit from **[b0f5cd2](https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d)** to **[6094c68](https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002)**",
    "created_at": "2020-11-15T04:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495206",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b0f5cd2](https://github.com/sagemath/sagetrac-mirror/commit/b0f5cd25911c289093a8060c998b0ef574d5289d)** to **[6094c68](https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002)**



---

archive/issue_comments_495207.json:
```json
{
    "body": "Changed commit from **[6094c68](https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002)** to **[411cbfb](https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5)**",
    "created_at": "2020-11-20T00:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495207",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6094c68](https://github.com/sagemath/sagetrac-mirror/commit/6094c68b2aebfaf87358be89dfbc273ac1f22002)** to **[411cbfb](https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5)**



---

archive/issue_comments_495208.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5\">411cbfb</a></td><td><code>build/bin/sage-get-system-packages: Add comment</code></td></tr></table>\n",
    "created_at": "2020-11-20T00:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495208",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5">411cbfb</a></td><td><code>build/bin/sage-get-system-packages: Add comment</code></td></tr></table>




---

archive/issue_comments_495209.json:
```json
{
    "body": "Changed commit from **[411cbfb](https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5)** to **[3b02c3d](https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05)**",
    "created_at": "2020-11-20T02:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495209",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[411cbfb](https://github.com/sagemath/sagetrac-mirror/commit/411cbfb61f6bdaadf09e9c092818dafbe10036d5)** to **[3b02c3d](https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05)**



---

archive/issue_comments_495210.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05\">3b02c3d</a></td><td><code>bootstrap: Run bootstrap scripts in build/pkgs/*/, create build/pkgs/sagelib/bootstrap</code></td></tr></table>\n",
    "created_at": "2020-11-20T02:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495210",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05">3b02c3d</a></td><td><code>bootstrap: Run bootstrap scripts in build/pkgs/*/, create build/pkgs/sagelib/bootstrap</code></td></tr></table>




---

archive/issue_comments_495211.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWill this be able to deal with optional package declarations (in time)?",
    "created_at": "2020-11-20T19:46:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495211",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

Will this be able to deal with optional package declarations (in time)?



---

archive/issue_comments_495212.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe plan for optional packages is that users would install a package such as `sagemath-meataxe` or `sagemath-tdlib` in addition to `sagemath-standard`.",
    "created_at": "2020-11-20T19:50:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495212",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

The plan for optional packages is that users would install a package such as `sagemath-meataxe` or `sagemath-tdlib` in addition to `sagemath-standard`.



---

archive/issue_comments_495213.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e\">95b74e8</a></td><td><code>Merge tag '9.3.beta2' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2020-11-27T04:13:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495213",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e">95b74e8</a></td><td><code>Merge tag '9.3.beta2' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495214.json:
```json
{
    "body": "Changed commit from **[3b02c3d](https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05)** to **[95b74e8](https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e)**",
    "created_at": "2020-11-27T04:13:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495214",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3b02c3d](https://github.com/sagemath/sagetrac-mirror/commit/3b02c3d6bdafa6872231d4d1039629f9fa140d05)** to **[95b74e8](https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e)**



---

archive/issue_comments_495215.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T17:43:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495215",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_495216.json:
```json
{
    "body": "Changed dependencies from **#30578, #30912, #30719** to **#30578, #30912**",
    "created_at": "2020-12-06T21:21:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495216",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30578, #30912, #30719** to **#30578, #30912**



---

archive/issue_comments_495217.json:
```json
{
    "body": "Changed commit from **[95b74e8](https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e)** to **[8b8b9f9](https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4)**",
    "created_at": "2020-12-10T19:25:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495217",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[95b74e8](https://github.com/sagemath/sagetrac-mirror/commit/95b74e8087ab5b250f7312298ca2615232633c4e)** to **[8b8b9f9](https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4)**



---

archive/issue_comments_495218.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99b56f5852d9b49bfad2da9a5f391e49475e5aab\">99b56f5</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add environment python-norequirements</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4\">8b8b9f9</a></td><td><code>Merge tag '9.3.beta3' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2020-12-10T19:25:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495218",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99b56f5852d9b49bfad2da9a5f391e49475e5aab">99b56f5</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add environment python-norequirements</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4">8b8b9f9</a></td><td><code>Merge tag '9.3.beta3' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495219.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,8 @@\n As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.\n \n+To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n+In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` added in #30578), use\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n+```\n``````\n",
    "created_at": "2020-12-10T19:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495219",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,8 @@
 As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.
 
+To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
+In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` added in #30578), use
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
+```
``````




---

archive/issue_comments_495220.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAdded instructions for testing to the ticket description. \nIn particular, this reveals the missing dependencies of upstream Python packages tracked in #30922.",
    "created_at": "2020-12-10T19:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495220",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Added instructions for testing to the ticket description. 
In particular, this reveals the missing dependencies of upstream Python packages tracked in #30922.



---

archive/issue_comments_495221.json:
```json
{
    "body": "Changed commit from **[8b8b9f9](https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4)** to **[3382a47](https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227)**",
    "created_at": "2020-12-10T19:36:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495221",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8b8b9f9](https://github.com/sagemath/sagetrac-mirror/commit/8b8b9f9f8042217fc56b91d12d20f7c1dab7faf4)** to **[3382a47](https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227)**



---

archive/issue_comments_495222.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227\">3382a47</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Switch to git+https link</code></td></tr></table>\n",
    "created_at": "2020-12-10T19:36:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495222",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227">3382a47</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Switch to git+https link</code></td></tr></table>




---

archive/issue_comments_495223.json:
```json
{
    "body": "Changed commit from **[3382a47](https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227)** to **[bf61db4](https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a)**",
    "created_at": "2020-12-12T01:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495223",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3382a47](https://github.com/sagemath/sagetrac-mirror/commit/3382a47982e5be9cd312728600357526e5902227)** to **[bf61db4](https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a)**



---

archive/issue_comments_495224.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6432727a4fb106206dd0aae3d8e62715cd6725b3\">6432727</a></td><td><code>Merge tag '9.3.beta2' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a693f22c6044c8baa80f744519855371e3c4aae\">4a693f2</a></td><td><code>Move build/pkgs/sagelib/src/setup.cfg to SAGE_ROOT/src, replace by symlink</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea182d7302b3d362bbd38b548cda65c86e3b6f66\">ea182d7</a></td><td><code>Copy changes from build/pkgs/sagelib/src to src</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1a10b9b524e63574bbf1de2c4ce6f149116f147\">a1a10b9</a></td><td><code>src/VERSION.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5697335ed14c929adb01a3fafe95f82b79248918\">5697335</a></td><td><code>src/setup.cfg: Add license_file=LICENSE.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/deb9eb3a33ee6474f755a9bee6f487d839c9d247\">deb9eb3</a></td><td><code>Merge tag '9.3.beta3' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a\">bf61db4</a></td><td><code>Merge branch 't/30912/sagelib__update_metadata_for_pypi_deployment' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2020-12-12T01:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495224",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6432727a4fb106206dd0aae3d8e62715cd6725b3">6432727</a></td><td><code>Merge tag '9.3.beta2' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a693f22c6044c8baa80f744519855371e3c4aae">4a693f2</a></td><td><code>Move build/pkgs/sagelib/src/setup.cfg to SAGE_ROOT/src, replace by symlink</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea182d7302b3d362bbd38b548cda65c86e3b6f66">ea182d7</a></td><td><code>Copy changes from build/pkgs/sagelib/src to src</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1a10b9b524e63574bbf1de2c4ce6f149116f147">a1a10b9</a></td><td><code>src/VERSION.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5697335ed14c929adb01a3fafe95f82b79248918">5697335</a></td><td><code>src/setup.cfg: Add license_file=LICENSE.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/deb9eb3a33ee6474f755a9bee6f487d839c9d247">deb9eb3</a></td><td><code>Merge tag '9.3.beta3' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a">bf61db4</a></td><td><code>Merge branch 't/30912/sagelib__update_metadata_for_pypi_deployment' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495225.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee3c0147d6e9dbf18b90d86acbe5e05aa0a2a2c3\">ee3c014</a></td><td><code>src/setup.cfg: Remove file generated by bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a\">bde563c</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Fix up URL</code></td></tr></table>\n",
    "created_at": "2020-12-12T01:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495225",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee3c0147d6e9dbf18b90d86acbe5e05aa0a2a2c3">ee3c014</a></td><td><code>src/setup.cfg: Remove file generated by bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a">bde563c</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Fix up URL</code></td></tr></table>




---

archive/issue_comments_495226.json:
```json
{
    "body": "Changed commit from **[bf61db4](https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a)** to **[bde563c](https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a)**",
    "created_at": "2020-12-12T01:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495226",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bf61db4](https://github.com/sagemath/sagetrac-mirror/commit/bf61db4ee0b042865fa61e7b14ad55a13c839c0a)** to **[bde563c](https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a)**



---

archive/issue_comments_495227.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42f90c92449b72da776cc1a294d4ec09b3efce12\">42f90c9</a></td><td><code>src/requirements.txt: Add to documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80026f1db4dee14926a8a539f54a7f88a9a10734\">80026f1</a></td><td><code>bootstrap, build/pkgs/sagelib/bootstrap: Do not ignore errors</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/598675c5bc5f4680482f1267a3166f103ccdcee5\">598675c</a></td><td><code>build/pkgs/sage_conf/package-version.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59d6b17dc4761e2b26d7c7ad12e6e80c1613f800\">59d6b17</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add environments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d\">2f88522</a></td><td><code>src/requirements.txt: Generate from ....m4</code></td></tr></table>\n",
    "created_at": "2020-12-12T06:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495227",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42f90c92449b72da776cc1a294d4ec09b3efce12">42f90c9</a></td><td><code>src/requirements.txt: Add to documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80026f1db4dee14926a8a539f54a7f88a9a10734">80026f1</a></td><td><code>bootstrap, build/pkgs/sagelib/bootstrap: Do not ignore errors</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/598675c5bc5f4680482f1267a3166f103ccdcee5">598675c</a></td><td><code>build/pkgs/sage_conf/package-version.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59d6b17dc4761e2b26d7c7ad12e6e80c1613f800">59d6b17</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add environments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d">2f88522</a></td><td><code>src/requirements.txt: Generate from ....m4</code></td></tr></table>




---

archive/issue_comments_495228.json:
```json
{
    "body": "Changed commit from **[bde563c](https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a)** to **[2f88522](https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d)**",
    "created_at": "2020-12-12T06:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495228",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bde563c](https://github.com/sagemath/sagetrac-mirror/commit/bde563c18a8625a69d2313e68f3981e1618d813a)** to **[2f88522](https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d)**



---

archive/issue_comments_495229.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35\">9ca41ea</a></td><td><code>Add some notes</code></td></tr></table>\n",
    "created_at": "2020-12-12T06:26:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495229",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35">9ca41ea</a></td><td><code>Add some notes</code></td></tr></table>




---

archive/issue_comments_495230.json:
```json
{
    "body": "Changed commit from **[2f88522](https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d)** to **[9ca41ea](https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35)**",
    "created_at": "2020-12-12T06:26:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495230",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2f88522](https://github.com/sagemath/sagetrac-mirror/commit/2f88522ec07dbdc3aa5f26d913ce31b7f3216f4d)** to **[9ca41ea](https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35)**



---

archive/issue_comments_495231.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nTo generate the `requirements.txt` file as well, need #29041",
    "created_at": "2020-12-12T06:27:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495231",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

To generate the `requirements.txt` file as well, need #29041



---

archive/issue_events_426372.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-12T06:27:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426372"
}
```



---

archive/issue_events_426373.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-12T06:27:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426373"
}
```



---

archive/issue_comments_495232.json:
```json
{
    "body": "Changed commit from **[9ca41ea](https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35)** to **[f727cfe](https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d)**",
    "created_at": "2020-12-12T07:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495232",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9ca41ea](https://github.com/sagemath/sagetrac-mirror/commit/9ca41ea164450110e221c7adebb8b69a2f93bb35)** to **[f727cfe](https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d)**



---

archive/issue_comments_495233.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d\">f727cfe</a></td><td><code>src/requirements.txt.m4: Remove patchlevels from versions</code></td></tr></table>\n",
    "created_at": "2020-12-12T07:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495233",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d">f727cfe</a></td><td><code>src/requirements.txt.m4: Remove patchlevels from versions</code></td></tr></table>




---

archive/issue_events_426374.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-12T07:37:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426374"
}
```



---

archive/issue_events_426375.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-12T07:37:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426375"
}
```



---

archive/issue_events_426376.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-12T07:37:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "title_is": "sagelib: Generate setup.cfg [install_requires], generate requirements.txt",
    "title_was": "sagelib: Add setup.cfg [install_requires]",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426376"
}
```



---

archive/issue_comments_495234.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.\n \n To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n-In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` added in #30578), use\n+In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use\n \n ```\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n``````\n",
    "created_at": "2020-12-12T07:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495234",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.
 
 To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
-In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` added in #30578), use
+In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use
 
 ```
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
``````




---

archive/issue_comments_495235.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nSince the setup.cfg and requirments.txt file are static (do not depend on the developers/users system), I would check them in as normal files instead of auto-generating them as part of the bootstrap. Then one would only need to update them as part of a package update (having a (doc)test to verify that the content of these files is always up-to-date).\n\nA few more observations while scrolling through the code:\n- I think the Licence file should be in the root, so that other tools (e.g. github) automatically pick them up.\n- Are the symlinks really necessary? I would prefer if instead the path of the original is passed to e.g. setuptools.\n- Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?",
    "created_at": "2020-12-12T20:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495235",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:26" align="right">comment:26</div>

Since the setup.cfg and requirments.txt file are static (do not depend on the developers/users system), I would check them in as normal files instead of auto-generating them as part of the bootstrap. Then one would only need to update them as part of a package update (having a (doc)test to verify that the content of these files is always up-to-date).

A few more observations while scrolling through the code:
- I think the Licence file should be in the root, so that other tools (e.g. github) automatically pick them up.
- Are the symlinks really necessary? I would prefer if instead the path of the original is passed to e.g. setuptools.
- Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?



---

archive/issue_comments_495236.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@tobiasdiez](#comment:26):\n> Since the setup.cfg and requirments.txt file are static (do not depend on the developers/users system), I would check them in as normal files instead of auto-generating them as part of the bootstrap.\n\nNo, this is preparation for modularization, in which we will have dozens of packages.\nAuto-generation is key for maintainability.",
    "created_at": "2020-12-12T20:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495236",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@tobiasdiez](#comment:26):
> Since the setup.cfg and requirments.txt file are static (do not depend on the developers/users system), I would check them in as normal files instead of auto-generating them as part of the bootstrap.

No, this is preparation for modularization, in which we will have dozens of packages.
Auto-generation is key for maintainability.



---

archive/issue_comments_495237.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@tobiasdiez](#comment:26):\n> - I think the Licence file should be in the root, so that other tools (e.g. github) automatically pick them up.\n\nThe new file is the license for sagelib. Different from the one in top-level, which is about the Sage distribution.",
    "created_at": "2020-12-12T20:53:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495237",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@tobiasdiez](#comment:26):
> - I think the Licence file should be in the root, so that other tools (e.g. github) automatically pick them up.

The new file is the license for sagelib. Different from the one in top-level, which is about the Sage distribution.



---

archive/issue_comments_495238.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nYou can still auto-generate these files! My suggestion was to only to it when updating a package and not on bootstrap.",
    "created_at": "2020-12-12T20:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495238",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:29" align="right">comment:29</div>

You can still auto-generate these files! My suggestion was to only to it when updating a package and not on bootstrap.



---

archive/issue_comments_495239.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@tobiasdiez](#comment:26):\n> - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?\n\nIt needs to be configurable. For example `local` can be replaced by the user using `./configure --prefix`",
    "created_at": "2020-12-12T20:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495239",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@tobiasdiez](#comment:26):
> - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?

It needs to be configurable. For example `local` can be replaced by the user using `./configure --prefix`



---

archive/issue_comments_495240.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@mkoeppe](#comment:30):\n> Replying to [@tobiasdiez](#comment:26):\n> > - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?\n\n> \n> It needs to be configurable. For example `local` can be replaced by the user using `./configure --prefix`\n\nWhat If I want to have the wheels outside of the current local folder?",
    "created_at": "2020-12-12T20:57:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495240",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@mkoeppe](#comment:30):
> Replying to [@tobiasdiez](#comment:26):
> > - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?

> 
> It needs to be configurable. For example `local` can be replaced by the user using `./configure --prefix`

What If I want to have the wheels outside of the current local folder?



---

archive/issue_comments_495241.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@tobiasdiez](#comment:29):\n> You can still auto-generate these files! My suggestion was to only to it when updating a package and not on bootstrap.\n\nI don't like to have generated files in the git repository. The only files for which we do that (the release manager does, actually) is to update Sage's own version files, and in the long term I would actually change that.",
    "created_at": "2020-12-12T20:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495241",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@tobiasdiez](#comment:29):
> You can still auto-generate these files! My suggestion was to only to it when updating a package and not on bootstrap.

I don't like to have generated files in the git repository. The only files for which we do that (the release manager does, actually) is to update Sage's own version files, and in the long term I would actually change that.



---

archive/issue_comments_495242.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@tobiasdiez](#comment:31):\n> What If I want to have the wheels outside of the current local folder?\n\nYou pass the environment variable to tox",
    "created_at": "2020-12-12T20:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495242",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@tobiasdiez](#comment:31):
> What If I want to have the wheels outside of the current local folder?

You pass the environment variable to tox



---

archive/issue_comments_495243.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nBy the way, we could also generate Pipfile here on this ticket ...",
    "created_at": "2020-12-12T21:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495243",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

By the way, we could also generate Pipfile here on this ticket ...



---

archive/issue_comments_495244.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@tobiasdiez](#comment:26):\n> - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?\n\nI think I misunderstood your question. Yes, the variable `SAGE_SPKG_WHEELS` is expected to point to the full location of the wheels when set. \n\nBut I made a mistake - the `simple` is not expected to be part of `SAGE_SPKG_WHEELS`",
    "created_at": "2020-12-12T21:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495244",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@tobiasdiez](#comment:26):
> - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?

I think I misunderstood your question. Yes, the variable `SAGE_SPKG_WHEELS` is expected to point to the full location of the wheels when set. 

But I made a mistake - the `simple` is not expected to be part of `SAGE_SPKG_WHEELS`



---

archive/issue_comments_495245.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe\">4658e31</a></td><td><code>build/pkgs/sagelib/src/tox.ini: SAGE_SPKG_WHEELS is not expected to point to the 'simple' subdirectory</code></td></tr></table>\n",
    "created_at": "2020-12-12T21:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495245",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe">4658e31</a></td><td><code>build/pkgs/sagelib/src/tox.ini: SAGE_SPKG_WHEELS is not expected to point to the 'simple' subdirectory</code></td></tr></table>




---

archive/issue_comments_495246.json:
```json
{
    "body": "Changed commit from **[f727cfe](https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d)** to **[4658e31](https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe)**",
    "created_at": "2020-12-12T21:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495246",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f727cfe](https://github.com/sagemath/sagetrac-mirror/commit/f727cfe4a2792d70fb0177c448a42d1e6f8b6b3d)** to **[4658e31](https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe)**



---

archive/issue_comments_495247.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@mkoeppe](#comment:35):\n> Replying to [@tobiasdiez](#comment:26):\n> > - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?\n\n> \n> I think I misunderstood your question. Yes, the variable `SAGE_SPKG_WHEELS` is expected to point to the full location of the wheels when set. \n> \n> But I made a mistake - the `simple` is not expected to be part of `SAGE_SPKG_WHEELS`\n\nAnd I missed that the SAGE_LOCAL part is only the fallback in case SAGE_SPKG_WHEELS doesn't exist.",
    "created_at": "2020-12-12T21:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495247",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@mkoeppe](#comment:35):
> Replying to [@tobiasdiez](#comment:26):
> > - Concerning `sagewheels:      --index-url=file://{env:SAGE_SPKG_WHEELS:{env:SAGE_LOCAL:{toxinidir}/../../../../local}/var/lib/sage/wheels/simple}`, wouldn't it be easier to let `SAGE_SPKG_WHEELS` point to the full location of the wheels (e.g. `local/var/lib/sage/wheels/simple`)?

> 
> I think I misunderstood your question. Yes, the variable `SAGE_SPKG_WHEELS` is expected to point to the full location of the wheels when set. 
> 
> But I made a mistake - the `simple` is not expected to be part of `SAGE_SPKG_WHEELS`

And I missed that the SAGE_LOCAL part is only the fallback in case SAGE_SPKG_WHEELS doesn't exist.



---

archive/issue_comments_495248.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b07d0f6bea75f9e3a70897f200f1db2bc43fef65\">b07d0f6</a></td><td><code>src/Pipfile: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5\">fa4ee53</a></td><td><code>build/pkgs/sagelib/bootstrap: Generate Pipfile</code></td></tr></table>\n",
    "created_at": "2020-12-13T01:18:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495248",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b07d0f6bea75f9e3a70897f200f1db2bc43fef65">b07d0f6</a></td><td><code>src/Pipfile: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5">fa4ee53</a></td><td><code>build/pkgs/sagelib/bootstrap: Generate Pipfile</code></td></tr></table>




---

archive/issue_comments_495249.json:
```json
{
    "body": "Changed commit from **[4658e31](https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe)** to **[fa4ee53](https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5)**",
    "created_at": "2020-12-13T01:18:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495249",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4658e31](https://github.com/sagemath/sagetrac-mirror/commit/4658e31e3fc1d98dd3e92ae3b24c00d25426f0fe)** to **[fa4ee53](https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5)**



---

archive/issue_events_426377.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-13T01:19:28Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "title_is": "sagelib: Generate setup.cfg [install_requires], requirements.txt, and Pipfile",
    "title_was": "sagelib: Generate setup.cfg [install_requires], generate requirements.txt",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426377"
}
```



---

archive/issue_events_426378.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-13T12:36:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426378"
}
```



---

archive/issue_events_426379.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-13T12:36:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426379"
}
```



---

archive/issue_comments_495250.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThanks for also generating the pipfile. However, you are currently locking the version of most packages. The idea, however, is that the pipfile is quite liberal, and only specifies the minimal version requirements (e.g. if an older version of a package is known not to work for some reason). The specific package versions are in the pipfile.lock file, which can be automatically generated by pipenv (which also contains versions for the whole dependency tree).",
    "created_at": "2020-12-13T12:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495250",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:40" align="right">comment:40</div>

Thanks for also generating the pipfile. However, you are currently locking the version of most packages. The idea, however, is that the pipfile is quite liberal, and only specifies the minimal version requirements (e.g. if an older version of a package is known not to work for some reason). The specific package versions are in the pipfile.lock file, which can be automatically generated by pipenv (which also contains versions for the whole dependency tree).



---

archive/issue_comments_495251.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nHm... If that is so, then we should generate this information from the version constraints that are in the files `install-requires.txt`.\n\nBut what if the user wants to lock the same versions that are defined in the Sage distribution?\n\nAnd also my guess is that `Pipfile` should then also contain lists of packages that are not actual dependencies of `sagelib` but are present in the Sage distribution. Otherwise, `Pipfile` would just encode the same package and version requirements that are already known by `setup.cfg install-requires` -- that can't be the whole purpose of `Pipfile`.",
    "created_at": "2020-12-13T17:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495251",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

Hm... If that is so, then we should generate this information from the version constraints that are in the files `install-requires.txt`.

But what if the user wants to lock the same versions that are defined in the Sage distribution?

And also my guess is that `Pipfile` should then also contain lists of packages that are not actual dependencies of `sagelib` but are present in the Sage distribution. Otherwise, `Pipfile` would just encode the same package and version requirements that are already known by `setup.cfg install-requires` -- that can't be the whole purpose of `Pipfile`.



---

archive/issue_comments_495252.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI think we should really separate between sage-the-distribution and sage-the-library.\n\nFor a library, you specify the abstract dependencies via `install-requires`. It's important to do that without version information because otherwise that might lead to ugly dependency issues for users of that library (e.g. if another library requires incompatible dependency versions). The pipfile is not really necessary in this case, except that it defines a test/development environment. Here, the pipfile declares the abstract requirements, and the pipfile.lock is saying \"these versions are known to work\". So for sage, one might consider to sync the pipfile.lock with the version information in build/pkgs but that's really hard to do because pipenv also calculates hashes etc (I guess). \n\nFor applications, you declare all dependencies in the pipfile, and use pipenv to create the whole concrete dependency tree meeting all restricts for all dependencies and their subdependencies. Adopting pipenv for this purpose in sage, you could remove all pip-packages from build/pkgs and let pipenv manage all Python dependencies. Then the pipfile indeed would need to declare all packages that are currently present in the sage distribution (so it would more or less correspond to the list of folders in build/pkgs) and the pipfile.lock contains the exact version information, including where to get it and the files hashes (so basically the content of the folders in build/pkgs).\n\nSee https://pipenv.pypa.io/en/latest/advanced/#pipfile-vs-setup-py for more details.\n\nMy proposal would be to use pipenv at the moment only for providing a test environment. In this case, one strategy would be to only put the pipfile (with it's abstract dependencies) under version control, and generate the pipenv.lock as a build artifact (so that if the test fail, one could regenerate the exact same environment locally). Moreover, there could be a second pipfile (and pipfile.lock) in the build folder, specifying the same versions as in the build/pkgs folder (to make it simpler to create a test environment that equals the distributed environment).",
    "created_at": "2020-12-13T21:46:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495252",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:42" align="right">comment:42</div>

I think we should really separate between sage-the-distribution and sage-the-library.

For a library, you specify the abstract dependencies via `install-requires`. It's important to do that without version information because otherwise that might lead to ugly dependency issues for users of that library (e.g. if another library requires incompatible dependency versions). The pipfile is not really necessary in this case, except that it defines a test/development environment. Here, the pipfile declares the abstract requirements, and the pipfile.lock is saying "these versions are known to work". So for sage, one might consider to sync the pipfile.lock with the version information in build/pkgs but that's really hard to do because pipenv also calculates hashes etc (I guess). 

For applications, you declare all dependencies in the pipfile, and use pipenv to create the whole concrete dependency tree meeting all restricts for all dependencies and their subdependencies. Adopting pipenv for this purpose in sage, you could remove all pip-packages from build/pkgs and let pipenv manage all Python dependencies. Then the pipfile indeed would need to declare all packages that are currently present in the sage distribution (so it would more or less correspond to the list of folders in build/pkgs) and the pipfile.lock contains the exact version information, including where to get it and the files hashes (so basically the content of the folders in build/pkgs).

See https://pipenv.pypa.io/en/latest/advanced/#pipfile-vs-setup-py for more details.

My proposal would be to use pipenv at the moment only for providing a test environment. In this case, one strategy would be to only put the pipfile (with it's abstract dependencies) under version control, and generate the pipenv.lock as a build artifact (so that if the test fail, one could regenerate the exact same environment locally). Moreover, there could be a second pipfile (and pipfile.lock) in the build folder, specifying the same versions as in the build/pkgs folder (to make it simpler to create a test environment that equals the distributed environment).



---

archive/issue_comments_495253.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@tobiasdiez](#comment:42):\n> I think we should really separate between sage-the-distribution and sage-the-library.\n> \n> For a library, you specify the abstract dependencies via `install-requires`. It's important to do that without version information because otherwise that might lead to ugly dependency issues for users of that library (e.g. if another library requires incompatible dependency versions).\n\n\"Without version information\" -- surely you mean \"without fixing specific versions\"",
    "created_at": "2020-12-13T21:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495253",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@tobiasdiez](#comment:42):
> I think we should really separate between sage-the-distribution and sage-the-library.
> 
> For a library, you specify the abstract dependencies via `install-requires`. It's important to do that without version information because otherwise that might lead to ugly dependency issues for users of that library (e.g. if another library requires incompatible dependency versions).

"Without version information" -- surely you mean "without fixing specific versions"



---

archive/issue_comments_495254.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@tobiasdiez](#comment:42):\n> I think we should really separate between sage-the-distribution and sage-the-library.\n> \n> For a library, [...]\n\nRight, I would consider sagelib a library...\n\n> For applications, \n\n... which the sage distribution should probably considered to be ...\n\n> you declare all dependencies in the pipfile, and use pipenv to create the whole concrete dependency tree meeting all restricts for all dependencies and their subdependencies. Adopting pipenv for this purpose in sage, you could remove all pip-packages from build/pkgs and let pipenv manage all Python dependencies. \n\nWell, we won't remove the Python packages from `build/pkgs`. But I want to enable the users to use `pipenv` for exactly this at their option. In particular in combination with #30896\t(`./configure --without-sage-venv`) this would be an interesting way to build Sage.\n\n> Then the pipfile indeed would need to declare all packages that are currently present in the sage distribution (so it would more or less correspond to the list of folders in build/pkgs) and the pipfile.lock contains the exact version information, including where to get it and the files hashes (so basically the content of the folders in build/pkgs).\n\nLet's investigate if the `pipfile.lock` file really needs to include hashes or we can get away with automatically generating a weaker version",
    "created_at": "2020-12-13T22:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495254",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@tobiasdiez](#comment:42):
> I think we should really separate between sage-the-distribution and sage-the-library.
> 
> For a library, [...]

Right, I would consider sagelib a library...

> For applications, 

... which the sage distribution should probably considered to be ...

> you declare all dependencies in the pipfile, and use pipenv to create the whole concrete dependency tree meeting all restricts for all dependencies and their subdependencies. Adopting pipenv for this purpose in sage, you could remove all pip-packages from build/pkgs and let pipenv manage all Python dependencies. 

Well, we won't remove the Python packages from `build/pkgs`. But I want to enable the users to use `pipenv` for exactly this at their option. In particular in combination with #30896	(`./configure --without-sage-venv`) this would be an interesting way to build Sage.

> Then the pipfile indeed would need to declare all packages that are currently present in the sage distribution (so it would more or less correspond to the list of folders in build/pkgs) and the pipfile.lock contains the exact version information, including where to get it and the files hashes (so basically the content of the folders in build/pkgs).

Let's investigate if the `pipfile.lock` file really needs to include hashes or we can get away with automatically generating a weaker version



---

archive/issue_comments_495255.json:
```json
{
    "body": "Changed commit from **[fa4ee53](https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5)** to **[406968b](https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a)**",
    "created_at": "2020-12-15T01:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495255",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fa4ee53](https://github.com/sagemath/sagetrac-mirror/commit/fa4ee53c5cb87ade62b31383c7df6db1dba173d5)** to **[406968b](https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a)**



---

archive/issue_comments_495256.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad242940df18edc6302812287731f22a1b9dce44\">ad24294</a></td><td><code>tox.ini: Simplify, use sage-get-system-packages, sage-package list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a77a6bf5cf13edb74e4b17a8e169c238fceee99\">1a77a6b</a></td><td><code>build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57\">35241e7</a></td><td><code>src/doc/en/developer/portability_testing.rst: Update paths in documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249\">68baff1</a></td><td><code>Makefile (configure): Update dependency on moved files build/pkgs/*.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2\">fae4bd0</a></td><td><code>bootstrap: Remove --enable-_recommended etc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830\">a9bd145</a></td><td><code>m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d\">571cc49</a></td><td><code>Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000\">c529729</a></td><td><code>Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6\">b73d6f0</a></td><td><code>Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a\">406968b</a></td><td><code>Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2020-12-15T01:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495256",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad242940df18edc6302812287731f22a1b9dce44">ad24294</a></td><td><code>tox.ini: Simplify, use sage-get-system-packages, sage-package list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a77a6bf5cf13edb74e4b17a8e169c238fceee99">1a77a6b</a></td><td><code>build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57">35241e7</a></td><td><code>src/doc/en/developer/portability_testing.rst: Update paths in documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249">68baff1</a></td><td><code>Makefile (configure): Update dependency on moved files build/pkgs/*.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2">fae4bd0</a></td><td><code>bootstrap: Remove --enable-_recommended etc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830">a9bd145</a></td><td><code>m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d">571cc49</a></td><td><code>Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000">c529729</a></td><td><code>Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6">b73d6f0</a></td><td><code>Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a">406968b</a></td><td><code>Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495257.json:
```json
{
    "body": "Changed dependencies from **#30578, #30912** to **#30578, #30912, #29124**",
    "created_at": "2020-12-15T01:06:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495257",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30578, #30912** to **#30578, #30912, #29124**



---

archive/issue_comments_495258.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad242940df18edc6302812287731f22a1b9dce44\">ad24294</a></td><td><code>tox.ini: Simplify, use sage-get-system-packages, sage-package list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a77a6bf5cf13edb74e4b17a8e169c238fceee99\">1a77a6b</a></td><td><code>build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57\">35241e7</a></td><td><code>src/doc/en/developer/portability_testing.rst: Update paths in documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249\">68baff1</a></td><td><code>Makefile (configure): Update dependency on moved files build/pkgs/*.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2\">fae4bd0</a></td><td><code>bootstrap: Remove --enable-_recommended etc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830\">a9bd145</a></td><td><code>m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d\">571cc49</a></td><td><code>Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000\">c529729</a></td><td><code>Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6\">b73d6f0</a></td><td><code>Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a\">406968b</a></td><td><code>Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2020-12-15T01:06:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495258",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad242940df18edc6302812287731f22a1b9dce44">ad24294</a></td><td><code>tox.ini: Simplify, use sage-get-system-packages, sage-package list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a77a6bf5cf13edb74e4b17a8e169c238fceee99">1a77a6b</a></td><td><code>build/bin/write-dockerfile.sh: Remove special casing of build/pkgs/$SYSTEM.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35241e7cc31dd679bc491028d7186629c2f97c57">35241e7</a></td><td><code>src/doc/en/developer/portability_testing.rst: Update paths in documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68baff143410209e56af62dc81eb6ec38ba12249">68baff1</a></td><td><code>Makefile (configure): Update dependency on moved files build/pkgs/*.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fae4bd089c019cc0e27929d78a2b85b5e4dfa3a2">fae4bd0</a></td><td><code>bootstrap: Remove --enable-_recommended etc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9bd1455bf3762c21957bcf4da3e06750897b830">a9bd145</a></td><td><code>m4/sage_spkg_collect.m4: Remove _recommended etc. from the configure package summary</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/571cc490c2efebe12bdac19490b9a2f8b058475d">571cc49</a></td><td><code>Merge branch 't/30947/src_doc_bootstrap__simplify_by_using_new_options_of__sage__package_list_' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c529729783bd328c3180d0faa2c90071319fa000">c529729</a></td><td><code>Merge commit '3bb309944b7e8542b2ac88ed3c9d9a60e68644d7' of git://trac.sagemath.org/sage into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b73d6f0e1f6d4bfc7e6442b1eeb4fef76c9f9ec6">b73d6f0</a></td><td><code>Merge tag '9.3.beta4' into t/29124/script-packages-prereq-toolchain-bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a">406968b</a></td><td><code>Merge branch 't/29124/script-packages-prereq-toolchain-bootstrap' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495259.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@mkoeppe](#comment:43):\n> \"Without version information\" -- surely you mean \"without fixing specific versions\"\n\nWell, only specifying known upper and lower bounds for the versions. Maybe it would make sense to add min/max version information in build/pkgs?\n\n\n> Let's investigate if the pipfile.lock file really needs to include hashes or we can get away with automatically generating a weaker version.\n\nThe hashes and the complete dependency tree is what makes pipenv special over requirements.txt. For applications (i.e. sage distribution), it should be fine to pin the versions in the pipfile (in the build folder). Normally you don't want to do this because it makes upgrades harder (if the versions are free, you can simply run `pipenv update` for this). But since upgrades are done differently in sage anyway, it should be fine.\n\nSo what you think about the following:\n- One pipfile in build (pipfile.lock in gitignore) with all packages in the distribution and version information locked (for users to use pipenv to install pip packages)\n- One pipfile in src (pipfile.lock in gitignore) with all dependencies of sagelib and version information as free as possible (for developers to generate a dev environment, and for CI as test environment)",
    "created_at": "2020-12-15T12:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495259",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@mkoeppe](#comment:43):
> "Without version information" -- surely you mean "without fixing specific versions"

Well, only specifying known upper and lower bounds for the versions. Maybe it would make sense to add min/max version information in build/pkgs?


> Let's investigate if the pipfile.lock file really needs to include hashes or we can get away with automatically generating a weaker version.

The hashes and the complete dependency tree is what makes pipenv special over requirements.txt. For applications (i.e. sage distribution), it should be fine to pin the versions in the pipfile (in the build folder). Normally you don't want to do this because it makes upgrades harder (if the versions are free, you can simply run `pipenv update` for this). But since upgrades are done differently in sage anyway, it should be fine.

So what you think about the following:
- One pipfile in build (pipfile.lock in gitignore) with all packages in the distribution and version information locked (for users to use pipenv to install pip packages)
- One pipfile in src (pipfile.lock in gitignore) with all dependencies of sagelib and version information as free as possible (for developers to generate a dev environment, and for CI as test environment)



---

archive/issue_comments_495260.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@tobiasdiez](#comment:47):\n> Maybe it would make sense to add min/max version information in build/pkgs?\n\nThis information was recently added in the files `install-requires.txt`\nand this is what we are generating `setup.cfg [install_requires]` from.",
    "created_at": "2020-12-16T22:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495260",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@tobiasdiez](#comment:47):
> Maybe it would make sense to add min/max version information in build/pkgs?

This information was recently added in the files `install-requires.txt`
and this is what we are generating `setup.cfg [install_requires]` from.



---

archive/issue_comments_495261.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@tobiasdiez](#comment:47):\n> So what you think about the following:\n> - One pipfile in build (pipfile.lock in gitignore) with all packages in the distribution and version information locked (for users to use pipenv to install pip packages)\n\nYes, we can do this; except I would put in `SAGE_ROOT`, not `SAGE_ROOT/build`. (We create environment files for conda there already. And `build` is the location of the `setup.py` of `sage_bootstrap` - so that would be confusing.)\n\n> - One pipfile in src (pipfile.lock in gitignore) with all dependencies of sagelib and version information as free as possible (for developers to generate a dev environment, and for CI as test environment)  \n\nOK.",
    "created_at": "2020-12-17T17:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495261",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@tobiasdiez](#comment:47):
> So what you think about the following:
> - One pipfile in build (pipfile.lock in gitignore) with all packages in the distribution and version information locked (for users to use pipenv to install pip packages)

Yes, we can do this; except I would put in `SAGE_ROOT`, not `SAGE_ROOT/build`. (We create environment files for conda there already. And `build` is the location of the `setup.py` of `sage_bootstrap` - so that would be confusing.)

> - One pipfile in src (pipfile.lock in gitignore) with all dependencies of sagelib and version information as free as possible (for developers to generate a dev environment, and for CI as test environment)  

OK.



---

archive/issue_comments_495262.json:
```json
{
    "body": "Changed commit from **[406968b](https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a)** to **[ea1d153](https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269)**",
    "created_at": "2020-12-17T17:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495262",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[406968b](https://github.com/sagemath/sagetrac-mirror/commit/406968b98473b4db63157acf88b1aa836399558a)** to **[ea1d153](https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269)**



---

archive/issue_comments_495263.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c5f967f7d8e479e6cda627dc49ec0dd2bfc8212\">0c5f967</a></td><td><code>build/pkgs/sagelib/bootstrap: Also generate SAGE_ROOT/Pipfile</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269\">ea1d153</a></td><td><code>Pipfile, src/Pipfile: Add comments</code></td></tr></table>\n",
    "created_at": "2020-12-17T17:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495263",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:50"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c5f967f7d8e479e6cda627dc49ec0dd2bfc8212">0c5f967</a></td><td><code>build/pkgs/sagelib/bootstrap: Also generate SAGE_ROOT/Pipfile</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269">ea1d153</a></td><td><code>Pipfile, src/Pipfile: Add comments</code></td></tr></table>




---

archive/issue_comments_495264.json:
```json
{
    "body": "Changed commit from **[ea1d153](https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269)** to **[3cccd32](https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6)**",
    "created_at": "2020-12-17T18:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495264",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ea1d153](https://github.com/sagemath/sagetrac-mirror/commit/ea1d1537ef7b49cd7e48f9172d449d9ba3459269)** to **[3cccd32](https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6)**



---

archive/issue_comments_495265.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6\">3cccd32</a></td><td><code>src/Pipfile.m4: Get version info from install-requires.txt, not package-version.txt</code></td></tr></table>\n",
    "created_at": "2020-12-17T18:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495265",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6">3cccd32</a></td><td><code>src/Pipfile.m4: Get version info from install-requires.txt, not package-version.txt</code></td></tr></table>




---

archive/issue_comments_495266.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf\">c8aeed7</a></td><td><code>Pipfile.m4, src/Pipfile.m4: Not editable</code></td></tr></table>\n",
    "created_at": "2020-12-17T18:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495266",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf">c8aeed7</a></td><td><code>Pipfile.m4, src/Pipfile.m4: Not editable</code></td></tr></table>




---

archive/issue_comments_495267.json:
```json
{
    "body": "Changed commit from **[3cccd32](https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6)** to **[c8aeed7](https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf)**",
    "created_at": "2020-12-17T18:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495267",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3cccd32](https://github.com/sagemath/sagetrac-mirror/commit/3cccd32d641d7710249fab92093f3d96b2cc58e6)** to **[c8aeed7](https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf)**



---

archive/issue_comments_495268.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nOK, here is a version as a starting point.",
    "created_at": "2020-12-17T18:07:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495268",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

OK, here is a version as a starting point.



---

archive/issue_comments_495269.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nHelp with getting the pipfiles in shape would be very welcome",
    "created_at": "2020-12-17T18:38:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495269",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:54" align="right">comment:54</div>

Help with getting the pipfiles in shape would be very welcome



---

archive/issue_comments_495270.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@mkoeppe](#comment:48):\n> This information was recently added in the files `install-requires.txt`\n> and this is what we are generating `setup.cfg [install_requires]` from.\n\nOk, good to know!",
    "created_at": "2020-12-18T12:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495270",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@mkoeppe](#comment:48):
> This information was recently added in the files `install-requires.txt`
> and this is what we are generating `setup.cfg [install_requires]` from.

Ok, good to know!



---

archive/issue_comments_495271.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@mkoeppe](#comment:54):\n> Help with getting the pipfiles in shape would be very welcome\n\nYou took the initial pipfile from my ticket, right? They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).",
    "created_at": "2020-12-18T12:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495271",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@mkoeppe](#comment:54):
> Help with getting the pipfiles in shape would be very welcome

You took the initial pipfile from my ticket, right? They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).



---

archive/issue_comments_495272.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nFor the files in build/pkgs/sagelib, are they meant for distribution? In this case, it's probably enough to add only the pipfile in the root there (since src/pipfile is for developers only).\n\nSince the pipfile in the root seems to be only for distribution, why not put it directly in `build/pgks/sagelib`?",
    "created_at": "2020-12-18T12:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495272",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:57" align="right">comment:57</div>

For the files in build/pkgs/sagelib, are they meant for distribution? In this case, it's probably enough to add only the pipfile in the root there (since src/pipfile is for developers only).

Since the pipfile in the root seems to be only for distribution, why not put it directly in `build/pgks/sagelib`?



---

archive/issue_comments_495273.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@tobiasdiez](#comment:56):\n> Replying to [@mkoeppe](#comment:54):\n> > Help with getting the pipfiles in shape would be very welcome\n\n> \n> You took the initial pipfile from my ticket, right? \n\nYes\n\n> They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).\n\nThe version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.",
    "created_at": "2020-12-21T18:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495273",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@tobiasdiez](#comment:56):
> Replying to [@mkoeppe](#comment:54):
> > Help with getting the pipfiles in shape would be very welcome

> 
> You took the initial pipfile from my ticket, right? 

Yes

> They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).

The version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.



---

archive/issue_comments_495274.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@mkoeppe](#comment:58):\n> > They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).\n\n> \n> The version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.\n> \n\nPipenv will use the prebuilt wheels anyway, so there is no point in installing build dependencies for these packages, right?",
    "created_at": "2020-12-22T10:28:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495274",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@mkoeppe](#comment:58):
> > They actually look good to me. I'm not sure which packages are missing (as the sagedocs seem to mostly pass with the current ones). Note that pipenv is able to resolve sub-dependencies automatically, so they don't need to be specified in the pipfile (but are in build/pkgs of course).

> 
> The version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.
> 

Pipenv will use the prebuilt wheels anyway, so there is no point in installing build dependencies for these packages, right?



---

archive/issue_comments_495275.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@tobiasdiez](#comment:59):\n> > The version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.\n> > \n\n> \n> Pipenv will use the prebuilt wheels anyway, so there is no point in installing build dependencies for these packages, right?\n\nMost dependencies are actually not just build dependencies but runtime dependencies.\nFor example - `matplotlib` depends on `dateutil`",
    "created_at": "2020-12-22T14:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495275",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@tobiasdiez](#comment:59):
> > The version of the pipfile that pins the versions to the sage distribution's versions will need the pinnings of these dependencies.
> > 

> 
> Pipenv will use the prebuilt wheels anyway, so there is no point in installing build dependencies for these packages, right?

Most dependencies are actually not just build dependencies but runtime dependencies.
For example - `matplotlib` depends on `dateutil`



---

archive/issue_comments_495276.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n-As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n+\n+As part of `bootstrap`, we now generate the `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n+\n+**Testing requirements.txt:**\n+\n+A virtual environment using it can be created and doctested using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n+\n+**Testing install-requires:**\n \n To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use\n@@ -6,3 +19,19 @@\n ```\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n ```\n+\n+**Testing Pipfile:**\n+\n+- Use pipenv\n+\n+**Related or follow-up tickets:**\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 `sage_bootstrap`: Add command \"sage -package list --output={install-requires,requirements,pipfile,debian,....}\"\n+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+ \n+\n+\n+\n+\n``````\n",
    "created_at": "2021-01-18T04:44:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495276",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,17 @@
-As part of `bootstrap`, we generate the `install_requires` information using m4 from the information added in #30719.
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
+
+As part of `bootstrap`, we now generate the `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
+
+**Testing requirements.txt:**
+
+A virtual environment using it can be created and doctested using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)
+
+**Testing install-requires:**
 
 To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
 In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use
@@ -6,3 +19,19 @@
 ```
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
 ```
+
+**Testing Pipfile:**
+
+- Use pipenv
+
+**Related or follow-up tickets:**
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 `sage_bootstrap`: Add command "sage -package list --output={install-requires,requirements,pipfile,debian,....}"
+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+ 
+
+
+
+
``````




---

archive/issue_comments_495277.json:
```json
{
    "body": "Changed dependencies from **#30578, #30912, #29124** to **#30912, #29124**",
    "created_at": "2021-01-18T04:44:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495277",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30578, #30912, #29124** to **#30912, #29124**



---

archive/issue_comments_495278.json:
```json
{
    "body": "Changed dependencies from **#30912, #29124** to **#30527, #30912, #29124**",
    "created_at": "2021-01-18T04:48:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495278",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30912, #29124** to **#30527, #30912, #29124**



---

archive/issue_comments_495279.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124** to **#30527, #30912, #29124, #31261**",
    "created_at": "2021-01-18T20:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495279",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124** to **#30527, #30912, #29124, #31261**



---

archive/issue_comments_495280.json:
```json
{
    "body": "<div id=\"comment:64\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f1e3bb30900ce80f3bbefee7fdd5ff35937e2f2\">5f1e3bb</a></td><td><code>build/pkgs/pplpy: Update to 0.8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02c6cd998457b5c7b145be8430d44993f76d3c1f\">02c6cd9</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Update, add comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22\">bdc9912</a></td><td><code>Merge branch 't/31261/update_pplpy_to_0_8_6' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-01-18T20:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495280",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:64"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f1e3bb30900ce80f3bbefee7fdd5ff35937e2f2">5f1e3bb</a></td><td><code>build/pkgs/pplpy: Update to 0.8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02c6cd998457b5c7b145be8430d44993f76d3c1f">02c6cd9</a></td><td><code>build/pkgs/pplpy/install-requires.txt: Update, add comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22">bdc9912</a></td><td><code>Merge branch 't/31261/update_pplpy_to_0_8_6' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495281.json:
```json
{
    "body": "Changed commit from **[c8aeed7](https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf)** to **[bdc9912](https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22)**",
    "created_at": "2021-01-18T20:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495281",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c8aeed7](https://github.com/sagemath/sagetrac-mirror/commit/c8aeed7454c5828dd94e92818228068e5637c7cf)** to **[bdc9912](https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22)**



---

archive/issue_comments_495282.json:
```json
{
    "body": "<div id=\"comment:65\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acfc409ae99e538d8abbe027bdb80634c78da769\">acfc409</a></td><td><code>src/setup.cfg.m4: Add fpylll dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c\">338211c</a></td><td><code>src/requirements.txt.m4: Update pplpy, add fpylll</code></td></tr></table>\n",
    "created_at": "2021-01-18T20:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495282",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:65"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acfc409ae99e538d8abbe027bdb80634c78da769">acfc409</a></td><td><code>src/setup.cfg.m4: Add fpylll dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c">338211c</a></td><td><code>src/requirements.txt.m4: Update pplpy, add fpylll</code></td></tr></table>




---

archive/issue_comments_495283.json:
```json
{
    "body": "Changed commit from **[bdc9912](https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22)** to **[338211c](https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c)**",
    "created_at": "2021-01-18T20:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495283",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bdc9912](https://github.com/sagemath/sagetrac-mirror/commit/bdc991292e0c912e05cef54a2a8ce0d288c1ce22)** to **[338211c](https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c)**



---

archive/issue_events_426380.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-18T20:50:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "title_is": "sagelib: Generate setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile",
    "title_was": "sagelib: Generate setup.cfg [install_requires], requirements.txt, and Pipfile",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426380"
}
```



---

archive/issue_comments_495284.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,7 +20,7 @@\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n ```\n \n-**Testing Pipfile:**\n+**Testing Pipfile and src/Pipfile:**\n \n - Use pipenv\n \n``````\n",
    "created_at": "2021-01-18T20:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495284",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,7 +20,7 @@
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
 ```
 
-**Testing Pipfile:**
+**Testing Pipfile and src/Pipfile:**
 
 - Use pipenv
 
``````




---

archive/issue_comments_495285.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n A virtual environment using it can be created and doctested using:\n \n ```\n-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n ```\n (Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n \n@@ -17,7 +17,7 @@\n In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use\n \n ```\n-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n ```\n \n **Testing Pipfile and src/Pipfile:**\n``````\n",
    "created_at": "2021-01-19T01:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495285",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 A virtual environment using it can be created and doctested using:
 
 ```
-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
 ```
 (Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)
 
@@ -17,7 +17,7 @@
 In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use
 
 ```
-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
 ```
 
 **Testing Pipfile and src/Pipfile:**
``````




---

archive/issue_comments_495286.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nWhen trying to use the \"install-requires\" method, I am running into the problem that Cython does not seem to find the `.pxd` files of build requirements that are provided in pip's build isolation, such as `cysignals`.",
    "created_at": "2021-01-19T01:52:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495286",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

When trying to use the "install-requires" method, I am running into the problem that Cython does not seem to find the `.pxd` files of build requirements that are provided in pip's build isolation, such as `cysignals`.



---

archive/issue_comments_495287.json:
```json
{
    "body": "<div id=\"comment:69\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c1e6480b19a84745d0007f5a330412f7ec9b7fe\">2c1e648</a></td><td><code>src/sage_setup/command/sage_build_cython.py: Remove top-level imports from sage.env, Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88c4e8c946b6e93381b4ef0b035ff4f21a1f30f5\">88c4e8c</a></td><td><code>src/setup.py: Make 'setup.py sdist' work without Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a05a537dff521aed6560694f26d3ec19a6f5a1dc\">a05a537</a></td><td><code>src/pyproject.toml: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15a6c2b353b6c1a1ebed1964e1f3ab41fbbfae39\">15a6c2b</a></td><td><code>Merge branch 't/30580/sage_setup__remove_import_time_dependency___setup_requires___on__pkgconfig____numpy_' into t/30581/pyproject_toml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/310ebd11a9149c85a746a5da0f9ae5b86d5250db\">310ebd1</a></td><td><code>Merge tag '9.3.beta1' into t/30581/pyproject_toml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbfc19eb5ed799c2f0302ecaecddd904a9cf3bf1\">bbfc19e</a></td><td><code>build/pkgs/sagelib/src: Apply PEP 517 changes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/563d908cee64a60e95942de89ae52857ab78bbcc\">563d908</a></td><td><code>Merge branch 't/30913/sagelib__add_setup_cfg__install_requires_' into t/30581/pyproject_toml</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55a61d32a115055353c2bd0dde23e6d47fc3be60\">55a61d3</a></td><td><code>WIP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fac10c1b274d32feaa04384c9602f34d45240fcd\">fac10c1</a></td><td><code>Merge branch 't/30581/pyproject_toml' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32\">b84d478</a></td><td><code>src/pyproject.toml: Generate with m4, add more to [build-system] requires</code></td></tr></table>\n",
    "created_at": "2021-01-19T07:36:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495287",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:69"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c1e6480b19a84745d0007f5a330412f7ec9b7fe">2c1e648</a></td><td><code>src/sage_setup/command/sage_build_cython.py: Remove top-level imports from sage.env, Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88c4e8c946b6e93381b4ef0b035ff4f21a1f30f5">88c4e8c</a></td><td><code>src/setup.py: Make 'setup.py sdist' work without Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a05a537dff521aed6560694f26d3ec19a6f5a1dc">a05a537</a></td><td><code>src/pyproject.toml: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15a6c2b353b6c1a1ebed1964e1f3ab41fbbfae39">15a6c2b</a></td><td><code>Merge branch 't/30580/sage_setup__remove_import_time_dependency___setup_requires___on__pkgconfig____numpy_' into t/30581/pyproject_toml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/310ebd11a9149c85a746a5da0f9ae5b86d5250db">310ebd1</a></td><td><code>Merge tag '9.3.beta1' into t/30581/pyproject_toml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbfc19eb5ed799c2f0302ecaecddd904a9cf3bf1">bbfc19e</a></td><td><code>build/pkgs/sagelib/src: Apply PEP 517 changes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/563d908cee64a60e95942de89ae52857ab78bbcc">563d908</a></td><td><code>Merge branch 't/30913/sagelib__add_setup_cfg__install_requires_' into t/30581/pyproject_toml</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55a61d32a115055353c2bd0dde23e6d47fc3be60">55a61d3</a></td><td><code>WIP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fac10c1b274d32feaa04384c9602f34d45240fcd">fac10c1</a></td><td><code>Merge branch 't/30581/pyproject_toml' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32">b84d478</a></td><td><code>src/pyproject.toml: Generate with m4, add more to [build-system] requires</code></td></tr></table>




---

archive/issue_comments_495288.json:
```json
{
    "body": "Changed commit from **[338211c](https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c)** to **[b84d478](https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32)**",
    "created_at": "2021-01-19T07:36:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495288",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[338211c](https://github.com/sagemath/sagetrac-mirror/commit/338211cef2a6141b2650119fd6031456e67d742c)** to **[b84d478](https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32)**



---

archive/issue_comments_495289.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n-As part of `bootstrap`, we now generate the `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n+As part of `bootstrap`, we now generate the `pyproject.toml` and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n \n **Testing requirements.txt:**\n \n@@ -11,10 +11,10 @@\n ```\n (Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n \n-**Testing install-requires:**\n+**Testing pyproject.toml and install-requires:**\n \n To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n-In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use\n+In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use\n \n ```\n ./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n``````\n",
    "created_at": "2021-01-20T21:04:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495289",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
-As part of `bootstrap`, we now generate the `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
+As part of `bootstrap`, we now generate the `pyproject.toml` and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
 
 **Testing requirements.txt:**
 
@@ -11,10 +11,10 @@
 ```
 (Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)
 
-**Testing install-requires:**
+**Testing pyproject.toml and install-requires:**
 
 To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
-In particular, to use `install_requires` only (and not the concrete requirements from `requirements.txt` first added in #30578 and now generated too), use
+In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use
 
 ```
 ./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
``````




---

archive/issue_comments_495290.json:
```json
{
    "body": "Changed commit from **[b84d478](https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32)** to **[9949076](https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a)**",
    "created_at": "2021-01-20T22:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495290",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b84d478](https://github.com/sagemath/sagetrac-mirror/commit/b84d4783b65efcee6581110f0f756da329331f32)** to **[9949076](https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a)**



---

archive/issue_comments_495291.json:
```json
{
    "body": "<div id=\"comment:71\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/580b36abb92c6dad8087feb5ebb5490b9c1fa4d1\">580b36a</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Clean up</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b426012fa647de20a3eb84cba85b326f05cb4674\">b426012</a></td><td><code>src/pyproject.toml.m4: Add sage-conf as a build-system requires=</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a\">9949076</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Use environment variables instead of options for pip, use find-links instead of index-url</code></td></tr></table>\n",
    "created_at": "2021-01-20T22:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495291",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:71"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/580b36abb92c6dad8087feb5ebb5490b9c1fa4d1">580b36a</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Clean up</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b426012fa647de20a3eb84cba85b326f05cb4674">b426012</a></td><td><code>src/pyproject.toml.m4: Add sage-conf as a build-system requires=</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a">9949076</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Use environment variables instead of options for pip, use find-links instead of index-url</code></td></tr></table>




---

archive/issue_comments_495292.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\n`./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -r -v -v -v -e python-sagewheels-norequirements)'` now gets all the way to here:\n\n```\n/pkgs/sagelib/src/.tox/python-sagewheels-norequirements/bin/sage -c 'import sys; print(\"sys.path =\", sys.path); import sage.all; print(sage.all.__file__)'\nTraceback (most recent call last):\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python-sagewheels-norequirements/bin/sage-location\", line 11, in <module>\n    SAGE_ROOT     = os.path.realpath(os.environ['SAGE_ROOT'])\n  File \"/usr/local/Cellar/python@3.9/3.9.1_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/os.py\", line 679, in __getitem__\n    raise KeyError(key) from None\nKeyError: 'SAGE_ROOT'\n```\nSo let's finally get rid of this `sage-location` business in #21783.",
    "created_at": "2021-01-20T23:03:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495292",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:72" align="right">comment:72</div>

`./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -r -v -v -v -e python-sagewheels-norequirements)'` now gets all the way to here:

```
/pkgs/sagelib/src/.tox/python-sagewheels-norequirements/bin/sage -c 'import sys; print("sys.path =", sys.path); import sage.all; print(sage.all.__file__)'
Traceback (most recent call last):
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python-sagewheels-norequirements/bin/sage-location", line 11, in <module>
    SAGE_ROOT     = os.path.realpath(os.environ['SAGE_ROOT'])
  File "/usr/local/Cellar/python@3.9/3.9.1_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/os.py", line 679, in __getitem__
    raise KeyError(key) from None
KeyError: 'SAGE_ROOT'
```
So let's finally get rid of this `sage-location` business in #21783.



---

archive/issue_comments_495293.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261** to **#30527, #30912, #29124, #31261, #21783, #31270**",
    "created_at": "2021-01-21T00:42:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495293",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261** to **#30527, #30912, #29124, #31261, #21783, #31270**



---

archive/issue_comments_495294.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,9 @@\n After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n-As part of `bootstrap`, we now generate the `pyproject.toml` and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n+As part of `bootstrap`, we now generate the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n+\n+(Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n+\n \n **Testing requirements.txt:**\n \n@@ -33,5 +36,9 @@\n  \n \n \n+References:\n+- https://snarky.ca/what-the-heck-is-pyproject-toml/\n \n \n+\n+\n``````\n",
    "created_at": "2021-01-21T00:44:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495294",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,9 @@
 After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
-As part of `bootstrap`, we now generate the `pyproject.toml` and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
+As part of `bootstrap`, we now generate the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
+
+(Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)
+
 
 **Testing requirements.txt:**
 
@@ -33,5 +36,9 @@
  
 
 
+References:
+- https://snarky.ca/what-the-heck-is-pyproject-toml/
 
 
+
+
``````




---

archive/issue_events_426381.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-21T00:46:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "title_is": "sagelib: Generate pyproject.toml and setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile",
    "title_was": "sagelib: Generate setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426381"
}
```



---

archive/issue_comments_495295.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,9 +10,9 @@\n A virtual environment using it can be created and doctested using:\n \n ```\n-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v python-sagewheels)'\n ```\n-(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n+\n \n **Testing pyproject.toml and install-requires:**\n \n@@ -20,7 +20,7 @@\n In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use\n \n ```\n-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'\n+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'\n ```\n \n **Testing Pipfile and src/Pipfile:**\n``````\n",
    "created_at": "2021-01-21T01:44:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495295",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,9 +10,9 @@
 A virtual environment using it can be created and doctested using:
 
 ```
-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v python-sagewheels)'
 ```
-(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)
+
 
 **Testing pyproject.toml and install-requires:**
 
@@ -20,7 +20,7 @@
 In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use
 
 ```
-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-norequirements)'
+./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'
 ```
 
 **Testing Pipfile and src/Pipfile:**
``````




---

archive/issue_comments_495296.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e40ee84cc8414061a6921b48bbaa9e7b33de29d\">3e40ee8</a></td><td><code>build/pkgs/qepcad/spkg-install.in: Generate default.qepcadrc instead of doing this in src/bin/sage-location</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e37c3fc525351a9e153c44843dea85dc3ea18bd\">3e37c3f</a></td><td><code>build/bin/sage-spkg, src/bin/sage, src/bin/sage-location: Remove sage-force-relocate mechanism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/287dc70b82317ccbd9fac75af7aafd9082e51e84\">287dc70</a></td><td><code>src/doc/it/faq/faq-usage.rst: rimuovi gli antichi consigli relativi alla posizione della salvia</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1dfc9202b48521e495fefd19617ebe68291c6367\">1dfc920</a></td><td><code>src/bin/sage-location: Do not fail if SAGE_ROOT is not set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0e48166ea72e0085082912a21afc194522b92a8\">b0e4816</a></td><td><code>src/bin/sage-location: Do not output 2 lines announcing a no-op</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a2d9fd47dc2f880ff5af500006654f9c77dc18f\">5a2d9fd</a></td><td><code>Merge branch 't/31270/remove-sage-location' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391\">26da7ce</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add tox environments 'pipenv-...'</code></td></tr></table>\n",
    "created_at": "2021-01-21T02:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495296",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e40ee84cc8414061a6921b48bbaa9e7b33de29d">3e40ee8</a></td><td><code>build/pkgs/qepcad/spkg-install.in: Generate default.qepcadrc instead of doing this in src/bin/sage-location</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e37c3fc525351a9e153c44843dea85dc3ea18bd">3e37c3f</a></td><td><code>build/bin/sage-spkg, src/bin/sage, src/bin/sage-location: Remove sage-force-relocate mechanism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/287dc70b82317ccbd9fac75af7aafd9082e51e84">287dc70</a></td><td><code>src/doc/it/faq/faq-usage.rst: rimuovi gli antichi consigli relativi alla posizione della salvia</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1dfc9202b48521e495fefd19617ebe68291c6367">1dfc920</a></td><td><code>src/bin/sage-location: Do not fail if SAGE_ROOT is not set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0e48166ea72e0085082912a21afc194522b92a8">b0e4816</a></td><td><code>src/bin/sage-location: Do not output 2 lines announcing a no-op</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a2d9fd47dc2f880ff5af500006654f9c77dc18f">5a2d9fd</a></td><td><code>Merge branch 't/31270/remove-sage-location' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391">26da7ce</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add tox environments 'pipenv-...'</code></td></tr></table>




---

archive/issue_comments_495297.json:
```json
{
    "body": "Changed commit from **[9949076](https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a)** to **[26da7ce](https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391)**",
    "created_at": "2021-01-21T02:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495297",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9949076](https://github.com/sagemath/sagetrac-mirror/commit/99490769da4064a7e5ee9d4dc046ce581d36146a)** to **[26da7ce](https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391)**



---

archive/issue_comments_495298.json:
```json
{
    "body": "<div id=\"comment:78\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b\">fabc9ce</a></td><td><code>src/setup.cfg.m4: Do not use 'file: VERSION.txt', which pipenv does not like</code></td></tr></table>\n",
    "created_at": "2021-01-21T02:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495298",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b">fabc9ce</a></td><td><code>src/setup.cfg.m4: Do not use 'file: VERSION.txt', which pipenv does not like</code></td></tr></table>




---

archive/issue_comments_495299.json:
```json
{
    "body": "Changed commit from **[26da7ce](https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391)** to **[fabc9ce](https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b)**",
    "created_at": "2021-01-21T02:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495299",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[26da7ce](https://github.com/sagemath/sagetrac-mirror/commit/26da7cedebc2b5dd09f1035efc6f052ee757a391)** to **[fabc9ce](https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b)**



---

archive/issue_comments_495300.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,7 @@\n \n (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n \n+To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n \n **Testing requirements.txt:**\n \n@@ -16,16 +17,14 @@\n \n **Testing pyproject.toml and install-requires:**\n \n-To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n-In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use\n-\n ```\n ./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'\n ```\n \n **Testing Pipfile and src/Pipfile:**\n \n-- Use pipenv\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'\n+\n \n **Related or follow-up tickets:**\n - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n``````\n",
    "created_at": "2021-01-21T02:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495300",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,7 @@
 
 (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)
 
+To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
 
 **Testing requirements.txt:**
 
@@ -16,16 +17,14 @@
 
 **Testing pyproject.toml and install-requires:**
 
-To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
-In particular, to use `pyproject.toml` and `install_requires` only (and not the concrete requirements from `requirements.txt`), use
-
 ```
 ./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'
 ```
 
 **Testing Pipfile and src/Pipfile:**
 
-- Use pipenv
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'
+
 
 **Related or follow-up tickets:**
 - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
``````




---

archive/issue_comments_495301.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\n`./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'` now leads to ...\n\n```\npipenv.exceptions.ResolutionFailure: ERROR: Could not find a version that matches gmpy2>=2.1.0b5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenvt6rhur8arequirements/pipenv-53ckyr68-constraints.txt (line 2))\nTried: 2.0.1, 2.0.2, 2.0.3, 2.0.4, 2.0.5, 2.0.6, 2.0.7, 2.0.8\nSkipped pre-versions: 2.1.0a1, 2.1.0a2, 2.1.0a3, 2.1.0a4, 2.1.0b1, 2.1.0b3, 2.1.0b4, 2.1.0b5, 2.1.0b5\n```",
    "created_at": "2021-01-21T02:20:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495301",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:80" align="right">comment:80</div>

`./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'` now leads to ...

```
pipenv.exceptions.ResolutionFailure: ERROR: Could not find a version that matches gmpy2>=2.1.0b5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenvt6rhur8arequirements/pipenv-53ckyr68-constraints.txt (line 2))
Tried: 2.0.1, 2.0.2, 2.0.3, 2.0.4, 2.0.5, 2.0.6, 2.0.7, 2.0.8
Skipped pre-versions: 2.1.0a1, 2.1.0a2, 2.1.0a3, 2.1.0a4, 2.1.0b1, 2.1.0b3, 2.1.0b4, 2.1.0b5, 2.1.0b5
```



---

archive/issue_comments_495302.json:
```json
{
    "body": "<div id=\"comment:81\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a\">d758025</a></td><td><code>build/pkgs/gmpy2/install-requires.txt: Use == for the benefit of pipenv</code></td></tr></table>\n",
    "created_at": "2021-01-21T03:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495302",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:81"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a">d758025</a></td><td><code>build/pkgs/gmpy2/install-requires.txt: Use == for the benefit of pipenv</code></td></tr></table>




---

archive/issue_comments_495303.json:
```json
{
    "body": "Changed commit from **[fabc9ce](https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b)** to **[d758025](https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a)**",
    "created_at": "2021-01-21T03:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495303",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fabc9ce](https://github.com/sagemath/sagetrac-mirror/commit/fabc9ce08f2c5b0c1f3aee35bf2c81dd7120293b)** to **[d758025](https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a)**



---

archive/issue_comments_495304.json:
```json
{
    "body": "Changed commit from **[d758025](https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a)** to **[9c2c3e1](https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d)**",
    "created_at": "2021-01-21T08:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495304",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d758025](https://github.com/sagemath/sagetrac-mirror/commit/d7580259c240deb25675cbfcd80c75edee72fd0a)** to **[9c2c3e1](https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d)**



---

archive/issue_comments_495305.json:
```json
{
    "body": "<div id=\"comment:82\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d\">9c2c3e1</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Use  PIPENV_SKIP_LOCK=true</code></td></tr></table>\n",
    "created_at": "2021-01-21T08:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495305",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:82"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d">9c2c3e1</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Use  PIPENV_SKIP_LOCK=true</code></td></tr></table>




---

archive/issue_comments_495306.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nAs is to be expected, if the correct version of a package is not already built in `local/var/lib/sage/wheels` and `pipenv` tries to build the wheel, this can fail\n\n```\n  Building wheels for collected packages: pplpy\n    Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-jcmfqod5\n    Destination directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-jcmfqod5\n    Building wheel for pplpy (PEP 517): started\n...\n    ld: library not found for -lpari\n    clang: error: linker command failed with exit code 1 (use -v to see invocation)\n    error: command '/usr/bin/clang++' failed with exit code 1\n    Building wheel for pplpy (PEP 517): finished with status 'error'\n    ERROR: Failed building wheel for pplpy\n  Failed to build pplpy\n```",
    "created_at": "2021-01-21T08:23:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495306",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:83" align="right">comment:83</div>

As is to be expected, if the correct version of a package is not already built in `local/var/lib/sage/wheels` and `pipenv` tries to build the wheel, this can fail

```
  Building wheels for collected packages: pplpy
    Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-jcmfqod5
    Destination directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-jcmfqod5
    Building wheel for pplpy (PEP 517): started
...
    ld: library not found for -lpari
    clang: error: linker command failed with exit code 1 (use -v to see invocation)
    error: command '/usr/bin/clang++' failed with exit code 1
    Building wheel for pplpy (PEP 517): finished with status 'error'
    ERROR: Failed building wheel for pplpy
  Failed to build pplpy
```



---

archive/issue_comments_495307.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\n\n```\nUsing version 0.8.7 (newest of versions: 0.8.6, 0.8.7)\nCollecting pplpy>=0.8.6\n```",
    "created_at": "2021-01-21T08:32:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495307",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:84" align="right">comment:84</div>


```
Using version 0.8.7 (newest of versions: 0.8.6, 0.8.7)
Collecting pplpy>=0.8.6
```



---

archive/issue_comments_495308.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nI released pplpy 0.8.7 to fix a weird issue with clang-11.0.0 on FreeBSD, see https://gitlab.com/videlec/pplpy/-/issues/21. As far as SageMath is concerned, there should be no difference.",
    "created_at": "2021-01-21T08:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495308",
    "user": "https://github.com/videlec"
}
```

<div id="comment:85" align="right">comment:85</div>

I released pplpy 0.8.7 to fix a weird issue with clang-11.0.0 on FreeBSD, see https://gitlab.com/videlec/pplpy/-/issues/21. As far as SageMath is concerned, there should be no difference.



---

archive/issue_comments_495309.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nThanks for the update, Vincent. There is no problem.",
    "created_at": "2021-01-21T18:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495309",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:86" align="right">comment:86</div>

Thanks for the update, Vincent. There is no problem.



---

archive/issue_comments_495310.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,8 +23,9 @@\n \n **Testing Pipfile and src/Pipfile:**\n \n+```\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'\n-\n+```\n \n **Related or follow-up tickets:**\n - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n``````\n",
    "created_at": "2021-01-22T02:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495310",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,8 +23,9 @@
 
 **Testing Pipfile and src/Pipfile:**
 
+```
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'
-
+```
 
 **Related or follow-up tickets:**
 - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
``````




---

archive/issue_comments_495311.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279**",
    "created_at": "2021-01-22T20:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495311",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279**



---

archive/issue_comments_495312.json:
```json
{
    "body": "<div id=\"comment:89\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4273b7f15ee42fa40362d168f103f600981f009\">f4273b7</a></td><td><code>build/pkgs/argon2_cffi: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cec11b3db582d600607bb0b49193b22d185d804\">3cec11b</a></td><td><code>build/pkgs/notebook/dependencies: Add argon2_cffi</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324\">de05284</a></td><td><code>Merge branch 't/31279/add_package_argon2_cffi' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-01-22T21:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495312",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:89"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4273b7f15ee42fa40362d168f103f600981f009">f4273b7</a></td><td><code>build/pkgs/argon2_cffi: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cec11b3db582d600607bb0b49193b22d185d804">3cec11b</a></td><td><code>build/pkgs/notebook/dependencies: Add argon2_cffi</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324">de05284</a></td><td><code>Merge branch 't/31279/add_package_argon2_cffi' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495313.json:
```json
{
    "body": "Changed commit from **[9c2c3e1](https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d)** to **[de05284](https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324)**",
    "created_at": "2021-01-22T21:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495313",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9c2c3e1](https://github.com/sagemath/sagetrac-mirror/commit/9c2c3e1beff798917445a08c71fe33907bda8e6d)** to **[de05284](https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324)**



---

archive/issue_comments_495314.json:
```json
{
    "body": "Changed commit from **[de05284](https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324)** to **[f5f9ac6](https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7)**",
    "created_at": "2021-01-23T02:06:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495314",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[de05284](https://github.com/sagemath/sagetrac-mirror/commit/de05284de0bd4ab88afbbe945c1d483ae7360324)** to **[f5f9ac6](https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7)**



---

archive/issue_comments_495315.json:
```json
{
    "body": "<div id=\"comment:90\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d19802cb20e47e941fb14f522762504a06e651e\">1d19802</a></td><td><code>Build and store wheels for setuptools, pip, wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7\">f5f9ac6</a></td><td><code>Merge branch 't/31045/pip__wheel__setuptools__make_wheels_or_source_archives_available_in_sage_spkg_wheels' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-01-23T02:06:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495315",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:90"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d19802cb20e47e941fb14f522762504a06e651e">1d19802</a></td><td><code>Build and store wheels for setuptools, pip, wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7">f5f9ac6</a></td><td><code>Merge branch 't/31045/pip__wheel__setuptools__make_wheels_or_source_archives_available_in_sage_spkg_wheels' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495316.json:
```json
{
    "body": "<div id=\"comment:91\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94004909f14418867571704ca84d20f03d50fd4f\">9400490</a></td><td><code>Pipfile.m4: Add sagemath-standard (sagelib)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d\">664d553</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add pipenv-dist</code></td></tr></table>\n",
    "created_at": "2021-01-23T03:39:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495316",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:91"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94004909f14418867571704ca84d20f03d50fd4f">9400490</a></td><td><code>Pipfile.m4: Add sagemath-standard (sagelib)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d">664d553</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add pipenv-dist</code></td></tr></table>




---

archive/issue_comments_495317.json:
```json
{
    "body": "Changed commit from **[f5f9ac6](https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7)** to **[664d553](https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d)**",
    "created_at": "2021-01-23T03:39:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495317",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f5f9ac6](https://github.com/sagemath/sagetrac-mirror/commit/f5f9ac63c5b49a6fd25e56a50503fa471e765ec7)** to **[664d553](https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d)**



---

archive/issue_comments_495318.json:
```json
{
    "body": "Changed commit from **[664d553](https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d)** to **[7acfb58](https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a)**",
    "created_at": "2021-01-23T04:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495318",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[664d553](https://github.com/sagemath/sagetrac-mirror/commit/664d5535562c2e1f2ea64b157c2157e5f6ab4a6d)** to **[7acfb58](https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a)**



---

archive/issue_comments_495319.json:
```json
{
    "body": "<div id=\"comment:92\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a\">7acfb58</a></td><td><code>build/pkgs/sympy/install-requires.txt: Allow 1.7.x versions</code></td></tr></table>\n",
    "created_at": "2021-01-23T04:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495319",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:92"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a">7acfb58</a></td><td><code>build/pkgs/sympy/install-requires.txt: Allow 1.7.x versions</code></td></tr></table>




---

archive/issue_comments_495320.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045**",
    "created_at": "2021-01-23T04:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495320",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045**



---

archive/issue_events_426382.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-23T04:27:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426382"
}
```



---

archive/issue_events_426383.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-23T04:27:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426383"
}
```



---

archive/issue_comments_495321.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,31 +1,11 @@\n After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n-As part of `bootstrap`, we now generate the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n+As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n \n (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n \n-To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.\n+To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`.\n \n-**Testing requirements.txt:**\n-\n-A virtual environment using it can be created and doctested using:\n-\n-```\n-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v python-sagewheels)'\n-```\n-\n-\n-**Testing pyproject.toml and install-requires:**\n-\n-```\n-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'\n-```\n-\n-**Testing Pipfile and src/Pipfile:**\n-\n-```\n-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'\n-```\n \n **Related or follow-up tickets:**\n - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n``````\n",
    "created_at": "2021-01-23T04:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495321",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,31 +1,11 @@
 After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
-As part of `bootstrap`, we now generate the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, `requirements.txt` and `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
+As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
 
 (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)
 
-To test - see instructions in `build/pkgs/sagelib/src/tox.ini`.
+To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`.
 
-**Testing requirements.txt:**
-
-A virtual environment using it can be created and doctested using:
-
-```
-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v python-sagewheels)'
-```
-
-
-**Testing pyproject.toml and install-requires:**
-
-```
-./bootstrap && ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-norequirements)'
-```
-
-**Testing Pipfile and src/Pipfile:**
-
-```
-./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-pipenv-sagewheels)'
-```
 
 **Related or follow-up tickets:**
 - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
``````




---

archive/issue_comments_495322.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nThis seems to work well now - but the variants using pipenv fail in mysterious ways. I have marked these variants as \"experimental\" in the comments in `build/pkgs/sagelib/src/tox.ini`.\n\nReady for review.",
    "created_at": "2021-01-23T04:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495322",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:94" align="right">comment:94</div>

This seems to work well now - but the variants using pipenv fail in mysterious ways. I have marked these variants as "experimental" in the comments in `build/pkgs/sagelib/src/tox.ini`.

Ready for review.



---

archive/issue_comments_495323.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nWhat errors / problems do you have with pipenv?",
    "created_at": "2021-01-23T10:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495323",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:95" align="right">comment:95</div>

What errors / problems do you have with pipenv?



---

archive/issue_comments_495324.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@tobiasdiez](#comment:95):\n> What errors / problems do you have with pipenv?\n\nMost recently - it did not accept the existing wheel of the latest version and is deciding to build another wheel of the same version:\n\n```\nLocal files found: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/var/lib/sage/wheels/fpylll-0.5.4-cp39-cp39-macosx_10_15_x86_64.whl\nChecked 2 links for project 'fpylll' against 2 hashes (1 matches, 1 no digest): discarding no candidates\nUsing version 0.5.4 (newest of versions: 0.5.4)\nCollecting fpylll==0.5.4\n  Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-unpack-hnc4lgb4\n  Looking up \"https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz\" in the cache\n  Current age based on date: 1384\n  Ignoring unknown cache-control directive: immutable\n  Freshness lifetime from max-age: 365000000\n  The response is \"fresh\", returning cached response\n  365000000 > 1384\n  Using cached fpylll-0.5.4.tar.gz (115 kB)\n  Added fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1)) to build tracker '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-6cth3jj8'\n    Running setup.py (path:/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py) egg_info for package fpylll\n    Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i\n    Running command python setup.py egg_info\n    running egg_info\n    creating /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info\n    writing /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/PKG-INFO\n    writing dependency_links to /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/dependency_links.txt\n    writing top-level names to /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/top_level.txt\n    writing manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'\n    Package fplll was not found in the pkg-config search path.\n    Perhaps you should add the directory containing `fplll.pc'\n    to the PKG_CONFIG_PATH environment variable\n    No package 'fplll' found\n    reading manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'\n    reading manifest template 'MANIFEST.in'\n    no previously-included directories found matching 'build'\n    no previously-included directories found matching 'dist'\n    writing manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'\n  Source in /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll has version 0.5.4, which satisfies requirement fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1))\n  Removed fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1)) from build tracker '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-6cth3jj8'\nBuilding wheels for collected packages: fpylll\n  Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab\n  Building wheel for fpylll (setup.py): started\n  Destination directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab\n  Running command /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python-sagewheels-pipenv-dist/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py'\"'\"'; __file__='\"'\"'/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab\n  running bdist_wheel\n```\n\nOverall, despite cranking up verbosity, it's quite opaque",
    "created_at": "2021-01-23T18:52:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495324",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@tobiasdiez](#comment:95):
> What errors / problems do you have with pipenv?

Most recently - it did not accept the existing wheel of the latest version and is deciding to build another wheel of the same version:

```
Local files found: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/var/lib/sage/wheels/fpylll-0.5.4-cp39-cp39-macosx_10_15_x86_64.whl
Checked 2 links for project 'fpylll' against 2 hashes (1 matches, 1 no digest): discarding no candidates
Using version 0.5.4 (newest of versions: 0.5.4)
Collecting fpylll==0.5.4
  Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-unpack-hnc4lgb4
  Looking up "https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz" in the cache
  Current age based on date: 1384
  Ignoring unknown cache-control directive: immutable
  Freshness lifetime from max-age: 365000000
  The response is "fresh", returning cached response
  365000000 > 1384
  Using cached fpylll-0.5.4.tar.gz (115 kB)
  Added fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1)) to build tracker '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-6cth3jj8'
    Running setup.py (path:/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py) egg_info for package fpylll
    Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i
    Running command python setup.py egg_info
    running egg_info
    creating /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info
    writing /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/PKG-INFO
    writing dependency_links to /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/dependency_links.txt
    writing top-level names to /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/top_level.txt
    writing manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'
    Package fplll was not found in the pkg-config search path.
    Perhaps you should add the directory containing `fplll.pc'
    to the PKG_CONFIG_PATH environment variable
    No package 'fplll' found
    reading manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    no previously-included directories found matching 'build'
    no previously-included directories found matching 'dist'
    writing manifest file '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-pip-egg-info-nldn300i/fpylll.egg-info/SOURCES.txt'
  Source in /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll has version 0.5.4, which satisfies requirement fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1))
  Removed fpylll==0.5.4 from https://files.pythonhosted.org/packages/ad/c5/f30f354dcce03b928702414fdbdd916d60915c6b144360c88707784385bb/fpylll-0.5.4.tar.gz#sha256=0f8433b682bf030d9285eaf460cefdffccc4d04d60da46828ee523bc61d553f5 (from -r /var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pipenv-d79lavpe-requirements/pipenv-p7sezg0u-requirement.txt (line 1)) from build tracker '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-6cth3jj8'
Building wheels for collected packages: fpylll
  Created temporary directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab
  Building wheel for fpylll (setup.py): started
  Destination directory: /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab
  Running command /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python-sagewheels-pipenv-dist/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py'"'"'; __file__='"'"'/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-install-lhezbhsm/fpylll/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' bdist_wheel -d /private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-wheel-eygv6kab
  running bdist_wheel
```

Overall, despite cranking up verbosity, it's quite opaque



---

archive/issue_comments_495325.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nMhh, with this I have no experience, as I've always took the wheel from pypi or had the build dependencies installed. \n\nMaybe it works if you set `prefer_binary = true`. In general, the selection seems to follow the following criteria:\nhttps://github.com/pypa/pipenv/blob/cda15b3b30e04e038ee286bced6c47a311f1e0ec/pipenv/patched/notpip/_internal/index/package_finder.py#L503-L517",
    "created_at": "2021-01-23T19:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495325",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:97" align="right">comment:97</div>

Mhh, with this I have no experience, as I've always took the wheel from pypi or had the build dependencies installed. 

Maybe it works if you set `prefer_binary = true`. In general, the selection seems to follow the following criteria:
https://github.com/pypa/pipenv/blob/cda15b3b30e04e038ee286bced6c47a311f1e0ec/pipenv/patched/notpip/_internal/index/package_finder.py#L503-L517



---

archive/issue_comments_495326.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nThanks, that's something to explore in a follow up.\n\nFor this ticket I think I don't want to spend more time on `pipenv`. The other, more elementary, ways of installing things are working fine.",
    "created_at": "2021-01-23T19:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495326",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:98" align="right">comment:98</div>

Thanks, that's something to explore in a follow up.

For this ticket I think I don't want to spend more time on `pipenv`. The other, more elementary, ways of installing things are working fine.



---

archive/issue_comments_495327.json:
```json
{
    "body": "Work Issues: **perhaps merge #31321**",
    "created_at": "2021-02-02T02:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495327",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **perhaps merge #31321**



---

archive/issue_comments_495328.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nOne more point for discussion is if the pipfile should list the dependencies or if it is enough to only put them in the install_requires.\nNormally, the advice seems to be to put them only in install_requires, but that's mainly to capture missing dependencies and not bother to keep the files in sync. But since they are now automatically generated, I'm not sure how to precede. \n\nSome discussions on this point: https://github.com/psf/requests/blob/967a05bfffcb68f97296eda197b062221c2ebc0d/Pipfile#L25 and \"Problem: Hiding broken setup.py defined dependencies\" in https://github.com/pypa/pipenv/issues/1911. See also discussion in https://github.com/pypa/pipenv/issues/1263 and https://pipenv-fork.readthedocs.io/en/latest/advanced.html#pipfile-vs-setup-py",
    "created_at": "2021-02-04T22:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495328",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:0" align="right">comment:0</div>

One more point for discussion is if the pipfile should list the dependencies or if it is enough to only put them in the install_requires.
Normally, the advice seems to be to put them only in install_requires, but that's mainly to capture missing dependencies and not bother to keep the files in sync. But since they are now automatically generated, I'm not sure how to precede. 

Some discussions on this point: https://github.com/psf/requests/blob/967a05bfffcb68f97296eda197b062221c2ebc0d/Pipfile#L25 and "Problem: Hiding broken setup.py defined dependencies" in https://github.com/pypa/pipenv/issues/1911. See also discussion in https://github.com/pypa/pipenv/issues/1263 and https://pipenv-fork.readthedocs.io/en/latest/advanced.html#pipfile-vs-setup-py



---

archive/issue_comments_495329.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWhich of the two Pipfiles are you talking about?",
    "created_at": "2021-02-04T23:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495329",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Which of the two Pipfiles are you talking about?



---

archive/issue_comments_495330.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nMostly the one in the src folder, but I guess the question actually applies to both.",
    "created_at": "2021-02-05T13:27:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495330",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:2" align="right">comment:2</div>

Mostly the one in the src folder, but I guess the question actually applies to both.



---

archive/issue_comments_495331.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAs per previous discussion, `SAGE_ROOT/Pipfile.m4` (= `Pipfile-dist.m4`) locks all package versions to the one in the Sage distribution (see comment at top -- many packages are still missing in this file, this needs work). As `setup.cfg [install_requires]` only has version ranges, we cannot reduce this Pipfile.\n\nI agree with your comment regarding `src/Pipfile.m4`. Indeed the packages that are already specified in `setup.cfg [install_requires]` should not appear here - mainly for clarity (as you point out, by design we do not have the synchronization issues mentioned in the discussions). I will make this change.\n\nActually for several packages, whether they should appear in `setup.cfg [install_requires]` or not is a bit of a question. Later refinements can happen later, and will certainly as modularization comes along.",
    "created_at": "2021-02-05T19:04:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495331",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

As per previous discussion, `SAGE_ROOT/Pipfile.m4` (= `Pipfile-dist.m4`) locks all package versions to the one in the Sage distribution (see comment at top -- many packages are still missing in this file, this needs work). As `setup.cfg [install_requires]` only has version ranges, we cannot reduce this Pipfile.

I agree with your comment regarding `src/Pipfile.m4`. Indeed the packages that are already specified in `setup.cfg [install_requires]` should not appear here - mainly for clarity (as you point out, by design we do not have the synchronization issues mentioned in the discussions). I will make this change.

Actually for several packages, whether they should appear in `setup.cfg [install_requires]` or not is a bit of a question. Later refinements can happen later, and will certainly as modularization comes along.



---

archive/issue_comments_495332.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321**",
    "created_at": "2021-02-05T19:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495332",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321**



---

archive/issue_comments_495333.json:
```json
{
    "body": "Changed work issues from **perhaps merge #31321** to none",
    "created_at": "2021-02-05T19:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495333",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **perhaps merge #31321** to none



---

archive/issue_comments_495334.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nSounds good to me!",
    "created_at": "2021-02-05T19:13:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495334",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:5" align="right">comment:5</div>

Sounds good to me!



---

archive/issue_comments_495335.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18466f041190f8843dc35d9f6ba49a36562f7512\">18466f0</a></td><td><code>build/pkgs/wheel/install-requires.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ec310e54306f39d061082694d43a75eabc8921a\">8ec310e</a></td><td><code>src/doc/en/developer/packaging.rst: Explain install-requires.txt (from https://wiki.sagemath.org/ReleaseTours/sage-9.3)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a92c517b750b3320a997947b853052cff158aab\">5a92c51</a></td><td><code>build/pkgs/texttable/install-requires.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52add22562d5cf057f57a296d50c24293c2b1b06\">52add22</a></td><td><code>build/pkgs/wheel/install-requires.txt: No space after >=</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce2118cc4c71de5ea1edffabac8da9d94d9d095d\">ce2118c</a></td><td><code>Merge branch 't/31321/build_pkgs__add_some_missing_metadata' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a\">e90a327</a></td><td><code>src/Pipfile.m4: Do not list packages that are already declared as install_requires</code></td></tr></table>\n",
    "created_at": "2021-02-05T19:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495335",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18466f041190f8843dc35d9f6ba49a36562f7512">18466f0</a></td><td><code>build/pkgs/wheel/install-requires.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ec310e54306f39d061082694d43a75eabc8921a">8ec310e</a></td><td><code>src/doc/en/developer/packaging.rst: Explain install-requires.txt (from https://wiki.sagemath.org/ReleaseTours/sage-9.3)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a92c517b750b3320a997947b853052cff158aab">5a92c51</a></td><td><code>build/pkgs/texttable/install-requires.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52add22562d5cf057f57a296d50c24293c2b1b06">52add22</a></td><td><code>build/pkgs/wheel/install-requires.txt: No space after >=</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce2118cc4c71de5ea1edffabac8da9d94d9d095d">ce2118c</a></td><td><code>Merge branch 't/31321/build_pkgs__add_some_missing_metadata' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a">e90a327</a></td><td><code>src/Pipfile.m4: Do not list packages that are already declared as install_requires</code></td></tr></table>




---

archive/issue_comments_495336.json:
```json
{
    "body": "Changed commit from **[7acfb58](https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a)** to **[e90a327](https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a)**",
    "created_at": "2021-02-05T19:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495336",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7acfb58](https://github.com/sagemath/sagetrac-mirror/commit/7acfb5847c60024e81360acf3d7e229a06a79f7a)** to **[e90a327](https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a)**



---

archive/issue_comments_495337.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nNot much is left in `src/Pipfile.m4` now...\n\nAny thoughts on `python_version`?",
    "created_at": "2021-02-05T19:18:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495337",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Not much is left in `src/Pipfile.m4` now...

Any thoughts on `python_version`?



---

archive/issue_comments_495338.json:
```json
{
    "body": "Changed commit from **[e90a327](https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a)** to **[62004b6](https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379)**",
    "created_at": "2021-02-05T19:21:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495338",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e90a327](https://github.com/sagemath/sagetrac-mirror/commit/e90a327f7977e0e9c979e14cfdaf5422255dd45a)** to **[62004b6](https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379)**



---

archive/issue_comments_495339.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379\">62004b6</a></td><td><code>src/setup.cfg.m4: Add python_requires</code></td></tr></table>\n",
    "created_at": "2021-02-05T19:21:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495339",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379">62004b6</a></td><td><code>src/setup.cfg.m4: Add python_requires</code></td></tr></table>




---

archive/issue_comments_495340.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321, #30589**",
    "created_at": "2021-02-05T19:25:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495340",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321** to **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321, #30589**



---

archive/issue_comments_495341.json:
```json
{
    "body": "Changed commit from **[62004b6](https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379)** to **[c58389f](https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d)**",
    "created_at": "2021-02-05T19:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495341",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[62004b6](https://github.com/sagemath/sagetrac-mirror/commit/62004b6de841b7b0d5d122292041d5ac71236379)** to **[c58389f](https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d)**



---

archive/issue_comments_495342.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29aee87fc01f6fce3cc4356c98f27c44e4ce2b5b\">29aee87</a></td><td><code>build/pkgs/python3: Update to 3.9.0rc2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e61d464292262d80c43895c64fce4f48a6895822\">e61d464</a></td><td><code>build/pkgs/python3: Update to 3.9.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f8bb56d16600c8cfe1bab1d127f3931ca280dff0\">f8bb56d</a></td><td><code>build/pkgs/python3: Update to 3.9.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e3513fcb3e2efa1832db8bd7957a93ad75b215c\">0e3513f</a></td><td><code>build/pkgs/pip: Update to 20.3.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41d7e7a74441e5f9deb3e7a93adfccf486dde417\">41d7e7a</a></td><td><code>Merge branch 'u/jhpalmieri/new_wheel' of git://trac.sagemath.org/sage into t/30589/upgrade-python-3.9</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d\">c58389f</a></td><td><code>Merge branch 't/30589/upgrade-python-3.9' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-02-05T19:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495342",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29aee87fc01f6fce3cc4356c98f27c44e4ce2b5b">29aee87</a></td><td><code>build/pkgs/python3: Update to 3.9.0rc2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e61d464292262d80c43895c64fce4f48a6895822">e61d464</a></td><td><code>build/pkgs/python3: Update to 3.9.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f8bb56d16600c8cfe1bab1d127f3931ca280dff0">f8bb56d</a></td><td><code>build/pkgs/python3: Update to 3.9.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e3513fcb3e2efa1832db8bd7957a93ad75b215c">0e3513f</a></td><td><code>build/pkgs/pip: Update to 20.3.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41d7e7a74441e5f9deb3e7a93adfccf486dde417">41d7e7a</a></td><td><code>Merge branch 'u/jhpalmieri/new_wheel' of git://trac.sagemath.org/sage into t/30589/upgrade-python-3.9</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d">c58389f</a></td><td><code>Merge branch 't/30589/upgrade-python-3.9' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495343.json:
```json
{
    "body": "Changed commit from **[c58389f](https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d)** to **[3f8de03](https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60)**",
    "created_at": "2021-02-05T19:27:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495343",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c58389f](https://github.com/sagemath/sagetrac-mirror/commit/c58389ff91f3133c39841a292bbb05b96519e81d)** to **[3f8de03](https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60)**



---

archive/issue_comments_495344.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60\">3f8de03</a></td><td><code>Pipfile.m4: require python_version = 3.9</code></td></tr></table>\n",
    "created_at": "2021-02-05T19:27:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495344",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60">3f8de03</a></td><td><code>Pipfile.m4: require python_version = 3.9</code></td></tr></table>




---

archive/issue_comments_495345.json:
```json
{
    "body": "Changed commit from **[3f8de03](https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60)** to **[c7150c6](https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d)**",
    "created_at": "2021-02-05T19:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495345",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3f8de03](https://github.com/sagemath/sagetrac-mirror/commit/3f8de0329ac35ac4ed42c86a985168d412513f60)** to **[c7150c6](https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d)**



---

archive/issue_comments_495346.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d\">c7150c6</a></td><td><code>src/Pipfile.m4: Remove [requires] python_version; rely on range provided by setup.cfg [python_requires]</code></td></tr></table>\n",
    "created_at": "2021-02-05T19:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495346",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d">c7150c6</a></td><td><code>src/Pipfile.m4: Remove [requires] python_version; rely on range provided by setup.cfg [python_requires]</code></td></tr></table>




---

archive/issue_comments_495347.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nReplying to [@mkoeppe](#comment:107):\n> Any thoughts on `python_version`? \n\nFor now I have fixed it in `SAGE_ROOT/Pipfile`, added the supported range to `src/setup.cfg` and removed the setting from `src/Pipfile`",
    "created_at": "2021-02-05T19:49:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495347",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:113" align="right">comment:113</div>

Replying to [@mkoeppe](#comment:107):
> Any thoughts on `python_version`? 

For now I have fixed it in `SAGE_ROOT/Pipfile`, added the supported range to `src/setup.cfg` and removed the setting from `src/Pipfile`



---

archive/issue_comments_495348.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI agree, this seems to be the way to go.",
    "created_at": "2021-02-05T21:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495348",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

I agree, this seems to be the way to go.



---

archive/issue_comments_495349.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f82935770ab4b84fb167850b1a0341dbb52c3644\">f829357</a></td><td><code>Merge tag '9.3.beta7' into t/31321/build_pkgs__add_some_missing_metadata</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2\">f581fce</a></td><td><code>Merge branch 't/31321/build_pkgs__add_some_missing_metadata' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-02-07T20:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495349",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f82935770ab4b84fb167850b1a0341dbb52c3644">f829357</a></td><td><code>Merge tag '9.3.beta7' into t/31321/build_pkgs__add_some_missing_metadata</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2">f581fce</a></td><td><code>Merge branch 't/31321/build_pkgs__add_some_missing_metadata' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495350.json:
```json
{
    "body": "Changed commit from **[c7150c6](https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d)** to **[f581fce](https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2)**",
    "created_at": "2021-02-07T20:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495350",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c7150c6](https://github.com/sagemath/sagetrac-mirror/commit/c7150c62ec0f0e3a13c72a7a1cb085084f639a3d)** to **[f581fce](https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2)**



---

archive/issue_comments_495351.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321, #30589** to **#30527, #30912, #31279, #31045, #31321**",
    "created_at": "2021-02-07T20:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495351",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #29124, #31261, #21783, #31270, #31279, #31045, #31321, #30589** to **#30527, #30912, #31279, #31045, #31321**



---

archive/issue_comments_495352.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,17 +4,35 @@\n \n (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n \n-To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`.\n+To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`:\n \n-\n+```\n+    #\n+    # SUPPORTED ENVIRONMENTS:\n+    #\n+    # Build dependencies according to requirements.txt (all versions fixed).\n+    # Use ONLY the wheels built and stored by the Sage distribution (no PyPI):\n+    #\n+    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'\n+    #\n+    python-sagewheels-nopypi,\n+    #\n+    # Build and test without using the concrete dependencies specified by requirements.txt,\n+    # using the dependencies declared in pyproject.toml and setup.cfg (install-requires) only:\n+    # Still use ONLY the wheels built and stored by the Sage distribution (no PyPI).\n+    #\n+    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi-norequirements)'\n+    #\n+    python-sagewheels-nopypi-norequirements,\n+    #\n+```\n **Related or follow-up tickets:**\n+- #31377 `./configure --enable-editable`\n - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n - #28752 Make sagelib pip-installable in a conda environment\n - #30371 In-place (editable) installs of sagelib in a venv\n - #29041 `sage_bootstrap`: Add command \"sage -package list --output={install-requires,requirements,pipfile,debian,....}\"\n - add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n- \n-\n \n References:\n - https://snarky.ca/what-the-heck-is-pyproject-toml/\n``````\n",
    "created_at": "2021-02-12T17:25:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495352",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,17 +4,35 @@
 
 (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)
 
-To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`.
+To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`:
 
-
+```
+    #
+    # SUPPORTED ENVIRONMENTS:
+    #
+    # Build dependencies according to requirements.txt (all versions fixed).
+    # Use ONLY the wheels built and stored by the Sage distribution (no PyPI):
+    #
+    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'
+    #
+    python-sagewheels-nopypi,
+    #
+    # Build and test without using the concrete dependencies specified by requirements.txt,
+    # using the dependencies declared in pyproject.toml and setup.cfg (install-requires) only:
+    # Still use ONLY the wheels built and stored by the Sage distribution (no PyPI).
+    #
+    #   ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi-norequirements)'
+    #
+    python-sagewheels-nopypi-norequirements,
+    #
+```
 **Related or follow-up tickets:**
+- #31377 `./configure --enable-editable`
 - #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
 - #28752 Make sagelib pip-installable in a conda environment
 - #30371 In-place (editable) installs of sagelib in a venv
 - #29041 `sage_bootstrap`: Add command "sage -package list --output={install-requires,requirements,pipfile,debian,....}"
 - add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
- 
-
 
 References:
 - https://snarky.ca/what-the-heck-is-pyproject-toml/
``````




---

archive/issue_comments_495353.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n+After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n \n``````\n",
    "created_at": "2021-02-12T17:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495353",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
+After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
 As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
 
``````




---

archive/issue_comments_495354.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db\">1e529d7</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass environment variables set by .homebrew-build-env</code></td></tr></table>\n",
    "created_at": "2021-02-12T19:04:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495354",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db">1e529d7</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass environment variables set by .homebrew-build-env</code></td></tr></table>




---

archive/issue_comments_495355.json:
```json
{
    "body": "Changed commit from **[f581fce](https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2)** to **[1e529d7](https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db)**",
    "created_at": "2021-02-12T19:04:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495355",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f581fce](https://github.com/sagemath/sagetrac-mirror/commit/f581fce5dec2815f0440f4f97b7d5e0118632fa2)** to **[1e529d7](https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db)**



---

archive/issue_comments_495356.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #31279, #31045, #31321** to **#30527, #30912, #31279, #31045, #31321, #31357**",
    "created_at": "2021-02-12T20:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495356",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #31279, #31045, #31321** to **#30527, #30912, #31279, #31045, #31321, #31357**



---

archive/issue_comments_495357.json:
```json
{
    "body": "Changed commit from **[1e529d7](https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db)** to **[aa2f1f8](https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866)**",
    "created_at": "2021-02-12T20:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495357",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1e529d7](https://github.com/sagemath/sagetrac-mirror/commit/1e529d7f89688c00b0745a339d9ea962af0d16db)** to **[aa2f1f8](https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866)**



---

archive/issue_comments_495358.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ad4c0e6da58f8851cfbced0e9c1a66c9479f918\">7ad4c0e</a></td><td><code>Merge tag '9.3.beta4' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d2e597a19d3bacc3277760879d52accac43a280\">8d2e597</a></td><td><code>Merge #30912</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45e5cd24f864ad35a176944cfe4d13840a962054\">45e5cd2</a></td><td><code>build/pkgs/argon2_cffi/spkg-install.in: Handle SAGE_FAT_BINARY</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5feab6eebead08363b08d8bd6fed81595716c59\">d5feab6</a></td><td><code>Merge #31279</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5603f694552baad5d7e80645be23156be4902d91\">5603f69</a></td><td><code>Merge #31045</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbd4c116fd0977cd7119305c62700e67159efb28\">cbd4c11</a></td><td><code>Merge #31321</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1a0a20844a0420e18bb6793997af1a3e91c0724\">d1a0a20</a></td><td><code>bootstrap: Generate pyproject.toml and setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ffa05350361acc79c928b59945b867192eba18d1\">ffa0535</a></td><td><code>build/pkgs/gmpy2/install-requires.txt: Use == for the benefit of pipenv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d03b83a9e6499208bde8846e78f762bebcedfa1\">9d03b83</a></td><td><code>build/pkgs/sympy/install-requires.txt: Allow 1.7.x versions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866\">aa2f1f8</a></td><td><code>build/pkgs/cypari/install-requires.txt: cypari2, not cypari</code></td></tr></table>\n",
    "created_at": "2021-02-12T20:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495358",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ad4c0e6da58f8851cfbced0e9c1a66c9479f918">7ad4c0e</a></td><td><code>Merge tag '9.3.beta4' into t/30912/sagelib__update_metadata_for_pypi_deployment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d2e597a19d3bacc3277760879d52accac43a280">8d2e597</a></td><td><code>Merge #30912</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45e5cd24f864ad35a176944cfe4d13840a962054">45e5cd2</a></td><td><code>build/pkgs/argon2_cffi/spkg-install.in: Handle SAGE_FAT_BINARY</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5feab6eebead08363b08d8bd6fed81595716c59">d5feab6</a></td><td><code>Merge #31279</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5603f694552baad5d7e80645be23156be4902d91">5603f69</a></td><td><code>Merge #31045</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbd4c116fd0977cd7119305c62700e67159efb28">cbd4c11</a></td><td><code>Merge #31321</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1a0a20844a0420e18bb6793997af1a3e91c0724">d1a0a20</a></td><td><code>bootstrap: Generate pyproject.toml and setup.cfg [install_requires], requirements.txt, Pipfile, and src/Pipfile</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ffa05350361acc79c928b59945b867192eba18d1">ffa0535</a></td><td><code>build/pkgs/gmpy2/install-requires.txt: Use == for the benefit of pipenv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d03b83a9e6499208bde8846e78f762bebcedfa1">9d03b83</a></td><td><code>build/pkgs/sympy/install-requires.txt: Allow 1.7.x versions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866">aa2f1f8</a></td><td><code>build/pkgs/cypari/install-requires.txt: cypari2, not cypari</code></td></tr></table>




---

archive/issue_comments_495359.json:
```json
{
    "body": "Changed commit from **[aa2f1f8](https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866)** to **[7e842ce](https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695)**",
    "created_at": "2021-02-12T20:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495359",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[aa2f1f8](https://github.com/sagemath/sagetrac-mirror/commit/aa2f1f8931be35c2654ca5c693b79291ec16c866)** to **[7e842ce](https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695)**



---

archive/issue_comments_495360.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bdb223715da2bb4394becd5f3a105f9cd88baed8\">bdb2237</a></td><td><code>Merge branch 't/30912/sagelib__update_metadata_for_pypi_deployment' into t/31357/fixup_src_version_txt_added_in__30912</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c16651c760dfcb6a2af23fdcde582b4e62bfeba6\">c16651c</a></td><td><code>src/VERSION.txt: Use same format as build/pkgs/sagelib/src/VERSION.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/043d3ab5d754aff9ddd3813087a810cd351fc9e6\">043d3ab</a></td><td><code>Fixup version files/symlinks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695\">7e842ce</a></td><td><code>Merge #31357</code></td></tr></table>\n",
    "created_at": "2021-02-12T20:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495360",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bdb223715da2bb4394becd5f3a105f9cd88baed8">bdb2237</a></td><td><code>Merge branch 't/30912/sagelib__update_metadata_for_pypi_deployment' into t/31357/fixup_src_version_txt_added_in__30912</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c16651c760dfcb6a2af23fdcde582b4e62bfeba6">c16651c</a></td><td><code>src/VERSION.txt: Use same format as build/pkgs/sagelib/src/VERSION.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/043d3ab5d754aff9ddd3813087a810cd351fc9e6">043d3ab</a></td><td><code>Fixup version files/symlinks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695">7e842ce</a></td><td><code>Merge #31357</code></td></tr></table>




---

archive/issue_comments_495361.json:
```json
{
    "body": "Changed dependencies from **#30527, #30912, #31279, #31045, #31321, #31357** to **#30912, #31279, #31045, #31321, #31357**",
    "created_at": "2021-02-12T20:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495361",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30527, #30912, #31279, #31045, #31321, #31357** to **#30912, #31279, #31045, #31321, #31357**



---

archive/issue_comments_495362.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nRebased/squashed on top of current beta + dependencies (removing dependency on #30527), and avoiding changes to `src/` that conflicted with #31377.",
    "created_at": "2021-02-12T20:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495362",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Rebased/squashed on top of current beta + dependencies (removing dependency on #30527), and avoiding changes to `src/` that conflicted with #31377.



---

archive/issue_comments_495363.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600\">9c04e7f</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass through SAGE_NUM_THREADS</code></td></tr></table>\n",
    "created_at": "2021-02-12T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495363",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600">9c04e7f</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass through SAGE_NUM_THREADS</code></td></tr></table>




---

archive/issue_comments_495364.json:
```json
{
    "body": "Changed commit from **[7e842ce](https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695)** to **[9c04e7f](https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600)**",
    "created_at": "2021-02-12T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495364",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7e842ce](https://github.com/sagemath/sagetrac-mirror/commit/7e842cef734b16eb7a9be99841a2a94f962be695)** to **[9c04e7f](https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600)**



---

archive/issue_events_426384.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-07T21:19:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426384"
}
```



---

archive/issue_events_426385.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-07T21:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426385"
}
```



---

archive/issue_comments_495365.json:
```json
{
    "body": "Changed dependencies from **#30912, #31279, #31045, #31321, #31357** to **#31321**",
    "created_at": "2021-03-07T21:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495365",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30912, #31279, #31045, #31321, #31357** to **#31321**



---

archive/issue_comments_495366.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNow that most dependencies are merged, this ticket should be easier to review...",
    "created_at": "2021-03-07T21:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495366",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Now that most dependencies are merged, this ticket should be easier to review...



---

archive/issue_comments_495367.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n+\n+As of Sage 9.3.beta8, `sagelib` is published as a source distribution on PyPI (https://pypi.org/project/sagemath-standard), but the package does not have proper dependency information yet. \n \n As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.\n \n``````\n",
    "created_at": "2021-03-07T23:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495367",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 After #29500, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
+
+As of Sage 9.3.beta8, `sagelib` is published as a source distribution on PyPI (https://pypi.org/project/sagemath-standard), but the package does not have proper dependency information yet. 
 
 As part of `bootstrap`, we now generate (1) the `pyproject.toml` (PEP 517 metadata) and `install_requires` information, (2) `requirements.txt` and (3) `Pipfile` using m4 from the information added in #30719.  These files provide 3 distinct ways of setting up a user-defined venv.
 
``````




---

archive/issue_comments_495368.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc\">f691585</a></td><td><code>Merge tag '9.3.beta9' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-03-14T23:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495368",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc">f691585</a></td><td><code>Merge tag '9.3.beta9' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495369.json:
```json
{
    "body": "Changed commit from **[9c04e7f](https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600)** to **[f691585](https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc)**",
    "created_at": "2021-03-14T23:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495369",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9c04e7f](https://github.com/sagemath/sagetrac-mirror/commit/9c04e7feefa588aa90c6a9fec7797eb4e2e09600)** to **[f691585](https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc)**



---

archive/issue_comments_495370.json:
```json
{
    "body": "Changed dependencies from **#31321** to none",
    "created_at": "2021-03-14T23:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495370",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31321** to none



---

archive/issue_comments_495371.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262\">66c2987</a></td><td><code>build/pkgs/{sage_sws2rst,sage_docbuild}/install-requires.txt: New</code></td></tr></table>\n",
    "created_at": "2021-03-19T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495371",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262">66c2987</a></td><td><code>build/pkgs/{sage_sws2rst,sage_docbuild}/install-requires.txt: New</code></td></tr></table>




---

archive/issue_comments_495372.json:
```json
{
    "body": "Changed commit from **[f691585](https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc)** to **[66c2987](https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262)**",
    "created_at": "2021-03-19T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495372",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f691585](https://github.com/sagemath/sagetrac-mirror/commit/f691585107543592cb5faaf94993ba536390aebc)** to **[66c2987](https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262)**



---

archive/issue_comments_495373.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28\">7f8ec6c</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add factor sitepackages</code></td></tr></table>\n",
    "created_at": "2021-03-22T04:47:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495373",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28">7f8ec6c</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add factor sitepackages</code></td></tr></table>




---

archive/issue_comments_495374.json:
```json
{
    "body": "Changed commit from **[66c2987](https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262)** to **[7f8ec6c](https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28)**",
    "created_at": "2021-03-22T04:47:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495374",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66c2987](https://github.com/sagemath/sagetrac-mirror/commit/66c29875f2f18553c9e8f1e46a8a010dff007262)** to **[7f8ec6c](https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28)**



---

archive/issue_comments_495375.json:
```json
{
    "body": "Changed commit from **[7f8ec6c](https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28)** to **[f720722](https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373)**",
    "created_at": "2021-03-22T19:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495375",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7f8ec6c](https://github.com/sagemath/sagetrac-mirror/commit/7f8ec6c3356e4a15da913f08be8e3d4d8cbf3a28)** to **[f720722](https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373)**



---

archive/issue_comments_495376.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0283da5a2392e2bec2b46147327a0ad37f466d6a\">0283da5</a></td><td><code>build/make/Makefile.in: Add wheel, setuptools_wheel to PYTHON_TOOLCHAIN to make sure that PEP 517 packages have a complete build system</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373\">f720722</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add factor nobuildisolation</code></td></tr></table>\n",
    "created_at": "2021-03-22T19:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495376",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0283da5a2392e2bec2b46147327a0ad37f466d6a">0283da5</a></td><td><code>build/make/Makefile.in: Add wheel, setuptools_wheel to PYTHON_TOOLCHAIN to make sure that PEP 517 packages have a complete build system</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373">f720722</a></td><td><code>build/pkgs/sagelib/src/tox.ini: Add factor nobuildisolation</code></td></tr></table>




---

archive/issue_comments_495377.json:
```json
{
    "body": "Changed commit from **[f720722](https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373)** to **[c451b31](https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98)**",
    "created_at": "2021-03-23T02:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495377",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f720722](https://github.com/sagemath/sagetrac-mirror/commit/f7207221ddc3da17663be31d51530b774a164373)** to **[c451b31](https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98)**



---

archive/issue_comments_495378.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98\">c451b31</a></td><td><code>src/setup.cfg.m4 (install_requires): Add sage_conf</code></td></tr></table>\n",
    "created_at": "2021-03-23T02:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495378",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98">c451b31</a></td><td><code>src/setup.cfg.m4 (install_requires): Add sage_conf</code></td></tr></table>




---

archive/issue_comments_495379.json:
```json
{
    "body": "Changed commit from **[c451b31](https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98)** to **[6700223](https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be)**",
    "created_at": "2021-03-24T06:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495379",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c451b31](https://github.com/sagemath/sagetrac-mirror/commit/c451b310026a0b6c973dd0b22efa2cbe784e6c98)** to **[6700223](https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be)**



---

archive/issue_comments_495380.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be\">6700223</a></td><td><code>Merge tag '9.3.rc0' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>\n",
    "created_at": "2021-03-24T06:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495380",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be">6700223</a></td><td><code>Merge tag '9.3.rc0' into t/30913/sagelib__add_setup_cfg__install_requires_</code></td></tr></table>




---

archive/issue_comments_495381.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\non a clean repo I ran ./bootstrap and then\n\n```\n./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)\n...\nadding 'sagemath-standard-9.3rc0/sagemath_standard.egg-info/SOURCES.txt'\nadding 'sagemath-standard-9.3rc0/sagemath_standard.egg-info/top_level.txt'\nremoving 'sagemath-standard-9.3rc0' (and everything under it)\n\nGLOB finish: packaging after 3.96 seconds\ncopying new sdistfile to '/users/dimpase/.tox/distshare/sagemath-standard-9.3rc0.zip'\npackage .tmp/package/1/sagemath-standard-9.3rc0.zip links to dist/sagemath-standard-9.3rc0.zip (/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox)\npython-sagewheels-nopypi start: getenv /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi\npython-sagewheels-nopypi cannot reuse: no previous config /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/.tox-config1\npython-sagewheels-nopypi create: /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi\n  removing /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi\nsetting PATH=/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin:/home/scratch2/dimpase/sage/sage/build/bin:/home/scratch2/dimpase/sage/sage/src/bin:/home/scratch2/dimpase/sage/sage/local/bin:/home/scratch2/dimpase/sage/sage/local/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin\n  /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox$ /usr/bin/python3 -m virtualenv --python /usr/bin/python3 python-sagewheels-nopypi >/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/log/python-sagewheels-nopypi-0.log\npython-sagewheels-nopypi installdeps: -rrequirements.txt\nsetting PATH=/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin:/home/scratch2/dimpase/sage/sage/build/bin:/home/scratch2/dimpase/sage/sage/src/bin:/home/scratch2/dimpase/sage/sage/local/bin:/home/scratch2/dimpase/sage/sage/local/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin\n  /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src$ /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt \nIgnoring pycygwin: markers 'sys_platform == \"cygwin\"' don't match your environment\nLooking in links: file:///home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels\nCollecting sage-conf==9.3.rc0 (from -r requirements.txt (line 12))\n  Url 'file:///home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels' is ignored: it is neither a file nor a directory.\n  Could not find a version that satisfies the requirement sage-conf==9.3.rc0 (from -r requirements.txt (line 12)) (from versions: )\nNo matching distribution found for sage-conf==9.3.rc0 (from -r requirements.txt (line 12))\nERROR: could not install deps [-rrequirements.txt]; v = InvocationError(\"'/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt'\", 1)\npython-sagewheels-nopypi finish: getenv after 2.13 seconds\n_________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________\nERROR:   python-sagewheels-nopypi: could not install deps [-rrequirements.txt]; v = InvocationError(\"'/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt'\", 1)\ncleanup /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip\n```",
    "created_at": "2021-03-24T11:22:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495381",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

on a clean repo I ran ./bootstrap and then

```
./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)
...
adding 'sagemath-standard-9.3rc0/sagemath_standard.egg-info/SOURCES.txt'
adding 'sagemath-standard-9.3rc0/sagemath_standard.egg-info/top_level.txt'
removing 'sagemath-standard-9.3rc0' (and everything under it)

GLOB finish: packaging after 3.96 seconds
copying new sdistfile to '/users/dimpase/.tox/distshare/sagemath-standard-9.3rc0.zip'
package .tmp/package/1/sagemath-standard-9.3rc0.zip links to dist/sagemath-standard-9.3rc0.zip (/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox)
python-sagewheels-nopypi start: getenv /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi
python-sagewheels-nopypi cannot reuse: no previous config /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/.tox-config1
python-sagewheels-nopypi create: /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi
  removing /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi
setting PATH=/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin:/home/scratch2/dimpase/sage/sage/build/bin:/home/scratch2/dimpase/sage/sage/src/bin:/home/scratch2/dimpase/sage/sage/local/bin:/home/scratch2/dimpase/sage/sage/local/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin
  /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox$ /usr/bin/python3 -m virtualenv --python /usr/bin/python3 python-sagewheels-nopypi >/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/log/python-sagewheels-nopypi-0.log
python-sagewheels-nopypi installdeps: -rrequirements.txt
setting PATH=/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin:/home/scratch2/dimpase/sage/sage/build/bin:/home/scratch2/dimpase/sage/sage/src/bin:/home/scratch2/dimpase/sage/sage/local/bin:/home/scratch2/dimpase/sage/sage/local/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin
  /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src$ /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt 
Ignoring pycygwin: markers 'sys_platform == "cygwin"' don't match your environment
Looking in links: file:///home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels
Collecting sage-conf==9.3.rc0 (from -r requirements.txt (line 12))
  Url 'file:///home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels' is ignored: it is neither a file nor a directory.
  Could not find a version that satisfies the requirement sage-conf==9.3.rc0 (from -r requirements.txt (line 12)) (from versions: )
No matching distribution found for sage-conf==9.3.rc0 (from -r requirements.txt (line 12))
ERROR: could not install deps [-rrequirements.txt]; v = InvocationError("'/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt'", 1)
python-sagewheels-nopypi finish: getenv after 2.13 seconds
_________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________
ERROR:   python-sagewheels-nopypi: could not install deps [-rrequirements.txt]; v = InvocationError("'/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt'", 1)
cleanup /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip
```



---

archive/issue_comments_495382.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nmaybe I missed some prelim stages, I have no idea.",
    "created_at": "2021-03-24T11:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495382",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

maybe I missed some prelim stages, I have no idea.



---

archive/issue_comments_495383.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI have extended the instructions in the ticket description: You need to configure and build the Sage distribution before running the tox commands shown.",
    "created_at": "2021-03-24T15:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495383",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

I have extended the instructions in the ticket description: You need to configure and build the Sage distribution before running the tox commands shown.



---

archive/issue_comments_495384.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n \n (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)\n \n-To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`:\n+**To test - use `./bootstrap` and then configure and build the Sage distribution.**  Then follow the instructions in `build/pkgs/sagelib/src/tox.ini`:\n \n ```\n     #\n``````\n",
    "created_at": "2021-03-24T15:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495384",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,7 @@
 
 (Adding `pyproject.toml` does not change how the Sage distribution installs sagelib because `build/pkgs/sagelib/spkg-install` uses `setup.py install` directly.)
 
-To test - use `./bootstrap` and the follow the instructions in `build/pkgs/sagelib/src/tox.ini`:
+**To test - use `./bootstrap` and then configure and build the Sage distribution.**  Then follow the instructions in `build/pkgs/sagelib/src/tox.ini`:
 
 ```
     #
``````




---

archive/issue_comments_495385.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nanother issue is logging. I have no idea where logs of this all go, in particular I noticed an error due to no space left on device, even though it should all be fine (unless there is an excessive use of ~/.sage, or /tmp)\n\nbut worst of all I can't find a log with this info, it was printed in terminal...",
    "created_at": "2021-03-24T18:56:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495385",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

another issue is logging. I have no idea where logs of this all go, in particular I noticed an error due to no space left on device, even though it should all be fine (unless there is an excessive use of ~/.sage, or /tmp)

but worst of all I can't find a log with this info, it was printed in terminal...



---

archive/issue_comments_495386.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n(wrong ticket)",
    "created_at": "2021-03-24T18:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495386",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

(wrong ticket)



---

archive/issue_comments_495387.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYou will find the logs in `build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi`",
    "created_at": "2021-03-24T18:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495387",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

You will find the logs in `build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi`



---

archive/issue_comments_495388.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\n\n```\nProcessing /home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels/nbformat-5.0.7-py3-none-any.whl\nProcessing /home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels/widgetsnbextension-3.5.1-py2.py3-none-any.whl\nINFO: pip is looking at multiple versions of ipython to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of ipykernel to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of gmpy2 to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of fpylll to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of <Python from Requires-Python> to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of cython to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of cysignals to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of cypari2 to determine which version is compatible with other requirements. This could take a while.\nINFO: pip is looking at multiple versions of cvxopt to determine which version is compatible with other requirements. This could take a while.\nERROR: Could not find a version that satisfies the requirement jupyterlab-widgets>=1.0.0; python_version >= \"3.6\" (from ipywidgets)\nERROR: No matching distribution found for jupyterlab-widgets>=1.0.0; python_version >= \"3.6\"\nERROR: invocation failed (exit code 1)\nERROR: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)\npython-sagewheels-nopypi finish: getenv /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi after 1.87 seconds\n______________________________________________________________ summary ______________________________________________________________\nERROR:   python-sagewheels-nopypi: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)\ncleanup /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip\n```\n\nno idea about that `jupyterlab-widgets`, we don't even seem to have such a package in Sage.\n\nPS. `./sage --pip install jupyterlab-widgets` didn't fix it.",
    "created_at": "2021-03-24T19:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495388",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">comment:0</div>


```
Processing /home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels/nbformat-5.0.7-py3-none-any.whl
Processing /home/scratch2/dimpase/sage/sage/local/var/lib/sage/wheels/widgetsnbextension-3.5.1-py2.py3-none-any.whl
INFO: pip is looking at multiple versions of ipython to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of ipykernel to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of gmpy2 to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of fpylll to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of <Python from Requires-Python> to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of cython to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of cysignals to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of cypari2 to determine which version is compatible with other requirements. This could take a while.
INFO: pip is looking at multiple versions of cvxopt to determine which version is compatible with other requirements. This could take a while.
ERROR: Could not find a version that satisfies the requirement jupyterlab-widgets>=1.0.0; python_version >= "3.6" (from ipywidgets)
ERROR: No matching distribution found for jupyterlab-widgets>=1.0.0; python_version >= "3.6"
ERROR: invocation failed (exit code 1)
ERROR: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)
python-sagewheels-nopypi finish: getenv /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi after 1.87 seconds
______________________________________________________________ summary ______________________________________________________________
ERROR:   python-sagewheels-nopypi: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)
cleanup /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip
```

no idea about that `jupyterlab-widgets`, we don't even seem to have such a package in Sage.

PS. `./sage --pip install jupyterlab-widgets` didn't fix it.



---

archive/issue_comments_495389.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWe do have the SPKG`jupyterlab_widgets`. Running `make jupyterlab_widgets` will fix the problem.",
    "created_at": "2021-03-24T19:39:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495389",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

We do have the SPKG`jupyterlab_widgets`. Running `make jupyterlab_widgets` will fix the problem.



---

archive/issue_comments_495390.json:
```json
{
    "body": "Changed commit from **[6700223](https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be)** to **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**",
    "created_at": "2021-03-24T20:01:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495390",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6700223](https://github.com/sagemath/sagetrac-mirror/commit/67002239dc377d82717c09a7c5c048a7161b51be)** to **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**



---

archive/issue_comments_495391.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662\">04da2c6</a></td><td><code>build/pkgs/ipywidgets: Patch out declaring install-requires of nbformat and jupyterlab-widgets</code></td></tr></table>\n",
    "created_at": "2021-03-24T20:01:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495391",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662">04da2c6</a></td><td><code>build/pkgs/ipywidgets: Patch out declaring install-requires of nbformat and jupyterlab-widgets</code></td></tr></table>




---

archive/issue_comments_495392.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nOr try with this fix (which makes no change to how we install things in the Sage distribution, but removes excessive dependencies from the wheels)",
    "created_at": "2021-03-24T20:03:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495392",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Or try with this fix (which makes no change to how we install things in the Sage distribution, but removes excessive dependencies from the wheels)



---

archive/issue_comments_495393.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n(Newer versions of `jupyterlab-widgets` have more disciplined dependencies via use of `jupyter_packaging`; after an upgrade in the Sage 9.4 series we will be able to make `jupyterlab-widgets` a standard package and drop the patch to `ipywidgets` again.)",
    "created_at": "2021-03-24T20:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495393",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

(Newer versions of `jupyterlab-widgets` have more disciplined dependencies via use of `jupyter_packaging`; after an upgrade in the Sage 9.4 series we will be able to make `jupyterlab-widgets` a standard package and drop the patch to `ipywidgets` again.)



---

archive/issue_comments_495394.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nohh, nodejs getting installed as a sage package?!",
    "created_at": "2021-03-24T20:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495394",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

ohh, nodejs getting installed as a sage package?!



---

archive/issue_comments_495395.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">comment:146</div>\n\nReplying to [@mkoeppe](#comment:141):\n> We do have the SPKG`jupyterlab_widgets`. Running `make jupyterlab_widgets` will fix the problem. \n\nit did not. trying the latest commit now",
    "created_at": "2021-03-24T20:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495395",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:146" align="right">comment:146</div>

Replying to [@mkoeppe](#comment:141):
> We do have the SPKG`jupyterlab_widgets`. Running `make jupyterlab_widgets` will fix the problem. 

it did not. trying the latest commit now



---

archive/issue_comments_495396.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nthe patch let it go further, but now this puzzling \"no space left on device\"\n\n```\n  copying sage/sets/finite_enumerated_set.py -> build/lib.linux-x86_64-3.7/sage/sets\n  copying sage/sets/set.py -> build/lib.linux-x86_64-3.7/sage/sets\n  error: could not write to 'build/lib.linux-x86_64-3.7/sage/sets/set.py': No space left on device\n  Building wheel for sagemath-standard (PEP 517) ... error\n  ERROR: Failed building wheel for sagemath-standard\nFailed to build sagemath-standard\nERROR: Could not build wheels for sagemath-standard which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/commands/install.py\", line 361, in run\n    \", \".join(pep517_build_failure_names)\npip._internal.exceptions.InstallationError: Could not build wheels for sagemath-standard which use PEP 517 and cannot be installed directly\nRemoved build tracker: '/tmp/pip-req-tracker-rj13d2c8'\nERROR: invocation failed (exit code 1)\npython-sagewheels-nopypi finish: installpkg /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip after 308.24 seconds\n```\n\nI really don't get is, there is almost 300Gb left on /home/scratch2/\nMaybe it tries to copy stuff via some silly place like /tmp or /var or ~/.sage/, and the error comes from this? No idea.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662\">04da2c6</a></td><td><code>build/pkgs/ipywidgets: Patch out declaring install-requires of nbformat and jupyterlab-widgets</code></td></tr></table>\n",
    "created_at": "2021-03-24T21:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495396",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

the patch let it go further, but now this puzzling "no space left on device"

```
  copying sage/sets/finite_enumerated_set.py -> build/lib.linux-x86_64-3.7/sage/sets
  copying sage/sets/set.py -> build/lib.linux-x86_64-3.7/sage/sets
  error: could not write to 'build/lib.linux-x86_64-3.7/sage/sets/set.py': No space left on device
  Building wheel for sagemath-standard (PEP 517) ... error
  ERROR: Failed building wheel for sagemath-standard
Failed to build sagemath-standard
ERROR: Could not build wheels for sagemath-standard which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/python-sagewheels-nopypi/lib/python3.7/site-packages/pip/_internal/commands/install.py", line 361, in run
    ", ".join(pep517_build_failure_names)
pip._internal.exceptions.InstallationError: Could not build wheels for sagemath-standard which use PEP 517 and cannot be installed directly
Removed build tracker: '/tmp/pip-req-tracker-rj13d2c8'
ERROR: invocation failed (exit code 1)
python-sagewheels-nopypi finish: installpkg /home/scratch2/dimpase/sage/sage/build/pkgs/sagelib/src/.tox/.tmp/package/1/sagemath-standard-9.3rc0.zip after 308.24 seconds
```

I really don't get is, there is almost 300Gb left on /home/scratch2/
Maybe it tries to copy stuff via some silly place like /tmp or /var or ~/.sage/, and the error comes from this? No idea.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662">04da2c6</a></td><td><code>build/pkgs/ipywidgets: Patch out declaring install-requires of nbformat and jupyterlab-widgets</code></td></tr></table>




---

archive/issue_comments_495397.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\npip likes to use temporary directories, probably in /tmp or /var/tmp",
    "created_at": "2021-03-24T22:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495397",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

pip likes to use temporary directories, probably in /tmp or /var/tmp



---

archive/issue_comments_495398.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nTry setting `TMPDIR` to something elese",
    "created_at": "2021-03-24T22:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495398",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Try setting `TMPDIR` to something elese



---

archive/issue_comments_495399.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nis TMPDIR an env.var. I can export before running this job? Or is it something pythonic?",
    "created_at": "2021-03-24T22:32:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495399",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">comment:0</div>

is TMPDIR an env.var. I can export before running this job? Or is it something pythonic?



---

archive/issue_comments_495400.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nJust the standard environment variable",
    "created_at": "2021-03-24T22:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495400",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Just the standard environment variable



---

archive/issue_comments_495401.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nOK, this run finishes, with some doctest errors, mainly in sphinx/docs related:\n\n```\n$ ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'\n...\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/all.py  # 1 doctest failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/misc/package.py  # 1 doctest failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/misc/sagedoc.py  # 4 doctests failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/docs/conf.py  # 1 doctest failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/interfaces/gap.py  # 1 doctest failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_setup/find.py  # 1 doctest failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/__init__.py  # 35 doctests failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/sphinxbuild.py  # 13 doctests failed\nsage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/utils.py  # 5 doctests failed\n```\n\nif this is expected, feel free to make it positive review.",
    "created_at": "2021-03-25T10:07:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495401",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

OK, this run finishes, with some doctest errors, mainly in sphinx/docs related:

```
$ ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v -e python-sagewheels-nopypi)'
...
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/all.py  # 1 doctest failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/misc/package.py  # 1 doctest failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/misc/sagedoc.py  # 4 doctests failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/docs/conf.py  # 1 doctest failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage/interfaces/gap.py  # 1 doctest failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_setup/find.py  # 1 doctest failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/__init__.py  # 35 doctests failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/sphinxbuild.py  # 13 doctests failed
sage -t --random-seed=0 /home/scratch2/dimpase/sage/sage/src/sage_docbuild/utils.py  # 5 doctests failed
```

if this is expected, feel free to make it positive review.



---

archive/issue_comments_495402.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-03-25T10:07:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495402",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_495403.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThanks for testing! Yes, this looks as expected. The documentation is not built by this invocation. We should disable the corresponding doctests, for example using #30778 - but that's something for the 9.4 series.",
    "created_at": "2021-03-25T16:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495403",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Thanks for testing! Yes, this looks as expected. The documentation is not built by this invocation. We should disable the corresponding doctests, for example using #30778 - but that's something for the 9.4 series.



---

archive/issue_events_426386.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-25T16:11:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426386"
}
```



---

archive/issue_events_426387.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-25T16:11:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426387"
}
```



---

archive/issue_comments_495404.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSetting priority to blocker to bring this ticket to the attention of the release bot.",
    "created_at": "2021-03-29T23:54:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495404",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Setting priority to blocker to bring this ticket to the attention of the release bot.



---

archive/issue_events_426388.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-29T23:54:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426388"
}
```



---

archive/issue_events_426389.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-29T23:54:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426389"
}
```



---

archive/issue_events_426390.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:50:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426390"
}
```



---

archive/issue_events_426391.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:50:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426391"
}
```



---

archive/issue_events_426392.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-18T16:17:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426392"
}
```



---

archive/issue_events_426393.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-18T16:17:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426393"
}
```



---

archive/issue_events_426394.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-27T20:30:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426394"
}
```



---

archive/issue_events_426395.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1c01281a1e468c423fbb41c2d8043471616587f9",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-05-27T20:30:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30913#event-426395"
}
```



---

archive/issue_comments_495405.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sagelib__add_setup_cfg__install_requires_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sagelib__add_setup_cfg__install_requires_)** to **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**",
    "created_at": "2021-05-27T20:30:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30913#issuecomment-495405",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/sagelib__add_setup_cfg__install_requires_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sagelib__add_setup_cfg__install_requires_)** to **[04da2c6](https://github.com/sagemath/sagetrac-mirror/commit/04da2c6eb85566de6d49bf19803a061f4843c662)**
