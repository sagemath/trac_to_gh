# Issue 30736: replacing insecure git:// with secure https://

archive/issues_030499.json:
```json
{
    "body": "adjust documentation of Sage and git-trac to use https rather than git.\n\nremove git_trac spkg, as the upstream should be used directly instead, and\nas our version is long obsolete.\n\n**CC:**  @vbraun @mkoeppe @embray @saraedum\n\n**Keywords:** security git trac\n\n**Branch/Commit:** [f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)\n\n**Reviewer:** Dima Pasechnik, Matthias Koeppe\n\n**Author:** Volker Weissmann, Dima Pasechnik\n\nIssue created by migration from https://trac.sagemath.org/ticket/30736\n\n",
    "closed_at": "2020-11-01T00:42:52Z",
    "created_at": "2020-10-06T23:59:59Z",
    "labels": [
        "component: scripts",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "replacing insecure git:// with secure https://",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30736",
    "user": "https://github.com/Volker-Weissmann"
}
```
adjust documentation of Sage and git-trac to use https rather than git.

remove git_trac spkg, as the upstream should be used directly instead, and
as our version is long obsolete.

**CC:**  @vbraun @mkoeppe @embray @saraedum

**Keywords:** security git trac

**Branch/Commit:** [f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)

**Reviewer:** Dima Pasechnik, Matthias Koeppe

**Author:** Volker Weissmann, Dima Pasechnik

Issue created by migration from https://trac.sagemath.org/ticket/30736





---

archive/issue_comments_581435.json:
```json
{
    "body": "**Branch:** [u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)",
    "created_at": "2020-10-07T00:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581435",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Branch:** [u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)



---

archive/issue_comments_581436.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)\" to \"\".",
    "created_at": "2020-10-07T01:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581436",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Changing branch** from "[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)" to "".



---

archive/issue_comments_581437.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"security git trac\".",
    "created_at": "2020-10-07T01:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581437",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Changing keywords** from "" to "security git trac".



---

archive/issue_comments_581438.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-10-07T01:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581438",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_089951.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89951"
}
```



---

archive/issue_comments_581439.json:
```json
{
    "body": "<a id='comment:3'></a>\nSee https://github.com/sagemath/git-trac-command/pull/49 for the second part of this ticket. (This ticket won't work without the git trac PR).",
    "created_at": "2020-10-07T01:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581439",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:3'></a>
See https://github.com/sagemath/git-trac-command/pull/49 for the second part of this ticket. (This ticket won't work without the git trac PR).



---

archive/issue_comments_581440.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe PR has been merged. So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?",
    "created_at": "2020-10-07T11:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581440",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
The PR has been merged. So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?



---

archive/issue_comments_581441.json:
```json
{
    "body": "**Branch:** [u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)",
    "created_at": "2020-10-07T23:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581441",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Branch:** [u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)



---

archive/issue_comments_581442.json:
```json
{
    "body": "**Commit:** [1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582](https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582)",
    "created_at": "2020-10-07T23:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581442",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Commit:** [1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582](https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582)



---

archive/issue_comments_581443.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [dimpase](#comment%3A4):\n> So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?\n> \n\nI don't know what you are talking about. We don't touch build/pkgs/git_trac/package-version.txt .\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582\">1a15744</a></td><td><code>replaced insecure git:// with secure https:// or secure git over ssh</code></td></tr></table>\n",
    "created_at": "2020-10-07T23:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581443",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:6'></a>
Replying to [dimpase](#comment%3A4):
> So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?
> 

I don't know what you are talking about. We don't touch build/pkgs/git_trac/package-version.txt .

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582">1a15744</a></td><td><code>replaced insecure git:// with secure https:// or secure git over ssh</code></td></tr></table>




---

archive/issue_comments_581444.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [gh-Volker-Weissmann](#comment%3A6):\n> Replying to [dimpase](#comment%3A4):\n> > So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?\n> > \n\n> I don't know what you are talking about. We don't touch build/pkgs/git_trac/package-version.txt \n\nSage can install  git-trac as its optional package.\nThis ticket updates git-trac, so I thought it should update the optional package too.\nHowever, the optional package looks abandoned, last touched in 2016.\n\nLet's remove it here, it seems to be an oversight that it's not done years ago.",
    "created_at": "2020-10-08T10:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581444",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Replying to [gh-Volker-Weissmann](#comment%3A6):
> Replying to [dimpase](#comment%3A4):
> > So I suppose it's waiting for a new release, to update build/pkgs/git_trac/package-version.txt etc?
> > 

> I don't know what you are talking about. We don't touch build/pkgs/git_trac/package-version.txt 

Sage can install  git-trac as its optional package.
This ticket updates git-trac, so I thought it should update the optional package too.
However, the optional package looks abandoned, last touched in 2016.

Let's remove it here, it seems to be an oversight that it's not done years ago.



---

archive/issue_comments_581445.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)\" to \"[u/dimpase/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/replacing_insecure_git____with_secure_https___)\".",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581445",
    "user": "https://github.com/dimpase"
}
```

**Changing branch** from "[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)" to "[u/dimpase/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/replacing_insecure_git____with_secure_https___)".



---

archive/issue_comments_581446.json:
```json
{
    "body": "**Changing commit** from \"[1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582](https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582)\" to \"[c28adeff5b638555daf89d82bce21750e070b8be](https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be)\".",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581446",
    "user": "https://github.com/dimpase"
}
```

**Changing commit** from "[1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582](https://github.com/sagemath/sagetrac-mirror/commit/1a15744f2fc9cf6de37ffb65f2fd9e91d43f5582)" to "[c28adeff5b638555daf89d82bce21750e070b8be](https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be)".



---

archive/issue_comments_581447.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n+adjust documentation of Sage and git-trac to use https rather than git.\n \n+remove git_trac spkg, as the upstream should be used directly instead, and\n+as our version is long obsolete.\n``````\n",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581447",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,4 @@
+adjust documentation of Sage and git-trac to use https rather than git.
 
+remove git_trac spkg, as the upstream should be used directly instead, and
+as our version is long obsolete.
``````




---

archive/issue_comments_581448.json:
```json
{
    "body": "**Author:** Volker Weissmann",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581448",
    "user": "https://github.com/dimpase"
}
```

**Author:** Volker Weissmann



---

archive/issue_comments_581449.json:
```json
{
    "body": "<a id='comment:8'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be\">c28adef</a></td><td><code>remove git_trac spkg</code></td></tr></table>\n",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581449",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be">c28adef</a></td><td><code>remove git_trac spkg</code></td></tr></table>




---

archive/issue_comments_581450.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581450",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_581451.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2020-10-08T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581451",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_581452.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2020-10-08T11:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581452",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_581453.json:
```json
{
    "body": "<a id='comment:10'></a>\nI am not sure about changes to `docker/Dockerfile` - isn't it replacing anonymous access with authenticated?\nSame for some scripts.",
    "created_at": "2020-10-08T11:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581453",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
I am not sure about changes to `docker/Dockerfile` - isn't it replacing anonymous access with authenticated?
Same for some scripts.



---

archive/issue_comments_581454.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis looks wrong:\n\n```diff\n--- a/src/bin/sage-env\n+++ b/src/bin/sage-env\n@@ -352,7 +352,7 @@ SINGULARPATH=\"$SAGE_LOCAL/share/singular\" && export SINGULARPATH\n SINGULAR_EXECUTABLE=\"$SAGE_LOCAL/bin/Singular\" && export SINGULAR_EXECUTABLE\n \n if [ -z \"$SAGE_REPO_ANONYMOUS\" ]; then\n-    SAGE_REPO_ANONYMOUS=\"git://trac.sagemath.org/sage.git\"\n+    SAGE_REPO_ANONYMOUS=\"git@trac.sagemath.org:sage.git\"\n     export SAGE_REPO_ANONYMOUS\n fi\n if [ -z \"$SAGE_REPO_AUTHENTICATED\" ]; then\n```\nas this is anonymous access, as opposed to authenticated. So it should be left alone (as our git server does not provide `http(s):` access, only `git:` and `ssh:`.",
    "created_at": "2020-10-08T12:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581454",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
This looks wrong:

```diff
--- a/src/bin/sage-env
+++ b/src/bin/sage-env
@@ -352,7 +352,7 @@ SINGULARPATH="$SAGE_LOCAL/share/singular" && export SINGULARPATH
 SINGULAR_EXECUTABLE="$SAGE_LOCAL/bin/Singular" && export SINGULAR_EXECUTABLE
 
 if [ -z "$SAGE_REPO_ANONYMOUS" ]; then
-    SAGE_REPO_ANONYMOUS="git://trac.sagemath.org/sage.git"
+    SAGE_REPO_ANONYMOUS="git@trac.sagemath.org:sage.git"
     export SAGE_REPO_ANONYMOUS
 fi
 if [ -z "$SAGE_REPO_AUTHENTICATED" ]; then
```
as this is anonymous access, as opposed to authenticated. So it should be left alone (as our git server does not provide `http(s):` access, only `git:` and `ssh:`.



---

archive/issue_comments_581455.json:
```json
{
    "body": "<a id='comment:12'></a>\non the other hand, `SAGE_REPO_ANONYMOUS` is only **used** in `build/bin/sage-clone-source` - a script that is currently not used, so it's OK to change it like this. \n\nBut the dockerfile may be used by various bots, so it really matters that it's an anonymous access.\nThe proper fix would be to enable `https:` on Sage's git server, but I am so not looking forward to this exercise... Perhaps it might be easier to add a server-side post-commit hook to push changes to the github mirror https://github.com/sagemath/sagetrac-mirror, and use it for read access instead.",
    "created_at": "2020-10-08T13:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581455",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
on the other hand, `SAGE_REPO_ANONYMOUS` is only **used** in `build/bin/sage-clone-source` - a script that is currently not used, so it's OK to change it like this. 

But the dockerfile may be used by various bots, so it really matters that it's an anonymous access.
The proper fix would be to enable `https:` on Sage's git server, but I am so not looking forward to this exercise... Perhaps it might be easier to add a server-side post-commit hook to push changes to the github mirror https://github.com/sagemath/sagetrac-mirror, and use it for read access instead.



---

archive/issue_comments_581456.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe problem with using git clone git://trac.sagemath.org/sage.git is that it does not check whether the cloned source code actually originates from sagemath.org.\nIf a hacker got control over e.g. the router, he could manipulate the cloned source code to include malware that gets executed once you build sagemath.\nThis is an unacceptable security vulnerability that needs to be fixed by either using https or ssh.\n\nI tried https://trac.sagemath.org/sage.git, but this is not supported from server-site.\nI don't see the problem with having git clone git@trac.sagemath.org:sage.git . A bot could do that, but maybe it would require setting the correct ssh fingerprint like in my other PR:\n\nhttps://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec",
    "created_at": "2020-10-08T15:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581456",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:13'></a>
The problem with using git clone git://trac.sagemath.org/sage.git is that it does not check whether the cloned source code actually originates from sagemath.org.
If a hacker got control over e.g. the router, he could manipulate the cloned source code to include malware that gets executed once you build sagemath.
This is an unacceptable security vulnerability that needs to be fixed by either using https or ssh.

I tried https://trac.sagemath.org/sage.git, but this is not supported from server-site.
I don't see the problem with having git clone git@trac.sagemath.org:sage.git . A bot could do that, but maybe it would require setting the correct ssh fingerprint like in my other PR:

https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec



---

archive/issue_comments_581457.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [gh-Volker-Weissmann](#comment%3A13):\n> The problem with using git clone git://trac.sagemath.org/sage.git is that it does not check whether the cloned source code actually originates from sagemath.org.\n> If a hacker got control over e.g. the router, he could manipulate the cloned source code to include malware that gets executed once you build sagemath.\n> This is an unacceptable security vulnerability that needs to be fixed by either using https or ssh.\n> \n> I tried https://trac.sagemath.org/sage.git, but this is not supported from server-site.\n\n\nyes, I know, I have admin rights for the host running trac.sagemath.org, and setting https access seems to be a tricky task. I can't seem to be able to find a guide on how to do this, although I didn't try too hard. The Git Book only talks about http, not https.\n\n\n> I don't see the problem with having git clone git@trac.sagemath.org:sage.git . A bot could do that, but maybe it would require setting the correct ssh fingerprint like in my other PR:\n\n\nI don't see how this could be useful.\nA typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.\n\n\n> \n> https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec \n\n>",
    "created_at": "2020-10-08T16:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581457",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
Replying to [gh-Volker-Weissmann](#comment%3A13):
> The problem with using git clone git://trac.sagemath.org/sage.git is that it does not check whether the cloned source code actually originates from sagemath.org.
> If a hacker got control over e.g. the router, he could manipulate the cloned source code to include malware that gets executed once you build sagemath.
> This is an unacceptable security vulnerability that needs to be fixed by either using https or ssh.
> 
> I tried https://trac.sagemath.org/sage.git, but this is not supported from server-site.


yes, I know, I have admin rights for the host running trac.sagemath.org, and setting https access seems to be a tricky task. I can't seem to be able to find a guide on how to do this, although I didn't try too hard. The Git Book only talks about http, not https.


> I don't see the problem with having git clone git@trac.sagemath.org:sage.git . A bot could do that, but maybe it would require setting the correct ssh fingerprint like in my other PR:


I don't see how this could be useful.
A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.


> 
> https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec 

>



---

archive/issue_comments_581458.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [dimpase](#comment%3A14):\n\n> I don't see how this could be useful.\n> A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.\n> \n> \n> > \n> > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec \n> > \n\n\nWhy does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public. If you don't like hard-coded keys, and you can't manage to activate https on the git server, you could make a https site with the correct public ssh fingerprints. Then we could download the key using https and add them into the known_hosts file. If you don't like editing the ~/.ssh/known_hosts file, git clone can pass options to ssh and ssh has an option to use a different known_hosts file.\n\nThe only alternative I see is enabling https or switching from trac to a software that supports https.",
    "created_at": "2020-10-08T18:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581458",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:15'></a>
Replying to [dimpase](#comment%3A14):

> I don't see how this could be useful.
> A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.
> 
> 
> > 
> > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec 
> > 


Why does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public. If you don't like hard-coded keys, and you can't manage to activate https on the git server, you could make a https site with the correct public ssh fingerprints. Then we could download the key using https and add them into the known_hosts file. If you don't like editing the ~/.ssh/known_hosts file, git clone can pass options to ssh and ssh has an option to use a different known_hosts file.

The only alternative I see is enabling https or switching from trac to a software that supports https.



---

archive/issue_comments_581459.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [gh-Volker-Weissmann](#comment%3A15):\n> Replying to [dimpase](#comment%3A14):\n> \n> > I don't see how this could be useful.\n> > A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.\n> > \n> > \n> > > \n> > > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec \n> > > \n\n> \n> Why does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public.\n\n\nno, the bot needs a key-pair to be able to pull via ssh, just as a normal user needs a key-pair.\nGiving a pre-existing key-pair to the bot is not secure, and certainly a bot cannot generate a key-pair and upload the public key.",
    "created_at": "2020-10-08T18:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581459",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
Replying to [gh-Volker-Weissmann](#comment%3A15):
> Replying to [dimpase](#comment%3A14):
> 
> > I don't see how this could be useful.
> > A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.
> > 
> > 
> > > 
> > > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec 
> > > 

> 
> Why does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public.


no, the bot needs a key-pair to be able to pull via ssh, just as a normal user needs a key-pair.
Giving a pre-existing key-pair to the bot is not secure, and certainly a bot cannot generate a key-pair and upload the public key.



---

archive/issue_comments_581460.json:
```json
{
    "body": "<a id='comment:17'></a>\nI've set up a post-commit hook on trac so that everything pushed gets immediatelly mirrored to https://github.com/sagemath/sagetrac-mirror - from which one can pull with https:.\nSo in the scripts one can replace trac with github.com/sagemath/sagetrac-mirror",
    "created_at": "2020-10-08T18:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581460",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>
I've set up a post-commit hook on trac so that everything pushed gets immediatelly mirrored to https://github.com/sagemath/sagetrac-mirror - from which one can pull with https:.
So in the scripts one can replace trac with github.com/sagemath/sagetrac-mirror



---

archive/issue_comments_581461.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [dimpase](#comment%3A16):\n> Replying to [gh-Volker-Weissmann](#comment%3A15):\n> > Replying to [dimpase](#comment%3A14):\n> > \n> > > I don't see how this could be useful.\n> > > A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.\n> > > \n> > > \n> > > > \n> > > > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec \n> > > > \n\n> > \n> > Why does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public.\n\n> \n> no, the bot needs a key-pair to be able to pull via ssh, just as a normal user needs a key-pair.\n> Giving a pre-existing key-pair to the bot is not secure, and certainly a bot cannot generate a key-pair and upload the public key.\n>  \n\n\nIf I set the correct public key in my .ssh/known_hosts file, I can just execute git clone git@trac.sagemath.org:sage.git\nI don't know why the bot should not be able to do that.",
    "created_at": "2020-10-08T18:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581461",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:18'></a>
Replying to [dimpase](#comment%3A16):
> Replying to [gh-Volker-Weissmann](#comment%3A15):
> > Replying to [dimpase](#comment%3A14):
> > 
> > > I don't see how this could be useful.
> > > A typical bot would be, say, a host running [GitHub](GitHub) Actions task, and the problem of distributing the keys seems to be a rather tricky one. Indeed, we do not have a way to have a read-only access rights, and so uploading an ssh key-pair to a random host does breach our security just as well.
> > > 
> > > 
> > > > 
> > > > https://github.com/sagemath/git-trac-command/pull/49/commits/1cf840b144bb49a3948361cd3368db430b75deec 
> > > > 

> > 
> > Why does uploading an ssh key to a random host breach your security? Its a public key, its meant to be public.

> 
> no, the bot needs a key-pair to be able to pull via ssh, just as a normal user needs a key-pair.
> Giving a pre-existing key-pair to the bot is not secure, and certainly a bot cannot generate a key-pair and upload the public key.
>  


If I set the correct public key in my .ssh/known_hosts file, I can just execute git clone git@trac.sagemath.org:sage.git
I don't know why the bot should not be able to do that.



---

archive/issue_comments_581462.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [gh-Volker-Weissmann](#comment%3A18):\n\n> If I set the correct public key in my .ssh/known_hosts file, I can just execute git clone git@trac.sagemath.org:sage.git\n> I don't know why the bot should not be able to do that.\n\n\nisn't it working because you have ssh-agent running, and your public key is already on trac?\nIMHO git via ssh always does ssh authentication, even `git clone` - although I might be wrong here.",
    "created_at": "2020-10-08T19:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581462",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>
Replying to [gh-Volker-Weissmann](#comment%3A18):

> If I set the correct public key in my .ssh/known_hosts file, I can just execute git clone git@trac.sagemath.org:sage.git
> I don't know why the bot should not be able to do that.


isn't it working because you have ssh-agent running, and your public key is already on trac?
IMHO git via ssh always does ssh authentication, even `git clone` - although I might be wrong here.



---

archive/issue_comments_581463.json:
```json
{
    "body": "<a id='comment:20'></a>\nWell, yes, I am right, I did an experiment - created a new user, logged in, and\n\n```\nfoo@hilbert ~ $ git clone git@github.com:sage/sage.git\nCloning into 'sage'...\nThe authenticity of host 'github.com (140.82.121.4)' can't be established.\nRSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added 'github.com,140.82.121.4' (RSA) to the list of known hosts.\ngit@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nfoo@hilbert ~ $ \nfoo@hilbert ~ $ git clone git@github.com:sage/sage.git\nCloning into 'sage'...\ngit@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nfoo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git\nCloning into 'sage'...\nThe authenticity of host 'trac.sagemath.org (104.197.143.230)' can't be established.\nECDSA key fingerprint is SHA256:4Op/q3b5792x+F1lHSKRi5UIORAPDlIFVA5cUq9YVXI.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added 'trac.sagemath.org,104.197.143.230' (ECDSA) to the list of known hosts.\ngit@trac.sagemath.org: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nfoo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git\nCloning into 'sage'...\ngit@trac.sagemath.org: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n```\n\nThus, well, no, it won't fly.",
    "created_at": "2020-10-08T19:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581463",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Well, yes, I am right, I did an experiment - created a new user, logged in, and

```
foo@hilbert ~ $ git clone git@github.com:sage/sage.git
Cloning into 'sage'...
The authenticity of host 'github.com (140.82.121.4)' can't be established.
RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'github.com,140.82.121.4' (RSA) to the list of known hosts.
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
foo@hilbert ~ $ 
foo@hilbert ~ $ git clone git@github.com:sage/sage.git
Cloning into 'sage'...
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git
Cloning into 'sage'...
The authenticity of host 'trac.sagemath.org (104.197.143.230)' can't be established.
ECDSA key fingerprint is SHA256:4Op/q3b5792x+F1lHSKRi5UIORAPDlIFVA5cUq9YVXI.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'trac.sagemath.org,104.197.143.230' (ECDSA) to the list of known hosts.
git@trac.sagemath.org: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git
Cloning into 'sage'...
git@trac.sagemath.org: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
```

Thus, well, no, it won't fly.



---

archive/issue_comments_581464.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [dimpase](#comment%3A20):\n> Well, yes, I am right, I did an experiment - created a new user, logged in, and\n> \n> ```\n> foo@hilbert ~ $ git clone git@github.com:sage/sage.git\n> Cloning into 'sage'...\n> The authenticity of host 'github.com (140.82.121.4)' can't be established.\n> RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.\n> Are you sure you want to continue connecting (yes/no/[fingerprint])? yes\n> Warning: Permanently added 'github.com,140.82.121.4' (RSA) to the list of known hosts.\n> git@github.com: Permission denied (publickey).\n> fatal: Could not read from remote repository.\n> \n> Please make sure you have the correct access rights\n> and the repository exists.\n> foo@hilbert ~ $ \n> foo@hilbert ~ $ git clone git@github.com:sage/sage.git\n> Cloning into 'sage'...\n> git@github.com: Permission denied (publickey).\n> fatal: Could not read from remote repository.\n> \n> Please make sure you have the correct access rights\n> and the repository exists.\n> foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git\n> Cloning into 'sage'...\n> The authenticity of host 'trac.sagemath.org (104.197.143.230)' can't be established.\n> ECDSA key fingerprint is SHA256:4Op/q3b5792x+F1lHSKRi5UIORAPDlIFVA5cUq9YVXI.\n> Are you sure you want to continue connecting (yes/no/[fingerprint])? yes\n> Warning: Permanently added 'trac.sagemath.org,104.197.143.230' (ECDSA) to the list of known hosts.\n> git@trac.sagemath.org: Permission denied (publickey).\n> fatal: Could not read from remote repository.\n> \n> Please make sure you have the correct access rights\n> and the repository exists.\n> foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git\n> Cloning into 'sage'...\n> git@trac.sagemath.org: Permission denied (publickey).\n> fatal: Could not read from remote repository.\n> \n> Please make sure you have the correct access rights\n> and the repository exists.\n> ```\n> \n> Thus, well, no, it won't fly.\n> \n\nOh no, that's not good, I didn't knew that.\nI think you will have to setup https then.",
    "created_at": "2020-10-08T19:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581464",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:21'></a>
Replying to [dimpase](#comment%3A20):
> Well, yes, I am right, I did an experiment - created a new user, logged in, and
> 
> ```
> foo@hilbert ~ $ git clone git@github.com:sage/sage.git
> Cloning into 'sage'...
> The authenticity of host 'github.com (140.82.121.4)' can't be established.
> RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
> Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
> Warning: Permanently added 'github.com,140.82.121.4' (RSA) to the list of known hosts.
> git@github.com: Permission denied (publickey).
> fatal: Could not read from remote repository.
> 
> Please make sure you have the correct access rights
> and the repository exists.
> foo@hilbert ~ $ 
> foo@hilbert ~ $ git clone git@github.com:sage/sage.git
> Cloning into 'sage'...
> git@github.com: Permission denied (publickey).
> fatal: Could not read from remote repository.
> 
> Please make sure you have the correct access rights
> and the repository exists.
> foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git
> Cloning into 'sage'...
> The authenticity of host 'trac.sagemath.org (104.197.143.230)' can't be established.
> ECDSA key fingerprint is SHA256:4Op/q3b5792x+F1lHSKRi5UIORAPDlIFVA5cUq9YVXI.
> Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
> Warning: Permanently added 'trac.sagemath.org,104.197.143.230' (ECDSA) to the list of known hosts.
> git@trac.sagemath.org: Permission denied (publickey).
> fatal: Could not read from remote repository.
> 
> Please make sure you have the correct access rights
> and the repository exists.
> foo@hilbert ~ $ git clone git@trac.sagemath.org:sage.git
> Cloning into 'sage'...
> git@trac.sagemath.org: Permission denied (publickey).
> fatal: Could not read from remote repository.
> 
> Please make sure you have the correct access rights
> and the repository exists.
> ```
> 
> Thus, well, no, it won't fly.
> 

Oh no, that's not good, I didn't knew that.
I think you will have to setup https then.



---

archive/issue_comments_581465.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f\">b69a573</a></td><td><code>use github in README</code></td></tr></table>\n",
    "created_at": "2020-10-08T20:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581465",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f">b69a573</a></td><td><code>use github in README</code></td></tr></table>




---

archive/issue_comments_581466.json:
```json
{
    "body": "**Changing commit** from \"[c28adeff5b638555daf89d82bce21750e070b8be](https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be)\" to \"[b69a573ec475cd0087d0f79277855ab1fcbafe9f](https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f)\".",
    "created_at": "2020-10-08T20:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581466",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c28adeff5b638555daf89d82bce21750e070b8be](https://github.com/sagemath/sagetrac-mirror/commit/c28adeff5b638555daf89d82bce21750e070b8be)" to "[b69a573ec475cd0087d0f79277855ab1fcbafe9f](https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f)".



---

archive/issue_comments_581467.json:
```json
{
    "body": "<a id='comment:23'></a>\nI suppose we can get away with github.com/sagemath/sagetrac-mirror.git repo (which does allow https) for all the Docker-related stuff and CI.\nNow committing to git trac goes to  there, too. E.g. here is what I saw as I pushed the last commit:\n\n```\n$ git push trac HEAD\nEnumerating objects: 5, done.\nCounting objects: 100% (5/5), done.\nDelta compression using up to 4 threads\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 308 bytes | 308.00 KiB/s, done.\nTotal 3 (delta 2), reused 0 (delta 0), pack-reused 0\nremote: Trac #30736: Commit changed to b69a57.\nremote: To git@github.com:sagemath/sagetrac-mirror.git\nremote:    c28adef..b69a573  u/dimpase/replacing_insecure_git____with_secure_https___ -> u/dimpase/replacing_insecure_git____with_secure_https___\nTo trac.sagemath.org:sage.git\n   c28adeff5b..b69a573ec4  HEAD -> u/dimpase/replacing_insecure_git____with_secure_https___\n```\n\nthe only drawback is that it's a bit slow (we can think for doing pushing to [GitHub](GitHub) in the background).",
    "created_at": "2020-10-08T20:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581467",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
I suppose we can get away with github.com/sagemath/sagetrac-mirror.git repo (which does allow https) for all the Docker-related stuff and CI.
Now committing to git trac goes to  there, too. E.g. here is what I saw as I pushed the last commit:

```
$ git push trac HEAD
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 4 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 308 bytes | 308.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Trac #30736: Commit changed to b69a57.
remote: To git@github.com:sagemath/sagetrac-mirror.git
remote:    c28adef..b69a573  u/dimpase/replacing_insecure_git____with_secure_https___ -> u/dimpase/replacing_insecure_git____with_secure_https___
To trac.sagemath.org:sage.git
   c28adeff5b..b69a573ec4  HEAD -> u/dimpase/replacing_insecure_git____with_secure_https___
```

the only drawback is that it's a bit slow (we can think for doing pushing to [GitHub](GitHub) in the background).



---

archive/issue_comments_581468.json:
```json
{
    "body": "<a id='comment:24'></a>\nSeems like a good idea.",
    "created_at": "2020-10-08T20:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581468",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:24'></a>
Seems like a good idea.



---

archive/issue_comments_581469.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [dimpase](#comment%3A23):\n> I suppose we can get away with github.com/sagemath/sagetrac-mirror.git repo (which does allow https) for all the Docker-related stuff and CI.\n> Now committing to git trac goes to  there, too. E.g. here is what I saw as I pushed the last commit:\n> \n> ```\n> $ git push trac HEAD\n> Enumerating objects: 5, done.\n> Counting objects: 100% (5/5), done.\n> Delta compression using up to 4 threads\n> Compressing objects: 100% (3/3), done.\n> Writing objects: 100% (3/3), 308 bytes | 308.00 KiB/s, done.\n> Total 3 (delta 2), reused 0 (delta 0), pack-reused 0\n> remote: Trac #30736: Commit changed to b69a57.\n> remote: To git@github.com:sagemath/sagetrac-mirror.git\n> remote:    c28adef..b69a573  u/dimpase/replacing_insecure_git____with_secure_https___ -> u/dimpase/replacing_insecure_git____with_secure_https___\n> To trac.sagemath.org:sage.git\n>    c28adeff5b..b69a573ec4  HEAD -> u/dimpase/replacing_insecure_git____with_secure_https___\n> ```\n> \n> the only drawback is that it's a bit slow (we can think for doing pushing to [GitHub](GitHub) in the background).\n\n\nDo you want to code that, or should I code that?",
    "created_at": "2020-10-09T12:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581469",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:25'></a>
Replying to [dimpase](#comment%3A23):
> I suppose we can get away with github.com/sagemath/sagetrac-mirror.git repo (which does allow https) for all the Docker-related stuff and CI.
> Now committing to git trac goes to  there, too. E.g. here is what I saw as I pushed the last commit:
> 
> ```
> $ git push trac HEAD
> Enumerating objects: 5, done.
> Counting objects: 100% (5/5), done.
> Delta compression using up to 4 threads
> Compressing objects: 100% (3/3), done.
> Writing objects: 100% (3/3), 308 bytes | 308.00 KiB/s, done.
> Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
> remote: Trac #30736: Commit changed to b69a57.
> remote: To git@github.com:sagemath/sagetrac-mirror.git
> remote:    c28adef..b69a573  u/dimpase/replacing_insecure_git____with_secure_https___ -> u/dimpase/replacing_insecure_git____with_secure_https___
> To trac.sagemath.org:sage.git
>    c28adeff5b..b69a573ec4  HEAD -> u/dimpase/replacing_insecure_git____with_secure_https___
> ```
> 
> the only drawback is that it's a bit slow (we can think for doing pushing to [GitHub](GitHub) in the background).


Do you want to code that, or should I code that?



---

archive/issue_comments_581470.json:
```json
{
    "body": "<a id='comment:26'></a>\nI broke the github.com/sagemath/sagetrac-mirror.git while playing with the commit hook, removed it, and for some reason cannot re-create it on github - looks like a github problem, direct pushing from trac server of a 300Mb repo with lots of refs ends with weird\n\n```\n...\n! [remote failure]  9.2.beta9 -> 9.2.beta9 (remote failed to report status)\n! [remote failure]  9.2.rc0 -> 9.2.rc0 (remote failed to report status)\nerror: failed to push some refs to 'git@github.com:sagemath/sagetrac-mirror.git'\n```\nIf you have time please feel free to play with this (in your own [GitHub](GitHub) repo, you can always transfer the ownership later): clone the trac repo with --mirror option, then try to push it to [GitHub](GitHub).\n\n---\n\nThe ticket is meanwhile good to go, as the affected by it Docker and script things are currently not in use.",
    "created_at": "2020-10-09T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581470",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>
I broke the github.com/sagemath/sagetrac-mirror.git while playing with the commit hook, removed it, and for some reason cannot re-create it on github - looks like a github problem, direct pushing from trac server of a 300Mb repo with lots of refs ends with weird

```
...
! [remote failure]  9.2.beta9 -> 9.2.beta9 (remote failed to report status)
! [remote failure]  9.2.rc0 -> 9.2.rc0 (remote failed to report status)
error: failed to push some refs to 'git@github.com:sagemath/sagetrac-mirror.git'
```
If you have time please feel free to play with this (in your own [GitHub](GitHub) repo, you can always transfer the ownership later): clone the trac repo with --mirror option, then try to push it to [GitHub](GitHub).

---

The ticket is meanwhile good to go, as the affected by it Docker and script things are currently not in use.



---

archive/issue_comments_581471.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-10-09T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581471",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_581472.json:
```json
{
    "body": "**Changing branch** from \"[u/dimpase/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/replacing_insecure_git____with_secure_https___)\" to \"[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)\".",
    "created_at": "2020-10-09T14:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581472",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Changing branch** from "[u/dimpase/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/replacing_insecure_git____with_secure_https___)" to "[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)".



---

archive/issue_comments_581473.json:
```json
{
    "body": "<a id='comment:28'></a>\nBecause you said, that the script is currently not in use, I just disabled it and added a link to this ticket.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56\">86b885d</a></td><td><code>Disabled a broken script</code></td></tr></table>\n",
    "created_at": "2020-10-09T14:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581473",
    "user": "https://github.com/Volker-Weissmann"
}
```

<a id='comment:28'></a>
Because you said, that the script is currently not in use, I just disabled it and added a link to this ticket.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56">86b885d</a></td><td><code>Disabled a broken script</code></td></tr></table>




---

archive/issue_comments_581474.json:
```json
{
    "body": "**Changing commit** from \"[b69a573ec475cd0087d0f79277855ab1fcbafe9f](https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f)\" to \"[86b885dc406fef8fc6935835c0a7a2f2fe927a56](https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56)\".",
    "created_at": "2020-10-09T14:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581474",
    "user": "https://github.com/Volker-Weissmann"
}
```

**Changing commit** from "[b69a573ec475cd0087d0f79277855ab1fcbafe9f](https://github.com/sagemath/sagetrac-mirror/commit/b69a573ec475cd0087d0f79277855ab1fcbafe9f)" to "[86b885dc406fef8fc6935835c0a7a2f2fe927a56](https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56)".



---

archive/issue_comments_581475.json:
```json
{
    "body": "<a id='comment:29'></a>\nOops, sorry, `sage-clone-source` is actually used in `sage-sdist`, which is, AFAIK, a part of Volker B.'s (vbraun) workflow to make distributions.\nBut we can assume that vbraun does use ssh authentication to pull from git trac, I suppose?\nVolker?",
    "created_at": "2020-10-09T22:17:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581475",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
Oops, sorry, `sage-clone-source` is actually used in `sage-sdist`, which is, AFAIK, a part of Volker B.'s (vbraun) workflow to make distributions.
But we can assume that vbraun does use ssh authentication to pull from git trac, I suppose?
Volker?



---

archive/issue_comments_581476.json:
```json
{
    "body": "**Changing status** from positive_review to needs_info.",
    "created_at": "2020-10-09T22:17:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581476",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from positive_review to needs_info.



---

archive/issue_comments_581477.json:
```json
{
    "body": "**Changing status** from needs_info to needs_work.",
    "created_at": "2020-10-10T00:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581477",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_info to needs_work.



---

archive/issue_comments_581478.json:
```json
{
    "body": "<a id='comment:30'></a>\n`sage-sdist` is also used in CI - see `.github/workflows/tox.yml`, job `dist`.",
    "created_at": "2020-10-10T00:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581478",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
`sage-sdist` is also used in CI - see `.github/workflows/tox.yml`, job `dist`.



---

archive/issue_comments_581479.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [mkoeppe](#comment%3A30):\n> `sage-sdist` is also used in CI - see `.github/workflows/tox.yml`, job `dist`.\n\n\nbut there it's not pulling from Sage's git repo, if I  understood you correctly, right?",
    "created_at": "2020-10-10T00:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581479",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>
Replying to [mkoeppe](#comment%3A30):
> `sage-sdist` is also used in CI - see `.github/workflows/tox.yml`, job `dist`.


but there it's not pulling from Sage's git repo, if I  understood you correctly, right?



---

archive/issue_comments_581480.json:
```json
{
    "body": "<a id='comment:32'></a>\nI had forgotten about this particular one. This one uses `make dist`, which leads to the use of `SAGE_REPO_ANONYMOUS`.\n\nThe idea of `make dist` (`sage-clone-source`), by the way, is that the source distribution (like the binary packages) distributes a `.git` directory that has a git remote that is accessible to any user...",
    "created_at": "2020-10-10T01:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581480",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
I had forgotten about this particular one. This one uses `make dist`, which leads to the use of `SAGE_REPO_ANONYMOUS`.

The idea of `make dist` (`sage-clone-source`), by the way, is that the source distribution (like the binary packages) distributes a `.git` directory that has a git remote that is accessible to any user...



---

archive/issue_comments_581481.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [mkoeppe](#comment%3A32):\n> I had forgotten about this particular one. This one uses `make dist`, which leads to the use of `SAGE_REPO_ANONYMOUS`.\n> \n> The idea of `make dist` (`sage-clone-source`), by the way, is that the source distribution (like the binary packages) distributes a `.git` directory that has a git remote that is accessible to any user...\n\n\nWhat branches are meant to be exposed this way? Experimental ones? One way or another, using a mirror rather than the git trac server could be better also for scalability (also removes the need to set up https access on git trac, something I'm not keen on doing, as it seems to be dark art :-)).\n\nI'm currenly building up a mirror on [GitLab](GitLab) - pushing all the branches one by one, otherwise it chokes up, so it should be ready in a day or two.",
    "created_at": "2020-10-10T07:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581481",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
Replying to [mkoeppe](#comment%3A32):
> I had forgotten about this particular one. This one uses `make dist`, which leads to the use of `SAGE_REPO_ANONYMOUS`.
> 
> The idea of `make dist` (`sage-clone-source`), by the way, is that the source distribution (like the binary packages) distributes a `.git` directory that has a git remote that is accessible to any user...


What branches are meant to be exposed this way? Experimental ones? One way or another, using a mirror rather than the git trac server could be better also for scalability (also removes the need to set up https access on git trac, something I'm not keen on doing, as it seems to be dark art :-)).

I'm currenly building up a mirror on [GitLab](GitLab) - pushing all the branches one by one, otherwise it chokes up, so it should be ready in a day or two.



---

archive/issue_comments_581482.json:
```json
{
    "body": "<a id='comment:34'></a>\nThere is also already functional https://gitlab.com/sagemath/dev/trac.git - which does updates by pulling using `git://`, so that currently defeats its purpose, security-wise. It should be possible to make it use ssh (not sure if we're in a tier that allows this for free). As well, it does pull every 30 minutes (or even a bit less often), so there is a delay.",
    "created_at": "2020-10-10T07:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581482",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
There is also already functional https://gitlab.com/sagemath/dev/trac.git - which does updates by pulling using `git://`, so that currently defeats its purpose, security-wise. It should be possible to make it use ssh (not sure if we're in a tier that allows this for free). As well, it does pull every 30 minutes (or even a bit less often), so there is a delay.



---

archive/issue_comments_581483.json:
```json
{
    "body": "<a id='comment:36'></a>\nFinally I got a push mirror running on https://gitlab.com/sagemath/dev/tracmirror -\nso this should be used whereever possible to reduce the load on our git server, and use `https:` in place of `git:`.\n\nSorry that it took so long.",
    "created_at": "2020-10-22T09:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581483",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
Finally I got a push mirror running on https://gitlab.com/sagemath/dev/tracmirror -
so this should be used whereever possible to reduce the load on our git server, and use `https:` in place of `git:`.

Sorry that it took so long.



---

archive/issue_comments_581484.json:
```json
{
    "body": "**Changing commit** from \"[86b885dc406fef8fc6935835c0a7a2f2fe927a56](https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56)\" to \"[c6a947d138981d089a38b47d98d02f47d423e190](https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190)\".",
    "created_at": "2020-10-22T09:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581484",
    "user": "https://github.com/dimpase"
}
```

**Changing commit** from "[86b885dc406fef8fc6935835c0a7a2f2fe927a56](https://github.com/sagemath/sagetrac-mirror/commit/86b885dc406fef8fc6935835c0a7a2f2fe927a56)" to "[c6a947d138981d089a38b47d98d02f47d423e190](https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190)".



---

archive/issue_comments_581485.json:
```json
{
    "body": "<a id='comment:37'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ebc40dd6dffac03545ba34a864da150011ff7f0\">1ebc40d</a></td><td><code>replaced insecure git:// with secure https:// or secure git over ssh</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cf3cd0fac686d7395c3fec8fc64d7e639ef9a15\">6cf3cd0</a></td><td><code>Disabled a broken script</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ecefe50bb1d346d27166ef81eb31a158c5cd7b43\">ecefe50</a></td><td><code>Revert \"Disabled a broken script\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190\">c6a947d</a></td><td><code>used https gitlab push mirror where appropriate</code></td></tr></table>\n",
    "created_at": "2020-10-22T09:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581485",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ebc40dd6dffac03545ba34a864da150011ff7f0">1ebc40d</a></td><td><code>replaced insecure git:// with secure https:// or secure git over ssh</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cf3cd0fac686d7395c3fec8fc64d7e639ef9a15">6cf3cd0</a></td><td><code>Disabled a broken script</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ecefe50bb1d346d27166ef81eb31a158c5cd7b43">ecefe50</a></td><td><code>Revert "Disabled a broken script"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190">c6a947d</a></td><td><code>used https gitlab push mirror where appropriate</code></td></tr></table>




---

archive/issue_comments_581486.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)\" to \"[public/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/public/replacing_insecure_git____with_secure_https___)\".",
    "created_at": "2020-10-22T09:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581486",
    "user": "https://github.com/dimpase"
}
```

**Changing branch** from "[u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Volker-Weissmann/replacing_insecure_git____with_secure_https___)" to "[public/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/public/replacing_insecure_git____with_secure_https___)".



---

archive/issue_comments_581487.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2020-10-22T09:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581487",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_581488.json:
```json
{
    "body": "<a id='comment:38'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6\">6797e46</a></td><td><code>remove git_trac spkg</code></td></tr></table>\n",
    "created_at": "2020-10-22T09:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6">6797e46</a></td><td><code>remove git_trac spkg</code></td></tr></table>




---

archive/issue_comments_581489.json:
```json
{
    "body": "**Changing commit** from \"[c6a947d138981d089a38b47d98d02f47d423e190](https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190)\" to \"[6797e46d64442438c7e82c598538ab97b12308c6](https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6)\".",
    "created_at": "2020-10-22T09:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581489",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c6a947d138981d089a38b47d98d02f47d423e190](https://github.com/sagemath/sagetrac-mirror/commit/c6a947d138981d089a38b47d98d02f47d423e190)" to "[6797e46d64442438c7e82c598538ab97b12308c6](https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6)".



---

archive/issue_comments_581490.json:
```json
{
    "body": "<a id='comment:39'></a>\nOK, so now it's as intended. Please review.",
    "created_at": "2020-10-22T09:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581490",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
OK, so now it's as intended. Please review.



---

archive/issue_comments_581491.json:
```json
{
    "body": "<a id='comment:40'></a>\nI don't understand how this is different from https://gitlab.com/sagemath/dev/trac which we already had.",
    "created_at": "2020-10-22T13:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581491",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'></a>
I don't understand how this is different from https://gitlab.com/sagemath/dev/trac which we already had.



---

archive/issue_comments_581492.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [embray](#comment%3A40):\n> I don't understand how this is different from https://gitlab.com/sagemath/dev/trac which we already had. \n\n\nthe old one is a pull mirror, so there is a 30+ min delay in updating it, as opposed to the new one, which is a push mirror, updated immediately via push from trac git server (via a post-receive commit hook)",
    "created_at": "2020-10-22T14:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581492",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
Replying to [embray](#comment%3A40):
> I don't understand how this is different from https://gitlab.com/sagemath/dev/trac which we already had. 


the old one is a pull mirror, so there is a 30+ min delay in updating it, as opposed to the new one, which is a push mirror, updated immediately via push from trac git server (via a post-receive commit hook)



---

archive/issue_comments_581493.json:
```json
{
    "body": "<a id='comment:42'></a>\nThis change seems to have been made mechanically without checking whether the server exists\n\n```\n--- a/build/pkgs/tdlib/SPKG.rst\n+++ b/build/pkgs/tdlib/SPKG.rst\n@@ -24,7 +24,7 @@ Upstream Contact\n ----------------\n \n - Lukas Larisch (larisch@informatik.uni-frankfurt.de)\n-- git-repo: git://pholia.tdi.cs.uni-frankfurt.de/git/tdlib\n+- git-repo: https://pholia.tdi.cs.uni-frankfurt.de/git/tdlib\n```",
    "created_at": "2020-10-22T15:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581493",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
This change seems to have been made mechanically without checking whether the server exists

```
--- a/build/pkgs/tdlib/SPKG.rst
+++ b/build/pkgs/tdlib/SPKG.rst
@@ -24,7 +24,7 @@ Upstream Contact
 ----------------
 
 - Lukas Larisch (larisch@informatik.uni-frankfurt.de)
-- git-repo: git://pholia.tdi.cs.uni-frankfurt.de/git/tdlib
+- git-repo: https://pholia.tdi.cs.uni-frankfurt.de/git/tdlib
```



---

archive/issue_comments_581494.json:
```json
{
    "body": "<a id='comment:43'></a>\n\n```\n if [ -z \"$SAGE_REPO_ANONYMOUS\" ]; then\n-    SAGE_REPO_ANONYMOUS=\"git://trac.sagemath.org/sage.git\"\n+    SAGE_REPO_ANONYMOUS=\"https://gitlab.com/sagemath/dev/tracmirror.git\"\n     export SAGE_REPO_ANONYMOUS\n fi\n```\nThis is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?",
    "created_at": "2020-10-22T15:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581494",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>

```
 if [ -z "$SAGE_REPO_ANONYMOUS" ]; then
-    SAGE_REPO_ANONYMOUS="git://trac.sagemath.org/sage.git"
+    SAGE_REPO_ANONYMOUS="https://gitlab.com/sagemath/dev/tracmirror.git"
     export SAGE_REPO_ANONYMOUS
 fi
```
This is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?



---

archive/issue_comments_581495.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [mkoeppe](#comment%3A43):\n> \n> ```\n>  if [ -z \"$SAGE_REPO_ANONYMOUS\" ]; then\n> -    SAGE_REPO_ANONYMOUS=\"git://trac.sagemath.org/sage.git\"\n> +    SAGE_REPO_ANONYMOUS=\"https://gitlab.com/sagemath/dev/tracmirror.git\"\n>      export SAGE_REPO_ANONYMOUS\n>  fi\n> ```\n> This is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?\n> \n\n\nSorry, I meant: Why is this one not using the github URL to match what is advertised in README?",
    "created_at": "2020-10-22T15:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581495",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>
Replying to [mkoeppe](#comment%3A43):
> 
> ```
>  if [ -z "$SAGE_REPO_ANONYMOUS" ]; then
> -    SAGE_REPO_ANONYMOUS="git://trac.sagemath.org/sage.git"
> +    SAGE_REPO_ANONYMOUS="https://gitlab.com/sagemath/dev/tracmirror.git"
>      export SAGE_REPO_ANONYMOUS
>  fi
> ```
> This is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?
> 


Sorry, I meant: Why is this one not using the github URL to match what is advertised in README?



---

archive/issue_comments_581496.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [mkoeppe](#comment%3A44):\n> Replying to [mkoeppe](#comment%3A43):\n> > \n> > ```\n> >  if [ -z \"$SAGE_REPO_ANONYMOUS\" ]; then\n> > -    SAGE_REPO_ANONYMOUS=\"git://trac.sagemath.org/sage.git\"\n> > +    SAGE_REPO_ANONYMOUS=\"https://gitlab.com/sagemath/dev/tracmirror.git\"\n> >      export SAGE_REPO_ANONYMOUS\n> >  fi\n> > ```\n> > This is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?\n> > \n\n> \n> Sorry, I meant: Why is this one not using the github URL to match what is advertised in README?\n\non github we now only have a repo with develop and master branches (and all the tags for betas/rcs, starting from 8.5.beta1)\n\nthe gitlab repo used on this ticket is a true push mirror, carrying all the branches, and only behind the git trac server by seconds.\n(and as git trac does not allow https access, we use the gitlab repo, which does allow https)",
    "created_at": "2020-10-22T17:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581496",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:45'></a>
Replying to [mkoeppe](#comment%3A44):
> Replying to [mkoeppe](#comment%3A43):
> > 
> > ```
> >  if [ -z "$SAGE_REPO_ANONYMOUS" ]; then
> > -    SAGE_REPO_ANONYMOUS="git://trac.sagemath.org/sage.git"
> > +    SAGE_REPO_ANONYMOUS="https://gitlab.com/sagemath/dev/tracmirror.git"
> >      export SAGE_REPO_ANONYMOUS
> >  fi
> > ```
> > This is the one that the source tarballs made using `make dist` will be referring to. Why is this one using gitlab instead of the new mirror?
> > 

> 
> Sorry, I meant: Why is this one not using the github URL to match what is advertised in README?

on github we now only have a repo with develop and master branches (and all the tags for betas/rcs, starting from 8.5.beta1)

the gitlab repo used on this ticket is a true push mirror, carrying all the branches, and only behind the git trac server by seconds.
(and as git trac does not allow https access, we use the gitlab repo, which does allow https)



---

archive/issue_comments_581497.json:
```json
{
    "body": "<a id='comment:46'></a>\nThat's great, thanks for the explanation.",
    "created_at": "2020-10-22T17:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581497",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
That's great, thanks for the explanation.



---

archive/issue_comments_581498.json:
```json
{
    "body": "<a id='comment:47'></a>\nI think `sage-clone-source` should be changed so that either the `push` URL is removed, or set to trac.",
    "created_at": "2020-10-22T17:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581498",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
I think `sage-clone-source` should be changed so that either the `push` URL is removed, or set to trac.



---

archive/issue_comments_581499.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [mkoeppe](#comment%3A47):\n> I think `sage-clone-source` should be changed so that either the `push` URL is removed, or set to trac.\n\nRight now we have:\n\n```\n$ git remote -v\norigin\thttps://gitlab.com/sagemath/dev/tracmirror.git (fetch)\norigin\thttps://gitlab.com/sagemath/dev/tracmirror.git (push)\n```",
    "created_at": "2020-10-22T17:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581499",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:48'></a>
Replying to [mkoeppe](#comment%3A47):
> I think `sage-clone-source` should be changed so that either the `push` URL is removed, or set to trac.

Right now we have:

```
$ git remote -v
origin	https://gitlab.com/sagemath/dev/tracmirror.git (fetch)
origin	https://gitlab.com/sagemath/dev/tracmirror.git (push)
```



---

archive/issue_comments_581500.json:
```json
{
    "body": "<a id='comment:49'></a>\n\n```\ndiff --git a/build/bin/sage-clone-source b/build/bin/sage-clone-source\nindex 6720ea7391..dbbf33a786 100755\n--- a/build/bin/sage-clone-source\n+++ b/build/bin/sage-clone-source\n@@ -35,6 +35,7 @@ git clone \"$SRC\" \"$DST\"\n \n cd \"$DST\"\n git remote set-url origin \"$SAGE_REPO_ANONYMOUS\"\n+git remote set-url --push origin \"$SAGE_REPO_AUTHENTICATED\"\n \n # Save space\n git gc --aggressive --prune=now\n```",
    "created_at": "2020-10-22T17:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581500",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>

```
diff --git a/build/bin/sage-clone-source b/build/bin/sage-clone-source
index 6720ea7391..dbbf33a786 100755
--- a/build/bin/sage-clone-source
+++ b/build/bin/sage-clone-source
@@ -35,6 +35,7 @@ git clone "$SRC" "$DST"
 
 cd "$DST"
 git remote set-url origin "$SAGE_REPO_ANONYMOUS"
+git remote set-url --push origin "$SAGE_REPO_AUTHENTICATED"
 
 # Save space
 git gc --aggressive --prune=now
```



---

archive/issue_comments_581501.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [mkoeppe](#comment%3A42):\n> This change seems to have been made mechanically without checking whether the server exists\n\n\nI agree. It seems that the current active upstream is at https://github.com/freetdi/tdlib\nand the old servers are long gone.\n(email is obsolete too, the current affiliation of Larisch appears to be KAUST:\nhttps://cemse.kaust.edu.sa/cs/people/person/lukas-larisch)\n\nI'll fix this.",
    "created_at": "2020-10-22T17:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581501",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'></a>
Replying to [mkoeppe](#comment%3A42):
> This change seems to have been made mechanically without checking whether the server exists


I agree. It seems that the current active upstream is at https://github.com/freetdi/tdlib
and the old servers are long gone.
(email is obsolete too, the current affiliation of Larisch appears to be KAUST:
https://cemse.kaust.edu.sa/cs/people/person/lukas-larisch)

I'll fix this.



---

archive/issue_comments_581502.json:
```json
{
    "body": "<a id='comment:51'></a>\nI've opened #30813 to investigate a possibility to update tdlib.",
    "created_at": "2020-10-22T17:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581502",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'></a>
I've opened #30813 to investigate a possibility to update tdlib.



---

archive/issue_comments_581503.json:
```json
{
    "body": "<a id='comment:52'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9a542f2b7bb74964256ecd85a9c203487b65abd\">c9a542f</a></td><td><code>correct push URL - needs authentication</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7\">f482f0c</a></td><td><code>update tdlib info</code></td></tr></table>\n",
    "created_at": "2020-10-22T18:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581503",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9a542f2b7bb74964256ecd85a9c203487b65abd">c9a542f</a></td><td><code>correct push URL - needs authentication</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7">f482f0c</a></td><td><code>update tdlib info</code></td></tr></table>




---

archive/issue_comments_581504.json:
```json
{
    "body": "**Changing commit** from \"[6797e46d64442438c7e82c598538ab97b12308c6](https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6)\" to \"[f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)\".",
    "created_at": "2020-10-22T18:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6797e46d64442438c7e82c598538ab97b12308c6](https://github.com/sagemath/sagetrac-mirror/commit/6797e46d64442438c7e82c598538ab97b12308c6)" to "[f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)".



---

archive/issue_comments_581505.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-10-22T19:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581505",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_089952.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89952"
}
```



---

archive/issue_events_089953.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89953"
}
```



---

archive/issue_comments_581506.json:
```json
{
    "body": "**Changing reviewer** from \"Dima Pasechnik\" to \"Dima Pasechnik, Matthias Koeppe\".",
    "created_at": "2020-10-22T19:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581506",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Dima Pasechnik" to "Dima Pasechnik, Matthias Koeppe".



---

archive/issue_comments_581507.json:
```json
{
    "body": "**Changing author** from \"Volker Weissmann\" to \"Volker Weissmann, Dima Pasechnik\".",
    "created_at": "2020-10-22T19:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581507",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Volker Weissmann" to "Volker Weissmann, Dima Pasechnik".



---

archive/issue_events_089954.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89954"
}
```



---

archive/issue_comments_581508.json:
```json
{
    "body": "<a id='comment:54'></a>\nNot a blocker",
    "created_at": "2020-10-24T11:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581508",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:54'></a>
Not a blocker



---

archive/issue_comments_581509.json:
```json
{
    "body": "<a id='comment:55'></a>\nwell, if you prefer leaving security holes open...",
    "created_at": "2020-10-24T11:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581509",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
well, if you prefer leaving security holes open...



---

archive/issue_events_089955.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89955"
}
```



---

archive/issue_comments_581510.json:
```json
{
    "body": "<a id='comment:57'></a>\nwill this allow to fix our current docker hub problem ?\n\nApparently if fails on the following line in docker/Dockerfile:\n\n```\ngit remote add trac git://trac.sagemath.org/sage.git\n```\n\nSee https://gitlab.com/sagemath/sage/-/pipelines",
    "created_at": "2020-10-25T19:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581510",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:57'></a>
will this allow to fix our current docker hub problem ?

Apparently if fails on the following line in docker/Dockerfile:

```
git remote add trac git://trac.sagemath.org/sage.git
```

See https://gitlab.com/sagemath/sage/-/pipelines



---

archive/issue_events_089956.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-01T00:42:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30736#event-89956"
}
```



---

archive/issue_comments_581511.json:
```json
{
    "body": "**Changing branch** from \"[public/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/public/replacing_insecure_git____with_secure_https___)\" to \"[f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)\".",
    "created_at": "2020-11-01T00:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30736#issuecomment-581511",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/replacing_insecure_git____with_secure_https___](https://github.com/sagemath/sagetrac-mirror/tree/public/replacing_insecure_git____with_secure_https___)" to "[f482f0c25a5c50cba16252dc4f527fc7092be0b7](https://github.com/sagemath/sagetrac-mirror/commit/f482f0c25a5c50cba16252dc4f527fc7092be0b7)".
