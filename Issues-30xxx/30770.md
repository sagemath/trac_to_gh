# Issue 30770: cython_aliases: Use ecl-config to determine compiler/linker flags for ecl

archive/issues_030533.json:
```json
{
    "body": "We use ecl-config to determine compiler/linker flags for ecl. This is a step towards using a system-installed ecl and is needed/helpful for installing sage in virtual environments (#30371).\n\n```\n$ ecl-config --help\nUsage: /usr/local/bin/ecl-config [OPTIONS] [LIBS]\nOptions: \n\t[--cflags]\n\t[--libs|--ldflags]\nLibs:\n\tcmp\n```\nSample output:\n\n```\n> ./local/bin/ecl-config --cflags --libs\n-Dlinux   -I/mnt/d/Programming/sage/local/include\n-Wl,--rpath,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -lecl -Wl,-rpath-link,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -Wl,-rpath,/mnt/d/Programming/sage/local/lib      -ldl -lm\n```\n\n\n\nCC:  @dimpase @orlitzky @spaghettisalat @jhpalmieri @tobiasdiez @isuruf @kiwifb @antonio-rojas\n\nKeywords: sd111\n\nReviewer: Matthias Koeppe, Dima Pasechnik\n\nAuthor: Tobias Diez, Matthias Koeppe\n\nBranch: 11ad40ae805a29feb59f0db4816cc21cd5be9f4f\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30770\n\n",
    "closed_at": "2021-02-20T10:46:49Z",
    "created_at": "2020-10-15T03:25:08Z",
    "labels": [
        "component: build",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "cython_aliases: Use ecl-config to determine compiler/linker flags for ecl",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30770",
    "user": "https://github.com/mkoeppe"
}
```
We use ecl-config to determine compiler/linker flags for ecl. This is a step towards using a system-installed ecl and is needed/helpful for installing sage in virtual environments (#30371).

```
$ ecl-config --help
Usage: /usr/local/bin/ecl-config [OPTIONS] [LIBS]
Options: 
	[--cflags]
	[--libs|--ldflags]
Libs:
	cmp
```
Sample output:

```
> ./local/bin/ecl-config --cflags --libs
-Dlinux   -I/mnt/d/Programming/sage/local/include
-Wl,--rpath,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -lecl -Wl,-rpath-link,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -Wl,-rpath,/mnt/d/Programming/sage/local/lib      -ldl -lm
```



CC:  @dimpase @orlitzky @spaghettisalat @jhpalmieri @tobiasdiez @isuruf @kiwifb @antonio-rojas

Keywords: sd111

Reviewer: Matthias Koeppe, Dima Pasechnik

Author: Tobias Diez, Matthias Koeppe

Branch: 11ad40ae805a29feb59f0db4816cc21cd5be9f4f

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30770





---

archive/issue_events_080226.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30770#event-80226"
}
```



---

archive/issue_comments_609524.json:
```json
{
    "body": "<a id='comment:2'></a>Ideally, of course, ecl would install a pkg-config module...",
    "created_at": "2020-11-01T16:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609524",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Ideally, of course, ecl would install a pkg-config module...



---

archive/issue_comments_609525.json:
```json
{
    "body": "<a id='comment:3'></a>Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609525",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_comments_609526.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609526",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_609527.json:
```json
{
    "body": "Changing commit from \"\" to \"3049e53618902318c8247e277d28f50c1f59f545\"",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609527",
    "user": "https://github.com/tobiasdiez"
}
```

Changing commit from "" to "3049e53618902318c8247e277d28f50c1f59f545"



---

archive/issue_comments_609528.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+We use ecl-config to determine compiler/linker flags for ecl. This is a step towards using a system-installed ecl and is needed/helpful for installing sage in virtual environments (#30371).\n+\n ```\n $ ecl-config --help\n Usage: /usr/local/bin/ecl-config [OPTIONS] [LIBS]\n@@ -7,6 +9,15 @@\n Libs:\n \tcmp\n ```\n+Sample output:\n+\n+```\n+> ./local/bin/ecl-config --cflags --libs\n+-Dlinux   -I/mnt/d/Programming/sage/local/include\n+-Wl,--rpath,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -lecl -Wl,-rpath-link,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -Wl,-rpath,/mnt/d/Programming/sage/local/lib      -ldl -lm\n+```\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609528",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+We use ecl-config to determine compiler/linker flags for ecl. This is a step towards using a system-installed ecl and is needed/helpful for installing sage in virtual environments (#30371).
+
 ```
 $ ecl-config --help
 Usage: /usr/local/bin/ecl-config [OPTIONS] [LIBS]
@@ -7,6 +9,15 @@
 Libs:
 	cmp
 ```
+Sample output:
+
+```
+> ./local/bin/ecl-config --cflags --libs
+-Dlinux   -I/mnt/d/Programming/sage/local/include
+-Wl,--rpath,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -lecl -Wl,-rpath-link,/mnt/d/Programming/sage/local/lib -L/mnt/d/Programming/sage/local/lib -Wl,-rpath,/mnt/d/Programming/sage/local/lib      -ldl -lm
+```
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_609529.json:
```json
{
    "body": "Changing branch from \"\" to \"public/build/ecl-config\"",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609529",
    "user": "https://github.com/tobiasdiez"
}
```

Changing branch from "" to "public/build/ecl-config"



---

archive/issue_comments_609530.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609530",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_609531.json:
```json
{
    "body": "Changing author from \"\" to \"Tobias Diez\"",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609531",
    "user": "https://github.com/tobiasdiez"
}
```

Changing author from "" to "Tobias Diez"



---

archive/issue_comments_609532.json:
```json
{
    "body": "<a id='comment:6'></a>The following is working for me (in the context of #30371).\n\n---\nNew commits:",
    "created_at": "2021-01-11T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609532",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>The following is working for me (in the context of #30371).

---
New commits:



---

archive/issue_comments_609533.json:
```json
{
    "body": "<a id='comment:7'></a>Following the conventions of autoconf, this variable should be called `ECL_CONFIG`, not `ECL_CONFIG_PATH`",
    "created_at": "2021-01-11T17:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609533",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Following the conventions of autoconf, this variable should be called `ECL_CONFIG`, not `ECL_CONFIG_PATH`



---

archive/issue_comments_609534.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-12T12:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_609535.json:
```json
{
    "body": "Changing commit from \"3049e53618902318c8247e277d28f50c1f59f545\" to \"1041128342253f609a9c3b8f8efe4495bc314a2e\"",
    "created_at": "2021-01-12T12:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3049e53618902318c8247e277d28f50c1f59f545" to "1041128342253f609a9c3b8f8efe4495bc314a2e"



---

archive/issue_comments_609536.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 mkoeppe]:\n> Following the conventions of autoconf, this variable should be called `ECL_CONFIG`, not `ECL_CONFIG_PATH`\n\n\nI'm not sure if one should follow the autoconf conventions here since the variable is (right now) only used in python scripts, but I've renamed it anyway.",
    "created_at": "2021-01-12T12:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609536",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>Replying to [comment:7 mkoeppe]:
> Following the conventions of autoconf, this variable should be called `ECL_CONFIG`, not `ECL_CONFIG_PATH`


I'm not sure if one should follow the autoconf conventions here since the variable is (right now) only used in python scripts, but I've renamed it anyway.



---

archive/issue_comments_609537.json:
```json
{
    "body": "<a id='comment:10'></a>`capture_output` is not available on Python 3.6 - see #30758",
    "created_at": "2021-01-12T17:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609537",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>`capture_output` is not available on Python 3.6 - see #30758



---

archive/issue_comments_609538.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30551\"",
    "created_at": "2021-01-12T21:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609538",
    "user": "https://github.com/tobiasdiez"
}
```

Changing dependencies from "" to "#30551"



---

archive/issue_comments_609539.json:
```json
{
    "body": "<a id='comment:12'></a>I think it's better to make the simple change of the code as in https://git.sagemath.org/sage.git/commit?id=a569b88f02ab4dfdd8eec6e8ad0472f1f537d2c8\ninstead of deferring this ticket until after we drop support for python 3.6",
    "created_at": "2021-01-12T23:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609539",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>I think it's better to make the simple change of the code as in https://git.sagemath.org/sage.git/commit?id=a569b88f02ab4dfdd8eec6e8ad0472f1f537d2c8
instead of deferring this ticket until after we drop support for python 3.6



---

archive/issue_comments_609540.json:
```json
{
    "body": "<a id='comment:13'></a>I have yet to see a system that ships patched ECL, allowing one to build Maxima in Sage, etc.",
    "created_at": "2021-01-13T14:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609540",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>I have yet to see a system that ships patched ECL, allowing one to build Maxima in Sage, etc.



---

archive/issue_comments_609541.json:
```json
{
    "body": "<a id='comment:14'></a>I use this ticket successfully in #30371 to build sage in a new python virtual environment using sage's ecl precisely because the system ecl is not working.",
    "created_at": "2021-01-13T14:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609541",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:14'></a>I use this ticket successfully in #30371 to build sage in a new python virtual environment using sage's ecl precisely because the system ecl is not working.



---

archive/issue_comments_609542.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 dimpase]:\n> I have yet to see a system that ships patched ECL, allowing one to build Maxima in Sage, etc.\n\nSurely distributions that ship sage must have a suitable package: conda, arch, ...?",
    "created_at": "2021-01-13T17:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609542",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Replying to [comment:13 dimpase]:
> I have yet to see a system that ships patched ECL, allowing one to build Maxima in Sage, etc.

Surely distributions that ship sage must have a suitable package: conda, arch, ...?



---

archive/issue_comments_609543.json:
```json
{
    "body": "<a id='comment:17'></a>\n```\n@@ -203,6 +204,7 @@ var('MAXIMA_FAS')\n var('SAGE_NAUTY_BINS_PREFIX',        '')\n var('ARB_LIBRARY',                   'arb')\n var('CBLAS_PC_MODULES',              'cblas:openblas:blas')\n+var('ECL_CONFIG')\n \n # misc\n var('SAGE_BANNER', '')\n```\n\nPlease add a fallback here, otherwise this will break distro packaging without sage_conf",
    "created_at": "2021-01-13T21:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609543",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:17'></a>
```
@@ -203,6 +204,7 @@ var('MAXIMA_FAS')
 var('SAGE_NAUTY_BINS_PREFIX',        '')
 var('ARB_LIBRARY',                   'arb')
 var('CBLAS_PC_MODULES',              'cblas:openblas:blas')
+var('ECL_CONFIG')
 
 # misc
 var('SAGE_BANNER', '')
```

Please add a fallback here, otherwise this will break distro packaging without sage_conf



---

archive/issue_comments_609544.json:
```json
{
    "body": "<a id='comment:18'></a>Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?",
    "created_at": "2021-01-13T21:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609544",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:18'></a>Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?



---

archive/issue_comments_609545.json:
```json
{
    "body": "<a id='comment:19'></a>I think we can change our maxima installation to use a different installation directoery and then pass the full path using the existing variable `sage.env.MAXIMA_FAS`",
    "created_at": "2021-01-13T21:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609545",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>I think we can change our maxima installation to use a different installation directoery and then pass the full path using the existing variable `sage.env.MAXIMA_FAS`



---

archive/issue_comments_609546.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:17 arojas]:\n> {{{\n> `@``@` -203,6 +204,7 `@``@` var('MAXIMA_FAS')\n>  var('SAGE_NAUTY_BINS_PREFIX',        '')\n>  var('ARB_LIBRARY',                   'arb')\n>  var('CBLAS_PC_MODULES',              'cblas:openblas:blas')\n> +var('ECL_CONFIG')\n>  \n>  # misc\n>  var('SAGE_BANNER', '')\n> }}}\n> \n> Please add a fallback here, otherwise this will break distro packaging without sage_conf\n\n\nI agree, this should fall back to just `'ecl-config'`",
    "created_at": "2021-01-13T23:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609546",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Replying to [comment:17 arojas]:
> {{{
> `@``@` -203,6 +204,7 `@``@` var('MAXIMA_FAS')
>  var('SAGE_NAUTY_BINS_PREFIX',        '')
>  var('ARB_LIBRARY',                   'arb')
>  var('CBLAS_PC_MODULES',              'cblas:openblas:blas')
> +var('ECL_CONFIG')
>  
>  # misc
>  var('SAGE_BANNER', '')
> }}}
> 
> Please add a fallback here, otherwise this will break distro packaging without sage_conf


I agree, this should fall back to just `'ecl-config'`



---

archive/issue_comments_609547.json:
```json
{
    "body": "<a id='comment:21'></a>Good catch, I've now added a fallback!",
    "created_at": "2021-01-14T09:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609547",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:21'></a>Good catch, I've now added a fallback!



---

archive/issue_comments_609548.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-14T09:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609548",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_609549.json:
```json
{
    "body": "Changing commit from \"1041128342253f609a9c3b8f8efe4495bc314a2e\" to \"fd05a972b62b0014995887f1372e7934866fdf24\"",
    "created_at": "2021-01-14T09:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609549",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1041128342253f609a9c3b8f8efe4495bc314a2e" to "fd05a972b62b0014995887f1372e7934866fdf24"



---

archive/issue_comments_609550.json:
```json
{
    "body": "<a id='comment:23'></a>#30551 is for 9.4, why is this one still for 9.3 ? (I'd rather switch #30551 to 9.3, though)",
    "created_at": "2021-01-15T14:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609550",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>#30551 is for 9.4, why is this one still for 9.3 ? (I'd rather switch #30551 to 9.3, though)



---

archive/issue_comments_609551.json:
```json
{
    "body": "<a id='comment:24'></a>I've put #30551 now to 9.3 since I agree it would be convenient to drop python 3.6 support soon. Matthias, please feel free to put both tickets onto 9.4 if you strongly feel that 3.6 still needs to be supported.",
    "created_at": "2021-01-15T14:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609551",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:24'></a>I've put #30551 now to 9.3 since I agree it would be convenient to drop python 3.6 support soon. Matthias, please feel free to put both tickets onto 9.4 if you strongly feel that 3.6 still needs to be supported.



---

archive/issue_comments_609552.json:
```json
{
    "body": "<a id='comment:25'></a>Let's please not use a ticket like this where we know exactly how to write python 3.6 conforming code to force a decision that needs proper discussion in #30551.",
    "created_at": "2021-01-15T17:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609552",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>Let's please not use a ticket like this where we know exactly how to write python 3.6 conforming code to force a decision that needs proper discussion in #30551.



---

archive/issue_comments_609553.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-01-15T17:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609553",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_609554.json:
```json
{
    "body": "Changing commit from \"fd05a972b62b0014995887f1372e7934866fdf24\" to \"6370c345114d50095e84a9b2e7917dd8cae3bfe6\"",
    "created_at": "2021-01-15T17:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609554",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fd05a972b62b0014995887f1372e7934866fdf24" to "6370c345114d50095e84a9b2e7917dd8cae3bfe6"



---

archive/issue_comments_609555.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-15T17:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609555",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_609556.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-15T17:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609556",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_609557.json:
```json
{
    "body": "Changing author from \"Tobias Diez\" to \"Tobias Diez, Matthias Koeppe\"",
    "created_at": "2021-01-15T17:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609557",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Tobias Diez" to "Tobias Diez, Matthias Koeppe"



---

archive/issue_comments_609558.json:
```json
{
    "body": "Changing commit from \"6370c345114d50095e84a9b2e7917dd8cae3bfe6\" to \"31f1bbba244263160e887613b34111bc3a20d4f4\"",
    "created_at": "2021-01-16T04:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609558",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6370c345114d50095e84a9b2e7917dd8cae3bfe6" to "31f1bbba244263160e887613b34111bc3a20d4f4"



---

archive/issue_comments_609559.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-16T04:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_609560.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                                           |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n> |[31f1bbb](https://git.sagemath.org/sage.git/commit/?id=31f1bbba244263160e887613b34111bc3a20d4f4)|`Also use universal_newlines instead of text, for python 3.6 compatibility`|\n\n\nWhy do you push Python-3.6-needed changes to a ticket that depends on #30551 ?\nIt just makes no sense to me.",
    "created_at": "2021-01-16T10:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609560",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>Replying to [comment:28 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                                           |
> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
> |[31f1bbb](https://git.sagemath.org/sage.git/commit/?id=31f1bbba244263160e887613b34111bc3a20d4f4)|`Also use universal_newlines instead of text, for python 3.6 compatibility`|


Why do you push Python-3.6-needed changes to a ticket that depends on #30551 ?
It just makes no sense to me.



---

archive/issue_comments_609561.json:
```json
{
    "body": "<a id='comment:30'></a>Thanks. I forgot to remove the dependency.",
    "created_at": "2021-01-16T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609561",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>Thanks. I forgot to remove the dependency.



---

archive/issue_comments_609562.json:
```json
{
    "body": "Changing dependencies from \"#30551\" to \"\"",
    "created_at": "2021-01-16T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609562",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30551" to ""



---

archive/issue_comments_609563.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:18 arojas]:\n> Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?\n\n\nWhere do distributions install compiled common lisp libraries?",
    "created_at": "2021-01-16T18:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609563",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>Replying to [comment:18 arojas]:
> Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?


Where do distributions install compiled common lisp libraries?



---

archive/issue_comments_609564.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 mkoeppe]:\n> Replying to [comment:18 arojas]:\n> > Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?\n\n> \n> Where do distributions install compiled common lisp libraries?\n\nGentoo does it in `/usr/lib64/ecl-20.4.24` - as can be seen it is versioned. This is the place where ecl put a lot of its own libraries. It is determined by running the following ecl lisp formula, which I believe is the same in vanilla sage.\n\n```\necl -eval \"(princ (SI:GET-LIBRARY-PATHNAME))\" -eval \"(quit)\"\n```\nIt could be interesting to know other, or how to set other, paths to install .fas files for ecl.",
    "created_at": "2021-01-16T19:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609564",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:32'></a>Replying to [comment:31 mkoeppe]:
> Replying to [comment:18 arojas]:
> > Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?

> 
> Where do distributions install compiled common lisp libraries?

Gentoo does it in `/usr/lib64/ecl-20.4.24` - as can be seen it is versioned. This is the place where ecl put a lot of its own libraries. It is determined by running the following ecl lisp formula, which I believe is the same in vanilla sage.

```
ecl -eval "(princ (SI:GET-LIBRARY-PATHNAME))" -eval "(quit)"
```
It could be interesting to know other, or how to set other, paths to install .fas files for ecl.



---

archive/issue_comments_609565.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:32 fbissey]:\n> Replying to [comment:31 mkoeppe]:\n> > Replying to [comment:18 arojas]:\n> > > Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?\n\n> > \n> > Where do distributions install compiled common lisp libraries?\n\n> Gentoo does it in `/usr/lib64/ecl-20.4.24` - as can be seen it is versioned. This is the place where ecl put a lot of its own libraries. It is determined by running the following ecl lisp formula, which I believe is the same in vanilla sage.\n> {{{\n> ecl -eval \"(princ (SI:GET-LIBRARY-PATHNAME))\" -eval \"(quit)\"\n> }}}\n> It could be interesting to know other, or how to set other, paths to install .fas files for ecl. \n\n\nThere is no universally agreed place to put .fas files, after all you can just use `(load \"/wherever/whatever.fas\")` to load them from any place you like. But `/usr/lib64/ecl-20.4.24` makes the most sense for libraries useable for multiple projects and also allows you to call `(require :whatever)` to use the fas in ECL. On the other hand, if the .fas file is only useable for a single project, I would rather put it in `/usr/lib64/some-other-project/` and explicitely load it from there.",
    "created_at": "2021-01-17T19:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609565",
    "user": "https://github.com/spaghettisalat"
}
```

<a id='comment:33'></a>Replying to [comment:32 fbissey]:
> Replying to [comment:31 mkoeppe]:
> > Replying to [comment:18 arojas]:
> > > Given that sage's maxima is patched to install a fas module in ecl's tree, how is this supposed to work with a system ecl?

> > 
> > Where do distributions install compiled common lisp libraries?

> Gentoo does it in `/usr/lib64/ecl-20.4.24` - as can be seen it is versioned. This is the place where ecl put a lot of its own libraries. It is determined by running the following ecl lisp formula, which I believe is the same in vanilla sage.
> {{{
> ecl -eval "(princ (SI:GET-LIBRARY-PATHNAME))" -eval "(quit)"
> }}}
> It could be interesting to know other, or how to set other, paths to install .fas files for ecl. 


There is no universally agreed place to put .fas files, after all you can just use `(load "/wherever/whatever.fas")` to load them from any place you like. But `/usr/lib64/ecl-20.4.24` makes the most sense for libraries useable for multiple projects and also allows you to call `(require :whatever)` to use the fas in ECL. On the other hand, if the .fas file is only useable for a single project, I would rather put it in `/usr/lib64/some-other-project/` and explicitely load it from there.



---

archive/issue_comments_609566.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe, ...\"",
    "created_at": "2021-01-17T19:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609566",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe, ..."



---

archive/issue_comments_609567.json:
```json
{
    "body": "<a id='comment:35'></a>This is extremely interesting, how would you load a .fas from an arbitrary location?",
    "created_at": "2021-01-17T19:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609567",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:35'></a>This is extremely interesting, how would you load a .fas from an arbitrary location?



---

archive/issue_comments_609568.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:35 fbissey]:\n> This is extremely interesting, how would you load a .fas from an arbitrary location?\n\n\nAs I said, you just call `(load \"/path/to/lib.fas\")`. This is a standard common lisp function for loading compiled code or source code into the running image, much like `dlopen` loads a shared library in C.",
    "created_at": "2021-01-17T19:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609568",
    "user": "https://github.com/spaghettisalat"
}
```

<a id='comment:36'></a>Replying to [comment:35 fbissey]:
> This is extremely interesting, how would you load a .fas from an arbitrary location?


As I said, you just call `(load "/path/to/lib.fas")`. This is a standard common lisp function for loading compiled code or source code into the running image, much like `dlopen` loads a shared library in C.



---

archive/issue_comments_609569.json:
```json
{
    "body": "Changing commit from \"31f1bbba244263160e887613b34111bc3a20d4f4\" to \"11ad40ae805a29feb59f0db4816cc21cd5be9f4f\"",
    "created_at": "2021-01-19T16:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609569",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "31f1bbba244263160e887613b34111bc3a20d4f4" to "11ad40ae805a29feb59f0db4816cc21cd5be9f4f"



---

archive/issue_comments_609570.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-19T16:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609570",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_609571.json:
```json
{
    "body": "<a id='comment:38'></a>Let's continue the discussion on Maxima FASL installation in #29617 (spkg-configure.m4 and distros/ information for ecl)\n\nThe present ticket is about the parameters for compiling the `sage.libs.ecl` extension. Needs review",
    "created_at": "2021-01-19T21:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609571",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>Let's continue the discussion on Maxima FASL installation in #29617 (spkg-configure.m4 and distros/ information for ecl)

The present ticket is about the parameters for compiling the `sage.libs.ecl` extension. Needs review



---

archive/issue_comments_609572.json:
```json
{
    "body": "<a id='comment:39'></a>Let's please get this in",
    "created_at": "2021-02-02T21:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609572",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>Let's please get this in



---

archive/issue_comments_609573.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-02-02T21:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609573",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_609574.json:
```json
{
    "body": "<a id='comment:40'></a>lgtm",
    "created_at": "2021-02-03T00:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609574",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'></a>lgtm



---

archive/issue_comments_609575.json:
```json
{
    "body": "Changing reviewer from \"Matthias Koeppe, ...\" to \"Matthias Koeppe, Dima Pasechnik\"",
    "created_at": "2021-02-03T00:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609575",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "Matthias Koeppe, ..." to "Matthias Koeppe, Dima Pasechnik"



---

archive/issue_comments_609576.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-02-03T00:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609576",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_609577.json:
```json
{
    "body": "<a id='comment:41'></a>Thanks!",
    "created_at": "2021-02-03T09:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609577",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:41'></a>Thanks!



---

archive/issue_comments_609578.json:
```json
{
    "body": "Changing branch from \"public/build/ecl-config\" to \"11ad40ae805a29feb59f0db4816cc21cd5be9f4f\"",
    "created_at": "2021-02-20T10:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609578",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/build/ecl-config" to "11ad40ae805a29feb59f0db4816cc21cd5be9f4f"



---

archive/issue_events_080227.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-02-20T10:46:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30770#event-80227"
}
```



---

archive/issue_comments_609579.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-02-20T10:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609579",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_609580.json:
```json
{
    "body": "Changing commit from \"11ad40ae805a29feb59f0db4816cc21cd5be9f4f\" to \"\"",
    "created_at": "2022-05-05T17:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609580",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "11ad40ae805a29feb59f0db4816cc21cd5be9f4f" to ""



---

archive/issue_comments_609581.json:
```json
{
    "body": "<a id='comment:43'></a>Follow up in #33803",
    "created_at": "2022-05-05T17:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30770",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30770#issuecomment-609581",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>Follow up in #33803
