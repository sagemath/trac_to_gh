# Issue 30263: declare_union yields wrong results

archive/issues_030026.json:
```json
{
    "body": "(for the visualization of the posets, use #31680 and install the `dot2tex` package - without that package, the layout is quite misleading)\n\n```\nsage: M = Manifold(3, 'M')\nsage: U = M.open_subset('U'); V = M.open_subset('V'); W = M.open_subset('W')\nsage: M.declare_union(U, V, W)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-c7f527dcc1ea> in <module>()\n----> 1 M.declare_union(U, V, W)\n\nTypeError: declare_union() takes 3 positional arguments but 4 were given\n\nsage: def label(element): \n....:     try: \n....:         return element._name \n....:     except AttributeError: \n....:         return '[' + ', '.join(sorted(x._name for x in element)) + ']' \n\nsage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n\nsage: M.declare_union(U, V.union(W))\nsage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n\nsage: U.union(V).union(W)\nOpen subset U_union_V_union_W of the 3-dimensional differentiable manifold M\nsage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n\nsage: U.union(V.union(W))\n3-dimensional differentiable manifold M\nsage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same\n\nsage: M.is_subset(U.union(V).union(W))                                                         \nFalse\n```\n\n#31764 adds support for arbitrary unions. But the main issue here is  the failing associativity of the union. \n\nWe fix it as follows.\n\nWhen creating a union, we update the open covers of the supersets of the members, replacing the union members by the union.\n\n\n\n**CC:**  @egourgoulhon @tscrim\n\n**Keywords:** sets, union\n\n**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)\n\n**Commit:** [743f11446a96c32cde3873ebe0a907cdbd0c305b](https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b)\n\n**Author:** Matthias Koeppe\n\n**Status:** new\n\n**Dependencies:** #31764\n\nIssue created by migration from https://trac.sagemath.org/ticket/30263\n\n",
    "created_at": "2020-08-01T07:11:42Z",
    "labels": [
        "component: manifolds",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "declare_union yields wrong results",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30263",
    "user": "https://github.com/mjungmath"
}
```
(for the visualization of the posets, use #31680 and install the `dot2tex` package - without that package, the layout is quite misleading)

```
sage: M = Manifold(3, 'M')
sage: U = M.open_subset('U'); V = M.open_subset('V'); W = M.open_subset('W')
sage: M.declare_union(U, V, W)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-c7f527dcc1ea> in <module>()
----> 1 M.declare_union(U, V, W)

TypeError: declare_union() takes 3 positional arguments but 4 were given

sage: def label(element): 
....:     try: 
....:         return element._name 
....:     except AttributeError: 
....:         return '[' + ', '.join(sorted(x._name for x in element)) + ']' 

sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})

sage: M.declare_union(U, V.union(W))
sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})

sage: U.union(V).union(W)
Open subset U_union_V_union_W of the 3-dimensional differentiable manifold M
sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})

sage: U.union(V.union(W))
3-dimensional differentiable manifold M
sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same

sage: M.is_subset(U.union(V).union(W))                                                         
False
```

#31764 adds support for arbitrary unions. But the main issue here is  the failing associativity of the union. 

We fix it as follows.

When creating a union, we update the open covers of the supersets of the members, replacing the union members by the union.



**CC:**  @egourgoulhon @tscrim

**Keywords:** sets, union

**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)

**Commit:** [743f11446a96c32cde3873ebe0a907cdbd0c305b](https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b)

**Author:** Matthias Koeppe

**Status:** new

**Dependencies:** #31764

Issue created by migration from https://trac.sagemath.org/ticket/30263





---

archive/issue_events_088239.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88239"
}
```



---

archive/issue_comments_596275.json:
```json
{
    "body": "<a id='comment:2'></a>\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-04-07T19:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596275",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_088240.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88240"
}
```



---

archive/issue_events_088241.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88241"
}
```



---

archive/issue_comments_596276.json:
```json
{
    "body": "<a id='comment:3'></a>\nUnions of several subsets also appear in another form - as open covers (which are merely lists of subsets and not manifold subsets in their own right). One might ask whether this could be unified as well.",
    "created_at": "2021-04-18T17:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596276",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Unions of several subsets also appear in another form - as open covers (which are merely lists of subsets and not manifold subsets in their own right). One might ask whether this could be unified as well.



---

archive/issue_comments_596277.json:
```json
{
    "body": "**Dependencies:** #31680",
    "created_at": "2021-04-21T19:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596277",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #31680



---

archive/issue_comments_596278.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,11 +9,26 @@\n ----> 1 M.declare_union(U, V, W)\n \n TypeError: declare_union() takes 3 positional arguments but 4 were given\n+\n+sage: def label(element): \n+....:     try: \n+....:         return element._name \n+....:     except AttributeError: \n+....:         return '[' + ', '.join(sorted(x._name for x in element)) + ']' \n+\n+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n+\n sage: M.declare_union(U, V.union(W))\n+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n+\n sage: U.union(V).union(W)\n Open subset U_union_V_union_W of the 3-dimensional differentiable manifold M\n+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})\n+\n sage: U.union(V.union(W))\n 3-dimensional differentiable manifold M\n+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same\n+\n ```\n \n I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.\n``````\n",
    "created_at": "2021-04-21T19:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596278",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,11 +9,26 @@
 ----> 1 M.declare_union(U, V, W)
 
 TypeError: declare_union() takes 3 positional arguments but 4 were given
+
+sage: def label(element): 
+....:     try: 
+....:         return element._name 
+....:     except AttributeError: 
+....:         return '[' + ', '.join(sorted(x._name for x in element)) + ']' 
+
+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})
+
 sage: M.declare_union(U, V.union(W))
+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})
+
 sage: U.union(V).union(W)
 Open subset U_union_V_union_W of the 3-dimensional differentiable manifold M
+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})
+
 sage: U.union(V.union(W))
 3-dimensional differentiable manifold M
+sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same
+
 ```
 
 I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.
``````




---

archive/issue_comments_596279.json:
```json
{
    "body": "<a id='comment:5'></a>\nAn issue with the existing code is that through a sequence of `declare_union` calls, it is possible to obtain a situation in which two subsets must be the same, although `declare_union` makes a (not very effective) attempt to stop the user from doing so (by checking whether the two arguments are the same).\n\nIn terms of the poset of subsets that is defined by the `_subsets` (and `_supersets`) attributes (which is visualized by the code from #31680), this is quite problematic. \n\nThis could be solved by introducing equivalence classes of subsets - for example by keeping the `_subsets` relation acyclic and introducing an `_equal_sets` attribute; loops that update subsets will have to be modified.\nThe elements of the poset introduced in #31680 then would be equivalence classes of subsets rather than subsets.",
    "created_at": "2021-04-21T19:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596279",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
An issue with the existing code is that through a sequence of `declare_union` calls, it is possible to obtain a situation in which two subsets must be the same, although `declare_union` makes a (not very effective) attempt to stop the user from doing so (by checking whether the two arguments are the same).

In terms of the poset of subsets that is defined by the `_subsets` (and `_supersets`) attributes (which is visualized by the code from #31680), this is quite problematic. 

This could be solved by introducing equivalence classes of subsets - for example by keeping the `_subsets` relation acyclic and introducing an `_equal_sets` attribute; loops that update subsets will have to be modified.
The elements of the poset introduced in #31680 then would be equivalence classes of subsets rather than subsets.



---

archive/issue_comments_596280.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n+(for the visualization of the posets, use #31680 and install the `dot2tex` package - without that package, the layout is quite misleading)\n \n ```\n sage: M = Manifold(3, 'M')\n@@ -29,6 +30,8 @@\n 3-dimensional differentiable manifold M\n sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same\n \n+sage: M.is_subset(U.union(V).union(W))                                                         \n+False\n ```\n \n I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.\n``````\n",
    "created_at": "2021-04-21T19:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596280",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
+(for the visualization of the posets, use #31680 and install the `dot2tex` package - without that package, the layout is quite misleading)
 
 ```
 sage: M = Manifold(3, 'M')
@@ -29,6 +30,8 @@
 3-dimensional differentiable manifold M
 sage: P = M.subset_poset(open_covers=True); P.plot(element_labels={element: label(element) for element in P})  # same
 
+sage: M.is_subset(U.union(V).union(W))                                                         
+False
 ```
 
 I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.
``````




---

archive/issue_comments_596281.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -34,4 +34,14 @@\n False\n ```\n \n-I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.\n+In this ticket, we extend `declare_union` as follows:\n+- support more than two arguments \n+- support 0 arguments (alias: `declare_empty()`) - a subset is empty if it has an empty open cover\n+- support 1 argument (alias: `declare_equal(other)`)\n+\n+We also introduce\n+- `declare_disjoint(other)` - same as `self.intersection(other).declare_empty()`\n+- `declare_disjoint_union(*sets)`\n+\n+Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.\n+\n``````\n",
    "created_at": "2021-04-23T15:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596281",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -34,4 +34,14 @@
 False
 ```
 
-I propose to allow more than two arguments for `declare_union`. Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.
+In this ticket, we extend `declare_union` as follows:
+- support more than two arguments 
+- support 0 arguments (alias: `declare_empty()`) - a subset is empty if it has an empty open cover
+- support 1 argument (alias: `declare_equal(other)`)
+
+We also introduce
+- `declare_disjoint(other)` - same as `self.intersection(other).declare_empty()`
+- `declare_disjoint_union(*sets)`
+
+Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.
+
``````




---

archive/issue_comments_596282.json:
```json
{
    "body": "**Changing dependencies** from \"#31680\" to \"#31680, #31718\".",
    "created_at": "2021-04-23T23:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596282",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31680" to "#31680, #31718".



---

archive/issue_comments_596283.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)",
    "created_at": "2021-04-24T02:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596283",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)



---

archive/issue_comments_596284.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0959889a79f531474f8fe7a12ebe749db3c2957\">f095988</a></td><td><code>FiniteManifoldObjectFamily.__bool__: Remove, inherited from superclass after #31717</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d87ceef7ea74cd88701eb3a3eb728d6a994bd43\">5d87cee</a></td><td><code>Manifold{Object,Subset}FiniteFamily: Rename from FiniteManifold{Object,Subset}Family</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f2ace2e9e9b0580d2b6d93eaa98d14bbc966f77\">2f2ace2</a></td><td><code>src/doc/en/reference/manifolds/manifold.rst: Add sage.manifolds.family</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1aff58a70849386432f336b5bba37e9545eed6eb\">1aff58a</a></td><td><code>Fix up docstring markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b922066d150a4bdc6e6ee9d52924a7d49f039946\">b922066</a></td><td><code>ManifoldSubsetFiniteFamily: If all subsets are open, include 'open' in repr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30271af51d78e4796f1be8b221088ceb2a71b2fa\">30271af</a></td><td><code>Fixup doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adac07acd0af399defe7819f0dc9f4cea8e1b27e\">adac07a</a></td><td><code>Merge #31680</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78cc27a8e439c542c2f03958e8e0888b0551a979\">78cc27a</a></td><td><code>ManifoldSubset.open_covers: Change to generator, add optional arg 'trivial'; update uses</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e026e7a68095577277de1b32df0f8c446b594aa7\">e026e7a</a></td><td><code>ManifoldSubset.subset_digraph: Use open_covers method</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483\">fca7e89</a></td><td><code>ManifoldSubset.declare_empty etc.</code></td></tr></table>\n",
    "created_at": "2021-04-24T02:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596284",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0959889a79f531474f8fe7a12ebe749db3c2957">f095988</a></td><td><code>FiniteManifoldObjectFamily.__bool__: Remove, inherited from superclass after #31717</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d87ceef7ea74cd88701eb3a3eb728d6a994bd43">5d87cee</a></td><td><code>Manifold{Object,Subset}FiniteFamily: Rename from FiniteManifold{Object,Subset}Family</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f2ace2e9e9b0580d2b6d93eaa98d14bbc966f77">2f2ace2</a></td><td><code>src/doc/en/reference/manifolds/manifold.rst: Add sage.manifolds.family</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1aff58a70849386432f336b5bba37e9545eed6eb">1aff58a</a></td><td><code>Fix up docstring markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b922066d150a4bdc6e6ee9d52924a7d49f039946">b922066</a></td><td><code>ManifoldSubsetFiniteFamily: If all subsets are open, include 'open' in repr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30271af51d78e4796f1be8b221088ceb2a71b2fa">30271af</a></td><td><code>Fixup doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adac07acd0af399defe7819f0dc9f4cea8e1b27e">adac07a</a></td><td><code>Merge #31680</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78cc27a8e439c542c2f03958e8e0888b0551a979">78cc27a</a></td><td><code>ManifoldSubset.open_covers: Change to generator, add optional arg 'trivial'; update uses</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e026e7a68095577277de1b32df0f8c446b594aa7">e026e7a</a></td><td><code>ManifoldSubset.subset_digraph: Use open_covers method</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483">fca7e89</a></td><td><code>ManifoldSubset.declare_empty etc.</code></td></tr></table>




---

archive/issue_comments_596285.json:
```json
{
    "body": "**Commit:** [fca7e8988f5fb5175750252e9b71efea0cf9e483](https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483)",
    "created_at": "2021-04-24T02:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596285",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [fca7e8988f5fb5175750252e9b71efea0cf9e483](https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483)



---

archive/issue_comments_596286.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-04-24T02:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596286",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_596287.json:
```json
{
    "body": "**Changing commit** from \"[fca7e8988f5fb5175750252e9b71efea0cf9e483](https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483)\" to \"[26401dd40fb6f24ac1a7a3b5945e3c312c0e002d](https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d)\".",
    "created_at": "2021-04-24T20:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fca7e8988f5fb5175750252e9b71efea0cf9e483](https://github.com/sagemath/sagetrac-mirror/commit/fca7e8988f5fb5175750252e9b71efea0cf9e483)" to "[26401dd40fb6f24ac1a7a3b5945e3c312c0e002d](https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d)".



---

archive/issue_comments_596288.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/215c3785383a48d545e0815c4f4ec42ba7d5ae4d\">215c378</a></td><td><code>ManifoldSubset.subset_{digraph,poset}: Add plots in documentation, remove # not tested</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84896c4d1ec02b22bed05d2f5dd188d71ee0767d\">84896c4</a></td><td><code>ManifoldSubsetFiniteFamily: Use full error message in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3364468cfb725f5a6f26230beafc08461c9d3bbf\">3364468</a></td><td><code>Merge #31680</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c8374eaf1d0422f3572adfffe9a4cda7d6fec0a\">6c8374e</a></td><td><code>ManifoldSubset.open_covers: Add option supersets; use it to fix is_empty</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28650bc4c02d66a4b935d916a937527783500efe\">28650bc</a></td><td><code>Fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d\">26401dd</a></td><td><code>ManifoldSubset.declare_empty: Add plot</code></td></tr></table>\n",
    "created_at": "2021-04-24T20:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596288",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/215c3785383a48d545e0815c4f4ec42ba7d5ae4d">215c378</a></td><td><code>ManifoldSubset.subset_{digraph,poset}: Add plots in documentation, remove # not tested</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84896c4d1ec02b22bed05d2f5dd188d71ee0767d">84896c4</a></td><td><code>ManifoldSubsetFiniteFamily: Use full error message in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3364468cfb725f5a6f26230beafc08461c9d3bbf">3364468</a></td><td><code>Merge #31680</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c8374eaf1d0422f3572adfffe9a4cda7d6fec0a">6c8374e</a></td><td><code>ManifoldSubset.open_covers: Add option supersets; use it to fix is_empty</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28650bc4c02d66a4b935d916a937527783500efe">28650bc</a></td><td><code>Fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d">26401dd</a></td><td><code>ManifoldSubset.declare_empty: Add plot</code></td></tr></table>




---

archive/issue_comments_596289.json:
```json
{
    "body": "**Changing commit** from \"[26401dd40fb6f24ac1a7a3b5945e3c312c0e002d](https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d)\" to \"[ba512023a38e6aa972d1f796bb27a1d9bd9512bf](https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf)\".",
    "created_at": "2021-04-24T21:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596289",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[26401dd40fb6f24ac1a7a3b5945e3c312c0e002d](https://github.com/sagemath/sagetrac-mirror/commit/26401dd40fb6f24ac1a7a3b5945e3c312c0e002d)" to "[ba512023a38e6aa972d1f796bb27a1d9bd9512bf](https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf)".



---

archive/issue_comments_596290.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fee8b991e81e06d04712cfa90245da81b9991964\">fee8b99</a></td><td><code>ManifoldSubsetFiniteFamily.from_subsets_or_families: New constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf\">ba51202</a></td><td><code>ManifoldSubset.declare_union: Add option 'disjoint'</code></td></tr></table>\n",
    "created_at": "2021-04-24T21:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596290",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fee8b991e81e06d04712cfa90245da81b9991964">fee8b99</a></td><td><code>ManifoldSubsetFiniteFamily.from_subsets_or_families: New constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf">ba51202</a></td><td><code>ManifoldSubset.declare_union: Add option 'disjoint'</code></td></tr></table>




---

archive/issue_comments_596291.json:
```json
{
    "body": "**Changing commit** from \"[ba512023a38e6aa972d1f796bb27a1d9bd9512bf](https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf)\" to \"[4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc](https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc)\".",
    "created_at": "2021-04-25T00:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ba512023a38e6aa972d1f796bb27a1d9bd9512bf](https://github.com/sagemath/sagetrac-mirror/commit/ba512023a38e6aa972d1f796bb27a1d9bd9512bf)" to "[4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc](https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc)".



---

archive/issue_comments_596292.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ca80d296d57d8e56a8cf23b8ce3243faa418826\">9ca80d2</a></td><td><code>ManifoldSubset.{equal_subsets,supersets,superset_family}: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55d2aa8013875d18027b6535a38873fd55eeaebf\">55d2aa8</a></td><td><code>ManifoldSubset.{subset,superset}_digraph: New option quotient; use it for {subset,superset}_poset</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc\">4cf4a52</a></td><td><code>ManifoldSubset.declare_equal: New; use it for 1-arg ManifoldSubset.declare_union</code></td></tr></table>\n",
    "created_at": "2021-04-25T00:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ca80d296d57d8e56a8cf23b8ce3243faa418826">9ca80d2</a></td><td><code>ManifoldSubset.{equal_subsets,supersets,superset_family}: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55d2aa8013875d18027b6535a38873fd55eeaebf">55d2aa8</a></td><td><code>ManifoldSubset.{subset,superset}_digraph: New option quotient; use it for {subset,superset}_poset</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc">4cf4a52</a></td><td><code>ManifoldSubset.declare_equal: New; use it for 1-arg ManifoldSubset.declare_union</code></td></tr></table>




---

archive/issue_comments_596293.json:
```json
{
    "body": "**Changing commit** from \"[4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc](https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc)\" to \"[55a28ce3b93c44619614c85d3cb1c324d0e68a7b](https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b)\".",
    "created_at": "2021-04-25T06:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596293",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc](https://github.com/sagemath/sagetrac-mirror/commit/4cf4a52e5e6b063489e18317b9dbfcfbe3b7c4bc)" to "[55a28ce3b93c44619614c85d3cb1c324d0e68a7b](https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b)".



---

archive/issue_comments_596294.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f037ff2f590b9e7af36996cacd7a5622dc5bab3\">0f037ff</a></td><td><code>ManifoldSubset.intersection: Handle arbitrary intersections</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c75d18f711b1450120ec5a303ddc9966a253fd8\">9c75d18</a></td><td><code>intersection: Refactor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d63c32055b34275530184b39432188eddc5c20d\">8d63c32</a></td><td><code>ManifoldSubset.intersection: Only pass name, latex_name to the final intersection</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0867b0cb3e8583627b8072c02a1e283c5c37a004\">0867b0c</a></td><td><code>ManifoldSubset.intersection: Go through ManifoldSubsetFiniteFamily to make the order of operations canonical</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de5f92887466cce9c9f086abc2a42e075a4c2bf1\">de5f928</a></td><td><code>ManifoldSubset._union_subset: Factor out from ManifoldSubset.union</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4698da13a21992b36083e898203a0bf5017b05e0\">4698da1</a></td><td><code>ManifoldSubset.union: Handle arbitrary unions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51a89d08c5f61320644930db5fad7eda58891155\">51a89d0</a></td><td><code>ManifoldSubset.union: Add example and plots</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b\">55a28ce</a></td><td><code>ManifoldSubset.declare_union: Handle arbitrary unions</code></td></tr></table>\n",
    "created_at": "2021-04-25T06:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f037ff2f590b9e7af36996cacd7a5622dc5bab3">0f037ff</a></td><td><code>ManifoldSubset.intersection: Handle arbitrary intersections</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c75d18f711b1450120ec5a303ddc9966a253fd8">9c75d18</a></td><td><code>intersection: Refactor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d63c32055b34275530184b39432188eddc5c20d">8d63c32</a></td><td><code>ManifoldSubset.intersection: Only pass name, latex_name to the final intersection</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0867b0cb3e8583627b8072c02a1e283c5c37a004">0867b0c</a></td><td><code>ManifoldSubset.intersection: Go through ManifoldSubsetFiniteFamily to make the order of operations canonical</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de5f92887466cce9c9f086abc2a42e075a4c2bf1">de5f928</a></td><td><code>ManifoldSubset._union_subset: Factor out from ManifoldSubset.union</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4698da13a21992b36083e898203a0bf5017b05e0">4698da1</a></td><td><code>ManifoldSubset.union: Handle arbitrary unions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51a89d08c5f61320644930db5fad7eda58891155">51a89d0</a></td><td><code>ManifoldSubset.union: Add example and plots</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b">55a28ce</a></td><td><code>ManifoldSubset.declare_union: Handle arbitrary unions</code></td></tr></table>




---

archive/issue_comments_596295.json:
```json
{
    "body": "**Work_Issues:** rebase on #31732, #31727",
    "created_at": "2021-04-26T19:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596295",
    "user": "https://github.com/mkoeppe"
}
```

**Work_Issues:** rebase on #31732, #31727



---

archive/issue_comments_596296.json:
```json
{
    "body": "**Changing work_issues** from \"rebase on #31732, #31727\" to \"rebase on #31732, #31727, #31736\".",
    "created_at": "2021-04-27T01:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596296",
    "user": "https://github.com/mkoeppe"
}
```

**Changing work_issues** from "rebase on #31732, #31727" to "rebase on #31732, #31727, #31736".



---

archive/issue_comments_596297.json:
```json
{
    "body": "**Changing work_issues** from \"rebase on #31732, #31727, #31736\" to \"\".",
    "created_at": "2021-05-02T23:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596297",
    "user": "https://github.com/mkoeppe"
}
```

**Changing work_issues** from "rebase on #31732, #31727, #31736" to "".



---

archive/issue_comments_596298.json:
```json
{
    "body": "**Changing commit** from \"[55a28ce3b93c44619614c85d3cb1c324d0e68a7b](https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b)\" to \"\".",
    "created_at": "2021-05-02T23:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596298",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[55a28ce3b93c44619614c85d3cb1c324d0e68a7b](https://github.com/sagemath/sagetrac-mirror/commit/55a28ce3b93c44619614c85d3cb1c324d0e68a7b)" to "".



---

archive/issue_comments_596299.json:
```json
{
    "body": "**Changing dependencies** from \"#31680, #31718\" to \"#31764\".",
    "created_at": "2021-05-02T23:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596299",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31680, #31718" to "#31764".



---

archive/issue_comments_596300.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)\" to \"\".",
    "created_at": "2021-05-02T23:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596300",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)" to "".



---

archive/issue_comments_596301.json:
```json
{
    "body": "**Changing author** from \"Matthias Koeppe\" to \"\".",
    "created_at": "2021-05-02T23:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596301",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Matthias Koeppe" to "".



---

archive/issue_comments_596302.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -34,14 +34,5 @@\n False\n ```\n \n-In this ticket, we extend `declare_union` as follows:\n-- support more than two arguments \n-- support 0 arguments (alias: `declare_empty()`) - a subset is empty if it has an empty open cover\n-- support 1 argument (alias: `declare_equal(other)`)\n+#31764 adds support for arbitrary unions. But whether this is used or not, something is wrong with the commutativity of the union. This should be investigated, too.\n \n-We also introduce\n-- `declare_disjoint(other)` - same as `self.intersection(other).declare_empty()`\n-- `declare_disjoint_union(*sets)`\n-\n-Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.\n-\n``````\n",
    "created_at": "2021-05-02T23:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596302",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -34,14 +34,5 @@
 False
 ```
 
-In this ticket, we extend `declare_union` as follows:
-- support more than two arguments 
-- support 0 arguments (alias: `declare_empty()`) - a subset is empty if it has an empty open cover
-- support 1 argument (alias: `declare_equal(other)`)
+#31764 adds support for arbitrary unions. But whether this is used or not, something is wrong with the commutativity of the union. This should be investigated, too.
 
-We also introduce
-- `declare_disjoint(other)` - same as `self.intersection(other).declare_empty()`
-- `declare_disjoint_union(*sets)`
-
-Furthermore, something went wrong with the commutativity of the union. This should be investigated, too.
-
``````




---

archive/issue_comments_596303.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -34,5 +34,10 @@\n False\n ```\n \n-#31764 adds support for arbitrary unions. But whether this is used or not, something is wrong with the commutativity of the union. This should be investigated, too.\n+#31764 adds support for arbitrary unions. But the main issue here is  the failing associativity of the union. \n \n+We fix it as follows.\n+\n+When creating a union, we update the open covers of its subsets, replacing the union members by the union.\n+\n+\n``````\n",
    "created_at": "2021-05-02T23:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596303",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -34,5 +34,10 @@
 False
 ```
 
-#31764 adds support for arbitrary unions. But whether this is used or not, something is wrong with the commutativity of the union. This should be investigated, too.
+#31764 adds support for arbitrary unions. But the main issue here is  the failing associativity of the union. 
 
+We fix it as follows.
+
+When creating a union, we update the open covers of its subsets, replacing the union members by the union.
+
+
``````




---

archive/issue_comments_596304.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)",
    "created_at": "2021-05-03T05:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596304",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/declare_union_yields_wrong_results](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/declare_union_yields_wrong_results)



---

archive/issue_comments_596305.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0032bf9f08bc66e13c17358e360b98b1c2674bbc\">0032bf9</a></td><td><code>ManifoldSubset.intersection: Go through ManifoldSubsetFiniteFamily to make the order of operations canonical</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/282010b434abc9468fd52519049ed54eadb222f0\">282010b</a></td><td><code>ManifoldSubset._union_subset: Factor out from ManifoldSubset.union</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6772570996c36fd531558422d1709aa38854a503\">6772570</a></td><td><code>ManifoldSubset.union: Handle arbitrary unions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edfea33c61a84addb189436807439b1fc0f7b32c\">edfea33</a></td><td><code>ManifoldSubset.union: Add example and plots</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdd0aba9ef75cc0c0fc07757b59c98ab272ca030\">fdd0aba</a></td><td><code>ManifoldSubset.declare_union: Handle arbitrary unions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2f484c87cc890540b6b9b882bfd433bf292e730\">c2f484c</a></td><td><code>src/sage/manifolds/subset.py: import itertools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a08356971af378cabec7cd5a51be8e597ea77a67\">a083569</a></td><td><code>ManifoldSubset._intersection_subset, _union_subset: Use declare_subset, declare_superset; fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d41b469856d9e90829c802372b33d0ee3aff9d4\">5d41b46</a></td><td><code>Merge #31764</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aceb0e8553ee51f1ed429126f8872ac7cb5d09e4\">aceb0e8</a></td><td><code>ManifoldSubset._union_subset: Do cache store the union here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b\">743f114</a></td><td><code>ManifoldSubset._union_subset: Update open covers</code></td></tr></table>\n",
    "created_at": "2021-05-03T05:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596305",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0032bf9f08bc66e13c17358e360b98b1c2674bbc">0032bf9</a></td><td><code>ManifoldSubset.intersection: Go through ManifoldSubsetFiniteFamily to make the order of operations canonical</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/282010b434abc9468fd52519049ed54eadb222f0">282010b</a></td><td><code>ManifoldSubset._union_subset: Factor out from ManifoldSubset.union</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6772570996c36fd531558422d1709aa38854a503">6772570</a></td><td><code>ManifoldSubset.union: Handle arbitrary unions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edfea33c61a84addb189436807439b1fc0f7b32c">edfea33</a></td><td><code>ManifoldSubset.union: Add example and plots</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdd0aba9ef75cc0c0fc07757b59c98ab272ca030">fdd0aba</a></td><td><code>ManifoldSubset.declare_union: Handle arbitrary unions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2f484c87cc890540b6b9b882bfd433bf292e730">c2f484c</a></td><td><code>src/sage/manifolds/subset.py: import itertools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a08356971af378cabec7cd5a51be8e597ea77a67">a083569</a></td><td><code>ManifoldSubset._intersection_subset, _union_subset: Use declare_subset, declare_superset; fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d41b469856d9e90829c802372b33d0ee3aff9d4">5d41b46</a></td><td><code>Merge #31764</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aceb0e8553ee51f1ed429126f8872ac7cb5d09e4">aceb0e8</a></td><td><code>ManifoldSubset._union_subset: Do cache store the union here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b">743f114</a></td><td><code>ManifoldSubset._union_subset: Update open covers</code></td></tr></table>




---

archive/issue_comments_596306.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-05-03T05:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596306",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_596307.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -38,6 +38,6 @@\n \n We fix it as follows.\n \n-When creating a union, we update the open covers of its subsets, replacing the union members by the union.\n+When creating a union, we update the open covers of the supersets of the members, replacing the union members by the union.\n \n \n``````\n",
    "created_at": "2021-05-03T05:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596307",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -38,6 +38,6 @@
 
 We fix it as follows.
 
-When creating a union, we update the open covers of its subsets, replacing the union members by the union.
+When creating a union, we update the open covers of the supersets of the members, replacing the union members by the union.
 
 
``````




---

archive/issue_comments_596308.json:
```json
{
    "body": "**Commit:** [743f11446a96c32cde3873ebe0a907cdbd0c305b](https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b)",
    "created_at": "2021-05-03T05:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30263#issuecomment-596308",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [743f11446a96c32cde3873ebe0a907cdbd0c305b](https://github.com/sagemath/sagetrac-mirror/commit/743f11446a96c32cde3873ebe0a907cdbd0c305b)



---

archive/issue_events_088242.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88242"
}
```



---

archive/issue_events_088243.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88243"
}
```



---

archive/issue_events_088244.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88244"
}
```



---

archive/issue_events_088245.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88245"
}
```



---

archive/issue_events_088246.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T01:55:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88246"
}
```



---

archive/issue_events_088247.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T01:55:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88247"
}
```



---

archive/issue_events_088248.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88248"
}
```



---

archive/issue_events_088249.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30263",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30263#event-88249"
}
```
