# Issue 30094: Basis-dependent isomorphism from FiniteRankFreeModule to an object in the category ModulesWithBasis

archive/issues_029857.json:
```json
{
    "assignees": [],
    "body": "(This ticket has been narrowed to the topic mainly discussed in the comments. The topic originally in title and ticket description has been moved to #30174)\n\nThere are multiple incompatible protocols for dealing with bases of a free module in Sage (#19346).\n\nOne such protocol is defined by the category `ModulesWithBasis`. `CombinatorialFreeModule` is one of the parent classes in this category.\n\nAnother such protocol is defined by the parent class `FiniteRankFreeModule`, which is in the category `Modules`.\nA `FiniteRankFreeModule` can be equipped with a finite list of bases (each represented by an instance of `FreeModuleBasis`), none of which are considered distinguished. `FiniteRankFreeModule`s are unique parents; the operation of equipping a `FiniteRankFreeModule`  does not change the identity of the parent.\n\nWe define a method `FiniteRankFreeModule. isomorphism_with_fixed_basis` that establishes, given a basis, an isomorphism with a `CombinatorialFreeModule` (and thus a parent in the category `ModulesWithBasis`.\n\n\n\nDepends on #30180\n\nCC:  @egourgoulhon @tscrim @mjungmath\n\nBranch/Commit: **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**\n\nReviewer: **Michael Jung, Matthias Koeppe, Eric Gourgoulhon, Travis Scrimshaw**\n\nAuthor: **Matthias Koeppe, Michael Jung**\n\nComponent: **categories**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30094_\n\n",
    "closed_at": "2020-08-02T08:20:38Z",
    "created_at": "2020-07-08T20:40:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20categories",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Basis-dependent isomorphism from FiniteRankFreeModule to an object in the category ModulesWithBasis",
    "type": "issue",
    "updated_at": "2020-08-02T08:20:38Z",
    "url": "https://github.com/sagemath/sage/issues/30094",
    "user": "https://github.com/mkoeppe"
}
```
(This ticket has been narrowed to the topic mainly discussed in the comments. The topic originally in title and ticket description has been moved to #30174)

There are multiple incompatible protocols for dealing with bases of a free module in Sage (#19346).

One such protocol is defined by the category `ModulesWithBasis`. `CombinatorialFreeModule` is one of the parent classes in this category.

Another such protocol is defined by the parent class `FiniteRankFreeModule`, which is in the category `Modules`.
A `FiniteRankFreeModule` can be equipped with a finite list of bases (each represented by an instance of `FreeModuleBasis`), none of which are considered distinguished. `FiniteRankFreeModule`s are unique parents; the operation of equipping a `FiniteRankFreeModule`  does not change the identity of the parent.

We define a method `FiniteRankFreeModule. isomorphism_with_fixed_basis` that establishes, given a basis, an isomorphism with a `CombinatorialFreeModule` (and thus a parent in the category `ModulesWithBasis`.



Depends on #30180

CC:  @egourgoulhon @tscrim @mjungmath

Branch/Commit: **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**

Reviewer: **Michael Jung, Matthias Koeppe, Eric Gourgoulhon, Travis Scrimshaw**

Author: **Matthias Koeppe, Michael Jung**

Component: **categories**

_Issue created by migration from https://trac.sagemath.org/ticket/30094_





---

archive/issue_events_414397.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T20:40:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414397"
}
```



---

archive/issue_events_414398.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T20:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414398"
}
```



---

archive/issue_events_414399.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T20:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414399"
}
```



---

archive/issue_events_414400.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T20:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414400"
}
```



---

archive/issue_comments_476506.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,7 @@\n ```\n sage: Q3 = FiniteRankFreeModule(QQ, 3)\n sage: Q3 in Modules(QQ)\n+True\n sage: Modules(QQ)(Q3)\n TypeError: 'FiniteRankFreeModule_with_category' object has no attribute 'vector_space'\n unable to coerce x (=3-dimensional vector space over the Rational Field) into Category of vector spaces over Rational Field\n``````\n",
    "created_at": "2020-07-08T20:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476506",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,7 @@
 ```
 sage: Q3 = FiniteRankFreeModule(QQ, 3)
 sage: Q3 in Modules(QQ)
+True
 sage: Modules(QQ)(Q3)
 TypeError: 'FiniteRankFreeModule_with_category' object has no attribute 'vector_space'
 unable to coerce x (=3-dimensional vector space over the Rational Field) into Category of vector spaces over Rational Field
``````




---

archive/issue_comments_476507.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAlso it seems various maps are missing.\n\n```\nsage: Q3.has_coerce_map_from(QQ^3)\nFalse\nsage: Q3((QQ^3).an_element())\nValueError: the None has not been defined on the 3-dimensional vector space over the Rational Field\n```",
    "created_at": "2020-07-10T18:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476507",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Also it seems various maps are missing.

```
sage: Q3.has_coerce_map_from(QQ^3)
False
sage: Q3((QQ^3).an_element())
ValueError: the None has not been defined on the 3-dimensional vector space over the Rational Field
```



---

archive/issue_comments_476508.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThese are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.\n\nMy 2 cents for the error reported in the ticket is to first check that the object is not in the category. The other option is to lift the `vector_space` method up to the category of modules and then implement a `change_ring` method for `Q3`.",
    "created_at": "2020-07-17T02:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476508",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.

My 2 cents for the error reported in the ticket is to first check that the object is not in the category. The other option is to lift the `vector_space` method up to the category of modules and then implement a `change_ring` method for `Q3`.



---

archive/issue_comments_476509.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@tscrim](#comment:4):\n> These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.\n\nShouldn't there be a map in one direction that forgets the distinguished basis?",
    "created_at": "2020-07-17T02:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476509",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@tscrim](#comment:4):
> These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.

Shouldn't there be a map in one direction that forgets the distinguished basis?



---

archive/issue_comments_476510.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@mkoeppe](#comment:5):\n> Replying to [@tscrim](#comment:4):\n> > These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.\n\n> \n> Shouldn't there be a map in one direction that forgets the distinguished basis?\n\nNo, because where would you send the point `(1,3,1)` to? How would you know how it is expressed in one of the bases of `Q3`?",
    "created_at": "2020-07-17T02:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476510",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@mkoeppe](#comment:5):
> Replying to [@tscrim](#comment:4):
> > These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.

> 
> Shouldn't there be a map in one direction that forgets the distinguished basis?

No, because where would you send the point `(1,3,1)` to? How would you know how it is expressed in one of the bases of `Q3`?



---

archive/issue_comments_476511.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOk, I feel we had this discussion before",
    "created_at": "2020-07-17T18:10:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476511",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Ok, I feel we had this discussion before



---

archive/issue_comments_476512.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nShould `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?",
    "created_at": "2020-07-17T18:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476512",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?



---

archive/issue_comments_476513.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mkoeppe](#comment:8):\n> Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\nNo, I don't think it should. The identity map (like any other automorphism) is a basis independent object.",
    "created_at": "2020-07-17T18:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476513",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mkoeppe](#comment:8):
> Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

No, I don't think it should. The identity map (like any other automorphism) is a basis independent object.



---

archive/issue_comments_476514.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mjungmath](#comment:9):\n> Replying to [@mkoeppe](#comment:8):\n> > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\n> \n> No, I don't think it should. The identity map (like any other automorphism) is a basis independent object.\n\nI might even go further to say that it would not be the identity map, but an isomorphism of free modules. We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. So there is no identity map from `V -> W` because I am not looking at `End(V)`, but `Mor(V, W)`. Yes, they are isomorphic, but there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.",
    "created_at": "2020-07-17T23:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476514",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mjungmath](#comment:9):
> Replying to [@mkoeppe](#comment:8):
> > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

> 
> No, I don't think it should. The identity map (like any other automorphism) is a basis independent object.

I might even go further to say that it would not be the identity map, but an isomorphism of free modules. We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. So there is no identity map from `V -> W` because I am not looking at `End(V)`, but `Mor(V, W)`. Yes, they are isomorphic, but there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.



---

archive/issue_comments_476515.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@tscrim](#comment:10):\n> Replying to [@mjungmath](#comment:9):\n> > Replying to [@mkoeppe](#comment:8):\n> > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\n> > \n> > No, I don't think it should. The identity map (like any other automorphism) is a basis independent object.\n\n> \n> I might even go further to say that it would not be the identity map, but an isomorphism of free modules. \n\nOf course, that's what I meant.",
    "created_at": "2020-07-17T23:50:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476515",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@tscrim](#comment:10):
> Replying to [@mjungmath](#comment:9):
> > Replying to [@mkoeppe](#comment:8):
> > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

> > 
> > No, I don't think it should. The identity map (like any other automorphism) is a basis independent object.

> 
> I might even go further to say that it would not be the identity map, but an isomorphism of free modules. 

Of course, that's what I meant.



---

archive/issue_comments_476516.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@tscrim](#comment:10):\n> > Replying to [@mkoeppe](#comment:8):\n> > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\n> > \n\n> We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. \n> ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.\n\nIn my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis.",
    "created_at": "2020-07-17T23:56:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476516",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@tscrim](#comment:10):
> > Replying to [@mkoeppe](#comment:8):
> > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

> > 

> We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. 
> ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.

In my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis.



---

archive/issue_comments_476517.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@mkoeppe](#comment:12):\n> Replying to [@tscrim](#comment:10):\n> > > Replying to [@mkoeppe](#comment:8):\n> > > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\n> > > \n\n> > We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. \n> > ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.\n\n> \n> In my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis. \n\nYou were asking for a map from `self.free_module()`, which is the free module without a distinguished basis. If you want to go from a `FreeModuleBasis`, then that might be a good method as there is a canonical isomorphism of the homspace with the endspace and an identity map. Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.",
    "created_at": "2020-07-18T00:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476517",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@mkoeppe](#comment:12):
> Replying to [@tscrim](#comment:10):
> > > Replying to [@mkoeppe](#comment:8):
> > > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

> > > 

> > We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. 
> > ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.

> 
> In my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis. 

You were asking for a map from `self.free_module()`, which is the free module without a distinguished basis. If you want to go from a `FreeModuleBasis`, then that might be a good method as there is a canonical isomorphism of the homspace with the endspace and an identity map. Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.



---

archive/issue_comments_476518.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@tscrim](#comment:13):\n> Replying to [@mkoeppe](#comment:12):\n> > Replying to [@tscrim](#comment:10):\n> > > > Replying to [@mkoeppe](#comment:8):\n> > > > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?\n\n> > > > \n\n> > > We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. \n> > > ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.\n\n> > \n> > In my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis. \n\n> \n> You were asking for a map from `self.free_module()`, which is the free module without a distinguished basis. If you want to go from a `FreeModuleBasis`, then that might be a good method as there is a canonical isomorphism of the homspace with the endspace and an identity map. Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.\n\nI of course agree that one may implement a method in `FreeModuleBasis` that returns an isomorphism between `Q3` and `QQ^3`, but for which purpose? Such an isomorphism cannot be used for a coercion since a coercion must be unique and cannot depend on a extra parameter such as a\nbasis-dependent isomorphism.\n\nComing back to the issue mentioned in the ticket title and description, I would say that the problem arises because \"vector spaces\" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.",
    "created_at": "2020-07-18T14:11:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476518",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@tscrim](#comment:13):
> Replying to [@mkoeppe](#comment:12):
> > Replying to [@tscrim](#comment:10):
> > > > Replying to [@mkoeppe](#comment:8):
> > > > > Should `FreeModuleBasis` get a method that creates the identity map from `self.free_module()` to a free module with that basis?

> > > > 

> > > We have to be careful about distinguishing things up to equality and up to isomorphism. For example, if I have `V = span_R{x,y,z}`, this is not equal to `W = R^3`. 
> > > ... there is no canonical isomorphism until I choose a distinguished basis for `V` and `W`.

> > 
> > In my question above, this would be a method of `FreeModuleBasis` - so there is a particular basis. And `RR^3` also has a distinguished basis. 

> 
> You were asking for a map from `self.free_module()`, which is the free module without a distinguished basis. If you want to go from a `FreeModuleBasis`, then that might be a good method as there is a canonical isomorphism of the homspace with the endspace and an identity map. Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.

I of course agree that one may implement a method in `FreeModuleBasis` that returns an isomorphism between `Q3` and `QQ^3`, but for which purpose? Such an isomorphism cannot be used for a coercion since a coercion must be unique and cannot depend on a extra parameter such as a
basis-dependent isomorphism.

Coming back to the issue mentioned in the ticket title and description, I would say that the problem arises because "vector spaces" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.



---

archive/issue_comments_476519.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@egourgoulhon](#comment:14):\n> Coming back to the issue mentioned in the ticket title and description, I would say that the problem arises because \"vector spaces\" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.    \n\nOK, I think we are getting closer. \n\nWhen you say, '\"vector spaces\" as they are implemented in Sage', I assume you mean the ones implemented in `sage.modules.free_module` and constructed by the function `VectorSpace`, and then I agree with what you wrote.\n\nWhat I was asking for in comment 8 is, given a basis, a map from a `FiniteRankFreeModule` (which is in the category of finite dimensional modules) to a parent that is in the category of finite dimensional modules with basis.",
    "created_at": "2020-07-18T16:34:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476519",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@egourgoulhon](#comment:14):
> Coming back to the issue mentioned in the ticket title and description, I would say that the problem arises because "vector spaces" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.    

OK, I think we are getting closer. 

When you say, '"vector spaces" as they are implemented in Sage', I assume you mean the ones implemented in `sage.modules.free_module` and constructed by the function `VectorSpace`, and then I agree with what you wrote.

What I was asking for in comment 8 is, given a basis, a map from a `FiniteRankFreeModule` (which is in the category of finite dimensional modules) to a parent that is in the category of finite dimensional modules with basis.



---

archive/issue_comments_476520.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@tscrim](#comment:10):\n> I might even go further to say that it would not be the identity map, but an isomorphism of free modules.\n\nWell, yes. It is a special kind of automorphism. However, I wouldn't see it as an isomorphism between any two free modules of the same rank, in case this is what you are referring to.\n\nReplying to [@tscrim](#comment:13):\n> Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.\n\nI am not sure what you mean with \"the span of the basis elements\". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).",
    "created_at": "2020-07-18T19:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476520",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@tscrim](#comment:10):
> I might even go further to say that it would not be the identity map, but an isomorphism of free modules.

Well, yes. It is a special kind of automorphism. However, I wouldn't see it as an isomorphism between any two free modules of the same rank, in case this is what you are referring to.

Replying to [@tscrim](#comment:13):
> Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.

I am not sure what you mean with "the span of the basis elements". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).



---

archive/issue_comments_476521.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment:4):\n> These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.\n\nAgreed.\n\n> My 2 cents for the error reported in the ticket is to first check that the object is not in the category. The other option is to lift the `vector_space` method up to the category of modules and then implement a `change_ring` method for `Q3`.\n\nSounds good. Who goes for it?",
    "created_at": "2020-07-18T20:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476521",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment:4):
> These are incompatible objects since `QQ^3` has a distinguished basis (the standard Euclidean basis) whereas `Q3` does not. So there should not be a map between them.

Agreed.

> My 2 cents for the error reported in the ticket is to first check that the object is not in the category. The other option is to lift the `vector_space` method up to the category of modules and then implement a `change_ring` method for `Q3`.

Sounds good. Who goes for it?



---

archive/issue_comments_476522.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mkoeppe](#comment:15):\n> Replying to [@egourgoulhon](#comment:14):\n> > Coming back to the issue mentioned in the ticket title and description, I would say that the problem arises because \"vector spaces\" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.    \n\n> \n> OK, I think we are getting closer. \n> \n> When you say, '\"vector spaces\" as they are implemented in Sage', I assume you mean the ones implemented in `sage.modules.free_module` and constructed by the function `VectorSpace`, \n\nYes.\n>and then I agree with what you wrote.\n>\n>What I was asking for in comment 8 is, given a basis, a map from a `FiniteRankFreeModule` (which is in the category of finite dimensional modules) to a parent that is in the category of finite dimensional modules with basis.\n> \n\nYes, this is the basis-dependent isomorphism I was referring to [comment:14](#comment:14), but my concern, and that of Travis if I understand correctly, is that such an isomorphism cannot be used for a coercion, because it is not canonical (by definition, it depends on a choice of basis).",
    "created_at": "2020-07-18T22:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476522",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mkoeppe](#comment:15):
> Replying to [@egourgoulhon](#comment:14):
> > Coming back to the issue mentioned in the ticket title and description, I would say that the problem arises because "vector spaces" as they are implemented in Sage are not really vector spaces in all their generality but only Cartesian powers `F^n`, where `F` is the base field.    

> 
> OK, I think we are getting closer. 
> 
> When you say, '"vector spaces" as they are implemented in Sage', I assume you mean the ones implemented in `sage.modules.free_module` and constructed by the function `VectorSpace`, 

Yes.
>and then I agree with what you wrote.
>
>What I was asking for in comment 8 is, given a basis, a map from a `FiniteRankFreeModule` (which is in the category of finite dimensional modules) to a parent that is in the category of finite dimensional modules with basis.
> 

Yes, this is the basis-dependent isomorphism I was referring to [comment:14](#comment:14), but my concern, and that of Travis if I understand correctly, is that such an isomorphism cannot be used for a coercion, because it is not canonical (by definition, it depends on a choice of basis).



---

archive/issue_comments_476523.json:
```json
{
    "body": "Branch: **[u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field)**",
    "created_at": "2020-07-18T22:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476523",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field)**



---

archive/issue_comments_476524.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@egourgoulhon](#comment:18):\n> Yes, this is the basis-dependent isomorphism I was referring to [comment:14](#comment:14), but my concern, and that of Travis if I understand correctly, is that such an isomorphism cannot be used for a coercion, because it is not canonical (by definition, it depends on a choice of basis). \n\nI've pushed a rough implementation of this to the ticket.\n\nSure, I don't need this to be a coercion. Just a module morphism.\n\n\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb\"><code>91e44f4</code></a></td><td><code>sage.tensor.modules.FiniteRankFreeModule.basis_fixing_map: New</code></td></tr></table>\n",
    "created_at": "2020-07-18T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476524",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@egourgoulhon](#comment:18):
> Yes, this is the basis-dependent isomorphism I was referring to [comment:14](#comment:14), but my concern, and that of Travis if I understand correctly, is that such an isomorphism cannot be used for a coercion, because it is not canonical (by definition, it depends on a choice of basis). 

I've pushed a rough implementation of this to the ticket.

Sure, I don't need this to be a coercion. Just a module morphism.



---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb"><code>91e44f4</code></a></td><td><code>sage.tensor.modules.FiniteRankFreeModule.basis_fixing_map: New</code></td></tr></table>




---

archive/issue_comments_476525.json:
```json
{
    "body": "Commit: **[`91e44f4`](https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb)**",
    "created_at": "2020-07-18T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476525",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`91e44f4`](https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb)**



---

archive/issue_comments_476526.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@mjungmath](#comment:16):\n> Replying to [@tscrim](#comment:13):\n> > Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.\n\n> \n> I am not sure what you mean with \"the span of the basis elements\". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).\n\nThe question is what does this class represent:\n\n1. The basis itself, which is a finite set.\n2. The span of the basis elements, which is a vector space where we can represent the points in terms of the chosen basis elements.\n\nThese are very different objects. One is finite, one is infinite (well, |R|<sup>n</sup>, where R is the base ring). Since you want to think of it as 1, then you are saying there should not be a morphism. However, most of the points of the free module should not be elements of this parent. The actual implementation is really treating it like 2, and its elements are the points of the free module represented using the chosen basis.\n\n---\n\nI like the proposed method overall. I have some suggestions:\n\n1 - Change the name to something like `morphism_with_fixed_basis` as right now it sounds like it is constructing a map that happens to fix a basis.\n2 - Allow the codomain of the map to be passed to the function. Then you can have the map be defined as\n\n```python\n        if codomain.dimension() != self.dimension():\n            raise ValueError\n        B = list(codomain.basis())\n        def function(x):\n            return codomain.sum(x[basis, i] * B[i] for i in self.irange())\n```\nThis should be implementation independent (if it is not, then it is a bug IMO).",
    "created_at": "2020-07-18T23:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476526",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@mjungmath](#comment:16):
> Replying to [@tscrim](#comment:13):
> > Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.

> 
> I am not sure what you mean with "the span of the basis elements". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).

The question is what does this class represent:

1. The basis itself, which is a finite set.
2. The span of the basis elements, which is a vector space where we can represent the points in terms of the chosen basis elements.

These are very different objects. One is finite, one is infinite (well, |R|<sup>n</sup>, where R is the base ring). Since you want to think of it as 1, then you are saying there should not be a morphism. However, most of the points of the free module should not be elements of this parent. The actual implementation is really treating it like 2, and its elements are the points of the free module represented using the chosen basis.

---

I like the proposed method overall. I have some suggestions:

1 - Change the name to something like `morphism_with_fixed_basis` as right now it sounds like it is constructing a map that happens to fix a basis.
2 - Allow the codomain of the map to be passed to the function. Then you can have the map be defined as

```python
        if codomain.dimension() != self.dimension():
            raise ValueError
        B = list(codomain.basis())
        def function(x):
            return codomain.sum(x[basis, i] * B[i] for i in self.irange())
```
This should be implementation independent (if it is not, then it is a bug IMO).



---

archive/issue_comments_476527.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@tscrim](#comment:21):\n> Replying to [@mjungmath](#comment:16):\n> > Replying to [@tscrim](#comment:13):\n> > > Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.\n\n> > \n> > I am not sure what you mean with \"the span of the basis elements\". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).\n\n> \n> The question is what does this class represent:\n> \n> 1. The basis itself, which is a finite set.\n> 2. The span of the basis elements, which is a vector space where we can represent the points in terms of the chosen basis elements.\n\nI think it's clear that 1 is intended:\n\n```\nsage: V = FiniteRankFreeModule(QQ, 3)\nsage: e = V.basis(\"e\")\nsage: e[0] in e\nTrue\nsage: e[1] in e\nTrue\nsage: e[0] + e[1] in e\nFalse",
    "created_at": "2020-07-19T00:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476527",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@tscrim](#comment:21):
> Replying to [@mjungmath](#comment:16):
> > Replying to [@tscrim](#comment:13):
> > > Although I am not sure how much the basis is intended as a basis as a set or the span of the basis elements. I suspect the former, so such a method would not make sense. I would have to see what Eric and Michal say.

> > 
> > I am not sure what you mean with "the span of the basis elements". This does not make any sense to me because the span is always the free module again. Anyway, I would see an instance of `FreeModuleBasis` as a representation of a (finite) subset of the corresponding free module which is linearly independent and generates the module (possibly in the sense of formal linear combinations).

> 
> The question is what does this class represent:
> 
> 1. The basis itself, which is a finite set.
> 2. The span of the basis elements, which is a vector space where we can represent the points in terms of the chosen basis elements.

I think it's clear that 1 is intended:

```
sage: V = FiniteRankFreeModule(QQ, 3)
sage: e = V.basis("e")
sage: e[0] in e
True
sage: e[1] in e
True
sage: e[0] + e[1] in e
False



---

archive/issue_comments_476528.json:
```json
{
    "body": "Changed commit from **[`91e44f4`](https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb)** to **[`7366741`](https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419)**",
    "created_at": "2020-07-19T00:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476528",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`91e44f4`](https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb)** to **[`7366741`](https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419)**



---

archive/issue_comments_476529.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419\"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr></table>\n",
    "created_at": "2020-07-19T00:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476529",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr></table>




---

archive/issue_comments_476530.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAh, right. Yes, it is clear that it is 1. I got myself confused.",
    "created_at": "2020-07-19T01:34:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476530",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">comment:24</div>

Ah, right. Yes, it is clear that it is 1. I got myself confused.



---

archive/issue_comments_476531.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@sagetrac-git](#comment:23):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419\"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr></table>\n\nI must agree Eric in [comment:14](#comment:14), I don't see the use of such a method `isomorphism_with_fixed_basis`, not even in `FiniteRankFreeModule`.\n\nI see no problem in implementing the coercion on the level of modules right away. There is no need for such method either in this case. The vector space `QQ^3` forgets about the basis we have chosen, anyway (i.e. there is no going back). The important thing is that we are able to choose a basis. But this is ensured due to the definition of a free module.\n\nI have to admit, I am not sure what's the problem is we're still discussing; apart from the error reported in the description. Is it still all about [comment:2](#comment:2)? As reported in this ticket, we want to coerce the free modules themselves and not their elements.",
    "created_at": "2020-07-19T08:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476531",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@sagetrac-git](#comment:23):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr></table>

I must agree Eric in [comment:14](#comment:14), I don't see the use of such a method `isomorphism_with_fixed_basis`, not even in `FiniteRankFreeModule`.

I see no problem in implementing the coercion on the level of modules right away. There is no need for such method either in this case. The vector space `QQ^3` forgets about the basis we have chosen, anyway (i.e. there is no going back). The important thing is that we are able to choose a basis. But this is ensured due to the definition of a free module.

I have to admit, I am not sure what's the problem is we're still discussing; apart from the error reported in the description. Is it still all about [comment:2](#comment:2)? As reported in this ticket, we want to coerce the free modules themselves and not their elements.



---

archive/issue_comments_476532.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@mjungmath](#comment:25):\n> I have to admit, I am not sure what's the problem is we're still discussing\n\nThanks. I will split the ticket into two and clarify the descriptions.",
    "created_at": "2020-07-19T14:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476532",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@mjungmath](#comment:25):
> I have to admit, I am not sure what's the problem is we're still discussing

Thanks. I will split the ticket into two and clarify the descriptions.



---

archive/issue_comments_476533.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,17 +1,12 @@\n+(This ticket has been narrowed to the topic mainly discussed in the comments. The topic originally in title and ticket description has been moved to #30174)\n \n-```\n-sage: Q3 = FiniteRankFreeModule(QQ, 3)\n-sage: Q3 in Modules(QQ)\n-True\n-sage: Modules(QQ)(Q3)\n-TypeError: 'FiniteRankFreeModule_with_category' object has no attribute 'vector_space'\n-unable to coerce x (=3-dimensional vector space over the Rational Field) into Category of vector spaces over Rational Field\n-```\n+There are multiple incompatible protocols for dealing with bases of a free module in Sage (#19346).\n \n-Compare with:\n+One such protocol is defined by the category `ModulesWithBasis`. `CombinatorialFreeModule` is one of the parent classes in this category.\n \n-```\n-sage: Modules(QQ)(QQ^3)\n-Vector space of dimension 3 over Rational Field\n-```\n+Another such protocol is defined by the parent class `FiniteRankFreeModule`, which is in the category `Modules`.\n+A `FiniteRankFreeModule` can be equipped with a finite list of bases (each represented by an instance of `FreeModuleBasis`), none of which are considered distinguished. `FiniteRankFreeModule`s are unique parents; the operation of equipping a `FiniteRankFreeModule`  does not change the identity of the parent.\n \n+We define a method `FiniteRankFreeModule. isomorphism_with_fixed_basis` that establishes, given a basis, an isomorphism with a `CombinatorialFreeModule` (and thus a parent in the category `ModulesWithBasis`.\n+\n+\n``````\n",
    "created_at": "2020-07-19T14:33:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476533",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,17 +1,12 @@
+(This ticket has been narrowed to the topic mainly discussed in the comments. The topic originally in title and ticket description has been moved to #30174)
 
-```
-sage: Q3 = FiniteRankFreeModule(QQ, 3)
-sage: Q3 in Modules(QQ)
-True
-sage: Modules(QQ)(Q3)
-TypeError: 'FiniteRankFreeModule_with_category' object has no attribute 'vector_space'
-unable to coerce x (=3-dimensional vector space over the Rational Field) into Category of vector spaces over Rational Field
-```
+There are multiple incompatible protocols for dealing with bases of a free module in Sage (#19346).
 
-Compare with:
+One such protocol is defined by the category `ModulesWithBasis`. `CombinatorialFreeModule` is one of the parent classes in this category.
 
-```
-sage: Modules(QQ)(QQ^3)
-Vector space of dimension 3 over Rational Field
-```
+Another such protocol is defined by the parent class `FiniteRankFreeModule`, which is in the category `Modules`.
+A `FiniteRankFreeModule` can be equipped with a finite list of bases (each represented by an instance of `FreeModuleBasis`), none of which are considered distinguished. `FiniteRankFreeModule`s are unique parents; the operation of equipping a `FiniteRankFreeModule`  does not change the identity of the parent.
 
+We define a method `FiniteRankFreeModule. isomorphism_with_fixed_basis` that establishes, given a basis, an isomorphism with a `CombinatorialFreeModule` (and thus a parent in the category `ModulesWithBasis`.
+
+
``````




---

archive/issue_events_414401.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-19T14:33:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "title_is": "Basis-dependent isomorphism from FiniteRankFreeModule to an object in the category ModulesWithBasis",
    "title_was": "unable to coerce x (=3-dimensional vector space over the Rational Field) into Category of vector spaces over Rational Field",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414401"
}
```



---

archive/issue_comments_476534.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThe topic originally on the ticket description is now in #30174.\nI hope this helps.",
    "created_at": "2020-07-19T14:35:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476534",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

The topic originally on the ticket description is now in #30174.
I hope this helps.



---

archive/issue_comments_476535.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nLooking at the code, I begin to like the idea, too. :)\n\nIt's still a draft, however I'd like to propose an improvement regarding the docstring:\n\n```diff\n         Construct the canonical isomorphism from the free module ``self``\n-        to a free module in which ``basis`` of ``self`` is the distinguished basis.\n+        to a free module in which ``basis`` of ``self`` is mapped to the\n+        distinguished basis of ``codomain``.\n```\n\nI think it would also be good to specify input and output in the docstring. In particular, the input `codomain` should be described as an element of `ModulesWithBasis` having the same rank as `self` and over the same base ring. Furthermore, it should be explained that `CombinatorialFreeModule` is chosen by default if the input is `None`.",
    "created_at": "2020-07-19T15:52:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476535",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:29" align="right">comment:29</div>

Looking at the code, I begin to like the idea, too. :)

It's still a draft, however I'd like to propose an improvement regarding the docstring:

```diff
         Construct the canonical isomorphism from the free module ``self``
-        to a free module in which ``basis`` of ``self`` is the distinguished basis.
+        to a free module in which ``basis`` of ``self`` is mapped to the
+        distinguished basis of ``codomain``.
```

I think it would also be good to specify input and output in the docstring. In particular, the input `codomain` should be described as an element of `ModulesWithBasis` having the same rank as `self` and over the same base ring. Furthermore, it should be explained that `CombinatorialFreeModule` is chosen by default if the input is `None`.



---

archive/issue_comments_476536.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAnd probably we should raise an error in case both base rings are not equal.",
    "created_at": "2020-07-19T15:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476536",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:30" align="right">comment:30</div>

And probably we should raise an error in case both base rings are not equal.



---

archive/issue_comments_476537.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThanks for the suggestions, sounds all good. I don't have time to work on it today. Please feel free to commit changes to the branch",
    "created_at": "2020-07-19T16:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476537",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Thanks for the suggestions, sounds all good. I don't have time to work on it today. Please feel free to commit changes to the branch



---

archive/issue_comments_476538.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field)** to **[public/tensor/basis_dependent_isomorphism_free_modules](https://github.com/sagemath/sagetrac-mirror/tree/public/tensor/basis_dependent_isomorphism_free_modules)**",
    "created_at": "2020-07-19T19:15:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476538",
    "user": "https://github.com/mjungmath"
}
```

Changed branch from **[u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/unable_to_coerce_x___3_dimensional_vector_space_over_the_rational_field__into_category_of_vector_spaces_over_rational_field)** to **[public/tensor/basis_dependent_isomorphism_free_modules](https://github.com/sagemath/sagetrac-mirror/tree/public/tensor/basis_dependent_isomorphism_free_modules)**



---

archive/issue_comments_476539.json:
```json
{
    "body": "Changed commit from **[`7366741`](https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419)** to none",
    "created_at": "2020-07-19T19:15:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476539",
    "user": "https://github.com/mjungmath"
}
```

Changed commit from **[`7366741`](https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419)** to none



---

archive/issue_comments_476540.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb\"><code>91e44f4</code></a></td><td><code>sage.tensor.modules.FiniteRankFreeModule.basis_fixing_map: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419\"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8\"><code>81e0ec0</code></a></td><td><code>Trac #30094: docstring improved + raise error for different base rings</code></td></tr></table>\n",
    "created_at": "2020-07-19T19:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476540",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91e44f4479bfb30663873faa7de0467e542daebb"><code>91e44f4</code></a></td><td><code>sage.tensor.modules.FiniteRankFreeModule.basis_fixing_map: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73667410fb02014b789a49ef58e9846ecc729419"><code>7366741</code></a></td><td><code>Rename, generalize</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8"><code>81e0ec0</code></a></td><td><code>Trac #30094: docstring improved + raise error for different base rings</code></td></tr></table>




---

archive/issue_comments_476541.json:
```json
{
    "body": "Commit: **[`81e0ec0`](https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8)**",
    "created_at": "2020-07-19T19:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476541",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`81e0ec0`](https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8)**



---

archive/issue_comments_476542.json:
```json
{
    "body": "Changed commit from **[`81e0ec0`](https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8)** to **[`bdc6e2c`](https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752)**",
    "created_at": "2020-07-19T20:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476542",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`81e0ec0`](https://github.com/sagemath/sagetrac-mirror/commit/81e0ec0c1902a55269214f81e2cce130253b0de8)** to **[`bdc6e2c`](https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752)**



---

archive/issue_comments_476543.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752\"><code>bdc6e2c</code></a></td><td><code>Trac #30094: minor improvements in docstring</code></td></tr></table>\n",
    "created_at": "2020-07-19T20:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476543",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752"><code>bdc6e2c</code></a></td><td><code>Trac #30094: minor improvements in docstring</code></td></tr></table>




---

archive/issue_comments_476544.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThanks for the code! I think this should be changed:\n\n```diff\n-            return codomain.sum(x[basis, i] * codomain_basis[i]\n-                                for i in self.irange())\n+            return codomain.sum(x[basis, i] * codomain_basis[i - self._sindex]\n+                                for i in self.irange())\n```\nThe doctest \n\n```\nsage: self = V = FiniteRankFreeModule(QQ, 3); V\n```\ncould be changed to\n\n```\nsage: self = V = FiniteRankFreeModule(QQ, 3, start_index=1); V\n```\nto check that everything is OK with index ranges.",
    "created_at": "2020-07-20T12:45:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476544",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:35" align="right">comment:35</div>

Thanks for the code! I think this should be changed:

```diff
-            return codomain.sum(x[basis, i] * codomain_basis[i]
-                                for i in self.irange())
+            return codomain.sum(x[basis, i] * codomain_basis[i - self._sindex]
+                                for i in self.irange())
```
The doctest 

```
sage: self = V = FiniteRankFreeModule(QQ, 3); V
```
could be changed to

```
sage: self = V = FiniteRankFreeModule(QQ, 3, start_index=1); V
```
to check that everything is OK with index ranges.



---

archive/issue_comments_476545.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9\"><code>acaaa7f</code></a></td><td><code>Trac #30094: starting index corrected</code></td></tr></table>\n",
    "created_at": "2020-07-20T13:34:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476545",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9"><code>acaaa7f</code></a></td><td><code>Trac #30094: starting index corrected</code></td></tr></table>




---

archive/issue_comments_476546.json:
```json
{
    "body": "Changed commit from **[`bdc6e2c`](https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752)** to **[`acaaa7f`](https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9)**",
    "created_at": "2020-07-20T13:34:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476546",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bdc6e2c`](https://github.com/sagemath/sagetrac-mirror/commit/bdc6e2c8194911acf4e2a6a021e2f417504b9752)** to **[`acaaa7f`](https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9)**



---

archive/issue_comments_476547.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@egourgoulhon](#comment:35):\n> Thanks for the code! I think this should be changed:\n> \n> ```diff\n> -            return codomain.sum(x[basis, i] * codomain_basis[i]\n> -                                for i in self.irange())\n> +            return codomain.sum(x[basis, i] * codomain_basis[i - self._sindex]\n> +                                for i in self.irange())\n> ```\n> The doctest \n> \n> ```\n> sage: self = V = FiniteRankFreeModule(QQ, 3); V\n> ```\n> could be changed to\n> \n> ```\n> sage: self = V = FiniteRankFreeModule(QQ, 3, start_index=1); V\n> ```\n> to check that everything is OK with index ranges.\n\nVery good objection. I took that into consideration. I think, the ticket is ready for review now. Matthias?",
    "created_at": "2020-07-20T13:36:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476547",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@egourgoulhon](#comment:35):
> Thanks for the code! I think this should be changed:
> 
> ```diff
> -            return codomain.sum(x[basis, i] * codomain_basis[i]
> -                                for i in self.irange())
> +            return codomain.sum(x[basis, i] * codomain_basis[i - self._sindex]
> +                                for i in self.irange())
> ```
> The doctest 
> 
> ```
> sage: self = V = FiniteRankFreeModule(QQ, 3); V
> ```
> could be changed to
> 
> ```
> sage: self = V = FiniteRankFreeModule(QQ, 3, start_index=1); V
> ```
> to check that everything is OK with index ranges.

Very good objection. I took that into consideration. I think, the ticket is ready for review now. Matthias?



---

archive/issue_events_414402.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-20T15:49:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414402"
}
```



---

archive/issue_comments_476548.json:
```json
{
    "body": "Author: **Matthias Koeppe, Michael Jung**",
    "created_at": "2020-07-20T15:49:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476548",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe, Michael Jung**



---

archive/issue_comments_476549.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI'm happy with these changes, thanks very much!",
    "created_at": "2020-07-20T15:50:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476549",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>

I'm happy with these changes, thanks very much!



---

archive/issue_comments_476550.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nOf course, one could ask what the basis of the `CombinatorialFreeModule` should be indexed by.\n\n```\nsage: V = FiniteRankFreeModule(QQ, 3, start_index=1)\nsage: basis = e = V.basis(\"e\")\nsage: phi_e.codomain().basis()\nFinite family {'e_1': B['e_1'], 'e_2': B['e_2'], 'e_3': B['e_3']}\n```\nI think it would be more natural if this family was indexed by `V.irange()`.",
    "created_at": "2020-07-20T18:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476550",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Of course, one could ask what the basis of the `CombinatorialFreeModule` should be indexed by.

```
sage: V = FiniteRankFreeModule(QQ, 3, start_index=1)
sage: basis = e = V.basis("e")
sage: phi_e.codomain().basis()
Finite family {'e_1': B['e_1'], 'e_2': B['e_2'], 'e_3': B['e_3']}
```
I think it would be more natural if this family was indexed by `V.irange()`.



---

archive/issue_comments_476551.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@mkoeppe](#comment:40):\n> Of course, one could ask what the basis of the `CombinatorialFreeModule` should be indexed by.\n> \n> ```\n> sage: V = FiniteRankFreeModule(QQ, 3, start_index=1)\n> sage: basis = e = V.basis(\"e\")\n> sage: phi_e.codomain().basis()\n> Finite family {'e_1': B['e_1'], 'e_2': B['e_2'], 'e_3': B['e_3']}\n> ```\n> I think it would be more natural if this family was indexed by `V.irange()`.\n\nI don't quite get what you want. I have quickly overviewd the documentation of `CombinatorialFreeModule`, and I think that our implementation already carries out the intended behavior.",
    "created_at": "2020-07-20T18:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476551",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@mkoeppe](#comment:40):
> Of course, one could ask what the basis of the `CombinatorialFreeModule` should be indexed by.
> 
> ```
> sage: V = FiniteRankFreeModule(QQ, 3, start_index=1)
> sage: basis = e = V.basis("e")
> sage: phi_e.codomain().basis()
> Finite family {'e_1': B['e_1'], 'e_2': B['e_2'], 'e_3': B['e_3']}
> ```
> I think it would be more natural if this family was indexed by `V.irange()`.

I don't quite get what you want. I have quickly overviewd the documentation of `CombinatorialFreeModule`, and I think that our implementation already carries out the intended behavior.



---

archive/issue_comments_476552.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\n\n```\nsage: phi_e.codomain().basis().keys()\n{'e_1', 'e_2', 'e_3'}\n```\nI think the code should be changed so that\n\n```\nsage: phi_e.codomain().basis().keys()\n{1, 2, 3}\n```",
    "created_at": "2020-07-20T19:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476552",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">comment:42</div>


```
sage: phi_e.codomain().basis().keys()
{'e_1', 'e_2', 'e_3'}
```
I think the code should be changed so that

```
sage: phi_e.codomain().basis().keys()
{1, 2, 3}
```



---

archive/issue_comments_476553.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@mkoeppe](#comment:42):\n> \n> ```\n> sage: phi_e.codomain().basis().keys()\n> {'e_1', 'e_2', 'e_3'}\n> ```\n> I think the code should be changed so that\n> \n> ```\n> sage: phi_e.codomain().basis().keys()\n> {1, 2, 3}\n> ```\n\nAs far as I understand it, the keys correspond to the basis element's name. And I thought that the intention was to name them after the basis we are coming from, wasn't it?\n\nNotice that the names can also differ from the canonical choice, for example `a, b, c`, without labeled indices. In that case, the current implementation is preferrable anyway.",
    "created_at": "2020-07-20T19:38:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476553",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@mkoeppe](#comment:42):
> 
> ```
> sage: phi_e.codomain().basis().keys()
> {'e_1', 'e_2', 'e_3'}
> ```
> I think the code should be changed so that
> 
> ```
> sage: phi_e.codomain().basis().keys()
> {1, 2, 3}
> ```

As far as I understand it, the keys correspond to the basis element's name. And I thought that the intention was to name them after the basis we are coming from, wasn't it?

Notice that the names can also differ from the canonical choice, for example `a, b, c`, without labeled indices. In that case, the current implementation is preferrable anyway.



---

archive/issue_comments_476554.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nAre there methods in `FreeModuleBasis` or `FiniteRankFreeModule` that allow the user to look up a basis element by name?",
    "created_at": "2020-07-20T19:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476554",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

Are there methods in `FreeModuleBasis` or `FiniteRankFreeModule` that allow the user to look up a basis element by name?



---

archive/issue_comments_476555.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI am sorry. I am little off track. You were obiously right:\n\n> `basis_keys` - list, tuple, family, set, etc. defining the indexing set for the basis of this module\n\nWhat you suggest sounds good then.",
    "created_at": "2020-07-20T21:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476555",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:45" align="right">comment:45</div>

I am sorry. I am little off track. You were obiously right:

> `basis_keys` - list, tuple, family, set, etc. defining the indexing set for the basis of this module

What you suggest sounds good then.



---

archive/issue_comments_476556.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd\"><code>81fa95d</code></a></td><td><code>Trac #30094: indexing improved</code></td></tr></table>\n",
    "created_at": "2020-07-20T21:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476556",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd"><code>81fa95d</code></a></td><td><code>Trac #30094: indexing improved</code></td></tr></table>




---

archive/issue_comments_476557.json:
```json
{
    "body": "Changed commit from **[`acaaa7f`](https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9)** to **[`81fa95d`](https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd)**",
    "created_at": "2020-07-20T21:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476557",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`acaaa7f`](https://github.com/sagemath/sagetrac-mirror/commit/acaaa7fbb60c891ba80ecf504430a7c68c99dad9)** to **[`81fa95d`](https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd)**



---

archive/issue_comments_476558.json:
```json
{
    "body": "Changed commit from **[`81fa95d`](https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd)** to **[`5657108`](https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400)**",
    "created_at": "2020-07-20T21:50:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476558",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`81fa95d`](https://github.com/sagemath/sagetrac-mirror/commit/81fa95dd8abee38ce70b57d35f1aa3c8667c7ffd)** to **[`5657108`](https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400)**



---

archive/issue_comments_476559.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400\"><code>5657108</code></a></td><td><code>Add an example with a provided codomain</code></td></tr></table>\n",
    "created_at": "2020-07-20T21:50:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476559",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400"><code>5657108</code></a></td><td><code>Add an example with a provided codomain</code></td></tr></table>




---

archive/issue_comments_476560.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nPerhaps the prefix \"B\" should be changed to `basis._symbol`",
    "created_at": "2020-07-20T21:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476560",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">comment:48</div>

Perhaps the prefix "B" should be changed to `basis._symbol`



---

archive/issue_comments_476561.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880\"><code>40f589f</code></a></td><td><code>Use basis._symbol as prefix instead of B</code></td></tr></table>\n",
    "created_at": "2020-07-21T00:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476561",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880"><code>40f589f</code></a></td><td><code>Use basis._symbol as prefix instead of B</code></td></tr></table>




---

archive/issue_comments_476562.json:
```json
{
    "body": "Changed commit from **[`5657108`](https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400)** to **[`40f589f`](https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880)**",
    "created_at": "2020-07-21T00:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5657108`](https://github.com/sagemath/sagetrac-mirror/commit/5657108b4d0ea40f08e79de42e1a7675dd2f2400)** to **[`40f589f`](https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880)**



---

archive/issue_comments_476563.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@sagetrac-git](#comment:49):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880\"><code>40f589f</code></a></td><td><code>Use basis._symbol as prefix instead of B</code></td></tr></table>\n\nReplying to [@mkoeppe](#comment:48):\n> Perhaps the prefix \"B\" should be changed to `basis._symbol`\n\n\nThis won't work:\n\n```\nsage: M = FiniteRankFreeModule(QQ, 3)\nsage: e = M.basis(['a', 'b', 'c'], symbol_dual=['d', 'e', 'f'])\nsage: phi_e = phi_e = M.isomorphism_with_fixed_basis(e)\nsage: phi_e.codomain().basis()\n<repr(<sage.sets.family.FiniteFamily_with_category at 0x7f03d6b8bb88>) failed: TypeError: can only concatenate tuple (not \"str\") to tuple>\n```\n\nSee [comment:43](#comment:43).",
    "created_at": "2020-07-21T07:58:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476563",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@sagetrac-git](#comment:49):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880"><code>40f589f</code></a></td><td><code>Use basis._symbol as prefix instead of B</code></td></tr></table>

Replying to [@mkoeppe](#comment:48):
> Perhaps the prefix "B" should be changed to `basis._symbol`


This won't work:

```
sage: M = FiniteRankFreeModule(QQ, 3)
sage: e = M.basis(['a', 'b', 'c'], symbol_dual=['d', 'e', 'f'])
sage: phi_e = phi_e = M.isomorphism_with_fixed_basis(e)
sage: phi_e.codomain().basis()
<repr(<sage.sets.family.FiniteFamily_with_category at 0x7f03d6b8bb88>) failed: TypeError: can only concatenate tuple (not "str") to tuple>
```

See [comment:43](#comment:43).



---

archive/issue_events_414403.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-21T07:59:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414403"
}
```



---

archive/issue_events_414404.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-07-21T07:59:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414404"
}
```



---

archive/issue_comments_476564.json:
```json
{
    "body": "Changed commit from **[`40f589f`](https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880)** to **[`affd0c9`](https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823)**",
    "created_at": "2020-07-21T14:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476564",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`40f589f`](https://github.com/sagemath/sagetrac-mirror/commit/40f589f9033607bae86eec49b1eeb2d020003880)** to **[`affd0c9`](https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823)**



---

archive/issue_comments_476565.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823\"><code>affd0c9</code></a></td><td><code>Use basis._symbol as prefix only when it is a string</code></td></tr></table>\n",
    "created_at": "2020-07-21T14:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476565",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823"><code>affd0c9</code></a></td><td><code>Use basis._symbol as prefix only when it is a string</code></td></tr></table>




---

archive/issue_comments_476566.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThanks for catching this. Here's a better version",
    "created_at": "2020-07-21T14:48:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476566",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Thanks for catching this. Here's a better version



---

archive/issue_events_414405.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-21T14:48:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414405"
}
```



---

archive/issue_events_414406.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-21T14:48:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414406"
}
```



---

archive/issue_comments_476567.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI don't think the prefix is even necessary, but I can live with that.",
    "created_at": "2020-07-21T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476567",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:54" align="right">comment:54</div>

I don't think the prefix is even necessary, but I can live with that.



---

archive/issue_comments_476568.json:
```json
{
    "body": "Reviewer: **Michael Jung, Matthias Koeppe, ...**",
    "created_at": "2020-07-21T17:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476568",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Michael Jung, Matthias Koeppe, ...**



---

archive/issue_comments_476569.json:
```json
{
    "body": "Changed reviewer from **Michael Jung, Matthias Koeppe, ...** to **Michael Jung, Matthias Koeppe, Eric Gourgoulhon**",
    "created_at": "2020-07-22T09:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476569",
    "user": "https://github.com/egourgoulhon"
}
```

Changed reviewer from **Michael Jung, Matthias Koeppe, ...** to **Michael Jung, Matthias Koeppe, Eric Gourgoulhon**



---

archive/issue_events_414407.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-22T09:14:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414407"
}
```



---

archive/issue_events_414408.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-22T09:14:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414408"
}
```



---

archive/issue_comments_476570.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nLGTM. Thanks!",
    "created_at": "2020-07-22T09:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476570",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:56" align="right">comment:56</div>

LGTM. Thanks!



---

archive/issue_comments_476571.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nShouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency.",
    "created_at": "2020-07-22T09:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476571",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:57" align="right">comment:57</div>

Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency.



---

archive/issue_events_414409.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-22T09:27:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414409"
}
```



---

archive/issue_events_414410.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-22T09:27:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414410"
}
```



---

archive/issue_comments_476572.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@egourgoulhon](#comment:57):\n> Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. \n\nI think, the independence should be the other way around, right Matthias?",
    "created_at": "2020-07-22T09:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476572",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@egourgoulhon](#comment:57):
> Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. 

I think, the independence should be the other way around, right Matthias?



---

archive/issue_comments_476573.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@mjungmath](#comment:58):\n> Replying to [@egourgoulhon](#comment:57):\n> > Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. \n\n> \n> I think, the independence should be the other way around, right Matthias?\n\nNo, if the code in this ticket makes use of #30180's code, the dependency shall be set here to #30180.",
    "created_at": "2020-07-22T14:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476573",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@mjungmath](#comment:58):
> Replying to [@egourgoulhon](#comment:57):
> > Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. 

> 
> I think, the independence should be the other way around, right Matthias?

No, if the code in this ticket makes use of #30180's code, the dependency shall be set here to #30180.



---

archive/issue_comments_476574.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@egourgoulhon](#comment:59):\n> Replying to [@mjungmath](#comment:58):\n> > Replying to [@egourgoulhon](#comment:57):\n> > > Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. \n\n> > \n> > I think, the independence should be the other way around, right Matthias?\n\n> No, if the code in this ticket makes use of #30180's code, the dependency shall be set here to #30180. \n\nThis code works independently of #30180 and I don't see any snippets from #30180 used here.",
    "created_at": "2020-07-22T14:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476574",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@egourgoulhon](#comment:59):
> Replying to [@mjungmath](#comment:58):
> > Replying to [@egourgoulhon](#comment:57):
> > > Shouldn't the code of this ticket use #30180 (cf. comment 1 in that ticket)? Then #30180 should be added as a dependency. 

> > 
> > I think, the independence should be the other way around, right Matthias?

> No, if the code in this ticket makes use of #30180's code, the dependency shall be set here to #30180. 

This code works independently of #30180 and I don't see any snippets from #30180 used here.



---

archive/issue_comments_476575.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nBoth of you are right.",
    "created_at": "2020-07-22T15:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476575",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:61" align="right">comment:61</div>

Both of you are right.



---

archive/issue_comments_476576.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThanks to the speedy review of #30180, I will use it now to simplify the code on the present ticket.",
    "created_at": "2020-07-22T15:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476576",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:62" align="right">comment:62</div>

Thanks to the speedy review of #30180, I will use it now to simplify the code on the present ticket.



---

archive/issue_comments_476577.json:
```json
{
    "body": "Changed commit from **[`affd0c9`](https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823)** to **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**",
    "created_at": "2020-07-22T15:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476577",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`affd0c9`](https://github.com/sagemath/sagetrac-mirror/commit/affd0c974f144ca19f2095f3546130f04b188823)** to **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**



---

archive/issue_comments_476578.json:
```json
{
    "body": "<div id=\"comment:63\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0afa01cfcb1ad3ded5cde7ba2df3dc3231c6a3f8\"><code>0afa01c</code></a></td><td><code>Modules: Add parent method module_morphism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c8d08013740e2f406008f189792b53f3a2efa0f\"><code>3c8d080</code></a></td><td><code>Fix docstring markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2fc5d54c00a65e852cd8cbd9598417f686b3436\"><code>e2fc5d5</code></a></td><td><code>Make sure that we only create a module morphism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68da24ce124483c59e706cc7fd71f97464bae5e6\"><code>68da24c</code></a></td><td><code>Merge branch 't/30180/category_modules_should_provide_a_parent_method_module_morphism_compatible_with_moduleswithbasis_module_morphism' into t/30094/public/tensor/basis_dependent_isomorphism_free_modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e\"><code>8a800cc</code></a></td><td><code>FiniteRankFreeModule.isomorphism_with_fixed_basis: Simplify using self.module_morphism</code></td></tr></table>\n",
    "created_at": "2020-07-22T15:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476578",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:63"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0afa01cfcb1ad3ded5cde7ba2df3dc3231c6a3f8"><code>0afa01c</code></a></td><td><code>Modules: Add parent method module_morphism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c8d08013740e2f406008f189792b53f3a2efa0f"><code>3c8d080</code></a></td><td><code>Fix docstring markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2fc5d54c00a65e852cd8cbd9598417f686b3436"><code>e2fc5d5</code></a></td><td><code>Make sure that we only create a module morphism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68da24ce124483c59e706cc7fd71f97464bae5e6"><code>68da24c</code></a></td><td><code>Merge branch 't/30180/category_modules_should_provide_a_parent_method_module_morphism_compatible_with_moduleswithbasis_module_morphism' into t/30094/public/tensor/basis_dependent_isomorphism_free_modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e"><code>8a800cc</code></a></td><td><code>FiniteRankFreeModule.isomorphism_with_fixed_basis: Simplify using self.module_morphism</code></td></tr></table>




---

archive/issue_comments_476579.json:
```json
{
    "body": "Dependencies: **#30180**",
    "created_at": "2020-07-22T15:40:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476579",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#30180**



---

archive/issue_events_414411.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-22T15:40:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414411"
}
```



---

archive/issue_events_414412.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-22T15:40:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414412"
}
```



---

archive/issue_comments_476580.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nMorally green patchbot.",
    "created_at": "2020-07-24T00:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476580",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:65" align="right">comment:65</div>

Morally green patchbot.



---

archive/issue_events_414413.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-24T08:30:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414413"
}
```



---

archive/issue_events_414414.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-24T08:30:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414414"
}
```



---

archive/issue_comments_476581.json:
```json
{
    "body": "Changed reviewer from **Michael Jung, Matthias Koeppe, Eric Gourgoulhon** to **Michael Jung, Matthias Koeppe, Eric Gourgoulhon, Travis Scrimshaw**",
    "created_at": "2020-07-24T08:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476581",
    "user": "https://github.com/egourgoulhon"
}
```

Changed reviewer from **Michael Jung, Matthias Koeppe, Eric Gourgoulhon** to **Michael Jung, Matthias Koeppe, Eric Gourgoulhon, Travis Scrimshaw**



---

archive/issue_comments_476582.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nThanks for the update!",
    "created_at": "2020-07-24T08:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476582",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:66" align="right">comment:66</div>

Thanks for the update!



---

archive/issue_comments_476583.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThanks!",
    "created_at": "2020-07-24T15:51:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476583",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:67" align="right">comment:67</div>

Thanks!



---

archive/issue_events_414415.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-02T08:20:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414415"
}
```



---

archive/issue_events_414416.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d14a2c5705e054886fd0aaffcc2fe1d107db9dfe",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-02T08:20:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30094#event-414416"
}
```



---

archive/issue_comments_476584.json:
```json
{
    "body": "Changed branch from **[public/tensor/basis_dependent_isomorphism_free_modules](https://github.com/sagemath/sagetrac-mirror/tree/public/tensor/basis_dependent_isomorphism_free_modules)** to **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**",
    "created_at": "2020-08-02T08:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30094#issuecomment-476584",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/tensor/basis_dependent_isomorphism_free_modules](https://github.com/sagemath/sagetrac-mirror/tree/public/tensor/basis_dependent_isomorphism_free_modules)** to **[`8a800cc`](https://github.com/sagemath/sagetrac-mirror/commit/8a800cc0734fe2c0c9e4e201faf5b9435fdab78e)**
