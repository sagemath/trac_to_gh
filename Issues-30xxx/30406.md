# Issue 30406: Allow pull requests from Github

archive/issues_030169.json:
```json
{
    "body": "I've heard that once upon a time there was a bot that created trac issues based on GitHub PRs. Apparently the bot was lost.\n\nI found https://github.com/trac-hacks/trac-github which has the feature to \"update the local git mirror used by Trac after each push to GitHub, and notify the new changesets to Trac;\". Sounds like this is exactly what would be needed to allow PRs from github.\nI couldn't find anything on how to install trac plugins here on sage.\n\nRelated:\n\n- #30363: Migrate to GitHub\n\nCC:  @embray @mkoeppe @robertwb @slel @williamstein\n\nDependencies: #30363\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/30406\n\n",
    "closed_at": "2022-11-14T19:36:43Z",
    "created_at": "2020-08-20T13:53:17Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Allow pull requests from Github",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30406",
    "user": "https://github.com/tobiasdiez"
}
```
I've heard that once upon a time there was a bot that created trac issues based on GitHub PRs. Apparently the bot was lost.

I found https://github.com/trac-hacks/trac-github which has the feature to "update the local git mirror used by Trac after each push to GitHub, and notify the new changesets to Trac;". Sounds like this is exactly what would be needed to allow PRs from github.
I couldn't find anything on how to install trac plugins here on sage.

Related:

- #30363: Migrate to GitHub

CC:  @embray @mkoeppe @robertwb @slel @williamstein

Dependencies: #30363

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/30406





---

archive/issue_comments_429482.json:
```json
{
    "body": "<a id='comment:1'></a>Is this functionality that we want? There are several warnings about how the sage github repo doesn't accept PRs and to instead use trac.",
    "created_at": "2020-08-21T17:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429482",
    "user": "https://github.com/davidlowryduda"
}
```

<a id='comment:1'></a>Is this functionality that we want? There are several warnings about how the sage github repo doesn't accept PRs and to instead use trac.



---

archive/issue_comments_429483.json:
```json
{
    "body": "<a id='comment:2'></a>Ah, only now do I see that this is morally a continuation of the commentary occuring in #30363",
    "created_at": "2020-08-21T17:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429483",
    "user": "https://github.com/davidlowryduda"
}
```

<a id='comment:2'></a>Ah, only now do I see that this is morally a continuation of the commentary occuring in #30363



---

archive/issue_comments_429484.json:
```json
{
    "body": "<a id='comment:3'></a>Thanks for the link, I had forgotten where I read about the lost bot.",
    "created_at": "2020-08-21T17:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429484",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'></a>Thanks for the link, I had forgotten where I read about the lost bot.



---

archive/issue_comments_429485.json:
```json
{
    "body": "<a id='comment:4'></a>We are accepting merge requests through GitLab: https://gitlab.com/sagemath/sage\n\nThe GitHub page should link to that.",
    "created_at": "2020-08-31T14:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429485",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>We are accepting merge requests through GitLab: https://gitlab.com/sagemath/sage

The GitHub page should link to that.



---

archive/issue_events_078846.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78846"
}
```



---

archive/issue_events_078847.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78847"
}
```



---

archive/issue_events_078848.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78848"
}
```



---

archive/issue_comments_429486.json:
```json
{
    "body": "<a id='comment:6'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429486",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_429487.json:
```json
{
    "body": "<a id='comment:7'></a>The bot to turn pull requests to the SageMath repo at GitHub\ninto Trac tickets once existed.\n\nIn a [2014-08 sage-devel discussion](https://groups.google.com/g/sage-devel/c/5d9NfgZJDmw/m/mrchAwmwB-0J), Robert described:\n\n> All pull requests on github turn into tickets, so this easy web\n> interface flow works now.\n\n\nThe bot stopped working around mid 2015.\n\nIn a [2016-07 sage-devel discussion](https://groups.google.com/g/sage-devel/c/wcqMjrCZHHQ/m/jKOygA-sAgAJ), Paul wrote:\n\n> [...] there are a couple pull requests from the middle of 2015 that never became\n> Trac tickets. The bot appears to have stopped creating tickets before then.\n\n>\n> There are open pull requests from the end of 2014 that became part of Sage 6.4.\n> The bot does not appear to close pull requests on [GitHub](GitHub).\n\n\nand Robert wrote:\n\n> I was running a small script on trac.sagemath.org:12000 that was\n> listening for github pull requests and comments (via github webhooks)\n> and publishing them to trac (via the trac scripts shipped with Sage).\n> Nothing too fancy, but I can't find the code for it at the moment (but\n> it's probably still sitting in that image unless it's been redone\n> since then). I don't remember if I ever pushed anything back to github\n> (which would require write access) but pull requests should get closed\n> when their associated changes get merged into master.\n\n\nIn a 2018-02 discussion on the sagemath-admins mailing list, Robert wrote:\n\n> Sorry, I have no idea where the source to that is. However, the whole\n> thing was like 100 lines or so. It just listened for github hooks and\n> posted the information to a new/existing ticket on trac, and vice\n> versa (maybe was invoked via patchbot when something changed, I don't\n> remember how the hooks went the other direction).\n\n>\n> At this point, probably less effort to re-implement than track it\n> down. Huge +1 to tighter github integration; using trac to push\n> changes at the very least is a huge barrier for casual development.\n> (I'm very happy with migrating Cython completely over to Github,\n> modulo I don't keep track of the jenkins server that used to regularly\n> build and test Sage with Cython head).",
    "created_at": "2021-03-27T21:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429487",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>The bot to turn pull requests to the SageMath repo at GitHub
into Trac tickets once existed.

In a [2014-08 sage-devel discussion](https://groups.google.com/g/sage-devel/c/5d9NfgZJDmw/m/mrchAwmwB-0J), Robert described:

> All pull requests on github turn into tickets, so this easy web
> interface flow works now.


The bot stopped working around mid 2015.

In a [2016-07 sage-devel discussion](https://groups.google.com/g/sage-devel/c/wcqMjrCZHHQ/m/jKOygA-sAgAJ), Paul wrote:

> [...] there are a couple pull requests from the middle of 2015 that never became
> Trac tickets. The bot appears to have stopped creating tickets before then.

>
> There are open pull requests from the end of 2014 that became part of Sage 6.4.
> The bot does not appear to close pull requests on [GitHub](GitHub).


and Robert wrote:

> I was running a small script on trac.sagemath.org:12000 that was
> listening for github pull requests and comments (via github webhooks)
> and publishing them to trac (via the trac scripts shipped with Sage).
> Nothing too fancy, but I can't find the code for it at the moment (but
> it's probably still sitting in that image unless it's been redone
> since then). I don't remember if I ever pushed anything back to github
> (which would require write access) but pull requests should get closed
> when their associated changes get merged into master.


In a 2018-02 discussion on the sagemath-admins mailing list, Robert wrote:

> Sorry, I have no idea where the source to that is. However, the whole
> thing was like 100 lines or so. It just listened for github hooks and
> posted the information to a new/existing ticket on trac, and vice
> versa (maybe was invoked via patchbot when something changed, I don't
> remember how the hooks went the other direction).

>
> At this point, probably less effort to re-implement than track it
> down. Huge +1 to tighter github integration; using trac to push
> changes at the very least is a huge barrier for casual development.
> (I'm very happy with migrating Cython completely over to Github,
> modulo I don't keep track of the jenkins server that used to regularly
> build and test Sage with Cython head).



---

archive/issue_comments_429488.json:
```json
{
    "body": "<a id='comment:8'></a>Christopher Swenson pointed me to this:\n\nhttps://github.com/swenson/sage-workflow/blob/master/sagedev/pr_export.py",
    "created_at": "2021-03-27T22:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429488",
    "user": "https://github.com/slel"
}
```

<a id='comment:8'></a>Christopher Swenson pointed me to this:

https://github.com/swenson/sage-workflow/blob/master/sagedev/pr_export.py



---

archive/issue_comments_429489.json:
```json
{
    "body": "<a id='comment:10'></a>If you really want to do this I would recommend looking at the gitlab hook in the Trac plugin (ironically still hosted on GH though I would prefer to move it): https://github.com/sagemath/sage_trac_plugin/blob/master/sage_trac/gitlab.py\n\nMost of this could be refactored to abstract out the [GitLab](GitLab) and [GitHub](GitHub) API differences.  Personally I am not motivated to do it though.",
    "created_at": "2021-03-29T07:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429489",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>If you really want to do this I would recommend looking at the gitlab hook in the Trac plugin (ironically still hosted on GH though I would prefer to move it): https://github.com/sagemath/sage_trac_plugin/blob/master/sage_trac/gitlab.py

Most of this could be refactored to abstract out the [GitLab](GitLab) and [GitHub](GitHub) API differences.  Personally I am not motivated to do it though.



---

archive/issue_events_078849.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2021-03-29T07:48:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78849"
}
```



---

archive/issue_events_078850.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2021-03-29T07:48:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78850"
}
```



---

archive/issue_comments_429490.json:
```json
{
    "body": "<a id='comment:12'></a>Though we migrate to github, trac may function as a secondary issue tracker or at least archiver if this ticket is achieved. Or would we close trac completely after the migration?",
    "created_at": "2022-09-11T03:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429490",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'></a>Though we migrate to github, trac may function as a secondary issue tracker or at least archiver if this ticket is achieved. Or would we close trac completely after the migration?



---

archive/issue_comments_429491.json:
```json
{
    "body": "<a id='comment:13'></a>I would think we would probably keep Trac around in read-only mode for a little while, just so that people can easily see that nothing has been lost in the conversion. But definitely not more than that. Definitely not a converter from GH to Trac.",
    "created_at": "2022-09-11T03:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429491",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>I would think we would probably keep Trac around in read-only mode for a little while, just so that people can easily see that nothing has been lost in the conversion. But definitely not more than that. Definitely not a converter from GH to Trac.



---

archive/issue_events_078851.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:09:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78851"
}
```



---

archive/issue_events_078852.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:09:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78852"
}
```



---

archive/issue_comments_429492.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-11T04:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429492",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_429493.json:
```json
{
    "body": "<a id='comment:15'></a>We would not want to break links to trac somehow.  Eg we could host all of trac.sagemath.org in static readonly mode (e.g via github pages) forever to preserve the links.",
    "created_at": "2022-09-11T05:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429493",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:15'></a>We would not want to break links to trac somehow.  Eg we could host all of trac.sagemath.org in static readonly mode (e.g via github pages) forever to preserve the links.



---

archive/issue_comments_429494.json:
```json
{
    "body": "<a id='comment:16'></a>Or set up http redirects to the Issues? The plan is to map them 1:1",
    "created_at": "2022-09-11T16:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429494",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Or set up http redirects to the Issues? The plan is to map them 1:1



---

archive/issue_comments_429495.json:
```json
{
    "body": "<a id='comment:17'></a>I've added these ideas to #30363, let's take the discussion there.",
    "created_at": "2022-09-11T17:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429495",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>I've added these ideas to #30363, let's take the discussion there.



---

archive/issue_comments_429496.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-15T23:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429496",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_078853.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-11-14T19:36:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30406#event-78853"
}
```



---

archive/issue_comments_429497.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-11-14T19:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30406#issuecomment-429497",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
