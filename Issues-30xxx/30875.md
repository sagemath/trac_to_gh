# Issue 30875: Random elements of AA aren't random

archive/issues_030638.json:
```json
{
    "assignees": [
        "https://github.com/bmlivin"
    ],
    "body": "The `AA.random_element()` method only ever returns integers\namong -2, -1, 0, 1, 2:\n\n```\nsage: ' '.join(str(AA.random_element()) for i in range(100))\n2 0 0 2 1 2 -1 0 -2 -2 -2 0 -2 0 2 -1 1 0 0 1 1 -1 2 -1 0 2 1\n0 0 2 1 2 0 -1 -2 -2 -1 2 -2 1 -1 -2 -2 2 -1 0 1 -1 2 2 0 -2\n-1 -1 1 -2 2 0 2 -2 0 -2 1 -2 0 -2 -2 -2 -1 -2 -1 2 0 0 1 0 0\n-2 0 -1 2 -2 0 -2 2 -1 -1 1 1 -2 -1 0 -2 -2 -1 2 -2 -1 -2 -2\n```\n\nThat's a bit un-random, even by Sage standards.\nA simple improvement would be to return the real part\nof `QQbar.random_element()`:\n\n```\nsage: [QQbar.random_element().real() for i in range(5) ]\n[-5.372281323269015?,\n -0.2000000000000000?,\n 0.50000000000000000?,\n -0.50000000000000000?,\n 0.1906845620110298?]\n```\n\n\nBranch/Commit: **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**\n\nReviewer: **Lorenz Panny**\n\nAuthor: **Ben Livingston, Michael Orlitzky**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30875_\n\n",
    "closed_at": "2022-01-04T22:51:17Z",
    "created_at": "2020-11-08T21:44:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Random elements of AA aren't random",
    "type": "issue",
    "updated_at": "2022-01-04T22:51:17Z",
    "url": "https://github.com/sagemath/sage/issues/30875",
    "user": "https://github.com/orlitzky"
}
```
The `AA.random_element()` method only ever returns integers
among -2, -1, 0, 1, 2:

```
sage: ' '.join(str(AA.random_element()) for i in range(100))
2 0 0 2 1 2 -1 0 -2 -2 -2 0 -2 0 2 -1 1 0 0 1 1 -1 2 -1 0 2 1
0 0 2 1 2 0 -1 -2 -2 -1 2 -2 1 -1 -2 -2 2 -1 0 1 -1 2 2 0 -2
-1 -1 1 -2 2 0 2 -2 0 -2 1 -2 0 -2 -2 -2 -1 -2 -1 2 0 0 1 0 0
-2 0 -1 2 -2 0 -2 2 -1 -1 1 1 -2 -1 0 -2 -2 -1 2 -2 -1 -2 -2
```

That's a bit un-random, even by Sage standards.
A simple improvement would be to return the real part
of `QQbar.random_element()`:

```
sage: [QQbar.random_element().real() for i in range(5) ]
[-5.372281323269015?,
 -0.2000000000000000?,
 0.50000000000000000?,
 -0.50000000000000000?,
 0.1906845620110298?]
```


Branch/Commit: **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**

Reviewer: **Lorenz Panny**

Author: **Ben Livingston, Michael Orlitzky**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/30875_





---

archive/issue_events_427928.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-11-08T21:44:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427928"
}
```



---

archive/issue_events_427929.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-11-08T21:44:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427929"
}
```



---

archive/issue_events_427930.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-11-08T21:44:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427930"
}
```



---

archive/issue_events_427931.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-11-08T21:44:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427931"
}
```



---

archive/issue_comments_494324.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWhat's happening is that the class aliased to `AA`, `sage.rings.qqbar:AlgebraicRealField`, doesn't have a `random_element` method, which is causing its base class's (`sage.rings:Ring`'s) `random_element` to be called. I'm going to look into why this is happening.",
    "created_at": "2020-11-09T04:16:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494324",
    "user": "https://github.com/bmlivin"
}
```

<div id="comment:1" align="right">comment:1</div>

What's happening is that the class aliased to `AA`, `sage.rings.qqbar:AlgebraicRealField`, doesn't have a `random_element` method, which is causing its base class's (`sage.rings:Ring`'s) `random_element` to be called. I'm going to look into why this is happening.



---

archive/issue_events_427932.json:
```json
{
    "actor": "https://github.com/bmlivin",
    "created_at": "2020-11-09T04:16:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "subject": "https://github.com/bmlivin",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427932"
}
```



---

archive/issue_comments_494325.json:
```json
{
    "body": "Branch: **[u/gh-bmlivin/random_elements_of_aa_aren_t_random](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-bmlivin/random_elements_of_aa_aren_t_random)**",
    "created_at": "2020-11-10T19:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494325",
    "user": "https://github.com/bmlivin"
}
```

Branch: **[u/gh-bmlivin/random_elements_of_aa_aren_t_random](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-bmlivin/random_elements_of_aa_aren_t_random)**



---

archive/issue_comments_494326.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2\"><code>4772419</code></a></td><td><code>Added random_element method for sage.rings.qqbar.AlgebraicRealField which returns the real part of sage.rings.qqbar.AlgebraicField::random_element and moved sage.rings.qqbar.AlgebraicField::random_element to its parent class so it can be called by sage.rings.qqbar.AlgebraicRealField</code></td></tr></table>\n",
    "created_at": "2020-11-10T19:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494326",
    "user": "https://github.com/bmlivin"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2"><code>4772419</code></a></td><td><code>Added random_element method for sage.rings.qqbar.AlgebraicRealField which returns the real part of sage.rings.qqbar.AlgebraicField::random_element and moved sage.rings.qqbar.AlgebraicField::random_element to its parent class so it can be called by sage.rings.qqbar.AlgebraicRealField</code></td></tr></table>




---

archive/issue_events_427933.json:
```json
{
    "actor": "https://github.com/bmlivin",
    "created_at": "2020-11-10T19:26:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427933"
}
```



---

archive/issue_comments_494327.json:
```json
{
    "body": "Author: **Ben Livingston**",
    "created_at": "2020-11-10T19:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494327",
    "user": "https://github.com/bmlivin"
}
```

Author: **Ben Livingston**



---

archive/issue_comments_494328.json:
```json
{
    "body": "Commit: **[`4772419`](https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2)**",
    "created_at": "2020-11-10T19:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494328",
    "user": "https://github.com/bmlivin"
}
```

Commit: **[`4772419`](https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2)**



---

archive/issue_comments_494329.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis works, but I'm curious why you wanted to use a superclass method instead of\n\n```python\ndef random_element(self, poly_degree=2, *args, **kwds):\n    r\"\"\"\n    ...\n    \"\"\"\n    return QQbar.random_element(poly_degree, *args, **kwds).real()\n```\n\nEither way works, but your version moves some things into the \"common\" class that aren't common to the two fields (they only work for `QQbar`, and have to be overridden for `AA`). I didn't write these classes, but that seems to go against the design; e.g. nothing else in the \"common\" class is overridden in the subclasses.",
    "created_at": "2020-11-17T14:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494329",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:4" align="right">comment:4</div>

This works, but I'm curious why you wanted to use a superclass method instead of

```python
def random_element(self, poly_degree=2, *args, **kwds):
    r"""
    ...
    """
    return QQbar.random_element(poly_degree, *args, **kwds).real()
```

Either way works, but your version moves some things into the "common" class that aren't common to the two fields (they only work for `QQbar`, and have to be overridden for `AA`). I didn't write these classes, but that seems to go against the design; e.g. nothing else in the "common" class is overridden in the subclasses.



---

archive/issue_comments_494330.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\npatchbot tells you that the added doctest should start with `r\"\"\"`",
    "created_at": "2021-01-18T10:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494330",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

patchbot tells you that the added doctest should start with `r"""`



---

archive/issue_events_427934.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427934"
}
```



---

archive/issue_events_427935.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427935"
}
```



---

archive/issue_comments_494331.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494331",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_427936.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427936"
}
```



---

archive/issue_events_427937.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427937"
}
```



---

archive/issue_comments_494332.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494332",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_427938.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2021-09-18T09:46:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427938"
}
```



---

archive/issue_events_427939.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2021-09-18T09:46:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427939"
}
```



---

archive/issue_comments_494333.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nMoving to needs_work based on the last few comments.",
    "created_at": "2021-09-18T09:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494333",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:8" align="right">comment:8</div>

Moving to needs_work based on the last few comments.



---

archive/issue_events_427940.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427940"
}
```



---

archive/issue_events_427941.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427941"
}
```



---

archive/issue_comments_494334.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThanks for working on this ticket,\nthis would be a welcome improvement.\n\nSeems almost good to go. Please:\n\n- simplify as suggested by @orlitzky\n- use raw string for new method's docstring as suggested by @fchapoton\n- use `TESTS::` rather than `TESTS:` for test blocks",
    "created_at": "2021-12-29T23:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494334",
    "user": "https://github.com/slel"
}
```

<div id="comment:10" align="right">comment:10</div>

Thanks for working on this ticket,
this would be a welcome improvement.

Seems almost good to go. Please:

- simplify as suggested by @orlitzky
- use raw string for new method's docstring as suggested by @fchapoton
- use `TESTS::` rather than `TESTS:` for test blocks



---

archive/issue_comments_494335.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,116 +1,24 @@\n-The `AA.random_element()` method only returns integers between `-2` and `2`, inclusive:\n+The `AA.random_element()` method only ever returns integers\n+among -2, -1, 0, 1, 2:\n \n ```\n-sage: [AA.random_element() for i in range(100) ]                                                                                                                             \n-[2,\n- 0,\n- 0,\n- 2,\n- 1,\n- 2,\n- -1,\n- 0,\n- -2,\n- -2,\n- -2,\n- 0,\n- -2,\n- 0,\n- 2,\n- -1,\n- 1,\n- 0,\n- 0,\n- 1,\n- 1,\n- -1,\n- 2,\n- -1,\n- 0,\n- 2,\n- 1,\n- 0,\n- 0,\n- 2,\n- 1,\n- 2,\n- 0,\n- -1,\n- -2,\n- -2,\n- -1,\n- 2,\n- -2,\n- 1,\n- -1,\n- -2,\n- -2,\n- 2,\n- -1,\n- 0,\n- 1,\n- -1,\n- 2,\n- 2,\n- 0,\n- -2,\n- -1,\n- -1,\n- 1,\n- -2,\n- 2,\n- 0,\n- 2,\n- -2,\n- 0,\n- -2,\n- 1,\n- -2,\n- 0,\n- -2,\n- -2,\n- -2,\n- -1,\n- -2,\n- -1,\n- 2,\n- 0,\n- 0,\n- 1,\n- 0,\n- 0,\n- -2,\n- 0,\n- -1,\n- 2,\n- -2,\n- 0,\n- -2,\n- 2,\n- -1,\n- -1,\n- 1,\n- 1,\n- -2,\n- -1,\n- 0,\n- -2,\n- -2,\n- -1,\n- 2,\n- -2,\n- -1,\n- -2,\n- -2]\n+sage: ' '.join(str(AA.random_element()) for i in range(100))\n+2 0 0 2 1 2 -1 0 -2 -2 -2 0 -2 0 2 -1 1 0 0 1 1 -1 2 -1 0 2 1\n+0 0 2 1 2 0 -1 -2 -2 -1 2 -2 1 -1 -2 -2 2 -1 0 1 -1 2 2 0 -2\n+-1 -1 1 -2 2 0 2 -2 0 -2 1 -2 0 -2 -2 -2 -1 -2 -1 2 0 0 1 0 0\n+-2 0 -1 2 -2 0 -2 2 -1 -1 1 1 -2 -1 0 -2 -2 -1 2 -2 -1 -2 -2\n ```\n \n-That's a bit un-random, even by sage standards. A simple improvement would be to return the real part of `QQbar.random_element()`:\n+That's a bit un-random, even by Sage standards.\n+A simple improvement would be to return the real part\n+of `QQbar.random_element()`:\n \n ```\n-\n-}}}sage: [QQbar.random_element().real() for i in range(5) ]                                                                                                                     \n+sage: [QQbar.random_element().real() for i in range(5) ]\n [-5.372281323269015?,\n  -0.2000000000000000?,\n  0.50000000000000000?,\n  -0.50000000000000000?,\n  0.1906845620110298?]\n+```\n+\n``````\n",
    "created_at": "2021-12-29T23:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494335",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,116 +1,24 @@
-The `AA.random_element()` method only returns integers between `-2` and `2`, inclusive:
+The `AA.random_element()` method only ever returns integers
+among -2, -1, 0, 1, 2:
 
 ```
-sage: [AA.random_element() for i in range(100) ]                                                                                                                             
-[2,
- 0,
- 0,
- 2,
- 1,
- 2,
- -1,
- 0,
- -2,
- -2,
- -2,
- 0,
- -2,
- 0,
- 2,
- -1,
- 1,
- 0,
- 0,
- 1,
- 1,
- -1,
- 2,
- -1,
- 0,
- 2,
- 1,
- 0,
- 0,
- 2,
- 1,
- 2,
- 0,
- -1,
- -2,
- -2,
- -1,
- 2,
- -2,
- 1,
- -1,
- -2,
- -2,
- 2,
- -1,
- 0,
- 1,
- -1,
- 2,
- 2,
- 0,
- -2,
- -1,
- -1,
- 1,
- -2,
- 2,
- 0,
- 2,
- -2,
- 0,
- -2,
- 1,
- -2,
- 0,
- -2,
- -2,
- -2,
- -1,
- -2,
- -1,
- 2,
- 0,
- 0,
- 1,
- 0,
- 0,
- -2,
- 0,
- -1,
- 2,
- -2,
- 0,
- -2,
- 2,
- -1,
- -1,
- 1,
- 1,
- -2,
- -1,
- 0,
- -2,
- -2,
- -1,
- 2,
- -2,
- -1,
- -2,
- -2]
+sage: ' '.join(str(AA.random_element()) for i in range(100))
+2 0 0 2 1 2 -1 0 -2 -2 -2 0 -2 0 2 -1 1 0 0 1 1 -1 2 -1 0 2 1
+0 0 2 1 2 0 -1 -2 -2 -1 2 -2 1 -1 -2 -2 2 -1 0 1 -1 2 2 0 -2
+-1 -1 1 -2 2 0 2 -2 0 -2 1 -2 0 -2 -2 -2 -1 -2 -1 2 0 0 1 0 0
+-2 0 -1 2 -2 0 -2 2 -1 -1 1 1 -2 -1 0 -2 -2 -1 2 -2 -1 -2 -2
 ```
 
-That's a bit un-random, even by sage standards. A simple improvement would be to return the real part of `QQbar.random_element()`:
+That's a bit un-random, even by Sage standards.
+A simple improvement would be to return the real part
+of `QQbar.random_element()`:
 
 ```
-
-}}}sage: [QQbar.random_element().real() for i in range(5) ]                                                                                                                     
+sage: [QQbar.random_element().real() for i in range(5) ]
 [-5.372281323269015?,
  -0.2000000000000000?,
  0.50000000000000000?,
  -0.50000000000000000?,
  0.1906845620110298?]
+```
+
``````




---

archive/issue_comments_494336.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@slel](#comment:10):\n> Thanks for working on this ticket,\n> this would be a welcome improvement.\n> \n> Seems almost good to go. Please:\n> \n> - simplify as suggested by @orlitzky\n\nI don't think my suggestion is any simpler; in fact, if I were writing the module from scratch I would probably try to do what Ben did.\n\nThe `AlgebraicField_common` class, even though it is technically a superclass of `QQbar`/`AA`, is used more like a \"mix-in\" than a parent. Its methods don't delegate to subclass implementations; instead, it contains only the few methods that are literally the same in its subclasses. For an example of what I mean, see `polynomial_root()` whose implementations differ only by one word, but are not abstracted into the superclass.\n\nAt this point I just don't think we should try to change the design without serious thought (and personally, I'd like this to be an easy ticket). So (re)implementing `random_element()` in `AA` would appear the path of least resistance.",
    "created_at": "2021-12-30T00:16:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494336",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@slel](#comment:10):
> Thanks for working on this ticket,
> this would be a welcome improvement.
> 
> Seems almost good to go. Please:
> 
> - simplify as suggested by @orlitzky

I don't think my suggestion is any simpler; in fact, if I were writing the module from scratch I would probably try to do what Ben did.

The `AlgebraicField_common` class, even though it is technically a superclass of `QQbar`/`AA`, is used more like a "mix-in" than a parent. Its methods don't delegate to subclass implementations; instead, it contains only the few methods that are literally the same in its subclasses. For an example of what I mean, see `polynomial_root()` whose implementations differ only by one word, but are not abstracted into the superclass.

At this point I just don't think we should try to change the design without serious thought (and personally, I'd like this to be an easy ticket). So (re)implementing `random_element()` in `AA` would appear the path of least resistance.



---

archive/issue_comments_494337.json:
```json
{
    "body": "Changed commit from **[`4772419`](https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2)** to **[`1e40f34`](https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f)**",
    "created_at": "2021-12-30T02:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494337",
    "user": "https://github.com/orlitzky"
}
```

Changed commit from **[`4772419`](https://github.com/sagemath/sagetrac-mirror/commit/477241999ea1e1da45938431b830c198ccb311f2)** to **[`1e40f34`](https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f)**



---

archive/issue_comments_494338.json:
```json
{
    "body": "Changed branch from **[u/gh-bmlivin/random_elements_of_aa_aren_t_random](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-bmlivin/random_elements_of_aa_aren_t_random)** to **[u/mjo/ticket/30875](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/30875)**",
    "created_at": "2021-12-30T02:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494338",
    "user": "https://github.com/orlitzky"
}
```

Changed branch from **[u/gh-bmlivin/random_elements_of_aa_aren_t_random](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-bmlivin/random_elements_of_aa_aren_t_random)** to **[u/mjo/ticket/30875](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/30875)**



---

archive/issue_events_427942.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-12-30T02:06:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427942"
}
```



---

archive/issue_events_427943.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-12-30T02:06:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427943"
}
```



---

archive/issue_comments_494339.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nLet's see if patchbot likes this.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb1f741169d5bc3bc01d559bafbda7ccb63e6f68\"><code>bb1f741</code></a></td><td><code>build/pkgs/singular/spkg-install.in: Remove workaround for make paralellization bugs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2673632e6e9e5caa372c448ad71a0c6cfdc9b050\"><code>2673632</code></a></td><td><code>Port to API changes in singular 4.2.1p2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/720d10e8a7f7d2bf4038b65c64e73db494106a57\"><code>720d10e</code></a></td><td><code>Update tests for singular 4.2.1p2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cca353b70b9fdf04ca2fb1b76fff097d6bde940a\"><code>cca353b</code></a></td><td><code>src/sage/rings/polynomial/hilbert.pyx: Fix doctest markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c6c9498e236cbc6a15b3ad80830db3e5adb55de\"><code>8c6c949</code></a></td><td><code>build/pkgs/flint/: Add patch for threads with GCC < 4.9</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eea6328795664a3958988495c010e6431e6db5ea\"><code>eea6328</code></a></td><td><code>build/pkgs/singular/spkg-install.in: singular.hlp -> singular.info</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a137b7e6ff86fdf222d34ceb562d8f5fa5e4e741\"><code>a137b7e</code></a></td><td><code>Merge tag '9.5.beta8' into t/32907/update_singular_to_4_2_1p2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0856554004c43d72729967a0865f795b29488da2\"><code>0856554</code></a></td><td><code>build/pkgs/singular: Update to 4.2.1p3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1c448e157d7eea8360bc2560f4b5a91abe102ea\"><code>e1c448e</code></a></td><td><code>Merge commit '0856554' into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f\"><code>1e40f34</code></a></td><td><code>Trac #30875: randomize random elements from AA.</code></td></tr></table>\n",
    "created_at": "2021-12-30T02:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494339",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:12" align="right">comment:12</div>

Let's see if patchbot likes this.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb1f741169d5bc3bc01d559bafbda7ccb63e6f68"><code>bb1f741</code></a></td><td><code>build/pkgs/singular/spkg-install.in: Remove workaround for make paralellization bugs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2673632e6e9e5caa372c448ad71a0c6cfdc9b050"><code>2673632</code></a></td><td><code>Port to API changes in singular 4.2.1p2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/720d10e8a7f7d2bf4038b65c64e73db494106a57"><code>720d10e</code></a></td><td><code>Update tests for singular 4.2.1p2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cca353b70b9fdf04ca2fb1b76fff097d6bde940a"><code>cca353b</code></a></td><td><code>src/sage/rings/polynomial/hilbert.pyx: Fix doctest markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c6c9498e236cbc6a15b3ad80830db3e5adb55de"><code>8c6c949</code></a></td><td><code>build/pkgs/flint/: Add patch for threads with GCC < 4.9</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eea6328795664a3958988495c010e6431e6db5ea"><code>eea6328</code></a></td><td><code>build/pkgs/singular/spkg-install.in: singular.hlp -> singular.info</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a137b7e6ff86fdf222d34ceb562d8f5fa5e4e741"><code>a137b7e</code></a></td><td><code>Merge tag '9.5.beta8' into t/32907/update_singular_to_4_2_1p2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0856554004c43d72729967a0865f795b29488da2"><code>0856554</code></a></td><td><code>build/pkgs/singular: Update to 4.2.1p3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1c448e157d7eea8360bc2560f4b5a91abe102ea"><code>e1c448e</code></a></td><td><code>Merge commit '0856554' into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f"><code>1e40f34</code></a></td><td><code>Trac #30875: randomize random elements from AA.</code></td></tr></table>




---

archive/issue_comments_494340.json:
```json
{
    "body": "Changed author from **Ben Livingston** to **Ben Livingston, Michael Orlitzky**",
    "created_at": "2021-12-30T02:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494340",
    "user": "https://github.com/orlitzky"
}
```

Changed author from **Ben Livingston** to **Ben Livingston, Michael Orlitzky**



---

archive/issue_comments_494341.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447\"><code>748f6f3</code></a></td><td><code>Trac #30875: add missing colons to TESTS blocks in sage.rings.qqbar.</code></td></tr></table>\n",
    "created_at": "2021-12-30T02:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494341",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447"><code>748f6f3</code></a></td><td><code>Trac #30875: add missing colons to TESTS blocks in sage.rings.qqbar.</code></td></tr></table>




---

archive/issue_comments_494342.json:
```json
{
    "body": "Changed commit from **[`1e40f34`](https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f)** to **[`748f6f3`](https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447)**",
    "created_at": "2021-12-30T02:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494342",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1e40f34`](https://github.com/sagemath/sagetrac-mirror/commit/1e40f342d10b306ca94409bd0e43cd7bc1c3817f)** to **[`748f6f3`](https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447)**



---

archive/issue_comments_494343.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/470d460e53e1561e59a47e657095f7a673d17e38\"><code>470d460</code></a></td><td><code>Trac #30875: randomize random elements from AA.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af\"><code>94c07ba</code></a></td><td><code>Trac #30875: add missing colons to TESTS blocks in sage.rings.qqbar.</code></td></tr></table>\n",
    "created_at": "2021-12-30T02:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494343",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/470d460e53e1561e59a47e657095f7a673d17e38"><code>470d460</code></a></td><td><code>Trac #30875: randomize random elements from AA.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af"><code>94c07ba</code></a></td><td><code>Trac #30875: add missing colons to TESTS blocks in sage.rings.qqbar.</code></td></tr></table>




---

archive/issue_comments_494344.json:
```json
{
    "body": "Changed commit from **[`748f6f3`](https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447)** to **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**",
    "created_at": "2021-12-30T02:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494344",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`748f6f3`](https://github.com/sagemath/sagetrac-mirror/commit/748f6f3fc3e279e1292eaf3d05d2489635160447)** to **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**



---

archive/issue_comments_494345.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe patch looks good. The only thing I'm concerned about is that using degree 2 by default is perhaps a little (too?) small: Experimentally, the output lies in `QQ` about 62% of the time (is this 5/8?), and only ever returning quadratic numbers is kind of restrictive too. Of course, higher degrees make things slower, so I don't know what the perfect balance is. It looks like `poly_degree=4` might be a reasonable choice.",
    "created_at": "2021-12-30T08:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494345",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:15" align="right">comment:15</div>

The patch looks good. The only thing I'm concerned about is that using degree 2 by default is perhaps a little (too?) small: Experimentally, the output lies in `QQ` about 62% of the time (is this 5/8?), and only ever returning quadratic numbers is kind of restrictive too. Of course, higher degrees make things slower, so I don't know what the perfect balance is. It looks like `poly_degree=4` might be a reasonable choice.



---

archive/issue_comments_494346.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@yyyyx4](#comment:15):\n> The patch looks good. The only thing I'm concerned about is that using degree 2 by default is perhaps a little (too?) small: Experimentally, the output lies in `QQ` about 62% of the time (is this 5/8?), and only ever returning quadratic numbers is kind of restrictive too. Of course, higher degrees make things slower, so I don't know what the perfect balance is. It looks like `poly_degree=4` might be a reasonable choice.\n\nI had this same thought last night, but when I tried it, using `poly_degree=4` took almost 3x as long to generate a number:\n\n```\nsage: %timeit AA.random_element(poly_degree=2)\n2.67 ms \u00b1 53 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\nsage: %timeit AA.random_element(poly_degree=3)\n4.24 ms \u00b1 80.1 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\nsage: %timeit AA.random_element(poly_degree=4)\n7.3 ms \u00b1 1.04 ms per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n```\n\n~2.5ms is already a horrendous amount of time to generate a number, especially if you plan to e.g. fill a matrix with them. I'd hate to make `matrix.random(AA,5)` take ~175ms more than I hate the slight loss of randomness.",
    "created_at": "2021-12-30T12:48:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494346",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@yyyyx4](#comment:15):
> The patch looks good. The only thing I'm concerned about is that using degree 2 by default is perhaps a little (too?) small: Experimentally, the output lies in `QQ` about 62% of the time (is this 5/8?), and only ever returning quadratic numbers is kind of restrictive too. Of course, higher degrees make things slower, so I don't know what the perfect balance is. It looks like `poly_degree=4` might be a reasonable choice.

I had this same thought last night, but when I tried it, using `poly_degree=4` took almost 3x as long to generate a number:

```
sage: %timeit AA.random_element(poly_degree=2)
2.67 ms ± 53 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
sage: %timeit AA.random_element(poly_degree=3)
4.24 ms ± 80.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
sage: %timeit AA.random_element(poly_degree=4)
7.3 ms ± 1.04 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
```

~2.5ms is already a horrendous amount of time to generate a number, especially if you plan to e.g. fill a matrix with them. I'd hate to make `matrix.random(AA,5)` take ~175ms more than I hate the slight loss of randomness.



---

archive/issue_events_427944.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2021-12-30T16:08:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427944"
}
```



---

archive/issue_events_427945.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2021-12-30T16:08:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427945"
}
```



---

archive/issue_events_427946.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2021-12-30T16:08:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427946"
}
```



---

archive/issue_events_427947.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2021-12-30T16:08:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427947"
}
```



---

archive/issue_comments_494347.json:
```json
{
    "body": "Reviewer: **Lorenz Panny**",
    "created_at": "2021-12-30T16:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494347",
    "user": "https://github.com/yyyyx4"
}
```

Reviewer: **Lorenz Panny**



---

archive/issue_comments_494348.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAlright!",
    "created_at": "2021-12-30T16:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494348",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:17" align="right">comment:17</div>

Alright!



---

archive/issue_comments_494349.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIf speed matters, for degree bound two,\nwould the following be faster:\n\n- pick random integers `a`, `b`, `c`, `d`\n  (with nonzero `d `)\n- return `(a + b * AA(c).sqrt()) / d`\n\n(with `c > 0` for `AA`, any `c` for `QQbar`)\nand if so, is it worth special casing it?",
    "created_at": "2021-12-31T01:51:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494349",
    "user": "https://github.com/slel"
}
```

<div id="comment:18" align="right">comment:18</div>

If speed matters, for degree bound two,
would the following be faster:

- pick random integers `a`, `b`, `c`, `d`
  (with nonzero `d `)
- return `(a + b * AA(c).sqrt()) / d`

(with `c > 0` for `AA`, any `c` for `QQbar`)
and if so, is it worth special casing it?



---

archive/issue_comments_494350.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nMaybe similar recipes for degree 3 and 4\nwould have acceptable speeds?\n\nRandom expressible-by-radicals algebraics of a\nwider range of degrees might be cheap-ish too?",
    "created_at": "2021-12-31T01:58:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494350",
    "user": "https://github.com/slel"
}
```

<div id="comment:19" align="right">comment:19</div>

Maybe similar recipes for degree 3 and 4
would have acceptable speeds?

Random expressible-by-radicals algebraics of a
wider range of degrees might be cheap-ish too?



---

archive/issue_comments_494351.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI think so. For example (this is on a faster machine):\n\n```\nsage: %timeit QQbar.random_element().real()\n1.17 ms \u00b1 7.19 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n```\n\nversus\n\n```\nsage: def random_AA(degree):\n....:     exponents = [0] + [1/k for k in range(1,degree+1)]\n....:     return sum( QQ.random_element()*AA(ZZ.random_element(0,10))^k\n....:                 for k in exponents )\n....:\nsage: %timeit random_AA(2)\n715 \u00b5s \u00b1 15 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n```\n\nThat's a subtly different kind of random, but does anyone care?",
    "created_at": "2021-12-31T02:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494351",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:20" align="right">comment:20</div>

I think so. For example (this is on a faster machine):

```
sage: %timeit QQbar.random_element().real()
1.17 ms ± 7.19 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
```

versus

```
sage: def random_AA(degree):
....:     exponents = [0] + [1/k for k in range(1,degree+1)]
....:     return sum( QQ.random_element()*AA(ZZ.random_element(0,10))^k
....:                 for k in exponents )
....:
sage: %timeit random_AA(2)
715 µs ± 15 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
```

That's a subtly different kind of random, but does anyone care?



---

archive/issue_comments_494352.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/30875](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/30875)** to **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**",
    "created_at": "2022-01-04T22:51:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30875#issuecomment-494352",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mjo/ticket/30875](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/30875)** to **[`94c07ba`](https://github.com/sagemath/sagetrac-mirror/commit/94c07ba55b6137f8ac57753984ef21470d9431af)**



---

archive/issue_events_427948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-04T22:51:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427948"
}
```



---

archive/issue_events_427949.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "969746aadcbda5eb2cb339dce47a3a437b51c5ff",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-01-04T22:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30875",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30875#event-427949"
}
```
