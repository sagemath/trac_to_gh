# Issue 30503: src/tox.ini: Add environment codespell

archive/issues_030266.json:
```json
{
    "body": "We add a tox environment `codespell`.\n\n- https://fossies.org/features.html#codespell\n\n- https://pypi.org/project/codespell/\n\n\nTo try: `./sage -tox -e codespell`\n\n\n\n\nCC:  @fchapoton @slel @tobiasdiez\n\nKeywords: documentation, spelling, spellcheck\n\nBranch/Commit: e5a916fbedee067b8a58b0d640f7465d2269668c\n\nReviewer: Tobias Diez\n\nAuthor: Matthias Koeppe\n\nDependencies: #30467\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30503\n\n",
    "closed_at": "2020-09-23T21:27:39Z",
    "created_at": "2020-09-04T13:36:26Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "src/tox.ini: Add environment codespell",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30503",
    "user": "https://github.com/slel"
}
```
We add a tox environment `codespell`.

- https://fossies.org/features.html#codespell

- https://pypi.org/project/codespell/


To try: `./sage -tox -e codespell`




CC:  @fchapoton @slel @tobiasdiez

Keywords: documentation, spelling, spellcheck

Branch/Commit: e5a916fbedee067b8a58b0d640f7465d2269668c

Reviewer: Tobias Diez

Author: Matthias Koeppe

Dependencies: #30467

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30503





---

archive/issue_comments_431037.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2020-09-07T05:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431037",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_431038.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T06:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431038",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431039.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T06:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431040.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-07T06:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431040",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_431041.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T06:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431041",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431042.json:
```json
{
    "body": "<a id='comment:9'></a>I like it! A few observations:\n\n- Documentation needed, especially how it integrates with common IDEs.\n- Is the idea to run it as part of a github action, or patchbot on each ticket?\n- The exceptions added in .codespell-dictionary.txt seem to be proper missspellings or abbreviations that in my opinion shouldn't be encouraged in a multi-language dev team. I would actually propose to add the conversions ans -> answer, numer -> number as a custom codespell directory (`- D` argument)\n- What's the reason to only apply it to the source folder, and not the whole project (including build scripts etc)\n- Rename codespell-dictinary.txt to codespell-ignore. In codespell terminology, a dictionary flags misspellings and provides alternatives, e.g https://github.com/codespell-project/codespell/blob/45b67b427489910b0ef5e4566c9b3989be3f0f33/codespell_lib/data/dictionary_rare.txt\n-  Is it possible to add the configuration as a config block in tox instead of as cmd line args? https://github.com/codespell-project/codespell#using-a-config-file wasn't clear about tox support for this.",
    "created_at": "2020-09-07T10:10:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431042",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>I like it! A few observations:

- Documentation needed, especially how it integrates with common IDEs.
- Is the idea to run it as part of a github action, or patchbot on each ticket?
- The exceptions added in .codespell-dictionary.txt seem to be proper missspellings or abbreviations that in my opinion shouldn't be encouraged in a multi-language dev team. I would actually propose to add the conversions ans -> answer, numer -> number as a custom codespell directory (`- D` argument)
- What's the reason to only apply it to the source folder, and not the whole project (including build scripts etc)
- Rename codespell-dictinary.txt to codespell-ignore. In codespell terminology, a dictionary flags misspellings and provides alternatives, e.g https://github.com/codespell-project/codespell/blob/45b67b427489910b0ef5e4566c9b3989be3f0f33/codespell_lib/data/dictionary_rare.txt
-  Is it possible to add the configuration as a config block in tox instead of as cmd line args? https://github.com/codespell-project/codespell#using-a-config-file wasn't clear about tox support for this.



---

archive/issue_comments_431043.json:
```json
{
    "body": "<a id='comment:10'></a>Thanks a lot for the comments!",
    "created_at": "2020-09-07T16:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431043",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Thanks a lot for the comments!



---

archive/issue_comments_431044.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-09-07T16:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431044",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_431045.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:9 gh-tobiasdiez]:\n> -  Is it possible to add the configuration as a config block in tox instead of as cmd line args? https://github.com/codespell-project/codespell#using-a-config-file wasn't clear about tox support for this.\n\n\nIt only checks for `.codespellrc` and `setup.cfg`. I'm going to use `.codespellrc`",
    "created_at": "2020-09-07T16:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431045",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Replying to [comment:9 gh-tobiasdiez]:
> -  Is it possible to add the configuration as a config block in tox instead of as cmd line args? https://github.com/codespell-project/codespell#using-a-config-file wasn't clear about tox support for this.


It only checks for `.codespellrc` and `setup.cfg`. I'm going to use `.codespellrc`



---

archive/issue_comments_431046.json:
```json
{
    "body": "<a id='comment:12'></a>Actually, the released version (1.17.1) has no support for config files at all, so we have to keep the command line.",
    "created_at": "2020-09-07T16:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431046",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Actually, the released version (1.17.1) has no support for config files at all, so we have to keep the command line.



---

archive/issue_comments_431047.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T17:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431048.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T17:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431048",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431049.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:9 gh-tobiasdiez]:\n> - What's the reason to only apply it to the source folder, and not the whole project (including build scripts etc)\n\n\n`src/` is the \"pure Python\" part of the project (sagelib). Most Sage developers are only familiar with this part.\n\nBut I have changed the top-level tox.ini so that it runs codespell on the same distribution.\n\nMany of the excluded file/directory patterns could actually be obtained from `.gitignore` - but then again we would need a shell script to do this. I think it's \"good enough\" for this ticket.",
    "created_at": "2020-09-07T17:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431049",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Replying to [comment:9 gh-tobiasdiez]:
> - What's the reason to only apply it to the source folder, and not the whole project (including build scripts etc)


`src/` is the "pure Python" part of the project (sagelib). Most Sage developers are only familiar with this part.

But I have changed the top-level tox.ini so that it runs codespell on the same distribution.

Many of the excluded file/directory patterns could actually be obtained from `.gitignore` - but then again we would need a shell script to do this. I think it's "good enough" for this ticket.



---

archive/issue_comments_431050.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:9 gh-tobiasdiez]:\n> - Documentation needed, especially how it integrates with common IDEs.\n\n\nLet's add documentation in #30453 (`sage -advanced` already shows it as part of the help). I will need help there with the IDE angle - I only use the command line.\n\n> - Is the idea to run it as part of a github action, or patchbot on each ticket?\n\n\nAs of this ticket, it's just a dev tool that can be run locally. I don't have plans to work on CI integration for it.",
    "created_at": "2020-09-07T17:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431050",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:9 gh-tobiasdiez]:
> - Documentation needed, especially how it integrates with common IDEs.


Let's add documentation in #30453 (`sage -advanced` already shows it as part of the help). I will need help there with the IDE angle - I only use the command line.

> - Is the idea to run it as part of a github action, or patchbot on each ticket?


As of this ticket, it's just a dev tool that can be run locally. I don't have plans to work on CI integration for it.



---

archive/issue_comments_431051.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-09-07T17:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431051",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_431052.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T17:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431052",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_431053.json:
```json
{
    "body": "<a id='comment:18'></a>Thanks! LGTM\n\n(By the way, what are the conventions concerning putting yourself as reviewer, and changing the status to positive review?)",
    "created_at": "2020-09-07T18:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431053",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:18'></a>Thanks! LGTM

(By the way, what are the conventions concerning putting yourself as reviewer, and changing the status to positive review?)



---

archive/issue_comments_431054.json:
```json
{
    "body": "<a id='comment:19'></a>As soon as you have participated in reviewing a ticket, it is appropriate to add your name to the list of reviewers.\n\n(I have started to use the format \"My name, ...\" to indicate that more reviewers may be needed to cover other aspects of the ticket that I do not feel confident (or do not have time) to review. But this is not widely used ... yet.)\n\nIf you are the only reviewer and you are confident about giving a positive review, you set positive_review. If there are several active reviewers, some communication using comments is needed.",
    "created_at": "2020-09-07T19:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431054",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>As soon as you have participated in reviewing a ticket, it is appropriate to add your name to the list of reviewers.

(I have started to use the format "My name, ..." to indicate that more reviewers may be needed to cover other aspects of the ticket that I do not feel confident (or do not have time) to review. But this is not widely used ... yet.)

If you are the only reviewer and you are confident about giving a positive review, you set positive_review. If there are several active reviewers, some communication using comments is needed.



---

archive/issue_comments_431055.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-07T19:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431055",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431056.json:
```json
{
    "body": "<a id='comment:20'></a>Thanks for the review.",
    "created_at": "2020-09-07T19:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431056",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Thanks for the review.



---

archive/issue_comments_431057.json:
```json
{
    "body": "<a id='comment:21'></a>Thanks to you, for the explanation!",
    "created_at": "2020-09-07T21:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431057",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:21'></a>Thanks to you, for the explanation!



---

archive/issue_comments_431058.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-09-23T21:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30503#issuecomment-431058",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_079238.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-23T21:27:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30503",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30503#event-79238"
}
```
