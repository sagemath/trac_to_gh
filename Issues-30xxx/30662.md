# Issue 30662: Update conda package information, and fix building Sage on conda

archive/issues_030425.json:
```json
{
    "assignees": [],
    "body": "1) `build/pkgs/conda.txt` still has `\"python<3.8\"`\n\n2) Some trouble involving libpng as reported in https://groups.google.com/d/msg/sage-devel/LMFRiG9Y0ZM/1FIyE5P4CAAJ\n\n\n\nCC:  @dimpase @isuruf\n\nBranch/Commit: **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**\n\nReviewer: **Dima Pasechnik, Isuru Fernando**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **porting**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30662_\n\n",
    "closed_at": "2020-09-30T22:30:25Z",
    "created_at": "2020-09-25T14:36:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update conda package information, and fix building Sage on conda",
    "type": "issue",
    "updated_at": "2020-09-30T22:30:25Z",
    "url": "https://github.com/sagemath/sage/issues/30662",
    "user": "https://github.com/mkoeppe"
}
```
1) `build/pkgs/conda.txt` still has `"python<3.8"`

2) Some trouble involving libpng as reported in https://groups.google.com/d/msg/sage-devel/LMFRiG9Y0ZM/1FIyE5P4CAAJ



CC:  @dimpase @isuruf

Branch/Commit: **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**

Reviewer: **Dima Pasechnik, Isuru Fernando**

Author: **Matthias Koeppe**

Component: **porting**

_Issue created by migration from https://trac.sagemath.org/ticket/30662_





---

archive/issue_events_424816.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-25T14:36:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424816"
}
```



---

archive/issue_events_424817.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-25T14:36:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "000080",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424817"
}
```



---

archive/issue_events_424818.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-25T14:36:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424818"
}
```



---

archive/issue_events_424819.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-25T14:36:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424819"
}
```



---

archive/issue_comments_489332.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nyes, I'm currently trying to reproduce this, and ran so far into a similar error.\nI am not sure whether there  always was the recommendation to use Conda's compilers, \nc-compiler, cxx-compiler, and fortran-compiler.\n\nWhat I see atm is\n\n```\nlibtool: compile:  /home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc -DPACKAGE_NAME=\\\"libhomfly\\\" -DPACKAGE_TARNAME=\\\"libhomfly\\\" -DPACKAGE_VERSION=\\\"1.02r6\\\" \"-DPACKAGE_STRING=\\\"libhomfly 1.02r6\\\"\" -DPACKAGE_BUGREPORT=\\\"mmarco@unizar.es\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"libhomfly\\\" -DVERSION=\\\"1.02r6\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\\\".libs/\\\" -I. -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/scratch2/dimpase/miniconda3/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/scratch2/dimpase/miniconda3/include -c control.c  -fPIC -DPIC -o .libs/control.o\nbound.c:10:10: fatal error: gc.h: No such file or directory\n #include <gc.h>\n          ^~~~~~\n``` \nin\n\n```\nSetting up build directory for libhomfly-1.02r6\nFinished extraction\nNo patch files found in ../patches\n****************************************************\nHost system:\nLinux clpc171.cs.ox.ac.uk 5.2.18-200.fc30.x86_64 #1 SMP Tue Oct 1 13:14:07 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: /home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc\nC compiler version:\nReading specs from /home/scratch2/dimpase/miniconda3/bin/../lib/gcc/x86_64-conda-linux-gnu/7.5.0/specs\nCOLLECT_GCC=/home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc\nCOLLECT_LTO_WRAPPER=/home/scratch2/dimpase/miniconda3/bin/../libexec/gcc/x86_64-conda-linux-gnu/7.5.0/lto-wrapper\nTarget: x86_64-conda-linux-gnu\nConfigured with: /home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/src/gcc/configure --build=x86_64-build_pc-linux-gnu --host=x86_64-build_pc-linux-gnu --target=x86_64-conda-linux-gnu --prefix=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built --with-sysroot=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built/x86_64-conda-linux-gnu/sysroot --enable-languages=c,c++,fortran,objc,obj-c++ --with-pkgversion='crosstool-NG 1.24.0.131_87df0e6_dirty' --enable-__cxa_atexit --disable-libmudflap --enable-libgomp --disable-libssp --enable-libquadmath --enable-libquadmath-support --enable-libsanitizer --enable-libmpx --with-gmp=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-mpfr=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-mpc=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-isl=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --enable-lto --enable-threads=posix --enable-target-optspace --enable-plugin --enable-gold --disable-nls --disable-multilib --with-local-prefix=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built/x86_64-conda-linux-gnu/sysroot --enable-long-long --enable-default-pie\nThread model: posix\ngcc version 7.5.0 (crosstool-NG 1.24.0.131_87df0e6_dirty) \n...\n```\n\nyes, this one is probably fixable by installing conda gc package (if there is one) - but the question is why the compiler does not want to see anything in /usr/include?\n\n(here Sage is configured to use system gc package)",
    "created_at": "2020-09-25T15:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489332",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

yes, I'm currently trying to reproduce this, and ran so far into a similar error.
I am not sure whether there  always was the recommendation to use Conda's compilers, 
c-compiler, cxx-compiler, and fortran-compiler.

What I see atm is

```
libtool: compile:  /home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc -DPACKAGE_NAME=\"libhomfly\" -DPACKAGE_TARNAME=\"libhomfly\" -DPACKAGE_VERSION=\"1.02r6\" "-DPACKAGE_STRING=\"libhomfly 1.02r6\"" -DPACKAGE_BUGREPORT=\"mmarco@unizar.es\" -DPACKAGE_URL=\"\" -DPACKAGE=\"libhomfly\" -DVERSION=\"1.02r6\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -I. -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/scratch2/dimpase/miniconda3/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/scratch2/dimpase/miniconda3/include -c control.c  -fPIC -DPIC -o .libs/control.o
bound.c:10:10: fatal error: gc.h: No such file or directory
 #include <gc.h>
          ^~~~~~
``` 
in

```
Setting up build directory for libhomfly-1.02r6
Finished extraction
No patch files found in ../patches
****************************************************
Host system:
Linux clpc171.cs.ox.ac.uk 5.2.18-200.fc30.x86_64 #1 SMP Tue Oct 1 13:14:07 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: /home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc
C compiler version:
Reading specs from /home/scratch2/dimpase/miniconda3/bin/../lib/gcc/x86_64-conda-linux-gnu/7.5.0/specs
COLLECT_GCC=/home/scratch2/dimpase/miniconda3/bin/x86_64-conda-linux-gnu-cc
COLLECT_LTO_WRAPPER=/home/scratch2/dimpase/miniconda3/bin/../libexec/gcc/x86_64-conda-linux-gnu/7.5.0/lto-wrapper
Target: x86_64-conda-linux-gnu
Configured with: /home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/src/gcc/configure --build=x86_64-build_pc-linux-gnu --host=x86_64-build_pc-linux-gnu --target=x86_64-conda-linux-gnu --prefix=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built --with-sysroot=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built/x86_64-conda-linux-gnu/sysroot --enable-languages=c,c++,fortran,objc,obj-c++ --with-pkgversion='crosstool-NG 1.24.0.131_87df0e6_dirty' --enable-__cxa_atexit --disable-libmudflap --enable-libgomp --disable-libssp --enable-libquadmath --enable-libquadmath-support --enable-libsanitizer --enable-libmpx --with-gmp=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-mpfr=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-mpc=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --with-isl=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/.build/x86_64-conda-linux-gnu/buildtools --enable-lto --enable-threads=posix --enable-target-optspace --enable-plugin --enable-gold --disable-nls --disable-multilib --with-local-prefix=/home/conda/feedstock_root/build_artifacts/ctng-compilers_1598124794965/work/gcc_built/x86_64-conda-linux-gnu/sysroot --enable-long-long --enable-default-pie
Thread model: posix
gcc version 7.5.0 (crosstool-NG 1.24.0.131_87df0e6_dirty) 
...
```

yes, this one is probably fixable by installing conda gc package (if there is one) - but the question is why the compiler does not want to see anything in /usr/include?

(here Sage is configured to use system gc package)



---

archive/issue_comments_489333.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n> but the question is why the compiler does not want to see anything in /usr/include? \n\nThis is intentional with the compilers shipped by conda. Mixing system packages and conda packages almost always breaks stuff. (For eg: the pillow issue @mkoeppe had). You need to add `-I/usr/include` for the compiler to find it.\n\n> (here Sage is configured to use system gc package)\n\nHow did sage find the system gc package if the compiler doesn't? Does sage by default look in `/usr/include`?",
    "created_at": "2020-09-25T15:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489333",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:2" align="right">comment:2</div>

> but the question is why the compiler does not want to see anything in /usr/include? 

This is intentional with the compilers shipped by conda. Mixing system packages and conda packages almost always breaks stuff. (For eg: the pillow issue @mkoeppe had). You need to add `-I/usr/include` for the compiler to find it.

> (here Sage is configured to use system gc package)

How did sage find the system gc package if the compiler doesn't? Does sage by default look in `/usr/include`?



---

archive/issue_comments_489334.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@isuruf](#comment:2):\n> > but the question is why the compiler does not want to see anything in /usr/include? \n\n> \n> This is intentional with the compilers shipped by conda. Mixing system packages and conda packages almost always breaks stuff. (For eg: the pillow issue @mkoeppe had). You need to add `-I/usr/include` for the compiler to find it.\n> \n> > (here Sage is configured to use system gc package)\n\n> \n> How did sage find the system gc package if the compiler doesn't? Does sage by default look in `/usr/include`?\n\nit's done by calling autoconf macro `PKG_CHECK_MODULES`, which basically calls pkg-config and checks the version. Discovering that `gc.h` is not easy, as `$pkg-config -cflags bdw-gc`\ndoes not return anything. (Arguably it is a `bdw-gc` bug, but it does not make it easier).",
    "created_at": "2020-09-25T15:37:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489334",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@isuruf](#comment:2):
> > but the question is why the compiler does not want to see anything in /usr/include? 

> 
> This is intentional with the compilers shipped by conda. Mixing system packages and conda packages almost always breaks stuff. (For eg: the pillow issue @mkoeppe had). You need to add `-I/usr/include` for the compiler to find it.
> 
> > (here Sage is configured to use system gc package)

> 
> How did sage find the system gc package if the compiler doesn't? Does sage by default look in `/usr/include`?

it's done by calling autoconf macro `PKG_CHECK_MODULES`, which basically calls pkg-config and checks the version. Discovering that `gc.h` is not easy, as `$pkg-config -cflags bdw-gc`
does not return anything. (Arguably it is a `bdw-gc` bug, but it does not make it easier).



---

archive/issue_comments_489335.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\none can do something like\n\n```\n$ pkg-config --variable=includedir bdw-gc\n/usr/include\n```\nor from the autoconf is would be `PKG_CHECK_VAR([GCINCLUDEDIR],[bdw-gc], [includedir])`",
    "created_at": "2020-09-25T15:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489335",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

one can do something like

```
$ pkg-config --variable=includedir bdw-gc
/usr/include
```
or from the autoconf is would be `PKG_CHECK_VAR([GCINCLUDEDIR],[bdw-gc], [includedir])`



---

archive/issue_comments_489336.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nanother sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig\n\nthis is something that leads to a problem in buidling linbox, if fflas-ffpack is installed in conda\n\nSomething in `build/pkgs/pkgconf/spkg-configure.m4` should be fixed. It has\n\n```\n       AC_SUBST(SAGE_PKG_CONFIG_PATH, ['$SAGE_LOCAL/lib/pkgconfig'])\n```\nso the list should be extended with `<conda-root>/lib/pkgconfig`. So this leads the questions:\n\n1. how to find out in autoconf that we're on Conda\n2. how to find <conda-root>",
    "created_at": "2020-09-25T16:39:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489336",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig

this is something that leads to a problem in buidling linbox, if fflas-ffpack is installed in conda

Something in `build/pkgs/pkgconf/spkg-configure.m4` should be fixed. It has

```
       AC_SUBST(SAGE_PKG_CONFIG_PATH, ['$SAGE_LOCAL/lib/pkgconfig'])
```
so the list should be extended with `<conda-root>/lib/pkgconfig`. So this leads the questions:

1. how to find out in autoconf that we're on Conda
2. how to find <conda-root>



---

archive/issue_comments_489337.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@dimpase](#comment:4):\n> one can do something like\n> \n> ```\n> $ pkg-config --variable=includedir bdw-gc\n> /usr/include\n> ```\n> or from the autoconf is would be `PKG_CHECK_VAR([GCINCLUDEDIR],[bdw-gc], [includedir])`\n> \n\nthere is even a gh issue for this: https://github.com/miguelmarco/libhomfly/issues/10",
    "created_at": "2020-09-25T16:42:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489337",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@dimpase](#comment:4):
> one can do something like
> 
> ```
> $ pkg-config --variable=includedir bdw-gc
> /usr/include
> ```
> or from the autoconf is would be `PKG_CHECK_VAR([GCINCLUDEDIR],[bdw-gc], [includedir])`
> 

there is even a gh issue for this: https://github.com/miguelmarco/libhomfly/issues/10



---

archive/issue_events_424820.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-25T17:16:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "title_is": "Update conda package information, and fix building Sage on conda",
    "title_was": "Update conda package information",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424820"
}
```



---

archive/issue_events_424821.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-25T17:16:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424821"
}
```



---

archive/issue_events_424822.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-25T17:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424822"
}
```



---

archive/issue_comments_489338.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@dimpase](#comment:5):\n> another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig\n\nWhich pkg-config is that?",
    "created_at": "2020-09-25T17:30:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489338",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@dimpase](#comment:5):
> another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig

Which pkg-config is that?



---

archive/issue_comments_489339.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mkoeppe](#comment:8):\n> Replying to [@dimpase](#comment:5):\n> > another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig\n\n> \n> Which pkg-config is that?\n\nthe system's one. Perhaps installing conda's pkg-config (if it has one) is an easier way out.\n\nOne more thing: \nthere is a similar to libgc problem with libgd, which is used only in sagelib.\n(headers and the dylib are not found at /usr/ by conda's compiler and linker)",
    "created_at": "2020-09-25T17:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489339",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mkoeppe](#comment:8):
> Replying to [@dimpase](#comment:5):
> > another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig

> 
> Which pkg-config is that?

the system's one. Perhaps installing conda's pkg-config (if it has one) is an easier way out.

One more thing: 
there is a similar to libgc problem with libgd, which is used only in sagelib.
(headers and the dylib are not found at /usr/ by conda's compiler and linker)



---

archive/issue_comments_489340.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@dimpase](#comment:9):\n> Replying to [@mkoeppe](#comment:8):\n> > Replying to [@dimpase](#comment:5):\n> > > another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig\n\n> > \n> > Which pkg-config is that?\n\n> \n> the system's one. Perhaps installing conda's pkg-config (if it has one) is an easier way out.\n\nYes, it is already listed in `build/pkgs/conda-bootstrap.txt`. Probably should add somewhere else too.",
    "created_at": "2020-09-25T17:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489340",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@dimpase](#comment:9):
> Replying to [@mkoeppe](#comment:8):
> > Replying to [@dimpase](#comment:5):
> > > another sort of trouble is coming from pkg-config not looking in <conda-root>/lib/pkgconfig

> > 
> > Which pkg-config is that?

> 
> the system's one. Perhaps installing conda's pkg-config (if it has one) is an easier way out.

Yes, it is already listed in `build/pkgs/conda-bootstrap.txt`. Probably should add somewhere else too.



---

archive/issue_comments_489341.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@dimpase](#comment:5):\n> 1. how to find out in autoconf that we're on Conda\n> 2. how to find <conda-root>\n\nBasically, don't.",
    "created_at": "2020-09-25T17:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489341",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@dimpase](#comment:5):
> 1. how to find out in autoconf that we're on Conda
> 2. how to find <conda-root>

Basically, don't.



---

archive/issue_comments_489342.json:
```json
{
    "body": "Branch: **[u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda)**",
    "created_at": "2020-09-25T18:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489342",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda)**



---

archive/issue_comments_489343.json:
```json
{
    "body": "Commit: **[`49bfd8a`](https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947)**",
    "created_at": "2020-09-25T18:00:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489343",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`49bfd8a`](https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947)**



---

archive/issue_comments_489344.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947\"><code>49bfd8a</code></a></td><td><code>build/pkgs/conda.txt: Change python to '<3.9'</code></td></tr></table>\n",
    "created_at": "2020-09-25T18:00:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489344",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947"><code>49bfd8a</code></a></td><td><code>build/pkgs/conda.txt: Change python to '<3.9'</code></td></tr></table>




---

archive/issue_comments_489345.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWe could also extend `m4/sage_check_conda_compilers.m4` to make it a hard error if conda's pkg-config is not installed.",
    "created_at": "2020-09-25T18:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489345",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

We could also extend `m4/sage_check_conda_compilers.m4` to make it a hard error if conda's pkg-config is not installed.



---

archive/issue_comments_489346.json:
```json
{
    "body": "Changed commit from **[`49bfd8a`](https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947)** to **[`d5b486e`](https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d)**",
    "created_at": "2020-09-25T18:39:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489346",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`49bfd8a`](https://github.com/sagemath/sagetrac-mirror/commit/49bfd8a2ca66a0b0ef638d29f9d880aa71ffc947)** to **[`d5b486e`](https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d)**



---

archive/issue_comments_489347.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d\"><code>d5b486e</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Also check for pkg-config</code></td></tr></table>\n",
    "created_at": "2020-09-25T18:39:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489347",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d"><code>d5b486e</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Also check for pkg-config</code></td></tr></table>




---

archive/issue_comments_489348.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-09-25T18:40:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489348",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_489349.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nconfigure doesn't work:\n\n```\n...\nchecking whether a conda environment is active... yes\nconfigure: error: A conda environment (base) is active, but\nthe pkg-config command is not provided by the conda environment,\nwhich indicates that the conda environment is missing\nthe following conda packages required for building Sage:\n     pkg-config\nFor building Sage, either:\n- activate a conda environment that has these packages, using:\n    conda activate ENVIRONMENT\n- or install these conda packages, using\n    conda install  pkg-config\n- or deactivate conda by\n    conda deactivate\n  (this command may need to be repeated).\n(base) clpc171[/home/scratch2/dimpase/miniconda3/sage]$ \n(base) clpc171[/home/scratch2/dimpase/miniconda3/sage]$ which pkg-config\npkg-config is /home/scratch2/dimpase/miniconda3/bin/pkg-config\n```",
    "created_at": "2020-09-25T18:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489349",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

configure doesn't work:

```
...
checking whether a conda environment is active... yes
configure: error: A conda environment (base) is active, but
the pkg-config command is not provided by the conda environment,
which indicates that the conda environment is missing
the following conda packages required for building Sage:
     pkg-config
For building Sage, either:
- activate a conda environment that has these packages, using:
    conda activate ENVIRONMENT
- or install these conda packages, using
    conda install  pkg-config
- or deactivate conda by
    conda deactivate
  (this command may need to be repeated).
(base) clpc171[/home/scratch2/dimpase/miniconda3/sage]$ 
(base) clpc171[/home/scratch2/dimpase/miniconda3/sage]$ which pkg-config
pkg-config is /home/scratch2/dimpase/miniconda3/bin/pkg-config
```



---

archive/issue_comments_489350.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nmaybe because conda installs a script pkg-config and a binary pkg-config.bin (at least on Linux this is the case)",
    "created_at": "2020-09-25T19:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489350",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

maybe because conda installs a script pkg-config and a binary pkg-config.bin (at least on Linux this is the case)



---

archive/issue_comments_489351.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1320b91d61d95f6a3c36f0bdc4184183bd7e5955\"><code>1320b91</code></a></td><td><code>configure.ac: Check for pkg-config version with the PKG_PROG_PKG_CONFIG macro</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e\"><code>38e6a77</code></a></td><td><code>Use PKG_CONFIG instead of ac_cv_path_PKGCONF</code></td></tr></table>\n",
    "created_at": "2020-09-25T19:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489351",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1320b91d61d95f6a3c36f0bdc4184183bd7e5955"><code>1320b91</code></a></td><td><code>configure.ac: Check for pkg-config version with the PKG_PROG_PKG_CONFIG macro</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e"><code>38e6a77</code></a></td><td><code>Use PKG_CONFIG instead of ac_cv_path_PKGCONF</code></td></tr></table>




---

archive/issue_comments_489352.json:
```json
{
    "body": "Changed commit from **[`d5b486e`](https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d)** to **[`38e6a77`](https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e)**",
    "created_at": "2020-09-25T19:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489352",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d5b486e`](https://github.com/sagemath/sagetrac-mirror/commit/d5b486e04b80ca2314aa0f1facd05c8effb0da3d)** to **[`38e6a77`](https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e)**



---

archive/issue_comments_489353.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHere's a better version (only tested on macOS)",
    "created_at": "2020-09-25T19:45:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489353",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Here's a better version (only tested on macOS)



---

archive/issue_comments_489354.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOK, this works, but how about adding `pkg-config` to `build/pkgs/conda.txt`, in order to make sure it's not missing?",
    "created_at": "2020-09-25T20:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489354",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

OK, this works, but how about adding `pkg-config` to `build/pkgs/conda.txt`, in order to make sure it's not missing?



---

archive/issue_comments_489355.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2\"><code>7b25914</code></a></td><td><code>build/pkgs/conda*.txt: Move pkg-config to conda.txt</code></td></tr></table>\n",
    "created_at": "2020-09-25T20:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489355",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2"><code>7b25914</code></a></td><td><code>build/pkgs/conda*.txt: Move pkg-config to conda.txt</code></td></tr></table>




---

archive/issue_comments_489356.json:
```json
{
    "body": "Changed commit from **[`38e6a77`](https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e)** to **[`7b25914`](https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2)**",
    "created_at": "2020-09-25T20:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489356",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`38e6a77`](https://github.com/sagemath/sagetrac-mirror/commit/38e6a7779e55db335533b96c878e5208bcc42a4e)** to **[`7b25914`](https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2)**



---

archive/issue_comments_489357.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nGood idea, done.",
    "created_at": "2020-09-25T20:48:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489357",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

Good idea, done.



---

archive/issue_events_424823.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-25T21:00:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424823"
}
```



---

archive/issue_events_424824.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-25T21:03:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424824"
}
```



---

archive/issue_events_424825.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-25T21:03:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424825"
}
```



---

archive/issue_comments_489358.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik, Isuru Fernando**",
    "created_at": "2020-09-25T21:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489358",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik, Isuru Fernando**



---

archive/issue_comments_489359.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nlgtm",
    "created_at": "2020-09-25T21:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489359",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

lgtm



---

archive/issue_comments_489360.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThanks!",
    "created_at": "2020-09-25T21:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489360",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Thanks!



---

archive/issue_comments_489361.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nBtw, we need to add `bdw-gc` to `build/pkgs/gc/distros/conda.txt`",
    "created_at": "2020-09-25T21:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489361",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:27" align="right">comment:27</div>

Btw, we need to add `bdw-gc` to `build/pkgs/gc/distros/conda.txt`



---

archive/issue_events_424826.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-25T21:09:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424826"
}
```



---

archive/issue_events_424827.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-25T21:09:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424827"
}
```



---

archive/issue_comments_489362.json:
```json
{
    "body": "Changed commit from **[`7b25914`](https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2)** to **[`59e4a30`](https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983)**",
    "created_at": "2020-09-25T21:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489362",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7b25914`](https://github.com/sagemath/sagetrac-mirror/commit/7b259148ee7c1fc5c66c1a1ddee981bff89e94b2)** to **[`59e4a30`](https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983)**



---

archive/issue_comments_489363.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983\"><code>59e4a30</code></a></td><td><code>build/pkgs/gc/distros/conda.txt: Use bdw-gc</code></td></tr></table>\n",
    "created_at": "2020-09-25T21:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489363",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983"><code>59e4a30</code></a></td><td><code>build/pkgs/gc/distros/conda.txt: Use bdw-gc</code></td></tr></table>




---

archive/issue_events_424828.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-09-25T21:10:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424828"
}
```



---

archive/issue_events_424829.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-09-25T21:10:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424829"
}
```



---

archive/issue_comments_489364.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI'm getting \n\n```\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG libatomic_ops...\nchecking for atomic_ops >= 7.6.2... no\nconfigure: no suitable system package found for SPKG libatomic_ops\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG gc...\nchecking whether any of libatomic_ops is installed as or will be installed as SPKG... yes; install gc as well\nconfigure: no suitable system package found for SPKG gc\n-----------------------------------------------------------------------------\n```",
    "created_at": "2020-09-25T21:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489364",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

I'm getting 

```
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG libatomic_ops...
checking for atomic_ops >= 7.6.2... no
configure: no suitable system package found for SPKG libatomic_ops
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG gc...
checking whether any of libatomic_ops is installed as or will be installed as SPKG... yes; install gc as well
configure: no suitable system package found for SPKG gc
-----------------------------------------------------------------------------
```



---

archive/issue_comments_489365.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\n(previously discussed in #28991)",
    "created_at": "2020-09-25T21:39:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489365",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

(previously discussed in #28991)



---

archive/issue_comments_489366.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab\"><code>335bfa1</code></a></td><td><code>build/pkgs/libatomic_ops/distros/conda.txt: Use libatomic_ops</code></td></tr></table>\n",
    "created_at": "2020-09-25T21:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489366",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab"><code>335bfa1</code></a></td><td><code>build/pkgs/libatomic_ops/distros/conda.txt: Use libatomic_ops</code></td></tr></table>




---

archive/issue_events_424830.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-25T21:49:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424830"
}
```



---

archive/issue_events_424831.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-09-25T21:49:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424831"
}
```



---

archive/issue_comments_489367.json:
```json
{
    "body": "Changed commit from **[`59e4a30`](https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983)** to **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**",
    "created_at": "2020-09-25T21:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489367",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`59e4a30`](https://github.com/sagemath/sagetrac-mirror/commit/59e4a30e52bc52b58ef87944ae4275eda4175983)** to **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**



---

archive/issue_comments_489368.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nTrying now with this change.",
    "created_at": "2020-09-25T21:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489368",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Trying now with this change.



---

archive/issue_comments_489369.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n\n```\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG libatomic_ops...\nchecking for atomic_ops >= 7.6.2... yes\nconfigure: will use system package and not install SPKG libatomic_ops\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG gc...\nchecking whether any of libatomic_ops is installed as or will be installed as SPKG... no\nchecking for bdw-gc-threaded >= 7.6.4... no\nchecking for bdw-gc >= 7.6.4... yes\nconfigure: will use system package and not install SPKG gc\n```",
    "created_at": "2020-09-25T21:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489369",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>


```
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG libatomic_ops...
checking for atomic_ops >= 7.6.2... yes
configure: will use system package and not install SPKG libatomic_ops
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG gc...
checking whether any of libatomic_ops is installed as or will be installed as SPKG... no
checking for bdw-gc-threaded >= 7.6.4... no
checking for bdw-gc >= 7.6.4... yes
configure: will use system package and not install SPKG gc
```



---

archive/issue_comments_489370.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\n`tox -e docker-conda-forge-standard` builds without problem now.",
    "created_at": "2020-09-25T22:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489370",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

`tox -e docker-conda-forge-standard` builds without problem now.



---

archive/issue_events_424832.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-09-25T22:49:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424832"
}
```



---

archive/issue_events_424833.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-09-25T22:49:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424833"
}
```



---

archive/issue_comments_489371.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThanks",
    "created_at": "2020-09-25T22:49:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489371",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:36" align="right">comment:36</div>

Thanks



---

archive/issue_comments_489372.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda)** to **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**",
    "created_at": "2020-09-30T22:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30662#issuecomment-489372",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_conda_package_information__and_fix_building_sage_on_conda)** to **[`335bfa1`](https://github.com/sagemath/sagetrac-mirror/commit/335bfa14fc9a50e2a152b674083e7e70b5ed31ab)**



---

archive/issue_events_424834.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-30T22:30:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424834"
}
```



---

archive/issue_events_424835.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ebf4d9cf63da237df45cfd77140aa82641d13139",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-09-30T22:30:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30662",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30662#event-424835"
}
```
