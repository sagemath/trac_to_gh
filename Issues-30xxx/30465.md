# Issue 30465: faster and memory efficient implementation of Szeged index

archive/issues_030228.json:
```json
{
    "body": "The current implementation uses a dict of dicts containing distances. We change that with\n- a basic version using the Cython distance matrix\n- a version with space complexity in O(m)\n\n\nCC:  @vipul79321\n\nBranch/Commit: 72fb85a00b5742e0eef61210126bc7fbd07cebf7\n\nReviewer: Vipul Gupta\n\nAuthor: David Coudert\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30465\n\n",
    "closed_at": "2020-09-18T20:22:49Z",
    "created_at": "2020-08-29T17:27:29Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "faster and memory efficient implementation of Szeged index",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30465",
    "user": "https://github.com/dcoudert"
}
```
The current implementation uses a dict of dicts containing distances. We change that with
- a basic version using the Cython distance matrix
- a version with space complexity in O(m)


CC:  @vipul79321

Branch/Commit: 72fb85a00b5742e0eef61210126bc7fbd07cebf7

Reviewer: Vipul Gupta

Author: David Coudert

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30465





---

archive/issue_comments_601704.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n The current implementation uses a dict of dicts containing distances. We change that with\n - a basic version using the Cython distance matrix\n - a version with space complexity in O(m)\n+\n``````\n",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601704",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
 The current implementation uses a dict of dicts containing distances. We change that with
 - a basic version using the Cython distance matrix
 - a version with space complexity in O(m)
+
``````




---

archive/issue_comments_601705.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601705",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_601706.json:
```json
{
    "body": "Changing branch from \"\" to \"public/graphs/30465_szeged_index\"",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601706",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "public/graphs/30465_szeged_index"



---

archive/issue_comments_601707.json:
```json
{
    "body": "Changing commit from \"\" to \"8eddc880b7fee364300c178e048b8200d6a20290\"",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601707",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "8eddc880b7fee364300c178e048b8200d6a20290"



---

archive/issue_comments_601708.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|\n|[fafc961](https://git.sagemath.org/sage.git/commit?id=fafc9614efa5765c6c7ecce034a33aca45f30fdf)|`trac #30465: enable calls to all_pairs_shortest_path_BFS directly with a short_digraph`|\n|[8eddc88](https://git.sagemath.org/sage.git/commit?id=8eddc880b7fee364300c178e048b8200d6a20290)|`trac #30465: new algorithms for Szeged index`|",
    "created_at": "2020-08-29T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601708",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
|[fafc961](https://git.sagemath.org/sage.git/commit?id=fafc9614efa5765c6c7ecce034a33aca45f30fdf)|`trac #30465: enable calls to all_pairs_shortest_path_BFS directly with a short_digraph`|
|[8eddc88](https://git.sagemath.org/sage.git/commit?id=8eddc880b7fee364300c178e048b8200d6a20290)|`trac #30465: new algorithms for Szeged index`|



---

archive/issue_comments_601709.json:
```json
{
    "body": "<a id='comment:2'></a>\nWith this patch\n\n```\nsage: G = graphs.Grid2dGraph(10, 10)                                                                                                \nsage: %time G.szeged_index(algorithm='low')                                                                                         \nCPU times: user 1.24 ms, sys: 61 \u00b5s, total: 1.31 ms\nWall time: 1.31 ms\n330000\nsage: %time G.szeged_index(algorithm='high')                                                                                        \nCPU times: user 1.14 ms, sys: 13 \u00b5s, total: 1.15 ms\nWall time: 1.16 ms\n330000\nsage: G = graphs.CompleteGraph(50)                                                                                                  \nsage: %time G.szeged_index(algorithm='low')                                                                                         \nCPU times: user 1.44 ms, sys: 1 \u00b5s, total: 1.44 ms\nWall time: 1.45 ms\n1225\nsage: %time G.szeged_index(algorithm='high')                                                                                        \nCPU times: user 1.59 ms, sys: 0 ns, total: 1.59 ms\nWall time: 1.61 ms\n1225\n```\n\nWithout:\n\n```\nsage: G = graphs.Grid2dGraph(10, 10)                                                                                                \nsage: %time G.szeged_index()                                                                                                        \nCPU times: user 8.9 ms, sys: 1.06 ms, total: 9.96 ms\nWall time: 9.57 ms\n330000\nsage: G = graphs.CompleteGraph(50)                                                                                                  \nsage: %time G.szeged_index()                                                                                                        \nCPU times: user 19.2 ms, sys: 720 \u00b5s, total: 20 ms\nWall time: 19.5 ms\n1225\n```",
    "created_at": "2020-08-29T18:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601709",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:2'></a>
With this patch

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.24 ms, sys: 61 µs, total: 1.31 ms
Wall time: 1.31 ms
330000
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.14 ms, sys: 13 µs, total: 1.15 ms
Wall time: 1.16 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index(algorithm='low')                                                                                         
CPU times: user 1.44 ms, sys: 1 µs, total: 1.44 ms
Wall time: 1.45 ms
1225
sage: %time G.szeged_index(algorithm='high')                                                                                        
CPU times: user 1.59 ms, sys: 0 ns, total: 1.59 ms
Wall time: 1.61 ms
1225
```

Without:

```
sage: G = graphs.Grid2dGraph(10, 10)                                                                                                
sage: %time G.szeged_index()                                                                                                        
CPU times: user 8.9 ms, sys: 1.06 ms, total: 9.96 ms
Wall time: 9.57 ms
330000
sage: G = graphs.CompleteGraph(50)                                                                                                  
sage: %time G.szeged_index()                                                                                                        
CPU times: user 19.2 ms, sys: 720 µs, total: 20 ms
Wall time: 19.5 ms
1225
```



---

archive/issue_comments_601710.json:
```json
{
    "body": "<a id='comment:3'></a>\nOne minor fix in doc \n\n```diff\n- `2^16` vertices.\n+ `2^{16}` vertices.\n```\n\nAlso, I have one question, hasn't this method restricted the `szeged index` to `unweighted undirected graphs only`. Is that what we want? (I guess earlier that wasnt the case) \n\nAnd it is raising error for directed graph if that's the wanted case then why dont we move this method to `graph.py`.",
    "created_at": "2020-09-01T13:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601710",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:3'></a>
One minor fix in doc 

```diff
- `2^16` vertices.
+ `2^{16}` vertices.
```

Also, I have one question, hasn't this method restricted the `szeged index` to `unweighted undirected graphs only`. Is that what we want? (I guess earlier that wasnt the case) 

And it is raising error for directed graph if that's the wanted case then why dont we move this method to `graph.py`.



---

archive/issue_comments_601711.json:
```json
{
    "body": "Changing commit from \"8eddc880b7fee364300c178e048b8200d6a20290\" to \"8151a2afbe1ac1eb8120bac8517b2fb93acaf907\"",
    "created_at": "2020-09-01T19:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8eddc880b7fee364300c178e048b8200d6a20290" to "8151a2afbe1ac1eb8120bac8517b2fb93acaf907"



---

archive/issue_comments_601712.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[8151a2a](https://git.sagemath.org/sage.git/commit/?id=8151a2afbe1ac1eb8120bac8517b2fb93acaf907)|`trac #30465: fix doc`|",
    "created_at": "2020-09-01T19:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601712",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[8151a2a](https://git.sagemath.org/sage.git/commit/?id=8151a2afbe1ac1eb8120bac8517b2fb93acaf907)|`trac #30465: fix doc`|



---

archive/issue_comments_601713.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[0453b7d](https://git.sagemath.org/sage.git/commit/?id=0453b7dec98a178bb1b44be72e0869b8628532a9)|`trac #30465: improve behavior for digraphs`|",
    "created_at": "2020-09-01T20:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601713",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[0453b7d](https://git.sagemath.org/sage.git/commit/?id=0453b7dec98a178bb1b44be72e0869b8628532a9)|`trac #30465: improve behavior for digraphs`|



---

archive/issue_comments_601714.json:
```json
{
    "body": "Changing commit from \"8151a2afbe1ac1eb8120bac8517b2fb93acaf907\" to \"0453b7dec98a178bb1b44be72e0869b8628532a9\"",
    "created_at": "2020-09-01T20:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601714",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8151a2afbe1ac1eb8120bac8517b2fb93acaf907" to "0453b7dec98a178bb1b44be72e0869b8628532a9"



---

archive/issue_comments_601715.json:
```json
{
    "body": "Changing commit from \"0453b7dec98a178bb1b44be72e0869b8628532a9\" to \"9fff34a9b31881a9cb98e2a89c2360546b6db26b\"",
    "created_at": "2020-09-01T20:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0453b7dec98a178bb1b44be72e0869b8628532a9" to "9fff34a9b31881a9cb98e2a89c2360546b6db26b"



---

archive/issue_comments_601716.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[9fff34a](https://git.sagemath.org/sage.git/commit/?id=9fff34a9b31881a9cb98e2a89c2360546b6db26b)|`trac #30465: beter selection of default algorithm`|",
    "created_at": "2020-09-01T20:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601716",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[9fff34a](https://git.sagemath.org/sage.git/commit/?id=9fff34a9b31881a9cb98e2a89c2360546b6db26b)|`trac #30465: beter selection of default algorithm`|



---

archive/issue_comments_601717.json:
```json
{
    "body": "<a id='comment:7'></a>\nYou are right. I changed that to allow the use of the high algorithm on digraphs.",
    "created_at": "2020-09-01T20:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601717",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>
You are right. I changed that to allow the use of the high algorithm on digraphs.



---

archive/issue_comments_601718.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------|\n|[72fb85a](https://git.sagemath.org/sage.git/commit/?id=72fb85a00b5742e0eef61210126bc7fbd07cebf7)|`review commit`|",
    "created_at": "2020-09-02T06:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601718",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|[72fb85a](https://git.sagemath.org/sage.git/commit/?id=72fb85a00b5742e0eef61210126bc7fbd07cebf7)|`review commit`|



---

archive/issue_comments_601719.json:
```json
{
    "body": "Changing commit from \"9fff34a9b31881a9cb98e2a89c2360546b6db26b\" to \"72fb85a00b5742e0eef61210126bc7fbd07cebf7\"",
    "created_at": "2020-09-02T06:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9fff34a9b31881a9cb98e2a89c2360546b6db26b" to "72fb85a00b5742e0eef61210126bc7fbd07cebf7"



---

archive/issue_comments_601720.json:
```json
{
    "body": "<a id='comment:9'></a>\nWaiting for patchbot result for any issue. Rest we are done.",
    "created_at": "2020-09-02T06:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601720",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:9'></a>
Waiting for patchbot result for any issue. Rest we are done.



---

archive/issue_comments_601721.json:
```json
{
    "body": "<a id='comment:10'></a>\nLooks good to me :)",
    "created_at": "2020-09-03T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601721",
    "user": "https://github.com/vipul79321"
}
```

<a id='comment:10'></a>
Looks good to me :)



---

archive/issue_comments_601722.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-03T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601722",
    "user": "https://github.com/vipul79321"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_601723.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vipul Gupta\"",
    "created_at": "2020-09-03T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601723",
    "user": "https://github.com/vipul79321"
}
```

Changing reviewer from "" to "Vipul Gupta"



---

archive/issue_comments_601724.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you.",
    "created_at": "2020-09-03T13:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601724",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>
Thank you.



---

archive/issue_events_079086.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-18T20:22:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30465#event-79086"
}
```



---

archive/issue_comments_601725.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-09-18T20:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601725",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_601726.json:
```json
{
    "body": "Changing branch from \"public/graphs/30465_szeged_index\" to \"72fb85a00b5742e0eef61210126bc7fbd07cebf7\"",
    "created_at": "2020-09-18T20:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30465#issuecomment-601726",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/graphs/30465_szeged_index" to "72fb85a00b5742e0eef61210126bc7fbd07cebf7"
