# Issue 30040: Improve face iterator for simple/simplicial polytopes

archive/issues_029803.json:
```json
{
    "body": "So far the face iterator for polyhedra assumes the diamond property of the lattice only. The special case of simple/simplicial polytopes is not exploited. In this case all intervals not containing zero of the lattice are boolean (for simplicial polytopes we use the dual algorithm).\n\nWe alter the algorithm to work for lattices where every interval not containing zero is a boolean sublattice. We may even drop any further conditions on the lattice. So we may apply the algorithm to lattices, where some \"edges\" have only one atom.\nThus the algorithm can in principle be applied to simplicial complexes now in dual mode (\"edges\" with a single atom correspond to \"ridges\" only contained in one maximal face). The key observations are:\n\n- To check whether an intersection of faces is zero, we check whether the atom-representation is zero. Although not unique (in case the diamond property is relaxed), it works to distinguish from zero.\n \n- To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.\n \n- An intersection of two facets has always codimension 1, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).\n\n- To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.\n\n- To check whether we have seen a face already, we check containment of the coatom representation.\n\nThis algorithm performs much better and is also asymptotically better.\n\nBefore this ticket:\n\n```\nsage: P = polytopes.permutahedron(7)\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 85.7 ms, sys: 0 ns, total: 85.7 ms\nWall time: 85.1 ms\n(1, 5040, 15120, 16800, 8400, 1806, 126, 1)\n\nsage: P = polytopes.associahedron(['A',9], backend='normaliz')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 1.11 s, sys: 23 \u00b5s, total: 1.11 s\nWall time: 1.11 s\n(1, 16796, 75582, 143208, 148512, 91728, 34398, 7644, 936, 54, 1)\n\nsage: P = polytopes.associahedron(['A',10], backend='normaliz')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 21 s, sys: 19.8 ms, total: 21 s\nWall time: 21 s\n(1, 58786, 293930, 629850, 755820, 556920, 259896, 76440, 13650, 1365, 65, 1)\n\nsage: P = polytopes.hypercube(14, backend='field')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 5.27 s, sys: 11.9 ms, total: 5.28 s\nWall time: 5.27 s\n(1, 16384, 114688, 372736, 745472, 1025024, 1025024, 768768, 439296, 192192, 64064, 16016, 2912, 364, 28, 1)\nsage: P = polytopes.hypercube(16, backend='field')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 3min 11s, sys: 152 ms, total: 3min 11s\nWall time: 3min 11s\n(1, 65536, 524288, 1966080, 4587520, 7454720, 8945664, 8200192, 5857280, 3294720, 1464320, 512512, 139776, 29120, 4480, 480, 32, 1)\n```\n\nWith this ticket:\n\n```\nsage: P = polytopes.permutahedron(7)\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 15.5 ms, sys: 0 ns, total: 15.5 ms\nWall time: 15.5 ms\n(1, 5040, 15120, 16800, 8400, 1806, 126, 1)\n\nsage: P = polytopes.associahedron(['A',9], backend='normaliz')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 161 ms, sys: 14 \u00b5s, total: 161 ms\nWall time: 161 ms\n(1, 16796, 75582, 143208, 148512, 91728, 34398, 7644, 936, 54, 1)\n\nsage: P = polytopes.associahedron(['A',10], backend='normaliz')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 2.17 s, sys: 0 ns, total: 2.17 s\nWall time: 2.17 s\n(1, 58786, 293930, 629850, 755820, 556920, 259896, 76440, 13650, 1365, 65, 1)\n\nsage: P = polytopes.hypercube(14, backend='field')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 1.1 s, sys: 0 ns, total: 1.1 s\nWall time: 1.1 s\n(1, 16384, 114688, 372736, 745472, 1025024, 1025024, 768768, 439296, 192192, 64064, 16016, 2912, 364, 28, 1)\n\nsage: P = polytopes.hypercube(16, backend='field')\nsage: C = CombinatorialPolyhedron(P)\nsage: %time C.f_vector()\nCPU times: user 28 s, sys: 23.3 ms, total: 28 s\nWall time: 28 s\n(1, 65536, 524288, 1966080, 4587520, 7454720, 8945664, 8200192, 5857280, 3294720, 1464320, 512512, 139776, 29120, 4480, 480, 32, 1)\n```\n\nCC:  @jplab @laisrast @tscrim\n\nKeywords: face iterator, simple, simplicial, polytopes\n\nBranch/Commit: 63b7bd60cfc649e3d4448f970295eb7b7a977adf\n\nReviewer: Travis Scrimshaw\n\nAuthor: Jonathan Kliem\n\nDependencies: #29676, #29681, #30428, #30429, #30458\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30040\n\n",
    "closed_at": "2020-11-15T22:47:36Z",
    "created_at": "2020-07-01T15:05:26Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Improve face iterator for simple/simplicial polytopes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30040",
    "user": "https://github.com/kliem"
}
```
So far the face iterator for polyhedra assumes the diamond property of the lattice only. The special case of simple/simplicial polytopes is not exploited. In this case all intervals not containing zero of the lattice are boolean (for simplicial polytopes we use the dual algorithm).

We alter the algorithm to work for lattices where every interval not containing zero is a boolean sublattice. We may even drop any further conditions on the lattice. So we may apply the algorithm to lattices, where some "edges" have only one atom.
Thus the algorithm can in principle be applied to simplicial complexes now in dual mode ("edges" with a single atom correspond to "ridges" only contained in one maximal face). The key observations are:

- To check whether an intersection of faces is zero, we check whether the atom-representation is zero. Although not unique (in case the diamond property is relaxed), it works to distinguish from zero.
 
- To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.
 
- An intersection of two facets has always codimension 1, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).

- To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.

- To check whether we have seen a face already, we check containment of the coatom representation.

This algorithm performs much better and is also asymptotically better.

Before this ticket:

```
sage: P = polytopes.permutahedron(7)
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 85.7 ms, sys: 0 ns, total: 85.7 ms
Wall time: 85.1 ms
(1, 5040, 15120, 16800, 8400, 1806, 126, 1)

sage: P = polytopes.associahedron(['A',9], backend='normaliz')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 1.11 s, sys: 23 µs, total: 1.11 s
Wall time: 1.11 s
(1, 16796, 75582, 143208, 148512, 91728, 34398, 7644, 936, 54, 1)

sage: P = polytopes.associahedron(['A',10], backend='normaliz')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 21 s, sys: 19.8 ms, total: 21 s
Wall time: 21 s
(1, 58786, 293930, 629850, 755820, 556920, 259896, 76440, 13650, 1365, 65, 1)

sage: P = polytopes.hypercube(14, backend='field')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 5.27 s, sys: 11.9 ms, total: 5.28 s
Wall time: 5.27 s
(1, 16384, 114688, 372736, 745472, 1025024, 1025024, 768768, 439296, 192192, 64064, 16016, 2912, 364, 28, 1)
sage: P = polytopes.hypercube(16, backend='field')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 3min 11s, sys: 152 ms, total: 3min 11s
Wall time: 3min 11s
(1, 65536, 524288, 1966080, 4587520, 7454720, 8945664, 8200192, 5857280, 3294720, 1464320, 512512, 139776, 29120, 4480, 480, 32, 1)
```

With this ticket:

```
sage: P = polytopes.permutahedron(7)
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 15.5 ms, sys: 0 ns, total: 15.5 ms
Wall time: 15.5 ms
(1, 5040, 15120, 16800, 8400, 1806, 126, 1)

sage: P = polytopes.associahedron(['A',9], backend='normaliz')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 161 ms, sys: 14 µs, total: 161 ms
Wall time: 161 ms
(1, 16796, 75582, 143208, 148512, 91728, 34398, 7644, 936, 54, 1)

sage: P = polytopes.associahedron(['A',10], backend='normaliz')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 2.17 s, sys: 0 ns, total: 2.17 s
Wall time: 2.17 s
(1, 58786, 293930, 629850, 755820, 556920, 259896, 76440, 13650, 1365, 65, 1)

sage: P = polytopes.hypercube(14, backend='field')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 1.1 s, sys: 0 ns, total: 1.1 s
Wall time: 1.1 s
(1, 16384, 114688, 372736, 745472, 1025024, 1025024, 768768, 439296, 192192, 64064, 16016, 2912, 364, 28, 1)

sage: P = polytopes.hypercube(16, backend='field')
sage: C = CombinatorialPolyhedron(P)
sage: %time C.f_vector()
CPU times: user 28 s, sys: 23.3 ms, total: 28 s
Wall time: 28 s
(1, 65536, 524288, 1966080, 4587520, 7454720, 8945664, 8200192, 5857280, 3294720, 1464320, 512512, 139776, 29120, 4480, 480, 32, 1)
```

CC:  @jplab @laisrast @tscrim

Keywords: face iterator, simple, simplicial, polytopes

Branch/Commit: 63b7bd60cfc649e3d4448f970295eb7b7a977adf

Reviewer: Travis Scrimshaw

Author: Jonathan Kliem

Dependencies: #29676, #29681, #30428, #30429, #30458

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30040





---

archive/issue_comments_590219.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2020-07-01T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590219",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_590220.json:
```json
{
    "body": "Changing branch from \"\" to \"public/30040\"",
    "created_at": "2020-07-01T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590220",
    "user": "https://github.com/kliem"
}
```

Changing branch from "" to "public/30040"



---

archive/issue_comments_590221.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-01T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590221",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_590222.json:
```json
{
    "body": "Changing commit from \"\" to \"ceab5037b843a1a65ece192d2ba8652e208d0011\"",
    "created_at": "2020-07-01T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590222",
    "user": "https://github.com/kliem"
}
```

Changing commit from "" to "ceab5037b843a1a65ece192d2ba8652e208d0011"



---

archive/issue_comments_590223.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to geometry.",
    "created_at": "2020-07-02T17:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590223",
    "user": "https://github.com/kliem"
}
```

Changing component from PLEASE CHANGE to geometry.



---

archive/issue_comments_590224.json:
```json
{
    "body": "<a id='comment:4'></a>Needs rebase.",
    "created_at": "2020-08-21T11:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590224",
    "user": "https://github.com/kliem"
}
```

<a id='comment:4'></a>Needs rebase.



---

archive/issue_comments_590225.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-21T11:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590225",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_590226.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n  \n - To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.\n  \n-- To see whether a new face is of codimension one, we check whether the difference of the length of coatom representations is one.\n+- An intersection of two facets has always codimension, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).\n \n - To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.\n \n``````\n",
    "created_at": "2020-08-24T09:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590226",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
  
 - To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.
  
-- To see whether a new face is of codimension one, we check whether the difference of the length of coatom representations is one.
+- An intersection of two facets has always codimension, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).
 
 - To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.
 
``````




---

archive/issue_comments_590227.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n  \n - To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.\n  \n-- An intersection of two facets has always codimension, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).\n+- An intersection of two facets has always codimension 1, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).\n \n - To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.\n \n``````\n",
    "created_at": "2020-08-24T09:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590227",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
  
 - To intersect we now additionally unite the coatom representation. This gives the correct representation of the new face unless the intersection is zero.
  
-- An intersection of two facets has always codimension, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).
+- An intersection of two facets has always codimension 1, if not empty (they contain a common atom and are thus contained in a common boolean sublattice).
 
 - To mark a face as visited, we save its coatom representation in `visited_all_coatom_rep`.
 
``````




---

archive/issue_comments_590228.json:
```json
{
    "body": "Changing dependencies from \"#28894\" to \"#30428\"",
    "created_at": "2020-08-24T09:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590228",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#28894" to "#30428"



---

archive/issue_comments_590229.json:
```json
{
    "body": "Changing dependencies from \"#30428\" to \"#30428, #30429\"",
    "created_at": "2020-08-24T09:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590229",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#30428" to "#30428, #30429"



---

archive/issue_comments_590230.json:
```json
{
    "body": "Changing work_issues from \"There is a merge conflict with #29676. Whichever takes longer needs to be rebased.\" to \"There are merge conflicts with #29676, #29681. Whichever takes longer needs to be rebased.\"",
    "created_at": "2020-08-24T10:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590230",
    "user": "https://github.com/kliem"
}
```

Changing work_issues from "There is a merge conflict with #29676. Whichever takes longer needs to be rebased." to "There are merge conflicts with #29676, #29681. Whichever takes longer needs to be rebased."



---

archive/issue_comments_590231.json:
```json
{
    "body": "Changing branch from \"public/30040\" to \"public/30040-reb\"",
    "created_at": "2020-08-24T10:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590231",
    "user": "https://github.com/kliem"
}
```

Changing branch from "public/30040" to "public/30040-reb"



---

archive/issue_comments_590232.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-24T10:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590232",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_590233.json:
```json
{
    "body": "Changing commit from \"ceab5037b843a1a65ece192d2ba8652e208d0011\" to \"7ffac00417d0143aafefec4c21e3ad59a45cac06\"",
    "created_at": "2020-08-24T10:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590233",
    "user": "https://github.com/kliem"
}
```

Changing commit from "ceab5037b843a1a65ece192d2ba8652e208d0011" to "7ffac00417d0143aafefec4c21e3ad59a45cac06"



---

archive/issue_comments_590234.json:
```json
{
    "body": "<a id='comment:10'></a>New commits:",
    "created_at": "2020-08-24T10:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590234",
    "user": "https://github.com/kliem"
}
```

<a id='comment:10'></a>New commits:



---

archive/issue_comments_590235.json:
```json
{
    "body": "<a id='comment:11'></a>Typo: `intervalls` -> `intervals`\n\nBikeshedding: Personally, I find `sizeof(uint64_t **)` confusing compared to `sizeof(uint64_t**)`, where IMO is more indicative that it is a pointer. Feel free to ignore this comment.\n\nI feel like #29676 and #29681 are more natural as dependencies of this ticket given their changes, but that is not a strong opinion. I am happy to do the review of those tickets as well. Also, beyond these to things above, this ticket LGTM.",
    "created_at": "2020-08-25T00:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590235",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>Typo: `intervalls` -> `intervals`

Bikeshedding: Personally, I find `sizeof(uint64_t **)` confusing compared to `sizeof(uint64_t**)`, where IMO is more indicative that it is a pointer. Feel free to ignore this comment.

I feel like #29676 and #29681 are more natural as dependencies of this ticket given their changes, but that is not a strong opinion. I am happy to do the review of those tickets as well. Also, beyond these to things above, this ticket LGTM.



---

archive/issue_comments_590236.json:
```json
{
    "body": "Changing commit from \"7ffac00417d0143aafefec4c21e3ad59a45cac06\" to \"01b4154149fcc31347e8591874aa1668907aa315\"",
    "created_at": "2020-08-25T06:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590236",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7ffac00417d0143aafefec4c21e3ad59a45cac06" to "01b4154149fcc31347e8591874aa1668907aa315"



---

archive/issue_comments_590237.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-25T06:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_590238.json:
```json
{
    "body": "<a id='comment:13'></a>- At some point I started doing it like `cdef uint64_t *foo`, hence the `sizeof(uint64_t *)`.\n\n  This works well, because you can legally do `cdef uint64_t *foo, *foo2`, however I quickly stopped that because I got warnings that I'm not supposed to do this.\n\n  Once you start declaring each pointer in its own line, you can go to `cdef uint64_t* foo`, which is more natural, I agree. I just didn't yet. I think I should have a seperate ticket that gets this stuff in order in the entire folder. At the moment everything is one style, which is also desirable, I think.\n\n-  In principal #29676 and #29681 are more natural as dependencies of this ticket than vice versa (both are somewhat nice to review at the moment). I agree. But I don't want them to be in the way (in case they are sitting there without review). I'm happy to rebase whatever makes sense",
    "created_at": "2020-08-25T06:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590238",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'></a>- At some point I started doing it like `cdef uint64_t *foo`, hence the `sizeof(uint64_t *)`.

  This works well, because you can legally do `cdef uint64_t *foo, *foo2`, however I quickly stopped that because I got warnings that I'm not supposed to do this.

  Once you start declaring each pointer in its own line, you can go to `cdef uint64_t* foo`, which is more natural, I agree. I just didn't yet. I think I should have a seperate ticket that gets this stuff in order in the entire folder. At the moment everything is one style, which is also desirable, I think.

-  In principal #29676 and #29681 are more natural as dependencies of this ticket than vice versa (both are somewhat nice to review at the moment). I agree. But I don't want them to be in the way (in case they are sitting there without review). I'm happy to rebase whatever makes sense



---

archive/issue_comments_590239.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-25T13:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590239",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_590240.json:
```json
{
    "body": "<a id='comment:14'></a>Actually, there is a mistake.\n\nTo use the coatom representation to a mark a face as visited will work for polyhedra, but does require the uniqueness of the coatom representation. So this will not work for simplicial complexes.",
    "created_at": "2020-08-25T13:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590240",
    "user": "https://github.com/kliem"
}
```

<a id='comment:14'></a>Actually, there is a mistake.

To use the coatom representation to a mark a face as visited will work for polyhedra, but does require the uniqueness of the coatom representation. So this will not work for simplicial complexes.



---

archive/issue_comments_590241.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-25T13:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590241",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_590242.json:
```json
{
    "body": "<a id='comment:15'></a>Never mind. I should have read closely and rethought. The atom-representation is not unique. This is the entire point of worrying about the coatom representation. It's not because it is shorter, but because this is the only thing that will work for simplicial complexes.",
    "created_at": "2020-08-25T13:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590242",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>Never mind. I should have read closely and rethought. The atom-representation is not unique. This is the entire point of worrying about the coatom representation. It's not because it is shorter, but because this is the only thing that will work for simplicial complexes.



---

archive/issue_comments_590243.json:
```json
{
    "body": "Changing commit from \"01b4154149fcc31347e8591874aa1668907aa315\" to \"accea52802a9bcf8f3aea69bd4489ecdcaad94e8\"",
    "created_at": "2020-08-28T14:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "01b4154149fcc31347e8591874aa1668907aa315" to "accea52802a9bcf8f3aea69bd4489ecdcaad94e8"



---

archive/issue_comments_590244.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-28T14:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_590245.json:
```json
{
    "body": "Changing dependencies from \"#30428, #30429\" to \"#30428, #30429, #30458\"",
    "created_at": "2020-08-28T14:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590245",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#30428, #30429" to "#30428, #30429, #30458"



---

archive/issue_comments_590246.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2020-08-30T04:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590246",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_590247.json:
```json
{
    "body": "<a id='comment:18'></a>I just did the review of #29676 and #29681. So if you could rebase this based on those and just let me know if there are any non-trivial changes, then I should be able to finish the review of this ticket quickly.",
    "created_at": "2020-08-30T04:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590247",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>I just did the review of #29676 and #29681. So if you could rebase this based on those and just let me know if there are any non-trivial changes, then I should be able to finish the review of this ticket quickly.



---

archive/issue_comments_590248.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-30T05:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590248",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_590249.json:
```json
{
    "body": "Changing work_issues from \"There are merge conflicts with #29676, #29681. Whichever takes longer needs to be rebased.\" to \"\"",
    "created_at": "2020-08-30T05:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590249",
    "user": "https://github.com/kliem"
}
```

Changing work_issues from "There are merge conflicts with #29676, #29681. Whichever takes longer needs to be rebased." to ""



---

archive/issue_comments_590250.json:
```json
{
    "body": "Changing dependencies from \"#30428, #30429, #30458\" to \"#29676, #29681, #30428, #30429, #30458\"",
    "created_at": "2020-08-30T05:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590250",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#30428, #30429, #30458" to "#29676, #29681, #30428, #30429, #30458"



---

archive/issue_comments_590251.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-30T06:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590251",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_590252.json:
```json
{
    "body": "Changing commit from \"accea52802a9bcf8f3aea69bd4489ecdcaad94e8\" to \"ed6e966209266875d61895cf8112672675b17960\"",
    "created_at": "2020-08-30T06:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590252",
    "user": "https://github.com/kliem"
}
```

Changing commit from "accea52802a9bcf8f3aea69bd4489ecdcaad94e8" to "ed6e966209266875d61895cf8112672675b17960"



---

archive/issue_comments_590253.json:
```json
{
    "body": "<a id='comment:20'></a>Last 10 new commits:",
    "created_at": "2020-08-30T06:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590253",
    "user": "https://github.com/kliem"
}
```

<a id='comment:20'></a>Last 10 new commits:



---

archive/issue_comments_590254.json:
```json
{
    "body": "Changing branch from \"public/30040-reb\" to \"public/30040-reb2\"",
    "created_at": "2020-08-30T06:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590254",
    "user": "https://github.com/kliem"
}
```

Changing branch from "public/30040-reb" to "public/30040-reb2"



---

archive/issue_comments_590255.json:
```json
{
    "body": "<a id='comment:21'></a>Putting all five dependencies together works cleanly.\n\nPutting in the commits of this ticket was annoying but pretty much trivial.\n\nIt's all about figuring out, where those things have moved (and that `self.structure` is now `structptr[0]` in the `nogil` functions).",
    "created_at": "2020-08-30T06:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590255",
    "user": "https://github.com/kliem"
}
```

<a id='comment:21'></a>Putting all five dependencies together works cleanly.

Putting in the commits of this ticket was annoying but pretty much trivial.

It's all about figuring out, where those things have moved (and that `self.structure` is now `structptr[0]` in the `nogil` functions).



---

archive/issue_comments_590256.json:
```json
{
    "body": "<a id='comment:22'></a>If the patchbot comes back green, you can set a positive review on my behalf.",
    "created_at": "2020-08-30T06:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590256",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>If the patchbot comes back green, you can set a positive review on my behalf.



---

archive/issue_comments_590257.json:
```json
{
    "body": "<a id='comment:23'></a>Thank you.",
    "created_at": "2020-08-30T08:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590257",
    "user": "https://github.com/kliem"
}
```

<a id='comment:23'></a>Thank you.



---

archive/issue_comments_590258.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [tscrim](#comment%3A22):\n> If the patchbot comes back green, you can set a positive review on my behalf.\n\n\nStartup time warning, but I'm not dealing with any startup object, so I think it's not my fault.",
    "created_at": "2020-08-30T14:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590258",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'></a>Replying to [tscrim](#comment%3A22):
> If the patchbot comes back green, you can set a positive review on my behalf.


Startup time warning, but I'm not dealing with any startup object, so I think it's not my fault.



---

archive/issue_comments_590259.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-30T14:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590259",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_590260.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-09-02T06:11:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590260",
    "user": "https://github.com/kliem"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_590261.json:
```json
{
    "body": "<a id='comment:25'></a>merge conflict",
    "created_at": "2020-09-02T06:11:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590261",
    "user": "https://github.com/kliem"
}
```

<a id='comment:25'></a>merge conflict



---

archive/issue_comments_590262.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T06:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_590263.json:
```json
{
    "body": "Changing commit from \"ed6e966209266875d61895cf8112672675b17960\" to \"40e66678e274d9e6a45f140a8c8a1f19042582cd\"",
    "created_at": "2020-09-02T06:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ed6e966209266875d61895cf8112672675b17960" to "40e66678e274d9e6a45f140a8c8a1f19042582cd"



---

archive/issue_comments_590264.json:
```json
{
    "body": "Changing commit from \"40e66678e274d9e6a45f140a8c8a1f19042582cd\" to \"242cba7416b504da86d2f8f9c3712a9a9e7b6438\"",
    "created_at": "2020-09-02T06:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590264",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "40e66678e274d9e6a45f140a8c8a1f19042582cd" to "242cba7416b504da86d2f8f9c3712a9a9e7b6438"



---

archive/issue_comments_590265.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T06:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590265",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_590266.json:
```json
{
    "body": "<a id='comment:28'></a>Tests still pass. It really appears to be a question in what order you merge.",
    "created_at": "2020-09-02T06:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590266",
    "user": "https://github.com/kliem"
}
```

<a id='comment:28'></a>Tests still pass. It really appears to be a question in what order you merge.



---

archive/issue_comments_590267.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-09-02T06:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590267",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_590268.json:
```json
{
    "body": "Changing commit from \"242cba7416b504da86d2f8f9c3712a9a9e7b6438\" to \"63b7bd60cfc649e3d4448f970295eb7b7a977adf\"",
    "created_at": "2020-09-09T08:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590268",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "242cba7416b504da86d2f8f9c3712a9a9e7b6438" to "63b7bd60cfc649e3d4448f970295eb7b7a977adf"



---

archive/issue_comments_590269.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-09-09T08:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590269",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_590270.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:",
    "created_at": "2020-09-09T08:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590270",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:



---

archive/issue_comments_590271.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-09T08:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590271",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_590272.json:
```json
{
    "body": "<a id='comment:30'></a>Rebased.",
    "created_at": "2020-09-09T08:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590272",
    "user": "https://github.com/kliem"
}
```

<a id='comment:30'></a>Rebased.



---

archive/issue_events_077251.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30040#event-77251"
}
```



---

archive/issue_events_077252.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-15T22:47:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30040#event-77252"
}
```



---

archive/issue_comments_590273.json:
```json
{
    "body": "Changing branch from \"public/30040-reb2\" to \"63b7bd60cfc649e3d4448f970295eb7b7a977adf\"",
    "created_at": "2020-11-15T22:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590273",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/30040-reb2" to "63b7bd60cfc649e3d4448f970295eb7b7a977adf"



---

archive/issue_comments_590274.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-15T22:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30040#issuecomment-590274",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
