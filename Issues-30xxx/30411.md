# Issue 30411: src/tox.ini: Add environment pyright

archive/issues_030174.json:
```json
{
    "body": "(from #30408)\n\nWe add the command `sage -tox -e pyright` for static type checking.\n\npyright is implemented in javascript. \nWe install it via the unofficial pip-installable package https://pypi.org/project/pyright/\n\nReferences:\n- \u200bhttps://pypi.org/project/nodeenv/\n- https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini\n- https://opendev.org/zuul/zuul/src/branch/master/tools/pip.sh\n- https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21\n\nCC:  @tobiasdiez @fchapoton\n\nBranch/Commit: a2e56de453fdc6dd3ea90b8e8b9d5064a289c132\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30411\n\n",
    "closed_at": "2022-04-10T13:12:48Z",
    "created_at": "2020-08-20T22:45:57Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "src/tox.ini: Add environment pyright",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30411",
    "user": "https://github.com/mkoeppe"
}
```
(from #30408)

We add the command `sage -tox -e pyright` for static type checking.

pyright is implemented in javascript. 
We install it via the unofficial pip-installable package https://pypi.org/project/pyright/

References:
- ​https://pypi.org/project/nodeenv/
- https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini
- https://opendev.org/zuul/zuul/src/branch/master/tools/pip.sh
- https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21

CC:  @tobiasdiez @fchapoton

Branch/Commit: a2e56de453fdc6dd3ea90b8e8b9d5064a289c132

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30411





---

archive/issue_comments_592900.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,9 @@\n (from #30408)\n \n+pyright is implemented in javascript. \n+Installation needs npm. \n+\n+\n+References:\n+- \u200bhttps://pypi.org/project/nodeenv/\n+- https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini\n``````\n",
    "created_at": "2020-08-20T22:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592900",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,9 @@
 (from #30408)
 
+pyright is implemented in javascript. 
+Installation needs npm. 
+
+
+References:
+- ​https://pypi.org/project/nodeenv/
+- https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini
``````




---

archive/issue_comments_592901.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30246\"",
    "created_at": "2020-08-27T02:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592901",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#30246"



---

archive/issue_comments_592902.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,4 @@\n References:\n - \u200bhttps://pypi.org/project/nodeenv/\n - https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini\n+- https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21\n``````\n",
    "created_at": "2020-08-27T13:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592902",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,4 @@
 References:
 - ​https://pypi.org/project/nodeenv/
 - https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini
+- https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21
``````




---

archive/issue_comments_592903.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,4 +7,5 @@\n References:\n - \u200bhttps://pypi.org/project/nodeenv/\n - https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini\n+- https://opendev.org/zuul/zuul/src/branch/master/tools/pip.sh\n - https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21\n``````\n",
    "created_at": "2020-08-30T04:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592903",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,4 +7,5 @@
 References:
 - ​https://pypi.org/project/nodeenv/
 - https://opendev.org/zuul/zuul/src/commit/fadd15a0015b9ae4cc5c4c375476aa4d2242f9d8/tox.ini
+- https://opendev.org/zuul/zuul/src/branch/master/tools/pip.sh
 - https://github.com/seek-oss/aec/blob/390f9c2e78407218fac0d79e350e83ea066f24cc/Makefile#L19-L21
``````




---

archive/issue_comments_592904.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/src_tox_ini__add_environment_pyright\"",
    "created_at": "2020-08-30T17:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592904",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/src_tox_ini__add_environment_pyright"



---

archive/issue_comments_592905.json:
```json
{
    "body": "Changing commit from \"\" to \"a717cd2c592fbf84afeef12435dcdbbc288f1ba5\"",
    "created_at": "2020-08-30T17:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592905",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "a717cd2c592fbf84afeef12435dcdbbc288f1ba5"



---

archive/issue_comments_592906.json:
```json
{
    "body": "Changing dependencies from \"#30246\" to \"#30246, #30361, #30467\"",
    "created_at": "2020-08-30T17:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592906",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30246" to "#30246, #30361, #30467"



---

archive/issue_comments_592907.json:
```json
{
    "body": "<a id='comment:6'></a>\nHere's a version that succeeds in installing `pyright` (in the toxenv). But then testing does not work because it also needs to import sage.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[939e9e0](https://github.com/sagemath/sagetrac-mirror/commit/939e9e0e08d7d5c4e4c073a571ca8e4aac22ef77)|`src/tox.ini: Better default arg testenv:pycodestyle`|\n|[583bde5](https://github.com/sagemath/sagetrac-mirror/commit/583bde5acd02de68d120ca9af664ba401f7948a4)|`Merge branch 't/30408/public/build/pycodestyleConfig' into t/30410/command__sage__tox_`|\n|[8574448](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)|`src/tox.ini: Add coverage, startuptime; refactor, add descriptions`|\n|[eba708b](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)|`tox.ini: Delegate doctest, coverage, startuptime, pycodestyle to src/tox.ini`|\n|[df7ef3f](https://github.com/sagemath/sagetrac-mirror/commit/df7ef3f53373f3530843fbf014d0a50150d6a7ea)|`Merge branch 't/30410/command__sage__tox_' into t/30467/src_tox_ini__check_patchbot_plugin_patterns`|\n|[7e9d12d](https://github.com/sagemath/sagetrac-mirror/commit/7e9d12d7ddb7e579103eac30168e524441aa696c)|`src/tox.ini: New environment relint`|\n|[4a3a33a](https://github.com/sagemath/sagetrac-mirror/commit/4a3a33ac817e410d428ea5179fd42810e26185e9)|`Add comment`|\n|[b0ad03e](https://github.com/sagemath/sagetrac-mirror/commit/b0ad03e0932500900a64793c8ddb9c8fe2b2d4cf)|`src/bin/sage: Show tox environment list in 'sage -advanced'`|\n|[23753a9](https://github.com/sagemath/sagetrac-mirror/commit/23753a965dd0b421d5801917d1d7867cd49dc9c6)|`Merge branch 't/30467/src_tox_ini__check_patchbot_plugin_patterns' into t/30411/src_tox_ini__add_environment_pyright`|\n|[a717cd2](https://github.com/sagemath/sagetrac-mirror/commit/a717cd2c592fbf84afeef12435dcdbbc288f1ba5)|`WIP: src/.tox.ini: Add testenv:pyright`|",
    "created_at": "2020-08-30T17:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592907",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Here's a version that succeeds in installing `pyright` (in the toxenv). But then testing does not work because it also needs to import sage.

---
Last 10 new commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[939e9e0](https://github.com/sagemath/sagetrac-mirror/commit/939e9e0e08d7d5c4e4c073a571ca8e4aac22ef77)|`src/tox.ini: Better default arg testenv:pycodestyle`|
|[583bde5](https://github.com/sagemath/sagetrac-mirror/commit/583bde5acd02de68d120ca9af664ba401f7948a4)|`Merge branch 't/30408/public/build/pycodestyleConfig' into t/30410/command__sage__tox_`|
|[8574448](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)|`src/tox.ini: Add coverage, startuptime; refactor, add descriptions`|
|[eba708b](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)|`tox.ini: Delegate doctest, coverage, startuptime, pycodestyle to src/tox.ini`|
|[df7ef3f](https://github.com/sagemath/sagetrac-mirror/commit/df7ef3f53373f3530843fbf014d0a50150d6a7ea)|`Merge branch 't/30410/command__sage__tox_' into t/30467/src_tox_ini__check_patchbot_plugin_patterns`|
|[7e9d12d](https://github.com/sagemath/sagetrac-mirror/commit/7e9d12d7ddb7e579103eac30168e524441aa696c)|`src/tox.ini: New environment relint`|
|[4a3a33a](https://github.com/sagemath/sagetrac-mirror/commit/4a3a33ac817e410d428ea5179fd42810e26185e9)|`Add comment`|
|[b0ad03e](https://github.com/sagemath/sagetrac-mirror/commit/b0ad03e0932500900a64793c8ddb9c8fe2b2d4cf)|`src/bin/sage: Show tox environment list in 'sage -advanced'`|
|[23753a9](https://github.com/sagemath/sagetrac-mirror/commit/23753a965dd0b421d5801917d1d7867cd49dc9c6)|`Merge branch 't/30467/src_tox_ini__check_patchbot_plugin_patterns' into t/30411/src_tox_ini__add_environment_pyright`|
|[a717cd2](https://github.com/sagemath/sagetrac-mirror/commit/a717cd2c592fbf84afeef12435dcdbbc288f1ba5)|`WIP: src/.tox.ini: Add testenv:pyright`|



---

archive/issue_events_096784.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96784"
}
```



---

archive/issue_events_096785.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96785"
}
```



---

archive/issue_events_096786.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96786"
}
```



---

archive/issue_comments_592908.json:
```json
{
    "body": "<a id='comment:8'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592908",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_096787.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96787"
}
```



---

archive/issue_events_096788.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96788"
}
```



---

archive/issue_comments_592909.json:
```json
{
    "body": "Changing commit from \"a717cd2c592fbf84afeef12435dcdbbc288f1ba5\" to \"93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68\"",
    "created_at": "2021-08-14T18:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a717cd2c592fbf84afeef12435dcdbbc288f1ba5" to "93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68"



---

archive/issue_comments_592910.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[93eb7f4](https://github.com/sagemath/sagetrac-mirror/commit/93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68)|`WIP: src/.tox.ini: Add testenv:pyright`|",
    "created_at": "2021-08-14T18:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[93eb7f4](https://github.com/sagemath/sagetrac-mirror/commit/93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68)|`WIP: src/.tox.ini: Add testenv:pyright`|



---

archive/issue_comments_592911.json:
```json
{
    "body": "<a id='comment:11'></a>\nrebased",
    "created_at": "2021-08-14T18:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592911",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
rebased



---

archive/issue_comments_592912.json:
```json
{
    "body": "Changing dependencies from \"#30246, #30361, #30467\" to \"\"",
    "created_at": "2021-08-14T19:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592912",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30246, #30361, #30467" to ""



---

archive/issue_events_096789.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96789"
}
```



---

archive/issue_events_096790.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96790"
}
```



---

archive/issue_comments_592913.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis can now be simplified using https://pypi.org/project/pyright/",
    "created_at": "2022-03-20T22:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592913",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
This can now be simplified using https://pypi.org/project/pyright/



---

archive/issue_comments_592914.json:
```json
{
    "body": "Changing commit from \"93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68\" to \"70bf65238f3185bdba09a709023f25d8d25db21c\"",
    "created_at": "2022-03-20T23:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592914",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "93eb7f48f131ec0ddbd0032e6d8b1b7c82a49b68" to "70bf65238f3185bdba09a709023f25d8d25db21c"



---

archive/issue_comments_592915.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[a3d301c](https://github.com/sagemath/sagetrac-mirror/commit/a3d301cf5a6d311c191d6ec4ffb92ae26211d1eb)|`WIP: src/.tox.ini: Add testenv:pyright`|\n|[70bf652](https://github.com/sagemath/sagetrac-mirror/commit/70bf65238f3185bdba09a709023f25d8d25db21c)|`src/tox.ini (pyright): Use pypi package pyright`|",
    "created_at": "2022-03-20T23:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592915",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[a3d301c](https://github.com/sagemath/sagetrac-mirror/commit/a3d301cf5a6d311c191d6ec4ffb92ae26211d1eb)|`WIP: src/.tox.ini: Add testenv:pyright`|
|[70bf652](https://github.com/sagemath/sagetrac-mirror/commit/70bf65238f3185bdba09a709023f25d8d25db21c)|`src/tox.ini (pyright): Use pypi package pyright`|



---

archive/issue_comments_592916.json:
```json
{
    "body": "Changing commit from \"70bf65238f3185bdba09a709023f25d8d25db21c\" to \"71649fe5a230fd1066424ac228628930a5e4dca8\"",
    "created_at": "2022-03-20T23:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "70bf65238f3185bdba09a709023f25d8d25db21c" to "71649fe5a230fd1066424ac228628930a5e4dca8"



---

archive/issue_comments_592917.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[71649fe](https://github.com/sagemath/sagetrac-mirror/commit/71649fe5a230fd1066424ac228628930a5e4dca8)|`tox.ini (pyright): Fixup`|",
    "created_at": "2022-03-20T23:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[71649fe](https://github.com/sagemath/sagetrac-mirror/commit/71649fe5a230fd1066424ac228628930a5e4dca8)|`tox.ini (pyright): Fixup`|



---

archive/issue_comments_592918.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n (from #30408)\n \n pyright is implemented in javascript. \n-Installation needs npm. \n-\n+We install it via the unofficial pip-installable package https://pypi.org/project/pyright/\n \n References:\n - \u200bhttps://pypi.org/project/nodeenv/\n``````\n",
    "created_at": "2022-03-20T23:22:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592918",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 (from #30408)
 
 pyright is implemented in javascript. 
-Installation needs npm. 
-
+We install it via the unofficial pip-installable package https://pypi.org/project/pyright/
 
 References:
 - ​https://pypi.org/project/nodeenv/
``````




---

archive/issue_comments_592919.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-03-20T23:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592919",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_592920.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-20T23:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592920",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_592921.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[2707251](https://github.com/sagemath/sagetrac-mirror/commit/2707251b4b0365581494278fd94c475190386691)|`WIP: src/.tox.ini: Add testenv:pyright`|\n|[1f39c9b](https://github.com/sagemath/sagetrac-mirror/commit/1f39c9bda59df9a26a18b846d0f8710d8813ee14)|`src/tox.ini (pyright): Use pypi package pyright`|\n|[f9c25eb](https://github.com/sagemath/sagetrac-mirror/commit/f9c25ebdbb9e57954ce050b21b4c44deb00df5f9)|`tox.ini (pyright): Fixup`|\n|[79d7c38](https://github.com/sagemath/sagetrac-mirror/commit/79d7c38e8847c49c591ac29969e6cbe29480969d)|`Readd pyright and fix small errors`|\n|[2f7d295](https://github.com/sagemath/sagetrac-mirror/commit/2f7d2959f98a8ae4c66f6115f3ebc143850a3b30)|`Demote missing imports to warning for now as well`|",
    "created_at": "2022-03-21T01:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592921",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[2707251](https://github.com/sagemath/sagetrac-mirror/commit/2707251b4b0365581494278fd94c475190386691)|`WIP: src/.tox.ini: Add testenv:pyright`|
|[1f39c9b](https://github.com/sagemath/sagetrac-mirror/commit/1f39c9bda59df9a26a18b846d0f8710d8813ee14)|`src/tox.ini (pyright): Use pypi package pyright`|
|[f9c25eb](https://github.com/sagemath/sagetrac-mirror/commit/f9c25ebdbb9e57954ce050b21b4c44deb00df5f9)|`tox.ini (pyright): Fixup`|
|[79d7c38](https://github.com/sagemath/sagetrac-mirror/commit/79d7c38e8847c49c591ac29969e6cbe29480969d)|`Readd pyright and fix small errors`|
|[2f7d295](https://github.com/sagemath/sagetrac-mirror/commit/2f7d2959f98a8ae4c66f6115f3ebc143850a3b30)|`Demote missing imports to warning for now as well`|



---

archive/issue_comments_592922.json:
```json
{
    "body": "Changing commit from \"71649fe5a230fd1066424ac228628930a5e4dca8\" to \"2f7d2959f98a8ae4c66f6115f3ebc143850a3b30\"",
    "created_at": "2022-03-21T01:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "71649fe5a230fd1066424ac228628930a5e4dca8" to "2f7d2959f98a8ae4c66f6115f3ebc143850a3b30"



---

archive/issue_comments_592923.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#33456\"",
    "created_at": "2022-03-21T03:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592923",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#33456"



---

archive/issue_comments_592924.json:
```json
{
    "body": "Changing commit from \"2f7d2959f98a8ae4c66f6115f3ebc143850a3b30\" to \"e92ad80a99f743f70c6d721b282644ab6c9e7e6a\"",
    "created_at": "2022-03-21T03:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2f7d2959f98a8ae4c66f6115f3ebc143850a3b30" to "e92ad80a99f743f70c6d721b282644ab6c9e7e6a"



---

archive/issue_comments_592925.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[aa4a951](https://github.com/sagemath/sagetrac-mirror/commit/aa4a951c77ef0292fcdb391dda25a7082abf4ab3)|`Readd pyright and fix small errors`|\n|[acad07c](https://github.com/sagemath/sagetrac-mirror/commit/acad07c21b79d1d163ca1ee8fe26bfb9368ea2d3)|`Demote missing imports to warning for now as well`|\n|[e92ad80](https://github.com/sagemath/sagetrac-mirror/commit/e92ad80a99f743f70c6d721b282644ab6c9e7e6a)|`Merge #33456`|",
    "created_at": "2022-03-21T03:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592925",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[aa4a951](https://github.com/sagemath/sagetrac-mirror/commit/aa4a951c77ef0292fcdb391dda25a7082abf4ab3)|`Readd pyright and fix small errors`|
|[acad07c](https://github.com/sagemath/sagetrac-mirror/commit/acad07c21b79d1d163ca1ee8fe26bfb9368ea2d3)|`Demote missing imports to warning for now as well`|
|[e92ad80](https://github.com/sagemath/sagetrac-mirror/commit/e92ad80a99f743f70c6d721b282644ab6c9e7e6a)|`Merge #33456`|



---

archive/issue_comments_592926.json:
```json
{
    "body": "<a id='comment:22'></a>\nLocally (macOS), `./sage -tox -e pyright` (in a build with `./configure --enable-editable`) ends with \n\n```\nFATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory\n```",
    "created_at": "2022-03-21T03:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592926",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Locally (macOS), `./sage -tox -e pyright` (in a build with `./configure --enable-editable`) ends with 

```
FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
```



---

archive/issue_comments_592927.json:
```json
{
    "body": "Changing commit from \"e92ad80a99f743f70c6d721b282644ab6c9e7e6a\" to \"3277d2924805c5090ed19b32b2fe4a56a70352f0\"",
    "created_at": "2022-03-31T03:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e92ad80a99f743f70c6d721b282644ab6c9e7e6a" to "3277d2924805c5090ed19b32b2fe4a56a70352f0"



---

archive/issue_comments_592928.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[d20fcd5](https://github.com/sagemath/sagetrac-mirror/commit/d20fcd58bc3060c995dfaa539ec91faa86580b34)|`WIP: src/.tox.ini: Add testenv:pyright`|\n|[f837b3a](https://github.com/sagemath/sagetrac-mirror/commit/f837b3a626bc5a199740291f191543c0a198dfc1)|`src/tox.ini (pyright): Use pypi package pyright`|\n|[4ae0668](https://github.com/sagemath/sagetrac-mirror/commit/4ae066815f8d4a2f67509e24e20b0298d8b15f36)|`tox.ini (pyright): Fixup`|\n|[3277d29](https://github.com/sagemath/sagetrac-mirror/commit/3277d2924805c5090ed19b32b2fe4a56a70352f0)|`src/tox.ini (pyright): Run it in its own toxenv; default to running on sage.manifolds only`|",
    "created_at": "2022-03-31T03:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[d20fcd5](https://github.com/sagemath/sagetrac-mirror/commit/d20fcd58bc3060c995dfaa539ec91faa86580b34)|`WIP: src/.tox.ini: Add testenv:pyright`|
|[f837b3a](https://github.com/sagemath/sagetrac-mirror/commit/f837b3a626bc5a199740291f191543c0a198dfc1)|`src/tox.ini (pyright): Use pypi package pyright`|
|[4ae0668](https://github.com/sagemath/sagetrac-mirror/commit/4ae066815f8d4a2f67509e24e20b0298d8b15f36)|`tox.ini (pyright): Fixup`|
|[3277d29](https://github.com/sagemath/sagetrac-mirror/commit/3277d2924805c5090ed19b32b2fe4a56a70352f0)|`src/tox.ini (pyright): Run it in its own toxenv; default to running on sage.manifolds only`|



---

archive/issue_comments_592929.json:
```json
{
    "body": "Changing dependencies from \"#33456\" to \"\"",
    "created_at": "2022-03-31T03:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592929",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#33456" to ""



---

archive/issue_comments_592930.json:
```json
{
    "body": "<a id='comment:25'></a>\n`sage -tox -e pyright` now works well for me.\n\nHowever, `pyright` outputs lots of nonsensical warnings, so I am not adding it to the list of tox environments that will be tested by default if one just uses `sage -tox`.",
    "created_at": "2022-03-31T03:26:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592930",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
`sage -tox -e pyright` now works well for me.

However, `pyright` outputs lots of nonsensical warnings, so I am not adding it to the list of tox environments that will be tested by default if one just uses `sage -tox`.



---

archive/issue_comments_592931.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n (from #30408)\n+\n+We add the command `sage -tox -e pyright` for static type checking.\n \n pyright is implemented in javascript. \n We install it via the unofficial pip-installable package https://pypi.org/project/pyright/\n``````\n",
    "created_at": "2022-03-31T03:26:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592931",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 (from #30408)
+
+We add the command `sage -tox -e pyright` for static type checking.
 
 pyright is implemented in javascript. 
 We install it via the unofficial pip-installable package https://pypi.org/project/pyright/
``````




---

archive/issue_comments_592932.json:
```json
{
    "body": "Changing commit from \"3277d2924805c5090ed19b32b2fe4a56a70352f0\" to \"ef0eeb7897716b786073b54696234720cad11867\"",
    "created_at": "2022-03-31T14:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3277d2924805c5090ed19b32b2fe4a56a70352f0" to "ef0eeb7897716b786073b54696234720cad11867"



---

archive/issue_comments_592933.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[ef0eeb7](https://github.com/sagemath/sagetrac-mirror/commit/ef0eeb7897716b786073b54696234720cad11867)|`src/doc/en/developer/tools.rst: Update section on pyright`|",
    "created_at": "2022-03-31T14:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592933",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[ef0eeb7](https://github.com/sagemath/sagetrac-mirror/commit/ef0eeb7897716b786073b54696234720cad11867)|`src/doc/en/developer/tools.rst: Update section on pyright`|



---

archive/issue_comments_592934.json:
```json
{
    "body": "<a id='comment:27'></a>\nReady for review",
    "created_at": "2022-04-01T16:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592934",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Ready for review



---

archive/issue_comments_592935.json:
```json
{
    "body": "<a id='comment:28'></a>\n> - (for manual use or use with VS Code:) ``npm install -g pyright``, see `documentation <https://github.com/microsoft/pyright#installation>`__ for details.\n\n\nYou don't have to install pyright manually for use in vscode, its done via the pylance extension (providing such a seamless integration with vs code was one of the reasons why pyright is written in ts).",
    "created_at": "2022-04-01T17:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592935",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:28'></a>
> - (for manual use or use with VS Code:) ``npm install -g pyright``, see `documentation <https://github.com/microsoft/pyright#installation>`__ for details.


You don't have to install pyright manually for use in vscode, its done via the pylance extension (providing such a seamless integration with vs code was one of the reasons why pyright is written in ts).



---

archive/issue_comments_592936.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|\n|[ec45888](https://github.com/sagemath/sagetrac-mirror/commit/ec4588800e2fd278266b447fff095e36a2aa1b87)|`src/doc/en/developer/tools.rst: no need to install pyright manually for use in vscode`|",
    "created_at": "2022-04-01T17:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
|[ec45888](https://github.com/sagemath/sagetrac-mirror/commit/ec4588800e2fd278266b447fff095e36a2aa1b87)|`src/doc/en/developer/tools.rst: no need to install pyright manually for use in vscode`|



---

archive/issue_comments_592937.json:
```json
{
    "body": "Changing commit from \"ef0eeb7897716b786073b54696234720cad11867\" to \"ec4588800e2fd278266b447fff095e36a2aa1b87\"",
    "created_at": "2022-04-01T17:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ef0eeb7897716b786073b54696234720cad11867" to "ec4588800e2fd278266b447fff095e36a2aa1b87"



---

archive/issue_comments_592938.json:
```json
{
    "body": "<a id='comment:30'></a>\nThanks for the update.\n\nWith the current config, `tox -e pyright` still uses the `venv` symlink to resolve imports etc. Wouldn't it be more in the spirit of tox to install sagelib in the tox env and use that as a reference for imports? \n\nFor example, without a properly setup `venv`, `tox -e pyright` for example complains\n\n```\n  /workspace/sagetrac-mirror/src/sage/manifolds/subsets/pullback.py:302:22 - warning: Import \"ppl\" could not be resolved (reportMissingImports)\n  /workspace/sagetrac-mirror/src/sage/manifolds/subsets/pullback.py:827:26 - warning: Import \"ppl\" could not be resolved (reportMissingImports)\n```\nThese are not displayed if `venv` is setup correctly.\n\nAlso, why do you need `SAGE_LOCAL` for pyright/in the tox env?",
    "created_at": "2022-04-01T18:15:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592938",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:30'></a>
Thanks for the update.

With the current config, `tox -e pyright` still uses the `venv` symlink to resolve imports etc. Wouldn't it be more in the spirit of tox to install sagelib in the tox env and use that as a reference for imports? 

For example, without a properly setup `venv`, `tox -e pyright` for example complains

```
  /workspace/sagetrac-mirror/src/sage/manifolds/subsets/pullback.py:302:22 - warning: Import "ppl" could not be resolved (reportMissingImports)
  /workspace/sagetrac-mirror/src/sage/manifolds/subsets/pullback.py:827:26 - warning: Import "ppl" could not be resolved (reportMissingImports)
```
These are not displayed if `venv` is setup correctly.

Also, why do you need `SAGE_LOCAL` for pyright/in the tox env?



---

archive/issue_comments_592939.json:
```json
{
    "body": "<a id='comment:31'></a>\nIt's likely that I am confused about what pyright does with venvs. This is coming back to #33456#comment:10 - the current configuration in pyrightconfig.json makes no sense to me when I read the documentation of pyright.",
    "created_at": "2022-04-01T18:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592939",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
It's likely that I am confused about what pyright does with venvs. This is coming back to #33456#comment:10 - the current configuration in pyrightconfig.json makes no sense to me when I read the documentation of pyright.



---

archive/issue_comments_592940.json:
```json
{
    "body": "<a id='comment:32'></a>\nThat config is also highly confusing, and took me quite some time to understand.\n\n`venvPath` is the path where all venv's are supposed to be, and `venv` is then a path relative to this path selecting a certain venv.\nSo with `venvPath = /home/venvs` and `venv = ./a`, the venv is supposed to be in `/home/venvs/a`.\n\nThe code explains this better then the docs:\nhttps://github.com/microsoft/pyright/blob/fa4194fd8b0e6d9fb970468e50a974e0d4eeee5c/packages/pyright-internal/src/analyzer/pythonPathUtils.ts#L72-L73\n\nSo I guess you only have to set venvPath in the cli to the tox venv, and everything should work.",
    "created_at": "2022-04-01T18:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592940",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:32'></a>
That config is also highly confusing, and took me quite some time to understand.

`venvPath` is the path where all venv's are supposed to be, and `venv` is then a path relative to this path selecting a certain venv.
So with `venvPath = /home/venvs` and `venv = ./a`, the venv is supposed to be in `/home/venvs/a`.

The code explains this better then the docs:
https://github.com/microsoft/pyright/blob/fa4194fd8b0e6d9fb970468e50a974e0d4eeee5c/packages/pyright-internal/src/analyzer/pythonPathUtils.ts#L72-L73

So I guess you only have to set venvPath in the cli to the tox venv, and everything should work.



---

archive/issue_comments_592941.json:
```json
{
    "body": "<a id='comment:33'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[42b4c24](https://github.com/sagemath/sagetrac-mirror/commit/42b4c24955567fc2e3e06159ed74fcab8dc0c325)|`WIP: src/.tox.ini: Add testenv:pyright`|\n|[7b64334](https://github.com/sagemath/sagetrac-mirror/commit/7b6433475e9e5b4cf15aa9723ad2b138c2f8b456)|`src/tox.ini (pyright): Use pypi package pyright`|\n|[db7dba6](https://github.com/sagemath/sagetrac-mirror/commit/db7dba6f15b23ffccbdda0fdb03ba460dcf8f84a)|`tox.ini (pyright): Fixup`|\n|[a20e6b5](https://github.com/sagemath/sagetrac-mirror/commit/a20e6b58a2b4925c9208ba433902b96d1e06d6b4)|`src/tox.ini (pyright): Run it in its own toxenv; default to running on sage.manifolds only`|\n|[0ec81a5](https://github.com/sagemath/sagetrac-mirror/commit/0ec81a57025e946585124953e86086ec1762b084)|`src/doc/en/developer/tools.rst: Update section on pyright`|\n|[ebdd23d](https://github.com/sagemath/sagetrac-mirror/commit/ebdd23d26479c6abdf802fd095b202c19c846be6)|`src/doc/en/developer/tools.rst: no need to install pyright manually for use in vscode`|\n|[a2e56de](https://github.com/sagemath/sagetrac-mirror/commit/a2e56de453fdc6dd3ea90b8e8b9d5064a289c132)|`src/tox.ini (pyright): Pin pyright version`|",
    "created_at": "2022-04-03T16:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[42b4c24](https://github.com/sagemath/sagetrac-mirror/commit/42b4c24955567fc2e3e06159ed74fcab8dc0c325)|`WIP: src/.tox.ini: Add testenv:pyright`|
|[7b64334](https://github.com/sagemath/sagetrac-mirror/commit/7b6433475e9e5b4cf15aa9723ad2b138c2f8b456)|`src/tox.ini (pyright): Use pypi package pyright`|
|[db7dba6](https://github.com/sagemath/sagetrac-mirror/commit/db7dba6f15b23ffccbdda0fdb03ba460dcf8f84a)|`tox.ini (pyright): Fixup`|
|[a20e6b5](https://github.com/sagemath/sagetrac-mirror/commit/a20e6b58a2b4925c9208ba433902b96d1e06d6b4)|`src/tox.ini (pyright): Run it in its own toxenv; default to running on sage.manifolds only`|
|[0ec81a5](https://github.com/sagemath/sagetrac-mirror/commit/0ec81a57025e946585124953e86086ec1762b084)|`src/doc/en/developer/tools.rst: Update section on pyright`|
|[ebdd23d](https://github.com/sagemath/sagetrac-mirror/commit/ebdd23d26479c6abdf802fd095b202c19c846be6)|`src/doc/en/developer/tools.rst: no need to install pyright manually for use in vscode`|
|[a2e56de](https://github.com/sagemath/sagetrac-mirror/commit/a2e56de453fdc6dd3ea90b8e8b9d5064a289c132)|`src/tox.ini (pyright): Pin pyright version`|



---

archive/issue_comments_592942.json:
```json
{
    "body": "Changing commit from \"ec4588800e2fd278266b447fff095e36a2aa1b87\" to \"a2e56de453fdc6dd3ea90b8e8b9d5064a289c132\"",
    "created_at": "2022-04-03T16:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ec4588800e2fd278266b447fff095e36a2aa1b87" to "a2e56de453fdc6dd3ea90b8e8b9d5064a289c132"



---

archive/issue_comments_592943.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2022-04-05T08:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592943",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_592944.json:
```json
{
    "body": "<a id='comment:34'></a>\nlgtm",
    "created_at": "2022-04-05T08:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592944",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
lgtm



---

archive/issue_comments_592945.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-04-05T08:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592945",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_592946.json:
```json
{
    "body": "<a id='comment:35'></a>\nThanks",
    "created_at": "2022-04-05T18:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592946",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Thanks



---

archive/issue_events_096791.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-10T13:12:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30411#event-96791"
}
```



---

archive/issue_comments_592947.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/src_tox_ini__add_environment_pyright\" to \"a2e56de453fdc6dd3ea90b8e8b9d5064a289c132\"",
    "created_at": "2022-04-10T13:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592947",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/src_tox_ini__add_environment_pyright" to "a2e56de453fdc6dd3ea90b8e8b9d5064a289c132"



---

archive/issue_comments_592948.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-04-10T13:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30411#issuecomment-592948",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
