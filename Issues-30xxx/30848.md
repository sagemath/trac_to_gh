# Issue 30848: fix conversion of sign function to fricas

archive/issues_030848.json:
```json
{
    "body": "CC:  @mantepse\n\nKeywords: FriCAS\n\nwhich apparently has no symbolic sign function\n\nIssue created by migration from https://trac.sagemath.org/ticket/31085\n\n",
    "closed_at": "2020-12-27T00:22:40Z",
    "created_at": "2020-12-19T20:13:53Z",
    "labels": [
        "component: interfaces: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "fix conversion of sign function to fricas",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30848",
    "user": "https://github.com/fchapoton"
}
```
CC:  @mantepse

Keywords: FriCAS

which apparently has no symbolic sign function

Issue created by migration from https://trac.sagemath.org/ticket/31085





---

archive/issue_comments_440419.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440419",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_440420.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440420",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_440421.json:
```json
{
    "body": "I don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.",
    "created_at": "2020-12-19T20:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440421",
    "user": "https://github.com/mantepse"
}
```

I don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.



---

archive/issue_comments_440422.json:
```json
{
    "body": "I was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is \"sign\", which cannot handle symbolic arguments.\n\nBut then apparently, Fricas cannot integrate functions containing abs.",
    "created_at": "2020-12-19T20:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440422",
    "user": "https://github.com/fchapoton"
}
```

I was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is "sign", which cannot handle symbolic arguments.

But then apparently, Fricas cannot integrate functions containing abs.



---

archive/issue_comments_440423.json:
```json
{
    "body": "Yes, that's correct (as far as I know).\n\nSo, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)",
    "created_at": "2020-12-19T20:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440423",
    "user": "https://github.com/mantepse"
}
```

Yes, that's correct (as far as I know).

So, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)



---

archive/issue_comments_440424.json:
```json
{
    "body": "Well, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?",
    "created_at": "2020-12-21T08:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440424",
    "user": "https://github.com/fchapoton"
}
```

Well, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?



---

archive/issue_comments_440425.json:
```json
{
    "body": "Sorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.",
    "created_at": "2020-12-21T09:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440425",
    "user": "https://github.com/mantepse"
}
```

Sorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.



---

archive/issue_comments_440426.json:
```json
{
    "body": "Changing keywords from \"\" to \"FriCAS\".",
    "created_at": "2020-12-21T09:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440426",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "" to "FriCAS".



---

archive/issue_comments_440427.json:
```json
{
    "body": "Here is a trival test, do you want to add it?\n\n```\nsage: fricas(sign(x)).eval(x=-3)\n- 1\n```\n\nOther than that, it looks good.  There is currently a giac failure, which I cannot say anything about.",
    "created_at": "2020-12-21T18:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440427",
    "user": "https://github.com/mantepse"
}
```

Here is a trival test, do you want to add it?

```
sage: fricas(sign(x)).eval(x=-3)
- 1
```

Other than that, it looks good.  There is currently a giac failure, which I cannot say anything about.



---

archive/issue_comments_440428.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-21T20:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_440429.json:
```json
{
    "body": "Voil\u00e0 !",
    "created_at": "2020-12-21T20:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440429",
    "user": "https://github.com/fchapoton"
}
```

Voil√† !



---

archive/issue_comments_440430.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-21T20:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440430",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_440431.json:
```json
{
    "body": "Great, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.",
    "created_at": "2020-12-21T20:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440431",
    "user": "https://github.com/mantepse"
}
```

Great, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.



---

archive/issue_events_081154.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30848#event-81154"
}
```



---

archive/issue_comments_440432.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-27T00:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30848#issuecomment-440432",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
