# Issue 30319: Upgrade cddlib to fix wrong intersection of polytopes

archive/issues_030082.json:
```json
{
    "assignees": [],
    "body": "As reported in [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/514hUpM7pBY), the intersection of polytopes is sometimes very wrong\n\n```\na = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])\nb = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])\nc = a.intersection(b)\n```\nHere `c` should have been empty but is equal to `b`.\n\nWe fix it by upgrading to cddlib 0.94m, installing symlinks so that consumers of cddlib that have not been updated to work with the new header file locations (#29413) continue to work.\n\nCC:  @jplab @mkoeppe @dimpase @vbraun\n\nBranch/Commit: **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Matthias Koeppe, Dima Pasechnik**\n\nAuthor: **Jonathan Kliem, Matthias Koeppe**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30319_\n\n",
    "closed_at": "2021-04-01T19:45:17Z",
    "created_at": "2020-08-08T10:23:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade cddlib to fix wrong intersection of polytopes",
    "type": "issue",
    "updated_at": "2021-04-01T19:45:17Z",
    "url": "https://github.com/sagemath/sage/issues/30319",
    "user": "https://github.com/videlec"
}
```
As reported in [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/514hUpM7pBY), the intersection of polytopes is sometimes very wrong

```
a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])
b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])
c = a.intersection(b)
```
Here `c` should have been empty but is equal to `b`.

We fix it by upgrading to cddlib 0.94m, installing symlinks so that consumers of cddlib that have not been updated to work with the new header file locations (#29413) continue to work.

CC:  @jplab @mkoeppe @dimpase @vbraun

Branch/Commit: **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Matthias Koeppe, Dima Pasechnik**

Author: **Jonathan Kliem, Matthias Koeppe**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/30319_





---

archive/issue_events_419761.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-08-08T10:23:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419761"
}
```



---

archive/issue_events_419762.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-08-08T10:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419762"
}
```



---

archive/issue_events_419763.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-08-08T10:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419763"
}
```



---

archive/issue_events_419764.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-08-08T10:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419764"
}
```



---

archive/issue_events_419765.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T15:10:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419765"
}
```



---

archive/issue_events_419766.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T15:10:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419766"
}
```



---

archive/issue_comments_481098.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nLooks like a `cdd` bug.\n\n```\nsage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])\nsage: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])\nsage: a = a.change_ring(RDF)\nsage: new_eqns = a.equations() + b.equations()\nsage: new_ieqs = a.inequalities() + b.inequalities()\nsage: Polyhedron(eqns=new_eqns, ieqs=new_ieqs[1:2]+new_ieqs[4:5], verbose=True)\n---- CDD input -----\nH-representation\nlinearity 2 1 2\nbegin\n 5 4 real\n 0.0 0.0 1.0 1.0\n -1.0 0.0 1.0 1.0\n -1.0 2.0 -1.0 0.0\n -1.0 4.0 -2.0 0.0\n 1 0 0 0\nend\n\n---- CDD output -----\nCanonicalize the matrix.\nImplicit linearity rows are:\n\nRedundant rows are:1 3 5 \n\nNonredundant representation:\nThe new row positions are as follows (orig:new).\nEach redundant row has the new number 0.\nEach deleted duplicated row has a number nagative of the row that\nrepresents its equivalence class.\n 1:0 2:1 3:0 4:2 5:0\nH-representation\nlinearity 1  1\nbegin\n 2 4 real\n -1  0  1  1\n -1  4 -2  0\nend\n\nsize = 5 x 4\nNumber Type = real\n\n---- CDD input -----\nCanonicalize the matrix.\nImplicit linearity rows are:\n\nRedundant rows are:1 3 5 \n\nNonredundant representation:\nThe new row positions are as follows (orig:new).\nEach redundant row has the new number 0.\nEach deleted duplicated row has a number nagative of the row that\nrepresents its equivalence class.\n 1:0 2:1 3:0 4:2 5:0\nH-representation\nlinearity 1  1\nbegin\n 2 4 real\n -1  0  1  1\n -1  4 -2  0\nend\n\n---- CDD output -----\nThe second representation:\nV-representation\nlinearity 1  3\nbegin\n 3 4 real\n  0  1  0  0\n  1  7.500000000E-01  1  0\n  0 -5.000000000E-01 -1  1\nend\n\nVertex incidence\necd_file: Incidence of generators and inequalities\nbegin\n  3    3\n 1 -2 : 2 \n 2 -2 : 3 \n 3 -3 : \nend\n\nVertex adjacency\nead_file: Adjacency of generators\nbegin\n  3    3\n 1 1 : 2 \n 2 1 : 1 \n 3 0 : \nend\n\nThe first (input) representation\nH-representation\nlinearity 1  1\nbegin\n 2 4 real\n -1  0  1  1\n -1  4 -2  0\nend\n\nFacet incidence\nicd_file: Incidence of inequalities and generators\nbegin\n  3    3\n 1 -3 : \n 2 -2 : 1 \n 3 -2 : 2 \nend\n\nFacet adjacency\niad_file: Adjacency of inequalities\nbegin\n  3    3\n 1 -2 : 1 \n 2 -2 : 2 \n 3 -2 : 3 \nend\n\nsize = 2 x 4\nNumber Type = real\n\n---- CDD input -----\nThe second representation:\nV-representation\nlinearity 1  3\nbegin\n 3 4 real\n  0  1  0  0\n  1  7.500000000E-01  1  0\n  0 -5.000000000E-01 -1  1\nend\n---- CDD output -----\nThe second representation:\nH-representation\nlinearity 1  3\nbegin\n 3 4 real\n  1  0  0  0\n -1  4 -2  0\n -1  0  1  1\nend\n\nsize = 3 x 4\nNumber Type = real\n\nA 2-dimensional polyhedron in RDF^3 defined as the convex hull of 1 vertex, 1 ray, 1 line\n```\n\nFor some reason `cdd` thinks that row `1` is redundant. If you drop an inequality, everything is fine.",
    "created_at": "2020-08-10T10:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481098",
    "user": "https://github.com/kliem"
}
```

<div id="comment:2" align="right">comment:2</div>

Looks like a `cdd` bug.

```
sage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])
sage: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])
sage: a = a.change_ring(RDF)
sage: new_eqns = a.equations() + b.equations()
sage: new_ieqs = a.inequalities() + b.inequalities()
sage: Polyhedron(eqns=new_eqns, ieqs=new_ieqs[1:2]+new_ieqs[4:5], verbose=True)
---- CDD input -----
H-representation
linearity 2 1 2
begin
 5 4 real
 0.0 0.0 1.0 1.0
 -1.0 0.0 1.0 1.0
 -1.0 2.0 -1.0 0.0
 -1.0 4.0 -2.0 0.0
 1 0 0 0
end

---- CDD output -----
Canonicalize the matrix.
Implicit linearity rows are:

Redundant rows are:1 3 5 

Nonredundant representation:
The new row positions are as follows (orig:new).
Each redundant row has the new number 0.
Each deleted duplicated row has a number nagative of the row that
represents its equivalence class.
 1:0 2:1 3:0 4:2 5:0
H-representation
linearity 1  1
begin
 2 4 real
 -1  0  1  1
 -1  4 -2  0
end

size = 5 x 4
Number Type = real

---- CDD input -----
Canonicalize the matrix.
Implicit linearity rows are:

Redundant rows are:1 3 5 

Nonredundant representation:
The new row positions are as follows (orig:new).
Each redundant row has the new number 0.
Each deleted duplicated row has a number nagative of the row that
represents its equivalence class.
 1:0 2:1 3:0 4:2 5:0
H-representation
linearity 1  1
begin
 2 4 real
 -1  0  1  1
 -1  4 -2  0
end

---- CDD output -----
The second representation:
V-representation
linearity 1  3
begin
 3 4 real
  0  1  0  0
  1  7.500000000E-01  1  0
  0 -5.000000000E-01 -1  1
end

Vertex incidence
ecd_file: Incidence of generators and inequalities
begin
  3    3
 1 -2 : 2 
 2 -2 : 3 
 3 -3 : 
end

Vertex adjacency
ead_file: Adjacency of generators
begin
  3    3
 1 1 : 2 
 2 1 : 1 
 3 0 : 
end

The first (input) representation
H-representation
linearity 1  1
begin
 2 4 real
 -1  0  1  1
 -1  4 -2  0
end

Facet incidence
icd_file: Incidence of inequalities and generators
begin
  3    3
 1 -3 : 
 2 -2 : 1 
 3 -2 : 2 
end

Facet adjacency
iad_file: Adjacency of inequalities
begin
  3    3
 1 -2 : 1 
 2 -2 : 2 
 3 -2 : 3 
end

size = 2 x 4
Number Type = real

---- CDD input -----
The second representation:
V-representation
linearity 1  3
begin
 3 4 real
  0  1  0  0
  1  7.500000000E-01  1  0
  0 -5.000000000E-01 -1  1
end
---- CDD output -----
The second representation:
H-representation
linearity 1  3
begin
 3 4 real
  1  0  0  0
 -1  4 -2  0
 -1  0  1  1
end

size = 3 x 4
Number Type = real

A 2-dimensional polyhedron in RDF^3 defined as the convex hull of 1 vertex, 1 ray, 1 line
```

For some reason `cdd` thinks that row `1` is redundant. If you drop an inequality, everything is fine.



---

archive/issue_comments_481099.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCould someone please report it upstream (i do not have a github account) ?",
    "created_at": "2020-08-14T10:28:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481099",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:3" align="right">comment:3</div>

Could someone please report it upstream (i do not have a github account) ?



---

archive/issue_comments_481100.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2020-08-14T10:28:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481100",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_comments_481101.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nhttps://github.com/cddlib/cddlib/issues/45",
    "created_at": "2020-08-14T11:38:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481101",
    "user": "https://github.com/kliem"
}
```

<div id="comment:4" align="right">comment:4</div>

https://github.com/cddlib/cddlib/issues/45



---

archive/issue_comments_481102.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**",
    "created_at": "2020-08-14T11:38:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481102",
    "user": "https://github.com/kliem"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_481103.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNote that with data in [comment:2](#comment:2) one has\n\n```\nsage: Polyhedron(eqns=new_eqns)                                                                                                      \nThe empty polyhedron in RDF^3\n```\nso the emptiness should have been detected earlier.",
    "created_at": "2020-09-21T07:24:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481103",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Note that with data in [comment:2](#comment:2) one has

```
sage: Polyhedron(eqns=new_eqns)                                                                                                      
The empty polyhedron in RDF^3
```
so the emptiness should have been detected earlier.



---

archive/issue_comments_481104.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAre you proposing that we test whether the equations are infeasible ourselves as a workaround?\n\nSounds like a workaround that should work for us.\n\nIs `cdd` specifically excluding this case?",
    "created_at": "2020-09-21T07:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481104",
    "user": "https://github.com/kliem"
}
```

<div id="comment:6" align="right">comment:6</div>

Are you proposing that we test whether the equations are infeasible ourselves as a workaround?

Sounds like a workaround that should work for us.

Is `cdd` specifically excluding this case?



---

archive/issue_comments_481105.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSomething like\n\n```\nnew_eqns_matrix = matrix(new_eqns)\nfeasible_directions = new_eqns_matrix.right_kernel_matrix()\nif feasible_directions.column(0).is_zero():\n    initialize_empty_polyhedron()\n```\n\nshould work.",
    "created_at": "2020-09-21T08:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481105",
    "user": "https://github.com/kliem"
}
```

<div id="comment:7" align="right">comment:7</div>

Something like

```
new_eqns_matrix = matrix(new_eqns)
feasible_directions = new_eqns_matrix.right_kernel_matrix()
if feasible_directions.column(0).is_zero():
    initialize_empty_polyhedron()
```

should work.



---

archive/issue_comments_481106.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOn the other hand, with RDF data and the internal representation used by `cdd`, it is not so hard to come up with (ugly) examples on which it can fail to produce a meaningful answer.\n\nI'd say that computing `c` like in the ticket description should throw an error, \nas `a` is exact and `b` is not.\nOr at the very least print a warning like\n\n```\nsage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]],base_ring=RDF) \n....: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])                                                         \nsage: a.intersection(b)                                                                                                              \n/mnt/opt/Sage/sage-dev/local/lib/python3.8/site-packages/sage/geometry/polyhedron/backend_cdd.py:151: UserWarning: This polyhedron data is numerically complicated; cdd could not convert between the inexact V and H representation without loss of data. The resulting object might show inconsistencies.\n  warn(\"This polyhedron data is numerically complicated; cdd could not convert between the inexact V and H representation without loss of data. The resulting object might show inconsistencies.\")\nA 2-dimensional polyhedron in RDF^3 defined as the convex hull of 3 vertices\n```",
    "created_at": "2020-09-21T08:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481106",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

On the other hand, with RDF data and the internal representation used by `cdd`, it is not so hard to come up with (ugly) examples on which it can fail to produce a meaningful answer.

I'd say that computing `c` like in the ticket description should throw an error, 
as `a` is exact and `b` is not.
Or at the very least print a warning like

```
sage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]],base_ring=RDF) 
....: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])                                                         
sage: a.intersection(b)                                                                                                              
/mnt/opt/Sage/sage-dev/local/lib/python3.8/site-packages/sage/geometry/polyhedron/backend_cdd.py:151: UserWarning: This polyhedron data is numerically complicated; cdd could not convert between the inexact V and H representation without loss of data. The resulting object might show inconsistencies.
  warn("This polyhedron data is numerically complicated; cdd could not convert between the inexact V and H representation without loss of data. The resulting object might show inconsistencies.")
A 2-dimensional polyhedron in RDF^3 defined as the convex hull of 3 vertices
```



---

archive/issue_comments_481107.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nit's also weird that no warning is printed in this case:\n\n```\nsage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])\n....: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])      \n....: b.intersection(a)                                  \nA 2-dimensional polyhedron in RDF^3 defined as the convex hull of 3 vertices\n```\nas if seeing the exact `a` to intersect `b` with convinces cdd that everything should be fine.",
    "created_at": "2020-09-21T09:06:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481107",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

it's also weird that no warning is printed in this case:

```
sage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]])
....: b = Polyhedron([[0.0, -0.5, 1.5], [1.0, -0.5, 1.5], [1.0, 1.5, -0.5]])      
....: b.intersection(a)                                  
A 2-dimensional polyhedron in RDF^3 defined as the convex hull of 3 vertices
```
as if seeing the exact `a` to intersect `b` with convinces cdd that everything should be fine.



---

archive/issue_comments_481108.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThe behavior of coercing base rings is the correct and expected behaviour, I would say.\n\nThe failure of `cdd` has nothing to do with inexactness:\n\n```\nsage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]], backend='cdd')                                                                                                           \nsage: b = Polyhedron([[0, -1/2, 3/2], [1, -1/2, 3/2], [1, 3/2, -1/2]], backend='cdd')                                                                                               \nsage: a.intersection(b)                                                                                                                                                             \nA 2-dimensional polyhedron in QQ^3 defined as the convex hull of 3 vertices\n```",
    "created_at": "2020-09-21T09:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481108",
    "user": "https://github.com/kliem"
}
```

<div id="comment:10" align="right">comment:10</div>

The behavior of coercing base rings is the correct and expected behaviour, I would say.

The failure of `cdd` has nothing to do with inexactness:

```
sage: a = Polyhedron([[0, -1, 1], [1, -1, 1], [1, 1, -1]], backend='cdd')                                                                                                           
sage: b = Polyhedron([[0, -1/2, 3/2], [1, -1/2, 3/2], [1, 3/2, -1/2]], backend='cdd')                                                                                               
sage: a.intersection(b)                                                                                                                                                             
A 2-dimensional polyhedron in QQ^3 defined as the convex hull of 3 vertices
```



---

archive/issue_comments_481109.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n`cdd` for some reason determines that one of the equations is redundant. After this the calculation is correct. For this reason, no warning is printed. Because converting from Vrepresention to Hrepresentation works.\n\nThe output of `cdd` is numerical consistent, but incorrect.",
    "created_at": "2020-09-21T09:09:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481109",
    "user": "https://github.com/kliem"
}
```

<div id="comment:11" align="right">comment:11</div>

`cdd` for some reason determines that one of the equations is redundant. After this the calculation is correct. For this reason, no warning is printed. Because converting from Vrepresention to Hrepresentation works.

The output of `cdd` is numerical consistent, but incorrect.



---

archive/issue_comments_481110.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@kliem](#comment:10):\n> The behavior of coercing base rings is the correct and expected behaviour, I would say.\n> \n> The failure of `cdd` has nothing to do with inexactness:\n\nOK, I see, you're right - I thought it's an inexactness issue, such as computing rank of an RDF matrix, sorry.",
    "created_at": "2020-09-21T11:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481110",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@kliem](#comment:10):
> The behavior of coercing base rings is the correct and expected behaviour, I would say.
> 
> The failure of `cdd` has nothing to do with inexactness:

OK, I see, you're right - I thought it's an inexactness issue, such as computing rank of an RDF matrix, sorry.



---

archive/issue_comments_481111.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2020-09-21T13:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481111",
    "user": "https://github.com/kliem"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_events_419767.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419767"
}
```



---

archive/issue_events_419768.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419768"
}
```



---

archive/issue_comments_481112.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe fix is in \nhttps://github.com/cddlib/cddlib/releases/tag/0.94m\n\nlet's upgrade",
    "created_at": "2020-12-09T16:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481112",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

The fix is in 
https://github.com/cddlib/cddlib/releases/tag/0.94m

let's upgrade



---

archive/issue_comments_481113.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2020-12-09T16:09:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481113",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_481114.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHow important do we consider this bug. Should we reject older system installs?",
    "created_at": "2020-12-09T16:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481114",
    "user": "https://github.com/kliem"
}
```

<div id="comment:17" align="right">comment:17</div>

How important do we consider this bug. Should we reject older system installs?



---

archive/issue_comments_481115.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, in a later stable release.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2020-12-09T16:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481115",
    "user": "https://github.com/kliem"
}
```

Changed upstream from **Fixed upstream, in a later stable release.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_481116.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2020-12-09T16:13:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481116",
    "user": "https://github.com/kliem"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_481117.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOk, it warned me because of a conflict, but I did not expect it to change the description back.",
    "created_at": "2020-12-09T16:13:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481117",
    "user": "https://github.com/kliem"
}
```

<div id="comment:18" align="right">comment:18</div>

Ok, it warned me because of a conflict, but I did not expect it to change the description back.



---

archive/issue_comments_481118.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThere is a bug in latte_int with the new header location that needs fixing yet:\n\nhttps://github.com/latte-int/latte/issues/15",
    "created_at": "2020-12-09T16:45:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481118",
    "user": "https://github.com/kliem"
}
```

<div id="comment:19" align="right">comment:19</div>

There is a bug in latte_int with the new header location that needs fixing yet:

https://github.com/latte-int/latte/issues/15



---

archive/issue_comments_481119.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n@mkoeppe\n\nThere is already a patch for latte, but I'm incapable of creating a patch for latte-int not latte-integral.",
    "created_at": "2020-12-09T18:31:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481119",
    "user": "https://github.com/kliem"
}
```

<div id="comment:20" align="right">comment:20</div>

@mkoeppe

There is already a patch for latte, but I'm incapable of creating a patch for latte-int not latte-integral.



---

archive/issue_comments_481120.json:
```json
{
    "body": "Branch: **[public/30319](https://github.com/sagemath/sagetrac-mirror/tree/public/30319)**",
    "created_at": "2020-12-09T18:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481120",
    "user": "https://github.com/kliem"
}
```

Branch: **[public/30319](https://github.com/sagemath/sagetrac-mirror/tree/public/30319)**



---

archive/issue_comments_481121.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d\"><code>406cb29</code></a></td><td><code>update cddlib</code></td></tr></table>\n",
    "created_at": "2020-12-09T18:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481121",
    "user": "https://github.com/kliem"
}
```

<div id="comment:21"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d"><code>406cb29</code></a></td><td><code>update cddlib</code></td></tr></table>




---

archive/issue_comments_481122.json:
```json
{
    "body": "Commit: **[`406cb29`](https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d)**",
    "created_at": "2020-12-09T18:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481122",
    "user": "https://github.com/kliem"
}
```

Commit: **[`406cb29`](https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d)**



---

archive/issue_comments_481123.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@kliem](#comment:17):\n> How important do we consider this bug. Should we reject older system installs?\n\nA good idea, I think.",
    "created_at": "2020-12-15T20:04:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481123",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@kliem](#comment:17):
> How important do we consider this bug. Should we reject older system installs?

A good idea, I think.



---

archive/issue_comments_481124.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI agree as well.",
    "created_at": "2020-12-15T20:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481124",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

I agree as well.



---

archive/issue_events_419769.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T02:16:25Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "title_is": "wrong intersection of polytopes: Upgrade cddlib",
    "title_was": "wrong intersection of polytopes",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419769"
}
```



---

archive/issue_comments_481125.json:
```json
{
    "body": "Dependencies: **#31482**",
    "created_at": "2021-03-18T02:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481125",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31482**



---

archive/issue_comments_481126.json:
```json
{
    "body": "Work Issues: **rebase on #31482 - latte_int upgrade**",
    "created_at": "2021-03-18T02:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481126",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **rebase on #31482 - latte_int upgrade**



---

archive/issue_events_419770.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T02:18:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "title_is": "wrong intersection of polytopes",
    "title_was": "wrong intersection of polytopes: Upgrade cddlib",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419770"
}
```



---

archive/issue_comments_481127.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nIt seems that the system cdd will also leak into singular:\n\n`Singular/m4/gfanlib-check.m4`:\n\n```\n  AC_CHECK_HEADERS([setoper.h cdd/setoper.h cddlib/setoper.h])\n  if test \"x$ac_cv_header_setoper_h\" = xno -a \"x$ac_cv_header_cdd_setoper_h\" = xno -a \"x$ac_cv_header_cddlib_setoper_h\" = xno\n  then\n    if test \"x$ENABLE_GFANLIB\" = \"xyes\"; then\n      AC_MSG_ERROR([Error, setoper.h is missing!])\n    fi\n```",
    "created_at": "2021-03-18T06:05:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481127",
    "user": "https://github.com/kliem"
}
```

<div id="comment:26" align="right">comment:26</div>

It seems that the system cdd will also leak into singular:

`Singular/m4/gfanlib-check.m4`:

```
  AC_CHECK_HEADERS([setoper.h cdd/setoper.h cddlib/setoper.h])
  if test "x$ac_cv_header_setoper_h" = xno -a "x$ac_cv_header_cdd_setoper_h" = xno -a "x$ac_cv_header_cddlib_setoper_h" = xno
  then
    if test "x$ENABLE_GFANLIB" = "xyes"; then
      AC_MSG_ERROR([Error, setoper.h is missing!])
    fi
```



---

archive/issue_comments_481128.json:
```json
{
    "body": "Changed work issues from **rebase on #31482 - latte_int upgrade** to **rebase on dependencies**",
    "created_at": "2021-03-18T06:21:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481128",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **rebase on #31482 - latte_int upgrade** to **rebase on dependencies**



---

archive/issue_comments_481129.json:
```json
{
    "body": "Changed dependencies from **#31482** to **#31482, #25993**",
    "created_at": "2021-03-18T06:21:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481129",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31482** to **#31482, #25993**



---

archive/issue_comments_481130.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nSingular always prefers `<cdd/....h>` over `<cddlib/....h`. This means that on debian a system cdd will always be prefered, if I'm not mistaken.\n\nI don't know if this leads to any problems?\n\nWe could patch singular to modify the preference to `<cddlib/....h>` over `<cdd/....h>`. If we set up the path correctly, then sage's cdd will be prefered, even if there is a system cdd that is also in `<cdd/....h>`. Right??\n\nThis would be preferable in general I think (for singular as well). If there is a seperate install of cdd, it will always be in `cddlib/`.",
    "created_at": "2021-03-18T06:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481130",
    "user": "https://github.com/kliem"
}
```

<div id="comment:28" align="right">comment:28</div>

Singular always prefers `<cdd/....h>` over `<cddlib/....h`. This means that on debian a system cdd will always be prefered, if I'm not mistaken.

I don't know if this leads to any problems?

We could patch singular to modify the preference to `<cddlib/....h>` over `<cdd/....h>`. If we set up the path correctly, then sage's cdd will be prefered, even if there is a system cdd that is also in `<cdd/....h>`. Right??

This would be preferable in general I think (for singular as well). If there is a seperate install of cdd, it will always be in `cddlib/`.



---

archive/issue_comments_481131.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI suppose we can also just install a few symlinks in cddlib's spkg-install.\nThen we could finish the present ticket without having to wait for all the dependencies.\nLater, in a followup ticket when packages have been updated, we could eliminate the symlinks again.",
    "created_at": "2021-03-18T06:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481131",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

I suppose we can also just install a few symlinks in cddlib's spkg-install.
Then we could finish the present ticket without having to wait for all the dependencies.
Later, in a followup ticket when packages have been updated, we could eliminate the symlinks again.



---

archive/issue_comments_481132.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nWe could to that with the symlinks and singular will pull in the correct library then, I think (at least if my assumption that the path is an ordered list and we lock for headers from sage first is correct).\n\nI don't think we have to wait on singular. It's been leaking all along prefering the `cdd` system one over sage's header. It also checks for `cddlib`, so it won't fail.",
    "created_at": "2021-03-18T06:56:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481132",
    "user": "https://github.com/kliem"
}
```

<div id="comment:30" align="right">comment:30</div>

We could to that with the symlinks and singular will pull in the correct library then, I think (at least if my assumption that the path is an ordered list and we lock for headers from sage first is correct).

I don't think we have to wait on singular. It's been leaking all along prefering the `cdd` system one over sage's header. It also checks for `cddlib`, so it won't fail.



---

archive/issue_comments_481133.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\ngfan only checks plain cdd.h\n\nIn fact it looks to me, like gfan wouldn't be able to pick up a systems cdd at all (because the headers are in the subfolder cddlib resp. cdd). So that is actually a bug in the install system. Because if you have cdd installed in your system, but gfan not, then you won't be able to build gfan.",
    "created_at": "2021-03-18T07:54:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481133",
    "user": "https://github.com/kliem"
}
```

<div id="comment:31" align="right">comment:31</div>

gfan only checks plain cdd.h

In fact it looks to me, like gfan wouldn't be able to pick up a systems cdd at all (because the headers are in the subfolder cddlib resp. cdd). So that is actually a bug in the install system. Because if you have cdd installed in your system, but gfan not, then you won't be able to build gfan.



---

archive/issue_comments_481134.json:
```json
{
    "body": "Changed work issues from **rebase on dependencies** to **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan**",
    "created_at": "2021-03-18T07:54:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481134",
    "user": "https://github.com/kliem"
}
```

Changed work issues from **rebase on dependencies** to **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan**



---

archive/issue_comments_481135.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nWe should also update topcom's configure patch to match t, the updated version of latte. This should be easy, as we completely control topcom's configure",
    "created_at": "2021-03-18T07:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481135",
    "user": "https://github.com/kliem"
}
```

<div id="comment:32" align="right">comment:32</div>

We should also update topcom's configure patch to match t, the updated version of latte. This should be easy, as we completely control topcom's configure



---

archive/issue_comments_481136.json:
```json
{
    "body": "Changed work issues from **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan** to **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan, topcom configure**",
    "created_at": "2021-03-18T07:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481136",
    "user": "https://github.com/kliem"
}
```

Changed work issues from **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan** to **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan, topcom configure**



---

archive/issue_comments_481137.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nPolymake is a different topic.\n\nAccording to this https://github.com/polymake/polymake/blob/c2a326f240b11a06e1b1d5fd1c2ca7278bbe60a2/bundled/cdd/support/configure.pl\n\nwe probably need to specify the path to cdd. But I wouldn't know how to make this work for the systems cdd. But then again, I don't understand perl at all.",
    "created_at": "2021-03-18T08:01:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481137",
    "user": "https://github.com/kliem"
}
```

<div id="comment:33" align="right">comment:33</div>

Polymake is a different topic.

According to this https://github.com/polymake/polymake/blob/c2a326f240b11a06e1b1d5fd1c2ca7278bbe60a2/bundled/cdd/support/configure.pl

we probably need to specify the path to cdd. But I wouldn't know how to make this work for the systems cdd. But then again, I don't understand perl at all.



---

archive/issue_comments_481138.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI think if we only make sure things don't get worse as they have been, this ticket is very much doable.\n\nWe probably need a follow up ticket to fix gfan to work with systems cdd.\n\nEdit: I see, we ignore system cdd installs, if headers are in a subfolder. This is why I have cdd installed in both the system and in sage as well. I guess with the current ticket, we know exactly what we need to do, to be able to drop this.",
    "created_at": "2021-03-18T08:03:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481138",
    "user": "https://github.com/kliem"
}
```

<div id="comment:34" align="right">comment:34</div>

I think if we only make sure things don't get worse as they have been, this ticket is very much doable.

We probably need a follow up ticket to fix gfan to work with systems cdd.

Edit: I see, we ignore system cdd installs, if headers are in a subfolder. This is why I have cdd installed in both the system and in sage as well. I guess with the current ticket, we know exactly what we need to do, to be able to drop this.



---

archive/issue_comments_481139.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308274d2e56ccd1cb75e471f5d59b8e0ad0111d9\"><code>308274d</code></a></td><td><code>update cddlib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1\"><code>ed3ed2a</code></a></td><td><code>build/pkgs/cddlib/spkg-install.in: Install symlinks for cddlib/*.h</code></td></tr></table>\n",
    "created_at": "2021-03-18T20:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481139",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308274d2e56ccd1cb75e471f5d59b8e0ad0111d9"><code>308274d</code></a></td><td><code>update cddlib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1"><code>ed3ed2a</code></a></td><td><code>build/pkgs/cddlib/spkg-install.in: Install symlinks for cddlib/*.h</code></td></tr></table>




---

archive/issue_comments_481140.json:
```json
{
    "body": "Changed commit from **[`406cb29`](https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d)** to **[`ed3ed2a`](https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1)**",
    "created_at": "2021-03-18T20:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481140",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`406cb29`](https://github.com/sagemath/sagetrac-mirror/commit/406cb29f98626dce6ca86f27983874ab72fcd08d)** to **[`ed3ed2a`](https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1)**



---

archive/issue_comments_481141.json:
```json
{
    "body": "Changed work issues from **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan, topcom configure** to none",
    "created_at": "2021-03-18T20:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481141",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **rebase on dependencies, -I$SAGE_LOCAL/include/cddlib for gfan, topcom configure** to none



---

archive/issue_comments_481142.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nDo you know how to test for the cddlib bug in spkg-configure.m4?",
    "created_at": "2021-03-18T20:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481142",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Do you know how to test for the cddlib bug in spkg-configure.m4?



---

archive/issue_comments_481143.json:
```json
{
    "body": "Author: **Jonathan Kliem, Matthias Koeppe**",
    "created_at": "2021-03-18T20:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481143",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Jonathan Kliem, Matthias Koeppe**



---

archive/issue_comments_481144.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@sagetrac-git](#comment:35):\n> Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308274d2e56ccd1cb75e471f5d59b8e0ad0111d9\"><code>308274d</code></a></td><td><code>update cddlib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1\"><code>ed3ed2a</code></a></td><td><code>build/pkgs/cddlib/spkg-install.in: Install symlinks for cddlib/*.h</code></td></tr></table>\n\nI'm a bit confused on why you deleted the work issues. Did you forget to push something?",
    "created_at": "2021-03-18T20:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481144",
    "user": "https://github.com/kliem"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@sagetrac-git](#comment:35):
> Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308274d2e56ccd1cb75e471f5d59b8e0ad0111d9"><code>308274d</code></a></td><td><code>update cddlib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1"><code>ed3ed2a</code></a></td><td><code>build/pkgs/cddlib/spkg-install.in: Install symlinks for cddlib/*.h</code></td></tr></table>

I'm a bit confused on why you deleted the work issues. Did you forget to push something?



---

archive/issue_comments_481145.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nCreate a file\n\ntest.ine\n\nwith\n\n```\nH-representation\nlinearity 2 1 2\nbegin\n 5 4 real\n 0.0 0.0 1.0 1.0\n -1.0 0.0 1.0 1.0\n -1.0 2.0 -1.0 0.0\n -1.0 4.0 -2.0 0.0\n 1 0 0 0\nend\n```\n\nand run `cddexec --redcheck <test.ine`.\n\nThe line `Redundant rows are` should not contain a `1`.",
    "created_at": "2021-03-18T20:43:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481145",
    "user": "https://github.com/kliem"
}
```

<div id="comment:38" align="right">comment:38</div>

Create a file

test.ine

with

```
H-representation
linearity 2 1 2
begin
 5 4 real
 0.0 0.0 1.0 1.0
 -1.0 0.0 1.0 1.0
 -1.0 2.0 -1.0 0.0
 -1.0 4.0 -2.0 0.0
 1 0 0 0
end
```

and run `cddexec --redcheck <test.ine`.

The line `Redundant rows are` should not contain a `1`.



---

archive/issue_comments_481146.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@kliem](#comment:37):\n> I'm a bit confused on why you deleted the work issues. Did you forget to push something?\n\nI thought the result of our discussion was that by installing the symlinks, we do not have to fix anything in the other packages.",
    "created_at": "2021-03-18T20:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481146",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@kliem](#comment:37):
> I'm a bit confused on why you deleted the work issues. Did you forget to push something?

I thought the result of our discussion was that by installing the symlinks, we do not have to fix anything in the other packages.



---

archive/issue_comments_481147.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nOr is there a package that no longer finds a prefix-less system cdd?",
    "created_at": "2021-03-18T20:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481147",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Or is there a package that no longer finds a prefix-less system cdd?



---

archive/issue_comments_481148.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI see.\n\nOk, then technically the latte upgrade isn't a decency anymore.",
    "created_at": "2021-03-18T21:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481148",
    "user": "https://github.com/kliem"
}
```

<div id="comment:41" align="right">comment:41</div>

I see.

Ok, then technically the latte upgrade isn't a decency anymore.



---

archive/issue_comments_481149.json:
```json
{
    "body": "Changed commit from **[`ed3ed2a`](https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1)** to **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**",
    "created_at": "2021-03-18T22:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481149",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ed3ed2a`](https://github.com/sagemath/sagetrac-mirror/commit/ed3ed2a20f98f534d13b461d7b476fbc776928a1)** to **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**



---

archive/issue_comments_481150.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6\"><code>167c832</code></a></td><td><code>build/pkgs/cddlib/spkg-configure.m4: Add test for cddexec --redcheck bug</code></td></tr></table>\n",
    "created_at": "2021-03-18T22:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481150",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6"><code>167c832</code></a></td><td><code>build/pkgs/cddlib/spkg-configure.m4: Add test for cddexec --redcheck bug</code></td></tr></table>




---

archive/issue_comments_481151.json:
```json
{
    "body": "Changed dependencies from **#31482, #25993** to none",
    "created_at": "2021-03-18T22:00:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481151",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31482, #25993** to none



---

archive/issue_comments_481152.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,5 @@\n c = a.intersection(b)\n ```\n Here `c` should have been empty but is equal to `b`.\n+\n+We fix it by upgrading to cddlib 0.94m, installing symlinks so that consumers of cddlib that have not been updated to work with the new header file locations (#29413) continue to work.\n``````\n",
    "created_at": "2021-03-18T22:02:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481152",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,5 @@
 c = a.intersection(b)
 ```
 Here `c` should have been empty but is equal to `b`.
+
+We fix it by upgrading to cddlib 0.94m, installing symlinks so that consumers of cddlib that have not been updated to work with the new header file locations (#29413) continue to work.
``````




---

archive/issue_events_419771.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T22:02:37Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "title_is": "Upgrade cddlib to fix wrong intersection of polytopes",
    "title_was": "wrong intersection of polytopes",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419771"
}
```



---

archive/issue_comments_481153.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOK... the new configure check works correctly on `homebrew-macos-standard` (result: `yes` - but then the package is rejected because the headers are in the new place) and on `ubuntu-focal-standard` (result: `no`).",
    "created_at": "2021-03-18T22:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481153",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

OK... the new configure check works correctly on `homebrew-macos-standard` (result: `yes` - but then the package is rejected because the headers are in the new place) and on `ubuntu-focal-standard` (result: `no`).



---

archive/issue_events_419772.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T22:23:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419772"
}
```



---

archive/issue_comments_481154.json:
```json
{
    "body": "Reviewer: **https://github.com/mkoeppe/sage/actions/runs/666698487**",
    "created_at": "2021-03-19T03:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481154",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **https://github.com/mkoeppe/sage/actions/runs/666698487**



---

archive/issue_comments_481155.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nLet's please get this fix into 9.3",
    "created_at": "2021-03-24T00:29:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481155",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

Let's please get this fix into 9.3



---

archive/issue_comments_481156.json:
```json
{
    "body": "Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/666698487** to **Matthias Koeppe, ...**",
    "created_at": "2021-03-25T17:40:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481156",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/mkoeppe/sage/actions/runs/666698487** to **Matthias Koeppe, ...**



---

archive/issue_events_419773.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-03-25T18:42:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419773"
}
```



---

archive/issue_events_419774.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-03-25T18:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419774"
}
```



---

archive/issue_comments_481157.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Dima Pasechnik**",
    "created_at": "2021-03-25T18:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481157",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Dima Pasechnik**



---

archive/issue_comments_481158.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nok",
    "created_at": "2021-03-25T18:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481158",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

ok



---

archive/issue_comments_481159.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nThank you.",
    "created_at": "2021-03-25T18:52:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481159",
    "user": "https://github.com/kliem"
}
```

<div id="comment:52" align="right">comment:52</div>

Thank you.



---

archive/issue_comments_481160.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThanks!",
    "created_at": "2021-03-25T19:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481160",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Thanks!



---

archive/issue_events_419775.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-29T23:54:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419775"
}
```



---

archive/issue_events_419776.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-29T23:54:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419776"
}
```



---

archive/issue_comments_481161.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nSetting priority to blocker to bring this ticket to the attention of the release bot.",
    "created_at": "2021-03-29T23:54:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481161",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:54" align="right">comment:54</div>

Setting priority to blocker to bring this ticket to the attention of the release bot.



---

archive/issue_events_419777.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-04-01T19:45:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419777"
}
```



---

archive/issue_events_419778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "71123d8021cb6210d8dd4520ff2435f5cc62c9b4",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-04-01T19:45:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30319#event-419778"
}
```



---

archive/issue_comments_481162.json:
```json
{
    "body": "Changed branch from **[public/30319](https://github.com/sagemath/sagetrac-mirror/tree/public/30319)** to **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**",
    "created_at": "2021-04-01T19:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30319#issuecomment-481162",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/30319](https://github.com/sagemath/sagetrac-mirror/tree/public/30319)** to **[`167c832`](https://github.com/sagemath/sagetrac-mirror/commit/167c83211f146c119ec377cf00e3b872a6d305d6)**
