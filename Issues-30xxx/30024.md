# Issue 30024: Add build/pkgs/SPKG/requirements.txt for all Python SPKG

archive/issues_029787.json:
```json
{
    "body": "These files were added in #29287 (SPKG type: Make \"normal/script/pip\" orthogonal to \"base/standard/optional/experimental\") for all pip packages. \n\nWe record \"abstract\" version requirements in files `build/pkgs/SPKG/install-requires.txt` - this is #30719.\n\nIn this ticket, we additionally record \"concrete\" versions for all Python packages in `build/pkgs/SPKG/requirements.txt`.\n\n(cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)\n\nSome scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.\n\n\n\nCC:  @slel @jhpalmieri @orlitzky\n\nStatus: needs_work\n\nDependencies: #30719\n\nIssue created by migration from https://trac.sagemath.org/ticket/30024\n\n",
    "created_at": "2020-06-29T19:44:16Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Add build/pkgs/SPKG/requirements.txt for all Python SPKG",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30024",
    "user": "https://github.com/mkoeppe"
}
```
These files were added in #29287 (SPKG type: Make "normal/script/pip" orthogonal to "base/standard/optional/experimental") for all pip packages. 

We record "abstract" version requirements in files `build/pkgs/SPKG/install-requires.txt` - this is #30719.

In this ticket, we additionally record "concrete" versions for all Python packages in `build/pkgs/SPKG/requirements.txt`.

(cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)

Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.



CC:  @slel @jhpalmieri @orlitzky

Status: needs_work

Dependencies: #30719

Issue created by migration from https://trac.sagemath.org/ticket/30024





---

archive/issue_events_077192.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30024#event-77192"
}
```



---

archive/issue_comments_451092.json:
```json
{
    "body": "<a id='comment:2'></a>I would strongly suggest to have a look at pipenv, which manages python dependencies via pipfile and pipfile.lock (replacing requirements.txt and checksums.ini (?)).",
    "created_at": "2020-09-07T07:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451092",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:2'></a>I would strongly suggest to have a look at pipenv, which manages python dependencies via pipfile and pipfile.lock (replacing requirements.txt and checksums.ini (?)).



---

archive/issue_comments_451093.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,12 @@\n We record \"abstract\" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)\n \n \n-This is a step of Meta-ticket #29023 (In a python 3 build, use system Python packages) and of Meta-ticket #21507 (Make sagelib a pip-installable Python source package, listed on PyPI)\n+This is a step of:\n+- Meta-ticket #29023 (In a python 3 build, use system Python packages) \n+- Meta-ticket #21507 (Make sagelib a pip-installable Python source package, listed on PyPI)\n+- #29500 Install all Python packages via `pip wheel`, create PEP 503 simple repository for wheels\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-09-07T18:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451093",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,12 @@
 We record "abstract" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)
 
 
-This is a step of Meta-ticket #29023 (In a python 3 build, use system Python packages) and of Meta-ticket #21507 (Make sagelib a pip-installable Python source package, listed on PyPI)
+This is a step of:
+- Meta-ticket #29023 (In a python 3 build, use system Python packages) 
+- Meta-ticket #21507 (Make sagelib a pip-installable Python source package, listed on PyPI)
+- #29500 Install all Python packages via `pip wheel`, create PEP 503 simple repository for wheels
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_451094.json:
```json
{
    "body": "<a id='comment:3'></a>Not sure if we can use pipenv as a drop in solution. \n\nFor various Python packages, we currently have to use patches or special build steps. I have sketched a way forward in #29500 -- use our custom build scripts to build wheels (and store them in a wheelhouse / private package index), which can then be installed by all standard tools (and also by users into separate venvs). We can certainly generate a `Pipfile` that makes this easier for users",
    "created_at": "2020-09-07T18:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451094",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Not sure if we can use pipenv as a drop in solution. 

For various Python packages, we currently have to use patches or special build steps. I have sketched a way forward in #29500 -- use our custom build scripts to build wheels (and store them in a wheelhouse / private package index), which can then be installed by all standard tools (and also by users into separate venvs). We can certainly generate a `Pipfile` that makes this easier for users



---

archive/issue_comments_451095.json:
```json
{
    "body": "<a id='comment:4'></a>Let's discuss two separate concerns on two separate tickets:\n- sagelib's concern to declare the requirements regarding Python packages - #29041\n- sage-the-distribution's concern to provide working versions of Python packages as wheels - #29500",
    "created_at": "2020-09-07T18:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451095",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Let's discuss two separate concerns on two separate tickets:
- sagelib's concern to declare the requirements regarding Python packages - #29041
- sage-the-distribution's concern to provide working versions of Python packages as wheels - #29500



---

archive/issue_comments_451096.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+These files were added in #29287 (SPKG type: Make \"normal/script/pip\" orthogonal to \"base/standard/optional/experimental\") for all pip packages. \n+\n+In this ticket, we add them for all normal Python packages.\n+\n+This is a technical step for \n+- #29500 Install all Python packages via `pip wheel`, create PEP 503 simple repository for wheels\n+\n+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.\n+\n+We record \"abstract\" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-09-07T18:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451096",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+These files were added in #29287 (SPKG type: Make "normal/script/pip" orthogonal to "base/standard/optional/experimental") for all pip packages. 
+
+In this ticket, we add them for all normal Python packages.
+
+This is a technical step for 
+- #29500 Install all Python packages via `pip wheel`, create PEP 503 simple repository for wheels
+
+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.
+
+We record "abstract" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)
+
 
 
 Comment: 1
``````




---

archive/issue_comments_451097.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+These files were added in #29287 (SPKG type: Make \"normal/script/pip\" orthogonal to \"base/standard/optional/experimental\") for all pip packages. \n+\n+In this ticket, we add them for all normal Python packages - so that we have a mapping from SPKG name to distribution name\n+\n+\n+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.\n+\n+We record \"abstract\" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-09-08T05:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451097",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,12 @@
+These files were added in #29287 (SPKG type: Make "normal/script/pip" orthogonal to "base/standard/optional/experimental") for all pip packages. 
+
+In this ticket, we add them for all normal Python packages - so that we have a mapping from SPKG name to distribution name
+
+
+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.
+
+We record "abstract" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)
+
 
 
 Comment: 1
``````




---

archive/issue_events_077193.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:37:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30024#event-77193"
}
```



---

archive/issue_events_077194.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:37:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30024#event-77194"
}
```



---

archive/issue_comments_451098.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2020-10-04T17:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451098",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_451099.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2020-11-11T19:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451099",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_451100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,13 @@\n+These files were added in #29287 (SPKG type: Make \"normal/script/pip\" orthogonal to \"base/standard/optional/experimental\") for all pip packages. \n+\n+We record \"abstract\" version requirements in files `build/pkgs/SPKG/install-requires.txt` - this is #30719.\n+\n+In this ticket, we additionally record \"concrete\" versions for all Python packages in `build/pkgs/SPKG/requirements.txt`.\n+\n+(cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)\n+\n+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-11-11T19:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30024",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30024#issuecomment-451100",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,13 @@
+These files were added in #29287 (SPKG type: Make "normal/script/pip" orthogonal to "base/standard/optional/experimental") for all pip packages. 
+
+We record "abstract" version requirements in files `build/pkgs/SPKG/install-requires.txt` - this is #30719.
+
+In this ticket, we additionally record "concrete" versions for all Python packages in `build/pkgs/SPKG/requirements.txt`.
+
+(cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)
+
+Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.
+
 
 
 Comment: 1
``````

