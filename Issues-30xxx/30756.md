# Issue 30756: flake8 details in matroids

archive/issues_030519.json:
```json
{
    "body": "to make code there just a little more clean\n\nCC:  @slel\n\nReviewer: Samuel Leli\u00e8vre\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nBranch: 3ecdc03d4b26056d527b395b2318f5081e2922be\n\nCommit: 3ecdc03d4b26056d527b395b2318f5081e2922be\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30756\n\n",
    "closed_at": "2020-11-01T00:42:42Z",
    "created_at": "2020-10-11T14:17:02Z",
    "labels": [
        "component: matroid theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "flake8 details in matroids",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30756",
    "user": "https://github.com/fchapoton"
}
```
to make code there just a little more clean

CC:  @slel

Reviewer: Samuel Lelièvre

Author: Frédéric Chapoton

Branch: 3ecdc03d4b26056d527b395b2318f5081e2922be

Commit: 3ecdc03d4b26056d527b395b2318f5081e2922be

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30756





---

archive/issue_comments_435318.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2020-10-11T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435318",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_435319.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-11T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435319",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_435320.json:
```json
{
    "body": "<a id='comment:2'></a>This improves things, so positive review on my behalf if the bots are happy.\n\nIf you want to go further, but no pressure to do so here, more suggestions below.\n\nMaybe change `xrange` to `range` in `src/sage/matroids/matroid.pyx`?\n\nMabye check whether this alert should be taken care of, or removed:\n\n```\n# TODO: Alert: this sort of thing will break in Python 3, I think. --SvZ\n```\n\nMore possible minor code changes in or around the proposed changes:\n\n```diff\n-        if (self.size() != other.size() or other.groundset().difference(self.groundset())):\n+        if self.size() != other.size() or other.groundset().difference(self.groundset()):\n```\n\n```diff\n-        if (not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None):\n+        if not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None:\n\n```\n\n```diff\n-        if (not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None):\n+        if not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None:\n```\n\n```diff\n-        bdx = {basis[i]: i for i in range(len(basis))}\n+        bdx = {b: i for i, b in enumerate(basis)}\n```\n\n```diff\n-                if i % 2 == 0:\n-                    x = x * A.get(bdx[path[i]], idx[path[i+1]])\n-                else:\n-                    x = x * A.get(bdx[path[i+1]], idx[path[i]])\n+                if i % 2:\n+                    x *= A.get(bdx[path[i + 1]], idx[path[i]])\n+                else:\n+                    x *= A.get(bdx[path[i]], idx[path[i + 1]])\n```\n\nThese last two might require importing `polygen`:\n\n```diff\n-        z = ZZ['z'].gen()\n+        z = polygen(ZZ, 'z')\n```\n\n```diff\n-        t = QQ['t'].gen()\n+        t = polygen(QQ, 't')\n```",
    "created_at": "2020-10-11T16:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435320",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>This improves things, so positive review on my behalf if the bots are happy.

If you want to go further, but no pressure to do so here, more suggestions below.

Maybe change `xrange` to `range` in `src/sage/matroids/matroid.pyx`?

Mabye check whether this alert should be taken care of, or removed:

```
# TODO: Alert: this sort of thing will break in Python 3, I think. --SvZ
```

More possible minor code changes in or around the proposed changes:

```diff
-        if (self.size() != other.size() or other.groundset().difference(self.groundset())):
+        if self.size() != other.size() or other.groundset().difference(self.groundset()):
```

```diff
-        if (not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None):
+        if not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None:

```

```diff
-        if (not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None):
+        if not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None:
```

```diff
-        bdx = {basis[i]: i for i in range(len(basis))}
+        bdx = {b: i for i, b in enumerate(basis)}
```

```diff
-                if i % 2 == 0:
-                    x = x * A.get(bdx[path[i]], idx[path[i+1]])
-                else:
-                    x = x * A.get(bdx[path[i+1]], idx[path[i]])
+                if i % 2:
+                    x *= A.get(bdx[path[i + 1]], idx[path[i]])
+                else:
+                    x *= A.get(bdx[path[i]], idx[path[i + 1]])
```

These last two might require importing `polygen`:

```diff
-        z = ZZ['z'].gen()
+        z = polygen(ZZ, 'z')
```

```diff
-        t = QQ['t'].gen()
+        t = polygen(QQ, 't')
```



---

archive/issue_comments_435321.json:
```json
{
    "body": "<a id='comment:3'></a>bot is green, I am setting to positive, keeping further things for later",
    "created_at": "2020-10-12T06:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435321",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>bot is green, I am setting to positive, keeping further things for later



---

archive/issue_comments_435322.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-12T06:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435322",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_435323.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-01T00:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30756#issuecomment-435323",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_080184.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-01T00:42:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30756",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30756#event-80184"
}
```
