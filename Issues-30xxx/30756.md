# Issue 30756: flake8 details in matroids

archive/issues_030519.json:
```json
{
    "assignees": [],
    "body": "to make code there just a little more clean\n\nCC:  @slel\n\nBranch/Commit: **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**\n\nReviewer: **Samuel Leli\u00e8vre**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **matroid theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30756_\n\n",
    "closed_at": "2020-11-01T00:42:42Z",
    "created_at": "2020-10-11T14:17:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20matroid%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "flake8 details in matroids",
    "type": "issue",
    "updated_at": "2020-11-01T00:42:42Z",
    "url": "https://github.com/sagemath/sage/issues/30756",
    "user": "https://github.com/fchapoton"
}
```
to make code there just a little more clean

CC:  @slel

Branch/Commit: **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**

Reviewer: **Samuel Lelièvre**

Author: **Frédéric Chapoton**

Component: **matroid theory**

_Issue created by migration from https://trac.sagemath.org/ticket/30756_





---

archive/issue_events_424231.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-11T14:17:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424231"
}
```



---

archive/issue_events_424232.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-11T14:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20matroid%20theory",
    "label_color": "0000ff",
    "label_name": "c: matroid theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424232"
}
```



---

archive/issue_events_424233.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-11T14:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424233"
}
```



---

archive/issue_events_424234.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-11T14:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424234"
}
```



---

archive/issue_comments_491763.json:
```json
{
    "body": "Branch: **[u/chapoton/30756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/30756)**",
    "created_at": "2020-10-11T14:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491763",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/30756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/30756)**



---

archive/issue_comments_491764.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be\">3ecdc03</a></td><td><code>flake8 details in matroids/</code></td></tr></table>\n",
    "created_at": "2020-10-11T14:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491764",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be">3ecdc03</a></td><td><code>flake8 details in matroids/</code></td></tr></table>




---

archive/issue_events_424235.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-11T14:17:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424235"
}
```



---

archive/issue_comments_491765.json:
```json
{
    "body": "Commit: **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**",
    "created_at": "2020-10-11T14:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491765",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**



---

archive/issue_comments_491766.json:
```json
{
    "body": "Reviewer: **Samuel Leli\u00e8vre**",
    "created_at": "2020-10-11T16:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491766",
    "user": "https://github.com/slel"
}
```

Reviewer: **Samuel Lelièvre**



---

archive/issue_comments_491767.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis improves things, so positive review on my behalf if the bots are happy.\n\nIf you want to go further, but no pressure to do so here, more suggestions below.\n\nMaybe change `xrange` to `range` in `src/sage/matroids/matroid.pyx`?\n\nMabye check whether this alert should be taken care of, or removed:\n\n```\n# TODO: Alert: this sort of thing will break in Python 3, I think. --SvZ\n```\n\nMore possible minor code changes in or around the proposed changes:\n\n```diff\n-        if (self.size() != other.size() or other.groundset().difference(self.groundset())):\n+        if self.size() != other.size() or other.groundset().difference(self.groundset()):\n```\n\n```diff\n-        if (not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None):\n+        if not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None:\n\n```\n\n```diff\n-        if (not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None):\n+        if not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None:\n```\n\n```diff\n-        bdx = {basis[i]: i for i in range(len(basis))}\n+        bdx = {b: i for i, b in enumerate(basis)}\n```\n\n```diff\n-                if i % 2 == 0:\n-                    x = x * A.get(bdx[path[i]], idx[path[i+1]])\n-                else:\n-                    x = x * A.get(bdx[path[i+1]], idx[path[i]])\n+                if i % 2:\n+                    x *= A.get(bdx[path[i + 1]], idx[path[i]])\n+                else:\n+                    x *= A.get(bdx[path[i]], idx[path[i + 1]])\n```\n\nThese last two might require importing `polygen`:\n\n```diff\n-        z = ZZ['z'].gen()\n+        z = polygen(ZZ, 'z')\n```\n\n```diff\n-        t = QQ['t'].gen()\n+        t = polygen(QQ, 't')\n```",
    "created_at": "2020-10-11T16:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491767",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

This improves things, so positive review on my behalf if the bots are happy.

If you want to go further, but no pressure to do so here, more suggestions below.

Maybe change `xrange` to `range` in `src/sage/matroids/matroid.pyx`?

Mabye check whether this alert should be taken care of, or removed:

```
# TODO: Alert: this sort of thing will break in Python 3, I think. --SvZ
```

More possible minor code changes in or around the proposed changes:

```diff
-        if (self.size() != other.size() or other.groundset().difference(self.groundset())):
+        if self.size() != other.size() or other.groundset().difference(self.groundset()):
```

```diff
-        if (not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None):
+        if not isinstance(contractions, str) and not hasattr(contractions, '__iter__') and contractions is not None:

```

```diff
-        if (not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None):
+        if not isinstance(deletions, str) and not hasattr(deletions, '__iter__') and deletions is not None:
```

```diff
-        bdx = {basis[i]: i for i in range(len(basis))}
+        bdx = {b: i for i, b in enumerate(basis)}
```

```diff
-                if i % 2 == 0:
-                    x = x * A.get(bdx[path[i]], idx[path[i+1]])
-                else:
-                    x = x * A.get(bdx[path[i+1]], idx[path[i]])
+                if i % 2:
+                    x *= A.get(bdx[path[i + 1]], idx[path[i]])
+                else:
+                    x *= A.get(bdx[path[i]], idx[path[i + 1]])
```

These last two might require importing `polygen`:

```diff
-        z = ZZ['z'].gen()
+        z = polygen(ZZ, 'z')
```

```diff
-        t = QQ['t'].gen()
+        t = polygen(QQ, 't')
```



---

archive/issue_comments_491768.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nbot is green, I am setting to positive, keeping further things for later",
    "created_at": "2020-10-12T06:55:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491768",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

bot is green, I am setting to positive, keeping further things for later



---

archive/issue_events_424236.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-12T06:55:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424236"
}
```



---

archive/issue_events_424237.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-10-12T06:55:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424237"
}
```



---

archive/issue_events_424238.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-01T00:42:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424238"
}
```



---

archive/issue_events_424239.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2292d96d02c88b3abf9950d47a5f1172cc6b9c79",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-11-01T00:42:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30756#event-424239"
}
```



---

archive/issue_comments_491769.json:
```json
{
    "body": "Changed branch from **[u/chapoton/30756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/30756)** to **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**",
    "created_at": "2020-11-01T00:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30756#issuecomment-491769",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/30756](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/30756)** to **[3ecdc03](https://github.com/sagemath/sagetrac-mirror/commit/3ecdc03d4b26056d527b395b2318f5081e2922be)**
