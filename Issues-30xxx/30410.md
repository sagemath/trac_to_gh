# Issue 30410: Command "sage -tox"

archive/issues_030173.json:
```json
{
    "assignees": [],
    "body": "This will run tox using `src/tox.ini`.\n\nEntry point for doctesting and linting: See `./sage -tox -l -v` or `(cd src && tox -l -v)`.\n\n\n\n\n\n\nDepends on #30408\n\nCC:  @tobiasdiez @dimpase @jhpalmieri @fchapoton\n\nBranch: **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **doctest framework**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30410_\n\n",
    "closed_at": "2020-09-06T21:51:36Z",
    "created_at": "2020-08-20T21:14:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Command \"sage -tox\"",
    "type": "issue",
    "updated_at": "2023-01-08T08:57:31Z",
    "url": "https://github.com/sagemath/sage/issues/30410",
    "user": "https://github.com/mkoeppe"
}
```
This will run tox using `src/tox.ini`.

Entry point for doctesting and linting: See `./sage -tox -l -v` or `(cd src && tox -l -v)`.






Depends on #30408

CC:  @tobiasdiez @dimpase @jhpalmieri @fchapoton

Branch: **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **doctest framework**

_Issue created by migration from https://trac.sagemath.org/ticket/30410_





---

archive/issue_events_419145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-20T21:14:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419145"
}
```



---

archive/issue_events_419146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-20T21:14:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
    "label_color": "000080",
    "label_name": "c: doctest framework",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419146"
}
```



---

archive/issue_events_419147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-20T21:14:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419147"
}
```



---

archive/issue_events_419148.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-20T21:14:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419148"
}
```



---

archive/issue_comments_484281.json:
```json
{
    "body": "Branch: **[u/mkoeppe/command__sage__tox_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/command__sage__tox_)**",
    "created_at": "2020-08-20T22:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484281",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/command__sage__tox_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/command__sage__tox_)**



---

archive/issue_comments_484282.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475\"><code>5ccccbb</code></a></td><td><code>sage --tox</code></td></tr></table>\n",
    "created_at": "2020-08-20T22:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484282",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475"><code>5ccccbb</code></a></td><td><code>sage --tox</code></td></tr></table>




---

archive/issue_comments_484283.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-08-20T22:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484283",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_484284.json:
```json
{
    "body": "Commit: **[`5ccccbb`](https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475)**",
    "created_at": "2020-08-20T22:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484284",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`5ccccbb`](https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475)**



---

archive/issue_events_419149.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-20T22:41:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419149"
}
```



---

archive/issue_comments_484285.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n This will run tox using `src/tox.ini`.\n \n Entry point for doctesting and linting.\n-\n+(#30408 adds more functionality.)\n``````\n",
    "created_at": "2020-08-20T22:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484285",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
 This will run tox using `src/tox.ini`.
 
 Entry point for doctesting and linting.
-
+(#30408 adds more functionality.)
``````




---

archive/issue_comments_484286.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nInstead of putting more into the `bin/sage` script, wouldn't it make sense to actually extract all building and testing related code to tox? So instead of `sage -b` (`sage -t`) you run `tox build` (`tox test` respectively). This would leave the `sage` script only with the functionality that a user needs to *run* sage.\n\n(also I don't see any advantages of `sage -tox pycodestyle` over `tox pycodestyle`)",
    "created_at": "2020-08-21T09:25:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484286",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:3" align="right">comment:3</div>

Instead of putting more into the `bin/sage` script, wouldn't it make sense to actually extract all building and testing related code to tox? So instead of `sage -b` (`sage -t`) you run `tox build` (`tox test` respectively). This would leave the `sage` script only with the functionality that a user needs to *run* sage.

(also I don't see any advantages of `sage -tox pycodestyle` over `tox pycodestyle`)



---

archive/issue_comments_484287.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWhatever the final interface looks like, the documentation needs to be changed as well to reflect this. In particular, this ticket depends on #30361.",
    "created_at": "2020-08-21T10:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484287",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

Whatever the final interface looks like, the documentation needs to be changed as well to reflect this. In particular, this ticket depends on #30361.



---

archive/issue_comments_484288.json:
```json
{
    "body": "Dependencies: **30361**",
    "created_at": "2020-08-21T10:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484288",
    "user": "https://github.com/tobiasdiez"
}
```

Dependencies: **30361**



---

archive/issue_comments_484289.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@tobiasdiez](#comment:3):\n> Instead of putting more into the `bin/sage` script, wouldn't it make sense to actually extract all building and testing related code to tox? So instead of `sage -b` (`sage -t`) you run `tox build` (`tox test` respectively). This would leave the `sage` script only with the functionality that a user needs to *run* sage.\n\nSome projects are indeed using tox also for building, but I think I would like to keep it for testing only. At least for now - we can't make too many changes at the same time so that our developer community is not overwhelmed.\n\n`sage -coverage` and `sage -startuptime`, however, should definitely become tox environments.\n\n> (also I don't see any advantages of `sage -tox pycodestyle` over `tox pycodestyle`)\n\nThe difference is that `sage -tox` would also work with `src/tox.ini` when called from SAGE_ROOT. (There's another tox.ini in SAGE_ROOT for a different purpose - testing of the sage distribution.)\n\nAnd it can give a hint to install tox when it is not available.",
    "created_at": "2020-08-21T16:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484289",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@tobiasdiez](#comment:3):
> Instead of putting more into the `bin/sage` script, wouldn't it make sense to actually extract all building and testing related code to tox? So instead of `sage -b` (`sage -t`) you run `tox build` (`tox test` respectively). This would leave the `sage` script only with the functionality that a user needs to *run* sage.

Some projects are indeed using tox also for building, but I think I would like to keep it for testing only. At least for now - we can't make too many changes at the same time so that our developer community is not overwhelmed.

`sage -coverage` and `sage -startuptime`, however, should definitely become tox environments.

> (also I don't see any advantages of `sage -tox pycodestyle` over `tox pycodestyle`)

The difference is that `sage -tox` would also work with `src/tox.ini` when called from SAGE_ROOT. (There's another tox.ini in SAGE_ROOT for a different purpose - testing of the sage distribution.)

And it can give a hint to install tox when it is not available.



---

archive/issue_comments_484290.json:
```json
{
    "body": "Changed dependencies from **30361** to **#30408, #30361**",
    "created_at": "2020-08-21T16:36:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484290",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **30361** to **#30408, #30361**



---

archive/issue_comments_484291.json:
```json
{
    "body": "Changed commit from **[`5ccccbb`](https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475)** to **[`8574448`](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)**",
    "created_at": "2020-08-21T17:27:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484291",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5ccccbb`](https://github.com/sagemath/sagetrac-mirror/commit/5ccccbb0f7a28c878646fcf5c1580cba0e26c475)** to **[`8574448`](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)**



---

archive/issue_comments_484292.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cedc00fe789a4573c926cbff12e6fb9d2422c1e\"><code>1cedc00</code></a></td><td><code>Add configuration of pycodestyle via tox</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dde3b4f3955605d27e30f488c6dc11157031b720\"><code>dde3b4f</code></a></td><td><code>src/tox.ini: Add testenv:pycodestyle</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/939e9e0e08d7d5c4e4c073a571ca8e4aac22ef77\"><code>939e9e0</code></a></td><td><code>src/tox.ini: Better default arg testenv:pycodestyle</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/583bde5acd02de68d120ca9af664ba401f7948a4\"><code>583bde5</code></a></td><td><code>Merge branch 't/30408/public/build/pycodestyleConfig' into t/30410/command__sage__tox_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62\"><code>8574448</code></a></td><td><code>src/tox.ini: Add coverage, startuptime; refactor, add descriptions</code></td></tr></table>\n",
    "created_at": "2020-08-21T17:27:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484292",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cedc00fe789a4573c926cbff12e6fb9d2422c1e"><code>1cedc00</code></a></td><td><code>Add configuration of pycodestyle via tox</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dde3b4f3955605d27e30f488c6dc11157031b720"><code>dde3b4f</code></a></td><td><code>src/tox.ini: Add testenv:pycodestyle</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/939e9e0e08d7d5c4e4c073a571ca8e4aac22ef77"><code>939e9e0</code></a></td><td><code>src/tox.ini: Better default arg testenv:pycodestyle</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/583bde5acd02de68d120ca9af664ba401f7948a4"><code>583bde5</code></a></td><td><code>Merge branch 't/30408/public/build/pycodestyleConfig' into t/30410/command__sage__tox_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62"><code>8574448</code></a></td><td><code>src/tox.ini: Add coverage, startuptime; refactor, add descriptions</code></td></tr></table>




---

archive/issue_comments_484293.json:
```json
{
    "body": "Changed dependencies from **#30408, #30361** to **#30408**",
    "created_at": "2020-08-21T17:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484293",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30408, #30361** to **#30408**



---

archive/issue_comments_484294.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n This will run tox using `src/tox.ini`.\n \n-Entry point for doctesting and linting.\n-(#30408 adds more functionality.)\n+Entry point for doctesting and linting: See `./sage -tox -l -v` or `(cd src && tox -l -v)`.\n+\n+\n+\n+\n+\n``````\n",
    "created_at": "2020-08-21T17:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484294",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
 This will run tox using `src/tox.ini`.
 
-Entry point for doctesting and linting.
-(#30408 adds more functionality.)
+Entry point for doctesting and linting: See `./sage -tox -l -v` or `(cd src && tox -l -v)`.
+
+
+
+
+
``````




---

archive/issue_comments_484295.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI don't think #30361 needs to be a dependency.",
    "created_at": "2020-08-21T17:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484295",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

I don't think #30361 needs to be a dependency.



---

archive/issue_comments_484296.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nIt should also be possible to add simple forwards in the `tox.ini` at the root folder of the form\n\n\n```\n[testenv:pycodestyle]\nwhitelist_externals=tox\ncommands=tox -c {toxinidir}/src/tox.ini -e pycodestyle\n```\n\nThen you can simply call `tox -e pycodestyle`.",
    "created_at": "2020-08-21T17:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484296",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:9" align="right">comment:9</div>

It should also be possible to add simple forwards in the `tox.ini` at the root folder of the form


```
[testenv:pycodestyle]
whitelist_externals=tox
commands=tox -c {toxinidir}/src/tox.ini -e pycodestyle
```

Then you can simply call `tox -e pycodestyle`.



---

archive/issue_comments_484297.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?",
    "created_at": "2020-08-21T17:40:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484297",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:10" align="right">comment:10</div>

I also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?



---

archive/issue_comments_484298.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@tobiasdiez](#comment:9):\n> It should also be possible to add simple forwards in the `tox.ini` at the root folder\n\nGood idea, will do.",
    "created_at": "2020-08-21T17:41:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484298",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@tobiasdiez](#comment:9):
> It should also be possible to add simple forwards in the `tox.ini` at the root folder

Good idea, will do.



---

archive/issue_comments_484299.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@tobiasdiez](#comment:10):\n> I also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?\n\nFor that we would first have to make tox a \"standard\" package. Step by step...",
    "created_at": "2020-08-21T17:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484299",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@tobiasdiez](#comment:10):
> I also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?

For that we would first have to make tox a "standard" package. Step by step...



---

archive/issue_comments_484300.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@mkoeppe](#comment:12):\n> Replying to [@tobiasdiez](#comment:10):\n> > I also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?\n\n> \n> For that we would first have to make tox a \"standard\" package. Step by step...\n\nOpened #30416 for that.",
    "created_at": "2020-08-21T17:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484300",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@mkoeppe](#comment:12):
> Replying to [@tobiasdiez](#comment:10):
> > I also think the testing methods in bin/sage should now be removed or deprecated (or at least use tox), or not?

> 
> For that we would first have to make tox a "standard" package. Step by step...

Opened #30416 for that.



---

archive/issue_comments_484301.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b\"><code>eba708b</code></a></td><td><code>tox.ini: Delegate doctest, coverage, startuptime, pycodestyle to src/tox.ini</code></td></tr></table>\n",
    "created_at": "2020-08-21T22:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484301",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b"><code>eba708b</code></a></td><td><code>tox.ini: Delegate doctest, coverage, startuptime, pycodestyle to src/tox.ini</code></td></tr></table>




---

archive/issue_comments_484302.json:
```json
{
    "body": "Changed commit from **[`8574448`](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)** to **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**",
    "created_at": "2020-08-21T22:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484302",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8574448`](https://github.com/sagemath/sagetrac-mirror/commit/857444889f93a3053dda3e195444b3560b35ad62)** to **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**



---

archive/issue_comments_484303.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReady for review",
    "created_at": "2020-08-27T04:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484303",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Ready for review



---

archive/issue_comments_484304.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nLooks good to me.\n\nThe only point where I'm not sure is whether the src/tox.ini file is really needed, or if it can be combined with the tox.ini in the root directory. Similarly, I'm not sure if sage -tox should always be relative to the tox config in the src folder.",
    "created_at": "2020-08-27T12:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484304",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:16" align="right">comment:16</div>

Looks good to me.

The only point where I'm not sure is whether the src/tox.ini file is really needed, or if it can be combined with the tox.ini in the root directory. Similarly, I'm not sure if sage -tox should always be relative to the tox config in the src folder.



---

archive/issue_comments_484305.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tobiasdiez](#comment:16):\n> The only point where I'm not sure is whether the src/tox.ini file is really needed, or if it can be combined with the tox.ini in the root directory. \n\nYes, I have been debating this with myself actually, but in the end I think it is important to keep src/tox.ini simple and readable -- the portability testing stuff in the root can be overwhelming to developers.\n\n> Similarly, I'm not sure if sage -tox should always be relative to the tox config in the src folder.  \n\nThe purpose of this is to make it easy to run the tests on user code -- in the same way  that `sage -t` is often used.",
    "created_at": "2020-08-27T16:22:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484305",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tobiasdiez](#comment:16):
> The only point where I'm not sure is whether the src/tox.ini file is really needed, or if it can be combined with the tox.ini in the root directory. 

Yes, I have been debating this with myself actually, but in the end I think it is important to keep src/tox.ini simple and readable -- the portability testing stuff in the root can be overwhelming to developers.

> Similarly, I'm not sure if sage -tox should always be relative to the tox config in the src folder.  

The purpose of this is to make it easy to run the tests on user code -- in the same way  that `sage -t` is often used.



---

archive/issue_comments_484306.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI've tried it on a file (with system-wide tox and python):\n\n```\nsage-dev/src $ ../sage -tox  sage/graphs/generators/distance_regular.pyx \ndoctest run-test-pre: PYTHONHASHSEED='2313650994'\ndoctest run-test: commands[0] | sh -c '/mnt/opt/Sage/sage-dev/src/../sage -t -p 0 sage/graphs/generators/distance_regular.pyx'\nRunning doctests with ID 2020-08-27-17-20-03-d333763b.\nGit branch: HEAD\nUsing --optional=build,dochtml,e_antic,gap_packages,libsemigroups,meataxe,memlimit,normaliz,pynormaliz,sage\nDoctesting 1 file using 4 threads.\nsage -t --warn-long 108.5 --random-seed=0 sage/graphs/generators/distance_regular.pyx\n    [123 tests, 172.32 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 172.4 seconds\n    cpu time: 172.5 seconds\n    cumulative wall time: 172.3 seconds\ncoverage run-test-pre: PYTHONHASHSEED='2313650994'\ncoverage run-test: commands[0] | sh -c 'if [ -z \"sage/graphs/generators/distance_regular.pyx\" ]; then /mnt/opt/Sage/sage-dev/src/../sage --coverageall; else /mnt/opt/Sage/sage-dev/src/../sage --coverage sage/graphs/generators/distance_regular.pyx; fi'\n------------------------------------------------------------------------\nSCORE sage/graphs/generators/distance_regular.pyx: 100.0% (30 of 30)\n------------------------------------------------------------------------\nstartuptime run-test-pre: PYTHONHASHSEED='2313650994'\nstartuptime run-test: commands[0] | sh -c '/mnt/opt/Sage/sage-dev/src/../sage --startuptime sage/graphs/generators/distance_regular.pyx'\n[]\nTraceback (most recent call last):\n  File \"/mnt/opt/Sage/sage-dev/src/bin/sage-startuptime.py\", line 131, in <module>\n    raise ValueError('\"' + module_arg + '\" does not uniquely determine Sage module.')\nValueError: \"sage/graphs/generators/distance_regular.pyx\" does not uniquely determine Sage module.\nERROR: InvocationError for command /bin/sh -c '/mnt/opt/Sage/sage-dev/src/../sage --startuptime sage/graphs/generators/distance_regular.pyx' (exited with code 1)\npycodestyle installed: pycodestyle==2.6.0\npycodestyle run-test-pre: PYTHONHASHSEED='2313650994'\npycodestyle run-test: commands[0] | pycodestyle sage/graphs/generators/distance_regular.pyx\n  unknown option 'description' ignored\nsage/graphs/generators/distance_regular.pyx:547:28: E701 multiple statements on one line (colon)\nERROR: InvocationError for command /mnt/opt/Sage/sage-dev/src/.tox/pycodestyle/bin/pycodestyle sage/graphs/generators/distance_regular.pyx (exited with code 1)\n___________________________________________________________________________ summary ___________________________________________________________________________\n  doctest: commands succeeded\n  coverage: commands succeeded\nERROR:   startuptime: commands failed\nERROR:   pycodestyle: commands failed\n```\n\nnot sure I  understand the errors from `pycodestyle` and  `startuptime` - do I have everything set up right?\n\nIs it possible to do only, say, `pycodestyle` part?\n\n---\n\n`pycodestyle` output kind of makes sense (except that `unknown option 'description' ignored` thing)\n\ndoes `startuptime` only work for modules? (e.g. `sage/graphs/`) ?",
    "created_at": "2020-08-27T17:58:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484306",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

I've tried it on a file (with system-wide tox and python):

```
sage-dev/src $ ../sage -tox  sage/graphs/generators/distance_regular.pyx 
doctest run-test-pre: PYTHONHASHSEED='2313650994'
doctest run-test: commands[0] | sh -c '/mnt/opt/Sage/sage-dev/src/../sage -t -p 0 sage/graphs/generators/distance_regular.pyx'
Running doctests with ID 2020-08-27-17-20-03-d333763b.
Git branch: HEAD
Using --optional=build,dochtml,e_antic,gap_packages,libsemigroups,meataxe,memlimit,normaliz,pynormaliz,sage
Doctesting 1 file using 4 threads.
sage -t --warn-long 108.5 --random-seed=0 sage/graphs/generators/distance_regular.pyx
    [123 tests, 172.32 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 172.4 seconds
    cpu time: 172.5 seconds
    cumulative wall time: 172.3 seconds
coverage run-test-pre: PYTHONHASHSEED='2313650994'
coverage run-test: commands[0] | sh -c 'if [ -z "sage/graphs/generators/distance_regular.pyx" ]; then /mnt/opt/Sage/sage-dev/src/../sage --coverageall; else /mnt/opt/Sage/sage-dev/src/../sage --coverage sage/graphs/generators/distance_regular.pyx; fi'
------------------------------------------------------------------------
SCORE sage/graphs/generators/distance_regular.pyx: 100.0% (30 of 30)
------------------------------------------------------------------------
startuptime run-test-pre: PYTHONHASHSEED='2313650994'
startuptime run-test: commands[0] | sh -c '/mnt/opt/Sage/sage-dev/src/../sage --startuptime sage/graphs/generators/distance_regular.pyx'
[]
Traceback (most recent call last):
  File "/mnt/opt/Sage/sage-dev/src/bin/sage-startuptime.py", line 131, in <module>
    raise ValueError('"' + module_arg + '" does not uniquely determine Sage module.')
ValueError: "sage/graphs/generators/distance_regular.pyx" does not uniquely determine Sage module.
ERROR: InvocationError for command /bin/sh -c '/mnt/opt/Sage/sage-dev/src/../sage --startuptime sage/graphs/generators/distance_regular.pyx' (exited with code 1)
pycodestyle installed: pycodestyle==2.6.0
pycodestyle run-test-pre: PYTHONHASHSEED='2313650994'
pycodestyle run-test: commands[0] | pycodestyle sage/graphs/generators/distance_regular.pyx
  unknown option 'description' ignored
sage/graphs/generators/distance_regular.pyx:547:28: E701 multiple statements on one line (colon)
ERROR: InvocationError for command /mnt/opt/Sage/sage-dev/src/.tox/pycodestyle/bin/pycodestyle sage/graphs/generators/distance_regular.pyx (exited with code 1)
___________________________________________________________________________ summary ___________________________________________________________________________
  doctest: commands succeeded
  coverage: commands succeeded
ERROR:   startuptime: commands failed
ERROR:   pycodestyle: commands failed
```

not sure I  understand the errors from `pycodestyle` and  `startuptime` - do I have everything set up right?

Is it possible to do only, say, `pycodestyle` part?

---

`pycodestyle` output kind of makes sense (except that `unknown option 'description' ignored` thing)

does `startuptime` only work for modules? (e.g. `sage/graphs/`) ?



---

archive/issue_comments_484307.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@dimpase](#comment:18):\n> Is it possible to do only, say, `pycodestyle` part?\n\nYes, `tox -e pycodestyle`",
    "created_at": "2020-08-27T17:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484307",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@dimpase](#comment:18):
> Is it possible to do only, say, `pycodestyle` part?

Yes, `tox -e pycodestyle`



---

archive/issue_comments_484308.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n`startuptime` unfortunately has an inconsistent interface that wants a module name rather than a filename. Something that should probably be fixed",
    "created_at": "2020-08-27T18:00:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484308",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

`startuptime` unfortunately has an inconsistent interface that wants a module name rather than a filename. Something that should probably be fixed



---

archive/issue_comments_484309.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\ncan this be mentioned in the dev manual? then it would be a positive review.",
    "created_at": "2020-08-27T19:21:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484309",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

can this be mentioned in the dev manual? then it would be a positive review.



---

archive/issue_comments_484310.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOK, will do, adding to the documentation section from #30361",
    "created_at": "2020-08-27T20:25:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484310",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

OK, will do, adding to the documentation section from #30361



---

archive/issue_comments_484311.json:
```json
{
    "body": "Changed dependencies from **#30408** to **#30408, #30361**",
    "created_at": "2020-08-27T20:25:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484311",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30408** to **#30408, #30361**



---

archive/issue_comments_484312.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-08-27T20:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484312",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_419150.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-27T20:58:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419150"
}
```



---

archive/issue_events_419151.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-27T20:58:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419151"
}
```



---

archive/issue_comments_484313.json:
```json
{
    "body": "Changed dependencies from **#30408, #30361** to **#30408**",
    "created_at": "2020-08-27T21:04:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484313",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30408, #30361** to **#30408**



---

archive/issue_comments_484314.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThanks!",
    "created_at": "2020-08-27T21:04:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484314",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

Thanks!



---

archive/issue_comments_484315.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nFollow-up at #30452 and #30453",
    "created_at": "2020-08-27T21:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484315",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Follow-up at #30452 and #30453



---

archive/issue_comments_484316.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/command__sage__tox_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/command__sage__tox_)** to **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**",
    "created_at": "2020-09-06T21:51:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484316",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/command__sage__tox_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/command__sage__tox_)** to **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)**



---

archive/issue_events_419152.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-06T21:51:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419152"
}
```



---

archive/issue_events_419153.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "dfa0d227a520a8be33579933c186c6cf9ed7d124",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-09-06T21:51:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30410#event-419153"
}
```



---

archive/issue_comments_484317.json:
```json
{
    "body": "Changed commit from **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)** to none",
    "created_at": "2023-01-08T08:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30410",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30410#issuecomment-484317",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`eba708b`](https://github.com/sagemath/sagetrac-mirror/commit/eba708b89b9935f86d6db8369ef83bcfa1ca9d4b)** to none
