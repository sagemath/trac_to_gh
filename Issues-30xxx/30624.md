# Issue 30624: Improve wording and formatting of configure's recommendation message

archive/issues_030387.json:
```json
{
    "body": "**Context**\n\nRecent work on Sage's build system enables to use many\nsystem packages as possible when building Sage.\nSee meta-ticket #27330 for an overview.\n\nPart of that effort is to have `configure` end with\nrecommendations of extra system packages to install.\n\nMaking this recommendation system very precise would not\nbe sustainable. As a compromise, it recommends installing\npackages whenever\n\n- satisfactory versions of these packages\n  are not found to be already installed\n- some version of that OS has versions of these packages\n  that would avoid having to build them\n\n**Problem**\n\nWith the wording of the recommendation hint up to\nSage 9.2.beta12, users can be puzzled when it recommends\ninstalling a package that is already installed.\n\n**Solution**\n\nImprove the recommendation message and along the way\nmake it better stand out.\n\nBefore this ticket:\n\n```\nconfigure: hint: installing the following system packages\nis recommended and may avoid building some of the above SPKGs\nfrom source:\nconfigure:   $ sudo apt-get update\n$ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev\n```\n\nAfter this ticket:\n\n```\nconfigure:\n\n    hint: installing the following system packages, if not\n    already present, is recommended and may avoid building\n    them from source (some may have to be built anyway):\n\n    $ sudo apt-get update\n    $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev\n```\n\n\n**References**\n\nSee the 2020-09 discussion on sage-release,\nin particular these posts:\n\n- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/xtBCPrGrAgAJ\n- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/1IYw5RG_BQAJ\n- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/MWUqj400BgAJ\n\n**See also**\n\nSee also #30863 whose aim is the same (e.g., do not suggest to `sudo apt install sympow` if the reason was that the sympow already installed on the system was failing some tests).\n\nCC:  @egourgoulhon @orlitzky @mkoeppe @slel @tobiasdiez @seblabbe\n\nBranch/Commit: 72f00813745794bf1386517393bbf749d7aeb6a8\n\nReviewer: Matthias Koeppe, S\u00e9bastien Labb\u00e9\n\nAuthor: Samuel Leli\u00e8vre, Matthias Koeppe\n\nDependencies: #30606\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30624\n\n",
    "closed_at": "2020-12-05T22:13:18Z",
    "created_at": "2020-09-21T09:21:52Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Improve wording and formatting of configure's recommendation message",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30624",
    "user": "https://github.com/slel"
}
```
**Context**

Recent work on Sage's build system enables to use many
system packages as possible when building Sage.
See meta-ticket #27330 for an overview.

Part of that effort is to have `configure` end with
recommendations of extra system packages to install.

Making this recommendation system very precise would not
be sustainable. As a compromise, it recommends installing
packages whenever

- satisfactory versions of these packages
  are not found to be already installed
- some version of that OS has versions of these packages
  that would avoid having to build them

**Problem**

With the wording of the recommendation hint up to
Sage 9.2.beta12, users can be puzzled when it recommends
installing a package that is already installed.

**Solution**

Improve the recommendation message and along the way
make it better stand out.

Before this ticket:

```
configure: hint: installing the following system packages
is recommended and may avoid building some of the above SPKGs
from source:
configure:   $ sudo apt-get update
$ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev
```

After this ticket:

```
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid building
    them from source (some may have to be built anyway):

    $ sudo apt-get update
    $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev
```


**References**

See the 2020-09 discussion on sage-release,
in particular these posts:

- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/xtBCPrGrAgAJ
- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/1IYw5RG_BQAJ
- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/MWUqj400BgAJ

**See also**

See also #30863 whose aim is the same (e.g., do not suggest to `sudo apt install sympow` if the reason was that the sympow already installed on the system was failing some tests).

CC:  @egourgoulhon @orlitzky @mkoeppe @slel @tobiasdiez @seblabbe

Branch/Commit: 72f00813745794bf1386517393bbf749d7aeb6a8

Reviewer: Matthias Koeppe, Sébastien Labbé

Author: Samuel Lelièvre, Matthias Koeppe

Dependencies: #30606

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30624





---

archive/issue_comments_605631.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,14 +44,14 @@\n \n     hint: installing the following system packages, if not\n     already present, is recommended and may avoid building\n-    some of them from source (though some of them may\n-    have to be built anyway):\n+    them from source (some may have to be built anyway):\n \n     $ sudo apt-get update\n     $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev\n-\n ```\n \n+\n+**References**\n \n See the 2020-09 discussion on sage-release,\n in particular these posts:\n``````\n",
    "created_at": "2020-09-21T09:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605631",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,14 +44,14 @@
 
     hint: installing the following system packages, if not
     already present, is recommended and may avoid building
-    some of them from source (though some of them may
-    have to be built anyway):
+    them from source (some may have to be built anyway):
 
     $ sudo apt-get update
     $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev
-
 ```
 
+
+**References**
 
 See the 2020-09 discussion on sage-release,
 in particular these posts:
``````




---

archive/issue_comments_605632.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-05T07:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605632",
    "user": "https://github.com/slel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_605633.json:
```json
{
    "body": "Changing branch from \"\" to \"public/30624-improve-configure-recommendation-message\"",
    "created_at": "2020-10-05T07:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605633",
    "user": "https://github.com/slel"
}
```

Changing branch from "" to "public/30624-improve-configure-recommendation-message"



---

archive/issue_comments_605634.json:
```json
{
    "body": "Changing commit from \"\" to \"208d57272ee098e0e932a1356978e1cc99e9ce7c\"",
    "created_at": "2020-10-05T07:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605634",
    "user": "https://github.com/slel"
}
```

Changing commit from "" to "208d57272ee098e0e932a1356978e1cc99e9ce7c"



---

archive/issue_comments_605635.json:
```json
{
    "body": "<a id='comment:2'></a>Here is a branch.\n\nIllustration on macOS.\n\nBefore:\n\n```\n$ source .homebrew-build-env && ./bootstrap -q && ./configure\n...\nconfig.status: creating directory local/lib/pkgconfig\nconfig.status: creating directory local/share\nconfig.status: creating directory local/var/lib/sage/installed\nconfigure: notice: the following SPKGs did not find equivalent system packages: cbc coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_term_readline_gnu python3 tox\nchecking for the package system in use... -n (ignoring conda because no environment is active)\nhomebrew\nconfigure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs from source:\nconfigure:   $ brew install python3\n# To automatically take care of homebrew messages regarding\n# keg-only packages for the current shell session:\n  $ source /opt/s/sage9/.homebrew-build-env\n# Add this to your shell profile if you want it to persist between shell sessions.\nconfigure: After installation, re-run configure using:\nconfigure:   $ ./config.status --recheck && ./config.status\n```\n\nAfter:\n\n```\n$ source .homebrew-build-env && ./bootstrap -q && ./configure\n...\nconfig.status: creating directory local/lib/pkgconfig\nconfig.status: creating directory local/share\nconfig.status: creating directory local/var/lib/sage/installed\nconfigure:\n\n    notice: the following SPKGs did not find equivalent system packages:\n\n        cbc coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_term_readline_gnu python3 tox\n\nchecking for the package system in use... -n (ignoring conda because no environment is active)\nhomebrew\nconfigure:\n\n    hint: installing the following system packages, if not\n    already present, is recommended and may avoid having to\n    build them (though some may have to be built anyway):\n\n      $ brew install python3\n\n    Homebrew can issue suggestions regarding keg-only packages.\n    The following command is to automatically apply these suggestions.\n    Run it once to apply the suggestions for the current session.\n    Add it to your shell profile to apply them for all future sessions.\n\n      $ source /opt/s/sage92b6/.homebrew-build-env\n\n    After installation, re-run configure using:\n\n      $ ./config.status --recheck && ./config.status\n```\n\nIllustration on Debian.\n\nBefore:\n\n```\n$ ./bootstrap -q && ./configure\n...\nconfig.status: creating directory local/lib/pkgconfig\nconfig.status: creating directory local/share\nconfig.status: creating directory local/var/lib/sage/installed\nconfigure: notice: the following SPKGs did not find equivalent system packages: coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata tox\nchecking for the package system in use... debian\nconfigure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs\nfrom source:\nconfigure:   $ sudo apt-get update\n  $ sudo apt-get install pari-gp2c libnauty-dev\nconfigure: After installation, re-run configure using:\nconfigure:   $ ./config.status --recheck && ./config.status\n```\n\nAfter:\n\n```\n$ ./bootstrap -q && ./configure\n...\nconfig.status: creating directory local/lib/pkgconfig\nconfig.status: creating directory local/share\nconfig.status: creating directory local/var/lib/sage/installed\nconfigure:\n\n    notice: the following SPKGs did not find equivalent system packages:\n\n        coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata tox\n\nchecking for the package system in use... debian\nconfigure:\n\n    hint: installing the following system packages, if not\n    already present, is recommended and may avoid having to\n    build them (though some may have to be built anyway):\n\n      $ sudo apt-get update\n  $ sudo apt-get install pari-gp2c libnauty-dev\n\n    After installation, re-run configure using:\n\n      $ ./config.status --recheck && ./config.status\n```\n\n---\nNew commits:",
    "created_at": "2020-10-05T07:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605635",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>Here is a branch.

Illustration on macOS.

Before:

```
$ source .homebrew-build-env && ./bootstrap -q && ./configure
...
config.status: creating directory local/lib/pkgconfig
config.status: creating directory local/share
config.status: creating directory local/var/lib/sage/installed
configure: notice: the following SPKGs did not find equivalent system packages: cbc coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_term_readline_gnu python3 tox
checking for the package system in use... -n (ignoring conda because no environment is active)
homebrew
configure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs from source:
configure:   $ brew install python3
# To automatically take care of homebrew messages regarding
# keg-only packages for the current shell session:
  $ source /opt/s/sage9/.homebrew-build-env
# Add this to your shell profile if you want it to persist between shell sessions.
configure: After installation, re-run configure using:
configure:   $ ./config.status --recheck && ./config.status
```

After:

```
$ source .homebrew-build-env && ./bootstrap -q && ./configure
...
config.status: creating directory local/lib/pkgconfig
config.status: creating directory local/share
config.status: creating directory local/var/lib/sage/installed
configure:

    notice: the following SPKGs did not find equivalent system packages:

        cbc coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_term_readline_gnu python3 tox

checking for the package system in use... -n (ignoring conda because no environment is active)
homebrew
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid having to
    build them (though some may have to be built anyway):

      $ brew install python3

    Homebrew can issue suggestions regarding keg-only packages.
    The following command is to automatically apply these suggestions.
    Run it once to apply the suggestions for the current session.
    Add it to your shell profile to apply them for all future sessions.

      $ source /opt/s/sage92b6/.homebrew-build-env

    After installation, re-run configure using:

      $ ./config.status --recheck && ./config.status
```

Illustration on Debian.

Before:

```
$ ./bootstrap -q && ./configure
...
config.status: creating directory local/lib/pkgconfig
config.status: creating directory local/share
config.status: creating directory local/var/lib/sage/installed
configure: notice: the following SPKGs did not find equivalent system packages: coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata tox
checking for the package system in use... debian
configure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs
from source:
configure:   $ sudo apt-get update
  $ sudo apt-get install pari-gp2c libnauty-dev
configure: After installation, re-run configure using:
configure:   $ ./config.status --recheck && ./config.status
```

After:

```
$ ./bootstrap -q && ./configure
...
config.status: creating directory local/lib/pkgconfig
config.status: creating directory local/share
config.status: creating directory local/var/lib/sage/installed
configure:

    notice: the following SPKGs did not find equivalent system packages:

        coxeter3 gp2c libnauty libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata tox

checking for the package system in use... debian
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid having to
    build them (though some may have to be built anyway):

      $ sudo apt-get update
  $ sudo apt-get install pari-gp2c libnauty-dev

    After installation, re-run configure using:

      $ ./config.status --recheck && ./config.status
```

---
New commits:



---

archive/issue_comments_605636.json:
```json
{
    "body": "<a id='comment:3'></a>Polishing commits welcome (here or in a follow-up ticket).\n\nI'll update the \"before/after\" in the ticket description\nonce the branch gets positive review.",
    "created_at": "2020-10-05T07:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605636",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>Polishing commits welcome (here or in a follow-up ticket).

I'll update the "before/after" in the ticket description
once the branch gets positive review.



---

archive/issue_comments_605637.json:
```json
{
    "body": "<a id='comment:4'></a>This change is not good. # is the shell comment character.\nThe idea here is that (if PROMPT is not used) that you get a valid shell script as the output.\n\n```\n-        $IF_VERBOSE echo \"# To automatically take care of homebrew messages regarding \"\n-        $IF_VERBOSE echo \"# keg-only packages for the current shell session:\"\n+        $IF_VERBOSE echo \"\"\n+        $IF_VERBOSE echo \"    Homebrew can issue suggestions regarding keg-only packages.\"\n+        $IF_VERBOSE echo \"    The following command is to automatically apply these suggestions.\"\n```",
    "created_at": "2020-10-05T11:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605637",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>This change is not good. # is the shell comment character.
The idea here is that (if PROMPT is not used) that you get a valid shell script as the output.

```
-        $IF_VERBOSE echo "# To automatically take care of homebrew messages regarding "
-        $IF_VERBOSE echo "# keg-only packages for the current shell session:"
+        $IF_VERBOSE echo ""
+        $IF_VERBOSE echo "    Homebrew can issue suggestions regarding keg-only packages."
+        $IF_VERBOSE echo "    The following command is to automatically apply these suggestions."
```



---

archive/issue_comments_605638.json:
```json
{
    "body": "<a id='comment:5'></a>If you put this ticket on top of #30606, you could add customization of the comment prefix in the same way that #30606 adds customization of the prompt...",
    "created_at": "2020-10-05T11:56:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605638",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>If you put this ticket on top of #30606, you could add customization of the comment prefix in the same way that #30606 adds customization of the prompt...



---

archive/issue_comments_605639.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-10-05T19:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_605640.json:
```json
{
    "body": "Changing commit from \"208d57272ee098e0e932a1356978e1cc99e9ce7c\" to \"90ffc5575380b254a21ff92690249fd6895167be\"",
    "created_at": "2020-10-05T19:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "208d57272ee098e0e932a1356978e1cc99e9ce7c" to "90ffc5575380b254a21ff92690249fd6895167be"



---

archive/issue_comments_605641.json:
```json
{
    "body": "<a id='comment:7'></a>Rebased as I suggested. You can now modify the invocations of `sage-print-system-package-command` to use something like this for the desired effect:\n\n```\nbuild/bin/sage-print-system-package-command homebrew --verbose='     ' --prompt='               $ ' setup-build-env foo\n```",
    "created_at": "2020-10-05T19:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605641",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Rebased as I suggested. You can now modify the invocations of `sage-print-system-package-command` to use something like this for the desired effect:

```
build/bin/sage-print-system-package-command homebrew --verbose='     ' --prompt='               $ ' setup-build-env foo
```



---

archive/issue_comments_605642.json:
```json
{
    "body": "Changing author from \"\" to \"Samuel Leli\u00e8vre, Matthias Koeppe\"",
    "created_at": "2020-10-05T19:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605642",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Samuel Lelièvre, Matthias Koeppe"



---

archive/issue_comments_605643.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30606\"",
    "created_at": "2020-10-05T19:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605643",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#30606"



---

archive/issue_comments_605644.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-10-05T21:21:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605644",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_605645.json:
```json
{
    "body": "<a id='comment:10'></a>Your turn, Samuel...",
    "created_at": "2020-10-07T18:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605645",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Your turn, Samuel...



---

archive/issue_comments_605646.json:
```json
{
    "body": "<a id='comment:11'></a>Neither of the \"notice: ...\", \"hint: ...\",\nor \"After installation, ...\" parts start with \"# \".\n\nSo I tried to also avoid \"# \" for the text\non linking Homebrew's keg-only packages.\n\nThanks for showing me the correct way to do that.",
    "created_at": "2020-10-08T16:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605646",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>Neither of the "notice: ...", "hint: ...",
or "After installation, ..." parts start with "# ".

So I tried to also avoid "# " for the text
on linking Homebrew's keg-only packages.

Thanks for showing me the correct way to do that.



---

archive/issue_events_079630.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30624#event-79630"
}
```



---

archive/issue_comments_605647.json:
```json
{
    "body": "<a id='comment:13'></a>Samuel, do you plan to work on this?",
    "created_at": "2020-11-01T19:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605647",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Samuel, do you plan to work on this?



---

archive/issue_comments_605648.json:
```json
{
    "body": "<a id='comment:14'></a>FWIW, I've installed Sage 9.3.beta0 from scratch on Ubuntu 20.04; `configure` ends with the following recommendations:\n\n```\nconfigure: hint: installing the following system packages is recommended and may \navoid building some of the above SPKGs from source:\nconfigure:   $ sudo apt-get update \n  $ sudo apt-get install texlive-generic-extra texlive-xetex latexmk pandoc dvipng \ndefault-jdk ffmpeg libavdevice-dev libcdd-dev libcdd-tools libec-dev eclib-tools \nlibgc-dev libgiac-dev xcas pari-gp2c lcalc liblfunction-dev libnauty-dev nauty \npari-gp2c libpari-dev pari-doc pari-elldata pari-galdata pari-galpol pari-seadata \nsympow\n```\nNow, as mentioned in #29557#comment:56, `texlive-generic-extra` does not exist on Ubuntu 20.04 (there is `texlive-latex-extra`, which is already installed on my system). Moreover the recommended packages `texlive-xetex`,  `latexmk`, `pandoc`, `dvipng`, `default-jdk`, `ffmpeg`, `libavdevice-dev`, `libcdd-dev` and `libcdd-tools` are already installed on my system.",
    "created_at": "2020-11-02T20:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605648",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:14'></a>FWIW, I've installed Sage 9.3.beta0 from scratch on Ubuntu 20.04; `configure` ends with the following recommendations:

```
configure: hint: installing the following system packages is recommended and may 
avoid building some of the above SPKGs from source:
configure:   $ sudo apt-get update 
  $ sudo apt-get install texlive-generic-extra texlive-xetex latexmk pandoc dvipng 
default-jdk ffmpeg libavdevice-dev libcdd-dev libcdd-tools libec-dev eclib-tools 
libgc-dev libgiac-dev xcas pari-gp2c lcalc liblfunction-dev libnauty-dev nauty 
pari-gp2c libpari-dev pari-doc pari-elldata pari-galdata pari-galpol pari-seadata 
sympow
```
Now, as mentioned in #29557#comment:56, `texlive-generic-extra` does not exist on Ubuntu 20.04 (there is `texlive-latex-extra`, which is already installed on my system). Moreover the recommended packages `texlive-xetex`,  `latexmk`, `pandoc`, `dvipng`, `default-jdk`, `ffmpeg`, `libavdevice-dev`, `libcdd-dev` and `libcdd-tools` are already installed on my system.



---

archive/issue_comments_605649.json:
```json
{
    "body": "<a id='comment:16'></a>Updates of the package list and similar improvements -- please in #30930 or other tickets, not here.\n\nLet's keep this ticket narrowly focused on what is already on the branch.",
    "created_at": "2020-11-17T02:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605649",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Updates of the package list and similar improvements -- please in #30930 or other tickets, not here.

Let's keep this ticket narrowly focused on what is already on the branch.



---

archive/issue_comments_605650.json:
```json
{
    "body": "<a id='comment:17'></a>Samuel, please let me know if I can help with anything else to get this ticket finished.",
    "created_at": "2020-11-17T18:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605650",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Samuel, please let me know if I can help with anything else to get this ticket finished.



---

archive/issue_comments_605651.json:
```json
{
    "body": "Changing author from \"Samuel Leli\u00e8vre, Matthias Koeppe\" to \"Matthias Koeppe\"",
    "created_at": "2020-11-17T23:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605651",
    "user": "https://github.com/slel"
}
```

Changing author from "Samuel Lelièvre, Matthias Koeppe" to "Matthias Koeppe"



---

archive/issue_comments_605652.json:
```json
{
    "body": "<a id='comment:18'></a>What you did is good. Maybe set to `needs_review` and review as is?",
    "created_at": "2020-11-17T23:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605652",
    "user": "https://github.com/slel"
}
```

<a id='comment:18'></a>What you did is good. Maybe set to `needs_review` and review as is?



---

archive/issue_comments_605653.json:
```json
{
    "body": "<a id='comment:19'></a>The new options that I introduced for you (comment:7) are not used yet.",
    "created_at": "2020-11-18T00:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605653",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>The new options that I introduced for you (comment:7) are not used yet.



---

archive/issue_comments_605654.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe\" to \"Samuel Leli\u00e8vre, Matthias Koeppe\"",
    "created_at": "2020-11-18T00:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605654",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Matthias Koeppe" to "Samuel Lelièvre, Matthias Koeppe"



---

archive/issue_comments_605655.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,68 @@\n+**Context**\n \n+Recent work on Sage's build system enables to use many\n+system packages as possible when building Sage.\n+See meta-ticket #27330 for an overview.\n+\n+Part of that effort is to have `configure` end with\n+recommendations of extra system packages to install.\n+\n+Making this recommendation system very precise would not\n+be sustainable. As a compromise, it recommends installing\n+packages whenever\n+\n+- satisfactory versions of these packages\n+  are not found to be already installed\n+- some version of that OS has versions of these packages\n+  that would avoid having to build them\n+\n+**Problem**\n+\n+With the wording of the recommendation hint up to\n+Sage 9.2.beta12, users can be puzzled when it recommends\n+installing a package that is already installed.\n+\n+**Solution**\n+\n+Improve the recommendation message and along the way\n+make it better stand out.\n+\n+Before this ticket:\n+\n+```\n+configure: hint: installing the following system packages\n+is recommended and may avoid building some of the above SPKGs\n+from source:\n+configure:   $ sudo apt-get update\n+$ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev\n+```\n+\n+After this ticket:\n+\n+```\n+configure:\n+\n+    hint: installing the following system packages, if not\n+    already present, is recommended and may avoid building\n+    them from source (some may have to be built anyway):\n+\n+    $ sudo apt-get update\n+    $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev\n+```\n+\n+\n+**References**\n+\n+See the 2020-09 discussion on sage-release,\n+in particular these posts:\n+\n+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/xtBCPrGrAgAJ\n+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/1IYw5RG_BQAJ\n+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/MWUqj400BgAJ\n+\n+**See also**\n+\n+See also #30863 whose aim is the same (e.g., do not suggest to `sudo apt install sympow` if the reason was that the sympow already installed on the system was failing some tests).\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-11-25T10:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605655",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,68 @@
+**Context**
 
+Recent work on Sage's build system enables to use many
+system packages as possible when building Sage.
+See meta-ticket #27330 for an overview.
+
+Part of that effort is to have `configure` end with
+recommendations of extra system packages to install.
+
+Making this recommendation system very precise would not
+be sustainable. As a compromise, it recommends installing
+packages whenever
+
+- satisfactory versions of these packages
+  are not found to be already installed
+- some version of that OS has versions of these packages
+  that would avoid having to build them
+
+**Problem**
+
+With the wording of the recommendation hint up to
+Sage 9.2.beta12, users can be puzzled when it recommends
+installing a package that is already installed.
+
+**Solution**
+
+Improve the recommendation message and along the way
+make it better stand out.
+
+Before this ticket:
+
+```
+configure: hint: installing the following system packages
+is recommended and may avoid building some of the above SPKGs
+from source:
+configure:   $ sudo apt-get update
+$ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev
+```
+
+After this ticket:
+
+```
+configure:
+
+    hint: installing the following system packages, if not
+    already present, is recommended and may avoid building
+    them from source (some may have to be built anyway):
+
+    $ sudo apt-get update
+    $ sudo apt-get install libcdd-dev libcdd-tools libnauty-dev
+```
+
+
+**References**
+
+See the 2020-09 discussion on sage-release,
+in particular these posts:
+
+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/xtBCPrGrAgAJ
+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/1IYw5RG_BQAJ
+- https://groups.google.com/d/msg/sage-release/hobZzw74Rv0/MWUqj400BgAJ
+
+**See also**
+
+See also #30863 whose aim is the same (e.g., do not suggest to `sudo apt install sympow` if the reason was that the sympow already installed on the system was failing some tests).
 
 Comment: 1
 
``````




---

archive/issue_comments_605656.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-27T01:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605656",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_605657.json:
```json
{
    "body": "Changing commit from \"90ffc5575380b254a21ff92690249fd6895167be\" to \"72f00813745794bf1386517393bbf749d7aeb6a8\"",
    "created_at": "2020-11-27T01:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "90ffc5575380b254a21ff92690249fd6895167be" to "72f00813745794bf1386517393bbf749d7aeb6a8"



---

archive/issue_comments_605658.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe, ...\"",
    "created_at": "2020-11-27T01:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605658",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe, ..."



---

archive/issue_comments_605659.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-11-27T01:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605659",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_605660.json:
```json
{
    "body": "<a id='comment:24'></a>Ready for review",
    "created_at": "2020-11-27T01:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605660",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>Ready for review



---

archive/issue_comments_605661.json:
```json
{
    "body": "<a id='comment:25'></a>I just tested the branch on Ubuntu 18.04, I obtain:\n\n```\nconfigure:\n\n    notice: the following SPKGs did not find equivalent system packages:\n\n        _recommended boost coxeter3 gp2c igraph isl libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata\n        \nchecking for the package system in use... debian\nconfigure:\n\n    hint: installing the following system packages, if not\n    already present, is recommended and may avoid having to\n    build them (though some may have to be built anyway):\n\n      $ sudo apt-get update \n      $ sudo apt-get install  texlive-generic-extra texlive-xetex latexmk pandoc dvipng default-jdk ffmpeg libavdevice-dev libboost-dev pari-gp2c libigraph-dev libisl-dev\n\n    After installation, re-run configure using:\n\n      $ ./config.status --recheck && ./config.status\n         \n```\n\nShould `_recommended` be listed in the first list?",
    "created_at": "2020-11-27T07:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605661",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:25'></a>I just tested the branch on Ubuntu 18.04, I obtain:

```
configure:

    notice: the following SPKGs did not find equivalent system packages:

        _recommended boost coxeter3 gp2c igraph isl libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata
        
checking for the package system in use... debian
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid having to
    build them (though some may have to be built anyway):

      $ sudo apt-get update 
      $ sudo apt-get install  texlive-generic-extra texlive-xetex latexmk pandoc dvipng default-jdk ffmpeg libavdevice-dev libboost-dev pari-gp2c libigraph-dev libisl-dev

    After installation, re-run configure using:

      $ ./config.status --recheck && ./config.status
         
```

Should `_recommended` be listed in the first list?



---

archive/issue_comments_605662.json:
```json
{
    "body": "Changing reviewer from \"Matthias Koeppe, ...\" to \"Matthias Koeppe, S\u00e9bastien Labb\u00e9\"",
    "created_at": "2020-11-27T07:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605662",
    "user": "https://github.com/seblabbe"
}
```

Changing reviewer from "Matthias Koeppe, ..." to "Matthias Koeppe, Sébastien Labbé"



---

archive/issue_comments_605663.json:
```json
{
    "body": "<a id='comment:26'></a>> Should _recommended be listed in the first list? \n\n\nIf the answer to that question is yes, please change the status of this ticket to positive review.",
    "created_at": "2020-11-27T07:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605663",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:26'></a>> Should _recommended be listed in the first list? 


If the answer to that question is yes, please change the status of this ticket to positive review.



---

archive/issue_comments_605664.json:
```json
{
    "body": "<a id='comment:27'></a>> Should _recommended be listed in the first list? \n\n\nI just observed that this is the current behavior on 9.3.beta2. So, this is independent of this ticket.",
    "created_at": "2020-11-27T08:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605664",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:27'></a>> Should _recommended be listed in the first list? 


I just observed that this is the current behavior on 9.3.beta2. So, this is independent of this ticket.



---

archive/issue_comments_605665.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-27T08:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605665",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_605666.json:
```json
{
    "body": "<a id='comment:28'></a>Thank you!",
    "created_at": "2020-11-27T18:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605666",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>Thank you!



---

archive/issue_comments_605667.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:25 slabbe]:\n> I just tested the branch on Ubuntu 18.04, I obtain:\n> \n> \n> ```\n> configure:\n> \n>     notice: the following SPKGs did not find equivalent system packages:\n> \n>         _recommended boost coxeter3 gp2c igraph isl libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata\n> \n> Should `_recommended` be listed in the first list?\n\n\nI am making some changes in this direction - suppressing display of packages starting with underscore - in #29124",
    "created_at": "2020-11-27T18:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605667",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Replying to [comment:25 slabbe]:
> I just tested the branch on Ubuntu 18.04, I obtain:
> 
> 
> ```
> configure:
> 
>     notice: the following SPKGs did not find equivalent system packages:
> 
>         _recommended boost coxeter3 gp2c igraph isl libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata
> 
> Should `_recommended` be listed in the first list?


I am making some changes in this direction - suppressing display of packages starting with underscore - in #29124



---

archive/issue_comments_605668.json:
```json
{
    "body": "Changing branch from \"public/30624-improve-configure-recommendation-message\" to \"72f00813745794bf1386517393bbf749d7aeb6a8\"",
    "created_at": "2020-12-05T22:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605668",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/30624-improve-configure-recommendation-message" to "72f00813745794bf1386517393bbf749d7aeb6a8"



---

archive/issue_events_079631.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-05T22:13:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30624#event-79631"
}
```



---

archive/issue_comments_605669.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-05T22:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30624#issuecomment-605669",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
