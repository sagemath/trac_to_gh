# Issue 30251: ExtPowerFreeModule, ExtPowerDualFreeModule: Simplify _repr_

archive/issues_030014.json:
```json
{
    "assignees": [],
    "body": "... using `ZZ.ordinal_str()`\n\nCC:  @egourgoulhon @tscrim @mjungmath\n\nComponent: **linear algebra**\n\nAuthor: **Matthias Koeppe**\n\nBranch: **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**\n\nReviewer: **Eric Gourgoulhon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30251_\n\n",
    "closed_at": "2020-08-14T22:23:11Z",
    "created_at": "2020-07-30T02:17:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20trivial%20/%205",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "ExtPowerFreeModule, ExtPowerDualFreeModule: Simplify _repr_",
    "type": "issue",
    "updated_at": "2020-08-17T09:40:21Z",
    "url": "https://github.com/sagemath/sage/issues/30251",
    "user": "https://github.com/mkoeppe"
}
```
... using `ZZ.ordinal_str()`

CC:  @egourgoulhon @tscrim @mjungmath

Component: **linear algebra**

Author: **Matthias Koeppe**

Branch: **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**

Reviewer: **Eric Gourgoulhon**

_Issue created by migration from https://trac.sagemath.org/ticket/30251_





---

archive/issue_events_413629.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-30T02:17:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413629"
}
```



---

archive/issue_events_413630.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-30T02:17:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413630"
}
```



---

archive/issue_events_413631.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-30T02:17:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20trivial%20/%205",
    "label_color": "fff9e5",
    "label_name": "p: trivial / 5",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413631"
}
```



---

archive/issue_events_413632.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-30T02:17:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413632"
}
```



---

archive/issue_comments_479739.json:
```json
{
    "body": "Branch: **[u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_)**",
    "created_at": "2020-07-30T02:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479739",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_)**



---

archive/issue_comments_479740.json:
```json
{
    "body": "Commit: **[`56691cd`](https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484)**",
    "created_at": "2020-07-30T02:18:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479740",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`56691cd`](https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484)**



---

archive/issue_events_413633.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-30T02:18:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413633"
}
```



---

archive/issue_comments_479741.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484\"><code>56691cd</code></a></td><td><code>ExtPowerFreeModule, ExtPowerDualFreeModule._repr_: Simplify by using the ordinal_str method</code></td></tr></table>\n",
    "created_at": "2020-07-30T02:18:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479741",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484"><code>56691cd</code></a></td><td><code>ExtPowerFreeModule, ExtPowerDualFreeModule._repr_: Simplify by using the ordinal_str method</code></td></tr></table>




---

archive/issue_comments_479742.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nNice simplification! To secure it, one should probably perform\n\n```diff\n- self._degree = degree\n+ self._degree = ZZ(degree)\n```\nin the `__init__` method of `ExtPowerFreeModule` and `ExtPowerDualFreeModule`.",
    "created_at": "2020-07-30T12:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479742",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:3" align="right">comment:3</div>

Nice simplification! To secure it, one should probably perform

```diff
- self._degree = degree
+ self._degree = ZZ(degree)
```
in the `__init__` method of `ExtPowerFreeModule` and `ExtPowerDualFreeModule`.



---

archive/issue_comments_479743.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nGood idea!",
    "created_at": "2020-07-30T15:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479743",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Good idea!



---

archive/issue_comments_479744.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455\"><code>47caa8a</code></a></td><td><code>ExtPowerFreeModule, ExtPowerDualFreeModule: Make sure _degree is an Integer</code></td></tr></table>\n",
    "created_at": "2020-07-30T15:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479744",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455"><code>47caa8a</code></a></td><td><code>ExtPowerFreeModule, ExtPowerDualFreeModule: Make sure _degree is an Integer</code></td></tr></table>




---

archive/issue_comments_479745.json:
```json
{
    "body": "Changed commit from **[`56691cd`](https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**",
    "created_at": "2020-07-30T15:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479745",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`56691cd`](https://github.com/sagemath/sagetrac-mirror/commit/56691cd0fce13943886267de00217e7f64815484)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**



---

archive/issue_comments_479746.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n(pushed to wrong ticket)",
    "created_at": "2020-07-30T16:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479746",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6" align="right">comment:6</div>

(pushed to wrong ticket)



---

archive/issue_comments_479747.json:
```json
{
    "body": "Changed commit from **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)** to **[`6f1bc22`](https://github.com/sagemath/sagetrac-mirror/commit/6f1bc22335560496f7a09d72b9a0635bb6b21ee5)**",
    "created_at": "2020-07-30T16:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479747",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)** to **[`6f1bc22`](https://github.com/sagemath/sagetrac-mirror/commit/6f1bc22335560496f7a09d72b9a0635bb6b21ee5)**



---

archive/issue_comments_479748.json:
```json
{
    "body": "Changed commit from **[`6f1bc22`](https://github.com/sagemath/sagetrac-mirror/commit/6f1bc22335560496f7a09d72b9a0635bb6b21ee5)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**",
    "created_at": "2020-07-30T16:12:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479748",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6f1bc22`](https://github.com/sagemath/sagetrac-mirror/commit/6f1bc22335560496f7a09d72b9a0635bb6b21ee5)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**



---

archive/issue_comments_479749.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n(repaired push to wrong ticket)",
    "created_at": "2020-07-30T16:12:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479749",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7" align="right">comment:7</div>

(repaired push to wrong ticket)



---

archive/issue_comments_479750.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThis is just a general comment not only related to this ticket (I picked this ticket randomly), but worth to emphasize once again: the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence. Please be aware of that fact. I don't think it will go so far, but it would be very sad if the `manifolds` module would be unusable in the upcoming version of Sage.\n\nFurthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.",
    "created_at": "2020-07-30T16:18:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479750",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:8" align="right">comment:8</div>

This is just a general comment not only related to this ticket (I picked this ticket randomly), but worth to emphasize once again: the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence. Please be aware of that fact. I don't think it will go so far, but it would be very sad if the `manifolds` module would be unusable in the upcoming version of Sage.

Furthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.



---

archive/issue_comments_479751.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mjungmath](#comment%3A8):\n> the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence.\n\nThanks. Well, that's why we have doctests and peer review. I run the doctests also in the manifolds module -- and the patchbot runs all doctests.\n\n> Furthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.\n\nAbsolutely. I'll hope to do that when I have learned more about the manifolds code (I hope to be using this code soon for some of my research), or when it becomes necessary because of changes in the tensor modules code. Do feel free to make these changes if you would like them earlier.",
    "created_at": "2020-07-30T17:01:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479751",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mjungmath](#comment%3A8):
> the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence.

Thanks. Well, that's why we have doctests and peer review. I run the doctests also in the manifolds module -- and the patchbot runs all doctests.

> Furthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.

Absolutely. I'll hope to do that when I have learned more about the manifolds code (I hope to be using this code soon for some of my research), or when it becomes necessary because of changes in the tensor modules code. Do feel free to make these changes if you would like them earlier.



---

archive/issue_comments_479752.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mjungmath](#comment%3A8):\n> This is just a general comment not only related to this ticket (I picked this ticket randomly), but worth to emphasize once again: the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence. Please be aware of that fact. I don't think it will go so far, but it would be very sad if the `manifolds` module would be unusable in the upcoming version of Sage.\n\n\nThanks for expressing your concern. However, as Matthias pointed out in his reply (comment:9), doctests shall prevent breakage in the manifold part. It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. When there is a significant change in the manifold/tensor code, I usually run by hand some selected examples from the above page, typically, the [S2 sphere](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb), the [S3 one](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S3_Hopf.ipynb), the [Kerr spacetime](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb) (good test of parallel computation of the Riemann tensor) and the [anti-de Sitter space](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_anti_de_Sitter.ipynb). An automated test suite would be of great help in this respect. \n\nAnother concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). \n\nThat being said, I think the changes in the `tensor` modules proposed by Matthias are great improvements. In particular, they shall make `FiniteRankFreeModule` usable for other purposes than tensor field computations on smooth manifolds. \n\n> Furthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.\n\nIndeed!",
    "created_at": "2020-07-30T18:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479752",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mjungmath](#comment%3A8):
> This is just a general comment not only related to this ticket (I picked this ticket randomly), but worth to emphasize once again: the deeper you dig and the more comprehensive your modifications are in the `tensor` module, the more likely it may corrupt the manifolds code, as there is a *very* strong dependence. Please be aware of that fact. I don't think it will go so far, but it would be very sad if the `manifolds` module would be unusable in the upcoming version of Sage.


Thanks for expressing your concern. However, as Matthias pointed out in his reply (comment:9), doctests shall prevent breakage in the manifold part. It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. When there is a significant change in the manifold/tensor code, I usually run by hand some selected examples from the above page, typically, the [S2 sphere](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb), the [S3 one](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S3_Hopf.ipynb), the [Kerr spacetime](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb) (good test of parallel computation of the Riemann tensor) and the [anti-de Sitter space](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_anti_de_Sitter.ipynb). An automated test suite would be of great help in this respect. 

Another concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). 

That being said, I think the changes in the `tensor` modules proposed by Matthias are great improvements. In particular, they shall make `FiniteRankFreeModule` usable for other purposes than tensor field computations on smooth manifolds. 

> Furthermore, since the `manifolds` module is similarly structured, it is very likely that analogous improvements can be applied there, too.

Indeed!



---

archive/issue_comments_479753.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@egourgoulhon](#comment%3A10):\n> It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. \n\n+1. Could they possibly be added as thematic tutorials in the main sage tree, or are there technical limitations that would prevent that?\n\n> Another concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). \n\nYes, this is an important point - and one for which Sage unfortunately does not have a very good solution. Sure - we notice performance regressions sometimes when doctests suddenly time out. But obviously doctests are not very well suited as benchmarks. (One might think about \"# optional - benchmark\" annotations though...)\n\n(By the way, some of the doctests in sage.manifolds probably should be marked \"long\" -- I frequently see them time out in the automated tests on [GitHub](../wiki/GitHub) actions - see for example https://github.com/sagemath/sage/runs/910575697?check_suite_focus=true)",
    "created_at": "2020-07-30T18:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479753",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@egourgoulhon](#comment%3A10):
> It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. 

+1. Could they possibly be added as thematic tutorials in the main sage tree, or are there technical limitations that would prevent that?

> Another concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). 

Yes, this is an important point - and one for which Sage unfortunately does not have a very good solution. Sure - we notice performance regressions sometimes when doctests suddenly time out. But obviously doctests are not very well suited as benchmarks. (One might think about "# optional - benchmark" annotations though...)

(By the way, some of the doctests in sage.manifolds probably should be marked "long" -- I frequently see them time out in the automated tests on [GitHub](../wiki/GitHub) actions - see for example https://github.com/sagemath/sage/runs/910575697?check_suite_focus=true)



---

archive/issue_comments_479754.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks for pointing this out in such detail, Eric. I was not sure how \"deep\" the doctesting of the patchbot actually goes.\n\n> That being said, I think the changes in the tensor modules proposed by Matthias are great improvements. In particular, they shall make FiniteRankFreeModule usable for other purposes than tensor field computations on smooth manifolds. \n\nI didn't mean to be dismissive, sorry. I think the modifications and the effort by Matthias are extremely beneficial to the project. :)",
    "created_at": "2020-07-30T18:23:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479754",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks for pointing this out in such detail, Eric. I was not sure how "deep" the doctesting of the patchbot actually goes.

> That being said, I think the changes in the tensor modules proposed by Matthias are great improvements. In particular, they shall make FiniteRankFreeModule usable for other purposes than tensor field computations on smooth manifolds. 

I didn't mean to be dismissive, sorry. I think the modifications and the effort by Matthias are extremely beneficial to the project. :)



---

archive/issue_comments_479755.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nNo worries!",
    "created_at": "2020-07-30T18:24:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479755",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

No worries!



---

archive/issue_comments_479756.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nGood to go. Thanks!",
    "created_at": "2020-07-30T21:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479756",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:14" align="right">comment:14</div>

Good to go. Thanks!



---

archive/issue_comments_479757.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2020-07-30T21:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479757",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_events_413634.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-30T21:06:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413634"
}
```



---

archive/issue_events_413635.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-07-30T21:06:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413635"
}
```



---

archive/issue_comments_479758.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThank you!",
    "created_at": "2020-07-30T21:07:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479758",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Thank you!



---

archive/issue_comments_479759.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@mkoeppe](#comment%3A11):\n> Replying to [@egourgoulhon](#comment%3A10):\n> > It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. \n\n> \n> +1. Could they possibly be added as thematic tutorials in the main sage tree, or are there technical limitations that would prevent that?\n\nThe large CPU times could prevent to add these examples to the thematic tutorials, which are doctested at each run of `make ptestlong`. For instance, if you look at the last cell of the [Kerr notebook](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb), you see that it takes about 6 min when running in parallel on 8 processes. NB: most of this CPU time is not spent in the actual tensor calculations, but in the simplifications of the involved symbolic expressions. \n> \n> > Another concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). \n\n> \n> Yes, this is an important point - and one for which Sage unfortunately does not have a very good solution. Sure - we notice performance regressions sometimes when doctests suddenly time out. But obviously doctests are not very well suited as benchmarks. (One might think about \"# optional - benchmark\" annotations though...)\n> \n> (By the way, some of the doctests in sage.manifolds probably should be marked \"long\" -- I frequently see them time out in the automated tests on [GitHub](../wiki/GitHub) actions - see for example https://github.com/sagemath/sage/runs/910575697?check_suite_focus=true)\n\nYes, we should open a ticket for this.",
    "created_at": "2020-07-30T21:29:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479759",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@mkoeppe](#comment%3A11):
> Replying to [@egourgoulhon](#comment%3A10):
> > It remains true that doctests are not exhaustive and it will be more satisfactory to have a more comprehensive test suite, albeit more CPU consuming. Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. 

> 
> +1. Could they possibly be added as thematic tutorials in the main sage tree, or are there technical limitations that would prevent that?

The large CPU times could prevent to add these examples to the thematic tutorials, which are doctested at each run of `make ptestlong`. For instance, if you look at the last cell of the [Kerr notebook](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb), you see that it takes about 6 min when running in parallel on 8 processes. NB: most of this CPU time is not spent in the actual tensor calculations, but in the simplifications of the involved symbolic expressions. 
> 
> > Another concern one might have is performance, which is not tracked by doctests, but could be in the test suite (note that there is a total CPU time measurement in the Kerr notebook mentioned above). 

> 
> Yes, this is an important point - and one for which Sage unfortunately does not have a very good solution. Sure - we notice performance regressions sometimes when doctests suddenly time out. But obviously doctests are not very well suited as benchmarks. (One might think about "# optional - benchmark" annotations though...)
> 
> (By the way, some of the doctests in sage.manifolds probably should be marked "long" -- I frequently see them time out in the automated tests on [GitHub](../wiki/GitHub) actions - see for example https://github.com/sagemath/sage/runs/910575697?check_suite_focus=true)

Yes, we should open a ticket for this.



---

archive/issue_comments_479760.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**",
    "created_at": "2020-08-14T22:23:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479760",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/extpowerfreemodule__extpowerdualfreemodule__simplify__repr_)** to **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)**



---

archive/issue_events_413636.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-14T22:23:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413636"
}
```



---

archive/issue_events_413637.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "66472811de3a55c81bfc194827d9c765c51f2f16",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-14T22:23:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30251#event-413637"
}
```



---

archive/issue_comments_479761.json:
```json
{
    "body": "Changed commit from **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)** to none",
    "created_at": "2020-08-14T23:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479761",
    "user": "https://github.com/slel"
}
```

Changed commit from **[`47caa8a`](https://github.com/sagemath/sagetrac-mirror/commit/47caa8aa7a3c4c65c553661730d7c9d2cdd88455)** to none



---

archive/issue_comments_479762.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@egourgoulhon](#comment%3A10):\n>\n> Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. \n\nOr use [nbval](https://pypi.org/project/nbval/).",
    "created_at": "2020-08-14T23:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479762",
    "user": "https://github.com/slel"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@egourgoulhon](#comment%3A10):
>
> Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. 

Or use [nbval](https://pypi.org/project/nbval/).



---

archive/issue_comments_479763.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@slel](#comment%3A18):\n> Replying to [@egourgoulhon](#comment%3A10):\n> >\n> > Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. \n\n> \n> Or use [nbval](https://pypi.org/project/nbval/).\n\nThank you Samuel for the tip! I was not aware of nbval.",
    "created_at": "2020-08-17T09:40:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30251",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30251#issuecomment-479763",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@slel](#comment%3A18):
> Replying to [@egourgoulhon](#comment%3A10):
> >
> > Such a suite could be derived from the [manifold examples page](https://sagemanifolds.obspm.fr/examples.html). I guess one shall first turn these Jupyter notebooks into rst files, via the export menu. 

> 
> Or use [nbval](https://pypi.org/project/nbval/).

Thank you Samuel for the tip! I was not aware of nbval.
