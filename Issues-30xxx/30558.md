# Issue 30558: Implement the conjugate of a set partition

archive/issues_030321.json:
```json
{
    "body": "Implement the notion of the conjugate of a set partition defined in \"On Conjugates for Set Partitions and Integer Compositions\" by David Callan for the combinatorial class `SetPartition`\n\nCC:  @saliola @anneschilling\n\nKeywords: set partitions, conjugate\n\nBranch/Commit: 7e6a9ec3abca9e4f924ed82a9ecca35fada37d35\n\nReviewer: Anne Schilling, Fr\u00e9d\u00e9ric Chapoton, Samuel Leli\u00e8vre\n\nAuthor: Mike Zabrocki\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30558\n\n",
    "closed_at": "2020-11-07T16:22:34Z",
    "created_at": "2020-09-11T19:08:05Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Implement the conjugate of a set partition",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30558",
    "user": "https://github.com/zabrocki"
}
```
Implement the notion of the conjugate of a set partition defined in "On Conjugates for Set Partitions and Integer Compositions" by David Callan for the combinatorial class `SetPartition`

CC:  @saliola @anneschilling

Keywords: set partitions, conjugate

Branch/Commit: 7e6a9ec3abca9e4f924ed82a9ecca35fada37d35

Reviewer: Anne Schilling, Frédéric Chapoton, Samuel Lelièvre

Author: Mike Zabrocki

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30558





---

archive/issue_comments_604164.json:
```json
{
    "body": "Changing commit from \"\" to \"cc4efc2e7935195986b34784bca7cb069eced595\"",
    "created_at": "2020-09-11T21:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604164",
    "user": "https://github.com/zabrocki"
}
```

Changing commit from "" to "cc4efc2e7935195986b34784bca7cb069eced595"



---

archive/issue_comments_604165.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[cc4efc2](https://git.sagemath.org/sage.git/commit?id=cc4efc2e7935195986b34784bca7cb069eced595)|`initial version and reference`|",
    "created_at": "2020-09-11T21:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604165",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[cc4efc2](https://git.sagemath.org/sage.git/commit?id=cc4efc2e7935195986b34784bca7cb069eced595)|`initial version and reference`|



---

archive/issue_comments_604166.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-11T21:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604166",
    "user": "https://github.com/zabrocki"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_604167.json:
```json
{
    "body": "Changing branch from \"\" to \"public/combinat/conjugate-set-partition-30558\"",
    "created_at": "2020-09-11T21:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604167",
    "user": "https://github.com/zabrocki"
}
```

Changing branch from "" to "public/combinat/conjugate-set-partition-30558"



---

archive/issue_comments_604168.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-12T05:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604168",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_604169.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Anne Schilling\"",
    "created_at": "2020-09-12T05:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604169",
    "user": "https://github.com/anneschilling"
}
```

Changing reviewer from "" to "Anne Schilling"



---

archive/issue_comments_604170.json:
```json
{
    "body": "Changing keywords from \"\" to \"set partitions, conjugate\".",
    "created_at": "2020-09-12T05:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604170",
    "user": "https://github.com/anneschilling"
}
```

Changing keywords from "" to "set partitions, conjugate".



---

archive/issue_comments_604171.json:
```json
{
    "body": "<a id='comment:3'></a>\ntoo late, but this is a bit ugly\n\n```\nif len(initials)+len(singletons)==0:\n```\nand could have been\n\n```\nif not initials and not singletons:\n```",
    "created_at": "2020-09-12T06:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604171",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
too late, but this is a bit ugly

```
if len(initials)+len(singletons)==0:
```
and could have been

```
if not initials and not singletons:
```



---

archive/issue_comments_604172.json:
```json
{
    "body": "<a id='comment:4'></a>\nIt might be fine to reopen; otherwise fix it in a follow-up ticket.\n\nAlong with pep8 and maybe these other small things:\n\n```diff\n-            return (support+[support[0]])[support.index(a)+1]\n+            return support[(support.index(a)+1) % len(support)]\n```\n\n```diff\n-            support = sorted([a for S in sp for a in S])\n+            support = sorted(a for S in sp for a in S)\n```\n\n```diff\n-        support = sorted([a for S in self for a in S])\n+        support = sorted(a for S in self for a in S)\n```",
    "created_at": "2020-09-12T10:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604172",
    "user": "https://github.com/slel"
}
```

<a id='comment:4'></a>
It might be fine to reopen; otherwise fix it in a follow-up ticket.

Along with pep8 and maybe these other small things:

```diff
-            return (support+[support[0]])[support.index(a)+1]
+            return support[(support.index(a)+1) % len(support)]
```

```diff
-            support = sorted([a for S in sp for a in S])
+            support = sorted(a for S in sp for a in S)
```

```diff
-        support = sorted([a for S in self for a in S])
+        support = sorted(a for S in self for a in S)
```



---

archive/issue_comments_604173.json:
```json
{
    "body": "Changing commit from \"cc4efc2e7935195986b34784bca7cb069eced595\" to \"6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2\"",
    "created_at": "2020-09-12T11:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cc4efc2e7935195986b34784bca7cb069eced595" to "6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2"



---

archive/issue_comments_604174.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-09-12T11:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_604175.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[6ce6f9e](https://git.sagemath.org/sage.git/commit/?id=6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2)|`changed as per comments`|",
    "created_at": "2020-09-12T11:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[6ce6f9e](https://git.sagemath.org/sage.git/commit/?id=6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2)|`changed as per comments`|



---

archive/issue_comments_604176.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|\n|[1cef639](https://git.sagemath.org/sage.git/commit/?id=1cef639348be0ad6320365cf004145c5058e57a3)|`pep8 changes`|",
    "created_at": "2020-09-12T12:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|[1cef639](https://git.sagemath.org/sage.git/commit/?id=1cef639348be0ad6320365cf004145c5058e57a3)|`pep8 changes`|



---

archive/issue_comments_604177.json:
```json
{
    "body": "Changing commit from \"6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2\" to \"1cef639348be0ad6320365cf004145c5058e57a3\"",
    "created_at": "2020-09-12T12:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6ce6f9eb614e7ba70b5d4ff8945c9f2c94fd6ca2" to "1cef639348be0ad6320365cf004145c5058e57a3"



---

archive/issue_comments_604178.json:
```json
{
    "body": "<a id='comment:7'></a>\nActually, this corner case also needs to be fixed:\n\n```\n    sage: s = SetPartitions(0).list()[0]                                                                                                                                \n    sage: s.conjugate()                                                                                                                                                 \n    ---------------------------------------------------------------------------\n    ValueError                                Traceback (most recent call last)\n```",
    "created_at": "2020-09-12T15:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604178",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:7'></a>
Actually, this corner case also needs to be fixed:

```
    sage: s = SetPartitions(0).list()[0]                                                                                                                                
    sage: s.conjugate()                                                                                                                                                 
    ---------------------------------------------------------------------------
    ValueError                                Traceback (most recent call last)
```



---

archive/issue_comments_604179.json:
```json
{
    "body": "Changing commit from \"1cef639348be0ad6320365cf004145c5058e57a3\" to \"5e86a5bfc7a31b4ce145577d0e730c27487bf654\"",
    "created_at": "2020-09-12T15:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1cef639348be0ad6320365cf004145c5058e57a3" to "5e86a5bfc7a31b4ce145577d0e730c27487bf654"



---

archive/issue_comments_604180.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[5e86a5b](https://git.sagemath.org/sage.git/commit/?id=5e86a5bfc7a31b4ce145577d0e730c27487bf654)|`catch corner case`|",
    "created_at": "2020-09-12T15:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[5e86a5b](https://git.sagemath.org/sage.git/commit/?id=5e86a5bfc7a31b4ce145577d0e730c27487bf654)|`catch corner case`|



---

archive/issue_comments_604181.json:
```json
{
    "body": "<a id='comment:9'></a>\nAdd a doc test to the corner cases too!",
    "created_at": "2020-09-12T16:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604181",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:9'></a>
Add a doc test to the corner cases too!



---

archive/issue_comments_604182.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[7e6a9ec](https://git.sagemath.org/sage.git/commit/?id=7e6a9ec3abca9e4f924ed82a9ecca35fada37d35)|`add doc test for corner case`|",
    "created_at": "2020-09-12T16:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[7e6a9ec](https://git.sagemath.org/sage.git/commit/?id=7e6a9ec3abca9e4f924ed82a9ecca35fada37d35)|`add doc test for corner case`|



---

archive/issue_comments_604183.json:
```json
{
    "body": "Changing commit from \"5e86a5bfc7a31b4ce145577d0e730c27487bf654\" to \"7e6a9ec3abca9e4f924ed82a9ecca35fada37d35\"",
    "created_at": "2020-09-12T16:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5e86a5bfc7a31b4ce145577d0e730c27487bf654" to "7e6a9ec3abca9e4f924ed82a9ecca35fada37d35"



---

archive/issue_comments_604184.json:
```json
{
    "body": "<a id='comment:11'></a>\nFr\u00e9d\u00e9ric, any final formatting touch?\n\nThen back to positive review?",
    "created_at": "2020-09-12T20:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604184",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>
Frédéric, any final formatting touch?

Then back to positive review?



---

archive/issue_comments_604185.json:
```json
{
    "body": "Changing reviewer from \"Anne Schilling\" to \"Anne Schilling, Fr\u00e9d\u00e9ric Chapoton, Samuel Leli\u00e8vre\"",
    "created_at": "2020-09-12T20:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604185",
    "user": "https://github.com/slel"
}
```

Changing reviewer from "Anne Schilling" to "Anne Schilling, Frédéric Chapoton, Samuel Lelièvre"



---

archive/issue_comments_604186.json:
```json
{
    "body": "<a id='comment:12'></a>\nYes, you can set it back to positive review!",
    "created_at": "2020-09-13T00:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604186",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:12'></a>
Yes, you can set it back to positive review!



---

archive/issue_comments_604187.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-13T06:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604187",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_079425.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30558#event-79425"
}
```



---

archive/issue_events_079426.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-07T16:22:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30558#event-79426"
}
```



---

archive/issue_comments_604188.json:
```json
{
    "body": "Changing branch from \"public/combinat/conjugate-set-partition-30558\" to \"7e6a9ec3abca9e4f924ed82a9ecca35fada37d35\"",
    "created_at": "2020-11-07T16:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604188",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/combinat/conjugate-set-partition-30558" to "7e6a9ec3abca9e4f924ed82a9ecca35fada37d35"



---

archive/issue_comments_604189.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-07T16:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30558",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30558#issuecomment-604189",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
