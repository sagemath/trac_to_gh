# Issue 30835: tox.ini: Add environments for testing with llvm / clang

archive/issues_030598.json:
```json
{
    "assignees": [],
    "body": "https://groups.google.com/d/msg/sage-devel/5lzj9n57oRI/09AtJyUBBQAJ\n\nWe add \n- a `tox` configuration factor for using `llvm`\n- a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)\n\nExamples:\n- `tox -e local-homebrew-macos-standard-llvm` \n- `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)\n- `tox -e docker-fedora-34-standard-llvm`\n\nPortability issues (solving them should not be a prerequisite for the present ticket):\n- `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ\n- `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ\n\nWhen it works on at least a few platforms, we will want to create GH Actions workflows that build Sage with llvm on various platforms for each release tag.\n\n\n\nCC:  @dimpase @jhpalmieri @videlec @kiwifb\n\nBranch/Commit: **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **porting**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30835_\n\n",
    "closed_at": "2021-07-23T20:11:31Z",
    "created_at": "2020-10-27T16:05:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "tox.ini: Add environments for testing with llvm / clang",
    "type": "issue",
    "updated_at": "2021-07-23T20:11:31Z",
    "url": "https://github.com/sagemath/sage/issues/30835",
    "user": "https://github.com/mkoeppe"
}
```
https://groups.google.com/d/msg/sage-devel/5lzj9n57oRI/09AtJyUBBQAJ

We add 
- a `tox` configuration factor for using `llvm`
- a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)

Examples:
- `tox -e local-homebrew-macos-standard-llvm` 
- `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)
- `tox -e docker-fedora-34-standard-llvm`

Portability issues (solving them should not be a prerequisite for the present ticket):
- `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ
- `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ

When it works on at least a few platforms, we will want to create GH Actions workflows that build Sage with llvm on various platforms for each release tag.



CC:  @dimpase @jhpalmieri @videlec @kiwifb

Branch/Commit: **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**

Reviewer: **Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **porting**

_Issue created by migration from https://trac.sagemath.org/ticket/30835_





---

archive/issue_events_425306.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-27T16:05:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425306"
}
```



---

archive/issue_events_425307.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-27T16:05:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "000080",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425307"
}
```



---

archive/issue_events_425308.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-27T16:05:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425308"
}
```



---

archive/issue_events_425309.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-27T16:05:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425309"
}
```



---

archive/issue_comments_493451.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493451",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_425310.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425310"
}
```



---

archive/issue_events_425311.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425311"
}
```



---

archive/issue_events_425312.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-09T22:20:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "title_is": "tox.ini, GH Actions: Add environments for testing with llvm / clang",
    "title_was": "tox.ini: Test with homebrew llvm",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425312"
}
```



---

archive/issue_comments_493452.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIs there a need to distinguish several versions of clang / LLVM on the same system for portability testing purposes?",
    "created_at": "2021-07-09T22:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493452",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Is there a need to distinguish several versions of clang / LLVM on the same system for portability testing purposes?



---

archive/issue_comments_493453.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n https://groups.google.com/d/msg/sage-devel/5lzj9n57oRI/09AtJyUBBQAJ\n \n+We add \n+- a `tox` configuration factor for using `llvm`\n+- a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)\n+- GH Actions workflows that build Sage with llvm on various platforms\n \n+\n+\n``````\n",
    "created_at": "2021-07-09T22:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493453",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
 https://groups.google.com/d/msg/sage-devel/5lzj9n57oRI/09AtJyUBBQAJ
 
+We add 
+- a `tox` configuration factor for using `llvm`
+- a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)
+- GH Actions workflows that build Sage with llvm on various platforms
 
+
+
``````




---

archive/issue_comments_493454.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@mkoeppe](#comment:3):\n> Is there a need to distinguish several versions of clang / LLVM on the same system for portability testing purposes?\n\nthat's probably too much trouble. There is  a distinction w.r.t. which standard C++ library clang uses, GNU's (libstdc++) or LLVM's (libc++), which is more important.",
    "created_at": "2021-07-10T10:35:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493454",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@mkoeppe](#comment:3):
> Is there a need to distinguish several versions of clang / LLVM on the same system for portability testing purposes?

that's probably too much trouble. There is  a distinction w.r.t. which standard C++ library clang uses, GNU's (libstdc++) or LLVM's (libc++), which is more important.



---

archive/issue_comments_493455.json:
```json
{
    "body": "Branch: **[u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang)**",
    "created_at": "2021-07-10T17:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493455",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang)**



---

archive/issue_comments_493456.json:
```json
{
    "body": "Commit: **[`3200b93`](https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da)**",
    "created_at": "2021-07-10T17:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493456",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`3200b93`](https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da)**



---

archive/issue_comments_493457.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHere's some preliminary distro package information - just guesswork based on reading https://repology.org/project/llvm/versions\n\nHelp with refining it is welcome\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da\"><code>3200b93</code></a></td><td><code>build/pkgs/llvm: New</code></td></tr></table>\n",
    "created_at": "2021-07-10T17:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493457",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Here's some preliminary distro package information - just guesswork based on reading https://repology.org/project/llvm/versions

Help with refining it is welcome

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da"><code>3200b93</code></a></td><td><code>build/pkgs/llvm: New</code></td></tr></table>




---

archive/issue_comments_493458.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWhat's the Fortran situation with LLVM? Use flang or gfortran?",
    "created_at": "2021-07-10T18:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493458",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

What's the Fortran situation with LLVM? Use flang or gfortran?



---

archive/issue_comments_493459.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6\"><code>8b16cf8</code></a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add configuration factor 'llvm'</code></td></tr></table>\n",
    "created_at": "2021-07-10T18:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493459",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6"><code>8b16cf8</code></a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add configuration factor 'llvm'</code></td></tr></table>




---

archive/issue_comments_493460.json:
```json
{
    "body": "Changed commit from **[`3200b93`](https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da)** to **[`8b16cf8`](https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6)**",
    "created_at": "2021-07-10T18:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493460",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3200b93`](https://github.com/sagemath/sagetrac-mirror/commit/3200b93082cb001d364db4bfd6d86c774b6293da)** to **[`8b16cf8`](https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6)**



---

archive/issue_comments_493461.json:
```json
{
    "body": "Changed commit from **[`8b16cf8`](https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6)** to **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**",
    "created_at": "2021-07-10T19:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493461",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8b16cf8`](https://github.com/sagemath/sagetrac-mirror/commit/8b16cf8d7a4509f4da6029e829a71c8d8c128ad6)** to **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**



---

archive/issue_comments_493462.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca\"><code>38e3d3e</code></a></td><td><code>tox.ini [homebrew-llvm]: Set CC, CXX to full path</code></td></tr></table>\n",
    "created_at": "2021-07-10T19:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493462",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca"><code>38e3d3e</code></a></td><td><code>tox.ini [homebrew-llvm]: Set CC, CXX to full path</code></td></tr></table>




---

archive/issue_comments_493463.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,5 +5,7 @@\n - a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)\n - GH Actions workflows that build Sage with llvm on various platforms\n \n+Examples:\n+- `tox -e local-homebrew-macos-standard-llvm` \n+- `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)\n \n-\n``````\n",
    "created_at": "2021-07-10T19:13:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493463",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,5 +5,7 @@
 - a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)
 - GH Actions workflows that build Sage with llvm on various platforms
 
+Examples:
+- `tox -e local-homebrew-macos-standard-llvm` 
+- `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)
 
-
``````




---

archive/issue_comments_493464.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@mkoeppe](#comment:7):\n> What's the Fortran situation with LLVM? Use flang or gfortran?\n\nflang is still not quite ready for prime time\n(I managed to build Sage using flang/clang, but it was not stable)\n\ngfortran is good.",
    "created_at": "2021-07-10T19:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493464",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@mkoeppe](#comment:7):
> What's the Fortran situation with LLVM? Use flang or gfortran?

flang is still not quite ready for prime time
(I managed to build Sage using flang/clang, but it was not stable)

gfortran is good.



---

archive/issue_comments_493465.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-07-10T19:55:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493465",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_493466.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,5 @@\n Examples:\n - `tox -e local-homebrew-macos-standard-llvm` \n - `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)\n+- `tox -e docker-fedora-34-standard-llvm`\n \n``````\n",
    "created_at": "2021-07-10T19:55:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493466",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,5 @@
 Examples:
 - `tox -e local-homebrew-macos-standard-llvm` 
 - `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)
+- `tox -e docker-fedora-34-standard-llvm`
 
``````




---

archive/issue_comments_493467.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,7 @@\n - `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)\n - `tox -e docker-fedora-34-standard-llvm`\n \n+Portability issues (solving them should not be a prerequisite for the present ticket):\n+- `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ\n+- `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ\n+\n``````\n",
    "created_at": "2021-07-10T19:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493467",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,7 @@
 - `tox -e local-homebrew-macos-standard-usrlocal-llvm` (use at your own risk - updates the global homebrew installation)
 - `tox -e docker-fedora-34-standard-llvm`
 
+Portability issues (solving them should not be a prerequisite for the present ticket):
+- `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ
+- `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ
+
``````




---

archive/issue_comments_493468.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,6 @@\n We add \n - a `tox` configuration factor for using `llvm`\n - a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)\n-- GH Actions workflows that build Sage with llvm on various platforms\n \n Examples:\n - `tox -e local-homebrew-macos-standard-llvm` \n@@ -14,3 +13,6 @@\n - `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ\n - `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ\n \n+When it works on at least a few platforms, we will want to create GH Actions workflows that build Sage with llvm on various platforms for each release tag.\n+\n+\n``````\n",
    "created_at": "2021-07-10T21:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493468",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,6 @@
 We add 
 - a `tox` configuration factor for using `llvm`
 - a script package (without spkg-install) representing system package `llvm` (https://repology.org/project/llvm/versions)
-- GH Actions workflows that build Sage with llvm on various platforms
 
 Examples:
 - `tox -e local-homebrew-macos-standard-llvm` 
@@ -14,3 +13,6 @@
 - `pynac` - https://groups.google.com/g/sage-devel/c/N03gtymVUnA/m/9WpvHZZRAAAJ
 - `linbox` - https://groups.google.com/g/sage-devel/c/4ZH2MwIY0js/m/bnax1dsvAAAJ
 
+When it works on at least a few platforms, we will want to create GH Actions workflows that build Sage with llvm on various platforms for each release tag.
+
+
``````




---

archive/issue_events_425313.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-10T21:21:24Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "title_is": "tox.ini: Add environments for testing with llvm / clang",
    "title_was": "tox.ini, GH Actions: Add environments for testing with llvm / clang",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425313"
}
```



---

archive/issue_events_425314.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-10T21:21:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425314"
}
```



---

archive/issue_comments_493469.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI tried `tox -e local-direct-llvm` on Fedora 32, seems to work.",
    "created_at": "2021-07-13T10:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493469",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

I tried `tox -e local-direct-llvm` on Fedora 32, seems to work.



---

archive/issue_comments_493470.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHow do I actually run tests in such a local setup (I can't use docker on that machine)",
    "created_at": "2021-07-13T10:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493470",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

How do I actually run tests in such a local setup (I can't use docker on that machine)



---

archive/issue_comments_493471.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nYou can do `tox -e local-direct-llvm -- ptest`, or `tox -e local-direct-llvm -- bash` if you want a shell",
    "created_at": "2021-07-13T16:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493471",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

You can do `tox -e local-direct-llvm -- ptest`, or `tox -e local-direct-llvm -- bash` if you want a shell



---

archive/issue_comments_493472.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI feel like I've had this happen before: I ran `tox -e local-homebrew-macos-standard-llvm` and by yesterday at 18:13 (according to the timestamp on the file in `logs/pkgs`) it said \"  [networkx-2.5.1] successfully installed.\" Then it sat there with no apparent activity until I hit ctrl-C today at 09:56.",
    "created_at": "2021-07-13T16:58:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493472",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">comment:18</div>

I feel like I've had this happen before: I ran `tox -e local-homebrew-macos-standard-llvm` and by yesterday at 18:13 (according to the timestamp on the file in `logs/pkgs`) it said "  [networkx-2.5.1] successfully installed." Then it sat there with no apparent activity until I hit ctrl-C today at 09:56.



---

archive/issue_comments_493473.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nPrime suspect is `gfan`'s testsuite - see #32088",
    "created_at": "2021-07-13T17:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493473",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Prime suspect is `gfan`'s testsuite - see #32088



---

archive/issue_comments_493474.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI reran and `gfan`'s testsuite passed. (I had deleted the old log files, so I don't know if that was the problem the first time.) `pillow` failed to build, though. (This is OS X 11.4.)",
    "created_at": "2021-07-13T20:24:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493474",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

I reran and `gfan`'s testsuite passed. (I had deleted the old log files, so I don't know if that was the problem the first time.) `pillow` failed to build, though. (This is OS X 11.4.)



---

archive/issue_comments_493475.json:
```json
{
    "body": "Attachment: **[pillow-8.1.2.log](https://github.com/sagemath/sage/files/ticket30835/pillow-8.1.2.log)**",
    "created_at": "2021-07-13T20:24:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493475",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[pillow-8.1.2.log](https://github.com/sagemath/sage/files/ticket30835/pillow-8.1.2.log)**



---

archive/issue_comments_493476.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jhpalmieri](#comment:21):\n> `pillow` failed to build, though. (This is OS X 11.4.)\n\nI think this is just that some of Apple's system headers can only be compiled with Apple's compiler.",
    "created_at": "2021-07-13T22:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493476",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jhpalmieri](#comment:21):
> `pillow` failed to build, though. (This is OS X 11.4.)

I think this is just that some of Apple's system headers can only be compiled with Apple's compiler.



---

archive/issue_comments_493477.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n[I asked a question like this before](https://github.com/sagemath/sage/issues/31567#comment:32), but should there be a `make` target (or similar) that cleans up the `.tox` directory? Or if we are using `tox`, are we just supposed to know what we're doing? Maybe [this](https://stackoverflow.com/questions/59563746/how-to-clean-a-tox-environment-after-running) is relevant.",
    "created_at": "2021-07-13T23:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493477",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

[I asked a question like this before](https://github.com/sagemath/sage/issues/31567#comment:32), but should there be a `make` target (or similar) that cleans up the `.tox` directory? Or if we are using `tox`, are we just supposed to know what we're doing? Maybe [this](https://stackoverflow.com/questions/59563746/how-to-clean-a-tox-environment-after-running) is relevant.



---

archive/issue_comments_493478.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI think what you want, in addition to just removing the .tox directory, is #31111 (`tox -e local-direct`: Clean up the effects of previous `tox -e local-....`)",
    "created_at": "2021-07-13T23:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493478",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

I think what you want, in addition to just removing the .tox directory, is #31111 (`tox -e local-direct`: Clean up the effects of previous `tox -e local-....`)



---

archive/issue_comments_493479.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@mkoeppe](#comment:22):\n> Replying to [@jhpalmieri](#comment:21):\n> > `pillow` failed to build, though. (This is OS X 11.4.)\n\n> I think this is just that some of Apple's system headers can only be compiled with Apple's compiler.\n\nNo, if you just do\n\n```diff\n+++ b/build/pkgs/pillow/spkg-install.in\n@@ -10,7 +10,7 @@ if [ \"$UNAME\" = \"Darwin\" ] ; then\n     # #29019\n     # https://github.com/python-pillow/Pillow/issues/3438#issuecomment-555019284\n     # https://apple.stackexchange.com/questions/372032/usr-include-missing-on-macos-catalina-with-xcode-11/372600#372600\n-    export CPATH=\"$CPATH:`xcrun --show-sdk-path`/usr/include\"\n+    export CFLAGS=\"$CFLAGS -DTARGET_OS_IPHONE=0 -DTARGET_OS_OSX=1 -DTARGET_OS_MACCATALYST=0\"\n fi\n \n if [ \"$CONDA_PREFIX\" != \"\" ]; then\n```\nthen Pillow builds with Homebrew's clang (perhaps there is a more intelligent way, including some header?).",
    "created_at": "2021-07-15T10:09:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493479",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@mkoeppe](#comment:22):
> Replying to [@jhpalmieri](#comment:21):
> > `pillow` failed to build, though. (This is OS X 11.4.)

> I think this is just that some of Apple's system headers can only be compiled with Apple's compiler.

No, if you just do

```diff
+++ b/build/pkgs/pillow/spkg-install.in
@@ -10,7 +10,7 @@ if [ "$UNAME" = "Darwin" ] ; then
     # #29019
     # https://github.com/python-pillow/Pillow/issues/3438#issuecomment-555019284
     # https://apple.stackexchange.com/questions/372032/usr-include-missing-on-macos-catalina-with-xcode-11/372600#372600
-    export CPATH="$CPATH:`xcrun --show-sdk-path`/usr/include"
+    export CFLAGS="$CFLAGS -DTARGET_OS_IPHONE=0 -DTARGET_OS_OSX=1 -DTARGET_OS_MACCATALYST=0"
 fi
 
 if [ "$CONDA_PREFIX" != "" ]; then
```
then Pillow builds with Homebrew's clang (perhaps there is a more intelligent way, including some header?).



---

archive/issue_comments_493480.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nwith the patch in [comment:25](#comment:25), I can build and doctest Sage on Homebrew  llvm/clang/clang++ just fine (modulo few known errors).\n(perpending `/usr/local/opt/llvm/bin` to PATH)",
    "created_at": "2021-07-15T11:51:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493480",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

with the patch in [comment:25](#comment:25), I can build and doctest Sage on Homebrew  llvm/clang/clang++ just fine (modulo few known errors).
(perpending `/usr/local/opt/llvm/bin` to PATH)



---

archive/issue_comments_493481.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nUpstream report?",
    "created_at": "2021-07-15T16:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493481",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Upstream report?



---

archive/issue_comments_493482.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@mkoeppe](#comment:27):\n> Upstream report?\n\ndo you have any idea what Pillow is doing in a non-standard way while building Python extensions?\n(after all, everything else builds, and these `TARGET_OS_...` are used in the SDK's `stdio.h` and `stdlib.h`)\n\nPerhaps it's a setuptools bug?",
    "created_at": "2021-07-15T17:40:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493482",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@mkoeppe](#comment:27):
> Upstream report?

do you have any idea what Pillow is doing in a non-standard way while building Python extensions?
(after all, everything else builds, and these `TARGET_OS_...` are used in the SDK's `stdio.h` and `stdlib.h`)

Perhaps it's a setuptools bug?



---

archive/issue_comments_493483.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nPillow's setup.py does a lot of \"discovery\", the details are messy. To isolate what is happening here, you could use the `PILLOW_BUILD_EXT` setting from tox.ini that I use for the `macos-nohomebrew` environment",
    "created_at": "2021-07-15T17:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493483",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Pillow's setup.py does a lot of "discovery", the details are messy. To isolate what is happening here, you could use the `PILLOW_BUILD_EXT` setting from tox.ini that I use for the `macos-nohomebrew` environment



---

archive/issue_comments_493484.json:
```json
{
    "body": "Replying to [ticket:30835 mkoeppe]:\n> Portability issues (solving them should not be a prerequisite for the present ticket):\n\nLet me emphasize that the scope of this ticket should be to add the test environments, which will facilitate testing and porting. \n\nIt is not within the scope to do all the porting work.",
    "created_at": "2021-07-15T17:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493484",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [ticket:30835 mkoeppe]:
> Portability issues (solving them should not be a prerequisite for the present ticket):

Let me emphasize that the scope of this ticket should be to add the test environments, which will facilitate testing and porting. 

It is not within the scope to do all the porting work.



---

archive/issue_comments_493485.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@mkoeppe](#comment:29):\n> Pillow's setup.py does a lot of \"discovery\", the details are messy. To isolate what is happening here, you could use the `PILLOW_BUILD_EXT` setting from tox.ini that I use for the `macos-nohomebrew` environment\n\nI am not sure I understand how to \n\"use the `PILLOW_BUILD_EXT` setting from tox.ini\"",
    "created_at": "2021-07-15T18:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493485",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@mkoeppe](#comment:29):
> Pillow's setup.py does a lot of "discovery", the details are messy. To isolate what is happening here, you could use the `PILLOW_BUILD_EXT` setting from tox.ini that I use for the `macos-nohomebrew` environment

I am not sure I understand how to 
"use the `PILLOW_BUILD_EXT` setting from tox.ini"



---

archive/issue_comments_493486.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nIf I \n\n```\nexport PILLOW_BUILD_EXT=\"--disable-platform-guessing --disable-jpeg2000 --disable-imagequant --disable-tiff --disable-lcms --disable-webp --disable-webpmux --disable-xcb\"\n```\nit cannot find `zlib`. If I remove `--disable-platform-guessing` it fails with \n\n```\nbuilding 'PIL._imagingmath' extension\nclang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -O2 -g -march=native -g -I/usr/local/Cellar/jpeg/9d/include -I/usr\n/local/Cellar/openjpeg/2.4.0/include/openjpeg-2.4 -I/usr/local/Cellar/libtiff/4.3.0/include -I/Users/dima/sage/local/var/tmp/sage/build/pillow-8.1.2/src -I/usr/local/Cellar/freetype/2.10.4/include/freetype2 -I/usr/local/Cellar/little-cms2\n/2.12/include -I/Users/dima/sage/local/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include -I/usr/local/include -I/usr/local/Cellar/freetype/2.10.4/include -I/Users/dima/sag\ne/local/include -I/usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9 -c src/_imagingmath.c -o build/temp.macosx-11-x86_64-3.9/src/_imagingmath.o\nclang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -O2 -g -march=native -g -DHAVE_LIBZ -DPILLOW_VERSION=\\\"8.1.2\\\" -I/\nusr/local/Cellar/jpeg/9d/include -I/usr/local/Cellar/openjpeg/2.4.0/include/openjpeg-2.4 -I/usr/local/Cellar/libtiff/4.3.0/include -I/Users/dima/sage/local/var/tmp/sage/build/pillow-8.1.2/src -I/usr/local/Cellar/freetype/2.10.4/include/fr\neetype2 -I/usr/local/Cellar/little-cms2/2.12/include -I/Users/dima/sage/local/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include -I/usr/local/include -I/usr/local/Cellar/fr\neetype/2.10.4/include -I/Users/dima/sage/local/include -I/usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9 -c src/_imaging.c -o build/temp.macosx-11-x86_64-3.9/src/_imaging.o\nIn file included from In file included from src/_imagingft.c:22:\nIn file included from /usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9/Python.h:25:\nIn file included from /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h:64:\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/_stdio.h:93:16: warning: pointer is missing a nullability type specifier (_Nonnull, _Nullable, or _Null_unspecified) [-Wnullability\n-completeness]\n        unsigned char   *_base;\n                        ^\n...\nIn file included from /usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9/Python.h:25:\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h:220:5: error: 'TARGET_OS_IPHONE' is not defined, evaluates to 0 [-Werror,-Wundef-prefix=TARGET_OS_]\n#if TARGET_OS_IPHONE\n    ^\n...\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdlib.h:181:5: error: 'TARGET_OS_IPHONE' is not defined, evaluates to 0 [-Werror,-Wundef-prefix=TARGET_OS_]\n#if TARGET_OS_IPHONE\n   ^\n```",
    "created_at": "2021-07-15T19:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493486",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

If I 

```
export PILLOW_BUILD_EXT="--disable-platform-guessing --disable-jpeg2000 --disable-imagequant --disable-tiff --disable-lcms --disable-webp --disable-webpmux --disable-xcb"
```
it cannot find `zlib`. If I remove `--disable-platform-guessing` it fails with 

```
building 'PIL._imagingmath' extension
clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -O2 -g -march=native -g -I/usr/local/Cellar/jpeg/9d/include -I/usr
/local/Cellar/openjpeg/2.4.0/include/openjpeg-2.4 -I/usr/local/Cellar/libtiff/4.3.0/include -I/Users/dima/sage/local/var/tmp/sage/build/pillow-8.1.2/src -I/usr/local/Cellar/freetype/2.10.4/include/freetype2 -I/usr/local/Cellar/little-cms2
/2.12/include -I/Users/dima/sage/local/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include -I/usr/local/include -I/usr/local/Cellar/freetype/2.10.4/include -I/Users/dima/sag
e/local/include -I/usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9 -c src/_imagingmath.c -o build/temp.macosx-11-x86_64-3.9/src/_imagingmath.o
clang -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -O2 -g -march=native -g -DHAVE_LIBZ -DPILLOW_VERSION=\"8.1.2\" -I/
usr/local/Cellar/jpeg/9d/include -I/usr/local/Cellar/openjpeg/2.4.0/include/openjpeg-2.4 -I/usr/local/Cellar/libtiff/4.3.0/include -I/Users/dima/sage/local/var/tmp/sage/build/pillow-8.1.2/src -I/usr/local/Cellar/freetype/2.10.4/include/fr
eetype2 -I/usr/local/Cellar/little-cms2/2.12/include -I/Users/dima/sage/local/include -I/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include -I/usr/local/include -I/usr/local/Cellar/fr
eetype/2.10.4/include -I/Users/dima/sage/local/include -I/usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9 -c src/_imaging.c -o build/temp.macosx-11-x86_64-3.9/src/_imaging.o
In file included from In file included from src/_imagingft.c:22:
In file included from /usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9/Python.h:25:
In file included from /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h:64:
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/_stdio.h:93:16: warning: pointer is missing a nullability type specifier (_Nonnull, _Nullable, or _Null_unspecified) [-Wnullability
-completeness]
        unsigned char   *_base;
                        ^
...
In file included from /usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/include/python3.9/Python.h:25:
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h:220:5: error: 'TARGET_OS_IPHONE' is not defined, evaluates to 0 [-Werror,-Wundef-prefix=TARGET_OS_]
#if TARGET_OS_IPHONE
    ^
...
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdlib.h:181:5: error: 'TARGET_OS_IPHONE' is not defined, evaluates to 0 [-Werror,-Wundef-prefix=TARGET_OS_]
#if TARGET_OS_IPHONE
   ^
```



---

archive/issue_events_425315.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-16T10:30:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425315"
}
```



---

archive/issue_events_425316.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-07-16T10:30:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425316"
}
```



---

archive/issue_comments_493487.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-07-16T10:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493487",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_493488.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nOK, let's deal with Homebrew clang on #32207",
    "created_at": "2021-07-16T10:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493488",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">comment:33</div>

OK, let's deal with Homebrew clang on #32207



---

archive/issue_comments_493489.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThanks",
    "created_at": "2021-07-16T14:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493489",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Thanks



---

archive/issue_comments_493490.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang)** to **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**",
    "created_at": "2021-07-23T20:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30835#issuecomment-493490",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__gh_actions__add_environments_for_testing_with_llvm___clang)** to **[`38e3d3e`](https://github.com/sagemath/sagetrac-mirror/commit/38e3d3ee6d36986dfa24af2333a1287c7924c8ca)**



---

archive/issue_events_425317.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-23T20:11:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425317"
}
```



---

archive/issue_events_425318.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "42577e873e48f194ff3c1617b49d38a5f68951da",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-23T20:11:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30835",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30835#event-425318"
}
```
