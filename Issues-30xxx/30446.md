# Issue 30446: Update pynac to 0.7.27 to fix wrong result on symbolic exponentiation

archive/issues_030209.json:
```json
{
    "body": "Before this ticket:\n\n```\nsage: n((24*sqrt(3))^(100/50))\n3.80392047155301e5927962146\nsage: n((24*sqrt(3))^(2))\n1728.00000000000\n```\nClearly, both should be the same, namely the second.\n\nThis was on SageMath 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).\n\nI've tried to reproduce, but my SageMath, as well as on CoCalc crashes. The error message on my machine was\n\n```\nTraceback (most recent call last):\n  File \"<string>\", line 25, in <module>\nModuleNotFoundError: No module named 'Cython'\nError while executing Python code.\nSaved trace to /home/dakrenn/.sage/crash_logs/crash_lqkqgydq.log\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\nAborted (core dumped)\n```\nHowever, my SageMath seems to be fine otherwise, `make ptestlong` passes.\nSame on current 9.2.beta9.\n\nCC:  @zimmermann6\n\nUpstream: None of the above - read trac for reasoning.\n\nReviewer: Dima Pasechnik, Matthias Koeppe\n\nAuthor: Ben Livingston, Dima Pasechnik\n\nBranch: ccdf77cba4f57f2e8f595dbeefb2fb604d9f9ace\n\nDependencies: #31118\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30446\n\n",
    "closed_at": "2021-03-07T17:06:32Z",
    "created_at": "2020-08-26T14:33:36Z",
    "labels": [
        "component: symbolics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Update pynac to 0.7.27 to fix wrong result on symbolic exponentiation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30446",
    "user": "https://github.com/dkrenn"
}
```
Before this ticket:

```
sage: n((24*sqrt(3))^(100/50))
3.80392047155301e5927962146
sage: n((24*sqrt(3))^(2))
1728.00000000000
```
Clearly, both should be the same, namely the second.

This was on SageMath 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).

I've tried to reproduce, but my SageMath, as well as on CoCalc crashes. The error message on my machine was

```
Traceback (most recent call last):
  File "<string>", line 25, in <module>
ModuleNotFoundError: No module named 'Cython'
Error while executing Python code.
Saved trace to /home/dakrenn/.sage/crash_logs/crash_lqkqgydq.log
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
Aborted (core dumped)
```
However, my SageMath seems to be fine otherwise, `make ptestlong` passes.
Same on current 9.2.beta9.

CC:  @zimmermann6

Upstream: None of the above - read trac for reasoning.

Reviewer: Dima Pasechnik, Matthias Koeppe

Author: Ben Livingston, Dima Pasechnik

Branch: ccdf77cba4f57f2e8f595dbeefb2fb604d9f9ace

Dependencies: #31118

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30446





---

archive/issue_comments_459090.json:
```json
{
    "body": "<a id='comment:1'></a>I confirm the error. I get exactly the same answers as in the original report. I am using Mac OS 10.15.5, and tested both 9.1 and 9.2b10. (The version with 100/2 is slow -- takes about 50 seconds.) \n\nWhen I tried `CoCalc`, it failed because it ran out of memory. (The memory gauge was over 3GB before it aborted.)",
    "created_at": "2020-08-26T16:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459090",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:1'></a>I confirm the error. I get exactly the same answers as in the original report. I am using Mac OS 10.15.5, and tested both 9.1 and 9.2b10. (The version with 100/2 is slow -- takes about 50 seconds.) 

When I tried `CoCalc`, it failed because it ran out of memory. (The memory gauge was over 3GB before it aborted.)



---

archive/issue_comments_459091.json:
```json
{
    "body": "Set assignee to @bmlivin.",
    "created_at": "2020-09-21T02:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459091",
    "user": "https://github.com/bmlivin"
}
```

Set assignee to @bmlivin.



---

archive/issue_comments_459092.json:
```json
{
    "body": "<a id='comment:3'></a>There is no need to use big numbers, so the situation is even worse than it first appeared:\n\n```\nsage: n((2*sqrt(2))^(2/1))                                                      \n1.24131221754531e1292913987\nsage: n((2*sqrt(2))^2)                                                          \n8.00000000000000\n```\nThis only takes a few seconds with 9.1 on `CoCalc` (but needs more than 1GB of memory) or with 9.2b13 on MacOS 10.15.6.",
    "created_at": "2020-10-01T04:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459092",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:3'></a>There is no need to use big numbers, so the situation is even worse than it first appeared:

```
sage: n((2*sqrt(2))^(2/1))                                                      
1.24131221754531e1292913987
sage: n((2*sqrt(2))^2)                                                          
8.00000000000000
```
This only takes a few seconds with 9.1 on `CoCalc` (but needs more than 1GB of memory) or with 9.2b13 on MacOS 10.15.6.



---

archive/issue_comments_459093.json:
```json
{
    "body": "<a id='comment:4'></a>I can confirm this on Ubuntu 18 with [SageMath](SageMath) version 9.2.beta13, using Python 3.8.5.",
    "created_at": "2020-10-01T08:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459093",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>I can confirm this on Ubuntu 18 with [SageMath](SageMath) version 9.2.beta13, using Python 3.8.5.



---

archive/issue_comments_459094.json:
```json
{
    "body": "Remove assignee @bmlivin.",
    "created_at": "2020-10-03T23:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459094",
    "user": "https://github.com/bmlivin"
}
```

Remove assignee @bmlivin.



---

archive/issue_comments_459095.json:
```json
{
    "body": "<a id='comment:5'></a>Okay, I believe I've tracked this down. It is a `pynac` bug. Here's what's happening:\n\n`Sage` eventually calls `pynac`'s `pow` from `sage.symbolic.expression:Expression._pow_`, but before that happens, it simplifies the exponent. Specifically, it simplifies the exponent so that `pynac` thinks it is an integer, but its type is still `MPQ`.\n\nNone of that should matter, except that what `pynac` calls to evaluate the expression is `numeric::pow_intexp`. Here is the content of that function:\n\n```\nif (not exponent.is_integer())\n    throw std::runtime_error(\"nueric::pow_intexp: exponent not integer\");\nif (exponent.t == MPZ) {\n    if (not mpz_fits_sint_p(exponent.v._bigint))\n        throw std::runtime_error(\"size of exponent exceeds signed long size\");\n    return power(mpz_get_si(exponent.v._bigint));\n}\nreturn power(exponent.v._long);\n```\n\nIn this function, `exponent.is_integer()` is `True` and `exponent.t` is `MPQ`. So both of the `if` statements are false, and `power(exponent.v._long)` is called. The problem is that `v._long` contains junk (very large junk!). Evaluating that statement takes a long time, and it won't give you the answer you want.\n\nIf, on the other hand, the second `if` statement were true, the result would have been exactly what you want. So simply checking whether `exponent.t == MPQ` or `exponent.t == MPZ` should fix this. I haven't tried this, but it's what I would at least try.\n\nI think it may be possible as well to fix this by getting `Sage` to change the type of the exponent when it's cancelled out. I haven't looked into this and I think it sounds like a bad idea.\n\nI'm unassigning this because I can't currently report it upstream.",
    "created_at": "2020-10-03T23:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459095",
    "user": "https://github.com/bmlivin"
}
```

<a id='comment:5'></a>Okay, I believe I've tracked this down. It is a `pynac` bug. Here's what's happening:

`Sage` eventually calls `pynac`'s `pow` from `sage.symbolic.expression:Expression._pow_`, but before that happens, it simplifies the exponent. Specifically, it simplifies the exponent so that `pynac` thinks it is an integer, but its type is still `MPQ`.

None of that should matter, except that what `pynac` calls to evaluate the expression is `numeric::pow_intexp`. Here is the content of that function:

```
if (not exponent.is_integer())
    throw std::runtime_error("nueric::pow_intexp: exponent not integer");
if (exponent.t == MPZ) {
    if (not mpz_fits_sint_p(exponent.v._bigint))
        throw std::runtime_error("size of exponent exceeds signed long size");
    return power(mpz_get_si(exponent.v._bigint));
}
return power(exponent.v._long);
```

In this function, `exponent.is_integer()` is `True` and `exponent.t` is `MPQ`. So both of the `if` statements are false, and `power(exponent.v._long)` is called. The problem is that `v._long` contains junk (very large junk!). Evaluating that statement takes a long time, and it won't give you the answer you want.

If, on the other hand, the second `if` statement were true, the result would have been exactly what you want. So simply checking whether `exponent.t == MPQ` or `exponent.t == MPZ` should fix this. I haven't tried this, but it's what I would at least try.

I think it may be possible as well to fix this by getting `Sage` to change the type of the exponent when it's cancelled out. I haven't looked into this and I think it sounds like a bad idea.

I'm unassigning this because I can't currently report it upstream.



---

archive/issue_comments_459096.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-12T02:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459096",
    "user": "https://github.com/bmlivin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_459097.json:
```json
{
    "body": "<a id='comment:6'></a>I've fixed this upstream and submitted a pull request: https://github.com/pynac/pynac/pull/355. The pull request also includes additions to the doctest for `sage.symbolic.expression.Expression::_pow_`.",
    "created_at": "2020-10-12T02:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459097",
    "user": "https://github.com/bmlivin"
}
```

<a id='comment:6'></a>I've fixed this upstream and submitted a pull request: https://github.com/pynac/pynac/pull/355. The pull request also includes additions to the doctest for `sage.symbolic.expression.Expression::_pow_`.



---

archive/issue_events_079003.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30446#event-79003"
}
```



---

archive/issue_comments_459098.json:
```json
{
    "body": "<a id='comment:8'></a>OK, trying https://patch-diff.githubusercontent.com/raw/pynac/pynac/pull/355.patch now.\n\nBut where are \"additions to the doctest for `sage.symbolic.expression.Expression::_pow_`\"?\n\nI presume they should be here, on this ticket.",
    "created_at": "2021-01-10T11:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459098",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>OK, trying https://patch-diff.githubusercontent.com/raw/pynac/pynac/pull/355.patch now.

But where are "additions to the doctest for `sage.symbolic.expression.Expression::_pow_`"?

I presume they should be here, on this ticket.



---

archive/issue_comments_459099.json:
```json
{
    "body": "<a id='comment:9'></a>OK, with that patch,\n\n```\nsage: QQ((24*sqrt(3))^(100/50))==1728                                                                                                                                \nTrue\n```\nworks. I'll add this as a doctest somewhere.",
    "created_at": "2021-01-10T11:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459099",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>OK, with that patch,

```
sage: QQ((24*sqrt(3))^(100/50))==1728                                                                                                                                
True
```
works. I'll add this as a doctest somewhere.



---

archive/issue_comments_459100.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-10T12:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459100",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_459101.json:
```json
{
    "body": "<a id='comment:10'></a>patches from pynac PRs to be removed at the next pynac update.\n\n---\nNew commits:",
    "created_at": "2021-01-10T12:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459101",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>patches from pynac PRs to be removed at the next pynac update.

---
New commits:



---

archive/issue_comments_459102.json:
```json
{
    "body": "<a id='comment:11'></a>This patch to pynac also fixes #28620, #30304, and #30786. The PR at #30786 adds doctests for all 3 of these tickets (and also moves the doctest of this ticket from the `_latex_` method to the `_pow_` method, which seems like a more appropriate place).",
    "created_at": "2021-01-10T22:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459102",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:11'></a>This patch to pynac also fixes #28620, #30304, and #30786. The PR at #30786 adds doctests for all 3 of these tickets (and also moves the doctest of this ticket from the `_latex_` method to the `_pow_` method, which seems like a more appropriate place).



---

archive/issue_comments_459103.json:
```json
{
    "body": "<a id='comment:12'></a>fyi: Patchbot `Linux/74-Ubuntu_SMP_Tue_Sep_17_17%3A06%3A04_UTC_2019/x86_64/4.15.0-65-generic/pc72` seems to have failed to build pynac at ticket #30786. (\"Error installing package pynac-0.7.26.sage-2020-04-03.p1\") If there is a genuine problem, I think it must be because of this ticket.",
    "created_at": "2021-01-11T02:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459103",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:12'></a>fyi: Patchbot `Linux/74-Ubuntu_SMP_Tue_Sep_17_17%3A06%3A04_UTC_2019/x86_64/4.15.0-65-generic/pc72` seems to have failed to build pynac at ticket #30786. ("Error installing package pynac-0.7.26.sage-2020-04-03.p1") If there is a genuine problem, I think it must be because of this ticket.



---

archive/issue_comments_459104.json:
```json
{
    "body": "<a id='comment:13'></a>This patch also seems to fix #31137. I added a doctest there.",
    "created_at": "2021-01-12T02:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459104",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:13'></a>This patch also seems to fix #31137. I added a doctest there.



---

archive/issue_comments_459105.json:
```json
{
    "body": "<a id='comment:14'></a>fyi: Another ubuntu patchbot failed to build pynac (on ticket #31137 this time). Both failures say `WARNING: 'aclocal-1.16' is missing on your system. ... Makefile:432: recipe for target 'aclocal.m4' failed`.",
    "created_at": "2021-01-12T08:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459105",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:14'></a>fyi: Another ubuntu patchbot failed to build pynac (on ticket #31137 this time). Both failures say `WARNING: 'aclocal-1.16' is missing on your system. ... Makefile:432: recipe for target 'aclocal.m4' failed`.



---

archive/issue_comments_459106.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-01-17T19:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459106",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_459107.json:
```json
{
    "body": "<a id='comment:15'></a>Patch touches configure stuff which triggers automake run (which is not a Sage dependency)\n\n```\nBuilding pynac-0.7.26.sage-2020-04-03.p1\nCDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/bash /var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/pynac-0.7.26.sage-2020-04-03.p1/src/missing aclocal-1.16 -I m4\n/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/pynac-0.7.26.sage-2020-04-03.p1/src/missing: line 81: aclocal-1.16: command not found\nWARNING: 'aclocal-1.16' is missing on your system.\n         You should only need it if you modified 'acinclude.m4' or\n         'configure.ac' or m4 files included by 'configure.ac'.\n         The 'aclocal' program is part of the GNU Automake package:\n         <https://www.gnu.org/software/automake>\n         It also requires GNU Autoconf, GNU m4 and Perl in order to run:\n         <https://www.gnu.org/software/autoconf>\n         <https://www.gnu.org/software/m4/>\n         <https://www.perl.org/>\nMakefile:432: recipe for target 'aclocal.m4' failed\nmake[5]: *** [aclocal.m4] Error 127\nmake[5]: Failed to remake makefile 'Makefile'.\nmake[5]: Target 'all' not remade because of errors.\n```",
    "created_at": "2021-01-17T19:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459107",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Patch touches configure stuff which triggers automake run (which is not a Sage dependency)

```
Building pynac-0.7.26.sage-2020-04-03.p1
CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/bash /var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/pynac-0.7.26.sage-2020-04-03.p1/src/missing aclocal-1.16 -I m4
/var/lib/buildbot/slave/sage_git/build/local/var/tmp/sage/build/pynac-0.7.26.sage-2020-04-03.p1/src/missing: line 81: aclocal-1.16: command not found
WARNING: 'aclocal-1.16' is missing on your system.
         You should only need it if you modified 'acinclude.m4' or
         'configure.ac' or m4 files included by 'configure.ac'.
         The 'aclocal' program is part of the GNU Automake package:
         <https://www.gnu.org/software/automake>
         It also requires GNU Autoconf, GNU m4 and Perl in order to run:
         <https://www.gnu.org/software/autoconf>
         <https://www.gnu.org/software/m4/>
         <https://www.perl.org/>
Makefile:432: recipe for target 'aclocal.m4' failed
make[5]: *** [aclocal.m4] Error 127
make[5]: Failed to remake makefile 'Makefile'.
make[5]: Target 'all' not remade because of errors.
```



---

archive/issue_comments_459108.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-01-23T18:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459108",
    "user": "https://github.com/mjungmath"
}
```

Changing priority from major to critical.



---

archive/issue_comments_459109.json:
```json
{
    "body": "<a id='comment:16'></a>I set this to critical since many tickets (some already positively reviewed providing a doctest) rely on this one.",
    "created_at": "2021-01-23T18:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459109",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:16'></a>I set this to critical since many tickets (some already positively reviewed providing a doctest) rely on this one.



---

archive/issue_comments_459110.json:
```json
{
    "body": "<a id='comment:17'></a>https://doc.sagemath.org/html/en/developer/packaging.html#when-to-patch-when-to-repackage-when-to-autoconfiscate explains that patching is not an option here.\nA pynac release needs to be made and the new release tarball needs to be used.",
    "created_at": "2021-01-23T20:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459110",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>https://doc.sagemath.org/html/en/developer/packaging.html#when-to-patch-when-to-repackage-when-to-autoconfiscate explains that patching is not an option here.
A pynac release needs to be made and the new release tarball needs to be used.



---

archive/issue_comments_459111.json:
```json
{
    "body": "<a id='comment:18'></a>I'll repurpose this ticket for the package update.",
    "created_at": "2021-01-24T19:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459111",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>I'll repurpose this ticket for the package update.



---

archive/issue_comments_459112.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-24T19:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459112",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_459113.json:
```json
{
    "body": "<a id='comment:19'></a>New commits:",
    "created_at": "2021-01-24T19:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459113",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>New commits:



---

archive/issue_comments_459114.json:
```json
{
    "body": "<a id='comment:20'></a>When you make official releases in https://github.com/pynac/pynac, there is no need for a version suffix such as \"sage-2020-04-03\". I used this when I made the previous release from https://github.com/mkoeppe/pynac to make clear that this was an unofficial release.",
    "created_at": "2021-01-24T19:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459114",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>When you make official releases in https://github.com/pynac/pynac, there is no need for a version suffix such as "sage-2020-04-03". I used this when I made the previous release from https://github.com/mkoeppe/pynac to make clear that this was an unofficial release.



---

archive/issue_comments_459115.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-01-24T19:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459115",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_459116.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-24T20:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459116",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_459117.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-24T20:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459117",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_459118.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-24T20:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459118",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_459119.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-01-24T20:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459119",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_459120.json:
```json
{
    "body": "<a id='comment:25'></a>should provide a cleaner tarball",
    "created_at": "2021-01-24T20:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459120",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>should provide a cleaner tarball



---

archive/issue_comments_459121.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:20 mkoeppe]:\n> When you make official releases in https://github.com/pynac/pynac, there is no need for a version suffix such as \"sage-2020-04-03\". I used this when I made the previous release from https://github.com/mkoeppe/pynac to make clear that this was an unofficial release.\n\n\nbut then https://github.com/pynac/pynac/commit/bbaff9d21d31e73f74bf3dd751b16c4dd3ac28a7 has sneaked upstream in some way :-)",
    "created_at": "2021-01-24T21:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459121",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>Replying to [comment:20 mkoeppe]:
> When you make official releases in https://github.com/pynac/pynac, there is no need for a version suffix such as "sage-2020-04-03". I used this when I made the previous release from https://github.com/mkoeppe/pynac to make clear that this was an unofficial release.


but then https://github.com/pynac/pynac/commit/bbaff9d21d31e73f74bf3dd751b16c4dd3ac28a7 has sneaked upstream in some way :-)



---

archive/issue_comments_459122.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-24T21:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_459123.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-24T21:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459123",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_459124.json:
```json
{
    "body": "<a id='comment:29'></a>`build/pkgs/pynac/SPKG.rst` could use an update. In particular \"Special Update/Build Instructions\" should be removed",
    "created_at": "2021-01-24T21:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459124",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>`build/pkgs/pynac/SPKG.rst` could use an update. In particular "Special Update/Build Instructions" should be removed



---

archive/issue_comments_459125.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-24T22:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459125",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_459126.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-01-24T22:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459126",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_459127.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-01-24T22:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459127",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_459128.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-24T22:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459128",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_459129.json:
```json
{
    "body": "<a id='comment:34'></a>ok, done",
    "created_at": "2021-01-24T22:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459129",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>ok, done



---

archive/issue_comments_459130.json:
```json
{
    "body": "<a id='comment:36'></a>\n```\n[dochtml] [calculus ] docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.\n[dochtml] [calculus ] docstring of sage.symbolic.expression.Expression.substitute:135: WARNING: Literal block expected; none found.\n[dochtml] [manifolds] The inventory files are in local/share/doc/sage/inventory/en/reference/manifolds.\n[dochtml] Build finished. The built documents can be found in /home/release/Sage/local/share/doc/sage/inventory/en/reference/manifolds\n[dochtml] [calculus ] The inventory files are in local/share/doc/sage/inventory/en/reference/calculus.\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/usr/lib64/python3.9/runpy.py\", line 197, in _run_module_as_main\n[dochtml]     return _run_code(code, main_globals, None,\n[dochtml]   File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\n[dochtml]     exec(code, run_globals)\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py\", line 1730, in main\n[dochtml]     builder()\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py\", line 343, in _wrapper\n[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py\", line 569, in _wrapper\n[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py\", line 555, in _build_everything_except_bibliography\n[dochtml]     build_many(build_ref_doc, non_references)\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py\", line 295, in build_many\n[dochtml]     _build_many(target, args, processes=NUM_THREADS)\n[dochtml]   File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/utils.py\", line 289, in build_many\n[dochtml]     raise worker_exc.original_exception\n[dochtml] OSError: docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.\n[dochtml] \n[dochtml]     Note: incremental documentation builds sometimes cause spurious\n[dochtml]     error messages. To be certain that these are real errors, run\n[dochtml]     \"make doc-clean\" first and try again.\n```",
    "created_at": "2021-02-08T00:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459130",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>
```
[dochtml] [calculus ] docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.
[dochtml] [calculus ] docstring of sage.symbolic.expression.Expression.substitute:135: WARNING: Literal block expected; none found.
[dochtml] [manifolds] The inventory files are in local/share/doc/sage/inventory/en/reference/manifolds.
[dochtml] Build finished. The built documents can be found in /home/release/Sage/local/share/doc/sage/inventory/en/reference/manifolds
[dochtml] [calculus ] The inventory files are in local/share/doc/sage/inventory/en/reference/calculus.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
[dochtml]     return _run_code(code, main_globals, None,
[dochtml]   File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
[dochtml]     exec(code, run_globals)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py", line 1730, in main
[dochtml]     builder()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py", line 343, in _wrapper
[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py", line 569, in _wrapper
[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py", line 555, in _build_everything_except_bibliography
[dochtml]     build_many(build_ref_doc, non_references)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/__init__.py", line 295, in build_many
[dochtml]     _build_many(target, args, processes=NUM_THREADS)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_setup/docbuild/utils.py", line 289, in build_many
[dochtml]     raise worker_exc.original_exception
[dochtml] OSError: docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.
[dochtml] 
[dochtml]     Note: incremental documentation builds sometimes cause spurious
[dochtml]     error messages. To be certain that these are real errors, run
[dochtml]     "make doc-clean" first and try again.
```



---

archive/issue_comments_459131.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-02-08T00:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459131",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_459132.json:
```json
{
    "body": "<a id='comment:37'></a>Could someone fix up the documentation markup please?",
    "created_at": "2021-02-20T16:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459132",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>Could someone fix up the documentation markup please?



---

archive/issue_comments_459133.json:
```json
{
    "body": "<a id='comment:38'></a>I can't find any mistake, the patchbots are green, and the html documentation builds for me.\n\nI wonder if maybe this error was posted to the wrong ticket? It is exactly the same error that was reported by a patchbot on ticket #30378 because I goofed up the `WARNING` block there:\n\n```\n[dochtml] OSError: docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.\n```",
    "created_at": "2021-02-21T20:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459133",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:38'></a>I can't find any mistake, the patchbots are green, and the html documentation builds for me.

I wonder if maybe this error was posted to the wrong ticket? It is exactly the same error that was reported by a patchbot on ticket #30378 because I goofed up the `WARNING` block there:

```
[dochtml] OSError: docstring of sage.symbolic.expression.Expression.subs:135: WARNING: Literal block expected; none found.
```



---

archive/issue_comments_459134.json:
```json
{
    "body": "<a id='comment:39'></a>Thanks for checking! Works for me too (tested on top of 31344)",
    "created_at": "2021-02-21T21:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459134",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>Thanks for checking! Works for me too (tested on top of 31344)



---

archive/issue_comments_459135.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-02-21T21:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459135",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_079004.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-07T17:06:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30446#event-79004"
}
```



---

archive/issue_comments_459136.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-07T17:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459136",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_459137.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+Before this ticket:\n+\n \\`\\`\\`\n sage: n((24*sqrt(3))^(100/50))\n 3.80392047155301e5927962146\n@@ -6,9 +8,9 @@\n \\`\\`\\`\n Clearly, both should be the same, namely the second.\n \n-This was on [SageMath](SageMath) 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).\n+This was on SageMath 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).\n \n-I've tried to reproduce, but my [SageMath](SageMath), as well as on Cocalc crashes. The error message on my machine was\n+I've tried to reproduce, but my SageMath, as well as on CoCalc crashes. The error message on my machine was\n \n \\`\\`\\`\n Traceback (most recent call last):\n@@ -24,7 +26,7 @@\n ------------------------------------------------------------------------\n Aborted (core dumped)\n \\`\\`\\`\n-However, my [SageMath](SageMath) seems to be fine otherwise, \\`make ptestlong\\` passes.\n+However, my SageMath seems to be fine otherwise, \\`make ptestlong\\` passes.\n Same on current 9.2.beta9.\n \n Comment: 1\n```\n",
    "created_at": "2021-03-07T18:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30446",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30446#issuecomment-459137",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,5 @@
+Before this ticket:
+
 \`\`\`
 sage: n((24*sqrt(3))^(100/50))
 3.80392047155301e5927962146
@@ -6,9 +8,9 @@
 \`\`\`
 Clearly, both should be the same, namely the second.
 
-This was on [SageMath](SageMath) 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).
+This was on SageMath 9.1 on openSUSE Leap 15.2 (64bit) (reported by a colleague to me).
 
-I've tried to reproduce, but my [SageMath](SageMath), as well as on Cocalc crashes. The error message on my machine was
+I've tried to reproduce, but my SageMath, as well as on CoCalc crashes. The error message on my machine was
 
 \`\`\`
 Traceback (most recent call last):
@@ -24,7 +26,7 @@
 ------------------------------------------------------------------------
 Aborted (core dumped)
 \`\`\`
-However, my [SageMath](SageMath) seems to be fine otherwise, \`make ptestlong\` passes.
+However, my SageMath seems to be fine otherwise, \`make ptestlong\` passes.
 Same on current 9.2.beta9.
 
 Comment: 1
```

