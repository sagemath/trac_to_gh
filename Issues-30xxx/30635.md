# Issue 30635: doctests failures in sage/graphs when using COIN solver

archive/issues_030398.json:
```json
{
    "body": "On Ubuntu 18.04, with 9.2.beta13, running\n\n```\nsage -tp src/sage/graphs/generic_graph.py src/sage/graphs/graph.py\n```\nwith the following optional packages:\n\n```\nUsing --optional=4ti2,build,ccache,cryptominisat,dochtml,dot2tex,e_antic,fricas,glucose,latte_int,libnauty,lidia,lrslib,memlimit,normaliz,notedown,openssl,pandoc_attributes,pycosat,pynormaliz,rst2ipynb,sage,sage_numerical_backends_coin\n```\ngives\n\n```\nsage -t --random-seed=0 src/sage/graphs/graph.py\n**********************************************************************\nFile \"src/sage/graphs/graph.py\", line 4507, in sage.graphs.graph.Graph.has_homomorphism_to\nFailed example:\n    g.has_homomorphism_to(graphs.CycleGraph(4)) is not False\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"src/sage/graphs/graph.py\", line 4902, in sage.graphs.graph.Graph.minor\nFailed example:\n    L = g.minor(graphs.CompleteGraph(3))\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: This graph has no minor isomorphic to H !\nGot:\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/graphs/graph.py\", line 6112, in sage.graphs.graph.Graph.topological_minor\nFailed example:\n    g.topological_minor(graphs.CycleGraph(3))\nExpected:\n    False\nGot:\n    Subgraph of (Subgraph of (RandomGNP(15,0.300000000000000))): Graph on 0 vertices\n**********************************************************************\n3 items had failures:\n   1 of  10 in sage.graphs.graph.Graph.has_homomorphism_to\n   1 of  12 in sage.graphs.graph.Graph.minor\n   1 of   7 in sage.graphs.graph.Graph.topological_minor\n    [1229 tests, 3 failures, 12.35 s]\nsage -t --random-seed=0 src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 8909, in sage.graphs.generic_graph.GenericGraph.nowhere_zero_flow\nFailed example:\n    h = g.nowhere_zero_flow(k=3)\nExpected:\n    Traceback (most recent call last):\n    ...\n    EmptySetError: the problem has no feasible solution\nGot:\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 9530, in sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths\nFailed example:\n    p1,p2 = g.disjoint_routed_paths([((0, 0), (4, 4)), ((0, 4), (4, 0))])\nExpected:\n    Traceback (most recent call last):\n    ...\n    EmptySetError: the disjoint routed paths do not exist\nGot:\n    <BLANKLINE>\n**********************************************************************\n2 items had failures:\n   1 of   5 in sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths\n   1 of  29 in sage.graphs.generic_graph.GenericGraph.nowhere_zero_flow\n    [3458 tests, 2 failures, 13.67 s]\n----------------------------------------------------------------------\nsage -t --random-seed=0 src/sage/graphs/graph.py  # 3 doctests failed\nsage -t --random-seed=0 src/sage/graphs/generic_graph.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n\nSeems to be related to cbc/coin. Here are the involved versions:\n\n```\n$ sage -optional | grep coin\nsage_numerical_backends_coin............9.0b12 (9.0b12)\n$ sage -optional | grep cbc\ncbc.....................................2.9.4.p0 (not_installed)\n$ cbc --version\nWelcome to the CBC MILP Solver \nVersion: 2.9.9 \nBuild Date: Aug 21 2017 \n```\n\n\n**CC:**  @mkoeppe @dimpase\n\n**Reviewer:** David Coudert\n\n**Dependencies:** #30644\n\n**Resolution:** invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/30635\n\n",
    "closed_at": "2022-08-02T06:31:03Z",
    "created_at": "2020-09-22T20:40:13Z",
    "labels": [
        "component: graph theory",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "doctests failures in sage/graphs when using COIN solver",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30635",
    "user": "https://github.com/seblabbe"
}
```
On Ubuntu 18.04, with 9.2.beta13, running

```
sage -tp src/sage/graphs/generic_graph.py src/sage/graphs/graph.py
```
with the following optional packages:

```
Using --optional=4ti2,build,ccache,cryptominisat,dochtml,dot2tex,e_antic,fricas,glucose,latte_int,libnauty,lidia,lrslib,memlimit,normaliz,notedown,openssl,pandoc_attributes,pycosat,pynormaliz,rst2ipynb,sage,sage_numerical_backends_coin
```
gives

```
sage -t --random-seed=0 src/sage/graphs/graph.py
**********************************************************************
File "src/sage/graphs/graph.py", line 4507, in sage.graphs.graph.Graph.has_homomorphism_to
Failed example:
    g.has_homomorphism_to(graphs.CycleGraph(4)) is not False
Expected:
    False
Got:
    True
**********************************************************************
File "src/sage/graphs/graph.py", line 4902, in sage.graphs.graph.Graph.minor
Failed example:
    L = g.minor(graphs.CompleteGraph(3))
Expected:
    Traceback (most recent call last):
    ...
    ValueError: This graph has no minor isomorphic to H !
Got:
    <BLANKLINE>
**********************************************************************
File "src/sage/graphs/graph.py", line 6112, in sage.graphs.graph.Graph.topological_minor
Failed example:
    g.topological_minor(graphs.CycleGraph(3))
Expected:
    False
Got:
    Subgraph of (Subgraph of (RandomGNP(15,0.300000000000000))): Graph on 0 vertices
**********************************************************************
3 items had failures:
   1 of  10 in sage.graphs.graph.Graph.has_homomorphism_to
   1 of  12 in sage.graphs.graph.Graph.minor
   1 of   7 in sage.graphs.graph.Graph.topological_minor
    [1229 tests, 3 failures, 12.35 s]
sage -t --random-seed=0 src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 8909, in sage.graphs.generic_graph.GenericGraph.nowhere_zero_flow
Failed example:
    h = g.nowhere_zero_flow(k=3)
Expected:
    Traceback (most recent call last):
    ...
    EmptySetError: the problem has no feasible solution
Got:
    <BLANKLINE>
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 9530, in sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths
Failed example:
    p1,p2 = g.disjoint_routed_paths([((0, 0), (4, 4)), ((0, 4), (4, 0))])
Expected:
    Traceback (most recent call last):
    ...
    EmptySetError: the disjoint routed paths do not exist
Got:
    <BLANKLINE>
**********************************************************************
2 items had failures:
   1 of   5 in sage.graphs.generic_graph.GenericGraph.disjoint_routed_paths
   1 of  29 in sage.graphs.generic_graph.GenericGraph.nowhere_zero_flow
    [3458 tests, 2 failures, 13.67 s]
----------------------------------------------------------------------
sage -t --random-seed=0 src/sage/graphs/graph.py  # 3 doctests failed
sage -t --random-seed=0 src/sage/graphs/generic_graph.py  # 2 doctests failed
----------------------------------------------------------------------
```

Seems to be related to cbc/coin. Here are the involved versions:

```
$ sage -optional | grep coin
sage_numerical_backends_coin............9.0b12 (9.0b12)
$ sage -optional | grep cbc
cbc.....................................2.9.4.p0 (not_installed)
$ cbc --version
Welcome to the CBC MILP Solver 
Version: 2.9.9 
Build Date: Aug 21 2017 
```


**CC:**  @mkoeppe @dimpase

**Reviewer:** David Coudert

**Dependencies:** #30644

**Resolution:** invalid

Issue created by migration from https://trac.sagemath.org/ticket/30635





---

archive/issue_comments_606533.json:
```json
{
    "body": "<a id='comment:1'></a>\nI suspect it is due to coin. Can you try for instance\n\n```\nsage: g = graphs.CycleGraph(9)\nsage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='GLPK')\nFalse\n```\n\nfedora 32, with cplex as default solver, I get\n\n```\nmusclotte:/home/dcoudert/sage> ./sage -version\nSageMath version 9.2.beta13, Release Date: 2020-09-21\nmusclotte:/home/dcoudert/sage> ./sage -tp src/sage/graphs/generic_graph.py src/sage/graphs/graph.py \ntoo few successful tests, not using stored timings\nRunning doctests with ID 2020-09-22-23-04-40-6379f74f.\nGit branch: develop\nUsing --optional=benzene,bliss,buckygen,build,cryptominisat,csdp,dochtml,dot2tex,gap_packages,glucose,igraph,libsemigroups,mcqd,memlimit,plantri,python_igraph,rubiks,sage,sage_numerical_backends_cplex,sage_numerical_backends_gurobi,tdlib\nDoctesting 2 files using 8 threads.\nsage -t --random-seed=0 src/sage/graphs/graph.py\n    [1244 tests, 21.04 s]\nsage -t --random-seed=0 src/sage/graphs/generic_graph.py\n    [3514 tests, 47.27 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 48.2 seconds\n    cpu time: 122.6 seconds\n    cumulative wall time: 68.3 seconds\n```\nsame on macOS 10.15.6 but with only cplex as optional package.",
    "created_at": "2020-09-22T21:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606533",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'></a>
I suspect it is due to coin. Can you try for instance

```
sage: g = graphs.CycleGraph(9)
sage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='GLPK')
False
```

fedora 32, with cplex as default solver, I get

```
musclotte:/home/dcoudert/sage> ./sage -version
SageMath version 9.2.beta13, Release Date: 2020-09-21
musclotte:/home/dcoudert/sage> ./sage -tp src/sage/graphs/generic_graph.py src/sage/graphs/graph.py 
too few successful tests, not using stored timings
Running doctests with ID 2020-09-22-23-04-40-6379f74f.
Git branch: develop
Using --optional=benzene,bliss,buckygen,build,cryptominisat,csdp,dochtml,dot2tex,gap_packages,glucose,igraph,libsemigroups,mcqd,memlimit,plantri,python_igraph,rubiks,sage,sage_numerical_backends_cplex,sage_numerical_backends_gurobi,tdlib
Doctesting 2 files using 8 threads.
sage -t --random-seed=0 src/sage/graphs/graph.py
    [1244 tests, 21.04 s]
sage -t --random-seed=0 src/sage/graphs/generic_graph.py
    [3514 tests, 47.27 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 48.2 seconds
    cpu time: 122.6 seconds
    cumulative wall time: 68.3 seconds
```
same on macOS 10.15.6 but with only cplex as optional package.



---

archive/issue_comments_606534.json:
```json
{
    "body": "<a id='comment:2'></a>\nOk, I see, I need to reinstall Gurobi and/or CPLEX again, but I haven't needed it recently.\n\nI get this:\n\n```\nsage: g = graphs.CycleGraph(9) \nsage: g.has_homomorphism_to(graphs.CycleGraph(4))                     \n{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\nsage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='COIN')                     \n{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\nsage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='GLPK')                     \nLong-step dual simplex will be used\nFalse\n```",
    "created_at": "2020-09-23T08:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606534",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:2'></a>
Ok, I see, I need to reinstall Gurobi and/or CPLEX again, but I haven't needed it recently.

I get this:

```
sage: g = graphs.CycleGraph(9) 
sage: g.has_homomorphism_to(graphs.CycleGraph(4))                     
{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
sage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='COIN')                     
{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
sage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='GLPK')                     
Long-step dual simplex will be used
False
```



---

archive/issue_comments_606535.json:
```json
{
    "body": "<a id='comment:3'></a>\nSo something is wrong with cbc/coin. I never use it...\n\nFYI, the `Long-step dual simplex will be used` message when using glpk is ignored in doctests since #29587.",
    "created_at": "2020-09-23T09:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606535",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>
So something is wrong with cbc/coin. I never use it...

FYI, the `Long-step dual simplex will be used` message when using glpk is ignored in doctests since #29587.



---

archive/issue_comments_606536.json:
```json
{
    "body": "<a id='comment:4'></a>\nWhat is weird is that vertices 0 and 8 are not a key of the dictionnary \"found\" by coin:\n\n```\nsage: g8 = graphs.CycleGraph(8)                                                            \nsage: g9 = graphs.CycleGraph(9)                                                            \nsage: g4 = graphs.CycleGraph(4)                                                            \nsage: g9.has_homomorphism_to(g4, solver='COIN') # key 0 and 8 are missing in the output\n{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\nsage: g8.has_homomorphism_to(g4, solver='COIN')                                            \n{0: 0, 1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\nsage: g9.has_homomorphism_to(g4, solver='GLPK')                                            \nLong-step dual simplex will be used\nFalse\nsage: g8.has_homomorphism_to(g4, solver='GLPK')                                            \nLong-step dual simplex will be used\n{0: 0, 1: 3, 2: 0, 3: 3, 4: 0, 5: 3, 6: 0, 7: 3}\n```",
    "created_at": "2020-09-23T09:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606536",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:4'></a>
What is weird is that vertices 0 and 8 are not a key of the dictionnary "found" by coin:

```
sage: g8 = graphs.CycleGraph(8)                                                            
sage: g9 = graphs.CycleGraph(9)                                                            
sage: g4 = graphs.CycleGraph(4)                                                            
sage: g9.has_homomorphism_to(g4, solver='COIN') # key 0 and 8 are missing in the output
{1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
sage: g8.has_homomorphism_to(g4, solver='COIN')                                            
{0: 0, 1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
sage: g9.has_homomorphism_to(g4, solver='GLPK')                                            
Long-step dual simplex will be used
False
sage: g8.has_homomorphism_to(g4, solver='GLPK')                                            
Long-step dual simplex will be used
{0: 0, 1: 3, 2: 0, 3: 3, 4: 0, 5: 3, 6: 0, 7: 3}
```



---

archive/issue_events_089764.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "rename": {
        "from": "doctests failures in sage/graphs",
        "to": "doctests failures in sage/graphs when using COIN solver"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89764"
}
```



---

archive/issue_comments_606537.json:
```json
{
    "body": "<a id='comment:6'></a>\nDo you think #30637 is also cbc/coin related?",
    "created_at": "2020-09-23T09:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606537",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:6'></a>
Do you think #30637 is also cbc/coin related?



---

archive/issue_comments_606538.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -75,3 +75,13 @@\n sage -t --random-seed=0 src/sage/graphs/generic_graph.py  # 2 doctests failed\n ----------------------------------------------------------------------\n ```\n+\n+Seems to be related to cbc/coin. Here are the involved versions:\n+\n+```\n+$ sage -optional | grep coin\n+sage_numerical_backends_coin............9.0b12 (9.0b12)\n+$ sage -optional | grep cbc\n+cbc.....................................2.9.4.p0 (not_installed)\n+```\n+\n``````\n",
    "created_at": "2020-09-23T09:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606538",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -75,3 +75,13 @@
 sage -t --random-seed=0 src/sage/graphs/generic_graph.py  # 2 doctests failed
 ----------------------------------------------------------------------
 ```
+
+Seems to be related to cbc/coin. Here are the involved versions:
+
+```
+$ sage -optional | grep coin
+sage_numerical_backends_coin............9.0b12 (9.0b12)
+$ sage -optional | grep cbc
+cbc.....................................2.9.4.p0 (not_installed)
+```
+
``````




---

archive/issue_comments_606539.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [slabbe](#comment%3A6):\n> Do you think #30637 is also cbc/coin related?\n\nnot sure. See #29551",
    "created_at": "2020-09-23T09:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606539",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>
Replying to [slabbe](#comment%3A6):
> Do you think #30637 is also cbc/coin related?

not sure. See #29551



---

archive/issue_comments_606540.json:
```json
{
    "body": "<a id='comment:9'></a>\nWhat is the difference between cbc and coin?\n\nCan I use `solver='COIN'` if cbc is not installed?\n\n```\n$ sage -optional | grep cbc\ncbc.....................................2.9.4.p0 (not_installed)\n```",
    "created_at": "2020-09-23T09:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606540",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:9'></a>
What is the difference between cbc and coin?

Can I use `solver='COIN'` if cbc is not installed?

```
$ sage -optional | grep cbc
cbc.....................................2.9.4.p0 (not_installed)
```



---

archive/issue_comments_606541.json:
```json
{
    "body": "<a id='comment:10'></a>\nI confirm that the issue dissappear after installing cbc:\n\n```\n$ sage -optional | grep cbc\ncbc.....................................2.9.4.p0 (2.9.4.p0)\n```\n\n```\nsage -t --random-seed=0 src/sage/graphs/generic_graph.py\n    [3458 tests, 13.66 s]\nsage -t --random-seed=0 src/sage/graphs/graph.py\n    [1229 tests, 14.46 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```",
    "created_at": "2020-09-23T09:28:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606541",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'></a>
I confirm that the issue dissappear after installing cbc:

```
$ sage -optional | grep cbc
cbc.....................................2.9.4.p0 (2.9.4.p0)
```

```
sage -t --random-seed=0 src/sage/graphs/generic_graph.py
    [3458 tests, 13.66 s]
sage -t --random-seed=0 src/sage/graphs/graph.py
    [1229 tests, 14.46 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```



---

archive/issue_comments_606542.json:
```json
{
    "body": "<a id='comment:11'></a>\nSomething is weird in the configuration, because I did `--enable-cbc`:\n\n```\n$ head config.log\nThis file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nIt was created by Sage configure 9.2.beta13, which was\ngenerated by GNU Autoconf 2.69.  Invocation command line was\n\n  $ ./configure --enable-experimental-packages --enable-download-from-upstream-url --enable-ccache --enable-dot2tex --enable-rst2ipynb --enable-openssl --enable-cbc --enable-cryptominisat --enable-pycosat --enable-glucose --enable-sage_numerical_backends_coin --enable-pynormaliz --enable-latte_int --enable-awali --enable-fricas --no-create --no-recursion\n\n## --------- ##\n## Platform. ##\n```\n\nSo, I should not need to run `sage -i cbc` after...",
    "created_at": "2020-09-23T09:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606542",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:11'></a>
Something is weird in the configuration, because I did `--enable-cbc`:

```
$ head config.log
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by Sage configure 9.2.beta13, which was
generated by GNU Autoconf 2.69.  Invocation command line was

  $ ./configure --enable-experimental-packages --enable-download-from-upstream-url --enable-ccache --enable-dot2tex --enable-rst2ipynb --enable-openssl --enable-cbc --enable-cryptominisat --enable-pycosat --enable-glucose --enable-sage_numerical_backends_coin --enable-pynormaliz --enable-latte_int --enable-awali --enable-fricas --no-create --no-recursion

## --------- ##
## Platform. ##
```

So, I should not need to run `sage -i cbc` after...



---

archive/issue_comments_606543.json:
```json
{
    "body": "<a id='comment:12'></a>\nI'm not completely sure of what `coin` provides apart from a linear programming solver. If I'm right, `cbc` is the branch and cut / branch and bound engine.\n\nIf installing cbc is sufficient to fix the issues, it confirms that we must clarify when we can use `coin` and when we must use `cbc`, or if `cbc` is always needed to with `coin`. \n\nConcerning configuration / installation, I suggest to ask Dima or Matthias.",
    "created_at": "2020-09-23T09:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606543",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>
I'm not completely sure of what `coin` provides apart from a linear programming solver. If I'm right, `cbc` is the branch and cut / branch and bound engine.

If installing cbc is sufficient to fix the issues, it confirms that we must clarify when we can use `coin` and when we must use `cbc`, or if `cbc` is always needed to with `coin`. 

Concerning configuration / installation, I suggest to ask Dima or Matthias.



---

archive/issue_comments_606544.json:
```json
{
    "body": "<a id='comment:13'></a>\nadding Matthias in cc here. Questions are:\n\n- is it normal to have `sage_numerical_backends_coin` installed but not `cbc` (this is the source of the bug in this ticket)?\n- is it normal that `--enable-cbc` in the configuration did not installed `cbc` ?",
    "created_at": "2020-09-23T09:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606544",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'></a>
adding Matthias in cc here. Questions are:

- is it normal to have `sage_numerical_backends_coin` installed but not `cbc` (this is the source of the bug in this ticket)?
- is it normal that `--enable-cbc` in the configuration did not installed `cbc` ?



---

archive/issue_comments_606545.json:
```json
{
    "body": "<a id='comment:14'></a>\n`sage_numerical_backends_coin` does have cbc in its list of dependencies. Normal installs either using the `./configure` option  `--enable-sage_numerical_backends_coin` or `sage -i sage_numerical_backends_coin` should install cbc too.\n\nNote, however, that `cbc` knows how to find system packages. So `--enable-cbc` does not install its own copy of `cbc` if you have one in the system.",
    "created_at": "2020-09-23T12:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606545",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
`sage_numerical_backends_coin` does have cbc in its list of dependencies. Normal installs either using the `./configure` option  `--enable-sage_numerical_backends_coin` or `sage -i sage_numerical_backends_coin` should install cbc too.

Note, however, that `cbc` knows how to find system packages. So `--enable-cbc` does not install its own copy of `cbc` if you have one in the system.



---

archive/issue_comments_606546.json:
```json
{
    "body": "<a id='comment:15'></a>\nok, I see, and I have \n\n```\n$ cbc --version\nWelcome to the CBC MILP Solver \nVersion: 2.9.9 \nBuild Date: Aug 21 2017 \n```\ninstalled on the system as opposed to `2.9.4.p0` available in sage. Therefore it seems to be a regression in cbc that happen between `2.9.4.p0` and `2.9.9`.",
    "created_at": "2020-09-23T12:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606546",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:15'></a>
ok, I see, and I have 

```
$ cbc --version
Welcome to the CBC MILP Solver 
Version: 2.9.9 
Build Date: Aug 21 2017 
```
installed on the system as opposed to `2.9.4.p0` available in sage. Therefore it seems to be a regression in cbc that happen between `2.9.4.p0` and `2.9.9`.



---

archive/issue_comments_606547.json:
```json
{
    "body": "<a id='comment:16'></a>\nand the [latest release version](https://projects.coin-or.org/Cbc) of Cbc is 2.10.5",
    "created_at": "2020-09-23T13:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606547",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:16'></a>
and the [latest release version](https://projects.coin-or.org/Cbc) of Cbc is 2.10.5



---

archive/issue_comments_606548.json:
```json
{
    "body": "<a id='comment:17'></a>\nShould\n\n```\n$ sage -optional | grep cbc\ncbc.....................................2.9.4.p0 (not_installed)\n```\ninstead return\n\n```\n$ sage -optional | grep cbc\ncbc.....................................2.9.4.p0 (2.9.9)\n```\nif cbc 2.9.9 was found on the system by the `--enable-cbc`?",
    "created_at": "2020-09-23T13:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606548",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:17'></a>
Should

```
$ sage -optional | grep cbc
cbc.....................................2.9.4.p0 (not_installed)
```
instead return

```
$ sage -optional | grep cbc
cbc.....................................2.9.4.p0 (2.9.9)
```
if cbc 2.9.9 was found on the system by the `--enable-cbc`?



---

archive/issue_comments_606549.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -83,5 +83,9 @@\n sage_numerical_backends_coin............9.0b12 (9.0b12)\n $ sage -optional | grep cbc\n cbc.....................................2.9.4.p0 (not_installed)\n+$ cbc --version\n+Welcome to the CBC MILP Solver \n+Version: 2.9.9 \n+Build Date: Aug 21 2017 \n ```\n \n``````\n",
    "created_at": "2020-09-23T13:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606549",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -83,5 +83,9 @@
 sage_numerical_backends_coin............9.0b12 (9.0b12)
 $ sage -optional | grep cbc
 cbc.....................................2.9.4.p0 (not_installed)
+$ cbc --version
+Welcome to the CBC MILP Solver 
+Version: 2.9.9 
+Build Date: Aug 21 2017 
 ```
 
``````




---

archive/issue_comments_606550.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [slabbe](#comment%3A17):\n> Should\n> \n> ```\n> $ sage -optional | grep cbc\n> cbc.....................................2.9.4.p0 (not_installed)\n> ```\n> instead return\n> \n> ```\n> $ sage -optional | grep cbc\n> cbc.....................................2.9.4.p0 (2.9.9)\n> ```\n> if cbc 2.9.9 was found on the system by the `--enable-cbc`?\n\n\nBest to ignore `sage -optional` and everything that comes from `sage.misc.package`...",
    "created_at": "2020-09-23T13:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606550",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Replying to [slabbe](#comment%3A17):
> Should
> 
> ```
> $ sage -optional | grep cbc
> cbc.....................................2.9.4.p0 (not_installed)
> ```
> instead return
> 
> ```
> $ sage -optional | grep cbc
> cbc.....................................2.9.4.p0 (2.9.9)
> ```
> if cbc 2.9.9 was found on the system by the `--enable-cbc`?


Best to ignore `sage -optional` and everything that comes from `sage.misc.package`...



---

archive/issue_comments_606551.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [slabbe](#comment%3A4):\n> What is weird is that vertices 0 and 8 are not a key of the dictionnary \"found\" by coin:\n> \n> \n> ```\n> sage: g8 = graphs.CycleGraph(8)                                                            \n> sage: g9 = graphs.CycleGraph(9)                                                            \n> sage: g4 = graphs.CycleGraph(4)                                                            \n> sage: g9.has_homomorphism_to(g4, solver='COIN') # key 0 and 8 are missing in the output\n> {1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\n> sage: g8.has_homomorphism_to(g4, solver='COIN')                                            \n> {0: 0, 1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}\n> sage: g9.has_homomorphism_to(g4, solver='GLPK')                                            \n> Long-step dual simplex will be used\n> False\n> sage: g8.has_homomorphism_to(g4, solver='GLPK')                                            \n> Long-step dual simplex will be used\n> {0: 0, 1: 3, 2: 0, 3: 3, 4: 0, 5: 3, 6: 0, 7: 3}\n> ```\n\n\nThis seems to come from this code in `vertex_cover`:\n\n```\n                b = p.get_values(b)\n                cover_g = set(v for v in g if b[v] == 1)\n```\nwhich ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.",
    "created_at": "2020-09-23T13:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606551",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Replying to [slabbe](#comment%3A4):
> What is weird is that vertices 0 and 8 are not a key of the dictionnary "found" by coin:
> 
> 
> ```
> sage: g8 = graphs.CycleGraph(8)                                                            
> sage: g9 = graphs.CycleGraph(9)                                                            
> sage: g4 = graphs.CycleGraph(4)                                                            
> sage: g9.has_homomorphism_to(g4, solver='COIN') # key 0 and 8 are missing in the output
> {1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
> sage: g8.has_homomorphism_to(g4, solver='COIN')                                            
> {0: 0, 1: 1, 2: 0, 3: 1, 4: 0, 5: 1, 6: 0, 7: 1}
> sage: g9.has_homomorphism_to(g4, solver='GLPK')                                            
> Long-step dual simplex will be used
> False
> sage: g8.has_homomorphism_to(g4, solver='GLPK')                                            
> Long-step dual simplex will be used
> {0: 0, 1: 3, 2: 0, 3: 3, 4: 0, 5: 3, 6: 0, 7: 3}
> ```


This seems to come from this code in `vertex_cover`:

```
                b = p.get_values(b)
                cover_g = set(v for v in g if b[v] == 1)
```
which ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.



---

archive/issue_comments_606552.json:
```json
{
    "body": "<a id='comment:21'></a>\nTesting with cbc 2.10.5 (upgrade at #30644), the doctest failure stays.",
    "created_at": "2020-09-23T13:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606552",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:21'></a>
Testing with cbc 2.10.5 (upgrade at #30644), the doctest failure stays.



---

archive/issue_comments_606553.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [mkoeppe](#comment%3A20):\n> This seems to come from this code in `vertex_cover`:\n> \n> ```\n>                 b = p.get_values(b)\n>                 cover_g = set(v for v in g if b[v] == 1)\n> ```\n> which ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.\n> \n\nwell, `has_homomorphism_to` does not use `vertex_cover`, but I agree that it might be better to check e.g. `if b[v] >= .5`. Such tests are not unified (at least) in the graph module.",
    "created_at": "2020-09-23T14:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606553",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:22'></a>
Replying to [mkoeppe](#comment%3A20):
> This seems to come from this code in `vertex_cover`:
> 
> ```
>                 b = p.get_values(b)
>                 cover_g = set(v for v in g if b[v] == 1)
> ```
> which ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.
> 

well, `has_homomorphism_to` does not use `vertex_cover`, but I agree that it might be better to check e.g. `if b[v] >= .5`. Such tests are not unified (at least) in the graph module.



---

archive/issue_comments_606554.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [slabbe](#comment%3A21):\n> Testing with cbc 2.10.5 (upgrade at #30644), the doctest failure stays.\n\n\nI have  cbc 2.10.5 installed with hombrew, and after `sage -I sage_numerical_backends_coin` I get the correct result.\n\n```\nsage: g = graphs.CycleGraph(9)                                                                                                      \nsage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='Coin')                                                                    \nFalse\n```",
    "created_at": "2020-09-23T14:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606554",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:23'></a>
Replying to [slabbe](#comment%3A21):
> Testing with cbc 2.10.5 (upgrade at #30644), the doctest failure stays.


I have  cbc 2.10.5 installed with hombrew, and after `sage -I sage_numerical_backends_coin` I get the correct result.

```
sage: g = graphs.CycleGraph(9)                                                                                                      
sage: g.has_homomorphism_to(graphs.CycleGraph(4), solver='Coin')                                                                    
False
```



---

archive/issue_comments_606555.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [dcoudert](#comment%3A22):\n> Replying to [mkoeppe](#comment%3A20):\n> > This seems to come from this code in `vertex_cover`:\n> > \n> > ```\n> >                 b = p.get_values(b)\n> >                 cover_g = set(v for v in g if b[v] == 1)\n> > ```\n> > which ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.\n> > \n\n> well, `has_homomorphism_to` does not use `vertex_cover`, \n\nOK, `has_homomorphism_to` also has code like this:\n\n```\n            p.solve(log = verbose)\n            b = p.get_values(b)\n            mapping = dict(x[0] for x in b.items() if x[1])\n```\n\n> but I agree that it might be better to check e.g. `if b[v] >= .5`. Such tests are not unified (at least) in the graph module.\n\n\nIn deed, \"at least\"... this is severely broken code when `solver` is a numerical solver.",
    "created_at": "2020-09-23T17:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606555",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
Replying to [dcoudert](#comment%3A22):
> Replying to [mkoeppe](#comment%3A20):
> > This seems to come from this code in `vertex_cover`:
> > 
> > ```
> >                 b = p.get_values(b)
> >                 cover_g = set(v for v in g if b[v] == 1)
> > ```
> > which ignores the fact that a numerical solver is used and therefore `b` will include numerical noise.
> > 

> well, `has_homomorphism_to` does not use `vertex_cover`, 

OK, `has_homomorphism_to` also has code like this:

```
            p.solve(log = verbose)
            b = p.get_values(b)
            mapping = dict(x[0] for x in b.items() if x[1])
```

> but I agree that it might be better to check e.g. `if b[v] >= .5`. Such tests are not unified (at least) in the graph module.


In deed, "at least"... this is severely broken code when `solver` is a numerical solver.



---

archive/issue_comments_606556.json:
```json
{
    "body": "<a id='comment:25'></a>\nIf I'm correct, there is a confusion in the graph module between coin and cbc. Most of the models should be solved with ILP solvers, so `cbc` in this case and not `coin`, right ?",
    "created_at": "2020-09-23T17:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606556",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:25'></a>
If I'm correct, there is a confusion in the graph module between coin and cbc. Most of the models should be solved with ILP solvers, so `cbc` in this case and not `coin`, right ?



---

archive/issue_comments_606557.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [dcoudert](#comment%3A25):\n> If I'm correct, there is a confusion in the graph module between coin and cbc. Most of the models should be solved with ILP solvers, so `cbc` in this case and not `coin`, right ?\n\n\nSage only has one solver backend from the COIN-OR project, and that is the CBC solver, which we use both for mixed integer linear programming and linear programming. The string `\"coin\"` designates the use of this backend -- see `sage.numerical.backends.generic_backend.get_solver`. \n\n`chc` is the name of the SPKG providing the solver. Sage does not use it directly but only via the SPKG `sage_numerical_backends_coin`, which provides the class `sage_numerical_backends_coin.coin_backend.CoinBackend`.",
    "created_at": "2020-09-23T17:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606557",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Replying to [dcoudert](#comment%3A25):
> If I'm correct, there is a confusion in the graph module between coin and cbc. Most of the models should be solved with ILP solvers, so `cbc` in this case and not `coin`, right ?


Sage only has one solver backend from the COIN-OR project, and that is the CBC solver, which we use both for mixed integer linear programming and linear programming. The string `"coin"` designates the use of this backend -- see `sage.numerical.backends.generic_backend.get_solver`. 

`chc` is the name of the SPKG providing the solver. Sage does not use it directly but only via the SPKG `sage_numerical_backends_coin`, which provides the class `sage_numerical_backends_coin.coin_backend.CoinBackend`.



---

archive/issue_comments_606558.json:
```json
{
    "body": "<a id='comment:27'></a>\nAny doctests using this solver should be marked `optional - sage_numerical_backends_coin`, by the way (see #30646). Installing `cbc` by itself does not trigger installation of `sage_numerical_backends_coin`.",
    "created_at": "2020-09-23T17:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606558",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Any doctests using this solver should be marked `optional - sage_numerical_backends_coin`, by the way (see #30646). Installing `cbc` by itself does not trigger installation of `sage_numerical_backends_coin`.



---

archive/issue_comments_606559.json:
```json
{
    "body": "<a id='comment:28'></a>\nI would suggest to create a helper function that converts an inexact 0/1 output to bool with error margin checking, and to use it throughout the `sage.graphs` package.  Define a small epsilon, say 1e-4. Error out if input is away from 0 or 1 by something larger than that epsilon -- this indicates either a modeling error or a severe numerical issue in the solver.",
    "created_at": "2020-09-23T18:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606559",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
I would suggest to create a helper function that converts an inexact 0/1 output to bool with error margin checking, and to use it throughout the `sage.graphs` package.  Define a small epsilon, say 1e-4. Error out if input is away from 0 or 1 by something larger than that epsilon -- this indicates either a modeling error or a severe numerical issue in the solver.



---

archive/issue_comments_606560.json:
```json
{
    "body": "<a id='comment:30'></a>\nrelated to the suggestion of Matthias, I see that the following change was made in #28689:\n\n```diff\n     cpdef get_variable_value(self, int variable):\n         r\"\"\"\n@@ -868,7 +868,7 @@ cdef class CoinBackend(GenericBackend):\n         if self.is_variable_continuous(variable):\n             return v\n         else:\n-            return round(v)\n+            return int(round(v))\n \n     cpdef int ncols(self):\n         r\"\"\"\n```",
    "created_at": "2020-09-23T20:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606560",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:30'></a>
related to the suggestion of Matthias, I see that the following change was made in #28689:

```diff
     cpdef get_variable_value(self, int variable):
         r"""
@@ -868,7 +868,7 @@ cdef class CoinBackend(GenericBackend):
         if self.is_variable_continuous(variable):
             return v
         else:
-            return round(v)
+            return int(round(v))
 
     cpdef int ncols(self):
         r"""
```



---

archive/issue_comments_606561.json:
```json
{
    "body": "<a id='comment:31'></a>\nI don't support attempts of this kind to clean up the floating point results in the solver backends or in the `MixedIntegerLinearProgram` front-end. There is no generally correct way to exactify a solution to a MIP. \n\n`MixedIntegerLinearProgram` has the notion of a `base_ring`, which is `RDF` in the case of the numerical solvers. Client code of `MixedIntegerLinearProgram` needs to handle floating point results in a model-specific way.",
    "created_at": "2020-09-23T20:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606561",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
I don't support attempts of this kind to clean up the floating point results in the solver backends or in the `MixedIntegerLinearProgram` front-end. There is no generally correct way to exactify a solution to a MIP. 

`MixedIntegerLinearProgram` has the notion of a `base_ring`, which is `RDF` in the case of the numerical solvers. Client code of `MixedIntegerLinearProgram` needs to handle floating point results in a model-specific way.



---

archive/issue_events_089765.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-08T17:31:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89765"
}
```



---

archive/issue_events_089766.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89766"
}
```



---

archive/issue_events_089767.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89767"
}
```



---

archive/issue_comments_606562.json:
```json
{
    "body": "<a id='comment:33'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606562",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_606563.json:
```json
{
    "body": "**Dependencies:** #32191",
    "created_at": "2021-07-17T02:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606563",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32191



---

archive/issue_comments_606564.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [mkoeppe](#comment%3A28):\n> I would suggest to create a helper function that converts an inexact 0/1 output to bool with error margin checking, and to use it throughout the `sage.graphs` package.  Define a small epsilon, say 1e-4. Error out if input is away from 0 or 1 by something larger than that epsilon -- this indicates either a modeling error or a severe numerical issue in the solver.\n\n\nThis is now available with #32197. Meta-ticket #32191 (Audit/fix all uses of `MixedIntegerLinearProgram`) tracks the necessary changes in the library",
    "created_at": "2021-07-17T02:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606564",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Replying to [mkoeppe](#comment%3A28):
> I would suggest to create a helper function that converts an inexact 0/1 output to bool with error margin checking, and to use it throughout the `sage.graphs` package.  Define a small epsilon, say 1e-4. Error out if input is away from 0 or 1 by something larger than that epsilon -- this indicates either a modeling error or a severe numerical issue in the solver.


This is now available with #32197. Meta-ticket #32191 (Audit/fix all uses of `MixedIntegerLinearProgram`) tracks the necessary changes in the library



---

archive/issue_comments_606565.json:
```json
{
    "body": "<a id='comment:36'></a>\nDoes #32239 (which depends on #32197) fix the issues in `graph.py` ?",
    "created_at": "2021-07-19T15:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606565",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:36'></a>
Does #32239 (which depends on #32197) fix the issues in `graph.py` ?



---

archive/issue_comments_606566.json:
```json
{
    "body": "<a id='comment:37'></a>\nI haven't tested anything with COIN, but it is likely that these are all symptoms of the same issue that we're addressing in #32191.",
    "created_at": "2021-07-19T20:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606566",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
I haven't tested anything with COIN, but it is likely that these are all symptoms of the same issue that we're addressing in #32191.



---

archive/issue_events_089768.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-20T06:12:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89768"
}
```



---

archive/issue_events_089769.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-20T06:12:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89769"
}
```



---

archive/issue_comments_606567.json:
```json
{
    "body": "**Changing dependencies** from \"#32191\" to \"#32197 #32218 #32219 #32220 #32221 #32222 #32223 #32224 #32225 #32236 #32237 #32238 #32239 #32240 #32241\".",
    "created_at": "2021-07-20T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606567",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32191" to "#32197 #32218 #32219 #32220 #32221 #32222 #32223 #32224 #32225 #32236 #32237 #32238 #32239 #32240 #32241".



---

archive/issue_comments_606568.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-07-20T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606568",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_606569.json:
```json
{
    "body": "<a id='comment:38'></a>\nNo error with `sage_numerical_backends_coin` installed with the above tickets from #32191 merged. This is with `cbc` 2.10.3 from homebrew.",
    "created_at": "2021-07-20T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606569",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
No error with `sage_numerical_backends_coin` installed with the above tickets from #32191 merged. This is with `cbc` 2.10.3 from homebrew.



---

archive/issue_comments_606570.json:
```json
{
    "body": "<a id='comment:39'></a>\nAlso no error with `cbc` from our outdated SPKG (2.9.4.p0).",
    "created_at": "2021-07-20T06:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606570",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
Also no error with `cbc` from our outdated SPKG (2.9.4.p0).



---

archive/issue_comments_606571.json:
```json
{
    "body": "<a id='comment:40'></a>\nHowever, I do get errors with the `cbc` from the upgrade ticket #30644 that looks like the original report!",
    "created_at": "2021-07-20T06:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606571",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
However, I do get errors with the `cbc` from the upgrade ticket #30644 that looks like the original report!



---

archive/issue_comments_606572.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2021-07-20T06:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606572",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_606573.json:
```json
{
    "body": "<a id='comment:41'></a>\nThat's a bug that will need investigating. \n\nhttps://coin-or.github.io/Cbc/cbcmodelclass.html:\n\n  Primal column solution\t\n\n  `const double * getColSolution()`\n\n  The OSI method will return the best solution found thus far, unless none has been found. It is safer to use CbcModel version, CbcModel::bestSolution()\"",
    "created_at": "2021-07-20T07:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606573",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>
That's a bug that will need investigating. 

https://coin-or.github.io/Cbc/cbcmodelclass.html:

  Primal column solution	

  `const double * getColSolution()`

  The OSI method will return the best solution found thus far, unless none has been found. It is safer to use CbcModel version, CbcModel::bestSolution()"



---

archive/issue_events_089770.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-20T15:26:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89770"
}
```



---

archive/issue_events_089771.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-20T15:26:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89771"
}
```



---

archive/issue_comments_606574.json:
```json
{
    "body": "<a id='comment:44'></a>\n`g.minor()` is buggy. E.g. with `solver='ppl'` is doesn't seem to terminate on \n\n```\ng = graphs.RandomGNP(20,.5)\ng = g.subgraph(edges = g.min_spanning_tree())\ng.minor(graphs.CompleteGraph(3), solver='ppl')\n```\n\nWith 'glpk' instead of 'ppl' it's quick and correct (no such minor).\n\nWith Coin/cbc (from #30644, but do not forget to `make sage_numerical_backends_coin`)\nit returns nonsense `{0: [], 1: [0], 2: [17]}`.\n\nAn interface bug? (both for PPL and Coin/cbc?)",
    "created_at": "2021-07-21T11:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606574",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>
`g.minor()` is buggy. E.g. with `solver='ppl'` is doesn't seem to terminate on 

```
g = graphs.RandomGNP(20,.5)
g = g.subgraph(edges = g.min_spanning_tree())
g.minor(graphs.CompleteGraph(3), solver='ppl')
```

With 'glpk' instead of 'ppl' it's quick and correct (no such minor).

With Coin/cbc (from #30644, but do not forget to `make sage_numerical_backends_coin`)
it returns nonsense `{0: [], 1: [0], 2: [17]}`.

An interface bug? (both for PPL and Coin/cbc?)



---

archive/issue_comments_606575.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [dimpase](#comment%3A44):\n>  with `solver='ppl'` is doesn't seem to terminate \n\n\nThis is a MIP model with 117 binary variables, 344 total variables. Just way out of league for PPL. No bug here",
    "created_at": "2021-07-26T18:24:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606575",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Replying to [dimpase](#comment%3A44):
>  with `solver='ppl'` is doesn't seem to terminate 


This is a MIP model with 117 binary variables, 344 total variables. Just way out of league for PPL. No bug here



---

archive/issue_events_089772.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89772"
}
```



---

archive/issue_events_089773.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89773"
}
```



---

archive/issue_events_089774.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89774"
}
```



---

archive/issue_events_089775.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89775"
}
```



---

archive/issue_comments_606576.json:
```json
{
    "body": "<a id='comment:47'></a>\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606576",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_089776.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89776"
}
```



---

archive/issue_events_089777.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89777"
}
```



---

archive/issue_comments_606577.json:
```json
{
    "body": "<a id='comment:49'></a>\nObsolete after #30644",
    "created_at": "2022-07-30T23:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606577",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>
Obsolete after #30644



---

archive/issue_comments_606578.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2022-07-30T23:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606578",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_events_089778.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-30T23:50:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89778"
}
```



---

archive/issue_events_089779.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-30T23:50:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89779"
}
```



---

archive/issue_comments_606579.json:
```json
{
    "body": "**Changing dependencies** from \"#32197 #32218 #32219 #32220 #32221 #32222 #32223 #32224 #32225 #32236 #32237 #32238 #32239 #32240 #32241\" to \"#30644\".",
    "created_at": "2022-07-30T23:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606579",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32197 #32218 #32219 #32220 #32221 #32222 #32223 #32224 #32225 #32236 #32237 #32238 #32239 #32240 #32241" to "#30644".



---

archive/issue_comments_606580.json:
```json
{
    "body": "**Reviewer:** David Coudert",
    "created_at": "2022-07-31T06:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606580",
    "user": "https://github.com/dcoudert"
}
```

**Reviewer:** David Coudert



---

archive/issue_comments_606581.json:
```json
{
    "body": "<a id='comment:50'></a>\nSo then.",
    "created_at": "2022-07-31T06:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606581",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:50'></a>
So then.



---

archive/issue_comments_606582.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-07-31T06:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606582",
    "user": "https://github.com/dcoudert"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_089780.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-02T06:31:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30635#event-89780"
}
```



---

archive/issue_comments_606583.json:
```json
{
    "body": "**Resolution:** invalid",
    "created_at": "2022-08-02T06:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30635#issuecomment-606583",
    "user": "https://github.com/mkoeppe"
}
```

**Resolution:** invalid
