# Issue 30845: Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow

archive/issues_030608.json:
```json
{
    "assignees": [],
    "body": "Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.\n\nThis also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n\nRun: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n\nFixes:\n- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n- environment-optional: lcalc 1 is installed and then not recognized / leads to error\n\n```\nbuilding 'sage.libs.lcalc.lcalc_Lfunction' extension\n    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n        1 | #include \"lcalc/L.h\"\n          |          ^~~~~~~~~~~\n    compilation terminated.\n```\n- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n- Disable conda distro information for `gdb` because it is broken on macOS.\n- Add conda distro information for `lrcalc_python`\n- Filter out conda-specific `ld` warnings in doctests\n- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed\n- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires\n\n\nFollow-ups: See Meta-ticket #33331\n\n\nDepends on #33358\nDepends on #33330\nDepends on #33361\nDepends on #33141\n\nCC:  @isuruf @tobiasdiez @dimpase @saraedum\n\nKeywords: **sd111**\n\nBranch/Commit: **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**\n\nReviewer: **Matthias Koeppe, Dima Pasechnik, Tobias Diez**\n\nAuthor: **Tobias Diez, Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30845_\n\n",
    "closed_at": "2022-03-27T15:44:10Z",
    "created_at": "2020-11-01T18:57:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow",
    "type": "issue",
    "updated_at": "2022-03-27T15:44:10Z",
    "url": "https://github.com/sagemath/sage/issues/30845",
    "user": "https://github.com/mkoeppe"
}
```
Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.

This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)

Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml

Fixes:
- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
- environment-optional: lcalc 1 is installed and then not recognized / leads to error

```
building 'sage.libs.lcalc.lcalc_Lfunction' extension
    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
        1 | #include "lcalc/L.h"
          |          ^~~~~~~~~~~
    compilation terminated.
```
- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
- Disable conda distro information for `gdb` because it is broken on macOS.
- Add conda distro information for `lrcalc_python`
- Filter out conda-specific `ld` warnings in doctests
- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed
- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires


Follow-ups: See Meta-ticket #33331


Depends on #33358
Depends on #33330
Depends on #33361
Depends on #33141

CC:  @isuruf @tobiasdiez @dimpase @saraedum

Keywords: **sd111**

Branch/Commit: **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**

Reviewer: **Matthias Koeppe, Dima Pasechnik, Tobias Diez**

Author: **Tobias Diez, Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/30845_





---

archive/issue_events_427506.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-01T18:57:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427506"
}
```



---

archive/issue_events_427507.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-01T18:57:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427507"
}
```



---

archive/issue_events_427508.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-01T18:57:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427508"
}
```



---

archive/issue_events_427509.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-01T18:57:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427509"
}
```



---

archive/issue_events_427510.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-03T01:17:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "title_is": "tox.ini, GH Actions: Add test for conda without SPKG",
    "title_was": "GH Actions: Add test for conda without SPKG",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427510"
}
```



---

archive/issue_comments_493491.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n+This would also test that the generated `environment*.yml` files work correctly.\n \n``````\n",
    "created_at": "2020-11-26T21:46:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493491",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
+This would also test that the generated `environment*.yml` files work correctly.
 
``````




---

archive/issue_comments_493492.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493492",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_comments_493493.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493493",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_493494.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1 @@\n-This would also test that the generated `environment*.yml` files work correctly.\n-\n+This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2020-12-21T23:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493494",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1 @@
-This would also test that the generated `environment*.yml` files work correctly.
-
+This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_comments_493495.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSomething like https://github.com/tobiasdiez/sage/blob/public/build/conda_gh/.github/workflows/ci-conda.yml?\n\nThis currently fails with\n\n```\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: creating build/pkgs/sage_conf/src/sage_conf.py\nconfig.status: creating build/pkgs/sage_conf/src/setup.cfg\nconfig.status: executing depfiles commands\nconfig.status: executing mkdirs commands\nconfig.status: creating directory /home/runner/work/sage/sage/logs/pkgs\nconfig.status: creating directory \nmkdir: cannot create directory '': No such file or directory\nconfig.status: error: could not create \nError: Process completed with exit code 1.\n```\nhttps://github.com/tobiasdiez/sage/runs/1594237745?check_suite_focus=true\nAny idea what could be the reason and how to fix it?",
    "created_at": "2020-12-22T10:44:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493495",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:7" align="right">comment:7</div>

Something like https://github.com/tobiasdiez/sage/blob/public/build/conda_gh/.github/workflows/ci-conda.yml?

This currently fails with

```
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: creating build/pkgs/sage_conf/src/sage_conf.py
config.status: creating build/pkgs/sage_conf/src/setup.cfg
config.status: executing depfiles commands
config.status: executing mkdirs commands
config.status: creating directory /home/runner/work/sage/sage/logs/pkgs
config.status: creating directory 
mkdir: cannot create directory '': No such file or directory
config.status: error: could not create 
Error: Process completed with exit code 1.
```
https://github.com/tobiasdiez/sage/runs/1594237745?check_suite_focus=true
Any idea what could be the reason and how to fix it?



---

archive/issue_comments_493496.json:
```json
{
    "body": "Commit: **[`9af4614`](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)**",
    "created_at": "2020-12-22T10:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493496",
    "user": "https://github.com/tobiasdiez"
}
```

Commit: **[`9af4614`](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)**



---

archive/issue_comments_493497.json:
```json
{
    "body": "Author: **Tobias Diez**",
    "created_at": "2020-12-22T10:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493497",
    "user": "https://github.com/tobiasdiez"
}
```

Author: **Tobias Diez**



---

archive/issue_comments_493498.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c68d2624a0c205447fa19b88cc392673e445f691\"><code>c68d262</code></a></td><td><code>Add first version of workflow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76\"><code>9af4614</code></a></td><td><code>Try with sudo (why is this needed now?!)</code></td></tr></table>\n",
    "created_at": "2020-12-22T10:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493498",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:8"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c68d2624a0c205447fa19b88cc392673e445f691"><code>c68d262</code></a></td><td><code>Add first version of workflow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76"><code>9af4614</code></a></td><td><code>Try with sudo (why is this needed now?!)</code></td></tr></table>




---

archive/issue_comments_493499.json:
```json
{
    "body": "Branch: **[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)**",
    "created_at": "2020-12-22T10:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493499",
    "user": "https://github.com/tobiasdiez"
}
```

Branch: **[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)**



---

archive/issue_comments_493500.json:
```json
{
    "body": "Changed commit from **[`9af4614`](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)** to **[`a178b56`](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)**",
    "created_at": "2020-12-22T11:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493500",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9af4614`](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)** to **[`a178b56`](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)**



---

archive/issue_comments_493501.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ac74ee21958bb9534f9b8abb7983583f911ec70\"><code>5ac74ee</code></a></td><td><code>Try with conda-incubator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4\"><code>a178b56</code></a></td><td><code>Run in the conda shell</code></td></tr></table>\n",
    "created_at": "2020-12-22T11:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493501",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ac74ee21958bb9534f9b8abb7983583f911ec70"><code>5ac74ee</code></a></td><td><code>Try with conda-incubator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4"><code>a178b56</code></a></td><td><code>Run in the conda shell</code></td></tr></table>




---

archive/issue_comments_493502.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/199886cd5530d27e3c098fc06ccdc4748ae28431\"><code>199886c</code></a></td><td><code>Install more conda dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10de3f5dc6566bdba49d5fe1ce5626d3ce516c28\"><code>10de3f5</code></a></td><td><code>Fix conda env name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e\"><code>86411b8</code></a></td><td><code>Remove unnececesary install of conda dep</code></td></tr></table>\n",
    "created_at": "2020-12-22T11:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493502",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/199886cd5530d27e3c098fc06ccdc4748ae28431"><code>199886c</code></a></td><td><code>Install more conda dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10de3f5dc6566bdba49d5fe1ce5626d3ce516c28"><code>10de3f5</code></a></td><td><code>Fix conda env name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e"><code>86411b8</code></a></td><td><code>Remove unnececesary install of conda dep</code></td></tr></table>




---

archive/issue_comments_493503.json:
```json
{
    "body": "Changed commit from **[`a178b56`](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)** to **[`86411b8`](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)**",
    "created_at": "2020-12-22T11:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493503",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a178b56`](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)** to **[`86411b8`](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)**



---

archive/issue_comments_493504.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nManaged to fix the above error, just to be stuck two lines further down:\n\n```\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: creating build/pkgs/sage_conf/src/sage_conf.py\nconfig.status: creating build/pkgs/sage_conf/src/setup.cfg\nconfig.status: executing depfiles commands\nconfig.status: executing broken-gcc commands\nconfig.status: executing mkdirs commands\nconfig.status: creating directory /home/runner/work/sage/sage/logs/pkgs\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/bin\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/etc\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/include\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/lib\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/lib/pkgconfig\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/share\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/var/lib/sage/installed\nconfig.status: error: Cannot perform incremental update, run \"make distclean && make\"\nconfig.status: /usr/share/miniconda/envs/sage-build/lib64 is not a symlink, see Trac #19782\nError: Process completed with exit code 1.\n```\nhttps://github.com/tobiasdiez/sage/runs/1594601374?check_suite_focus=true",
    "created_at": "2020-12-22T11:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493504",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:11" align="right">comment:11</div>

Managed to fix the above error, just to be stuck two lines further down:

```
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: creating build/pkgs/sage_conf/src/sage_conf.py
config.status: creating build/pkgs/sage_conf/src/setup.cfg
config.status: executing depfiles commands
config.status: executing broken-gcc commands
config.status: executing mkdirs commands
config.status: creating directory /home/runner/work/sage/sage/logs/pkgs
config.status: creating directory /usr/share/miniconda/envs/sage-build
config.status: creating directory /usr/share/miniconda/envs/sage-build/bin
config.status: creating directory /usr/share/miniconda/envs/sage-build/etc
config.status: creating directory /usr/share/miniconda/envs/sage-build/include
config.status: creating directory /usr/share/miniconda/envs/sage-build/lib
config.status: creating directory /usr/share/miniconda/envs/sage-build/lib/pkgconfig
config.status: creating directory /usr/share/miniconda/envs/sage-build/share
config.status: creating directory /usr/share/miniconda/envs/sage-build/var/lib/sage/installed
config.status: error: Cannot perform incremental update, run "make distclean && make"
config.status: /usr/share/miniconda/envs/sage-build/lib64 is not a symlink, see Trac #19782
Error: Process completed with exit code 1.
```
https://github.com/tobiasdiez/sage/runs/1594601374?check_suite_focus=true



---

archive/issue_comments_493505.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFound a hack that fixed it by removing the lib64 folder. It only contained `libcc1.so` (not sure where/how this is needed).",
    "created_at": "2020-12-22T12:22:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493505",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:12" align="right">comment:12</div>

Found a hack that fixed it by removing the lib64 folder. It only contained `libcc1.so` (not sure where/how this is needed).



---

archive/issue_comments_493506.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nMade a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because \"sage-env-config\" doesn't exist.\nhttps://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true",
    "created_at": "2020-12-22T13:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493506",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:13" align="right">comment:13</div>

Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because "sage-env-config" doesn't exist.
https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true



---

archive/issue_comments_493507.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53503dc53801cb0be1e48359358013e6508df692\"><code>53503dc</code></a></td><td><code>Try remove lib64 folder by hand</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e530ac0752fe4109f2f2f4ad853741b3577ee3b2\"><code>e530ac0</code></a></td><td><code>Add c++ compiler to conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab47f5e52e705948e331b39790c1c4595288425c\"><code>ab47f5e</code></a></td><td><code>Install directly on top of conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af\"><code>741c55a</code></a></td><td><code>Make autogen work</code></td></tr></table>\n",
    "created_at": "2020-12-22T13:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493507",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53503dc53801cb0be1e48359358013e6508df692"><code>53503dc</code></a></td><td><code>Try remove lib64 folder by hand</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e530ac0752fe4109f2f2f4ad853741b3577ee3b2"><code>e530ac0</code></a></td><td><code>Add c++ compiler to conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab47f5e52e705948e331b39790c1c4595288425c"><code>ab47f5e</code></a></td><td><code>Install directly on top of conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af"><code>741c55a</code></a></td><td><code>Make autogen work</code></td></tr></table>




---

archive/issue_comments_493508.json:
```json
{
    "body": "Changed commit from **[`86411b8`](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)** to **[`741c55a`](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)**",
    "created_at": "2020-12-22T13:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493508",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`86411b8`](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)** to **[`741c55a`](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)**



---

archive/issue_comments_493509.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe `direct` variant should use `src/environment.yml` - which installs the Python packages of Sage in addition to what is listed in `environment.yml`",
    "created_at": "2020-12-22T14:43:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493509",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

The `direct` variant should use `src/environment.yml` - which installs the Python packages of Sage in addition to what is listed in `environment.yml`



---

archive/issue_comments_493510.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe `lib64` looks like a conda packaging bug to me - @isuruf, can you help?",
    "created_at": "2020-12-22T14:44:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493510",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

The `lib64` looks like a conda packaging bug to me - @isuruf, can you help?



---

archive/issue_comments_493511.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n`environment.yml` already includes `compilers` -- I don't think adding `cxx-compiler` should be necessary",
    "created_at": "2020-12-22T14:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493511",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

`environment.yml` already includes `compilers` -- I don't think adding `cxx-compiler` should be necessary



---

archive/issue_comments_493512.json:
```json
{
    "body": "Changed commit from **[`741c55a`](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)** to **[`3aba048`](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)**",
    "created_at": "2020-12-22T14:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493512",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`741c55a`](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)** to **[`3aba048`](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)**



---

archive/issue_comments_493513.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1231a24a021c9a760696063d532f5b569f751fd3\"><code>1231a24</code></a></td><td><code>Add env logging and fix SAGE_SRC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be024f8b783ff59403ea96c330b56c84718d4c52\"><code>be024f8</code></a></td><td><code>Fix build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a46d049ef169be7b13dc7c5b7e06fdfbf4326b4\"><code>8a46d04</code></a></td><td><code>Improve output of print_env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9802c56b11d65e099d2b20c8afa790d70cb4fd2c\"><code>9802c56</code></a></td><td><code>Improve print statement</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1\"><code>3aba048</code></a></td><td><code>Use correct conda env file</code></td></tr></table>\n",
    "created_at": "2020-12-22T14:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493513",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1231a24a021c9a760696063d532f5b569f751fd3"><code>1231a24</code></a></td><td><code>Add env logging and fix SAGE_SRC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be024f8b783ff59403ea96c330b56c84718d4c52"><code>be024f8</code></a></td><td><code>Fix build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a46d049ef169be7b13dc7c5b7e06fdfbf4326b4"><code>8a46d04</code></a></td><td><code>Improve output of print_env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9802c56b11d65e099d2b20c8afa790d70cb4fd2c"><code>9802c56</code></a></td><td><code>Improve print statement</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1"><code>3aba048</code></a></td><td><code>Use correct conda env file</code></td></tr></table>




---

archive/issue_comments_493514.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@tobiasdiez](#comment:13):\n> Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because \"sage-env-config\" doesn't exist.\n> https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true\n\nThis is now #31097.",
    "created_at": "2020-12-22T15:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493514",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@tobiasdiez](#comment:13):
> Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because "sage-env-config" doesn't exist.
> https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true

This is now #31097.



---

archive/issue_comments_493515.json:
```json
{
    "body": "Changed dependencies from **#28745** to **#31097**",
    "created_at": "2020-12-22T15:02:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493515",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#28745** to **#31097**



---

archive/issue_comments_493516.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2020-12-22T16:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493516",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_comments_493517.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI don't see a `lib64` folder. Which package is that coming from?",
    "created_at": "2020-12-22T16:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493517",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:22" align="right">comment:22</div>

I don't see a `lib64` folder. Which package is that coming from?



---

archive/issue_comments_493518.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIt contains `libcc1.so` so I guess gcc, g++ or some other compiler package.",
    "created_at": "2020-12-22T16:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493518",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:23" align="right">comment:23</div>

It contains `libcc1.so` so I guess gcc, g++ or some other compiler package.



---

archive/issue_comments_493519.json:
```json
{
    "body": "Changed commit from **[`3aba048`](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)** to **[`e9cb77b`](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)**",
    "created_at": "2020-12-22T18:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493519",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3aba048`](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)** to **[`e9cb77b`](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)**



---

archive/issue_comments_493520.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d853f145528c3380b2c276c7e49f102beefa3b36\"><code>d853f14</code></a></td><td><code>Ok, then install setup.py relative to src</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb5e2847fadc4410371250f81fc4ab083188c475\"><code>cb5e284</code></a></td><td><code>Add tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cf3de4add77b367da7a7935dbe1c3cb90ab51e8\"><code>1cf3de4</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Fix SAGE_BROKEN_GCC test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bc9c291355f9f549baeb780864573e35b21160c\"><code>1bc9c29</code></a></td><td><code>Merge branch 'u/mkoeppe/build_pkgs_gcc_spkg_configure_m4__fix_sage_broken_gcc_test' of git://trac.sagemath.org/sage into public/build/conda_gh</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c57d6156cbfd943b6724434293fa205ca531d38b\"><code>c57d615</code></a></td><td><code>Correct bootstrap command</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e85f1ba51d8bb4a60e096491aefec9f5f4407e75\"><code>e85f1ba</code></a></td><td><code>Fix venv config</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e29a9ab119e8254cb95e36c47499f237c2c58f1b\"><code>e29a9ab</code></a></td><td><code>Correct test command</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/483de62f8d29536ec04fca70d04d350dfb5ccf1a\"><code>483de62</code></a></td><td><code>Install autotools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8237b2cfb4369a374466aff1a97f497418a42180\"><code>8237b2c</code></a></td><td><code>Install gettext</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9\"><code>e9cb77b</code></a></td><td><code>Force configure to not install gcc</code></td></tr></table>\n",
    "created_at": "2020-12-22T18:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493520",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d853f145528c3380b2c276c7e49f102beefa3b36"><code>d853f14</code></a></td><td><code>Ok, then install setup.py relative to src</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb5e2847fadc4410371250f81fc4ab083188c475"><code>cb5e284</code></a></td><td><code>Add tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cf3de4add77b367da7a7935dbe1c3cb90ab51e8"><code>1cf3de4</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Fix SAGE_BROKEN_GCC test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bc9c291355f9f549baeb780864573e35b21160c"><code>1bc9c29</code></a></td><td><code>Merge branch 'u/mkoeppe/build_pkgs_gcc_spkg_configure_m4__fix_sage_broken_gcc_test' of git://trac.sagemath.org/sage into public/build/conda_gh</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c57d6156cbfd943b6724434293fa205ca531d38b"><code>c57d615</code></a></td><td><code>Correct bootstrap command</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e85f1ba51d8bb4a60e096491aefec9f5f4407e75"><code>e85f1ba</code></a></td><td><code>Fix venv config</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e29a9ab119e8254cb95e36c47499f237c2c58f1b"><code>e29a9ab</code></a></td><td><code>Correct test command</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/483de62f8d29536ec04fca70d04d350dfb5ccf1a"><code>483de62</code></a></td><td><code>Install autotools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8237b2cfb4369a374466aff1a97f497418a42180"><code>8237b2c</code></a></td><td><code>Install gettext</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9"><code>e9cb77b</code></a></td><td><code>Force configure to not install gcc</code></td></tr></table>




---

archive/issue_comments_493521.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nCurrent status:\n- Building sage using `make` on top of conda fails, since gcc is not found and the custom build of gcc fails.\n- Installing sagelib on top of a conda works, but many doctests fail.\n\nhttps://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22\n\nI let somebody else with more experience in conda/the intricacies of sage's build system take over from here.",
    "created_at": "2020-12-22T18:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493521",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:25" align="right">comment:25</div>

Current status:
- Building sage using `make` on top of conda fails, since gcc is not found and the custom build of gcc fails.
- Installing sagelib on top of a conda works, but many doctests fail.

https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22

I let somebody else with more experience in conda/the intricacies of sage's build system take over from here.



---

archive/issue_comments_493522.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThanks for getting this started!",
    "created_at": "2020-12-22T18:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493522",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Thanks for getting this started!



---

archive/issue_comments_493523.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nUnfortunately the runs do not give the config.log",
    "created_at": "2020-12-22T18:43:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493523",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Unfortunately the runs do not give the config.log



---

archive/issue_comments_493524.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nNow I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work.",
    "created_at": "2020-12-22T18:53:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493524",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work.



---

archive/issue_comments_493525.json:
```json
{
    "body": "Changed commit from **[`e9cb77b`](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)** to **[`9857e36`](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)**",
    "created_at": "2020-12-22T21:12:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493525",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e9cb77b`](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)** to **[`9857e36`](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)**



---

archive/issue_comments_493526.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449\"><code>9857e36</code></a></td><td><code>Without the prefix</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:12:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493526",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449"><code>9857e36</code></a></td><td><code>Without the prefix</code></td></tr></table>




---

archive/issue_comments_493527.json:
```json
{
    "body": "Changed commit from **[`9857e36`](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)** to **[`b50ae6a`](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)**",
    "created_at": "2020-12-22T21:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493527",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9857e36`](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)** to **[`b50ae6a`](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)**



---

archive/issue_comments_493528.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163\"><code>b50ae6a</code></a></td><td><code>Remove conda gcc distro again</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493528",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163"><code>b50ae6a</code></a></td><td><code>Remove conda gcc distro again</code></td></tr></table>




---

archive/issue_comments_493529.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468\"><code>68080fa</code></a></td><td><code>Cleanup workflow</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:36:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493529",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468"><code>68080fa</code></a></td><td><code>Cleanup workflow</code></td></tr></table>




---

archive/issue_comments_493530.json:
```json
{
    "body": "Changed commit from **[`b50ae6a`](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)** to **[`68080fa`](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)**",
    "created_at": "2020-12-22T21:36:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493530",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b50ae6a`](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)** to **[`68080fa`](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)**



---

archive/issue_comments_493531.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@mkoeppe](#comment:28):\n> Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work. \n\nThanks! Removing the prefix part indeed fixed the gcc issue. Now we are further in the build, and find this beautiful error:\n\n```\n2020-12-22T21:44:17.7966259Z [cvxopt-1.2.5]   x86_64-conda_cos6-linux-gnu-gcc -pthread -shared -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -L/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-rpath,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include build/temp.linux-x86_64-3.8/src/C/lapack.o -L/usr/share/miniconda/envs/sage-build/lib -lopenblas -lopenblas -o build/lib.linux-x86_64-3.8/cvxopt/lapack.cpython-38-x86_64-linux-gnu.so\n2020-12-22T21:44:17.7974135Z [cvxopt-1.2.5]   building 'umfpack' extension\n2020-12-22T21:44:17.7979362Z [cvxopt-1.2.5]   /usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include -fPIC -I/usr/include -I/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/include -I/usr/share/miniconda/envs/sage-build/include/python3.8 -c src/C/umfpack.c -o build/temp.linux-x86_64-3.8/src/C/umfpack.o\n2020-12-22T21:44:17.7990748Z [cvxopt-1.2.5]   In file included from /usr/share/miniconda/envs/sage-build/include/python3.8/Python.h:11:0,\n2020-12-22T21:44:17.7991831Z [cvxopt-1.2.5]                    from src/C/cvxopt.h:22,\n2020-12-22T21:44:17.7992613Z [cvxopt-1.2.5]                    from src/C/umfpack.c:22:\n2020-12-22T21:44:17.7993750Z [cvxopt-1.2.5]   /usr/include/limits.h:26:10: fatal error: bits/libc-header-start.h: No such file or directory\n2020-12-22T21:44:17.7994924Z [cvxopt-1.2.5]    #include <bits/libc-header-start.h>\n2020-12-22T21:44:17.7995741Z [cvxopt-1.2.5]             ^~~~~~~~~~~~~~~~~~~~~~~~~~\n2020-12-22T21:44:17.7996470Z [cvxopt-1.2.5]   compilation terminated.\n2020-12-22T21:44:17.7997728Z [cvxopt-1.2.5]   error: command '/usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc' failed with exit status 1\n2020-12-22T21:44:17.7999070Z [cvxopt-1.2.5]   Building wheel for cvxopt (setup.py): finished with status 'error'\n```\nCould this be related to the fact that libcc1 is installed in `lib64`?",
    "created_at": "2020-12-22T21:55:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493531",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@mkoeppe](#comment:28):
> Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work. 

Thanks! Removing the prefix part indeed fixed the gcc issue. Now we are further in the build, and find this beautiful error:

```
2020-12-22T21:44:17.7966259Z [cvxopt-1.2.5]   x86_64-conda_cos6-linux-gnu-gcc -pthread -shared -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -L/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-rpath,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include build/temp.linux-x86_64-3.8/src/C/lapack.o -L/usr/share/miniconda/envs/sage-build/lib -lopenblas -lopenblas -o build/lib.linux-x86_64-3.8/cvxopt/lapack.cpython-38-x86_64-linux-gnu.so
2020-12-22T21:44:17.7974135Z [cvxopt-1.2.5]   building 'umfpack' extension
2020-12-22T21:44:17.7979362Z [cvxopt-1.2.5]   /usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include -fPIC -I/usr/include -I/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/include -I/usr/share/miniconda/envs/sage-build/include/python3.8 -c src/C/umfpack.c -o build/temp.linux-x86_64-3.8/src/C/umfpack.o
2020-12-22T21:44:17.7990748Z [cvxopt-1.2.5]   In file included from /usr/share/miniconda/envs/sage-build/include/python3.8/Python.h:11:0,
2020-12-22T21:44:17.7991831Z [cvxopt-1.2.5]                    from src/C/cvxopt.h:22,
2020-12-22T21:44:17.7992613Z [cvxopt-1.2.5]                    from src/C/umfpack.c:22:
2020-12-22T21:44:17.7993750Z [cvxopt-1.2.5]   /usr/include/limits.h:26:10: fatal error: bits/libc-header-start.h: No such file or directory
2020-12-22T21:44:17.7994924Z [cvxopt-1.2.5]    #include <bits/libc-header-start.h>
2020-12-22T21:44:17.7995741Z [cvxopt-1.2.5]             ^~~~~~~~~~~~~~~~~~~~~~~~~~
2020-12-22T21:44:17.7996470Z [cvxopt-1.2.5]   compilation terminated.
2020-12-22T21:44:17.7997728Z [cvxopt-1.2.5]   error: command '/usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc' failed with exit status 1
2020-12-22T21:44:17.7999070Z [cvxopt-1.2.5]   Building wheel for cvxopt (setup.py): finished with status 'error'
```
Could this be related to the fact that libcc1 is installed in `lib64`?



---

archive/issue_comments_493532.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThis is known. #30710",
    "created_at": "2020-12-22T21:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493532",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:33" align="right">comment:33</div>

This is known. #30710



---

archive/issue_comments_493533.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAh thx for the pointer!",
    "created_at": "2020-12-22T22:03:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493533",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:34" align="right">comment:34</div>

Ah thx for the pointer!



---

archive/issue_comments_493534.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI guess the main objective of this ticket was to add a workflow verifying that sagelib installed on top of conda works. Since this is accomplished, I'll put it as ready for review.\n\nFixing the doctests and the build using `make` can be done later (e.g by resolving #30710).",
    "created_at": "2020-12-22T22:09:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493534",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:35" align="right">comment:35</div>

I guess the main objective of this ticket was to add a workflow verifying that sagelib installed on top of conda works. Since this is accomplished, I'll put it as ready for review.

Fixing the doctests and the build using `make` can be done later (e.g by resolving #30710).



---

archive/issue_events_427511.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-22T22:09:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427511"
}
```



---

archive/issue_comments_493535.json:
```json
{
    "body": "Reviewer: **https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22**",
    "created_at": "2020-12-22T22:09:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493535",
    "user": "https://github.com/tobiasdiez"
}
```

Reviewer: **https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22**



---

archive/issue_comments_493536.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAs `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.",
    "created_at": "2020-12-23T00:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493536",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.



---

archive/issue_comments_493537.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI have opened #31099 for this.",
    "created_at": "2020-12-23T00:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493537",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>

I have opened #31099 for this.



---

archive/issue_comments_493538.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@mkoeppe](#comment:36):\n> As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.\n\nI thought about using tox as well, but there are\n\na) problems setting up conda on github actions (this is why the workflow uses a special action for the conda setup) \n\nb) difficulties with conda and tox environment interactions (which I guess are handled by the tox-conda plugin, but I didn't wanted to dive into this)\n\nc) I still think tox is not the right tool for managing the user's environment beyond the Python environment.",
    "created_at": "2020-12-23T11:25:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493538",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@mkoeppe](#comment:36):
> As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.

I thought about using tox as well, but there are

a) problems setting up conda on github actions (this is why the workflow uses a special action for the conda setup) 

b) difficulties with conda and tox environment interactions (which I guess are handled by the tox-conda plugin, but I didn't wanted to dive into this)

c) I still think tox is not the right tool for managing the user's environment beyond the Python environment.



---

archive/issue_comments_493539.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n`local-conda-forge-ubuntu-standard` has been running for months on GH Actions, see for example https://github.com/sagemath/sage/runs/1553907433 for 9.3.beta4.\n\n#31099 is just a matter of creating a variant that uses `conda env create -f environment.yml` instead of `conda install ...`.",
    "created_at": "2020-12-23T17:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493539",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>

`local-conda-forge-ubuntu-standard` has been running for months on GH Actions, see for example https://github.com/sagemath/sage/runs/1553907433 for 9.3.beta4.

#31099 is just a matter of creating a variant that uses `conda env create -f environment.yml` instead of `conda install ...`.



---

archive/issue_comments_493540.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nred branch => needs work",
    "created_at": "2021-01-31T20:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493540",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:40" align="right">comment:40</div>

red branch => needs work



---

archive/issue_events_427512.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-31T20:01:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427512"
}
```



---

archive/issue_events_427513.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-31T20:01:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427513"
}
```



---

archive/issue_events_427514.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427514"
}
```



---

archive/issue_events_427515.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427515"
}
```



---

archive/issue_comments_493541.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nMoving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493541",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_events_427516.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427516"
}
```



---

archive/issue_events_427517.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427517"
}
```



---

archive/issue_comments_493542.json:
```json
{
    "body": "Changed commit from **[`68080fa`](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)** to **[`103f78b`](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)**",
    "created_at": "2021-11-12T17:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493542",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`68080fa`](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)** to **[`103f78b`](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)**



---

archive/issue_comments_493543.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524\"><code>103f78b</code></a></td><td><code>.github/workflows/ci-conda.yml: New</code></td></tr></table>\n",
    "created_at": "2021-11-12T17:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493543",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524"><code>103f78b</code></a></td><td><code>.github/workflows/ci-conda.yml: New</code></td></tr></table>




---

archive/issue_comments_493544.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI have reduced the branch to one of the jobs, `direct`, to remove the duplication with the existing workflows.",
    "created_at": "2021-11-12T17:54:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493544",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

I have reduced the branch to one of the jobs, `direct`, to remove the duplication with the existing workflows.



---

archive/issue_comments_493545.json:
```json
{
    "body": "Changed dependencies from **#31097** to none",
    "created_at": "2021-11-12T17:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493545",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31097** to none



---

archive/issue_comments_493546.json:
```json
{
    "body": "Changed reviewer from **https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22** to none",
    "created_at": "2021-11-12T17:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493546",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22** to none



---

archive/issue_comments_493547.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nStill needs updating to follow the steps of \"Conda for Sage Developers\" - https://wiki.sagemath.org/Conda - help welcome",
    "created_at": "2021-11-12T17:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493547",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

Still needs updating to follow the steps of "Conda for Sage Developers" - https://wiki.sagemath.org/Conda - help welcome



---

archive/issue_comments_493548.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2021-11-12T17:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493548",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_events_427518.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427518"
}
```



---

archive/issue_events_427519.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427519"
}
```



---

archive/issue_comments_493549.json:
```json
{
    "body": "Changed branch from **[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)** to **[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)**",
    "created_at": "2022-02-10T20:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493549",
    "user": "https://github.com/tobiasdiez"
}
```

Changed branch from **[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)** to **[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)**



---

archive/issue_comments_493550.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65e1b49f79c04d755a17d02c14011c22492dc06b\"><code>65e1b49</code></a></td><td><code>Fix workflow syntax</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85c31c3426f7d288c10a4435eae1bacf4c1b11eb\"><code>85c31c3</code></a></td><td><code>Make workflow at least try to compile sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd484d8e120aa25d323510bbe9bbb663ceeeddff\"><code>fd484d8</code></a></td><td><code>Github needs sudo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/909cd9e1261d3fc89f7f99041e0fa0ab576c9747\"><code>909cd9e</code></a></td><td><code>Add a few missing python packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a91da81a85668720514f7a233235705093864126\"><code>a91da81</code></a></td><td><code>Run in parallel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4945e505fd916165a8e692150f68e36c4d15ffa\"><code>d4945e5</code></a></td><td><code>Install gap manually</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3171f82be5c8ee56a71a2cafd6c5065499d64f7e\"><code>3171f82</code></a></td><td><code>Split in more jobs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b87f2bcca52c9492d467c49392dd99bc25ddbbd0\"><code>b87f2bc</code></a></td><td><code>Reuse existing bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eec7abca427e82ed97edf9f8853ce2d72879504d\"><code>eec7abc</code></a></td><td><code>Delete env-python from gitignore again</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729\"><code>68e8330</code></a></td><td><code>Try with prefix instead of building ecl and gap</code></td></tr></table>\n",
    "created_at": "2022-02-10T20:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493550",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:48" align="right">comment:48</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65e1b49f79c04d755a17d02c14011c22492dc06b"><code>65e1b49</code></a></td><td><code>Fix workflow syntax</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85c31c3426f7d288c10a4435eae1bacf4c1b11eb"><code>85c31c3</code></a></td><td><code>Make workflow at least try to compile sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd484d8e120aa25d323510bbe9bbb663ceeeddff"><code>fd484d8</code></a></td><td><code>Github needs sudo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/909cd9e1261d3fc89f7f99041e0fa0ab576c9747"><code>909cd9e</code></a></td><td><code>Add a few missing python packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a91da81a85668720514f7a233235705093864126"><code>a91da81</code></a></td><td><code>Run in parallel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4945e505fd916165a8e692150f68e36c4d15ffa"><code>d4945e5</code></a></td><td><code>Install gap manually</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3171f82be5c8ee56a71a2cafd6c5065499d64f7e"><code>3171f82</code></a></td><td><code>Split in more jobs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b87f2bcca52c9492d467c49392dd99bc25ddbbd0"><code>b87f2bc</code></a></td><td><code>Reuse existing bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eec7abca427e82ed97edf9f8853ce2d72879504d"><code>eec7abc</code></a></td><td><code>Delete env-python from gitignore again</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729"><code>68e8330</code></a></td><td><code>Try with prefix instead of building ecl and gap</code></td></tr></table>




---

archive/issue_events_427520.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T20:12:47Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "title_is": "GH Actions: Add test for conda without SPKG",
    "title_was": "tox.ini, GH Actions: Add test for conda without SPKG",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427520"
}
```



---

archive/issue_comments_493551.json:
```json
{
    "body": "Changed commit from **[`103f78b`](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)** to **[`68e8330`](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)**",
    "created_at": "2022-02-10T20:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493551",
    "user": "https://github.com/tobiasdiez"
}
```

Changed commit from **[`103f78b`](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)** to **[`68e8330`](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)**



---

archive/issue_comments_493552.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+\n+Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true\n+\n+Issues:\n+- rpy2 is not installed in the conda env\n+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h\n``````\n",
    "created_at": "2022-02-10T20:22:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493552",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
 This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+
+Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true
+
+Issues:
+- rpy2 is not installed in the conda env
+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h
``````




---

archive/issue_events_427521.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T23:20:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427521"
}
```



---

archive/issue_events_427522.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T23:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427522"
}
```



---

archive/issue_comments_493553.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nOkay, this is now ready for review.\n\nAny pointers to the two open issues are welcome. I looked for open tickets in these directions, but couldn't find one.",
    "created_at": "2022-02-10T23:20:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493553",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:50" align="right">comment:50</div>

Okay, this is now ready for review.

Any pointers to the two open issues are welcome. I looked for open tickets in these directions, but couldn't find one.



---

archive/issue_comments_493554.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,16 @@\n-This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.\n \n-Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true\n+This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n \n-Issues:\n+Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n+\n+The build of sage currently fails with the following issues:\n - rpy2 is not installed in the conda env\n-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h\n+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n+\n+```\n+\tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n+```\n+is used uninitialized in this function\n+\n+Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-10T23:20:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493554",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,16 @@
-This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.
 
-Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true
+This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)
 
-Issues:
+Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
+
+The build of sage currently fails with the following issues:
 - rpy2 is not installed in the conda env
-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h
+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
+
+```
+	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
+```
+is used uninitialized in this function
+
+Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_493555.json:
```json
{
    "body": "Changed commit from **[`68e8330`](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)** to **[`b408f9e`](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)**",
    "created_at": "2022-02-10T23:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493555",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`68e8330`](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)** to **[`b408f9e`](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)**



---

archive/issue_comments_493556.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462\"><code>b408f9e</code></a></td><td><code>Cleanup workflow</code></td></tr></table>\n",
    "created_at": "2022-02-10T23:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493556",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462"><code>b408f9e</code></a></td><td><code>Cleanup workflow</code></td></tr></table>




---

archive/issue_comments_493557.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nIn https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true I see\n\nI see \n\n```\nbuilding 'sage.libs.lcalc.lcalc_Lfunction' extension\n    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n        1 | #include \"lcalc/L.h\"\n          |          ^~~~~~~~~~~\n    compilation terminated.\n    building 'sage.libs.libecm' extension\n```",
    "created_at": "2022-02-10T23:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493557",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:52" align="right">comment:52</div>

In https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true I see

I see 

```
building 'sage.libs.lcalc.lcalc_Lfunction' extension
    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
        1 | #include "lcalc/L.h"
          |          ^~~~~~~~~~~
    compilation terminated.
    building 'sage.libs.libecm' extension
```



---

archive/issue_comments_493558.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,5 +12,17 @@\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n ```\n is used uninitialized in this function\n+- lcalc is not recognized although installed in conda\n+\n+```\n+building 'sage.libs.lcalc.lcalc_Lfunction' extension\n+    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n+    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n+    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n+        1 | #include \"lcalc/L.h\"\n+          |          ^~~~~~~~~~~\n+    compilation terminated.\n+```\n+- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-11T08:51:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493558",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,5 +12,17 @@
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
 ```
 is used uninitialized in this function
+- lcalc is not recognized although installed in conda
+
+```
+building 'sage.libs.lcalc.lcalc_Lfunction' extension
+    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
+    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
+    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
+        1 | #include "lcalc/L.h"
+          |          ^~~~~~~~~~~
+    compilation terminated.
+```
+- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
 Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_493559.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nGood observation. I think, however, this is not the reason why the build terminates as this error occurs somewhere in the middle (and I had similar error messages with `gap` before).\nI've added it to the list of \"issues\" in the ticket description.",
    "created_at": "2022-02-11T08:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493559",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:54" align="right">comment:54</div>

Good observation. I think, however, this is not the reason why the build terminates as this error occurs somewhere in the middle (and I had similar error messages with `gap` before).
I've added it to the list of "issues" in the ticket description.



---

archive/issue_comments_493560.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThis is the reason for the failure. There's no mystery there.",
    "created_at": "2022-02-11T18:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493560",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">comment:55</div>

This is the reason for the failure. There's no mystery there.



---

archive/issue_events_427523.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T18:18:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427523"
}
```



---

archive/issue_events_427524.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T18:18:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427524"
}
```



---

archive/issue_comments_493561.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nDo you get `lcalc>=2` with conda?",
    "created_at": "2022-02-11T19:59:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493561",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:56" align="right">comment:56</div>

Do you get `lcalc>=2` with conda?



---

archive/issue_comments_493562.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@mkoeppe](#comment:55):\n> This is the reason for the failure. There's no mystery there.\n\nCould be. But the point of this ticket is to add the github action, so that one can fix these issues in follow-up tickets and have a direct verification. It might take quite some time until this workflow is green, especially since there are probably quite a few tests that fail.\n\nSo except if you think that there is something fundamentally flawed with the current steps which result in the lcalc error, this should be ready for review.",
    "created_at": "2022-02-11T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493562",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@mkoeppe](#comment:55):
> This is the reason for the failure. There's no mystery there.

Could be. But the point of this ticket is to add the github action, so that one can fix these issues in follow-up tickets and have a direct verification. It might take quite some time until this workflow is green, especially since there are probably quite a few tests that fail.

So except if you think that there is something fundamentally flawed with the current steps which result in the lcalc error, this should be ready for review.



---

archive/issue_events_427525.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-11T20:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427525"
}
```



---

archive/issue_events_427526.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-11T20:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427526"
}
```



---

archive/issue_comments_493563.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@isuruf](#comment:56):\n> Do you get `lcalc>=2` with conda?\n\nNope, its installing lcalc 1.23 h0d16fac_1004 conda-forge. That's probably the reason why its not working.",
    "created_at": "2022-02-11T20:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493563",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@isuruf](#comment:56):
> Do you get `lcalc>=2` with conda?

Nope, its installing lcalc 1.23 h0d16fac_1004 conda-forge. That's probably the reason why its not working.



---

archive/issue_comments_493564.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nSo `build/pkgs/lcalc/distros/conda.txt` should be changed",
    "created_at": "2022-02-11T20:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493564",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:59" align="right">comment:59</div>

So `build/pkgs/lcalc/distros/conda.txt` should be changed



---

archive/issue_comments_493565.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@tobiasdiez](#comment:57):\n> the point of this ticket is to add the github action\n\nWell, it fails early, so we cannot see whether the later steps work.",
    "created_at": "2022-02-11T20:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493565",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@tobiasdiez](#comment:57):
> the point of this ticket is to add the github action

Well, it fails early, so we cannot see whether the later steps work.



---

archive/issue_comments_493566.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nReplying to [@mkoeppe](#comment:59):\n> So `build/pkgs/lcalc/distros/conda.txt` should be changed\n\nI don't think it will be that easy to solve:\n\n```\nmamba install lcalc=2.0.5 -n sage-dev\n > package libeantic-1.0.2-hf1f868f_1 requires antic >=0.2.4,<0.3.0a0, but none of the providers can be installed\n\nmamba install libeantic=1.1.0 -n sage-dev\n > package libeantic-1.1.0-h52e3b27_0 requires arb >=2.21.1,<2.22.0a0, but none of the providers can be installed\n\nmamba install arb=2.21.1 -n sage-dev\n > package e-antic-1.0.2-hf1f868f_0 requires arb >=2.19.0,<2.20.0a0, but none of the providers can be installed\n```\nI appears that there is a funny cyclic dependency thing going on.",
    "created_at": "2022-02-12T15:39:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493566",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:61" align="right">comment:61</div>

Replying to [@mkoeppe](#comment:59):
> So `build/pkgs/lcalc/distros/conda.txt` should be changed

I don't think it will be that easy to solve:

```
mamba install lcalc=2.0.5 -n sage-dev
 > package libeantic-1.0.2-hf1f868f_1 requires antic >=0.2.4,<0.3.0a0, but none of the providers can be installed

mamba install libeantic=1.1.0 -n sage-dev
 > package libeantic-1.1.0-h52e3b27_0 requires arb >=2.21.1,<2.22.0a0, but none of the providers can be installed

mamba install arb=2.21.1 -n sage-dev
 > package e-antic-1.0.2-hf1f868f_0 requires arb >=2.19.0,<2.20.0a0, but none of the providers can be installed
```
I appears that there is a funny cyclic dependency thing going on.



---

archive/issue_comments_493567.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nReplying to [@mkoeppe](#comment:60):\n> Replying to [@tobiasdiez](#comment:57):\n> > the point of this ticket is to add the github action\n\n> \n> Well, it fails early, so we cannot see whether the later steps work.\n\nShould I un-comment the last test step for now?",
    "created_at": "2022-02-12T15:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493567",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:62" align="right">comment:62</div>

Replying to [@mkoeppe](#comment:60):
> Replying to [@tobiasdiez](#comment:57):
> > the point of this ticket is to add the github action

> 
> Well, it fails early, so we cannot see whether the later steps work.

Should I un-comment the last test step for now?



---

archive/issue_comments_493568.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nTry switching from `src/environment-optional.yml` to `src/environment.yml`.\n`e_antic` is an optional package for Sage. Let's try without optional packages first.",
    "created_at": "2022-02-12T16:44:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493568",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:63" align="right">comment:63</div>

Try switching from `src/environment-optional.yml` to `src/environment.yml`.
`e_antic` is an optional package for Sage. Let's try without optional packages first.



---

archive/issue_comments_493569.json:
```json
{
    "body": "<div id=\"comment:64\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c\"><code>051b7b5</code></a></td><td><code>Don't use -optional env</code></td></tr></table>\n",
    "created_at": "2022-02-12T17:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493569",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:64"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c"><code>051b7b5</code></a></td><td><code>Don't use -optional env</code></td></tr></table>




---

archive/issue_comments_493570.json:
```json
{
    "body": "Changed commit from **[`b408f9e`](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)** to **[`051b7b5`](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)**",
    "created_at": "2022-02-12T17:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493570",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b408f9e`](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)** to **[`051b7b5`](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)**



---

archive/issue_comments_493571.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nThat should indeed work to get `loalc 2.0.5`. Good suggestion.\n\nFor the record: first installing `environment.yml` and then updating the env to `environment-optional.yml` yields the following downgrade of packgages:\n\n```\n  Downgrade:\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n  - arb                                               2.22.1  hbbd85db_0              installed\n  + arb                                               2.19.0  h7e34412_0              conda-forge/linux-64        7MB\n  - boost-cpp                                         1.77.0  h359cf19_1              installed\n  + boost-cpp                                         1.74.0  h312852a_4              conda-forge/linux-64     Cached\n  - cvxopt                                             1.2.7  py310h9fd565e_1         installed\n  + cvxopt                                             1.2.6  py38h55e5319_0          conda-forge/linux-64     Cached\n  - cysignals                                         1.11.2  py310h15010d2_0         installed\n  + cysignals                                         1.10.3  py38hd3cf888_0          conda-forge/linux-64     Cached\n  - eclib                                           20210625  h52f5ea4_4              installed\n  + eclib                                           20190909  h5b7fb09_3              conda-forge/linux-64       36MB\n  - gap-core                                          4.11.1  h1725ef4_2              installed\n  + gap-core                                          4.11.0  h1725ef4_7              conda-forge/linux-64       67MB\n  - gap-defaults                                      4.11.1  ha770c72_2              installed\n  + gap-defaults                                      4.11.0  ha770c72_7              conda-forge/linux-64       88MB\n  - gsl                                                  2.7  he838d99_0              installed\n  + gsl                                                  2.6  he838d99_2              conda-forge/linux-64     Cached\n  - harfbuzz                                           3.3.1  hb4a5f5f_0              installed\n  + harfbuzz                                           3.1.1  h83ec7ef_0              conda-forge/linux-64     Cached\n  - icu                                                 69.1  h9c3ff4c_0              installed\n  + icu                                                 68.2  h9c3ff4c_0              conda-forge/linux-64     Cached\n  - lcalc                                              2.0.5  h8cd7e2e_0              installed\n  + lcalc                                               1.23  h0d16fac_1004           conda-forge/linux-64     Cached\n  - libclang                                          13.0.1  default_hc23dcda_0      installed\n  + libclang                                          11.1.0  default_ha53f305_1      conda-forge/linux-64     Cached\n  - libflint                                           2.8.4  hd3cd37b_ntl_100        installed\n  + libflint                                           2.6.3  h6b702e8_0              conda-forge/linux-64       11MB\n  - libpq                                               14.2  hd57d9b9_0              installed\n  + libpq                                               13.5  hd57d9b9_1              conda-forge/linux-64     Cached\n  - libuv                                             1.43.0  h7f98852_0              installed\n  + libuv                                             1.42.0  h7f98852_0              conda-forge/linux-64     Cached\n  - pari                                              2.13.3  h82e6b41_1_pthread      installed\n  + pari                                              2.11.4  hddaffa3_2              conda-forge/linux-64     Cached\n  - python                                            3.10.2  h85951f9_3_cpython      installed\n  + python                                            3.8.12  ha38a3c6_3_cpython      conda-forge/linux-64     Cached\n  - python_abi                                          3.10  2_cp310                 installed\n  + python_abi                                           3.8  2_cp38                  conda-forge/linux-64     Cached\n  - r-base                                             4.1.2  hde4fec0_0              installed\n  + r-base                                             4.1.1  hb67fd72_0              conda-forge/linux-64     Cached\n  - singular                                        4.2.1.p3  haca423c_0              installed\n  + singular                                        4.1.1.p2  ha188dad_4              conda-forge/linux-64       22MB\n\n```",
    "created_at": "2022-02-12T17:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493571",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:65" align="right">comment:65</div>

That should indeed work to get `loalc 2.0.5`. Good suggestion.

For the record: first installing `environment.yml` and then updating the env to `environment-optional.yml` yields the following downgrade of packgages:

```
  Downgrade:
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

  - arb                                               2.22.1  hbbd85db_0              installed
  + arb                                               2.19.0  h7e34412_0              conda-forge/linux-64        7MB
  - boost-cpp                                         1.77.0  h359cf19_1              installed
  + boost-cpp                                         1.74.0  h312852a_4              conda-forge/linux-64     Cached
  - cvxopt                                             1.2.7  py310h9fd565e_1         installed
  + cvxopt                                             1.2.6  py38h55e5319_0          conda-forge/linux-64     Cached
  - cysignals                                         1.11.2  py310h15010d2_0         installed
  + cysignals                                         1.10.3  py38hd3cf888_0          conda-forge/linux-64     Cached
  - eclib                                           20210625  h52f5ea4_4              installed
  + eclib                                           20190909  h5b7fb09_3              conda-forge/linux-64       36MB
  - gap-core                                          4.11.1  h1725ef4_2              installed
  + gap-core                                          4.11.0  h1725ef4_7              conda-forge/linux-64       67MB
  - gap-defaults                                      4.11.1  ha770c72_2              installed
  + gap-defaults                                      4.11.0  ha770c72_7              conda-forge/linux-64       88MB
  - gsl                                                  2.7  he838d99_0              installed
  + gsl                                                  2.6  he838d99_2              conda-forge/linux-64     Cached
  - harfbuzz                                           3.3.1  hb4a5f5f_0              installed
  + harfbuzz                                           3.1.1  h83ec7ef_0              conda-forge/linux-64     Cached
  - icu                                                 69.1  h9c3ff4c_0              installed
  + icu                                                 68.2  h9c3ff4c_0              conda-forge/linux-64     Cached
  - lcalc                                              2.0.5  h8cd7e2e_0              installed
  + lcalc                                               1.23  h0d16fac_1004           conda-forge/linux-64     Cached
  - libclang                                          13.0.1  default_hc23dcda_0      installed
  + libclang                                          11.1.0  default_ha53f305_1      conda-forge/linux-64     Cached
  - libflint                                           2.8.4  hd3cd37b_ntl_100        installed
  + libflint                                           2.6.3  h6b702e8_0              conda-forge/linux-64       11MB
  - libpq                                               14.2  hd57d9b9_0              installed
  + libpq                                               13.5  hd57d9b9_1              conda-forge/linux-64     Cached
  - libuv                                             1.43.0  h7f98852_0              installed
  + libuv                                             1.42.0  h7f98852_0              conda-forge/linux-64     Cached
  - pari                                              2.13.3  h82e6b41_1_pthread      installed
  + pari                                              2.11.4  hddaffa3_2              conda-forge/linux-64     Cached
  - python                                            3.10.2  h85951f9_3_cpython      installed
  + python                                            3.8.12  ha38a3c6_3_cpython      conda-forge/linux-64     Cached
  - python_abi                                          3.10  2_cp310                 installed
  + python_abi                                           3.8  2_cp38                  conda-forge/linux-64     Cached
  - r-base                                             4.1.2  hde4fec0_0              installed
  + r-base                                             4.1.1  hb67fd72_0              conda-forge/linux-64     Cached
  - singular                                        4.2.1.p3  haca423c_0              installed
  + singular                                        4.1.1.p2  ha188dad_4              conda-forge/linux-64       22MB

```



---

archive/issue_comments_493572.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nThere must be some outdated pins / version constraints in the conda-forge packaging. Likely related to the fact that the Sage distribution has fallen behind upstream regarding `e_antic`/`normaliz` (see #31588).",
    "created_at": "2022-02-12T18:07:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493572",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:66" align="right">comment:66</div>

There must be some outdated pins / version constraints in the conda-forge packaging. Likely related to the fact that the Sage distribution has fallen behind upstream regarding `e_antic`/`normaliz` (see #31588).



---

archive/issue_comments_493573.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\n@isuruf, I think Sage works fine with current upstream versions of normaliz/pynormaliz that use the `e_antic` 1.x series, so it should be safe to remove such constraints. (We just can't yet update within the Sage distribution because of portability bugs in `e_antic`, see #31588.)",
    "created_at": "2022-02-12T18:11:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493573",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:67" align="right">comment:67</div>

@isuruf, I think Sage works fine with current upstream versions of normaliz/pynormaliz that use the `e_antic` 1.x series, so it should be safe to remove such constraints. (We just can't yet update within the Sage distribution because of portability bugs in `e_antic`, see #31588.)



---

archive/issue_comments_493574.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@mkoeppe](#comment:59):\n> So `build/pkgs/lcalc/distros/conda.txt` should be changed\n\n... to say `\"lcalc >=2\"`",
    "created_at": "2022-02-12T18:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493574",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@mkoeppe](#comment:59):
> So `build/pkgs/lcalc/distros/conda.txt` should be changed

... to say `"lcalc >=2"`



---

archive/issue_comments_493575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n The build of sage currently fails with the following issues:\n-- rpy2 is not installed in the conda env\n+- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n \n ```\n``````\n",
    "created_at": "2022-02-12T18:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493575",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
 The build of sage currently fails with the following issues:
-- rpy2 is not installed in the conda env
+- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
 
 ```
``````




---

archive/issue_comments_493576.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nRegarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier\n\nLet's also keep the instructions in https://wiki.sagemath.org/Conda updated.",
    "created_at": "2022-02-12T18:23:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493576",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:70" align="right">comment:70</div>

Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier

Let's also keep the instructions in https://wiki.sagemath.org/Conda updated.



---

archive/issue_comments_493577.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nOh, and `configure --with-system-lcalc=force` too...",
    "created_at": "2022-02-12T18:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493577",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">comment:71</div>

Oh, and `configure --with-system-lcalc=force` too...



---

archive/issue_comments_493578.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n ```\n is used uninitialized in this function\n-- lcalc is not recognized although installed in conda\n+- environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n building 'sage.libs.lcalc.lcalc_Lfunction' extension\n@@ -23,6 +23,6 @@\n           |          ^~~~~~~~~~~\n     compilation terminated.\n ```\n-- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n+- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-12T18:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493578",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
 ```
 is used uninitialized in this function
-- lcalc is not recognized although installed in conda
+- environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
 building 'sage.libs.lcalc.lcalc_Lfunction' extension
@@ -23,6 +23,6 @@
           |          ^~~~~~~~~~~
     compilation terminated.
 ```
-- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
+- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
 Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_493579.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@mkoeppe](#comment:70):\n> Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier\n> \n> Let's also keep the instructions in https://wiki.sagemath.org/Conda updated. \n\nWith the basic env, its now also using `pari 2.13.3`.\n\nI guess some of the optional packages is lagging behind a bit and still requiring some older version of some package. This then leads to these various downgrades of arb, ecl, pari, lcalc etc",
    "created_at": "2022-02-12T18:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493579",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@mkoeppe](#comment:70):
> Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier
> 
> Let's also keep the instructions in https://wiki.sagemath.org/Conda updated. 

With the basic env, its now also using `pari 2.13.3`.

I guess some of the optional packages is lagging behind a bit and still requiring some older version of some package. This then leads to these various downgrades of arb, ecl, pari, lcalc etc



---

archive/issue_comments_493580.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nYes, and we are missing many of the version constraints that are in https://github.com/conda-forge/sage-feedstock/blob/master/recipe/meta.yaml",
    "created_at": "2022-02-12T18:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493580",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:75" align="right">comment:75</div>

Yes, and we are missing many of the version constraints that are in https://github.com/conda-forge/sage-feedstock/blob/master/recipe/meta.yaml



---

archive/issue_comments_493581.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nMany of these should be added to the `conda.txt` files, so that they will be included in our `src/environment*.yml`.",
    "created_at": "2022-02-12T18:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493581",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:76" align="right">comment:76</div>

Many of these should be added to the `conda.txt` files, so that they will be included in our `src/environment*.yml`.



---

archive/issue_comments_493582.json:
```json
{
    "body": "Changed commit from **[`051b7b5`](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)** to **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)**",
    "created_at": "2022-02-12T18:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493582",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`051b7b5`](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)** to **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)**



---

archive/issue_comments_493583.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3\"><code>bd65274</code></a></td><td><code>Fix test command</code></td></tr></table>\n",
    "created_at": "2022-02-12T18:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493583",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3"><code>bd65274</code></a></td><td><code>Fix test command</code></td></tr></table>




---

archive/issue_comments_493584.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nOkay, after using `environment.yml` the build now succeeds. The tests fail almost immediately at the import of `sage.all`, because `primecountpy` is not installed in the conda env (it is also in neither `environment` file).\n\nI propose to get this ticket in and then work on the improvements to fix the various issues.",
    "created_at": "2022-02-12T20:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493584",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:78" align="right">comment:78</div>

Okay, after using `environment.yml` the build now succeeds. The tests fail almost immediately at the import of `sage.all`, because `primecountpy` is not installed in the conda env (it is also in neither `environment` file).

I propose to get this ticket in and then work on the improvements to fix the various issues.



---

archive/issue_comments_493585.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,8 @@\n \n The build of sage currently fails with the following issues:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n+- primecountpy is not installed in the conda env because its not listed in `environment.yml`\n+- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n \n ```\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n``````\n",
    "created_at": "2022-02-12T20:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493585",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,8 @@
 
 The build of sage currently fails with the following issues:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
+- primecountpy is not installed in the conda env because its not listed in `environment.yml`
+- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
 
 ```
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
``````




---

archive/issue_comments_493586.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n-The build of sage currently fails with the following issues:\n+During the work on this issue the following issues have been detected:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n``````\n",
    "created_at": "2022-02-12T20:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493586",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
-The build of sage currently fails with the following issues:
+During the work on this issue the following issues have been detected:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
``````




---

archive/issue_comments_493587.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,12 +7,6 @@\n During the work on this issue the following issues have been detected:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n-- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n-\n-```\n-\tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n-```\n-is used uninitialized in this function\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n``````\n",
    "created_at": "2022-02-12T20:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493587",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,12 +7,6 @@
 During the work on this issue the following issues have been detected:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
-- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
-
-```
-	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
-```
-is used uninitialized in this function
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
``````




---

archive/issue_comments_493588.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nJust add `build/pkgs/primecountpy/distros/conda.txt`",
    "created_at": "2022-02-12T20:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493588",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:82" align="right">comment:82</div>

Just add `build/pkgs/primecountpy/distros/conda.txt`



---

archive/issue_comments_493589.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nAt the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.",
    "created_at": "2022-02-12T20:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493589",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:83" align="right">comment:83</div>

At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.



---

archive/issue_comments_493590.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\ncomment:70, [comment:71](#comment:71), [comment:76](#comment:76), [comment:82](#comment:82) are actionable",
    "created_at": "2022-02-12T20:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493590",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:84" align="right">comment:84</div>

comment:70, [comment:71](#comment:71), [comment:76](#comment:76), [comment:82](#comment:82) are actionable



---

archive/issue_comments_493591.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nAlso, the ticket description claims that it follows https://wiki.sagemath.org/Conda; but that uses `pip install -r src/requirements.txt`, which would install the missing `primecountpy` too.",
    "created_at": "2022-02-12T20:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493591",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:85" align="right">comment:85</div>

Also, the ticket description claims that it follows https://wiki.sagemath.org/Conda; but that uses `pip install -r src/requirements.txt`, which would install the missing `primecountpy` too.



---

archive/issue_comments_493592.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nIt's better to not use pip.",
    "created_at": "2022-02-12T20:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493592",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:86" align="right">comment:86</div>

It's better to not use pip.



---

archive/issue_comments_493593.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nReplying to [@mkoeppe](#comment:83):\n> At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.\n\nThat's sadly true, but follow-up tickets can easily depend on this ticket here to run the CI.",
    "created_at": "2022-02-12T20:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493593",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:87" align="right">comment:87</div>

Replying to [@mkoeppe](#comment:83):
> At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.

That's sadly true, but follow-up tickets can easily depend on this ticket here to run the CI.



---

archive/issue_comments_493594.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n During the work on this issue the following issues have been detected:\n+- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n+- Migrate documentation from wiki to developer docs\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n``````\n",
    "created_at": "2022-02-12T20:41:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493594",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
 During the work on this issue the following issues have been detected:
+- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
+- Migrate documentation from wiki to developer docs
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
``````




---

archive/issue_events_427527.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T20:46:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427527"
}
```



---

archive/issue_events_427528.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T20:46:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427528"
}
```



---

archive/issue_comments_493595.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@mkoeppe](#comment:71):\n> Oh, and `configure --with-system-lcalc=force` too...\n\nDo you really think we should add a `--with-system-xyz=force` for every system package?",
    "created_at": "2022-02-12T22:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493595",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@mkoeppe](#comment:71):
> Oh, and `configure --with-system-lcalc=force` too...

Do you really think we should add a `--with-system-xyz=force` for every system package?



---

archive/issue_comments_493596.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nI don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...",
    "created_at": "2022-02-12T22:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493596",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:91" align="right">comment:91</div>

I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...



---

archive/issue_comments_493597.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nOr generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`",
    "created_at": "2022-02-12T22:30:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493597",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:92" align="right">comment:92</div>

Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`



---

archive/issue_comments_493598.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nWhy do you need `--with-system-lcalc=force`?",
    "created_at": "2022-02-12T22:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493598",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:93" align="right">comment:93</div>

Why do you need `--with-system-lcalc=force`?



---

archive/issue_comments_493599.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nSo that it is an immediate error if the system package is not usable. Here we are testing the workflow that does not run `make` at all.",
    "created_at": "2022-02-12T22:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493599",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:94" align="right">comment:94</div>

So that it is an immediate error if the system package is not usable. Here we are testing the workflow that does not run `make` at all.



---

archive/issue_comments_493600.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nReplying to [@mkoeppe](#comment:92):\n> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\nBut doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.\n\nMoreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.",
    "created_at": "2022-02-12T23:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493600",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:95" align="right">comment:95</div>

Replying to [@mkoeppe](#comment:92):
> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.

Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.



---

archive/issue_comments_493601.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@tobiasdiez](#comment:95):\n> Replying to [@mkoeppe](#comment:92):\n> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n> \n> But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.\n\nYes, that's the idea. For packages that have an `spkg-configure.m4`, our configure script knows which versions work. It should fail early if there is something that cannot be accepted.",
    "created_at": "2022-02-13T00:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493601",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@tobiasdiez](#comment:95):
> Replying to [@mkoeppe](#comment:92):
> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

> 
> But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.

Yes, that's the idea. For packages that have an `spkg-configure.m4`, our configure script knows which versions work. It should fail early if there is something that cannot be accepted.



---

archive/issue_comments_493602.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nReplying to [@tobiasdiez](#comment:95):\n> Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\nThat is something that is best left to the downstream packagers.",
    "created_at": "2022-02-13T00:08:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493602",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:97" align="right">comment:97</div>

Replying to [@tobiasdiez](#comment:95):
> Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.

That is something that is best left to the downstream packagers.



---

archive/issue_comments_493603.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@tobiasdiez](#comment:95):\n> That currently happens with a lot of packages as you can see in the github workflow.\n\n`python3` is rejected because your script doesn't follow the instructions at https://wiki.sagemath.org/Conda - `--with-python=$CONDA_PREFIX/bin/python` is missing.",
    "created_at": "2022-02-13T00:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493603",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@tobiasdiez](#comment:95):
> That currently happens with a lot of packages as you can see in the github workflow.

`python3` is rejected because your script doesn't follow the instructions at https://wiki.sagemath.org/Conda - `--with-python=$CONDA_PREFIX/bin/python` is missing.



---

archive/issue_comments_493604.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nAnd many others fail because you use `--without-system-gcc`, which is a bad idea.",
    "created_at": "2022-02-13T00:13:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493604",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:99" align="right">comment:99</div>

And many others fail because you use `--without-system-gcc`, which is a bad idea.



---

archive/issue_comments_493605.json:
```json
{
    "body": "Changed commit from **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)** to **[`8a297af`](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)**",
    "created_at": "2022-02-13T09:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493605",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)** to **[`8a297af`](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)**



---

archive/issue_comments_493606.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4\"><code>8a297af</code></a></td><td><code>Remove without gcc, add with python</code></td></tr></table>\n",
    "created_at": "2022-02-13T09:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493606",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4"><code>8a297af</code></a></td><td><code>Remove without gcc, add with python</code></td></tr></table>




---

archive/issue_comments_493607.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nReplying to [@mkoeppe](#comment:99):\n> And many others fail because you use `--without-system-gcc`, which is a bad idea.\n\nOtherwise configure fails with\n\n```\n configure: error: \n\n    Given --with-system-gcc=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-gcc)\n```",
    "created_at": "2022-02-13T09:39:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493607",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:101" align="right">comment:101</div>

Replying to [@mkoeppe](#comment:99):
> And many others fail because you use `--without-system-gcc`, which is a bad idea.

Otherwise configure fails with

```
 configure: error: 

    Given --with-system-gcc=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-gcc)
```



---

archive/issue_comments_493608.json:
```json
{
    "body": "Changed commit from **[`8a297af`](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)** to **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)**",
    "created_at": "2022-02-13T09:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493608",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8a297af`](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)** to **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)**



---

archive/issue_comments_493609.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-02-13T09:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493609",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_493610.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@mkoeppe](#comment:97):\n> Replying to [@tobiasdiez](#comment:95):\n> > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\n> \n> That is something that is best left to the downstream packagers.\n> \n\nThe section has the title \"Conda for Sage Developers\" so downstream packagers are not involved here.",
    "created_at": "2022-02-13T09:45:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493610",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@mkoeppe](#comment:97):
> Replying to [@tobiasdiez](#comment:95):
> > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.

> 
> That is something that is best left to the downstream packagers.
> 

The section has the title "Conda for Sage Developers" so downstream packagers are not involved here.



---

archive/issue_events_427529.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-13T09:45:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427529"
}
```



---

archive/issue_events_427530.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-13T09:45:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427530"
}
```



---

archive/issue_comments_493611.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n During the work on this issue the following issues have been detected:\n - Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n - Migrate documentation from wiki to developer docs\n+- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n``````\n",
    "created_at": "2022-02-13T09:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493611",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 During the work on this issue the following issues have been detected:
 - Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
 - Migrate documentation from wiki to developer docs
+- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
``````




---

archive/issue_comments_493612.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nReplying to [@mkoeppe](#comment:82):\n> Just add `build/pkgs/primecountpy/distros/conda.txt`\n\nThis is now #33330.",
    "created_at": "2022-02-13T11:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493612",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:106" align="right">comment:106</div>

Replying to [@mkoeppe](#comment:82):
> Just add `build/pkgs/primecountpy/distros/conda.txt`

This is now #33330.



---

archive/issue_comments_493613.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n - Migrate documentation from wiki to developer docs\n - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n-- primecountpy is not installed in the conda env because its not listed in `environment.yml`\n+- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n``````\n",
    "created_at": "2022-02-13T11:18:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493613",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 - Migrate documentation from wiki to developer docs
 - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
-- primecountpy is not installed in the conda env because its not listed in `environment.yml`
+- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
``````




---

archive/issue_comments_493614.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI undestand that the GH run on #33330 uses this branch, so it looks good to me.",
    "created_at": "2022-02-13T12:31:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493614",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

I undestand that the GH run on #33330 uses this branch, so it looks good to me.



---

archive/issue_comments_493615.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe, Dima Pasechnik**",
    "created_at": "2022-02-13T12:31:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493615",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Matthias Koeppe, Dima Pasechnik**



---

archive/issue_events_427531.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T12:31:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427531"
}
```



---

archive/issue_events_427532.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T12:31:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427532"
}
```



---

archive/issue_comments_493616.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAlso here, thanks for the review.",
    "created_at": "2022-02-13T13:17:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493616",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:9" align="right">comment:9</div>

Also here, thanks for the review.



---

archive/issue_comments_493617.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nI've now created #33331 for the follow-up issues.",
    "created_at": "2022-02-13T13:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493617",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:0" align="right">comment:0</div>

I've now created #33331 for the follow-up issues.



---

archive/issue_comments_493618.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nReplying to [@tobiasdiez](#comment:103):\n> Replying to [@mkoeppe](#comment:97):\n> > Replying to [@tobiasdiez](#comment:95):\n> > > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\n> > \n> > That is something that is best left to the downstream packagers.\n\n> \n> The section has the title \"Conda for Sage Developers\" so downstream packagers are not involved here.\n\nExactly, so in other words we should not attempt to skip `configure`'s checks.",
    "created_at": "2022-02-13T16:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493618",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:111" align="right">comment:111</div>

Replying to [@tobiasdiez](#comment:103):
> Replying to [@mkoeppe](#comment:97):
> > Replying to [@tobiasdiez](#comment:95):
> > > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.

> > 
> > That is something that is best left to the downstream packagers.

> 
> The section has the title "Conda for Sage Developers" so downstream packagers are not involved here.

Exactly, so in other words we should not attempt to skip `configure`'s checks.



---

archive/issue_comments_493619.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@tobiasdiez](#comment:101):\n> Replying to [@mkoeppe](#comment:99):\n> > And many others fail because you use `--without-system-gcc`, which is a bad idea.\n\n> \n> Otherwise configure fails with\n> \n> ```\n>  configure: error: \n> \n>     Given --with-system-gcc=force, but no system package could be used.\n>     That's an error.  Please install the indicated package to continue.\n>     (To override this error, use ./configure --without-system-gcc)\n> ```\n\nWhy does it reject gcc?",
    "created_at": "2022-02-13T16:09:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493619",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@tobiasdiez](#comment:101):
> Replying to [@mkoeppe](#comment:99):
> > And many others fail because you use `--without-system-gcc`, which is a bad idea.

> 
> Otherwise configure fails with
> 
> ```
>  configure: error: 
> 
>     Given --with-system-gcc=force, but no system package could be used.
>     That's an error.  Please install the indicated package to continue.
>     (To override this error, use ./configure --without-system-gcc)
> ```

Why does it reject gcc?



---

archive/issue_comments_493620.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\ncomment:98 still unaddressed",
    "created_at": "2022-02-13T16:14:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493620",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

comment:98 still unaddressed



---

archive/issue_comments_493621.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nReplying to [@mkoeppe](#comment:113):\n> comment:98 still unaddressed\n\nIt is addressed in [comment:100](#comment:100) (commit \u200b8a297af), no?",
    "created_at": "2022-02-13T21:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493621",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:114" align="right">comment:114</div>

Replying to [@mkoeppe](#comment:113):
> comment:98 still unaddressed

It is addressed in [comment:100](#comment:100) (commit ​8a297af), no?



---

archive/issue_comments_493622.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThat commit is not on the current branch",
    "created_at": "2022-02-13T21:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493622",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

That commit is not on the current branch



---

archive/issue_comments_493623.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYes, I had to revert that commit since the workflow didn't passed. https://github.com/sagemath/sagetrac-mirror/actions/runs/1836383017\n\nThat conda's python is rejected is #31539. And since sage is not invoking python during the workflow run, it also shouldn't matter if its rejected or not.",
    "created_at": "2022-02-13T21:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493623",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:6" align="right">comment:6</div>

Yes, I had to revert that commit since the workflow didn't passed. https://github.com/sagemath/sagetrac-mirror/actions/runs/1836383017

That conda's python is rejected is #31539. And since sage is not invoking python during the workflow run, it also shouldn't matter if its rejected or not.



---

archive/issue_comments_493624.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThat failure was from `gcc`, not python. So why back out the fix for python?",
    "created_at": "2022-02-13T21:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493624",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

That failure was from `gcc`, not python. So why back out the fix for python?



---

archive/issue_comments_493625.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">comment:118</div>\n\nReplying to [@tobiasdiez](#comment:116):\n> since sage is not invoking python during the workflow run\n\nHm?",
    "created_at": "2022-02-13T21:48:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493625",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:118" align="right">comment:118</div>

Replying to [@tobiasdiez](#comment:116):
> since sage is not invoking python during the workflow run

Hm?



---

archive/issue_comments_493626.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nReplying to [@mkoeppe](#comment:117):\n> That failure was from `gcc`, not python. So why back out the fix for python?\n\nSince it is working without this \"fix\".",
    "created_at": "2022-02-13T21:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493626",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:119" align="right">comment:119</div>

Replying to [@mkoeppe](#comment:117):
> That failure was from `gcc`, not python. So why back out the fix for python?

Since it is working without this "fix".



---

archive/issue_comments_493627.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nAlso, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?\n\nRight now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log",
    "created_at": "2022-02-13T21:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493627",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">comment:0</div>

Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?

Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log



---

archive/issue_comments_493628.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nReplying to [@tobiasdiez](#comment:119):\n> Replying to [@mkoeppe](#comment:117):\n> > That failure was from `gcc`, not python. So why back out the fix for python?\n\n> \n> Since it is working without this \"fix\".\n\nBut what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.",
    "created_at": "2022-02-13T21:58:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493628",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:121" align="right">comment:121</div>

Replying to [@tobiasdiez](#comment:119):
> Replying to [@mkoeppe](#comment:117):
> > That failure was from `gcc`, not python. So why back out the fix for python?

> 
> Since it is working without this "fix".

But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.



---

archive/issue_events_427533.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-14T10:45:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427533"
}
```



---

archive/issue_events_427534.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-14T10:45:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427534"
}
```



---

archive/issue_comments_493629.json:
```json
{
    "body": "Changed commit from **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)** to **[`7b76d0b`](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)**",
    "created_at": "2022-02-14T12:56:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493629",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bd65274`](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)** to **[`7b76d0b`](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)**



---

archive/issue_comments_493630.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e49a2e341674a35115eeff683944e4bc926e128\"><code>3e49a2e</code></a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1423cdfdfb4d950228a6bb3c35d8037ebb5a571\"><code>c1423cd</code></a></td><td><code>Force python</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71\"><code>7b76d0b</code></a></td><td><code>Print logs</code></td></tr></table>\n",
    "created_at": "2022-02-14T12:56:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493630",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e49a2e341674a35115eeff683944e4bc926e128"><code>3e49a2e</code></a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1423cdfdfb4d950228a6bb3c35d8037ebb5a571"><code>c1423cd</code></a></td><td><code>Force python</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71"><code>7b76d0b</code></a></td><td><code>Print logs</code></td></tr></table>




---

archive/issue_comments_493631.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\nReplying to [@mkoeppe](#comment:120):\n> Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?\n> \n> Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log\n\nDone.",
    "created_at": "2022-02-14T12:57:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493631",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:124" align="right">comment:124</div>

Replying to [@mkoeppe](#comment:120):
> Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?
> 
> Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log

Done.



---

archive/issue_comments_493632.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">comment:125</div>\n\nReplying to [@mkoeppe](#comment:121):\n> Replying to [@tobiasdiez](#comment:119):\n> > Replying to [@mkoeppe](#comment:117):\n> > > That failure was from `gcc`, not python. So why back out the fix for python?\n\n> > \n> > Since it is working without this \"fix\".\n\n> \n> But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\nI still don't understand why it's so important that sage's configure script accepts conda's python, but I've added the explicit `--with-python` argument.",
    "created_at": "2022-02-14T12:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493632",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:125" align="right">comment:125</div>

Replying to [@mkoeppe](#comment:121):
> Replying to [@tobiasdiez](#comment:119):
> > Replying to [@mkoeppe](#comment:117):
> > > That failure was from `gcc`, not python. So why back out the fix for python?

> > 
> > Since it is working without this "fix".

> 
> But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.

I still don't understand why it's so important that sage's configure script accepts conda's python, but I've added the explicit `--with-python` argument.



---

archive/issue_comments_493633.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> I still don't understand why it's so important that sage's configure script accepts conda's python\n\nHow else would you expect to be using Conda's Python packages in Sage, if you used another Python?",
    "created_at": "2022-02-14T13:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493633",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

> I still don't understand why it's so important that sage's configure script accepts conda's python

How else would you expect to be using Conda's Python packages in Sage, if you used another Python?



---

archive/issue_comments_493634.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe workflow is completely bypassing the make-scripts of sage. So using Conda's python packages follows the 'usual' strategy:\n- Create (virtual) python environment (done by conda)\n- Install other python packages (done by conda)\n- Install sagelib into the same environment (done via pip install)\n\nSo sage is not managing the python installation nor the python environment. It is simply a normal python package that gets installed in an existing environment. In this context, it is pretty non-standard to pose more requirements at the python installation then a simple version requirement (which is checked by pip). Ideally, you wouldn't even want to call configure, a simple `pip install -e src` should be enough (and that's for example the workflow numpy and scipy are using), but that's of course currently not possible.",
    "created_at": "2022-02-14T14:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493634",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:7" align="right">comment:7</div>

The workflow is completely bypassing the make-scripts of sage. So using Conda's python packages follows the 'usual' strategy:
- Create (virtual) python environment (done by conda)
- Install other python packages (done by conda)
- Install sagelib into the same environment (done via pip install)

So sage is not managing the python installation nor the python environment. It is simply a normal python package that gets installed in an existing environment. In this context, it is pretty non-standard to pose more requirements at the python installation then a simple version requirement (which is checked by pip). Ideally, you wouldn't even want to call configure, a simple `pip install -e src` should be enough (and that's for example the workflow numpy and scipy are using), but that's of course currently not possible.



---

archive/issue_comments_493635.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.\nPassing wrong parameters to `./configure` is not a good idea, IMHO.",
    "created_at": "2022-02-14T16:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493635",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.
Passing wrong parameters to `./configure` is not a good idea, IMHO.



---

archive/issue_comments_493636.json:
```json
{
    "body": "<div id=\"comment:129\" align=\"right\">comment:129</div>\n\nReplying to [@tobiasdiez](#comment:125):\n> > > Since it is working without this \"fix\".\n\n> > \n> > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\n> \n> I still don't understand why it's so important that sage's configure script accepts conda's python\n\nAs I said before in [comment:70](#comment:70), [comment:92](#comment:92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.",
    "created_at": "2022-02-14T17:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493636",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:129" align="right">comment:129</div>

Replying to [@tobiasdiez](#comment:125):
> > > Since it is working without this "fix".

> > 
> > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.

> 
> I still don't understand why it's so important that sage's configure script accepts conda's python

As I said before in [comment:70](#comment:70), [comment:92](#comment:92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.



---

archive/issue_comments_493637.json:
```json
{
    "body": "Replying to [ticket:30845 mkoeppe]:\n> - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n\nFor example, this one about `ecl-config` is the result of the misconfiguration. The configure script does not accept system ecl because of the misconfiguration `--without-system-gcc`. So the configuration reflects use of an ECL built using SPKG (which is not done because `make` is not involved).",
    "created_at": "2022-02-14T17:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493637",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [ticket:30845 mkoeppe]:
> - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)

For example, this one about `ecl-config` is the result of the misconfiguration. The configure script does not accept system ecl because of the misconfiguration `--without-system-gcc`. So the configuration reflects use of an ECL built using SPKG (which is not done because `make` is not involved).



---

archive/issue_comments_493638.json:
```json
{
    "body": "<div id=\"comment:131\" align=\"right\">comment:131</div>\n\nReplying to [@dimpase](#comment:128):\n> OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.\n> Passing wrong parameters to `./configure` is not a good idea, IMHO.\n\nSure, I agree with this!",
    "created_at": "2022-02-14T17:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493638",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:131" align="right">comment:131</div>

Replying to [@dimpase](#comment:128):
> OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.
> Passing wrong parameters to `./configure` is not a good idea, IMHO.

Sure, I agree with this!



---

archive/issue_comments_493639.json:
```json
{
    "body": "<div id=\"comment:132\" align=\"right\">comment:132</div>\n\nReplying to [@mkoeppe](#comment:129):\n> Replying to [@tobiasdiez](#comment:125):\n> > > > Since it is working without this \"fix\".\n\n> > > \n> > > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\n> > \n> > I still don't understand why it's so important that sage's configure script accepts conda's python\n\n> \n> As I said before in [comment:70](#comment:70), [comment:92](#comment:92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\nNot sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. But regardless, adding these force statements doesn't currently work.",
    "created_at": "2022-02-14T17:53:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493639",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:132" align="right">comment:132</div>

Replying to [@mkoeppe](#comment:129):
> Replying to [@tobiasdiez](#comment:125):
> > > > Since it is working without this "fix".

> > > 
> > > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.

> > 
> > I still don't understand why it's so important that sage's configure script accepts conda's python

> 
> As I said before in [comment:70](#comment:70), [comment:92](#comment:92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.

Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. But regardless, adding these force statements doesn't currently work.



---

archive/issue_comments_493640.json:
```json
{
    "body": "<div id=\"comment:133\" align=\"right\">comment:133</div>\n\nReplying to [@tobiasdiez](#comment:132):\n> adding these force statements doesn't currently work.\n\nYou reported that `--with-system-gcc=force` does not work; what else does not work?",
    "created_at": "2022-02-14T17:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493640",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:133" align="right">comment:133</div>

Replying to [@tobiasdiez](#comment:132):
> adding these force statements doesn't currently work.

You reported that `--with-system-gcc=force` does not work; what else does not work?



---

archive/issue_comments_493641.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">comment:134</div>\n\nReplying to [@mkoeppe](#comment:133):\n> Replying to [@tobiasdiez](#comment:132):\n> > adding these force statements doesn't currently work.\n\n> \n> You reported that `--with-system-gcc=force` does not work\n\n... and we can fix it if you show us the config.log",
    "created_at": "2022-02-14T18:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493641",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:134" align="right">comment:134</div>

Replying to [@mkoeppe](#comment:133):
> Replying to [@tobiasdiez](#comment:132):
> > adding these force statements doesn't currently work.

> 
> You reported that `--with-system-gcc=force` does not work

... and we can fix it if you show us the config.log



---

archive/issue_comments_493642.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI didn't check the force argument, but ecl, arb, ntl, ppl are not recognized.",
    "created_at": "2022-02-14T18:03:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493642",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:5" align="right">comment:5</div>

I didn't check the force argument, but ecl, arb, ntl, ppl are not recognized.



---

archive/issue_comments_493643.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nyes, because of the misconfigured gcc (I just explained it in [comment:130](#comment:130))",
    "created_at": "2022-02-14T18:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493643",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

yes, because of the misconfigured gcc (I just explained it in [comment:130](#comment:130))



---

archive/issue_comments_493644.json:
```json
{
    "body": "<div id=\"comment:137\" align=\"right\">comment:137</div>\n\nReplying to [@tobiasdiez](#comment:132):\n> > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\n> \n> Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. \n\nBoth.",
    "created_at": "2022-02-14T18:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493644",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:137" align="right">comment:137</div>

Replying to [@tobiasdiez](#comment:132):
> > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.

> 
> Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. 

Both.



---

archive/issue_comments_493645.json:
```json
{
    "body": "Changed commit from **[`7b76d0b`](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)** to **[`9af27b5`](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)**",
    "created_at": "2022-02-14T18:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493645",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7b76d0b`](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)** to **[`9af27b5`](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)**



---

archive/issue_comments_493646.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473\"><code>9af27b5</code></a></td><td><code>Fix log output</code></td></tr></table>\n",
    "created_at": "2022-02-14T18:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493646",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473"><code>9af27b5</code></a></td><td><code>Fix log output</code></td></tr></table>




---

archive/issue_comments_493647.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559\"><code>5940d76</code></a></td><td><code>Try again with system gcc</code></td></tr></table>\n",
    "created_at": "2022-02-14T19:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493647",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559"><code>5940d76</code></a></td><td><code>Try again with system gcc</code></td></tr></table>




---

archive/issue_comments_493648.json:
```json
{
    "body": "Changed commit from **[`9af27b5`](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)** to **[`5940d76`](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)**",
    "created_at": "2022-02-14T19:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493648",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9af27b5`](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)** to **[`5940d76`](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)**



---

archive/issue_comments_493649.json:
```json
{
    "body": "<div id=\"comment:140\" align=\"right\">comment:140</div>\n\nReplying to [@mkoeppe](#comment:137):\n> Replying to [@tobiasdiez](#comment:132):\n> > > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\n> > \n> > Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. \n\n> \n> Both. \n\nWhat's the point of the force except that the workflow fails early? Wouldn't it make more sense to let it run through and see what error it produces?",
    "created_at": "2022-02-14T19:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493649",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:140" align="right">comment:140</div>

Replying to [@mkoeppe](#comment:137):
> Replying to [@tobiasdiez](#comment:132):
> > > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.

> > 
> > Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. 

> 
> Both. 

What's the point of the force except that the workflow fails early? Wouldn't it make more sense to let it run through and see what error it produces?



---

archive/issue_comments_493650.json:
```json
{
    "body": "<div id=\"comment:141\" align=\"right\">comment:141</div>\n\nReplying to [@tobiasdiez](#comment:140):\n> What's the point of the force except that the workflow fails early? \n\nFailing early is good. \n\n> Wouldn't it make more sense to let it run through and see what error it produces?\n\nNo, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.",
    "created_at": "2022-02-14T19:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493650",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:141" align="right">comment:141</div>

Replying to [@tobiasdiez](#comment:140):
> What's the point of the force except that the workflow fails early? 

Failing early is good. 

> Wouldn't it make more sense to let it run through and see what error it produces?

No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.



---

archive/issue_comments_493651.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">comment:142</div>\n\nReplying to [@sagetrac-git](#comment:139):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559\"><code>5940d76</code></a></td><td><code>Try again with system gcc</code></td></tr></table>\n\nLocally this fails, output can be found at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true in a bit.\n\nIt accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place). Nothing of this is specific to the github action and can easily be investigated after creating a conda env locally.\n\nBut can we do this error analysis and corresponding improvements please in a follow-up ticket? The version using prefix works with almost no test failures (apart from giac, which is broken and has already a ticket). Moreover, in this ticket, I tried to codify the instructions of the wiki in a github workflow. The instructions didn't work for me verbatim in a fresh clone, nor via the github action. The current version works relatively well in my eyes. I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.",
    "created_at": "2022-02-14T19:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493651",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:142" align="right">comment:142</div>

Replying to [@sagetrac-git](#comment:139):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559"><code>5940d76</code></a></td><td><code>Try again with system gcc</code></td></tr></table>

Locally this fails, output can be found at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true in a bit.

It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place). Nothing of this is specific to the github action and can easily be investigated after creating a conda env locally.

But can we do this error analysis and corresponding improvements please in a follow-up ticket? The version using prefix works with almost no test failures (apart from giac, which is broken and has already a ticket). Moreover, in this ticket, I tried to codify the instructions of the wiki in a github workflow. The instructions didn't work for me verbatim in a fresh clone, nor via the github action. The current version works relatively well in my eyes. I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.



---

archive/issue_comments_493652.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nReplying to [@mkoeppe](#comment:141):\n> Replying to [@tobiasdiez](#comment:140):\n> > What's the point of the force except that the workflow fails early? \n\n> \n> Failing early is good. \n> \n> > Wouldn't it make more sense to let it run through and see what error it produces?\n\n> \n> No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.\n> \n\nWhat about adding a warning annotation in the github workflow when a system package is not recognized? Then you still get the information that the config didn't work as expected but keep the benefit of seeing error messages. This should become helpful down the road, as the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.",
    "created_at": "2022-02-14T19:57:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493652",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:143" align="right">comment:143</div>

Replying to [@mkoeppe](#comment:141):
> Replying to [@tobiasdiez](#comment:140):
> > What's the point of the force except that the workflow fails early? 

> 
> Failing early is good. 
> 
> > Wouldn't it make more sense to let it run through and see what error it produces?

> 
> No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.
> 

What about adding a warning annotation in the github workflow when a system package is not recognized? Then you still get the information that the config didn't work as expected but keep the benefit of seeing error messages. This should become helpful down the road, as the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.



---

archive/issue_comments_493653.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\ncomment:121 - the workflow should be testing something that we can recommend to developers. As of the current branch it's \"let's misconfigure creatively so that configure does not end with an error; please ignore everything that the configure script says because it does not matter. There may be errors in build and run later, YMMV.\"",
    "created_at": "2022-02-14T19:58:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493653",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

comment:121 - the workflow should be testing something that we can recommend to developers. As of the current branch it's "let's misconfigure creatively so that configure does not end with an error; please ignore everything that the configure script says because it does not matter. There may be errors in build and run later, YMMV."



---

archive/issue_comments_493654.json:
```json
{
    "body": "<div id=\"comment:145\" align=\"right\">comment:145</div>\n\nReplying to [@tobiasdiez](#comment:142):\n> I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.\n\nI've already offered to fix the problem with `--with-system-gcc=force`",
    "created_at": "2022-02-14T20:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493654",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:145" align="right">comment:145</div>

Replying to [@tobiasdiez](#comment:142):
> I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.

I've already offered to fix the problem with `--with-system-gcc=force`



---

archive/issue_comments_493655.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">comment:146</div>\n\nReplying to [@tobiasdiez](#comment:142):\n> It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\nThese reports would be more useful if you attach the config.log",
    "created_at": "2022-02-14T20:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493655",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:146" align="right">comment:146</div>

Replying to [@tobiasdiez](#comment:142):
> It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).

These reports would be more useful if you attach the config.log



---

archive/issue_comments_493656.json:
```json
{
    "body": "<div id=\"comment:147\" align=\"right\">comment:147</div>\n\nReplying to [@mkoeppe](#comment:145):\n> Replying to [@tobiasdiez](#comment:142):\n> > I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.\n\n> \n> I've already offered to fix the problem with `--with-system-gcc=force`\n\nCan you please give the full commands that create a working conda env and are able to recognize gcc and ecl. As you can see here `with-system-gcc` doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true",
    "created_at": "2022-02-14T20:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493656",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:147" align="right">comment:147</div>

Replying to [@mkoeppe](#comment:145):
> Replying to [@tobiasdiez](#comment:142):
> > I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.

> 
> I've already offered to fix the problem with `--with-system-gcc=force`

Can you please give the full commands that create a working conda env and are able to recognize gcc and ecl. As you can see here `with-system-gcc` doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true



---

archive/issue_comments_493657.json:
```json
{
    "body": "<div id=\"comment:148\" align=\"right\">comment:148</div>\n\nReplying to [@mkoeppe](#comment:146):\n> Replying to [@tobiasdiez](#comment:142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\n> \n> These reports would be more useful if you attach the config.log\n> \n\n((Yes, it's available now at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true)",
    "created_at": "2022-02-14T20:10:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493657",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:148" align="right">comment:148</div>

Replying to [@mkoeppe](#comment:146):
> Replying to [@tobiasdiez](#comment:142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).

> 
> These reports would be more useful if you attach the config.log
> 

((Yes, it's available now at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true)



---

archive/issue_comments_493658.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">comment:149</div>\n\nAttachment: **[config.log](https://github.com/sagemath/sage/files/ticket30845/config.log)**\n\nReplying to [@mkoeppe](#comment:146):\n> Replying to [@tobiasdiez](#comment:142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\n> \n> These reports would be more useful if you attach the config.log\n> \n\nNow attached to the ticket.",
    "created_at": "2022-02-14T20:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493658",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:149" align="right">comment:149</div>

Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket30845/config.log)**

Replying to [@mkoeppe](#comment:146):
> Replying to [@tobiasdiez](#comment:142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).

> 
> These reports would be more useful if you attach the config.log
> 

Now attached to the ticket.



---

archive/issue_comments_493659.json:
```json
{
    "body": "<div id=\"comment:150\" align=\"right\">comment:150</div>\n\nReplying to [@mkoeppe](#comment:146):\n> Replying to [@tobiasdiez](#comment:142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part.\n\nOK, here's why it does not accept it when the (questionable, but perhaps currently necessary) option `--prefix=$CONDA_PREFIX` is given:\n`build/pkgs/gcc/spkg-configure.m4` has these lines:\n\n```\n    if test -f \"$SAGE_LOCAL/bin/gcc\"; then\n        # Special value for SAGE_INSTALL_GCC if GCC is already installed\n        SAGE_INSTALL_GCC=exists\n        # Set yes since this implies we have already installed GCC and want to keep\n        # it selected\n        sage_spkg_install_gcc=yes\n\n        # Check whether it actually works...\n        # See https://trac.sagemath.org/ticket/24599\n        SAGE_CHECK_BROKEN_GCC()\n[...]\n```",
    "created_at": "2022-02-14T20:23:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493659",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:150" align="right">comment:150</div>

Replying to [@mkoeppe](#comment:146):
> Replying to [@tobiasdiez](#comment:142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part.

OK, here's why it does not accept it when the (questionable, but perhaps currently necessary) option `--prefix=$CONDA_PREFIX` is given:
`build/pkgs/gcc/spkg-configure.m4` has these lines:

```
    if test -f "$SAGE_LOCAL/bin/gcc"; then
        # Special value for SAGE_INSTALL_GCC if GCC is already installed
        SAGE_INSTALL_GCC=exists
        # Set yes since this implies we have already installed GCC and want to keep
        # it selected
        sage_spkg_install_gcc=yes

        # Check whether it actually works...
        # See https://trac.sagemath.org/ticket/24599
        SAGE_CHECK_BROKEN_GCC()
[...]
```



---

archive/issue_comments_493660.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI'll work on a fix for this later today.",
    "created_at": "2022-02-14T20:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493660",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

I'll work on a fix for this later today.



---

archive/issue_comments_493661.json:
```json
{
    "body": "<div id=\"comment:152\" align=\"right\">comment:152</div>\n\nReplying to [@tobiasdiez](#comment:149):\n> Replying to [@mkoeppe](#comment:146):\n> > These reports would be more useful if you attach the config.log\n\n> \n> Now attached to the ticket.\n\nThanks. From config.log:\n\n```\n## --------------------------------------------------- ##\n## Checking whether SageMath should install SPKG gc... ##\n## --------------------------------------------------- ##\nconfigure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG\nconfigure:19437: result: no\nconfigure:19440: checking whether we run on WSL\nconfigure:19444: result: yes; disabling using of system gc\nconfigure:19693: no suitable system package found for SPKG gc\n```\nThis is why `ecl` and `homfly` are not used.",
    "created_at": "2022-02-14T20:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493661",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:152" align="right">comment:152</div>

Replying to [@tobiasdiez](#comment:149):
> Replying to [@mkoeppe](#comment:146):
> > These reports would be more useful if you attach the config.log

> 
> Now attached to the ticket.

Thanks. From config.log:

```
## --------------------------------------------------- ##
## Checking whether SageMath should install SPKG gc... ##
## --------------------------------------------------- ##
configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG
configure:19437: result: no
configure:19440: checking whether we run on WSL
configure:19444: result: yes; disabling using of system gc
configure:19693: no suitable system package found for SPKG gc
```
This is why `ecl` and `homfly` are not used.



---

archive/issue_comments_493662.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n`ecl` is rejected because `gc` is rejected on WSL, see #30629: Reject system libgc that breaks ECL build on WSL\n\nThis rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)",
    "created_at": "2022-02-14T20:29:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493662",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

`ecl` is rejected because `gc` is rejected on WSL, see #30629: Reject system libgc that breaks ECL build on WSL

This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)



---

archive/issue_comments_493663.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">comment:154</div>\n\nReplying to [@dimpase](#comment:153):\n> This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)\n\nThis one is pretty subtle. `gc` is used by both ECL and libhomfly. So only if BOTH can be used from the system, then we do not need to build `gc` itself.",
    "created_at": "2022-02-14T20:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493663",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:154" align="right">comment:154</div>

Replying to [@dimpase](#comment:153):
> This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)

This one is pretty subtle. `gc` is used by both ECL and libhomfly. So only if BOTH can be used from the system, then we do not need to build `gc` itself.



---

archive/issue_comments_493664.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nActually, Jammy already has fixed `gc`.\nhttps://launchpad.net/ubuntu/+source/libgc\nhttps://bugs.launchpad.net/ubuntu/+source/libgc/+bug/1897371/comments/1",
    "created_at": "2022-02-14T20:39:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493664",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Actually, Jammy already has fixed `gc`.
https://launchpad.net/ubuntu/+source/libgc
https://bugs.launchpad.net/ubuntu/+source/libgc/+bug/1897371/comments/1



---

archive/issue_comments_493665.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSo we need an improved test",
    "created_at": "2022-02-14T20:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493665",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

So we need an improved test



---

archive/issue_comments_493666.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nis it `gc`  from Conda (it should be OK, right?)",
    "created_at": "2022-02-14T20:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493666",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

is it `gc`  from Conda (it should be OK, right?)



---

archive/issue_comments_493667.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">comment:158</div>\n\nReplying to [@dimpase](#comment:157):\n> is it `gc`  from Conda (it should be OK, right?)\n\nYes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17",
    "created_at": "2022-02-14T20:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493667",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:158" align="right">comment:158</div>

Replying to [@dimpase](#comment:157):
> is it `gc`  from Conda (it should be OK, right?)

Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17



---

archive/issue_comments_493668.json:
```json
{
    "body": "Changed commit from **[`5940d76`](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)** to **[`970b01e`](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)**",
    "created_at": "2022-02-14T21:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493668",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5940d76`](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)** to **[`970b01e`](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)**



---

archive/issue_comments_493669.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c\"><code>970b01e</code></a></td><td><code>Remove conda prefx</code></td></tr></table>\n",
    "created_at": "2022-02-14T21:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493669",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c"><code>970b01e</code></a></td><td><code>Remove conda prefx</code></td></tr></table>




---

archive/issue_comments_493670.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nConda's gc would only be too old if it were built with a particular option.\n\nThey probably use it to build ecl, and it won't fly if it was broken!",
    "created_at": "2022-02-14T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493670",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">comment:0</div>

Conda's gc would only be too old if it were built with a particular option.

They probably use it to build ecl, and it won't fly if it was broken!



---

archive/issue_comments_493671.json:
```json
{
    "body": "Changed commit from **[`970b01e`](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)** to **[`9799fd7`](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)**",
    "created_at": "2022-02-14T21:07:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493671",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`970b01e`](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)** to **[`9799fd7`](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)**



---

archive/issue_comments_493672.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a\"><code>9799fd7</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr></table>\n",
    "created_at": "2022-02-14T21:07:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493672",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a"><code>9799fd7</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr></table>




---

archive/issue_comments_493673.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHere's an attempt, not really tested yet",
    "created_at": "2022-02-14T21:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493673",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Here's an attempt, not really tested yet



---

archive/issue_comments_493674.json:
```json
{
    "body": "Changed commit from **[`9799fd7`](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)** to **[`757bd73`](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)**",
    "created_at": "2022-02-14T23:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493674",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9799fd7`](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)** to **[`757bd73`](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)**



---

archive/issue_comments_493675.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcf3dde352aa6d53d3143f796d4702c11475bda0\"><code>dcf3dde</code></a></td><td><code>Revert \"Remove conda prefx\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5\"><code>757bd73</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr></table>\n",
    "created_at": "2022-02-14T23:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493675",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcf3dde352aa6d53d3143f796d4702c11475bda0"><code>dcf3dde</code></a></td><td><code>Revert "Remove conda prefx"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5"><code>757bd73</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr></table>




---

archive/issue_comments_493676.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nTested locally with `EXTRA_CONFIGURE_ARGS=--prefix=/opt/conda tox -e docker-conda-forge-standard -- config.status`",
    "created_at": "2022-02-14T23:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493676",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Tested locally with `EXTRA_CONFIGURE_ARGS=--prefix=/opt/conda tox -e docker-conda-forge-standard -- config.status`



---

archive/issue_comments_493677.json:
```json
{
    "body": "<div id=\"comment:165\" align=\"right\">comment:165</div>\n\nReplying to [@mkoeppe](#comment:91):\n> I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...\n\nNow I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.",
    "created_at": "2022-02-15T01:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493677",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:165" align="right">comment:165</div>

Replying to [@mkoeppe](#comment:91):
> I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...

Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.



---

archive/issue_comments_493678.json:
```json
{
    "body": "Dependencies: **#33330, #33345**",
    "created_at": "2022-02-15T01:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493678",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#33330, #33345**



---

archive/issue_comments_493679.json:
```json
{
    "body": "Changed commit from **[`757bd73`](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)** to **[`b4f76aa`](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)**",
    "created_at": "2022-02-15T02:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493679",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`757bd73`](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)** to **[`b4f76aa`](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)**



---

archive/issue_comments_493680.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919\"><code>613198a</code></a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/566664d7a3e1994af407ab8b20cdf210a35bf8d8\"><code>566664d</code></a></td><td><code>Merge #33330</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dda3c48bf82ccfcbc3b7b5e3a1cee5c27b9aaca6\"><code>dda3c48</code></a></td><td><code>configure --with-system-standard-packages: New option</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc8aaa38981cb2d71f894b7b5ee5aab1341630a0\"><code>bc8aaa3</code></a></td><td><code>Merge #33345</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7\"><code>b4f76aa</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>\n",
    "created_at": "2022-02-15T02:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493680",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919"><code>613198a</code></a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/566664d7a3e1994af407ab8b20cdf210a35bf8d8"><code>566664d</code></a></td><td><code>Merge #33330</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dda3c48bf82ccfcbc3b7b5e3a1cee5c27b9aaca6"><code>dda3c48</code></a></td><td><code>configure --with-system-standard-packages: New option</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc8aaa38981cb2d71f894b7b5ee5aab1341630a0"><code>bc8aaa3</code></a></td><td><code>Merge #33345</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7"><code>b4f76aa</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>




---

archive/issue_comments_493681.json:
```json
{
    "body": "Changed commit from **[`b4f76aa`](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)** to **[`a9812f3`](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)**",
    "created_at": "2022-02-15T04:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493681",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b4f76aa`](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)** to **[`a9812f3`](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)**



---

archive/issue_comments_493682.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bbaf448bad39f543ccf06860fa72c457a0d65fd\"><code>3bbaf44</code></a></td><td><code>bootstrap: Only use SPKG_USE_SYSTEM_STANDARD_PACKAGES for packages with spkg-configure.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2998104fad3cc2b16f19b7a85e4e0d84144741b1\"><code>2998104</code></a></td><td><code>Merge #33345</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc\"><code>a9812f3</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>\n",
    "created_at": "2022-02-15T04:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493682",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bbaf448bad39f543ccf06860fa72c457a0d65fd"><code>3bbaf44</code></a></td><td><code>bootstrap: Only use SPKG_USE_SYSTEM_STANDARD_PACKAGES for packages with spkg-configure.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2998104fad3cc2b16f19b7a85e4e0d84144741b1"><code>2998104</code></a></td><td><code>Merge #33345</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc"><code>a9812f3</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>




---

archive/issue_comments_493683.json:
```json
{
    "body": "<div id=\"comment:168\" align=\"right\">comment:168</div>\n\nReplying to [@mkoeppe](#comment:152):\n> Replying to [@tobiasdiez](#comment:149):\n> > Replying to [@mkoeppe](#comment:146):\n> > > These reports would be more useful if you attach the config.log\n\n> > \n> > Now attached to the ticket.\n\n> \n> Thanks. From config.log:\n> \n> ```\n> ## --------------------------------------------------- ##\n> ## Checking whether SageMath should install SPKG gc... ##\n> ## --------------------------------------------------- ##\n> configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG\n> configure:19437: result: no\n> configure:19440: checking whether we run on WSL\n> configure:19444: result: yes; disabling using of system gc\n> configure:19693: no suitable system package found for SPKG gc\n> ```\n> This is why `ecl` and `homfly` are not used.\n\nThat makes sense. Sorry, should have investigated this before deviating from the instructions outlined in the wiki. Thanks for your patience and investigation.",
    "created_at": "2022-02-15T12:15:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493683",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:168" align="right">comment:168</div>

Replying to [@mkoeppe](#comment:152):
> Replying to [@tobiasdiez](#comment:149):
> > Replying to [@mkoeppe](#comment:146):
> > > These reports would be more useful if you attach the config.log

> > 
> > Now attached to the ticket.

> 
> Thanks. From config.log:
> 
> ```
> ## --------------------------------------------------- ##
> ## Checking whether SageMath should install SPKG gc... ##
> ## --------------------------------------------------- ##
> configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG
> configure:19437: result: no
> configure:19440: checking whether we run on WSL
> configure:19444: result: yes; disabling using of system gc
> configure:19693: no suitable system package found for SPKG gc
> ```
> This is why `ecl` and `homfly` are not used.

That makes sense. Sorry, should have investigated this before deviating from the instructions outlined in the wiki. Thanks for your patience and investigation.



---

archive/issue_comments_493684.json:
```json
{
    "body": "<div id=\"comment:169\" align=\"right\">comment:169</div>\n\nReplying to [@mkoeppe](#comment:165):\n> Replying to [@mkoeppe](#comment:91):\n> > I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...\n\n> \n> Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.\n\n[#30845 comment:143](https://github.com/sagemath/sage/issues/30845#comment:143) ?",
    "created_at": "2022-02-15T12:16:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493684",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:169" align="right">comment:169</div>

Replying to [@mkoeppe](#comment:165):
> Replying to [@mkoeppe](#comment:91):
> > I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...

> 
> Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.

[#30845 comment:143](https://github.com/sagemath/sage/issues/30845#comment:143) ?



---

archive/issue_comments_493685.json:
```json
{
    "body": "<div id=\"comment:170\" align=\"right\">comment:170</div>\n\nReplying to [@tobiasdiez](#comment:158):\n> Replying to [@dimpase](#comment:157):\n> > is it `gc`  from Conda (it should be OK, right?)\n\n> \n> Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17\n\nUpstream says one has to check that\n\n```\nstrings /usr/lib/x86_64-linux-gnu/libgc.so | grep \"Wrong __data_start/_end pair\"\n``` \ndoes not find anything. But this rules out all 8.0.4 (and possibly earlier) installations of libgc, not only broken ones.",
    "created_at": "2022-02-15T12:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493685",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:170" align="right">comment:170</div>

Replying to [@tobiasdiez](#comment:158):
> Replying to [@dimpase](#comment:157):
> > is it `gc`  from Conda (it should be OK, right?)

> 
> Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17

Upstream says one has to check that

```
strings /usr/lib/x86_64-linux-gnu/libgc.so | grep "Wrong __data_start/_end pair"
``` 
does not find anything. But this rules out all 8.0.4 (and possibly earlier) installations of libgc, not only broken ones.



---

archive/issue_comments_493686.json:
```json
{
    "body": "<div id=\"comment:171\" align=\"right\">comment:171</div>\n\nReplying to [@tobiasdiez](#comment:143):\n> What about adding a warning annotation in the github workflow when a system package is not recognized? \n\nWe don't have a mechanism for that, see discussion in #29499.",
    "created_at": "2022-02-15T15:55:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493686",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:171" align="right">comment:171</div>

Replying to [@tobiasdiez](#comment:143):
> What about adding a warning annotation in the github workflow when a system package is not recognized? 

We don't have a mechanism for that, see discussion in #29499.



---

archive/issue_comments_493687.json:
```json
{
    "body": "<div id=\"comment:172\" align=\"right\">comment:172</div>\n\nReplying to [@tobiasdiez](#comment:143):\n> the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\nThat's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo",
    "created_at": "2022-02-15T15:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493687",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:172" align="right">comment:172</div>

Replying to [@tobiasdiez](#comment:143):
> the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.

That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo



---

archive/issue_comments_493688.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHow about adding another job (via matrix) that uses `src/environment-optional.yml`?",
    "created_at": "2022-02-15T16:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493688",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

How about adding another job (via matrix) that uses `src/environment-optional.yml`?



---

archive/issue_comments_493689.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAlso, adding jobs that test other python versions could probably be useful",
    "created_at": "2022-02-15T16:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493689",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Also, adding jobs that test other python versions could probably be useful



---

archive/issue_comments_493690.json:
```json
{
    "body": "<div id=\"comment:175\" align=\"right\">comment:175</div>\n\nReplying to [@mkoeppe](#comment:171):\n> Replying to [@tobiasdiez](#comment:143):\n> > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> \n> We don't have a mechanism for that, see discussion in #29499.\n\nOne could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.",
    "created_at": "2022-02-15T16:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493690",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:175" align="right">comment:175</div>

Replying to [@mkoeppe](#comment:171):
> Replying to [@tobiasdiez](#comment:143):
> > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> 
> We don't have a mechanism for that, see discussion in #29499.

One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.



---

archive/issue_comments_493691.json:
```json
{
    "body": "<div id=\"comment:176\" align=\"right\">comment:176</div>\n\nReplying to [@mkoeppe](#comment:173):\n> How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\nProbably wait with this until this workflow here passes without errors. There is not much of an advantage in having 5 different matrix flows fail.",
    "created_at": "2022-02-15T16:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493691",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:176" align="right">comment:176</div>

Replying to [@mkoeppe](#comment:173):
> How about adding another job (via matrix) that uses `src/environment-optional.yml`?

Probably wait with this until this workflow here passes without errors. There is not much of an advantage in having 5 different matrix flows fail.



---

archive/issue_comments_493692.json:
```json
{
    "body": "<div id=\"comment:177\" align=\"right\">comment:177</div>\n\nReplying to [@mkoeppe](#comment:172):\n> Replying to [@tobiasdiez](#comment:143):\n> > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\n> \n> That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo\n\nBut in this case the workflow does not simply fail because the package is not accepted, right?",
    "created_at": "2022-02-15T16:52:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493692",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:177" align="right">comment:177</div>

Replying to [@mkoeppe](#comment:172):
> Replying to [@tobiasdiez](#comment:143):
> > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.

> 
> That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo

But in this case the workflow does not simply fail because the package is not accepted, right?



---

archive/issue_comments_493693.json:
```json
{
    "body": "<div id=\"comment:178\" align=\"right\">comment:178</div>\n\nReplying to [@tobiasdiez](#comment:175):\n> Replying to [@mkoeppe](#comment:171):\n> > Replying to [@tobiasdiez](#comment:143):\n> > > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> > \n> > We don't have a mechanism for that, see discussion in #29499.\n\n> \n> One could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.\n\nNo, the problem is that the configuration variables need to be set for the accepted system packages. [#29499 comment:3](https://github.com/sagemath/sage/issues/29499#comment:3)",
    "created_at": "2022-02-15T17:04:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493693",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:178" align="right">comment:178</div>

Replying to [@tobiasdiez](#comment:175):
> Replying to [@mkoeppe](#comment:171):
> > Replying to [@tobiasdiez](#comment:143):
> > > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> > 
> > We don't have a mechanism for that, see discussion in #29499.

> 
> One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.

No, the problem is that the configuration variables need to be set for the accepted system packages. [#29499 comment:3](https://github.com/sagemath/sage/issues/29499#comment:3)



---

archive/issue_comments_493694.json:
```json
{
    "body": "<div id=\"comment:179\" align=\"right\">comment:179</div>\n\nReplying to [@tobiasdiez](#comment:176):\n> Replying to [@mkoeppe](#comment:173):\n> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> \n> Probably wait with this until this workflow here passes without errors. \n\nJust reduce the errors in the `ptest` to warnings. This would be in line with the entire portability test suite.",
    "created_at": "2022-02-15T17:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493694",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:179" align="right">comment:179</div>

Replying to [@tobiasdiez](#comment:176):
> Replying to [@mkoeppe](#comment:173):
> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> 
> Probably wait with this until this workflow here passes without errors. 

Just reduce the errors in the `ptest` to warnings. This would be in line with the entire portability test suite.



---

archive/issue_comments_493695.json:
```json
{
    "body": "<div id=\"comment:180\" align=\"right\">comment:180</div>\n\nReplying to [@tobiasdiez](#comment:177):\n> Replying to [@mkoeppe](#comment:172):\n> > Replying to [@tobiasdiez](#comment:143):\n> > > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\n> > \n> > That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo\n\n> \n> But in this case the workflow does not simply fail because the package is not accepted, right?\n\nThat's right, Sage will just build the SPKG.",
    "created_at": "2022-02-15T17:20:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493695",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:180" align="right">comment:180</div>

Replying to [@tobiasdiez](#comment:177):
> Replying to [@mkoeppe](#comment:172):
> > Replying to [@tobiasdiez](#comment:143):
> > > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.

> > 
> > That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo

> 
> But in this case the workflow does not simply fail because the package is not accepted, right?

That's right, Sage will just build the SPKG.



---

archive/issue_comments_493696.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWhen a Sage user/developer follows our (to-be-updated) instructions with `--with-system-standard-packages=force` and it gives the configure error regarding the unsuitable system package, there is a clear recourse: Find and install a version that works.\n\nWhen Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in `conda.txt` files if possible; or file a conda bug report. \n\nSeeing error messages from using a system package that `configure` knows to reject does not help. It only leads to developers engaging in unproductive guesswork. \n\nFor updating Sage and our `spkg-configure.m4` scripts to work with new versions, local development and testing on many platforms is necessary anyway; it does not help if there's 1 platform that already speculatively displays some errors.",
    "created_at": "2022-02-15T17:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493696",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

When a Sage user/developer follows our (to-be-updated) instructions with `--with-system-standard-packages=force` and it gives the configure error regarding the unsuitable system package, there is a clear recourse: Find and install a version that works.

When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in `conda.txt` files if possible; or file a conda bug report. 

Seeing error messages from using a system package that `configure` knows to reject does not help. It only leads to developers engaging in unproductive guesswork. 

For updating Sage and our `spkg-configure.m4` scripts to work with new versions, local development and testing on many platforms is necessary anyway; it does not help if there's 1 platform that already speculatively displays some errors.



---

archive/issue_comments_493697.json:
```json
{
    "body": "<div id=\"comment:182\" align=\"right\">comment:182</div>\n\nReplying to [@mkoeppe](#comment:178):\n> Replying to [@tobiasdiez](#comment:175):\n> > Replying to [@mkoeppe](#comment:171):\n> > > Replying to [@tobiasdiez](#comment:143):\n> > > > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> > > \n> > > We don't have a mechanism for that, see discussion in #29499.\n\n> > \n> > One could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.\n\n> \n> No, the problem is that the configuration variables need to be set for the accepted system packages. [#29499 comment:3](https://github.com/sagemath/sage/issues/29499#comment:3)\n> \n\nI meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview.",
    "created_at": "2022-02-15T17:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493697",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:182" align="right">comment:182</div>

Replying to [@mkoeppe](#comment:178):
> Replying to [@tobiasdiez](#comment:175):
> > Replying to [@mkoeppe](#comment:171):
> > > Replying to [@tobiasdiez](#comment:143):
> > > > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> > > 
> > > We don't have a mechanism for that, see discussion in #29499.

> > 
> > One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.

> 
> No, the problem is that the configuration variables need to be set for the accepted system packages. [#29499 comment:3](https://github.com/sagemath/sage/issues/29499#comment:3)
> 

I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview.



---

archive/issue_comments_493698.json:
```json
{
    "body": "<div id=\"comment:183\" align=\"right\">comment:183</div>\n\nReplying to [@tobiasdiez](#comment:182):\n> I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\nSure, +1 on that, that's a good idea.",
    "created_at": "2022-02-15T17:32:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493698",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:183" align="right">comment:183</div>

Replying to [@tobiasdiez](#comment:182):
> I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 

Sure, +1 on that, that's a good idea.



---

archive/issue_comments_493699.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI have some of this in tox.yml, matching configure warnings and error",
    "created_at": "2022-02-15T17:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493699",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

I have some of this in tox.yml, matching configure warnings and error



---

archive/issue_comments_493700.json:
```json
{
    "body": "Changed commit from **[`a9812f3`](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)** to **[`6ff193f`](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)**",
    "created_at": "2022-02-15T18:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493700",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a9812f3`](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)** to **[`6ff193f`](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)**



---

archive/issue_comments_493701.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec\"><code>c1c9e61</code></a></td><td><code>Add matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf\"><code>6ff193f</code></a></td><td><code>Add problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-15T18:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493701",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec"><code>c1c9e61</code></a></td><td><code>Add matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf"><code>6ff193f</code></a></td><td><code>Add problem matcher</code></td></tr></table>




---

archive/issue_comments_493702.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b\"><code>3a25ddb</code></a></td><td><code>Fix path to problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-15T20:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493702",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b"><code>3a25ddb</code></a></td><td><code>Fix path to problem matcher</code></td></tr></table>




---

archive/issue_comments_493703.json:
```json
{
    "body": "Changed commit from **[`6ff193f`](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)** to **[`3a25ddb`](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)**",
    "created_at": "2022-02-15T20:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493703",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6ff193f`](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)** to **[`3a25ddb`](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)**



---

archive/issue_comments_493704.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b\"><code>a3fd48c</code></a></td><td><code>Improve problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-16T11:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493704",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b"><code>a3fd48c</code></a></td><td><code>Improve problem matcher</code></td></tr></table>




---

archive/issue_comments_493705.json:
```json
{
    "body": "Changed commit from **[`3a25ddb`](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)** to **[`a3fd48c`](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)**",
    "created_at": "2022-02-16T11:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493705",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3a25ddb`](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)** to **[`a3fd48c`](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)**



---

archive/issue_comments_493706.json:
```json
{
    "body": "<div id=\"comment:188\" align=\"right\">comment:188</div>\n\nReplying to [@mkoeppe](#comment:183):\n> Replying to [@tobiasdiez](#comment:182):\n> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\n> \n> Sure, +1 on that, that's a good idea.\n\nOkay, this is now implemented. See https://github.com/sagemath/sagetrac-mirror/actions/runs/1852417654",
    "created_at": "2022-02-16T12:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493706",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:188" align="right">comment:188</div>

Replying to [@mkoeppe](#comment:183):
> Replying to [@tobiasdiez](#comment:182):
> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 

> 
> Sure, +1 on that, that's a good idea.

Okay, this is now implemented. See https://github.com/sagemath/sagetrac-mirror/actions/runs/1852417654



---

archive/issue_comments_493707.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe tests now fail with the following error:\n\n```\n************************************************************************\nIt seems that you are attempting to run Sage from an unpacked source\ntarball, but you have not compiled it yet (or maybe the build has not\nfinished). You should run `make` in the Sage root directory first.\nIf you did not intend to build Sage from source, you should download\na binary tarball instead. Read README.txt for more information.\n************************************************************************\n```\nIs this a consequence of me merging the latest develop branch, or did I accidentally misconfigured something?\nHow can one overwrite this check?",
    "created_at": "2022-02-16T12:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493707",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:9" align="right">comment:9</div>

The tests now fail with the following error:

```
************************************************************************
It seems that you are attempting to run Sage from an unpacked source
tarball, but you have not compiled it yet (or maybe the build has not
finished). You should run `make` in the Sage root directory first.
If you did not intend to build Sage from source, you should download
a binary tarball instead. Read README.txt for more information.
************************************************************************
```
Is this a consequence of me merging the latest develop branch, or did I accidentally misconfigured something?
How can one overwrite this check?



---

archive/issue_comments_493708.json:
```json
{
    "body": "Changed dependencies from **#33330, #33345** to none",
    "created_at": "2022-02-16T12:34:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493708",
    "user": "https://github.com/tobiasdiez"
}
```

Changed dependencies from **#33330, #33345** to none



---

archive/issue_comments_493709.json:
```json
{
    "body": "<div id=\"comment:191\" align=\"right\">comment:191</div>\n\nReplying to [@mkoeppe](#comment:173):\n> How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\nDone, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9",
    "created_at": "2022-02-16T12:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493709",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:191" align="right">comment:191</div>

Replying to [@mkoeppe](#comment:173):
> How about adding another job (via matrix) that uses `src/environment-optional.yml`?

Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9



---

archive/issue_comments_493710.json:
```json
{
    "body": "<div id=\"comment:192\" align=\"right\">comment:192</div>\n\nReplying to [@sagetrac-git](#comment:185):\n> Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec\"><code>c1c9e61</code></a></td><td><code>Add matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf\"><code>6ff193f</code></a></td><td><code>Add problem matcher</code></td></tr></table>\n\nThis nuked my changes, intended?",
    "created_at": "2022-02-16T16:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493710",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:192" align="right">comment:192</div>

Replying to [@sagetrac-git](#comment:185):
> Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec"><code>c1c9e61</code></a></td><td><code>Add matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf"><code>6ff193f</code></a></td><td><code>Add problem matcher</code></td></tr></table>

This nuked my changes, intended?



---

archive/issue_comments_493711.json:
```json
{
    "body": "<div id=\"comment:193\" align=\"right\">comment:193</div>\n\nReplying to [@tobiasdiez](#comment:190):\n> Dependencies #33330, #33345 deleted\n\n?",
    "created_at": "2022-02-16T16:53:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493711",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:193" align="right">comment:193</div>

Replying to [@tobiasdiez](#comment:190):
> Dependencies #33330, #33345 deleted

?



---

archive/issue_comments_493712.json:
```json
{
    "body": "<div id=\"comment:194\" align=\"right\">comment:194</div>\n\nReplying to [@mkoeppe](#comment:193):\n> Replying to [@tobiasdiez](#comment:190):\n> > Dependencies #33330, #33345 deleted\n\n> \n> ?\n\nNo longer needed.",
    "created_at": "2022-02-16T17:31:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493712",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:194" align="right">comment:194</div>

Replying to [@mkoeppe](#comment:193):
> Replying to [@tobiasdiez](#comment:190):
> > Dependencies #33330, #33345 deleted

> 
> ?

No longer needed.



---

archive/issue_comments_493713.json:
```json
{
    "body": "<div id=\"comment:195\" align=\"right\">comment:195</div>\n\nReplying to [@tobiasdiez](#comment:191):\n> Replying to [@mkoeppe](#comment:173):\n> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> \n> Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\nShould be fixed with #33358",
    "created_at": "2022-02-16T17:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493713",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:195" align="right">comment:195</div>

Replying to [@tobiasdiez](#comment:191):
> Replying to [@mkoeppe](#comment:173):
> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> 
> Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9

Should be fixed with #33358



---

archive/issue_comments_493714.json:
```json
{
    "body": "<div id=\"comment:196\" align=\"right\">comment:196</div>\n\nReplying to [@mkoeppe](#comment:183):\n> Replying to [@tobiasdiez](#comment:182):\n> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\n> \n> Sure, +1 on that, that's a good idea.\n\nWait, I missed that you said \"run configure without `-with-system = force`\".\n\nI was +1 on adding the problem matchers.",
    "created_at": "2022-02-16T17:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493714",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:196" align="right">comment:196</div>

Replying to [@mkoeppe](#comment:183):
> Replying to [@tobiasdiez](#comment:182):
> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 

> 
> Sure, +1 on that, that's a good idea.

Wait, I missed that you said "run configure without `-with-system = force`".

I was +1 on adding the problem matchers.



---

archive/issue_comments_493715.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIn [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.",
    "created_at": "2022-02-16T17:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493715",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

In [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.



---

archive/issue_events_427535.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T17:39:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427535"
}
```



---

archive/issue_events_427536.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T17:39:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427536"
}
```



---

archive/issue_comments_493716.json:
```json
{
    "body": "<div id=\"comment:199\" align=\"right\">comment:199</div>\n\nReplying to [@mkoeppe](#comment:197):\n> In [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.\n\n> When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. \n\nThis is still accomplished with the current problem matchers, and even easier. Developer looks at the workflow run, sees that system packages are not accepted and can take action. In addition, she can directly see what errors result from not accepting the system package.\n\nI don't see any advantage in hiding useful information (what does break because of the missing package).",
    "created_at": "2022-02-16T17:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493716",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:199" align="right">comment:199</div>

Replying to [@mkoeppe](#comment:197):
> In [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.

> When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. 

This is still accomplished with the current problem matchers, and even easier. Developer looks at the workflow run, sees that system packages are not accepted and can take action. In addition, she can directly see what errors result from not accepting the system package.

I don't see any advantage in hiding useful information (what does break because of the missing package).



---

archive/issue_comments_493717.json:
```json
{
    "body": "<div id=\"comment:200\" align=\"right\">comment:200</div>\n\nReplying to [@isuruf](#comment:195):\n> Replying to [@tobiasdiez](#comment:191):\n> > Replying to [@mkoeppe](#comment:173):\n> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> > \n> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\n> \n> Should be fixed with #33358\n\nThanks!",
    "created_at": "2022-02-16T17:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493717",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:200" align="right">comment:200</div>

Replying to [@isuruf](#comment:195):
> Replying to [@tobiasdiez](#comment:191):
> > Replying to [@mkoeppe](#comment:173):
> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> > 
> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9

> 
> Should be fixed with #33358

Thanks!



---

archive/issue_comments_493718.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAny idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?",
    "created_at": "2022-02-16T17:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493718",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:1" align="right">comment:1</div>

Any idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?



---

archive/issue_comments_493719.json:
```json
{
    "body": "<div id=\"comment:202\" align=\"right\">comment:202</div>\n\nReplying to [@tobiasdiez](#comment:199):\n> I don't see any advantage in hiding useful information\n\nI've already explained that it's not useful for those who know how to update our configure tests.",
    "created_at": "2022-02-16T18:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493719",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:202" align="right">comment:202</div>

Replying to [@tobiasdiez](#comment:199):
> I don't see any advantage in hiding useful information

I've already explained that it's not useful for those who know how to update our configure tests.



---

archive/issue_comments_493720.json:
```json
{
    "body": "<div id=\"comment:203\" align=\"right\">comment:203</div>\n\nReplying to [@tobiasdiez](#comment:201):\n> Any idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?\n\nYes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.",
    "created_at": "2022-02-16T18:04:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493720",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:203" align="right">comment:203</div>

Replying to [@tobiasdiez](#comment:201):
> Any idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?

Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.



---

archive/issue_comments_493721.json:
```json
{
    "body": "<div id=\"comment:204\" align=\"right\">comment:204</div>\n\nReplying to [@tobiasdiez](#comment:199):\n> Replying to [@mkoeppe](#comment:197):\n> > In [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.\n\n> \n> > When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. \n\n> \n> This is still accomplished with the current problem matchers, and even easier. \n\nBut it misses the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.",
    "created_at": "2022-02-16T18:07:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493721",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:204" align="right">comment:204</div>

Replying to [@tobiasdiez](#comment:199):
> Replying to [@mkoeppe](#comment:197):
> > In [comment:181](#comment:181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.

> 
> > When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. 

> 
> This is still accomplished with the current problem matchers, and even easier. 

But it misses the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.



---

archive/issue_comments_493722.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAlso [comment:178](#comment:178).",
    "created_at": "2022-02-16T18:24:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493722",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Also [comment:178](#comment:178).



---

archive/issue_comments_493723.json:
```json
{
    "body": "<div id=\"comment:206\" align=\"right\">comment:206</div>\n\nReplying to [@mkoeppe](#comment:203):\n> Replying to [@tobiasdiez](#comment:201):\n> > Any idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?\n\n> \n> Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.\n\nAnd how does one fix it without using prefix (which according to you isn't desired)?",
    "created_at": "2022-02-16T18:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493723",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:206" align="right">comment:206</div>

Replying to [@mkoeppe](#comment:203):
> Replying to [@tobiasdiez](#comment:201):
> > Any idea on how to fix [#30845 comment:189](https://github.com/sagemath/sage/issues/30845#comment:189)?

> 
> Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.

And how does one fix it without using prefix (which according to you isn't desired)?



---

archive/issue_comments_493724.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFor now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.",
    "created_at": "2022-02-16T18:33:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493724",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.



---

archive/issue_comments_493725.json:
```json
{
    "body": "Changed commit from **[`a3fd48c`](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)** to **[`8426d2d`](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)**",
    "created_at": "2022-02-16T18:49:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493725",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a3fd48c`](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)** to **[`8426d2d`](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)**



---

archive/issue_comments_493726.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76660199b8496a45b96c9783515d6de0a868506e\"><code>7666019</code></a></td><td><code>Back to using prefix for now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a0f3194d19df7342fc7f7f3558277dbb79bf8d5\"><code>8a0f319</code></a></td><td><code>Fix for rename of conda e-antic package to libeantic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8a7b0f0e33ae8c39e8fe45b138c0b50dcba392a\"><code>c8a7b0f</code></a></td><td><code>Merge remote-tracking branch 'trac/u/isuruf/eantic' into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919\"><code>613198a</code></a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851\"><code>8426d2d</code></a></td><td><code>Merge remote-tracking branch 'trac/public/build/conda-addpackages-runci' into public/build/conda-runci</code></td></tr></table>\n",
    "created_at": "2022-02-16T18:49:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493726",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76660199b8496a45b96c9783515d6de0a868506e"><code>7666019</code></a></td><td><code>Back to using prefix for now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a0f3194d19df7342fc7f7f3558277dbb79bf8d5"><code>8a0f319</code></a></td><td><code>Fix for rename of conda e-antic package to libeantic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8a7b0f0e33ae8c39e8fe45b138c0b50dcba392a"><code>c8a7b0f</code></a></td><td><code>Merge remote-tracking branch 'trac/u/isuruf/eantic' into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919"><code>613198a</code></a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851"><code>8426d2d</code></a></td><td><code>Merge remote-tracking branch 'trac/public/build/conda-addpackages-runci' into public/build/conda-runci</code></td></tr></table>




---

archive/issue_comments_493727.json:
```json
{
    "body": "Dependencies: **#33358, #33330**",
    "created_at": "2022-02-16T18:50:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493727",
    "user": "https://github.com/tobiasdiez"
}
```

Dependencies: **#33358, #33330**



---

archive/issue_comments_493728.json:
```json
{
    "body": "<div id=\"comment:210\" align=\"right\">comment:210</div>\n\nReplying to [@isuruf](#comment:195):\n> Replying to [@tobiasdiez](#comment:191):\n> > Replying to [@mkoeppe](#comment:173):\n> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> > \n> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\n> \n> Should be fixed with #33358\n\nIt is indeed correctly using lcalc 2 now. Thanks!",
    "created_at": "2022-02-16T19:34:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493728",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:210" align="right">comment:210</div>

Replying to [@isuruf](#comment:195):
> Replying to [@tobiasdiez](#comment:191):
> > Replying to [@mkoeppe](#comment:173):
> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> > 
> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9

> 
> Should be fixed with #33358

It is indeed correctly using lcalc 2 now. Thanks!



---

archive/issue_comments_493729.json:
```json
{
    "body": "<div id=\"comment:211\" align=\"right\">comment:211</div>\n\nReplying to [@mkoeppe](#comment:207):\n> For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.\n\nThanks. I've reverted to using --prefix (with --without-system-gcc). Let's put your improvements to the gcc detection script in a follow-up ticket.",
    "created_at": "2022-02-16T19:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493729",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:211" align="right">comment:211</div>

Replying to [@mkoeppe](#comment:207):
> For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.

Thanks. I've reverted to using --prefix (with --without-system-gcc). Let's put your improvements to the gcc detection script in a follow-up ticket.



---

archive/issue_comments_493730.json:
```json
{
    "body": "<div id=\"comment:212\" align=\"right\">comment:212</div>\n\nReplying to [@mkoeppe](#comment:202):\n> Replying to [@tobiasdiez](#comment:199):\n> > I don't see any advantage in hiding useful information\n\n> \n> I've already explained that it's not useful for those who know how to update our configure tests.\n\nThere are also people that don't know much about these configure scripts but still want to work on the conda environment.\n\nThe point of this ticket (at least for me), is having a CI infrastructure to confirm that updates to the conda evniroment such as #33330 and #33358 indeed have a positive impact. For this it is not helpful if the workflow exists early because some conda package got updated in the meantime and now the corresponding \"system\" package is rejected by sage.\n\nTo be honest, I feel tired by this discussion and think we already invested more time discussing pros and cons then developer will ever spend while chasing mysterious bugs potentially coming from this. If its so important to you, I would like to ask you to implement it in a follow-up ticket.",
    "created_at": "2022-02-16T19:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493730",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:212" align="right">comment:212</div>

Replying to [@mkoeppe](#comment:202):
> Replying to [@tobiasdiez](#comment:199):
> > I don't see any advantage in hiding useful information

> 
> I've already explained that it's not useful for those who know how to update our configure tests.

There are also people that don't know much about these configure scripts but still want to work on the conda environment.

The point of this ticket (at least for me), is having a CI infrastructure to confirm that updates to the conda evniroment such as #33330 and #33358 indeed have a positive impact. For this it is not helpful if the workflow exists early because some conda package got updated in the meantime and now the corresponding "system" package is rejected by sage.

To be honest, I feel tired by this discussion and think we already invested more time discussing pros and cons then developer will ever spend while chasing mysterious bugs potentially coming from this. If its so important to you, I would like to ask you to implement it in a follow-up ticket.



---

archive/issue_comments_493731.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIt's now working: build succeeds and most tests pass in all tested configs. https://github.com/sagemath/sagetrac-mirror/actions/runs/1854640215\n\nLet's move potential improvements (like removing --prefix, --without-system-gcc, fixes to giac, updates to the docs etc) to follow-up tickets.",
    "created_at": "2022-02-16T19:40:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493731",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:3" align="right">comment:3</div>

It's now working: build succeeds and most tests pass in all tested configs. https://github.com/sagemath/sagetrac-mirror/actions/runs/1854640215

Let's move potential improvements (like removing --prefix, --without-system-gcc, fixes to giac, updates to the docs etc) to follow-up tickets.



---

archive/issue_events_427537.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-16T19:40:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427537"
}
```



---

archive/issue_events_427538.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-16T19:40:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427538"
}
```



---

archive/issue_comments_493732.json:
```json
{
    "body": "<div id=\"comment:214\" align=\"right\">comment:214</div>\n\nReplying to [@tobiasdiez](#comment:212):\n> Replying to [@mkoeppe](#comment:202):\n> > Replying to [@tobiasdiez](#comment:199):\n> > > I don't see any advantage in hiding useful information\n\n> > \n> > I've already explained that it's not useful for those who know how to update our configure tests.\n\n> \n> There are also people that don't know much about these configure scripts but still want to work on the conda environment.\n\nYes, and they can do that as I explained in [comment:181](#comment:181). They don't need to see the errors if they don't want to work on the configure scripts.",
    "created_at": "2022-02-16T19:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493732",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:214" align="right">comment:214</div>

Replying to [@tobiasdiez](#comment:212):
> Replying to [@mkoeppe](#comment:202):
> > Replying to [@tobiasdiez](#comment:199):
> > > I don't see any advantage in hiding useful information

> > 
> > I've already explained that it's not useful for those who know how to update our configure tests.

> 
> There are also people that don't know much about these configure scripts but still want to work on the conda environment.

Yes, and they can do that as I explained in [comment:181](#comment:181). They don't need to see the errors if they don't want to work on the configure scripts.



---

archive/issue_events_427539.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T19:44:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427539"
}
```



---

archive/issue_events_427540.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T19:44:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427540"
}
```



---

archive/issue_comments_493733.json:
```json
{
    "body": "<div id=\"comment:215\" align=\"right\">comment:215</div>\n\nReplying to [@tobiasdiez](#comment:213):\n> It's now working: build succeeds and most tests pass in all tested configs.\n\nIt still doesn't pass the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.",
    "created_at": "2022-02-16T19:44:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493733",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:215" align="right">comment:215</div>

Replying to [@tobiasdiez](#comment:213):
> It's now working: build succeeds and most tests pass in all tested configs.

It still doesn't pass the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.



---

archive/issue_comments_493734.json:
```json
{
    "body": "<div id=\"comment:216\" align=\"right\">comment:216</div>\n\nReplying to [@tobiasdiez](#comment:212):\n> If it's so important to you, I would like to ask you to implement it in a follow-up ticket.\n\nI already did, but you removed the commits that implemented it.",
    "created_at": "2022-02-16T19:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493734",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:216" align="right">comment:216</div>

Replying to [@tobiasdiez](#comment:212):
> If it's so important to you, I would like to ask you to implement it in a follow-up ticket.

I already did, but you removed the commits that implemented it.



---

archive/issue_comments_493735.json:
```json
{
    "body": "<div id=\"comment:217\" align=\"right\">comment:217</div>\n\nReplying to [@mkoeppe](#comment:215):\n> Replying to [@tobiasdiez](#comment:213):\n> > It's now working: build succeeds and most tests pass in all tested configs.\n\n> \n> It still doesn't pass the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.\n> \n\nC'mon, according to your own information using --prefix is the best way currently. Without any changes to gcc detection or whatever (which is not the point of this ticket), this only works with --without-system-gcc.",
    "created_at": "2022-02-16T19:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493735",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:217" align="right">comment:217</div>

Replying to [@mkoeppe](#comment:215):
> Replying to [@tobiasdiez](#comment:213):
> > It's now working: build succeeds and most tests pass in all tested configs.

> 
> It still doesn't pass the criterion of [comment:121](#comment:121) - does it test what we would recommend to developers.
> 

C'mon, according to your own information using --prefix is the best way currently. Without any changes to gcc detection or whatever (which is not the point of this ticket), this only works with --without-system-gcc.



---

archive/issue_comments_493736.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n@tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix.",
    "created_at": "2022-02-16T20:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493736",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:8" align="right">comment:8</div>

@tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix.



---

archive/issue_comments_493737.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI'll put these commits on #33361 now",
    "created_at": "2022-02-16T20:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493737",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

I'll put these commits on #33361 now



---

archive/issue_comments_493738.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d547541e0ca4e3806dc9c917d7901e76376bdd3f\"><code>d547541</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce6f8fd6326a3c7db0b3fa83421edf72d27734fb\"><code>ce6f8fd</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ba100510e6ff5168e5f61287fe44a96206cc6f0\"><code>5ba1005</code></a></td><td><code>Merge remote-tracking branch 'trac/u/mkoeppe/configure__handle_the_case_of_sage_local___a_system_directory_with_gcc_better' into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30\"><code>1c2c97e</code></a></td><td><code>Remove without-system-gcc</code></td></tr></table>\n",
    "created_at": "2022-02-17T12:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493738",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d547541e0ca4e3806dc9c917d7901e76376bdd3f"><code>d547541</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce6f8fd6326a3c7db0b3fa83421edf72d27734fb"><code>ce6f8fd</code></a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ba100510e6ff5168e5f61287fe44a96206cc6f0"><code>5ba1005</code></a></td><td><code>Merge remote-tracking branch 'trac/u/mkoeppe/configure__handle_the_case_of_sage_local___a_system_directory_with_gcc_better' into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30"><code>1c2c97e</code></a></td><td><code>Remove without-system-gcc</code></td></tr></table>




---

archive/issue_comments_493739.json:
```json
{
    "body": "Changed commit from **[`8426d2d`](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)** to **[`1c2c97e`](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)**",
    "created_at": "2022-02-17T12:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493739",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8426d2d`](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)** to **[`1c2c97e`](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)**



---

archive/issue_comments_493740.json:
```json
{
    "body": "<div id=\"comment:221\" align=\"right\">comment:221</div>\n\nReplying to [@mkoeppe](#comment:219):\n> I'll put these commits on #33361 now\n\nThanks",
    "created_at": "2022-02-17T12:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493740",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:221" align="right">comment:221</div>

Replying to [@mkoeppe](#comment:219):
> I'll put these commits on #33361 now

Thanks



---

archive/issue_events_427541.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-17T12:11:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427541"
}
```



---

archive/issue_events_427542.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-17T12:11:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427542"
}
```



---

archive/issue_comments_493741.json:
```json
{
    "body": "<div id=\"comment:222\" align=\"right\">comment:222</div>\n\nReplying to [@isuruf](#comment:218):\n> @tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix. \n\nDone by merging #33361. (For the record, I initially removed these commits because it seemed like the whole prefix thing wasn't necessary).\n\nStill a bit confused why #33361 couldn't just be a follow-up on top of this ticket, but, well, I guess I'm used to a different developing/merging strategy.",
    "created_at": "2022-02-17T12:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493741",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:222" align="right">comment:222</div>

Replying to [@isuruf](#comment:218):
> @tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix. 

Done by merging #33361. (For the record, I initially removed these commits because it seemed like the whole prefix thing wasn't necessary).

Still a bit confused why #33361 couldn't just be a follow-up on top of this ticket, but, well, I guess I'm used to a different developing/merging strategy.



---

archive/issue_comments_493742.json:
```json
{
    "body": "Changed dependencies from **#33358, #33330** to **#33358, #33330, #33361**",
    "created_at": "2022-02-17T12:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493742",
    "user": "https://github.com/tobiasdiez"
}
```

Changed dependencies from **#33358, #33330** to **#33358, #33330, #33361**



---

archive/issue_comments_493743.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSeems to work well, no gc errors anymore and all standard conda packages are detected successfully (even with the `environment-optional.yml).\n\nSo should be good to go now.",
    "created_at": "2022-02-17T12:23:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493743",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

Seems to work well, no gc errors anymore and all standard conda packages are detected successfully (even with the `environment-optional.yml).

So should be good to go now.



---

archive/issue_comments_493744.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHow is there no `gc` error any more? What has changed in this respect?",
    "created_at": "2022-02-17T17:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493744",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

How is there no `gc` error any more? What has changed in this respect?



---

archive/issue_comments_493745.json:
```json
{
    "body": "<div id=\"comment:226\" align=\"right\">comment:226</div>\n\nReplying to [@dimpase](#comment:225):\n> How is there no `gc` error any more? What has changed in this respect? \n\n#33361 fixed it.",
    "created_at": "2022-02-17T17:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493745",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:226" align="right">comment:226</div>

Replying to [@dimpase](#comment:225):
> How is there no `gc` error any more? What has changed in this respect? 

#33361 fixed it.



---

archive/issue_comments_493746.json:
```json
{
    "body": "<div id=\"comment:227\" align=\"right\">comment:227</div>\n\nReplying to [@tobiasdiez](#comment:226):\n> Replying to [@dimpase](#comment:225):\n> > How is there no `gc` error any more? What has changed in this respect? \n\n> \n> #33361 fixed it.\n\nthis must be close a miracle - as only `gcc` was touched there.",
    "created_at": "2022-02-17T17:52:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493746",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:227" align="right">comment:227</div>

Replying to [@tobiasdiez](#comment:226):
> Replying to [@dimpase](#comment:225):
> > How is there no `gc` error any more? What has changed in this respect? 

> 
> #33361 fixed it.

this must be close a miracle - as only `gcc` was touched there.



---

archive/issue_comments_493747.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n`gc` was rejected via SPKG_DEPCHECK on `gcc`.",
    "created_at": "2022-02-17T17:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493747",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

`gc` was rejected via SPKG_DEPCHECK on `gcc`.



---

archive/issue_comments_493748.json:
```json
{
    "body": "<div id=\"comment:229\" align=\"right\">comment:229</div>\n\nReplying to [@mkoeppe](#comment:228):\n> `gc` was rejected via SPKG_DEPCHECK on `gcc`.\n\nDoes this mean that somehow #33361 is blessing `gcc`'s deps?\nHmm, not sure I follow.",
    "created_at": "2022-02-17T18:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493748",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:229" align="right">comment:229</div>

Replying to [@mkoeppe](#comment:228):
> `gc` was rejected via SPKG_DEPCHECK on `gcc`.

Does this mean that somehow #33361 is blessing `gcc`'s deps?
Hmm, not sure I follow.



---

archive/issue_comments_493749.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nno, that's really weird. `gc` is not used by `gcc`... OK, this is a Church of gcc spkg, and I'm a non-believer...",
    "created_at": "2022-02-17T18:52:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493749",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">comment:0</div>

no, that's really weird. `gc` is not used by `gcc`... OK, this is a Church of gcc spkg, and I'm a non-believer...



---

archive/issue_comments_493750.json:
```json
{
    "body": "<div id=\"comment:231\" align=\"right\">comment:231</div>\n\nReplying to [@mkoeppe](#comment:228):\n> `gc` was rejected via SPKG_DEPCHECK on `gcc`.\n\nSorry, I was wrong - I misremembered",
    "created_at": "2022-02-17T18:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493750",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:231" align="right">comment:231</div>

Replying to [@mkoeppe](#comment:228):
> `gc` was rejected via SPKG_DEPCHECK on `gcc`.

Sorry, I was wrong - I misremembered



---

archive/issue_comments_493751.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThere was no problem with `gc` except within Tobias's WSL install.",
    "created_at": "2022-02-17T18:55:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493751",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

There was no problem with `gc` except within Tobias's WSL install.



---

archive/issue_comments_493752.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSorry for the missing c and the confusion it caused :-)",
    "created_at": "2022-02-17T19:37:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493752",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:3" align="right">comment:3</div>

Sorry for the missing c and the confusion it caused :-)



---

archive/issue_comments_493753.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n![](https://i.stack.imgur.com/jiFfM.jpg)",
    "created_at": "2022-02-17T20:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493753",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

![](https://i.stack.imgur.com/jiFfM.jpg)



---

archive/issue_comments_493754.json:
```json
{
    "body": "<div id=\"comment:235\" align=\"right\">comment:235</div>\n\nReplying to [@mkoeppe](#comment:92):\n> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\nWith dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.",
    "created_at": "2022-03-15T21:08:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493754",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:235" align="right">comment:235</div>

Replying to [@mkoeppe](#comment:92):
> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.



---

archive/issue_comments_493755.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n@isuruf - `--with-system-lrcalc=force` fails because conda-forge does not provide lrcalc 2.x yet",
    "created_at": "2022-03-15T21:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493755",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

@isuruf - `--with-system-lrcalc=force` fails because conda-forge does not provide lrcalc 2.x yet



---

archive/issue_comments_493756.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFixed by\n\n- https://github.com/conda-forge/lrcalc-feedstock/pull/7",
    "created_at": "2022-03-16T08:20:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493756",
    "user": "https://github.com/slel"
}
```

<div id="comment:7" align="right">comment:7</div>

Fixed by

- https://github.com/conda-forge/lrcalc-feedstock/pull/7



---

archive/issue_comments_493757.json:
```json
{
    "body": "<div id=\"comment:238\" align=\"right\">comment:238</div>\n\nReplying to [@mkoeppe](#comment:235):\n> Replying to [@mkoeppe](#comment:92):\n> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n> \n> With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.\n\n\nIf a system package is not used, then an error message is displayed in the github flow, so these force arguments are not necessary (or can later be added as part of #33345) .\n\nCan we please get this ticket in?",
    "created_at": "2022-03-16T17:55:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493757",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:238" align="right">comment:238</div>

Replying to [@mkoeppe](#comment:235):
> Replying to [@mkoeppe](#comment:92):
> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

> 
> With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.


If a system package is not used, then an error message is displayed in the github flow, so these force arguments are not necessary (or can later be added as part of #33345) .

Can we please get this ticket in?



---

archive/issue_comments_493758.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ea60619c478a4220a204843e9938968e3052677\"><code>9ea6061</code></a></td><td><code>Merge tag '9.6.beta5' into t/30845/public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352\"><code>574c6df</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-...=force</code></td></tr></table>\n",
    "created_at": "2022-03-16T18:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493758",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ea60619c478a4220a204843e9938968e3052677"><code>9ea6061</code></a></td><td><code>Merge tag '9.6.beta5' into t/30845/public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352"><code>574c6df</code></a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-...=force</code></td></tr></table>




---

archive/issue_comments_493759.json:
```json
{
    "body": "Changed commit from **[`1c2c97e`](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)** to **[`574c6df`](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)**",
    "created_at": "2022-03-16T18:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493759",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1c2c97e`](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)** to **[`574c6df`](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)**



---

archive/issue_comments_493760.json:
```json
{
    "body": "<div id=\"comment:240\" align=\"right\">comment:240</div>\n\nReplying to [@tobiasdiez](#comment:238):\n> Can we please get this ticket in? \n\nWorking on it, as you can see",
    "created_at": "2022-03-16T19:00:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493760",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:240" align="right">comment:240</div>

Replying to [@tobiasdiez](#comment:238):
> Can we please get this ticket in? 

Working on it, as you can see



---

archive/issue_comments_493761.json:
```json
{
    "body": "<div id=\"comment:241\" align=\"right\">comment:241</div>\n\nReplying to [@slel](#comment:237):\n> Fixed by\n> \n> - https://github.com/conda-forge/lrcalc-feedstock/pull/7\n\nGreat, now I see that lrcalc 2.1. Still need https://pypi.org/project/lrcalc/ in conda-forge, or we need to install it with pip.",
    "created_at": "2022-03-16T19:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493761",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:241" align="right">comment:241</div>

Replying to [@slel](#comment:237):
> Fixed by
> 
> - https://github.com/conda-forge/lrcalc-feedstock/pull/7

Great, now I see that lrcalc 2.1. Still need https://pypi.org/project/lrcalc/ in conda-forge, or we need to install it with pip.



---

archive/issue_comments_493762.json:
```json
{
    "body": "<div id=\"comment:242\" align=\"right\">comment:242</div>\n\nReplying to [@mkoeppe](#comment:240):\n> Replying to [@tobiasdiez](#comment:238):\n> > Can we please get this ticket in? \n\n> \n> Working on it, as you can see\n\nCan you please revert 574c6df thanks!",
    "created_at": "2022-03-16T19:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493762",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:242" align="right">comment:242</div>

Replying to [@mkoeppe](#comment:240):
> Replying to [@tobiasdiez](#comment:238):
> > Can we please get this ticket in? 

> 
> Working on it, as you can see

Can you please revert 574c6df thanks!



---

archive/issue_comments_493763.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI'm also getting\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular\nchecking for SINGULAR... no\n...\nconfigure: error: \n\n    Given --with-system-singular=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-singular)\n```\n(https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)",
    "created_at": "2022-03-16T19:40:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493763",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

I'm also getting

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular
checking for SINGULAR... no
...
configure: error: 

    Given --with-system-singular=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-singular)
```
(https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)



---

archive/issue_comments_493764.json:
```json
{
    "body": "Changed author from **Tobias Diez** to **Tobias Diez, Matthias Koeppe**",
    "created_at": "2022-03-16T19:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493764",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Tobias Diez** to **Tobias Diez, Matthias Koeppe**



---

archive/issue_events_427543.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-16T19:41:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427543"
}
```



---

archive/issue_events_427544.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-16T19:41:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427544"
}
```



---

archive/issue_comments_493765.json:
```json
{
    "body": "Changed commit from **[`574c6df`](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)** to **[`a01bdd9`](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)**",
    "created_at": "2022-03-16T19:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493765",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`574c6df`](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)** to **[`a01bdd9`](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)**



---

archive/issue_comments_493766.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb\"><code>a01bdd9</code></a></td><td><code>build/pkgs/lrcalc/distros/conda.txt: Set version bound >= 2</code></td></tr></table>\n",
    "created_at": "2022-03-16T19:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493766",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb"><code>a01bdd9</code></a></td><td><code>build/pkgs/lrcalc/distros/conda.txt: Set version bound >= 2</code></td></tr></table>




---

archive/issue_comments_493767.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8\"><code>739e4cd</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Set version lower bound</code></td></tr></table>\n",
    "created_at": "2022-03-16T19:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493767",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8"><code>739e4cd</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Set version lower bound</code></td></tr></table>




---

archive/issue_comments_493768.json:
```json
{
    "body": "Changed commit from **[`a01bdd9`](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)** to **[`739e4cd`](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)**",
    "created_at": "2022-03-16T19:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493768",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a01bdd9`](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)** to **[`739e4cd`](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)**



---

archive/issue_comments_493769.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWorking on both lrcalc and singular issue. Can you add `python-lrcalc` as the name for conda package for `lrcalc_python`?",
    "created_at": "2022-03-16T19:58:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493769",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:8" align="right">comment:8</div>

Working on both lrcalc and singular issue. Can you add `python-lrcalc` as the name for conda package for `lrcalc_python`?



---

archive/issue_comments_493770.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nWill do, thanks!",
    "created_at": "2022-03-16T20:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493770",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Will do, thanks!



---

archive/issue_comments_493771.json:
```json
{
    "body": "<div id=\"comment:0\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/587f57a0a4f1eeefcc6e54ead3322dbefe316b13\"><code>587f57a</code></a></td><td><code>build/pkgs/lrcalc_python/distros/conda.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6\"><code>8af68a0</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Change version specification</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493771",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:0"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/587f57a0a4f1eeefcc6e54ead3322dbefe316b13"><code>587f57a</code></a></td><td><code>build/pkgs/lrcalc_python/distros/conda.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6"><code>8af68a0</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Change version specification</code></td></tr></table>




---

archive/issue_comments_493772.json:
```json
{
    "body": "Changed commit from **[`739e4cd`](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)** to **[`8af68a0`](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)**",
    "created_at": "2022-03-16T20:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493772",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`739e4cd`](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)** to **[`8af68a0`](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)**



---

archive/issue_comments_493773.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nCan you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`",
    "created_at": "2022-03-16T20:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493773",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:1" align="right">comment:1</div>

Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`



---

archive/issue_comments_493774.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584\"><code>9cbee4c</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493774",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584"><code>9cbee4c</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>




---

archive/issue_comments_493775.json:
```json
{
    "body": "Changed commit from **[`8af68a0`](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)** to **[`9cbee4c`](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)**",
    "created_at": "2022-03-16T20:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493775",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8af68a0`](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)** to **[`9cbee4c`](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)**



---

archive/issue_comments_493776.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@mkoeppe](#comment:243):\n> I'm also getting\n> \n> ```\n> Checking whether SageMath should install SPKG singular...\n> checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\n> checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular\n> checking for SINGULAR... no\n> ...\n> configure: error: \n> \n>     Given --with-system-singular=force, but no system package could be used.\n>     That's an error.  Please install the indicated package to continue.\n>     (To override this error, use ./configure --without-system-singular)\n> ```\n> (https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)\n\nCan we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n\nSimilarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584\"><code>9cbee4c</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493776",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@mkoeppe](#comment:243):
> I'm also getting
> 
> ```
> Checking whether SageMath should install SPKG singular...
> checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
> checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular
> checking for SINGULAR... no
> ...
> configure: error: 
> 
>     Given --with-system-singular=force, but no system package could be used.
>     That's an error.  Please install the indicated package to continue.
>     (To override this error, use ./configure --without-system-singular)
> ```
> (https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)

Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.

Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584"><code>9cbee4c</code></a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>




---

archive/issue_comments_493777.json:
```json
{
    "body": "<div id=\"comment:254\" align=\"right\">comment:254</div>\n\nReplying to [@tobiasdiez](#comment:253):\n> Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n> \n> Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\nPlease, Tobias, an author repeatedly demanding that the ticket goes in \"as is\" is not helpful and is not part of the collaborative workflow of the Sage project.",
    "created_at": "2022-03-16T20:09:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493777",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:254" align="right">comment:254</div>

Replying to [@tobiasdiez](#comment:253):
> Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.
> 
> Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).

Please, Tobias, an author repeatedly demanding that the ticket goes in "as is" is not helpful and is not part of the collaborative workflow of the Sage project.



---

archive/issue_comments_493778.json:
```json
{
    "body": "<div id=\"comment:255\" align=\"right\">comment:255</div>\n\nReplying to [@isuruf](#comment:251):\n> Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`\n\nThanks, this works.",
    "created_at": "2022-03-16T20:09:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493778",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:255" align="right">comment:255</div>

Replying to [@isuruf](#comment:251):
> Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`

Thanks, this works.



---

archive/issue_comments_493779.json:
```json
{
    "body": "<div id=\"comment:256\" align=\"right\">comment:256</div>\n\nReplying to [@mkoeppe](#comment:254):\n> Replying to [@tobiasdiez](#comment:253):\n> > Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n> > \n> > Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\n> \n> Please, Tobias, an author repeatedly demanding that the ticket goes in \"as is\" is not helpful and is not part of the collaborative workflow of the Sage project. \n\nThat's not what I'm saying. I just don't see the need that these changes, that then need further changes etc need to be part of this ticket. I'm happy to adjust the github workflow if you have any comments/suggestions on this.",
    "created_at": "2022-03-16T20:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493779",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:256" align="right">comment:256</div>

Replying to [@mkoeppe](#comment:254):
> Replying to [@tobiasdiez](#comment:253):
> > Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.
> > 
> > Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).

> 
> Please, Tobias, an author repeatedly demanding that the ticket goes in "as is" is not helpful and is not part of the collaborative workflow of the Sage project. 

That's not what I'm saying. I just don't see the need that these changes, that then need further changes etc need to be part of this ticket. I'm happy to adjust the github workflow if you have any comments/suggestions on this.



---

archive/issue_comments_493780.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI see that `python-lrcalc` 2.1 is now available in the conda-forge channel. Thanks @isuruf! \n\nTests running at https://github.com/mkoeppe/sage/actions/runs/1996031338",
    "created_at": "2022-03-17T01:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493780",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

I see that `python-lrcalc` 2.1 is now available in the conda-forge channel. Thanks @isuruf! 

Tests running at https://github.com/mkoeppe/sage/actions/runs/1996031338



---

archive/issue_comments_493781.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThere's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion",
    "created_at": "2022-03-17T03:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493781",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion



---

archive/issue_comments_493782.json:
```json
{
    "body": "Changed commit from **[`9cbee4c`](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)** to **[`9f8cb1d`](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)**",
    "created_at": "2022-03-17T06:25:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493782",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9cbee4c`](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)** to **[`9f8cb1d`](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)**



---

archive/issue_comments_493783.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2\"><code>9f8cb1d</code></a></td><td><code>.github/workflows/ci-conda.yml: Also test on macos-latest</code></td></tr></table>\n",
    "created_at": "2022-03-17T06:25:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493783",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2"><code>9f8cb1d</code></a></td><td><code>.github/workflows/ci-conda.yml: Also test on macos-latest</code></td></tr></table>




---

archive/issue_comments_493784.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nI have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n\nsee https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true",
    "created_at": "2022-03-17T06:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493784",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">comment:0</div>

I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.

see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true



---

archive/issue_comments_493785.json:
```json
{
    "body": "<div id=\"comment:261\" align=\"right\">comment:261</div>\n\nReplying to [@mkoeppe](#comment:260):\n> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> \n> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\nthis looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget\nto append them to `LDFLAGS` for testing in `AC_RUN_IF_ELSE`. Something like this should make it work\n(assuming these flags are getting into `PPL_LDFLAGS` at all):\n\n```diff\n--- a/m4/ppl.m4\n+++ b/m4/ppl.m4\n@@ -96,9 +96,11 @@ else\n   if test \"x$enable_ppltest\" = xyes\n   then\n     ac_save_CPPFLAGS=\"$CPPFLAGS\"\n+    ac_save_LDFLAGS=\"$LDFLAGS\"\n     ac_save_LIBS=\"$LIBS\"\n     CPPFLAGS=\"$CPPFLAGS $PPL_CPPFLAGS\"\n     LIBS=\"$LIBS $PPL_LIBS\"\n+    LDFLAGS=\"$LDFLAGS $PPL_LDFLAGS\"\n \n dnl Now check if the installed PPL is sufficiently new.\n dnl (Also sanity checks the results of ppl-config to some extent.)\n@@ -238,6 +240,7 @@ main() {\n \n     CPPFLAGS=\"$ac_save_CPPFLAGS\"\n     LIBS=\"$ac_save_LIBS\"\n+    LDFLAGS=\"$ac_save_LDFLAGS\"\n   fi\n fi\n \n@@ -261,6 +264,7 @@ else\n       echo \"*** Could not run PPL test program, checking why...\"\n       CPPFLAGS=\"$CPPFLAGS $PPL_CPPFLAGS\"\n       LIBS=\"$LIBS $PPL_LIBS\"\n+      LDFLAGS=\"$LDFLAGS $PPL_LDFLAGS\"\n       AC_LINK_IFELSE([AC_LANG_PROGRAM([[\n #include <ppl.hh>\n using namespace Parma_Polyhedra_Library;\n@@ -287,6 +291,7 @@ using namespace Parma_Polyhedra_Library;\n ])\n       CPPFLAGS=\"$ac_save_CPPFLAGS\"\n       LIBS=\"$ac_save_LIBS\"\n+      LDFLAGS=\"$ac_save_LDFLAGS\"\n     fi\n   fi\n   PPL_CPPFLAGS=\"\"\n```\n\nUntested.",
    "created_at": "2022-03-17T09:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493785",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:261" align="right">comment:261</div>

Replying to [@mkoeppe](#comment:260):
> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> 
> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true

this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget
to append them to `LDFLAGS` for testing in `AC_RUN_IF_ELSE`. Something like this should make it work
(assuming these flags are getting into `PPL_LDFLAGS` at all):

```diff
--- a/m4/ppl.m4
+++ b/m4/ppl.m4
@@ -96,9 +96,11 @@ else
   if test "x$enable_ppltest" = xyes
   then
     ac_save_CPPFLAGS="$CPPFLAGS"
+    ac_save_LDFLAGS="$LDFLAGS"
     ac_save_LIBS="$LIBS"
     CPPFLAGS="$CPPFLAGS $PPL_CPPFLAGS"
     LIBS="$LIBS $PPL_LIBS"
+    LDFLAGS="$LDFLAGS $PPL_LDFLAGS"
 
 dnl Now check if the installed PPL is sufficiently new.
 dnl (Also sanity checks the results of ppl-config to some extent.)
@@ -238,6 +240,7 @@ main() {
 
     CPPFLAGS="$ac_save_CPPFLAGS"
     LIBS="$ac_save_LIBS"
+    LDFLAGS="$ac_save_LDFLAGS"
   fi
 fi
 
@@ -261,6 +264,7 @@ else
       echo "*** Could not run PPL test program, checking why..."
       CPPFLAGS="$CPPFLAGS $PPL_CPPFLAGS"
       LIBS="$LIBS $PPL_LIBS"
+      LDFLAGS="$LDFLAGS $PPL_LDFLAGS"
       AC_LINK_IFELSE([AC_LANG_PROGRAM([[
 #include <ppl.hh>
 using namespace Parma_Polyhedra_Library;
@@ -287,6 +291,7 @@ using namespace Parma_Polyhedra_Library;
 ])
       CPPFLAGS="$ac_save_CPPFLAGS"
       LIBS="$ac_save_LIBS"
+      LDFLAGS="$ac_save_LDFLAGS"
     fi
   fi
   PPL_CPPFLAGS=""
```

Untested.



---

archive/issue_comments_493786.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a\"><code>7bb23f9</code></a></td><td><code>Try again without lower limit for singular</code></td></tr></table>\n",
    "created_at": "2022-03-17T09:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493786",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a"><code>7bb23f9</code></a></td><td><code>Try again without lower limit for singular</code></td></tr></table>




---

archive/issue_comments_493787.json:
```json
{
    "body": "Changed commit from **[`9f8cb1d`](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)** to **[`7bb23f9`](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)**",
    "created_at": "2022-03-17T09:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493787",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9f8cb1d`](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)** to **[`7bb23f9`](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)**



---

archive/issue_comments_493788.json:
```json
{
    "body": "Changed commit from **[`7bb23f9`](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)** to **[`886d895`](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)**",
    "created_at": "2022-03-17T09:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493788",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7bb23f9`](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)** to **[`886d895`](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)**



---

archive/issue_comments_493789.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2\"><code>886d895</code></a></td><td><code>...and without lrcalc lower bound</code></td></tr></table>\n",
    "created_at": "2022-03-17T09:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493789",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2"><code>886d895</code></a></td><td><code>...and without lrcalc lower bound</code></td></tr></table>




---

archive/issue_comments_493790.json:
```json
{
    "body": "<div id=\"comment:264\" align=\"right\">comment:264</div>\n\nNo, it's a bug in the conda package with binary relocation. Will fix shortly.\n\nReplying to [@dimpase](#comment:261):\n> Replying to [@mkoeppe](#comment:260):\n> > I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> > \n> > see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\n> \n> this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget",
    "created_at": "2022-03-17T09:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493790",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:264" align="right">comment:264</div>

No, it's a bug in the conda package with binary relocation. Will fix shortly.

Replying to [@dimpase](#comment:261):
> Replying to [@mkoeppe](#comment:260):
> > I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> > 
> > see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true

> 
> this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget



---

archive/issue_comments_493791.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary. It also looks like on github `lcalc 2.1` and `singular 4.2.1.p3` are used automatically. This is also expected since conda always tries to use the most recent versions and only in very rare instances lower bounds are necessary (essentially only if there are two different branches in the dependency resolution tree, and conda would choose the 'wrong' one). Why did you added these lower bounds?",
    "created_at": "2022-03-17T12:58:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493791",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:5" align="right">comment:5</div>

I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary. It also looks like on github `lcalc 2.1` and `singular 4.2.1.p3` are used automatically. This is also expected since conda always tries to use the most recent versions and only in very rare instances lower bounds are necessary (essentially only if there are two different branches in the dependency resolution tree, and conda would choose the 'wrong' one). Why did you added these lower bounds?



---

archive/issue_comments_493792.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@mkoeppe](#comment:260):\n> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> \n> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\nAnd which advantages does one now gain from the fact that the github workflow already quits after the configure step, and doesn't run build and tests?\n\nMoreover, after the change with the force parameter the github matcher is no longer working correctly since now \" no suitable system package; this is an error\" is displayed in the logs.",
    "created_at": "2022-03-17T13:55:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493792",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@mkoeppe](#comment:260):
> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> 
> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true

And which advantages does one now gain from the fact that the github workflow already quits after the configure step, and doesn't run build and tests?

Moreover, after the change with the force parameter the github matcher is no longer working correctly since now " no suitable system package; this is an error" is displayed in the logs.



---

archive/issue_comments_493793.json:
```json
{
    "body": "Changed commit from **[`886d895`](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)** to **[`a93b236`](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)**",
    "created_at": "2022-03-17T15:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493793",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`886d895`](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)** to **[`a93b236`](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)**



---

archive/issue_comments_493794.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b\"><code>a93b236</code></a></td><td><code>.github/workflows/ci-conda.yml: Reorder matrix</code></td></tr></table>\n",
    "created_at": "2022-03-17T15:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493794",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b"><code>a93b236</code></a></td><td><code>.github/workflows/ci-conda.yml: Reorder matrix</code></td></tr></table>




---

archive/issue_comments_493795.json:
```json
{
    "body": "<div id=\"comment:268\" align=\"right\">comment:268</div>\n\nReplying to [@tobiasdiez](#comment:265):\n> I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary\n\nYes, they are not needed any more, thanks.",
    "created_at": "2022-03-17T15:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493795",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:268" align="right">comment:268</div>

Replying to [@tobiasdiez](#comment:265):
> I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary

Yes, they are not needed any more, thanks.



---

archive/issue_comments_493796.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n@isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb\n\n```\nWarning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n  \n  ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n  Rolling back transaction: ...working... done\n  Warning: \n  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n  ==> script messages <==\n  <None>\n  ==> script output <==\n  stdout: Warning: GDB is not codesigned.\n  Generating and installing gdb_codesign certificate\n  \n  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n  error: Something went wrong when installing the certificate\n  \n  return code: 1\n  \n  ()\n  \n  \n  \n  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n  ==> script messages <==\n  <None>\n  ==> script output <==\n  stdout: Warning: GDB is not codesigned.\n  Generating and installing gdb_codesign certificate\n  \n  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n  error: Something went wrong when installing the certificate\n  \n  return code: 1\n  \n```",
    "created_at": "2022-03-17T15:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493796",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

@isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb

```
Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
  
  ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
  Rolling back transaction: ...working... done
  Warning: 
  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
  ==> script messages <==
  <None>
  ==> script output <==
  stdout: Warning: GDB is not codesigned.
  Generating and installing gdb_codesign certificate
  
  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
  error: Something went wrong when installing the certificate
  
  return code: 1
  
  ()
  
  
  
  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
  ==> script messages <==
  <None>
  ==> script output <==
  stdout: Warning: GDB is not codesigned.
  Generating and installing gdb_codesign certificate
  
  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
  error: Something went wrong when installing the certificate
  
  return code: 1
  
```



---

archive/issue_comments_493797.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\n@isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?",
    "created_at": "2022-03-17T16:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493797",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">comment:0</div>

@isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?



---

archive/issue_comments_493798.json:
```json
{
    "body": "<div id=\"comment:271\" align=\"right\">comment:271</div>\n\nReplying to [@mkoeppe](#comment:258):\n> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion\n\nThis one is specific to Linux; it's fine on macos.",
    "created_at": "2022-03-17T16:37:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493798",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:271" align="right">comment:271</div>

Replying to [@mkoeppe](#comment:258):
> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion

This one is specific to Linux; it's fine on macos.



---

archive/issue_comments_493799.json:
```json
{
    "body": "Changed commit from **[`a93b236`](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)** to **[`ed0967c`](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)**",
    "created_at": "2022-03-17T17:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493799",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a93b236`](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)** to **[`ed0967c`](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)**



---

archive/issue_comments_493800.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c\"><code>ed0967c</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>\n",
    "created_at": "2022-03-17T17:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493800",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c"><code>ed0967c</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>




---

archive/issue_comments_493801.json:
```json
{
    "body": "<div id=\"comment:273\" align=\"right\">comment:273</div>\n\nReplying to [@sagetrac-git](#comment:272):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c\"><code>ed0967c</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>\n\nError: Unable to process command '::add-matcher::.github/workflows/configure-systempackage-problem-matcher.json' successfully.\nError: After parsing a value an unexpected character was encountered: {. Path 'problemMatcher[0]', line 15, position 8.",
    "created_at": "2022-03-17T19:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493801",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:273" align="right">comment:273</div>

Replying to [@sagetrac-git](#comment:272):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c"><code>ed0967c</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>

Error: Unable to process command '::add-matcher::.github/workflows/configure-systempackage-problem-matcher.json' successfully.
Error: After parsing a value an unexpected character was encountered: {. Path 'problemMatcher[0]', line 15, position 8.



---

archive/issue_comments_493802.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIs there something else that is left to do?",
    "created_at": "2022-03-17T19:21:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493802",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

Is there something else that is left to do?



---

archive/issue_comments_493803.json:
```json
{
    "body": "<div id=\"comment:275\" align=\"right\">comment:275</div>\n\nReplying to [@mkoeppe](#comment:270):\n> @isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?\n\nNot easy to do. It's better to silence in the doctest machinery",
    "created_at": "2022-03-17T19:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493803",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:275" align="right">comment:275</div>

Replying to [@mkoeppe](#comment:270):
> @isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?

Not easy to do. It's better to silence in the doctest machinery



---

archive/issue_comments_493804.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOK, I'll do that so that the noise from these warnings does not hide real failures",
    "created_at": "2022-03-17T19:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493804",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

OK, I'll do that so that the noise from these warnings does not hide real failures



---

archive/issue_comments_493805.json:
```json
{
    "body": "<div id=\"comment:277\" align=\"right\">comment:277</div>\n\nCan you open an issue in https://github.com/conda-forge/gdb-feedstock/?\n\nReplying to [@mkoeppe](#comment:269):\n> @isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb\n> \n> ```\n> Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n>   \n>   ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n>   Rolling back transaction: ...working... done\n>   Warning: \n>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n>   ==> script messages <==\n>   <None>\n>   ==> script output <==\n>   stdout: Warning: GDB is not codesigned.\n>   Generating and installing gdb_codesign certificate\n>   \n>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n>   error: Something went wrong when installing the certificate\n>   \n>   return code: 1\n>   \n>   ()\n>   \n>   \n>   \n>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n>   ==> script messages <==\n>   <None>\n>   ==> script output <==\n>   stdout: Warning: GDB is not codesigned.\n>   Generating and installing gdb_codesign certificate\n>   \n>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n>   error: Something went wrong when installing the certificate\n>   \n>   return code: 1\n>   \n> ```",
    "created_at": "2022-03-17T19:37:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493805",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:277" align="right">comment:277</div>

Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?

Replying to [@mkoeppe](#comment:269):
> @isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb
> 
> ```
> Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
>   
>   ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
>   Rolling back transaction: ...working... done
>   Warning: 
>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
>   ==> script messages <==
>   <None>
>   ==> script output <==
>   stdout: Warning: GDB is not codesigned.
>   Generating and installing gdb_codesign certificate
>   
>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
>   error: Something went wrong when installing the certificate
>   
>   return code: 1
>   
>   ()
>   
>   
>   
>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
>   ==> script messages <==
>   <None>
>   ==> script output <==
>   stdout: Warning: GDB is not codesigned.
>   Generating and installing gdb_codesign certificate
>   
>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
>   error: Something went wrong when installing the certificate
>   
>   return code: 1
>   
> ```



---

archive/issue_comments_493806.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nA minor thing to fix: Installing sagelib downgrades `scipy`, `networkx` via install-requires; that's now #33520.",
    "created_at": "2022-03-17T19:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493806",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

A minor thing to fix: Installing sagelib downgrades `scipy`, `networkx` via install-requires; that's now #33520.



---

archive/issue_comments_493807.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146\"><code>d7dfa69</code></a></td><td><code>sage.features.pkg_systems.SagePackageSystem: Check if there are any installation records</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493807",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146"><code>d7dfa69</code></a></td><td><code>sage.features.pkg_systems.SagePackageSystem: Check if there are any installation records</code></td></tr></table>




---

archive/issue_comments_493808.json:
```json
{
    "body": "Changed commit from **[`ed0967c`](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)** to **[`d7dfa69`](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)**",
    "created_at": "2022-03-17T19:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493808",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ed0967c`](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)** to **[`d7dfa69`](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)**



---

archive/issue_comments_493809.json:
```json
{
    "body": "Changed dependencies from **#33358, #33330, #33361** to **#33358, #33330, #33361, #33141**",
    "created_at": "2022-03-17T19:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493809",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#33358, #33330, #33361** to **#33358, #33330, #33361, #33141**



---

archive/issue_comments_493810.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07545e9bf3eb33b7f3456d0cd588ead12be69703\"><code>07545e9</code></a></td><td><code>Fix sage_setup doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa971bd929f7c95829710e00c5b6774304ffa964\"><code>aa971bd</code></a></td><td><code>Fix doctest in sage_docbuild/__init__.py. Most of the test rely on location that are writable or the presence of documentation sources.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54bd2f5cbb8b7f8c0771b503565246b7e7abd530\"><code>54bd2f5</code></a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c1dc29874c195a4ee6a370ca73b86840f5f3b06\"><code>6c1dc29</code></a></td><td><code>replace optional build tag with sage_spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18308fc6efa732b7174b2e7368e95c73c6fd533c\"><code>18308fc</code></a></td><td><code>get rid of the last optional build tag</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2c9eeace4712372fd8e41d06f96771af6109c3e\"><code>e2c9eea</code></a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5382264eb319f8d650fb1ec8bb0bf36ca2d96f25\"><code>5382264</code></a></td><td><code>make doctest in find_extra_files more robust by sorting the result so that the order is stable.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c\"><code>6b24c05</code></a></td><td><code>Merge #33141</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:52:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493810",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07545e9bf3eb33b7f3456d0cd588ead12be69703"><code>07545e9</code></a></td><td><code>Fix sage_setup doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa971bd929f7c95829710e00c5b6774304ffa964"><code>aa971bd</code></a></td><td><code>Fix doctest in sage_docbuild/__init__.py. Most of the test rely on location that are writable or the presence of documentation sources.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54bd2f5cbb8b7f8c0771b503565246b7e7abd530"><code>54bd2f5</code></a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c1dc29874c195a4ee6a370ca73b86840f5f3b06"><code>6c1dc29</code></a></td><td><code>replace optional build tag with sage_spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18308fc6efa732b7174b2e7368e95c73c6fd533c"><code>18308fc</code></a></td><td><code>get rid of the last optional build tag</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2c9eeace4712372fd8e41d06f96771af6109c3e"><code>e2c9eea</code></a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5382264eb319f8d650fb1ec8bb0bf36ca2d96f25"><code>5382264</code></a></td><td><code>make doctest in find_extra_files more robust by sorting the result so that the order is stable.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c"><code>6b24c05</code></a></td><td><code>Merge #33141</code></td></tr></table>




---

archive/issue_comments_493811.json:
```json
{
    "body": "Changed commit from **[`d7dfa69`](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)** to **[`6b24c05`](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)**",
    "created_at": "2022-03-17T19:52:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493811",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d7dfa69`](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)** to **[`6b24c05`](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)**



---

archive/issue_comments_493812.json:
```json
{
    "body": "Changed commit from **[`6b24c05`](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)** to **[`a408a00`](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)**",
    "created_at": "2022-03-17T19:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493812",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6b24c05`](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)** to **[`a408a00`](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)**



---

archive/issue_comments_493813.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290\"><code>a408a00</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix syntax</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493813",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290"><code>a408a00</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix syntax</code></td></tr></table>




---

archive/issue_comments_493814.json:
```json
{
    "body": "Changed commit from **[`a408a00`](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)** to **[`8631ae1`](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)**",
    "created_at": "2022-03-17T20:02:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493814",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a408a00`](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)** to **[`8631ae1`](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)**



---

archive/issue_comments_493815.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c\"><code>8631ae1</code></a></td><td><code>src/sage/doctest/parsing.py: Filter out ld warnings on macOS conda</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:02:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493815",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c"><code>8631ae1</code></a></td><td><code>src/sage/doctest/parsing.py: Filter out ld warnings on macOS conda</code></td></tr></table>




---

archive/issue_comments_493816.json:
```json
{
    "body": "Changed commit from **[`8631ae1`](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)** to **[`acf80df`](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)**",
    "created_at": "2022-03-17T20:05:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493816",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8631ae1`](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)** to **[`acf80df`](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)**



---

archive/issue_comments_493817.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65\"><code>acf80df</code></a></td><td><code>build/pkgs/gdb/distros/conda.txt: Disable</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:05:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493817",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65"><code>acf80df</code></a></td><td><code>build/pkgs/gdb/distros/conda.txt: Disable</code></td></tr></table>




---

archive/issue_comments_493818.json:
```json
{
    "body": "<div id=\"comment:285\" align=\"right\">comment:285</div>\n\nReplying to [@isuruf](#comment:277):\n> Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?\n\nWill do. For now I've disabled it",
    "created_at": "2022-03-17T20:06:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493818",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:285" align="right">comment:285</div>

Replying to [@isuruf](#comment:277):
> Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?

Will do. For now I've disabled it



---

archive/issue_comments_493819.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI've opened https://github.com/conda-forge/gdb-feedstock/issues/53",
    "created_at": "2022-03-17T20:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493819",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

I've opened https://github.com/conda-forge/gdb-feedstock/issues/53



---

archive/issue_comments_493820.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428\"><code>b431edb</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493820",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428"><code>b431edb</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>




---

archive/issue_comments_493821.json:
```json
{
    "body": "Changed commit from **[`acf80df`](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)** to **[`b431edb`](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)**",
    "created_at": "2022-03-17T20:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493821",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`acf80df`](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)** to **[`b431edb`](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)**



---

archive/issue_comments_493822.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, Dima Pasechnik** to **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634**",
    "created_at": "2022-03-17T21:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493822",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Matthias Koeppe, Dima Pasechnik** to **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634**



---

archive/issue_comments_493823.json:
```json
{
    "body": "<div id=\"comment:289\" align=\"right\">comment:289</div>\n\nReplying to [@sagetrac-git](#comment:287):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428\"><code>b431edb</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>\n\n`echo \"::remove-matcher owner=configure-systempackage::\"` in the workflow has to be probably be changed as well now.",
    "created_at": "2022-03-17T22:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493823",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:289" align="right">comment:289</div>

Replying to [@sagetrac-git](#comment:287):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428"><code>b431edb</code></a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>

`echo "::remove-matcher owner=configure-systempackage::"` in the workflow has to be probably be changed as well now.



---

archive/issue_comments_493824.json:
```json
{
    "body": "<div id=\"comment:290\" align=\"right\">comment:290</div>\n\nBtw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.",
    "created_at": "2022-03-17T22:29:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493824",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:290" align="right">comment:290</div>

Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.



---

archive/issue_comments_493825.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nmacos-latest-3.8-environment: https://github.com/mkoeppe/sage/runs/5591728773?check_suite_focus=true\n\n```\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/env.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/expect.py  # 40 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/gap.py  # 75 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/mwrank.py  # 6 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/quit.py  # 6 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interpreter.py  # 2 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interface_magic.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/ipython_kernel/install.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/structure/coerce_actions.pyx  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/tests/cmdline.py  # 2 doctests failed\n```",
    "created_at": "2022-03-17T22:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493825",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

macos-latest-3.8-environment: https://github.com/mkoeppe/sage/runs/5591728773?check_suite_focus=true

```
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/env.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/expect.py  # 40 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/gap.py  # 75 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/mwrank.py  # 6 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/quit.py  # 6 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interpreter.py  # 2 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interface_magic.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/ipython_kernel/install.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/structure/coerce_actions.pyx  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/tests/cmdline.py  # 2 doctests failed
```



---

archive/issue_comments_493826.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI think the many failures from `sage.interfaces` are the failure of too recent versions of `ptyprocess` (#32147).",
    "created_at": "2022-03-17T23:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493826",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

I think the many failures from `sage.interfaces` are the failure of too recent versions of `ptyprocess` (#32147).



---

archive/issue_comments_493827.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n@isuruf unfortunately, the only working version of ptyprocess (0.5.1) on macOS is only available on outdated python versions in conda-forge.\n\n```\nptyprocess                     0.5.1          py27_0  conda-forge         \nptyprocess                     0.5.1          py34_0  conda-forge         \nptyprocess                     0.5.1          py35_0  conda-forge         \nptyprocess                     0.5.1          py36_0  conda-forge         \n```",
    "created_at": "2022-03-17T23:08:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493827",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

@isuruf unfortunately, the only working version of ptyprocess (0.5.1) on macOS is only available on outdated python versions in conda-forge.

```
ptyprocess                     0.5.1          py27_0  conda-forge         
ptyprocess                     0.5.1          py34_0  conda-forge         
ptyprocess                     0.5.1          py35_0  conda-forge         
ptyprocess                     0.5.1          py36_0  conda-forge         
```



---

archive/issue_comments_493828.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84\"><code>6f9a2d0</code></a></td><td><code>src/setup.cfg.m4: Add ptyprocess to install-requires to get version constraint</code></td></tr></table>\n",
    "created_at": "2022-03-17T23:09:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493828",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84"><code>6f9a2d0</code></a></td><td><code>src/setup.cfg.m4: Add ptyprocess to install-requires to get version constraint</code></td></tr></table>




---

archive/issue_comments_493829.json:
```json
{
    "body": "Changed commit from **[`b431edb`](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)** to **[`6f9a2d0`](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)**",
    "created_at": "2022-03-17T23:09:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493829",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b431edb`](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)** to **[`6f9a2d0`](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)**



---

archive/issue_comments_493830.json:
```json
{
    "body": "<div id=\"comment:295\" align=\"right\">comment:295</div>\n\nReplying to [@tobiasdiez](#comment:290):\n> Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.\n\nThanks, yes, but the pipeline is pretty clogged",
    "created_at": "2022-03-17T23:23:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493830",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:295" align="right">comment:295</div>

Replying to [@tobiasdiez](#comment:290):
> Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.

Thanks, yes, but the pipeline is pretty clogged



---

archive/issue_comments_493831.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4\"><code>4de700d</code></a></td><td><code>.github/workflows/ci-conda.yml: Update ::remove-matcher</code></td></tr></table>\n",
    "created_at": "2022-03-17T23:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493831",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4"><code>4de700d</code></a></td><td><code>.github/workflows/ci-conda.yml: Update ::remove-matcher</code></td></tr></table>




---

archive/issue_comments_493832.json:
```json
{
    "body": "Changed commit from **[`6f9a2d0`](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)** to **[`4de700d`](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)**",
    "created_at": "2022-03-17T23:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493832",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6f9a2d0`](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)** to **[`4de700d`](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)**



---

archive/issue_comments_493833.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634** to **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113**",
    "created_at": "2022-03-17T23:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493833",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634** to **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113**



---

archive/issue_comments_493834.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe other failures on macOS are very minor.",
    "created_at": "2022-03-17T23:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493834",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

The other failures on macOS are very minor.



---

archive/issue_comments_493835.json:
```json
{
    "body": "<div id=\"comment:299\" align=\"right\">comment:299</div>\n\nReplying to [@mkoeppe](#comment:258):\n> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion\n\nThis failure on Linux is the remaining big issue.",
    "created_at": "2022-03-17T23:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493835",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:299" align="right">comment:299</div>

Replying to [@mkoeppe](#comment:258):
> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion

This failure on Linux is the remaining big issue.



---

archive/issue_comments_493836.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\n(The log of these runs is about 250 MB uncompressed, not fun to look at.)",
    "created_at": "2022-03-17T23:43:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493836",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">comment:0</div>

(The log of these runs is about 250 MB uncompressed, not fun to look at.)



---

archive/issue_comments_493837.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThere's also some cysignals-related breakage on Linux:\n\n```\n2022-03-17T21:25:16.4730359Z **********************************************************************\n2022-03-17T21:25:16.4812929Z File \"src/sage/functions/min_max.py\", line 240, in sage.functions.min_max.MaxSymbolic._evalf_\n2022-03-17T21:25:16.4813319Z Failed example:\n2022-03-17T21:25:16.4813740Z     sig_on_count() # check sig_on/off pairings (virtual doctest)\n2022-03-17T21:25:16.4814033Z Expected:\n2022-03-17T21:25:16.4814224Z     0\n2022-03-17T21:25:16.4814414Z Got:\n2022-03-17T21:25:16.4814603Z     2947\n2022-03-17T21:25:16.4935843Z **********************************************************************\n```",
    "created_at": "2022-03-17T23:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493837",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

There's also some cysignals-related breakage on Linux:

```
2022-03-17T21:25:16.4730359Z **********************************************************************
2022-03-17T21:25:16.4812929Z File "src/sage/functions/min_max.py", line 240, in sage.functions.min_max.MaxSymbolic._evalf_
2022-03-17T21:25:16.4813319Z Failed example:
2022-03-17T21:25:16.4813740Z     sig_on_count() # check sig_on/off pairings (virtual doctest)
2022-03-17T21:25:16.4814033Z Expected:
2022-03-17T21:25:16.4814224Z     0
2022-03-17T21:25:16.4814414Z Got:
2022-03-17T21:25:16.4814603Z     2947
2022-03-17T21:25:16.4935843Z **********************************************************************
```



---

archive/issue_comments_493838.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\ngiac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29",
    "created_at": "2022-03-18T06:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493838",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:2" align="right">comment:2</div>

giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29



---

archive/issue_comments_493839.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b508d1dcf7a04d7c56cfb4225be954f718225129\"><code>b508d1d</code></a></td><td><code>Cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294\"><code>93fce5a</code></a></td><td><code>Continue on error in config step</code></td></tr></table>\n",
    "created_at": "2022-03-18T08:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493839",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b508d1dcf7a04d7c56cfb4225be954f718225129"><code>b508d1d</code></a></td><td><code>Cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294"><code>93fce5a</code></a></td><td><code>Continue on error in config step</code></td></tr></table>




---

archive/issue_comments_493840.json:
```json
{
    "body": "Changed commit from **[`4de700d`](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)** to **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**",
    "created_at": "2022-03-18T08:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493840",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4de700d`](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)** to **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**



---

archive/issue_comments_493841.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nMost doctests are now passing, so this should be good to go now (leaving fixes to the other tests to follow-up tickets).",
    "created_at": "2022-03-18T08:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493841",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:4" align="right">comment:4</div>

Most doctests are now passing, so this should be good to go now (leaving fixes to the other tests to follow-up tickets).



---

archive/issue_events_427545.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-18T08:59:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427545"
}
```



---

archive/issue_events_427546.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-18T08:59:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427546"
}
```



---

archive/issue_comments_493842.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n`continue-on-error` makes no sense because the unconfigured source tree cannot be tested.",
    "created_at": "2022-03-18T15:11:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493842",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

`continue-on-error` makes no sense because the unconfigured source tree cannot be tested.



---

archive/issue_comments_493843.json:
```json
{
    "body": "<div id=\"comment:306\" align=\"right\">comment:306</div>\n\nReplying to [@isuruf](#comment:302):\n> giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29\n\nThanks @isuruf, looking great.",
    "created_at": "2022-03-18T15:15:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493843",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:306" align="right">comment:306</div>

Replying to [@isuruf](#comment:302):
> giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29

Thanks @isuruf, looking great.



---

archive/issue_comments_493844.json:
```json
{
    "body": "<div id=\"comment:307\" align=\"right\">comment:307</div>\n\nReplying to [@mkoeppe](#comment:305):\n> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\nOther than that, it's in good shape now. Could someone review my changes please?",
    "created_at": "2022-03-18T15:20:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493844",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:307" align="right">comment:307</div>

Replying to [@mkoeppe](#comment:305):
> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

Other than that, it's in good shape now. Could someone review my changes please?



---

archive/issue_comments_493845.json:
```json
{
    "body": "<div id=\"comment:308\" align=\"right\">comment:308</div>\n\nReplying to [@mkoeppe](#comment:305):\n> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\nThat largely depends on the nature of the error. If the error in the config step is critical, then the build step will fail and no tests are run. Moreover, there is no harm in executing also the other steps, the workflow will still be displayed as failed due to the error in the config job. You just get a bit more information.",
    "created_at": "2022-03-18T15:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493845",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:308" align="right">comment:308</div>

Replying to [@mkoeppe](#comment:305):
> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

That largely depends on the nature of the error. If the error in the config step is critical, then the build step will fail and no tests are run. Moreover, there is no harm in executing also the other steps, the workflow will still be displayed as failed due to the error in the config job. You just get a bit more information.



---

archive/issue_comments_493846.json:
```json
{
    "body": "<div id=\"comment:309\" align=\"right\">comment:309</div>\n\nReplying to [@tobiasdiez](#comment:308):\n> Replying to [@mkoeppe](#comment:305):\n> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> \n> That largely depends on the nature of the error. \n\nNo, it doesn't. On error, the generated files are not generated.",
    "created_at": "2022-03-18T15:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493846",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:309" align="right">comment:309</div>

Replying to [@tobiasdiez](#comment:308):
> Replying to [@mkoeppe](#comment:305):
> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> 
> That largely depends on the nature of the error. 

No, it doesn't. On error, the generated files are not generated.



---

archive/issue_comments_493847.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113** to **Matthias Koeppe, Dima Pasechnik, Tobias Diez**",
    "created_at": "2022-03-18T15:48:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493847",
    "user": "https://github.com/tobiasdiez"
}
```

Changed reviewer from **Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113** to **Matthias Koeppe, Dima Pasechnik, Tobias Diez**



---

archive/issue_comments_493848.json:
```json
{
    "body": "<div id=\"comment:310\" align=\"right\">comment:310</div>\n\nReplying to [@mkoeppe](#comment:307):\n> Replying to [@mkoeppe](#comment:305):\n> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> \n> Other than that, it's in good shape now. Could someone review my changes please?\n\nI'm fine with these changes (although they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow; but lets not be overly pedantic).",
    "created_at": "2022-03-18T15:48:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493848",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:310" align="right">comment:310</div>

Replying to [@mkoeppe](#comment:307):
> Replying to [@mkoeppe](#comment:305):
> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> 
> Other than that, it's in good shape now. Could someone review my changes please?

I'm fine with these changes (although they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow; but lets not be overly pedantic).



---

archive/issue_events_427547.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T15:57:43Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "title_is": "Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow",
    "title_was": "GH Actions: Add test for conda without SPKG",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427547"
}
```



---

archive/issue_comments_493849.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,11 +4,7 @@\n \n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n-During the work on this issue the following issues have been detected:\n-- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n-- Migrate documentation from wiki to developer docs\n-- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n-- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n+Fixes:\n - #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n@@ -23,4 +19,5 @@\n ```\n - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n-Fixing these problems will be addressed in a follow-up ticket.\n+Follow-ups: See Meta-ticket #33331\n+\n``````\n",
    "created_at": "2022-03-18T16:04:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493849",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,11 +4,7 @@
 
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
-During the work on this issue the following issues have been detected:
-- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
-- Migrate documentation from wiki to developer docs
-- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
-- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
+Fixes:
 - #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
@@ -23,4 +19,5 @@
 ```
 - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
-Fixing these problems will be addressed in a follow-up ticket.
+Follow-ups: See Meta-ticket #33331
+
``````




---

archive/issue_comments_493850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.\n+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.\n \n This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n \n``````\n",
    "created_at": "2022-03-18T16:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493850",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.
+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.
 
 This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)
 
``````




---

archive/issue_comments_493851.json:
```json
{
    "body": "<div id=\"comment:314\" align=\"right\">comment:314</div>\n\nReplying to [@mkoeppe](#comment:309):\n> Replying to [@tobiasdiez](#comment:308):\n> > Replying to [@mkoeppe](#comment:305):\n> > > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> > \n> > That largely depends on the nature of the error. \n\n> \n> No, it doesn't. On error, the generated files are not generated.\n\nI tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.",
    "created_at": "2022-03-18T16:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493851",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:314" align="right">comment:314</div>

Replying to [@mkoeppe](#comment:309):
> Replying to [@tobiasdiez](#comment:308):
> > Replying to [@mkoeppe](#comment:305):
> > > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> > 
> > That largely depends on the nature of the error. 

> 
> No, it doesn't. On error, the generated files are not generated.

I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.



---

archive/issue_comments_493852.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,6 +18,12 @@\n     compilation terminated.\n ```\n - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n+- Disable conda distro information for `gdb` because it is broken on macOS.\n+- Add conda distro information for `lrcalc_python`\n+- Filter out conda-specific `ld` warnings in doctests\n+- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed\n+- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires\n+\n \n Follow-ups: See Meta-ticket #33331\n \n``````\n",
    "created_at": "2022-03-18T16:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493852",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,6 +18,12 @@
     compilation terminated.
 ```
 - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
+- Disable conda distro information for `gdb` because it is broken on macOS.
+- Add conda distro information for `lrcalc_python`
+- Filter out conda-specific `ld` warnings in doctests
+- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed
+- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires
+
 
 Follow-ups: See Meta-ticket #33331
 
``````




---

archive/issue_comments_493853.json:
```json
{
    "body": "<div id=\"comment:316\" align=\"right\">comment:316</div>\n\nReplying to [@tobiasdiez](#comment:314):\n> I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.\n\nYou are right.",
    "created_at": "2022-03-18T16:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493853",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:316" align="right">comment:316</div>

Replying to [@tobiasdiez](#comment:314):
> I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.

You are right.



---

archive/issue_comments_493854.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nNevertheless, `continue-on-error` makes no sense as I have explained throughout the thread, [comment:141](#comment:141) etc.",
    "created_at": "2022-03-18T16:20:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493854",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Nevertheless, `continue-on-error` makes no sense as I have explained throughout the thread, [comment:141](#comment:141) etc.



---

archive/issue_events_427548.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:33:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427548"
}
```



---

archive/issue_events_427549.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:33:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427549"
}
```



---

archive/issue_comments_493855.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBut it's fine for now, let's see that we can get it merged in 9.6.",
    "created_at": "2022-03-18T16:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493855",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

But it's fine for now, let's see that we can get it merged in 9.6.



---

archive/issue_comments_493856.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOnward to documenting it, #33426?",
    "created_at": "2022-03-18T16:34:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493856",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Onward to documenting it, #33426?



---

archive/issue_events_427550.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:39:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427550"
}
```



---

archive/issue_events_427551.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:39:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427551"
}
```



---

archive/issue_comments_493857.json:
```json
{
    "body": "<div id=\"comment:321\" align=\"right\">comment:321</div>\n\nReplying to [@tobiasdiez](#comment:310):\n> they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow\n\nYes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.\n\nSometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.\n\nBut sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - \"what does it test\"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage.",
    "created_at": "2022-03-18T16:55:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493857",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:321" align="right">comment:321</div>

Replying to [@tobiasdiez](#comment:310):
> they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow

Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.

Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.

But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - "what does it test"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage.



---

archive/issue_comments_493858.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nSome of the test suite failures that we saw are from ipython 8.x; #33170 updates the doctests",
    "created_at": "2022-03-18T21:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493858",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Some of the test suite failures that we saw are from ipython 8.x; #33170 updates the doctests



---

archive/issue_comments_493859.json:
```json
{
    "body": "<div id=\"comment:323\" align=\"right\">comment:323</div>\n\nReplying to [@mkoeppe](#comment:318):\n> But it's fine for now, let's see that we can get it merged in 9.6.\n\nThanks for the review!",
    "created_at": "2022-03-18T22:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493859",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:323" align="right">comment:323</div>

Replying to [@mkoeppe](#comment:318):
> But it's fine for now, let's see that we can get it merged in 9.6.

Thanks for the review!



---

archive/issue_comments_493860.json:
```json
{
    "body": "<div id=\"comment:324\" align=\"right\">comment:324</div>\n\nReplying to [@mkoeppe](#comment:319):\n> Onward to documenting it, #33426?\n\nYes!",
    "created_at": "2022-03-18T22:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493860",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:324" align="right">comment:324</div>

Replying to [@mkoeppe](#comment:319):
> Onward to documenting it, #33426?

Yes!



---

archive/issue_comments_493861.json:
```json
{
    "body": "<div id=\"comment:325\" align=\"right\">comment:325</div>\n\nReplying to [@mkoeppe](#comment:321):\n> Replying to [@tobiasdiez](#comment:310):\n> > they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow\n\n> \n> Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.\n> \n> Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.\n> \n> But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - \"what does it test\"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage. \n\nIn general I agree that a ticket has to have a clear scope and improvement. For this ticket here, the github workflow essentially didn't change in the past 4 weeks, and at this point it was already clear that the workflow works in principle, with the caveat that a lot of docstests failed. In my opinion, it would have been better to merge the ticket already (with the few additional improvements to the workflow that we have discussed), then follow-up tickets could have easily improved different aspects of the conda environment, while the previous runs of the ci would have served as a baseline. Even thinks like the addition of the tests for macos could have been small follow-up tickets. I really think the tendency of the sage developers to create a lot of parallel, inter-dependent tickets makes reviewing harder and slows down the process. A more linear approach would increase the dev experience and velocity in my opinion.\n\nAnyway, I'm happy that this ticket is finally ready to be merged.",
    "created_at": "2022-03-18T22:27:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493861",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:325" align="right">comment:325</div>

Replying to [@mkoeppe](#comment:321):
> Replying to [@tobiasdiez](#comment:310):
> > they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow

> 
> Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.
> 
> Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.
> 
> But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - "what does it test"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage. 

In general I agree that a ticket has to have a clear scope and improvement. For this ticket here, the github workflow essentially didn't change in the past 4 weeks, and at this point it was already clear that the workflow works in principle, with the caveat that a lot of docstests failed. In my opinion, it would have been better to merge the ticket already (with the few additional improvements to the workflow that we have discussed), then follow-up tickets could have easily improved different aspects of the conda environment, while the previous runs of the ci would have served as a baseline. Even thinks like the addition of the tests for macos could have been small follow-up tickets. I really think the tendency of the sage developers to create a lot of parallel, inter-dependent tickets makes reviewing harder and slows down the process. A more linear approach would increase the dev experience and velocity in my opinion.

Anyway, I'm happy that this ticket is finally ready to be merged.



---

archive/issue_comments_493862.json:
```json
{
    "body": "<div id=\"comment:326\" align=\"right\">comment:326</div>\n\nReplying to [@tobiasdiez](#comment:325):\n> it was already clear that the workflow works in principle\n\nThe project generally uses a standard for tickets higher than that.\nYes, there's a tradeoff between velocity and stability.",
    "created_at": "2022-03-18T22:53:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493862",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:326" align="right">comment:326</div>

Replying to [@tobiasdiez](#comment:325):
> it was already clear that the workflow works in principle

The project generally uses a standard for tickets higher than that.
Yes, there's a tradeoff between velocity and stability.



---

archive/issue_comments_493863.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIs there a ticket for the remaining failures after this ticket?",
    "created_at": "2022-03-21T07:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493863",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:7" align="right">comment:7</div>

Is there a ticket for the remaining failures after this ticket?



---

archive/issue_comments_493864.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nYes, they are collected in #33331.",
    "created_at": "2022-03-21T10:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493864",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:8" align="right">comment:8</div>

Yes, they are collected in #33331.



---

archive/issue_events_427552.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-27T15:44:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427552"
}
```



---

archive/issue_events_427553.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6dbf0930e703352dc29f808f3d78c5385bbc74f8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-03-27T15:44:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-427553"
}
```



---

archive/issue_comments_493865.json:
```json
{
    "body": "Changed branch from **[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)** to **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**",
    "created_at": "2022-03-27T15:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-493865",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)** to **[`93fce5a`](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)**
