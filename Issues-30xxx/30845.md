# Issue 30845: Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow

archive/issues_030608.json:
```json
{
    "body": "Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.\n\nThis also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n\nRun: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n\nFixes:\n- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n- environment-optional: lcalc 1 is installed and then not recognized / leads to error\n\n```\nbuilding 'sage.libs.lcalc.lcalc_Lfunction' extension\n    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n        1 | #include \"lcalc/L.h\"\n          |          ^~~~~~~~~~~\n    compilation terminated.\n```\n- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n- Disable conda distro information for `gdb` because it is broken on macOS.\n- Add conda distro information for `lrcalc_python`\n- Filter out conda-specific `ld` warnings in doctests\n- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed\n- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires\n\n\nFollow-ups: See Meta-ticket #33331\n\n\nDepends on #33358\n\nDepends on #33330\n\nDepends on #33361\n\nDepends on #33141\n\n**CC:**  @isuruf @tobiasdiez @dimpase @saraedum\n\n**Keywords:** sd111\n\n**Branch/Commit:** [93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)\n\n**Reviewer:** Matthias Koeppe, Dima Pasechnik, Tobias Diez\n\n**Author:** Tobias Diez, Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/30845\n\n",
    "closed_at": "2022-03-27T15:44:10Z",
    "created_at": "2020-11-01T18:57:38Z",
    "labels": [
        "component: build",
        "critical",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "title": "Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/30845",
    "user": "https://github.com/mkoeppe"
}
```
Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.

This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)

Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml

Fixes:
- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
- environment-optional: lcalc 1 is installed and then not recognized / leads to error

```
building 'sage.libs.lcalc.lcalc_Lfunction' extension
    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
        1 | #include "lcalc/L.h"
          |          ^~~~~~~~~~~
    compilation terminated.
```
- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
- Disable conda distro information for `gdb` because it is broken on macOS.
- Add conda distro information for `lrcalc_python`
- Filter out conda-specific `ld` warnings in doctests
- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed
- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires


Follow-ups: See Meta-ticket #33331


Depends on #33358

Depends on #33330

Depends on #33361

Depends on #33141

**CC:**  @isuruf @tobiasdiez @dimpase @saraedum

**Keywords:** sd111

**Branch/Commit:** [93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)

**Reviewer:** Matthias Koeppe, Dima Pasechnik, Tobias Diez

**Author:** Tobias Diez, Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/30845





---

archive/issue_events_276548.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-03T01:17:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "rename": {
        "from": "GH Actions: Add test for conda without SPKG",
        "to": "tox.ini, GH Actions: Add test for conda without SPKG"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276548"
}
```



---

archive/issue_comments_496326.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n+This would also test that the generated `environment*.yml` files work correctly.\n \n``````\n",
    "created_at": "2020-11-26T21:46:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496326",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,2 @@
+This would also test that the generated `environment*.yml` files work correctly.
 
``````




---

archive/issue_comments_496327.json:
```json
{
    "body": "<a id='comment:3'></a>\nHoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496327",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_comments_496328.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd111\".",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496328",
    "user": "https://github.com/mkoeppe"
}
```

**Changing keywords** from "" to "sd111".



---

archive/issue_comments_496329.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1 @@\n-This would also test that the generated `environment*.yml` files work correctly.\n-\n+This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2020-12-21T23:19:48Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496329",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1 @@
-This would also test that the generated `environment*.yml` files work correctly.
-
+This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_comments_496330.json:
```json
{
    "body": "<a id='comment:7'></a>\nSomething like https://github.com/tobiasdiez/sage/blob/public/build/conda_gh/.github/workflows/ci-conda.yml?\n\nThis currently fails with\n\n```\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: creating build/pkgs/sage_conf/src/sage_conf.py\nconfig.status: creating build/pkgs/sage_conf/src/setup.cfg\nconfig.status: executing depfiles commands\nconfig.status: executing mkdirs commands\nconfig.status: creating directory /home/runner/work/sage/sage/logs/pkgs\nconfig.status: creating directory \nmkdir: cannot create directory '': No such file or directory\nconfig.status: error: could not create \nError: Process completed with exit code 1.\n```\nhttps://github.com/tobiasdiez/sage/runs/1594237745?check_suite_focus=true\nAny idea what could be the reason and how to fix it?",
    "created_at": "2020-12-22T10:44:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496330",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:7'></a>
Something like https://github.com/tobiasdiez/sage/blob/public/build/conda_gh/.github/workflows/ci-conda.yml?

This currently fails with

```
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: creating build/pkgs/sage_conf/src/sage_conf.py
config.status: creating build/pkgs/sage_conf/src/setup.cfg
config.status: executing depfiles commands
config.status: executing mkdirs commands
config.status: creating directory /home/runner/work/sage/sage/logs/pkgs
config.status: creating directory 
mkdir: cannot create directory '': No such file or directory
config.status: error: could not create 
Error: Process completed with exit code 1.
```
https://github.com/tobiasdiez/sage/runs/1594237745?check_suite_focus=true
Any idea what could be the reason and how to fix it?



---

archive/issue_comments_496331.json:
```json
{
    "body": "**Commit:** [9af4614153be945d5e56e2ffc7cdddaece705f76](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)",
    "created_at": "2020-12-22T10:46:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496331",
    "user": "https://github.com/tobiasdiez"
}
```

**Commit:** [9af4614153be945d5e56e2ffc7cdddaece705f76](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)



---

archive/issue_comments_496332.json:
```json
{
    "body": "**Author:** Tobias Diez",
    "created_at": "2020-12-22T10:46:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496332",
    "user": "https://github.com/tobiasdiez"
}
```

**Author:** Tobias Diez



---

archive/issue_comments_496333.json:
```json
{
    "body": "<a id='comment:8'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c68d2624a0c205447fa19b88cc392673e445f691\">c68d262</a></td><td><code>Add first version of workflow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76\">9af4614</a></td><td><code>Try with sudo (why is this needed now?!)</code></td></tr></table>\n",
    "created_at": "2020-12-22T10:46:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496333",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c68d2624a0c205447fa19b88cc392673e445f691">c68d262</a></td><td><code>Add first version of workflow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76">9af4614</a></td><td><code>Try with sudo (why is this needed now?!)</code></td></tr></table>




---

archive/issue_comments_496334.json:
```json
{
    "body": "**Branch:** [public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)",
    "created_at": "2020-12-22T10:46:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496334",
    "user": "https://github.com/tobiasdiez"
}
```

**Branch:** [public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)



---

archive/issue_comments_496335.json:
```json
{
    "body": "**Changing commit** from \"[9af4614153be945d5e56e2ffc7cdddaece705f76](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)\" to \"[a178b56349e645e6120832b0945a9a0e80327ce4](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)\".",
    "created_at": "2020-12-22T11:14:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9af4614153be945d5e56e2ffc7cdddaece705f76](https://github.com/sagemath/sagetrac-mirror/commit/9af4614153be945d5e56e2ffc7cdddaece705f76)" to "[a178b56349e645e6120832b0945a9a0e80327ce4](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)".



---

archive/issue_comments_496336.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ac74ee21958bb9534f9b8abb7983583f911ec70\">5ac74ee</a></td><td><code>Try with conda-incubator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4\">a178b56</a></td><td><code>Run in the conda shell</code></td></tr></table>\n",
    "created_at": "2020-12-22T11:14:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ac74ee21958bb9534f9b8abb7983583f911ec70">5ac74ee</a></td><td><code>Try with conda-incubator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4">a178b56</a></td><td><code>Run in the conda shell</code></td></tr></table>




---

archive/issue_comments_496337.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/199886cd5530d27e3c098fc06ccdc4748ae28431\">199886c</a></td><td><code>Install more conda dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10de3f5dc6566bdba49d5fe1ce5626d3ce516c28\">10de3f5</a></td><td><code>Fix conda env name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e\">86411b8</a></td><td><code>Remove unnececesary install of conda dep</code></td></tr></table>\n",
    "created_at": "2020-12-22T11:57:25Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496337",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/199886cd5530d27e3c098fc06ccdc4748ae28431">199886c</a></td><td><code>Install more conda dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10de3f5dc6566bdba49d5fe1ce5626d3ce516c28">10de3f5</a></td><td><code>Fix conda env name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e">86411b8</a></td><td><code>Remove unnececesary install of conda dep</code></td></tr></table>




---

archive/issue_comments_496338.json:
```json
{
    "body": "**Changing commit** from \"[a178b56349e645e6120832b0945a9a0e80327ce4](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)\" to \"[86411b841fb32b1ced8d4c8989d2f30703448c2e](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)\".",
    "created_at": "2020-12-22T11:57:25Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496338",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a178b56349e645e6120832b0945a9a0e80327ce4](https://github.com/sagemath/sagetrac-mirror/commit/a178b56349e645e6120832b0945a9a0e80327ce4)" to "[86411b841fb32b1ced8d4c8989d2f30703448c2e](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)".



---

archive/issue_comments_496339.json:
```json
{
    "body": "<a id='comment:11'></a>\nManaged to fix the above error, just to be stuck two lines further down:\n\n```\nconfigure: creating ./config.status\nconfig.status: creating build/make/Makefile-auto\nconfig.status: creating build/make/Makefile\nconfig.status: creating src/bin/sage-env-config\nconfig.status: creating src/bin/sage-src-env-config\nconfig.status: creating build/bin/sage-build-env-config\nconfig.status: creating build/pkgs/sage_conf/src/sage_conf.py\nconfig.status: creating build/pkgs/sage_conf/src/setup.cfg\nconfig.status: executing depfiles commands\nconfig.status: executing broken-gcc commands\nconfig.status: executing mkdirs commands\nconfig.status: creating directory /home/runner/work/sage/sage/logs/pkgs\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/bin\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/etc\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/include\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/lib\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/lib/pkgconfig\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/share\nconfig.status: creating directory /usr/share/miniconda/envs/sage-build/var/lib/sage/installed\nconfig.status: error: Cannot perform incremental update, run \"make distclean && make\"\nconfig.status: /usr/share/miniconda/envs/sage-build/lib64 is not a symlink, see Trac #19782\nError: Process completed with exit code 1.\n```\nhttps://github.com/tobiasdiez/sage/runs/1594601374?check_suite_focus=true",
    "created_at": "2020-12-22T11:58:14Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496339",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:11'></a>
Managed to fix the above error, just to be stuck two lines further down:

```
configure: creating ./config.status
config.status: creating build/make/Makefile-auto
config.status: creating build/make/Makefile
config.status: creating src/bin/sage-env-config
config.status: creating src/bin/sage-src-env-config
config.status: creating build/bin/sage-build-env-config
config.status: creating build/pkgs/sage_conf/src/sage_conf.py
config.status: creating build/pkgs/sage_conf/src/setup.cfg
config.status: executing depfiles commands
config.status: executing broken-gcc commands
config.status: executing mkdirs commands
config.status: creating directory /home/runner/work/sage/sage/logs/pkgs
config.status: creating directory /usr/share/miniconda/envs/sage-build
config.status: creating directory /usr/share/miniconda/envs/sage-build/bin
config.status: creating directory /usr/share/miniconda/envs/sage-build/etc
config.status: creating directory /usr/share/miniconda/envs/sage-build/include
config.status: creating directory /usr/share/miniconda/envs/sage-build/lib
config.status: creating directory /usr/share/miniconda/envs/sage-build/lib/pkgconfig
config.status: creating directory /usr/share/miniconda/envs/sage-build/share
config.status: creating directory /usr/share/miniconda/envs/sage-build/var/lib/sage/installed
config.status: error: Cannot perform incremental update, run "make distclean && make"
config.status: /usr/share/miniconda/envs/sage-build/lib64 is not a symlink, see Trac #19782
Error: Process completed with exit code 1.
```
https://github.com/tobiasdiez/sage/runs/1594601374?check_suite_focus=true



---

archive/issue_comments_496340.json:
```json
{
    "body": "<a id='comment:12'></a>\nFound a hack that fixed it by removing the lib64 folder. It only contained `libcc1.so` (not sure where/how this is needed).",
    "created_at": "2020-12-22T12:22:06Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496340",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:12'></a>
Found a hack that fixed it by removing the lib64 folder. It only contained `libcc1.so` (not sure where/how this is needed).



---

archive/issue_comments_496341.json:
```json
{
    "body": "<a id='comment:13'></a>\nMade a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because \"sage-env-config\" doesn't exist.\nhttps://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true",
    "created_at": "2020-12-22T13:18:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496341",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:13'></a>
Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because "sage-env-config" doesn't exist.
https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true



---

archive/issue_comments_496342.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53503dc53801cb0be1e48359358013e6508df692\">53503dc</a></td><td><code>Try remove lib64 folder by hand</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e530ac0752fe4109f2f2f4ad853741b3577ee3b2\">e530ac0</a></td><td><code>Add c++ compiler to conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab47f5e52e705948e331b39790c1c4595288425c\">ab47f5e</a></td><td><code>Install directly on top of conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af\">741c55a</a></td><td><code>Make autogen work</code></td></tr></table>\n",
    "created_at": "2020-12-22T13:37:20Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53503dc53801cb0be1e48359358013e6508df692">53503dc</a></td><td><code>Try remove lib64 folder by hand</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e530ac0752fe4109f2f2f4ad853741b3577ee3b2">e530ac0</a></td><td><code>Add c++ compiler to conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab47f5e52e705948e331b39790c1c4595288425c">ab47f5e</a></td><td><code>Install directly on top of conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af">741c55a</a></td><td><code>Make autogen work</code></td></tr></table>




---

archive/issue_comments_496343.json:
```json
{
    "body": "**Changing commit** from \"[86411b841fb32b1ced8d4c8989d2f30703448c2e](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)\" to \"[741c55abee6e1cc125b16f62d56fc865982c01af](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)\".",
    "created_at": "2020-12-22T13:37:20Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496343",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[86411b841fb32b1ced8d4c8989d2f30703448c2e](https://github.com/sagemath/sagetrac-mirror/commit/86411b841fb32b1ced8d4c8989d2f30703448c2e)" to "[741c55abee6e1cc125b16f62d56fc865982c01af](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)".



---

archive/issue_comments_496344.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe `direct` variant should use `src/environment.yml` - which installs the Python packages of Sage in addition to what is listed in `environment.yml`",
    "created_at": "2020-12-22T14:43:24Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496344",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
The `direct` variant should use `src/environment.yml` - which installs the Python packages of Sage in addition to what is listed in `environment.yml`



---

archive/issue_comments_496345.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe `lib64` looks like a conda packaging bug to me - @isuruf, can you help?",
    "created_at": "2020-12-22T14:44:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496345",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
The `lib64` looks like a conda packaging bug to me - @isuruf, can you help?



---

archive/issue_comments_496346.json:
```json
{
    "body": "<a id='comment:17'></a>\n`environment.yml` already includes `compilers` -- I don't think adding `cxx-compiler` should be necessary",
    "created_at": "2020-12-22T14:45:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496346",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
`environment.yml` already includes `compilers` -- I don't think adding `cxx-compiler` should be necessary



---

archive/issue_comments_496347.json:
```json
{
    "body": "**Changing commit** from \"[741c55abee6e1cc125b16f62d56fc865982c01af](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)\" to \"[3aba04885446291cb840e46712084185a5812eb1](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)\".",
    "created_at": "2020-12-22T14:47:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496347",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[741c55abee6e1cc125b16f62d56fc865982c01af](https://github.com/sagemath/sagetrac-mirror/commit/741c55abee6e1cc125b16f62d56fc865982c01af)" to "[3aba04885446291cb840e46712084185a5812eb1](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)".



---

archive/issue_comments_496348.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1231a24a021c9a760696063d532f5b569f751fd3\">1231a24</a></td><td><code>Add env logging and fix SAGE_SRC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be024f8b783ff59403ea96c330b56c84718d4c52\">be024f8</a></td><td><code>Fix build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a46d049ef169be7b13dc7c5b7e06fdfbf4326b4\">8a46d04</a></td><td><code>Improve output of print_env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9802c56b11d65e099d2b20c8afa790d70cb4fd2c\">9802c56</a></td><td><code>Improve print statement</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1\">3aba048</a></td><td><code>Use correct conda env file</code></td></tr></table>\n",
    "created_at": "2020-12-22T14:47:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496348",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1231a24a021c9a760696063d532f5b569f751fd3">1231a24</a></td><td><code>Add env logging and fix SAGE_SRC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be024f8b783ff59403ea96c330b56c84718d4c52">be024f8</a></td><td><code>Fix build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a46d049ef169be7b13dc7c5b7e06fdfbf4326b4">8a46d04</a></td><td><code>Improve output of print_env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9802c56b11d65e099d2b20c8afa790d70cb4fd2c">9802c56</a></td><td><code>Improve print statement</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1">3aba048</a></td><td><code>Use correct conda env file</code></td></tr></table>




---

archive/issue_comments_496349.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [gh-tobiasdiez](#comment%3A13):\n> Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because \"sage-env-config\" doesn't exist.\n> https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true\n\n\nThis is now #31097.",
    "created_at": "2020-12-22T15:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496349",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Replying to [gh-tobiasdiez](#comment%3A13):
> Made a bit more progress, but it currently errors while compiling gcc. Moreover, there is a problem in the detection of the conda/system gcc because "sage-env-config" doesn't exist.
> https://github.com/tobiasdiez/sage/runs/1594867631?check_suite_focus=true


This is now #31097.



---

archive/issue_comments_496350.json:
```json
{
    "body": "**Changing dependencies** from \"#28745\" to \"#31097\".",
    "created_at": "2020-12-22T15:02:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496350",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#28745" to "#31097".



---

archive/issue_comments_496351.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2020-12-22T16:10:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496351",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-This would also test that the generated `environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_comments_496352.json:
```json
{
    "body": "<a id='comment:22'></a>\nI don't see a `lib64` folder. Which package is that coming from?",
    "created_at": "2020-12-22T16:19:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496352",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:22'></a>
I don't see a `lib64` folder. Which package is that coming from?



---

archive/issue_comments_496353.json:
```json
{
    "body": "<a id='comment:23'></a>\nIt contains `libcc1.so` so I guess gcc, g++ or some other compiler package.",
    "created_at": "2020-12-22T16:40:59Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496353",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:23'></a>
It contains `libcc1.so` so I guess gcc, g++ or some other compiler package.



---

archive/issue_comments_496354.json:
```json
{
    "body": "**Changing commit** from \"[3aba04885446291cb840e46712084185a5812eb1](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)\" to \"[e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)\".",
    "created_at": "2020-12-22T18:01:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3aba04885446291cb840e46712084185a5812eb1](https://github.com/sagemath/sagetrac-mirror/commit/3aba04885446291cb840e46712084185a5812eb1)" to "[e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)".



---

archive/issue_comments_496355.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d853f145528c3380b2c276c7e49f102beefa3b36\">d853f14</a></td><td><code>Ok, then install setup.py relative to src</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb5e2847fadc4410371250f81fc4ab083188c475\">cb5e284</a></td><td><code>Add tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cf3de4add77b367da7a7935dbe1c3cb90ab51e8\">1cf3de4</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Fix SAGE_BROKEN_GCC test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bc9c291355f9f549baeb780864573e35b21160c\">1bc9c29</a></td><td><code>Merge branch 'u/mkoeppe/build_pkgs_gcc_spkg_configure_m4__fix_sage_broken_gcc_test' of git://trac.sagemath.org/sage into public/build/conda_gh</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c57d6156cbfd943b6724434293fa205ca531d38b\">c57d615</a></td><td><code>Correct bootstrap command</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e85f1ba51d8bb4a60e096491aefec9f5f4407e75\">e85f1ba</a></td><td><code>Fix venv config</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e29a9ab119e8254cb95e36c47499f237c2c58f1b\">e29a9ab</a></td><td><code>Correct test command</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/483de62f8d29536ec04fca70d04d350dfb5ccf1a\">483de62</a></td><td><code>Install autotools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8237b2cfb4369a374466aff1a97f497418a42180\">8237b2c</a></td><td><code>Install gettext</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9\">e9cb77b</a></td><td><code>Force configure to not install gcc</code></td></tr></table>\n",
    "created_at": "2020-12-22T18:01:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496355",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d853f145528c3380b2c276c7e49f102beefa3b36">d853f14</a></td><td><code>Ok, then install setup.py relative to src</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb5e2847fadc4410371250f81fc4ab083188c475">cb5e284</a></td><td><code>Add tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cf3de4add77b367da7a7935dbe1c3cb90ab51e8">1cf3de4</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Fix SAGE_BROKEN_GCC test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bc9c291355f9f549baeb780864573e35b21160c">1bc9c29</a></td><td><code>Merge branch 'u/mkoeppe/build_pkgs_gcc_spkg_configure_m4__fix_sage_broken_gcc_test' of git://trac.sagemath.org/sage into public/build/conda_gh</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c57d6156cbfd943b6724434293fa205ca531d38b">c57d615</a></td><td><code>Correct bootstrap command</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e85f1ba51d8bb4a60e096491aefec9f5f4407e75">e85f1ba</a></td><td><code>Fix venv config</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e29a9ab119e8254cb95e36c47499f237c2c58f1b">e29a9ab</a></td><td><code>Correct test command</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/483de62f8d29536ec04fca70d04d350dfb5ccf1a">483de62</a></td><td><code>Install autotools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8237b2cfb4369a374466aff1a97f497418a42180">8237b2c</a></td><td><code>Install gettext</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9">e9cb77b</a></td><td><code>Force configure to not install gcc</code></td></tr></table>




---

archive/issue_comments_496356.json:
```json
{
    "body": "<a id='comment:25'></a>\nCurrent status:\n- Building sage using `make` on top of conda fails, since gcc is not found and the custom build of gcc fails.\n- Installing sagelib on top of a conda works, but many doctests fail.\n\nhttps://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22\n\nI let somebody else with more experience in conda/the intricacies of sage's build system take over from here.",
    "created_at": "2020-12-22T18:06:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496356",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:25'></a>
Current status:
- Building sage using `make` on top of conda fails, since gcc is not found and the custom build of gcc fails.
- Installing sagelib on top of a conda works, but many doctests fail.

https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22

I let somebody else with more experience in conda/the intricacies of sage's build system take over from here.



---

archive/issue_comments_496357.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks for getting this started!",
    "created_at": "2020-12-22T18:33:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496357",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Thanks for getting this started!



---

archive/issue_comments_496358.json:
```json
{
    "body": "<a id='comment:27'></a>\nUnfortunately the runs do not give the config.log",
    "created_at": "2020-12-22T18:43:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496358",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Unfortunately the runs do not give the config.log



---

archive/issue_comments_496359.json:
```json
{
    "body": "<a id='comment:28'></a>\nNow I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work.",
    "created_at": "2020-12-22T18:53:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496359",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work.



---

archive/issue_comments_496360.json:
```json
{
    "body": "**Changing commit** from \"[e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)\" to \"[9857e36640c22e9bf7f1d072f21dfa9cd1455449](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)\".",
    "created_at": "2020-12-22T21:12:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9](https://github.com/sagemath/sagetrac-mirror/commit/e9cb77b0c0755e08fc3c054f051d1ec1a9cd80d9)" to "[9857e36640c22e9bf7f1d072f21dfa9cd1455449](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)".



---

archive/issue_comments_496361.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449\">9857e36</a></td><td><code>Without the prefix</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:12:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449">9857e36</a></td><td><code>Without the prefix</code></td></tr></table>




---

archive/issue_comments_496362.json:
```json
{
    "body": "**Changing commit** from \"[9857e36640c22e9bf7f1d072f21dfa9cd1455449](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)\" to \"[b50ae6a7e2e4f80dafbb27785ce9345163875163](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)\".",
    "created_at": "2020-12-22T21:29:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9857e36640c22e9bf7f1d072f21dfa9cd1455449](https://github.com/sagemath/sagetrac-mirror/commit/9857e36640c22e9bf7f1d072f21dfa9cd1455449)" to "[b50ae6a7e2e4f80dafbb27785ce9345163875163](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)".



---

archive/issue_comments_496363.json:
```json
{
    "body": "<a id='comment:30'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163\">b50ae6a</a></td><td><code>Remove conda gcc distro again</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:29:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163">b50ae6a</a></td><td><code>Remove conda gcc distro again</code></td></tr></table>




---

archive/issue_comments_496364.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468\">68080fa</a></td><td><code>Cleanup workflow</code></td></tr></table>\n",
    "created_at": "2020-12-22T21:36:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468">68080fa</a></td><td><code>Cleanup workflow</code></td></tr></table>




---

archive/issue_comments_496365.json:
```json
{
    "body": "**Changing commit** from \"[b50ae6a7e2e4f80dafbb27785ce9345163875163](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)\" to \"[68080fa95aed35a35813bddb7f35fbc73a373468](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)\".",
    "created_at": "2020-12-22T21:36:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b50ae6a7e2e4f80dafbb27785ce9345163875163](https://github.com/sagemath/sagetrac-mirror/commit/b50ae6a7e2e4f80dafbb27785ce9345163875163)" to "[68080fa95aed35a35813bddb7f35fbc73a373468](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)".



---

archive/issue_comments_496366.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [mkoeppe](#comment%3A28):\n> Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work. \n\n\nThanks! Removing the prefix part indeed fixed the gcc issue. Now we are further in the build, and find this beautiful error:\n\n```\n2020-12-22T21:44:17.7966259Z [cvxopt-1.2.5]   x86_64-conda_cos6-linux-gnu-gcc -pthread -shared -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -L/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-rpath,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include build/temp.linux-x86_64-3.8/src/C/lapack.o -L/usr/share/miniconda/envs/sage-build/lib -lopenblas -lopenblas -o build/lib.linux-x86_64-3.8/cvxopt/lapack.cpython-38-x86_64-linux-gnu.so\n2020-12-22T21:44:17.7974135Z [cvxopt-1.2.5]   building 'umfpack' extension\n2020-12-22T21:44:17.7979362Z [cvxopt-1.2.5]   /usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include -fPIC -I/usr/include -I/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/include -I/usr/share/miniconda/envs/sage-build/include/python3.8 -c src/C/umfpack.c -o build/temp.linux-x86_64-3.8/src/C/umfpack.o\n2020-12-22T21:44:17.7990748Z [cvxopt-1.2.5]   In file included from /usr/share/miniconda/envs/sage-build/include/python3.8/Python.h:11:0,\n2020-12-22T21:44:17.7991831Z [cvxopt-1.2.5]                    from src/C/cvxopt.h:22,\n2020-12-22T21:44:17.7992613Z [cvxopt-1.2.5]                    from src/C/umfpack.c:22:\n2020-12-22T21:44:17.7993750Z [cvxopt-1.2.5]   /usr/include/limits.h:26:10: fatal error: bits/libc-header-start.h: No such file or directory\n2020-12-22T21:44:17.7994924Z [cvxopt-1.2.5]    #include <bits/libc-header-start.h>\n2020-12-22T21:44:17.7995741Z [cvxopt-1.2.5]             ^~~~~~~~~~~~~~~~~~~~~~~~~~\n2020-12-22T21:44:17.7996470Z [cvxopt-1.2.5]   compilation terminated.\n2020-12-22T21:44:17.7997728Z [cvxopt-1.2.5]   error: command '/usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc' failed with exit status 1\n2020-12-22T21:44:17.7999070Z [cvxopt-1.2.5]   Building wheel for cvxopt (setup.py): finished with status 'error'\n```\nCould this be related to the fact that libcc1 is installed in `lib64`?",
    "created_at": "2020-12-22T21:55:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496366",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:32'></a>
Replying to [mkoeppe](#comment%3A28):
> Now I finally realize that for `on-top-of-spkg` you were trying to do `./configure --prefix=$CONDA_PREFIX` -- that can't work. 


Thanks! Removing the prefix part indeed fixed the gcc issue. Now we are further in the build, and find this beautiful error:

```
2020-12-22T21:44:17.7966259Z [cvxopt-1.2.5]   x86_64-conda_cos6-linux-gnu-gcc -pthread -shared -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -L/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-rpath,/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/usr/share/miniconda/envs/sage-build/lib -Wl,-rpath-link,/usr/share/miniconda/envs/sage-build/lib -L/usr/share/miniconda/envs/sage-build/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include build/temp.linux-x86_64-3.8/src/C/lapack.o -L/usr/share/miniconda/envs/sage-build/lib -lopenblas -lopenblas -o build/lib.linux-x86_64-3.8/cvxopt/lapack.cpython-38-x86_64-linux-gnu.so
2020-12-22T21:44:17.7974135Z [cvxopt-1.2.5]   building 'umfpack' extension
2020-12-22T21:44:17.7979362Z [cvxopt-1.2.5]   /usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /usr/share/miniconda/envs/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /usr/share/miniconda/envs/sage-build/include -fPIC -I/usr/include -I/home/runner/work/sagetrac-mirror/sagetrac-mirror/local/include -I/usr/share/miniconda/envs/sage-build/include/python3.8 -c src/C/umfpack.c -o build/temp.linux-x86_64-3.8/src/C/umfpack.o
2020-12-22T21:44:17.7990748Z [cvxopt-1.2.5]   In file included from /usr/share/miniconda/envs/sage-build/include/python3.8/Python.h:11:0,
2020-12-22T21:44:17.7991831Z [cvxopt-1.2.5]                    from src/C/cvxopt.h:22,
2020-12-22T21:44:17.7992613Z [cvxopt-1.2.5]                    from src/C/umfpack.c:22:
2020-12-22T21:44:17.7993750Z [cvxopt-1.2.5]   /usr/include/limits.h:26:10: fatal error: bits/libc-header-start.h: No such file or directory
2020-12-22T21:44:17.7994924Z [cvxopt-1.2.5]    #include <bits/libc-header-start.h>
2020-12-22T21:44:17.7995741Z [cvxopt-1.2.5]             ^~~~~~~~~~~~~~~~~~~~~~~~~~
2020-12-22T21:44:17.7996470Z [cvxopt-1.2.5]   compilation terminated.
2020-12-22T21:44:17.7997728Z [cvxopt-1.2.5]   error: command '/usr/share/miniconda/envs/sage-build/bin/x86_64-conda-linux-gnu-cc' failed with exit status 1
2020-12-22T21:44:17.7999070Z [cvxopt-1.2.5]   Building wheel for cvxopt (setup.py): finished with status 'error'
```
Could this be related to the fact that libcc1 is installed in `lib64`?



---

archive/issue_comments_496367.json:
```json
{
    "body": "<a id='comment:33'></a>\nThis is known. #30710",
    "created_at": "2020-12-22T21:57:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496367",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:33'></a>
This is known. #30710



---

archive/issue_comments_496368.json:
```json
{
    "body": "<a id='comment:34'></a>\nAh thx for the pointer!",
    "created_at": "2020-12-22T22:03:32Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496368",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:34'></a>
Ah thx for the pointer!



---

archive/issue_comments_496369.json:
```json
{
    "body": "<a id='comment:35'></a>\nI guess the main objective of this ticket was to add a workflow verifying that sagelib installed on top of conda works. Since this is accomplished, I'll put it as ready for review.\n\nFixing the doctests and the build using `make` can be done later (e.g by resolving #30710).",
    "created_at": "2020-12-22T22:09:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496369",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:35'></a>
I guess the main objective of this ticket was to add a workflow verifying that sagelib installed on top of conda works. Since this is accomplished, I'll put it as ready for review.

Fixing the doctests and the build using `make` can be done later (e.g by resolving #30710).



---

archive/issue_events_276549.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-22T22:09:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276549"
}
```



---

archive/issue_comments_496370.json:
```json
{
    "body": "**Reviewer:** https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22",
    "created_at": "2020-12-22T22:09:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496370",
    "user": "https://github.com/tobiasdiez"
}
```

**Reviewer:** https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22



---

archive/issue_comments_496371.json:
```json
{
    "body": "<a id='comment:36'></a>\nAs `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.",
    "created_at": "2020-12-23T00:13:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496371",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>
As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.



---

archive/issue_comments_496372.json:
```json
{
    "body": "<a id='comment:37'></a>\nI have opened #31099 for this.",
    "created_at": "2020-12-23T00:22:23Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496372",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
I have opened #31099 for this.



---

archive/issue_comments_496373.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [mkoeppe](#comment%3A36):\n> As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.\n\n\nI thought about using tox as well, but there are\n\na) problems setting up conda on github actions (this is why the workflow uses a special action for the conda setup) \n\nb) difficulties with conda and tox environment interactions (which I guess are handled by the tox-conda plugin, but I didn't wanted to dive into this)\n\nc) I still think tox is not the right tool for managing the user's environment beyond the Python environment.",
    "created_at": "2020-12-23T11:25:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496373",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:38'></a>
Replying to [mkoeppe](#comment%3A36):
> As `on-top-of-spkg` turns out to be a variant of `local-conda-forge-ubuntu-standard`, I think I would want to implement this variant using tox.


I thought about using tox as well, but there are

a) problems setting up conda on github actions (this is why the workflow uses a special action for the conda setup) 

b) difficulties with conda and tox environment interactions (which I guess are handled by the tox-conda plugin, but I didn't wanted to dive into this)

c) I still think tox is not the right tool for managing the user's environment beyond the Python environment.



---

archive/issue_comments_496374.json:
```json
{
    "body": "<a id='comment:39'></a>\n`local-conda-forge-ubuntu-standard` has been running for months on GH Actions, see for example https://github.com/sagemath/sage/runs/1553907433 for 9.3.beta4.\n\n#31099 is just a matter of creating a variant that uses `conda env create -f environment.yml` instead of `conda install ...`.",
    "created_at": "2020-12-23T17:19:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496374",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
`local-conda-forge-ubuntu-standard` has been running for months on GH Actions, see for example https://github.com/sagemath/sage/runs/1553907433 for 9.3.beta4.

#31099 is just a matter of creating a variant that uses `conda env create -f environment.yml` instead of `conda install ...`.



---

archive/issue_comments_496375.json:
```json
{
    "body": "<a id='comment:40'></a>\nred branch => needs work",
    "created_at": "2021-01-31T20:01:29Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496375",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:40'></a>
red branch => needs work



---

archive/issue_events_276550.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-31T20:01:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276550"
}
```



---

archive/issue_events_276551.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-31T20:01:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276551"
}
```



---

archive/issue_events_276552.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276552"
}
```



---

archive/issue_events_276553.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276553"
}
```



---

archive/issue_comments_496376.json:
```json
{
    "body": "<a id='comment:41'></a>\nMoving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496376",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>
Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_events_276554.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276554"
}
```



---

archive/issue_events_276555.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276555"
}
```



---

archive/issue_comments_496377.json:
```json
{
    "body": "**Changing commit** from \"[68080fa95aed35a35813bddb7f35fbc73a373468](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)\" to \"[103f78b3f0163e18b5aa4287d29570fbd2872524](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)\".",
    "created_at": "2021-11-12T17:52:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[68080fa95aed35a35813bddb7f35fbc73a373468](https://github.com/sagemath/sagetrac-mirror/commit/68080fa95aed35a35813bddb7f35fbc73a373468)" to "[103f78b3f0163e18b5aa4287d29570fbd2872524](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)".



---

archive/issue_comments_496378.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524\">103f78b</a></td><td><code>.github/workflows/ci-conda.yml: New</code></td></tr></table>\n",
    "created_at": "2021-11-12T17:52:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496378",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524">103f78b</a></td><td><code>.github/workflows/ci-conda.yml: New</code></td></tr></table>




---

archive/issue_comments_496379.json:
```json
{
    "body": "<a id='comment:44'></a>\nI have reduced the branch to one of the jobs, `direct`, to remove the duplication with the existing workflows.",
    "created_at": "2021-11-12T17:54:26Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496379",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>
I have reduced the branch to one of the jobs, `direct`, to remove the duplication with the existing workflows.



---

archive/issue_comments_496380.json:
```json
{
    "body": "**Changing dependencies** from \"#31097\" to \"\".",
    "created_at": "2021-11-12T17:55:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496380",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31097" to "".



---

archive/issue_comments_496381.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22\" to \"\".",
    "created_at": "2021-11-12T17:55:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496381",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3A%22Build+%26+Test+using+conda%22" to "".



---

archive/issue_comments_496382.json:
```json
{
    "body": "<a id='comment:45'></a>\nStill needs updating to follow the steps of \"Conda for Sage Developers\" - https://wiki.sagemath.org/Conda - help welcome",
    "created_at": "2021-11-12T17:55:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496382",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Still needs updating to follow the steps of "Conda for Sage Developers" - https://wiki.sagemath.org/Conda - help welcome



---

archive/issue_comments_496383.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n``````\n",
    "created_at": "2021-11-12T17:56:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496383",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-This would also test that the generated `environment*.yml` and `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
``````




---

archive/issue_events_276556.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276556"
}
```



---

archive/issue_events_276557.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276557"
}
```



---

archive/issue_comments_496384.json:
```json
{
    "body": "**Changing branch** from \"[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)\" to \"[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)\".",
    "created_at": "2022-02-10T20:12:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496384",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing branch** from "[public/build/conda_gh](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda_gh)" to "[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)".



---

archive/issue_comments_496385.json:
```json
{
    "body": "<a id='comment:48'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65e1b49f79c04d755a17d02c14011c22492dc06b\">65e1b49</a></td><td><code>Fix workflow syntax</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85c31c3426f7d288c10a4435eae1bacf4c1b11eb\">85c31c3</a></td><td><code>Make workflow at least try to compile sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd484d8e120aa25d323510bbe9bbb663ceeeddff\">fd484d8</a></td><td><code>Github needs sudo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/909cd9e1261d3fc89f7f99041e0fa0ab576c9747\">909cd9e</a></td><td><code>Add a few missing python packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a91da81a85668720514f7a233235705093864126\">a91da81</a></td><td><code>Run in parallel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4945e505fd916165a8e692150f68e36c4d15ffa\">d4945e5</a></td><td><code>Install gap manually</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3171f82be5c8ee56a71a2cafd6c5065499d64f7e\">3171f82</a></td><td><code>Split in more jobs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b87f2bcca52c9492d467c49392dd99bc25ddbbd0\">b87f2bc</a></td><td><code>Reuse existing bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eec7abca427e82ed97edf9f8853ce2d72879504d\">eec7abc</a></td><td><code>Delete env-python from gitignore again</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729\">68e8330</a></td><td><code>Try with prefix instead of building ecl and gap</code></td></tr></table>\n",
    "created_at": "2022-02-10T20:12:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496385",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:48'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65e1b49f79c04d755a17d02c14011c22492dc06b">65e1b49</a></td><td><code>Fix workflow syntax</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85c31c3426f7d288c10a4435eae1bacf4c1b11eb">85c31c3</a></td><td><code>Make workflow at least try to compile sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd484d8e120aa25d323510bbe9bbb663ceeeddff">fd484d8</a></td><td><code>Github needs sudo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/909cd9e1261d3fc89f7f99041e0fa0ab576c9747">909cd9e</a></td><td><code>Add a few missing python packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a91da81a85668720514f7a233235705093864126">a91da81</a></td><td><code>Run in parallel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4945e505fd916165a8e692150f68e36c4d15ffa">d4945e5</a></td><td><code>Install gap manually</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3171f82be5c8ee56a71a2cafd6c5065499d64f7e">3171f82</a></td><td><code>Split in more jobs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b87f2bcca52c9492d467c49392dd99bc25ddbbd0">b87f2bc</a></td><td><code>Reuse existing bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eec7abca427e82ed97edf9f8853ce2d72879504d">eec7abc</a></td><td><code>Delete env-python from gitignore again</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729">68e8330</a></td><td><code>Try with prefix instead of building ecl and gap</code></td></tr></table>




---

archive/issue_events_276558.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T20:12:47Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "rename": {
        "from": "tox.ini, GH Actions: Add test for conda without SPKG",
        "to": "GH Actions: Add test for conda without SPKG"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276558"
}
```



---

archive/issue_comments_496386.json:
```json
{
    "body": "**Changing commit** from \"[103f78b3f0163e18b5aa4287d29570fbd2872524](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)\" to \"[68e8330a3619f0b17934f1ff3d23cb8b9c392729](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)\".",
    "created_at": "2022-02-10T20:12:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496386",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing commit** from "[103f78b3f0163e18b5aa4287d29570fbd2872524](https://github.com/sagemath/sagetrac-mirror/commit/103f78b3f0163e18b5aa4287d29570fbd2872524)" to "[68e8330a3619f0b17934f1ff3d23cb8b9c392729](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)".



---

archive/issue_comments_496387.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+\n+Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true\n+\n+Issues:\n+- rpy2 is not installed in the conda env\n+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h\n``````\n",
    "created_at": "2022-02-10T20:22:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496387",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,7 @@
 This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+
+Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true
+
+Issues:
+- rpy2 is not installed in the conda env
+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h
``````




---

archive/issue_events_276559.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T23:20:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276559"
}
```



---

archive/issue_events_276560.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-10T23:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276560"
}
```



---

archive/issue_comments_496388.json:
```json
{
    "body": "<a id='comment:50'></a>\nOkay, this is now ready for review.\n\nAny pointers to the two open issues are welcome. I looked for open tickets in these directions, but couldn't find one.",
    "created_at": "2022-02-10T23:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496388",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:50'></a>
Okay, this is now ready for review.

Any pointers to the two open issues are welcome. I looked for open tickets in these directions, but couldn't find one.



---

archive/issue_comments_496389.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,16 @@\n-This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)\n+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.\n \n-Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true\n+This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n \n-Issues:\n+Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n+\n+The build of sage currently fails with the following issues:\n - rpy2 is not installed in the conda env\n-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h\n+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n+\n+```\n+\tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n+```\n+is used uninitialized in this function\n+\n+Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-10T23:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496389",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,16 @@
-This would also test that the generated  `src/environment*.yml` files work correctly. (See documentation added in #28745 and https://wiki.sagemath.org/Conda)
+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.
 
-Run: https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true
+This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)
 
-Issues:
+Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
+
+The build of sage currently fails with the following issues:
 - rpy2 is not installed in the conda env
-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h
+- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
+
+```
+	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
+```
+is used uninitialized in this function
+
+Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_496390.json:
```json
{
    "body": "**Changing commit** from \"[68e8330a3619f0b17934f1ff3d23cb8b9c392729](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)\" to \"[b408f9e4eaf24bcd898e33d35bc596a0ec998462](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)\".",
    "created_at": "2022-02-10T23:20:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[68e8330a3619f0b17934f1ff3d23cb8b9c392729](https://github.com/sagemath/sagetrac-mirror/commit/68e8330a3619f0b17934f1ff3d23cb8b9c392729)" to "[b408f9e4eaf24bcd898e33d35bc596a0ec998462](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)".



---

archive/issue_comments_496391.json:
```json
{
    "body": "<a id='comment:51'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462\">b408f9e</a></td><td><code>Cleanup workflow</code></td></tr></table>\n",
    "created_at": "2022-02-10T23:20:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462">b408f9e</a></td><td><code>Cleanup workflow</code></td></tr></table>




---

archive/issue_comments_496392.json:
```json
{
    "body": "<a id='comment:52'></a>\nIn https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true I see\n\nI see \n\n```\nbuilding 'sage.libs.lcalc.lcalc_Lfunction' extension\n    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n        1 | #include \"lcalc/L.h\"\n          |          ^~~~~~~~~~~\n    compilation terminated.\n    building 'sage.libs.libecm' extension\n```",
    "created_at": "2022-02-10T23:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496392",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'></a>
In https://github.com/sagemath/sagetrac-mirror/runs/5146995129?check_suite_focus=true I see

I see 

```
building 'sage.libs.lcalc.lcalc_Lfunction' extension
    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
        1 | #include "lcalc/L.h"
          |          ^~~~~~~~~~~
    compilation terminated.
    building 'sage.libs.libecm' extension
```



---

archive/issue_comments_496393.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,5 +12,17 @@\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n ```\n is used uninitialized in this function\n+- lcalc is not recognized although installed in conda\n+\n+```\n+building 'sage.libs.lcalc.lcalc_Lfunction' extension\n+    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n+    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:\n+    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory\n+        1 | #include \"lcalc/L.h\"\n+          |          ^~~~~~~~~~~\n+    compilation terminated.\n+```\n+- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-11T08:51:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496393",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,5 +12,17 @@
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
 ```
 is used uninitialized in this function
+- lcalc is not recognized although installed in conda
+
+```
+building 'sage.libs.lcalc.lcalc_Lfunction' extension
+    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
+    In file included from sage/libs/lcalc/lcalc_Lfunction.cpp:740:
+    sage/libs/lcalc/lcalc_sage.h:1:10: fatal error: lcalc/L.h: No such file or directory
+        1 | #include "lcalc/L.h"
+          |          ^~~~~~~~~~~
+    compilation terminated.
+```
+- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
 Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_496394.json:
```json
{
    "body": "<a id='comment:54'></a>\nGood observation. I think, however, this is not the reason why the build terminates as this error occurs somewhere in the middle (and I had similar error messages with `gap` before).\nI've added it to the list of \"issues\" in the ticket description.",
    "created_at": "2022-02-11T08:52:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496394",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:54'></a>
Good observation. I think, however, this is not the reason why the build terminates as this error occurs somewhere in the middle (and I had similar error messages with `gap` before).
I've added it to the list of "issues" in the ticket description.



---

archive/issue_comments_496395.json:
```json
{
    "body": "<a id='comment:55'></a>\nThis is the reason for the failure. There's no mystery there.",
    "created_at": "2022-02-11T18:18:14Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496395",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'></a>
This is the reason for the failure. There's no mystery there.



---

archive/issue_events_276561.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T18:18:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276561"
}
```



---

archive/issue_events_276562.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T18:18:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276562"
}
```



---

archive/issue_comments_496396.json:
```json
{
    "body": "<a id='comment:56'></a>\nDo you get `lcalc>=2` with conda?",
    "created_at": "2022-02-11T19:59:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496396",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:56'></a>
Do you get `lcalc>=2` with conda?



---

archive/issue_comments_496397.json:
```json
{
    "body": "<a id='comment:57'></a>\nReplying to [mkoeppe](#comment%3A55):\n> This is the reason for the failure. There's no mystery there.\n\n\nCould be. But the point of this ticket is to add the github action, so that one can fix these issues in follow-up tickets and have a direct verification. It might take quite some time until this workflow is green, especially since there are probably quite a few tests that fail.\n\nSo except if you think that there is something fundamentally flawed with the current steps which result in the lcalc error, this should be ready for review.",
    "created_at": "2022-02-11T20:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496397",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:57'></a>
Replying to [mkoeppe](#comment%3A55):
> This is the reason for the failure. There's no mystery there.


Could be. But the point of this ticket is to add the github action, so that one can fix these issues in follow-up tickets and have a direct verification. It might take quite some time until this workflow is green, especially since there are probably quite a few tests that fail.

So except if you think that there is something fundamentally flawed with the current steps which result in the lcalc error, this should be ready for review.



---

archive/issue_events_276563.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-11T20:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276563"
}
```



---

archive/issue_events_276564.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-11T20:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276564"
}
```



---

archive/issue_comments_496398.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [isuruf](#comment%3A56):\n> Do you get `lcalc>=2` with conda?\n\n\nNope, its installing lcalc 1.23 h0d16fac_1004 conda-forge. That's probably the reason why its not working.",
    "created_at": "2022-02-11T20:43:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496398",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:58'></a>
Replying to [isuruf](#comment%3A56):
> Do you get `lcalc>=2` with conda?


Nope, its installing lcalc 1.23 h0d16fac_1004 conda-forge. That's probably the reason why its not working.



---

archive/issue_comments_496399.json:
```json
{
    "body": "<a id='comment:59'></a>\nSo `build/pkgs/lcalc/distros/conda.txt` should be changed",
    "created_at": "2022-02-11T20:46:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496399",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'></a>
So `build/pkgs/lcalc/distros/conda.txt` should be changed



---

archive/issue_comments_496400.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [gh-tobiasdiez](#comment%3A57):\n> the point of this ticket is to add the github action\n\n\nWell, it fails early, so we cannot see whether the later steps work.",
    "created_at": "2022-02-11T20:48:08Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496400",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>
Replying to [gh-tobiasdiez](#comment%3A57):
> the point of this ticket is to add the github action


Well, it fails early, so we cannot see whether the later steps work.



---

archive/issue_comments_496401.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [mkoeppe](#comment%3A59):\n> So `build/pkgs/lcalc/distros/conda.txt` should be changed\n\n\nI don't think it will be that easy to solve:\n\n```\nmamba install lcalc=2.0.5 -n sage-dev\n > package libeantic-1.0.2-hf1f868f_1 requires antic >=0.2.4,<0.3.0a0, but none of the providers can be installed\n\nmamba install libeantic=1.1.0 -n sage-dev\n > package libeantic-1.1.0-h52e3b27_0 requires arb >=2.21.1,<2.22.0a0, but none of the providers can be installed\n\nmamba install arb=2.21.1 -n sage-dev\n > package e-antic-1.0.2-hf1f868f_0 requires arb >=2.19.0,<2.20.0a0, but none of the providers can be installed\n```\nI appears that there is a funny cyclic dependency thing going on.",
    "created_at": "2022-02-12T15:39:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496401",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:61'></a>
Replying to [mkoeppe](#comment%3A59):
> So `build/pkgs/lcalc/distros/conda.txt` should be changed


I don't think it will be that easy to solve:

```
mamba install lcalc=2.0.5 -n sage-dev
 > package libeantic-1.0.2-hf1f868f_1 requires antic >=0.2.4,<0.3.0a0, but none of the providers can be installed

mamba install libeantic=1.1.0 -n sage-dev
 > package libeantic-1.1.0-h52e3b27_0 requires arb >=2.21.1,<2.22.0a0, but none of the providers can be installed

mamba install arb=2.21.1 -n sage-dev
 > package e-antic-1.0.2-hf1f868f_0 requires arb >=2.19.0,<2.20.0a0, but none of the providers can be installed
```
I appears that there is a funny cyclic dependency thing going on.



---

archive/issue_comments_496402.json:
```json
{
    "body": "<a id='comment:62'></a>\nReplying to [mkoeppe](#comment%3A60):\n> Replying to [gh-tobiasdiez](#comment%3A57):\n> > the point of this ticket is to add the github action\n\n> \n> Well, it fails early, so we cannot see whether the later steps work.\n\n\nShould I un-comment the last test step for now?",
    "created_at": "2022-02-12T15:40:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496402",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:62'></a>
Replying to [mkoeppe](#comment%3A60):
> Replying to [gh-tobiasdiez](#comment%3A57):
> > the point of this ticket is to add the github action

> 
> Well, it fails early, so we cannot see whether the later steps work.


Should I un-comment the last test step for now?



---

archive/issue_comments_496403.json:
```json
{
    "body": "<a id='comment:63'></a>\nTry switching from `src/environment-optional.yml` to `src/environment.yml`.\n`e_antic` is an optional package for Sage. Let's try without optional packages first.",
    "created_at": "2022-02-12T16:44:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496403",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>
Try switching from `src/environment-optional.yml` to `src/environment.yml`.
`e_antic` is an optional package for Sage. Let's try without optional packages first.



---

archive/issue_comments_496404.json:
```json
{
    "body": "<a id='comment:64'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c\">051b7b5</a></td><td><code>Don't use -optional env</code></td></tr></table>\n",
    "created_at": "2022-02-12T17:51:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:64'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c">051b7b5</a></td><td><code>Don't use -optional env</code></td></tr></table>




---

archive/issue_comments_496405.json:
```json
{
    "body": "**Changing commit** from \"[b408f9e4eaf24bcd898e33d35bc596a0ec998462](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)\" to \"[051b7b5730203843fda7a5a47bab8bbaffdf5c3c](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)\".",
    "created_at": "2022-02-12T17:51:30Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b408f9e4eaf24bcd898e33d35bc596a0ec998462](https://github.com/sagemath/sagetrac-mirror/commit/b408f9e4eaf24bcd898e33d35bc596a0ec998462)" to "[051b7b5730203843fda7a5a47bab8bbaffdf5c3c](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)".



---

archive/issue_comments_496406.json:
```json
{
    "body": "<a id='comment:65'></a>\nThat should indeed work to get `loalc 2.0.5`. Good suggestion.\n\nFor the record: first installing `environment.yml` and then updating the env to `environment-optional.yml` yields the following downgrade of packgages:\n\n```\n  Downgrade:\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n  - arb                                               2.22.1  hbbd85db_0              installed\n  + arb                                               2.19.0  h7e34412_0              conda-forge/linux-64        7MB\n  - boost-cpp                                         1.77.0  h359cf19_1              installed\n  + boost-cpp                                         1.74.0  h312852a_4              conda-forge/linux-64     Cached\n  - cvxopt                                             1.2.7  py310h9fd565e_1         installed\n  + cvxopt                                             1.2.6  py38h55e5319_0          conda-forge/linux-64     Cached\n  - cysignals                                         1.11.2  py310h15010d2_0         installed\n  + cysignals                                         1.10.3  py38hd3cf888_0          conda-forge/linux-64     Cached\n  - eclib                                           20210625  h52f5ea4_4              installed\n  + eclib                                           20190909  h5b7fb09_3              conda-forge/linux-64       36MB\n  - gap-core                                          4.11.1  h1725ef4_2              installed\n  + gap-core                                          4.11.0  h1725ef4_7              conda-forge/linux-64       67MB\n  - gap-defaults                                      4.11.1  ha770c72_2              installed\n  + gap-defaults                                      4.11.0  ha770c72_7              conda-forge/linux-64       88MB\n  - gsl                                                  2.7  he838d99_0              installed\n  + gsl                                                  2.6  he838d99_2              conda-forge/linux-64     Cached\n  - harfbuzz                                           3.3.1  hb4a5f5f_0              installed\n  + harfbuzz                                           3.1.1  h83ec7ef_0              conda-forge/linux-64     Cached\n  - icu                                                 69.1  h9c3ff4c_0              installed\n  + icu                                                 68.2  h9c3ff4c_0              conda-forge/linux-64     Cached\n  - lcalc                                              2.0.5  h8cd7e2e_0              installed\n  + lcalc                                               1.23  h0d16fac_1004           conda-forge/linux-64     Cached\n  - libclang                                          13.0.1  default_hc23dcda_0      installed\n  + libclang                                          11.1.0  default_ha53f305_1      conda-forge/linux-64     Cached\n  - libflint                                           2.8.4  hd3cd37b_ntl_100        installed\n  + libflint                                           2.6.3  h6b702e8_0              conda-forge/linux-64       11MB\n  - libpq                                               14.2  hd57d9b9_0              installed\n  + libpq                                               13.5  hd57d9b9_1              conda-forge/linux-64     Cached\n  - libuv                                             1.43.0  h7f98852_0              installed\n  + libuv                                             1.42.0  h7f98852_0              conda-forge/linux-64     Cached\n  - pari                                              2.13.3  h82e6b41_1_pthread      installed\n  + pari                                              2.11.4  hddaffa3_2              conda-forge/linux-64     Cached\n  - python                                            3.10.2  h85951f9_3_cpython      installed\n  + python                                            3.8.12  ha38a3c6_3_cpython      conda-forge/linux-64     Cached\n  - python_abi                                          3.10  2_cp310                 installed\n  + python_abi                                           3.8  2_cp38                  conda-forge/linux-64     Cached\n  - r-base                                             4.1.2  hde4fec0_0              installed\n  + r-base                                             4.1.1  hb67fd72_0              conda-forge/linux-64     Cached\n  - singular                                        4.2.1.p3  haca423c_0              installed\n  + singular                                        4.1.1.p2  ha188dad_4              conda-forge/linux-64       22MB\n\n```",
    "created_at": "2022-02-12T17:58:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496406",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:65'></a>
That should indeed work to get `loalc 2.0.5`. Good suggestion.

For the record: first installing `environment.yml` and then updating the env to `environment-optional.yml` yields the following downgrade of packgages:

```
  Downgrade:
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

  - arb                                               2.22.1  hbbd85db_0              installed
  + arb                                               2.19.0  h7e34412_0              conda-forge/linux-64        7MB
  - boost-cpp                                         1.77.0  h359cf19_1              installed
  + boost-cpp                                         1.74.0  h312852a_4              conda-forge/linux-64     Cached
  - cvxopt                                             1.2.7  py310h9fd565e_1         installed
  + cvxopt                                             1.2.6  py38h55e5319_0          conda-forge/linux-64     Cached
  - cysignals                                         1.11.2  py310h15010d2_0         installed
  + cysignals                                         1.10.3  py38hd3cf888_0          conda-forge/linux-64     Cached
  - eclib                                           20210625  h52f5ea4_4              installed
  + eclib                                           20190909  h5b7fb09_3              conda-forge/linux-64       36MB
  - gap-core                                          4.11.1  h1725ef4_2              installed
  + gap-core                                          4.11.0  h1725ef4_7              conda-forge/linux-64       67MB
  - gap-defaults                                      4.11.1  ha770c72_2              installed
  + gap-defaults                                      4.11.0  ha770c72_7              conda-forge/linux-64       88MB
  - gsl                                                  2.7  he838d99_0              installed
  + gsl                                                  2.6  he838d99_2              conda-forge/linux-64     Cached
  - harfbuzz                                           3.3.1  hb4a5f5f_0              installed
  + harfbuzz                                           3.1.1  h83ec7ef_0              conda-forge/linux-64     Cached
  - icu                                                 69.1  h9c3ff4c_0              installed
  + icu                                                 68.2  h9c3ff4c_0              conda-forge/linux-64     Cached
  - lcalc                                              2.0.5  h8cd7e2e_0              installed
  + lcalc                                               1.23  h0d16fac_1004           conda-forge/linux-64     Cached
  - libclang                                          13.0.1  default_hc23dcda_0      installed
  + libclang                                          11.1.0  default_ha53f305_1      conda-forge/linux-64     Cached
  - libflint                                           2.8.4  hd3cd37b_ntl_100        installed
  + libflint                                           2.6.3  h6b702e8_0              conda-forge/linux-64       11MB
  - libpq                                               14.2  hd57d9b9_0              installed
  + libpq                                               13.5  hd57d9b9_1              conda-forge/linux-64     Cached
  - libuv                                             1.43.0  h7f98852_0              installed
  + libuv                                             1.42.0  h7f98852_0              conda-forge/linux-64     Cached
  - pari                                              2.13.3  h82e6b41_1_pthread      installed
  + pari                                              2.11.4  hddaffa3_2              conda-forge/linux-64     Cached
  - python                                            3.10.2  h85951f9_3_cpython      installed
  + python                                            3.8.12  ha38a3c6_3_cpython      conda-forge/linux-64     Cached
  - python_abi                                          3.10  2_cp310                 installed
  + python_abi                                           3.8  2_cp38                  conda-forge/linux-64     Cached
  - r-base                                             4.1.2  hde4fec0_0              installed
  + r-base                                             4.1.1  hb67fd72_0              conda-forge/linux-64     Cached
  - singular                                        4.2.1.p3  haca423c_0              installed
  + singular                                        4.1.1.p2  ha188dad_4              conda-forge/linux-64       22MB

```



---

archive/issue_comments_496407.json:
```json
{
    "body": "<a id='comment:66'></a>\nThere must be some outdated pins / version constraints in the conda-forge packaging. Likely related to the fact that the Sage distribution has fallen behind upstream regarding `e_antic`/`normaliz` (see #31588).",
    "created_at": "2022-02-12T18:07:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496407",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'></a>
There must be some outdated pins / version constraints in the conda-forge packaging. Likely related to the fact that the Sage distribution has fallen behind upstream regarding `e_antic`/`normaliz` (see #31588).



---

archive/issue_comments_496408.json:
```json
{
    "body": "<a id='comment:67'></a>\n@isuruf, I think Sage works fine with current upstream versions of normaliz/pynormaliz that use the `e_antic` 1.x series, so it should be safe to remove such constraints. (We just can't yet update within the Sage distribution because of portability bugs in `e_antic`, see #31588.)",
    "created_at": "2022-02-12T18:11:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496408",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:67'></a>
@isuruf, I think Sage works fine with current upstream versions of normaliz/pynormaliz that use the `e_antic` 1.x series, so it should be safe to remove such constraints. (We just can't yet update within the Sage distribution because of portability bugs in `e_antic`, see #31588.)



---

archive/issue_comments_496409.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [mkoeppe](#comment%3A59):\n> So `build/pkgs/lcalc/distros/conda.txt` should be changed\n... to say `\"lcalc >=2\"`",
    "created_at": "2022-02-12T18:13:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496409",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:68'></a>
Replying to [mkoeppe](#comment%3A59):
> So `build/pkgs/lcalc/distros/conda.txt` should be changed
... to say `"lcalc >=2"`



---

archive/issue_comments_496410.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n The build of sage currently fails with the following issues:\n-- rpy2 is not installed in the conda env\n+- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n \n ```\n``````\n",
    "created_at": "2022-02-12T18:16:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496410",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
 The build of sage currently fails with the following issues:
-- rpy2 is not installed in the conda env
+- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
 
 ```
``````




---

archive/issue_comments_496411.json:
```json
{
    "body": "<a id='comment:70'></a>\nRegarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier\n\nLet's also keep the instructions in https://wiki.sagemath.org/Conda updated.",
    "created_at": "2022-02-12T18:23:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496411",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:70'></a>
Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier

Let's also keep the instructions in https://wiki.sagemath.org/Conda updated.



---

archive/issue_comments_496412.json:
```json
{
    "body": "<a id='comment:71'></a>\nOh, and `configure --with-system-lcalc=force` too...",
    "created_at": "2022-02-12T18:25:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496412",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:71'></a>
Oh, and `configure --with-system-lcalc=force` too...



---

archive/issue_comments_496413.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n ```\n is used uninitialized in this function\n-- lcalc is not recognized although installed in conda\n+- environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n building 'sage.libs.lcalc.lcalc_Lfunction' extension\n@@ -23,6 +23,6 @@\n           |          ^~~~~~~~~~~\n     compilation terminated.\n ```\n-- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n+- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n Fixing these problems will be addressed in a follow-up ticket.\n``````\n",
    "created_at": "2022-02-12T18:32:03Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496413",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
 ```
 is used uninitialized in this function
-- lcalc is not recognized although installed in conda
+- environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
 building 'sage.libs.lcalc.lcalc_Lfunction' extension
@@ -23,6 +23,6 @@
           |          ^~~~~~~~~~~
     compilation terminated.
 ```
-- maybe related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
+- environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
 Fixing these problems will be addressed in a follow-up ticket.
``````




---

archive/issue_comments_496414.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [mkoeppe](#comment%3A70):\n> Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier\n> \n> Let's also keep the instructions in https://wiki.sagemath.org/Conda updated. \n\n\nWith the basic env, its now also using `pari 2.13.3`.\n\nI guess some of the optional packages is lagging behind a bit and still requiring some older version of some package. This then leads to these various downgrades of arb, ecl, pari, lcalc etc",
    "created_at": "2022-02-12T18:34:02Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496414",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:74'></a>
Replying to [mkoeppe](#comment%3A70):
> Regarding the `pari` issue mentioned in the ticket description, we should probably use  `configure --with-system-pari=force` so the error is signalled earlier
> 
> Let's also keep the instructions in https://wiki.sagemath.org/Conda updated. 


With the basic env, its now also using `pari 2.13.3`.

I guess some of the optional packages is lagging behind a bit and still requiring some older version of some package. This then leads to these various downgrades of arb, ecl, pari, lcalc etc



---

archive/issue_comments_496415.json:
```json
{
    "body": "<a id='comment:75'></a>\nYes, and we are missing many of the version constraints that are in https://github.com/conda-forge/sage-feedstock/blob/master/recipe/meta.yaml",
    "created_at": "2022-02-12T18:38:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496415",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:75'></a>
Yes, and we are missing many of the version constraints that are in https://github.com/conda-forge/sage-feedstock/blob/master/recipe/meta.yaml



---

archive/issue_comments_496416.json:
```json
{
    "body": "<a id='comment:76'></a>\nMany of these should be added to the `conda.txt` files, so that they will be included in our `src/environment*.yml`.",
    "created_at": "2022-02-12T18:40:14Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496416",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:76'></a>
Many of these should be added to the `conda.txt` files, so that they will be included in our `src/environment*.yml`.



---

archive/issue_comments_496417.json:
```json
{
    "body": "**Changing commit** from \"[051b7b5730203843fda7a5a47bab8bbaffdf5c3c](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)\" to \"[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)\".",
    "created_at": "2022-02-12T18:55:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[051b7b5730203843fda7a5a47bab8bbaffdf5c3c](https://github.com/sagemath/sagetrac-mirror/commit/051b7b5730203843fda7a5a47bab8bbaffdf5c3c)" to "[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)".



---

archive/issue_comments_496418.json:
```json
{
    "body": "<a id='comment:77'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3\">bd65274</a></td><td><code>Fix test command</code></td></tr></table>\n",
    "created_at": "2022-02-12T18:55:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496418",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:77'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3">bd65274</a></td><td><code>Fix test command</code></td></tr></table>




---

archive/issue_comments_496419.json:
```json
{
    "body": "<a id='comment:78'></a>\nOkay, after using `environment.yml` the build now succeeds. The tests fail almost immediately at the import of `sage.all`, because `primecountpy` is not installed in the conda env (it is also in neither `environment` file).\n\nI propose to get this ticket in and then work on the improvements to fix the various issues.",
    "created_at": "2022-02-12T20:16:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496419",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:78'></a>
Okay, after using `environment.yml` the build now succeeds. The tests fail almost immediately at the import of `sage.all`, because `primecountpy` is not installed in the conda env (it is also in neither `environment` file).

I propose to get this ticket in and then work on the improvements to fix the various issues.



---

archive/issue_comments_496420.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,7 +6,8 @@\n \n The build of sage currently fails with the following issues:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n+- primecountpy is not installed in the conda env because its not listed in `environment.yml`\n+- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n \n ```\n \tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n``````\n",
    "created_at": "2022-02-12T20:17:35Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496420",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,7 +6,8 @@
 
 The build of sage currently fails with the following issues:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
-- exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
+- primecountpy is not installed in the conda env because its not listed in `environment.yml`
+- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
 
 ```
 	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
``````




---

archive/issue_comments_496421.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n-The build of sage currently fails with the following issues:\n+During the work on this issue the following issues have been detected:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n``````\n",
    "created_at": "2022-02-12T20:18:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496421",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
-The build of sage currently fails with the following issues:
+During the work on this issue the following issues have been detected:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
``````




---

archive/issue_comments_496422.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,12 +7,6 @@\n During the work on this issue the following issues have been detected:\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n-- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in \n-\n-```\n-\tptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }\n-```\n-is used uninitialized in this function\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n``````\n",
    "created_at": "2022-02-12T20:18:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496422",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,12 +7,6 @@
 During the work on this issue the following issues have been detected:
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
-- environment-optional: exits without error message during or after compilation of sage/symbolic/ginac/ptr.h after complaining multiple times that `other.p` in 
-
-```
-	ptr(const ptr & other) throw() : p(other.p) { p->add_reference(); }
-```
-is used uninitialized in this function
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
``````




---

archive/issue_comments_496423.json:
```json
{
    "body": "<a id='comment:82'></a>\nJust add `build/pkgs/primecountpy/distros/conda.txt`",
    "created_at": "2022-02-12T20:19:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496423",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:82'></a>
Just add `build/pkgs/primecountpy/distros/conda.txt`



---

archive/issue_comments_496424.json:
```json
{
    "body": "<a id='comment:83'></a>\nAt the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.",
    "created_at": "2022-02-12T20:20:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496424",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:83'></a>
At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.



---

archive/issue_comments_496425.json:
```json
{
    "body": "<a id='comment:84'></a>\ncomment:70, [comment:71](#comment%3A71), [comment:76](#comment%3A76), [comment:82](#comment%3A82) are actionable",
    "created_at": "2022-02-12T20:22:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496425",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:84'></a>
comment:70, [comment:71](#comment%3A71), [comment:76](#comment%3A76), [comment:82](#comment%3A82) are actionable



---

archive/issue_comments_496426.json:
```json
{
    "body": "<a id='comment:85'></a>\nAlso, the ticket description claims that it follows https://wiki.sagemath.org/Conda; but that uses `pip install -r src/requirements.txt`, which would install the missing `primecountpy` too.",
    "created_at": "2022-02-12T20:30:32Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496426",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:85'></a>
Also, the ticket description claims that it follows https://wiki.sagemath.org/Conda; but that uses `pip install -r src/requirements.txt`, which would install the missing `primecountpy` too.



---

archive/issue_comments_496427.json:
```json
{
    "body": "<a id='comment:86'></a>\nIt's better to not use pip.",
    "created_at": "2022-02-12T20:34:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496427",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:86'></a>
It's better to not use pip.



---

archive/issue_comments_496428.json:
```json
{
    "body": "<a id='comment:87'></a>\nReplying to [mkoeppe](#comment%3A83):\n> At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.\n\n\nThat's sadly true, but follow-up tickets can easily depend on this ticket here to run the CI.",
    "created_at": "2022-02-12T20:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496428",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:87'></a>
Replying to [mkoeppe](#comment%3A83):
> At the current pace, it will take months before this ticket is merged. Little point in waiting for that to happen. There's a momentum now to fix it.


That's sadly true, but follow-up tickets can easily depend on this ticket here to run the CI.



---

archive/issue_comments_496429.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n During the work on this issue the following issues have been detected:\n+- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n+- Migrate documentation from wiki to developer docs\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n``````\n",
    "created_at": "2022-02-12T20:41:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496429",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
 During the work on this issue the following issues have been detected:
+- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
+- Migrate documentation from wiki to developer docs
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
``````




---

archive/issue_events_276565.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T20:46:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276565"
}
```



---

archive/issue_events_276566.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T20:46:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276566"
}
```



---

archive/issue_comments_496430.json:
```json
{
    "body": "<a id='comment:90'></a>\nReplying to [mkoeppe](#comment%3A71):\n> Oh, and `configure --with-system-lcalc=force` too...\n\n\nDo you really think we should add a `--with-system-xyz=force` for every system package?",
    "created_at": "2022-02-12T22:19:24Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496430",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:90'></a>
Replying to [mkoeppe](#comment%3A71):
> Oh, and `configure --with-system-lcalc=force` too...


Do you really think we should add a `--with-system-xyz=force` for every system package?



---

archive/issue_comments_496431.json:
```json
{
    "body": "<a id='comment:91'></a>\nI don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...",
    "created_at": "2022-02-12T22:28:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496431",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:91'></a>
I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...



---

archive/issue_comments_496432.json:
```json
{
    "body": "<a id='comment:92'></a>\nOr generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`",
    "created_at": "2022-02-12T22:30:02Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496432",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:92'></a>
Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`



---

archive/issue_comments_496433.json:
```json
{
    "body": "<a id='comment:93'></a>\nWhy do you need `--with-system-lcalc=force`?",
    "created_at": "2022-02-12T22:34:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496433",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:93'></a>
Why do you need `--with-system-lcalc=force`?



---

archive/issue_comments_496434.json:
```json
{
    "body": "<a id='comment:94'></a>\nSo that it is an immediate error if the system package is not usable. Here we are testing the workflow that does not run `make` at all.",
    "created_at": "2022-02-12T22:36:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496434",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:94'></a>
So that it is an immediate error if the system package is not usable. Here we are testing the workflow that does not run `make` at all.



---

archive/issue_comments_496435.json:
```json
{
    "body": "<a id='comment:95'></a>\nReplying to [mkoeppe](#comment%3A92):\n> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n\nBut doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.\n\nMoreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.",
    "created_at": "2022-02-12T23:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496435",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:95'></a>
Replying to [mkoeppe](#comment%3A92):
> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`


But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.

Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.



---

archive/issue_comments_496436.json:
```json
{
    "body": "<a id='comment:96'></a>\nReplying to [gh-tobiasdiez](#comment%3A95):\n> Replying to [mkoeppe](#comment%3A92):\n> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n> \n> But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.\n\n\nYes, that's the idea. For packages that have an `spkg-configure.m4`, our configure script knows which versions work. It should fail early if there is something that cannot be accepted.",
    "created_at": "2022-02-13T00:07:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496436",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:96'></a>
Replying to [gh-tobiasdiez](#comment%3A95):
> Replying to [mkoeppe](#comment%3A92):
> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

> 
> But doesn't this trigger errors as soon as a system package is rejected? That currently happens with a lot of packages as you can see in the github workflow.


Yes, that's the idea. For packages that have an `spkg-configure.m4`, our configure script knows which versions work. It should fail early if there is something that cannot be accepted.



---

archive/issue_comments_496437.json:
```json
{
    "body": "<a id='comment:97'></a>\nReplying to [gh-tobiasdiez](#comment%3A95):\n> Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\n\nThat is something that is best left to the downstream packagers.",
    "created_at": "2022-02-13T00:08:08Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496437",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:97'></a>
Replying to [gh-tobiasdiez](#comment%3A95):
> Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.


That is something that is best left to the downstream packagers.



---

archive/issue_comments_496438.json:
```json
{
    "body": "<a id='comment:98'></a>\nReplying to [gh-tobiasdiez](#comment%3A95):\n> That currently happens with a lot of packages as you can see in the github workflow.\n\n\n`python3` is rejected because your script doesn't follow the instructions at https://wiki.sagemath.org/Conda - `--with-python=$CONDA_PREFIX/bin/python` is missing.",
    "created_at": "2022-02-13T00:11:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496438",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:98'></a>
Replying to [gh-tobiasdiez](#comment%3A95):
> That currently happens with a lot of packages as you can see in the github workflow.


`python3` is rejected because your script doesn't follow the instructions at https://wiki.sagemath.org/Conda - `--with-python=$CONDA_PREFIX/bin/python` is missing.



---

archive/issue_comments_496439.json:
```json
{
    "body": "<a id='comment:99'></a>\nAnd many others fail because you use `--without-system-gcc`, which is a bad idea.",
    "created_at": "2022-02-13T00:13:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496439",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:99'></a>
And many others fail because you use `--without-system-gcc`, which is a bad idea.



---

archive/issue_comments_496440.json:
```json
{
    "body": "**Changing commit** from \"[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)\" to \"[8a297af947f5864afb5c8d5563293cf2b9391fe4](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)\".",
    "created_at": "2022-02-13T09:22:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)" to "[8a297af947f5864afb5c8d5563293cf2b9391fe4](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)".



---

archive/issue_comments_496441.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4\">8a297af</a></td><td><code>Remove without gcc, add with python</code></td></tr></table>\n",
    "created_at": "2022-02-13T09:22:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4">8a297af</a></td><td><code>Remove without gcc, add with python</code></td></tr></table>




---

archive/issue_comments_496442.json:
```json
{
    "body": "<a id='comment:101'></a>\nReplying to [mkoeppe](#comment%3A99):\n> And many others fail because you use `--without-system-gcc`, which is a bad idea.\n\n\nOtherwise configure fails with\n\n```\n configure: error: \n\n    Given --with-system-gcc=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-gcc)\n```",
    "created_at": "2022-02-13T09:39:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496442",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:101'></a>
Replying to [mkoeppe](#comment%3A99):
> And many others fail because you use `--without-system-gcc`, which is a bad idea.


Otherwise configure fails with

```
 configure: error: 

    Given --with-system-gcc=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-gcc)
```



---

archive/issue_comments_496443.json:
```json
{
    "body": "**Changing commit** from \"[8a297af947f5864afb5c8d5563293cf2b9391fe4](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)\" to \"[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)\".",
    "created_at": "2022-02-13T09:44:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8a297af947f5864afb5c8d5563293cf2b9391fe4](https://github.com/sagemath/sagetrac-mirror/commit/8a297af947f5864afb5c8d5563293cf2b9391fe4)" to "[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)".



---

archive/issue_comments_496444.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:",
    "created_at": "2022-02-13T09:44:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:



---

archive/issue_comments_496445.json:
```json
{
    "body": "<a id='comment:103'></a>\nReplying to [mkoeppe](#comment%3A97):\n> Replying to [gh-tobiasdiez](#comment%3A95):\n> > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\n> \n> That is something that is best left to the downstream packagers.\n> \n\n\nThe section has the title \"Conda for Sage Developers\" so downstream packagers are not involved here.",
    "created_at": "2022-02-13T09:45:23Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496445",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:103'></a>
Replying to [mkoeppe](#comment%3A97):
> Replying to [gh-tobiasdiez](#comment%3A95):
> > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.

> 
> That is something that is best left to the downstream packagers.
> 


The section has the title "Conda for Sage Developers" so downstream packagers are not involved here.



---

archive/issue_events_276567.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-13T09:45:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276567"
}
```



---

archive/issue_events_276568.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-13T09:45:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276568"
}
```



---

archive/issue_comments_496446.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n During the work on this issue the following issues have been detected:\n - Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n - Migrate documentation from wiki to developer docs\n+- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n - primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n``````\n",
    "created_at": "2022-02-13T09:47:02Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496446",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 During the work on this issue the following issues have been detected:
 - Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
 - Migrate documentation from wiki to developer docs
+- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
 - primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
``````




---

archive/issue_comments_496447.json:
```json
{
    "body": "<a id='comment:106'></a>\nReplying to [mkoeppe](#comment%3A82):\n> Just add `build/pkgs/primecountpy/distros/conda.txt`\n\n\nThis is now #33330.",
    "created_at": "2022-02-13T11:17:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496447",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:106'></a>
Replying to [mkoeppe](#comment%3A82):
> Just add `build/pkgs/primecountpy/distros/conda.txt`


This is now #33330.



---

archive/issue_comments_496448.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n - Migrate documentation from wiki to developer docs\n - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n-- primecountpy is not installed in the conda env because its not listed in `environment.yml`\n+- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n ```\n``````\n",
    "created_at": "2022-02-13T11:18:34Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496448",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 - Migrate documentation from wiki to developer docs
 - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
 - The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
-- primecountpy is not installed in the conda env because its not listed in `environment.yml`
+- #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
 ```
``````




---

archive/issue_comments_496449.json:
```json
{
    "body": "<a id='comment:8'></a>\nI undestand that the GH run on #33330 uses this branch, so it looks good to me.",
    "created_at": "2022-02-13T12:31:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496449",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
I undestand that the GH run on #33330 uses this branch, so it looks good to me.



---

archive/issue_comments_496450.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe, Dima Pasechnik",
    "created_at": "2022-02-13T12:31:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496450",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Matthias Koeppe, Dima Pasechnik



---

archive/issue_events_276569.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T12:31:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276569"
}
```



---

archive/issue_events_276570.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T12:31:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276570"
}
```



---

archive/issue_comments_496451.json:
```json
{
    "body": "<a id='comment:9'></a>\nAlso here, thanks for the review.",
    "created_at": "2022-02-13T13:17:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496451",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>
Also here, thanks for the review.



---

archive/issue_comments_496452.json:
```json
{
    "body": "<a id='comment:0'></a>\nI've now created #33331 for the follow-up issues.",
    "created_at": "2022-02-13T13:59:29Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496452",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:0'></a>
I've now created #33331 for the follow-up issues.



---

archive/issue_comments_496453.json:
```json
{
    "body": "<a id='comment:111'></a>\nReplying to [gh-tobiasdiez](#comment%3A103):\n> Replying to [mkoeppe](#comment%3A97):\n> > Replying to [gh-tobiasdiez](#comment%3A95):\n> > > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that \u0300 configure` currently performs.\n\n> > \n> > That is something that is best left to the downstream packagers.\n\n> \n> The section has the title \"Conda for Sage Developers\" so downstream packagers are not involved here.\n\n\nExactly, so in other words we should not attempt to skip `configure`'s checks.",
    "created_at": "2022-02-13T16:07:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496453",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:111'></a>
Replying to [gh-tobiasdiez](#comment%3A103):
> Replying to [mkoeppe](#comment%3A97):
> > Replying to [gh-tobiasdiez](#comment%3A95):
> > > Moreover, we have complete control over which versions we install in the conda systems, so one could actually skip the whole system check that ̀ configure` currently performs.

> > 
> > That is something that is best left to the downstream packagers.

> 
> The section has the title "Conda for Sage Developers" so downstream packagers are not involved here.


Exactly, so in other words we should not attempt to skip `configure`'s checks.



---

archive/issue_comments_496454.json:
```json
{
    "body": "<a id='comment:112'></a>\nReplying to [gh-tobiasdiez](#comment%3A101):\n> Replying to [mkoeppe](#comment%3A99):\n> > And many others fail because you use `--without-system-gcc`, which is a bad idea.\n\n> \n> Otherwise configure fails with\n> \n> ```\n>  configure: error: \n> \n>     Given --with-system-gcc=force, but no system package could be used.\n>     That's an error.  Please install the indicated package to continue.\n>     (To override this error, use ./configure --without-system-gcc)\n> ```\n\n\nWhy does it reject gcc?",
    "created_at": "2022-02-13T16:09:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496454",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:112'></a>
Replying to [gh-tobiasdiez](#comment%3A101):
> Replying to [mkoeppe](#comment%3A99):
> > And many others fail because you use `--without-system-gcc`, which is a bad idea.

> 
> Otherwise configure fails with
> 
> ```
>  configure: error: 
> 
>     Given --with-system-gcc=force, but no system package could be used.
>     That's an error.  Please install the indicated package to continue.
>     (To override this error, use ./configure --without-system-gcc)
> ```


Why does it reject gcc?



---

archive/issue_comments_496455.json:
```json
{
    "body": "<a id='comment:3'></a>\ncomment:98 still unaddressed",
    "created_at": "2022-02-13T16:14:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496455",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
comment:98 still unaddressed



---

archive/issue_comments_496456.json:
```json
{
    "body": "<a id='comment:114'></a>\nReplying to [mkoeppe](#comment%3A113):\n> comment:98 still unaddressed\n\n\nIt is addressed in [comment:100](#comment%3A100) (commit \u200b8a297af), no?",
    "created_at": "2022-02-13T21:08:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496456",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:114'></a>
Replying to [mkoeppe](#comment%3A113):
> comment:98 still unaddressed


It is addressed in [comment:100](#comment%3A100) (commit ​8a297af), no?



---

archive/issue_comments_496457.json:
```json
{
    "body": "<a id='comment:5'></a>\nThat commit is not on the current branch",
    "created_at": "2022-02-13T21:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496457",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
That commit is not on the current branch



---

archive/issue_comments_496458.json:
```json
{
    "body": "<a id='comment:6'></a>\nYes, I had to revert that commit since the workflow didn't passed. https://github.com/sagemath/sagetrac-mirror/actions/runs/1836383017\n\nThat conda's python is rejected is #31539. And since sage is not invoking python during the workflow run, it also shouldn't matter if its rejected or not.",
    "created_at": "2022-02-13T21:33:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496458",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>
Yes, I had to revert that commit since the workflow didn't passed. https://github.com/sagemath/sagetrac-mirror/actions/runs/1836383017

That conda's python is rejected is #31539. And since sage is not invoking python during the workflow run, it also shouldn't matter if its rejected or not.



---

archive/issue_comments_496459.json:
```json
{
    "body": "<a id='comment:7'></a>\nThat failure was from `gcc`, not python. So why back out the fix for python?",
    "created_at": "2022-02-13T21:47:27Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496459",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
That failure was from `gcc`, not python. So why back out the fix for python?



---

archive/issue_comments_496460.json:
```json
{
    "body": "<a id='comment:118'></a>\nReplying to [gh-tobiasdiez](#comment%3A116):\n> since sage is not invoking python during the workflow run\n\n\nHm?",
    "created_at": "2022-02-13T21:48:19Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496460",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:118'></a>
Replying to [gh-tobiasdiez](#comment%3A116):
> since sage is not invoking python during the workflow run


Hm?



---

archive/issue_comments_496461.json:
```json
{
    "body": "<a id='comment:119'></a>\nReplying to [mkoeppe](#comment%3A117):\n> That failure was from `gcc`, not python. So why back out the fix for python?\n\n\nSince it is working without this \"fix\".",
    "created_at": "2022-02-13T21:51:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496461",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:119'></a>
Replying to [mkoeppe](#comment%3A117):
> That failure was from `gcc`, not python. So why back out the fix for python?


Since it is working without this "fix".



---

archive/issue_comments_496462.json:
```json
{
    "body": "<a id='comment:0'></a>\nAlso, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?\n\nRight now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log",
    "created_at": "2022-02-13T21:54:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496462",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:0'></a>
Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?

Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log



---

archive/issue_comments_496463.json:
```json
{
    "body": "<a id='comment:121'></a>\nReplying to [gh-tobiasdiez](#comment%3A119):\n> Replying to [mkoeppe](#comment%3A117):\n> > That failure was from `gcc`, not python. So why back out the fix for python?\n\n> \n> Since it is working without this \"fix\".\n\n\nBut what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.",
    "created_at": "2022-02-13T21:58:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496463",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:121'></a>
Replying to [gh-tobiasdiez](#comment%3A119):
> Replying to [mkoeppe](#comment%3A117):
> > That failure was from `gcc`, not python. So why back out the fix for python?

> 
> Since it is working without this "fix".


But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.



---

archive/issue_events_276571.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-14T10:45:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276571"
}
```



---

archive/issue_events_276572.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-14T10:45:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276572"
}
```



---

archive/issue_comments_496464.json:
```json
{
    "body": "**Changing commit** from \"[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)\" to \"[7b76d0b4e85640ddb7ff5427ca93270595cb3e71](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)\".",
    "created_at": "2022-02-14T12:56:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496464",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bd652746414a344a666261af7298631769dd94c3](https://github.com/sagemath/sagetrac-mirror/commit/bd652746414a344a666261af7298631769dd94c3)" to "[7b76d0b4e85640ddb7ff5427ca93270595cb3e71](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)".



---

archive/issue_comments_496465.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e49a2e341674a35115eeff683944e4bc926e128\">3e49a2e</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1423cdfdfb4d950228a6bb3c35d8037ebb5a571\">c1423cd</a></td><td><code>Force python</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71\">7b76d0b</a></td><td><code>Print logs</code></td></tr></table>\n",
    "created_at": "2022-02-14T12:56:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496465",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e49a2e341674a35115eeff683944e4bc926e128">3e49a2e</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1423cdfdfb4d950228a6bb3c35d8037ebb5a571">c1423cd</a></td><td><code>Force python</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71">7b76d0b</a></td><td><code>Print logs</code></td></tr></table>




---

archive/issue_comments_496466.json:
```json
{
    "body": "<a id='comment:124'></a>\nReplying to [mkoeppe](#comment%3A120):\n> Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?\n> \n> Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log\n\n\nDone.",
    "created_at": "2022-02-14T12:57:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496466",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:124'></a>
Replying to [mkoeppe](#comment%3A120):
> Also, could you please add some steps that package up the logs, like the three last steps of `local-ubuntu` in tox.yml?
> 
> Right now we cannot see what went wrong in the `gcc` detection, as we cannot see config.log


Done.



---

archive/issue_comments_496467.json:
```json
{
    "body": "<a id='comment:125'></a>\nReplying to [mkoeppe](#comment%3A121):\n> Replying to [gh-tobiasdiez](#comment%3A119):\n> > Replying to [mkoeppe](#comment%3A117):\n> > > That failure was from `gcc`, not python. So why back out the fix for python?\n\n> > \n> > Since it is working without this \"fix\".\n\n> \n> But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\n\nI still don't understand why it's so important that sage's configure script accepts conda's python, but I've added the explicit `--with-python` argument.",
    "created_at": "2022-02-14T12:58:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496467",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:125'></a>
Replying to [mkoeppe](#comment%3A121):
> Replying to [gh-tobiasdiez](#comment%3A119):
> > Replying to [mkoeppe](#comment%3A117):
> > > That failure was from `gcc`, not python. So why back out the fix for python?

> > 
> > Since it is working without this "fix".

> 
> But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.


I still don't understand why it's so important that sage's configure script accepts conda's python, but I've added the explicit `--with-python` argument.



---

archive/issue_comments_496468.json:
```json
{
    "body": "<a id='comment:6'></a>\n> I still don't understand why it's so important that sage's configure script accepts conda's python\n\n\nHow else would you expect to be using Conda's Python packages in Sage, if you used another Python?",
    "created_at": "2022-02-14T13:04:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496468",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
> I still don't understand why it's so important that sage's configure script accepts conda's python


How else would you expect to be using Conda's Python packages in Sage, if you used another Python?



---

archive/issue_comments_496469.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe workflow is completely bypassing the make-scripts of sage. So using Conda's python packages follows the 'usual' strategy:\n- Create (virtual) python environment (done by conda)\n- Install other python packages (done by conda)\n- Install sagelib into the same environment (done via pip install)\n\nSo sage is not managing the python installation nor the python environment. It is simply a normal python package that gets installed in an existing environment. In this context, it is pretty non-standard to pose more requirements at the python installation then a simple version requirement (which is checked by pip). Ideally, you wouldn't even want to call configure, a simple `pip install -e src` should be enough (and that's for example the workflow numpy and scipy are using), but that's of course currently not possible.",
    "created_at": "2022-02-14T14:42:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496469",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:7'></a>
The workflow is completely bypassing the make-scripts of sage. So using Conda's python packages follows the 'usual' strategy:
- Create (virtual) python environment (done by conda)
- Install other python packages (done by conda)
- Install sagelib into the same environment (done via pip install)

So sage is not managing the python installation nor the python environment. It is simply a normal python package that gets installed in an existing environment. In this context, it is pretty non-standard to pose more requirements at the python installation then a simple version requirement (which is checked by pip). Ideally, you wouldn't even want to call configure, a simple `pip install -e src` should be enough (and that's for example the workflow numpy and scipy are using), but that's of course currently not possible.



---

archive/issue_comments_496470.json:
```json
{
    "body": "<a id='comment:8'></a>\nOK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.\nPassing wrong parameters to `./configure` is not a good idea, IMHO.",
    "created_at": "2022-02-14T16:27:20Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496470",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.
Passing wrong parameters to `./configure` is not a good idea, IMHO.



---

archive/issue_comments_496471.json:
```json
{
    "body": "<a id='comment:129'></a>\nReplying to [gh-tobiasdiez](#comment%3A125):\n> > > Since it is working without this \"fix\".\n\n> > \n> > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\n> \n> I still don't understand why it's so important that sage's configure script accepts conda's python\n\n\nAs I said before in [comment:70](#comment%3A70), [comment:92](#comment%3A92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.",
    "created_at": "2022-02-14T17:09:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496471",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:129'></a>
Replying to [gh-tobiasdiez](#comment%3A125):
> > > Since it is working without this "fix".

> > 
> > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.

> 
> I still don't understand why it's so important that sage's configure script accepts conda's python


As I said before in [comment:70](#comment%3A70), [comment:92](#comment%3A92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.



---

archive/issue_comments_496472.json:
```json
{
    "body": "Replying to [ticket:30845 mkoeppe]:\n> - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n\n\nFor example, this one about `ecl-config` is the result of the misconfiguration. The configure script does not accept system ecl because of the misconfiguration `--without-system-gcc`. So the configuration reflects use of an ECL built using SPKG (which is not done because `make` is not involved).",
    "created_at": "2022-02-14T17:16:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496472",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [ticket:30845 mkoeppe]:
> - Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)


For example, this one about `ecl-config` is the result of the misconfiguration. The configure script does not accept system ecl because of the misconfiguration `--without-system-gcc`. So the configuration reflects use of an ECL built using SPKG (which is not done because `make` is not involved).



---

archive/issue_comments_496473.json:
```json
{
    "body": "<a id='comment:131'></a>\nReplying to [dimpase](#comment%3A128):\n> OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.\n> Passing wrong parameters to `./configure` is not a good idea, IMHO.\n\n\nSure, I agree with this!",
    "created_at": "2022-02-14T17:52:06Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496473",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:131'></a>
Replying to [dimpase](#comment%3A128):
> OK, but note that `./bootstrap` and `./configure` still need to be run to install various things and fill in `*.in` templates.
> Passing wrong parameters to `./configure` is not a good idea, IMHO.


Sure, I agree with this!



---

archive/issue_comments_496474.json:
```json
{
    "body": "<a id='comment:132'></a>\nReplying to [mkoeppe](#comment%3A129):\n> Replying to [gh-tobiasdiez](#comment%3A125):\n> > > > Since it is working without this \"fix\".\n\n> > > \n> > > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.\n\n> > \n> > I still don't understand why it's so important that sage's configure script accepts conda's python\n\n> \n> As I said before in [comment:70](#comment%3A70), [comment:92](#comment%3A92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\n\nNot sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. But regardless, adding these force statements doesn't currently work.",
    "created_at": "2022-02-14T17:53:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496474",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:132'></a>
Replying to [mkoeppe](#comment%3A129):
> Replying to [gh-tobiasdiez](#comment%3A125):
> > > > Since it is working without this "fix".

> > > 
> > > But what does it test? Currently certainly not installation steps that we could recommend to developers. The `configure` run should really reflect the system configuration.

> > 
> > I still don't understand why it's so important that sage's configure script accepts conda's python

> 
> As I said before in [comment:70](#comment%3A70), [comment:92](#comment%3A92), etc., the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.


Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. But regardless, adding these force statements doesn't currently work.



---

archive/issue_comments_496475.json:
```json
{
    "body": "<a id='comment:133'></a>\nReplying to [gh-tobiasdiez](#comment%3A132):\n> adding these force statements doesn't currently work.\n\n\nYou reported that `--with-system-gcc=force` does not work; what else does not work?",
    "created_at": "2022-02-14T17:56:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496475",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:133'></a>
Replying to [gh-tobiasdiez](#comment%3A132):
> adding these force statements doesn't currently work.


You reported that `--with-system-gcc=force` does not work; what else does not work?



---

archive/issue_comments_496476.json:
```json
{
    "body": "<a id='comment:134'></a>\nReplying to [mkoeppe](#comment%3A133):\n> Replying to [gh-tobiasdiez](#comment%3A132):\n> > adding these force statements doesn't currently work.\n\n> \n> You reported that `--with-system-gcc=force` does not work\n\n\n... and we can fix it if you show us the config.log",
    "created_at": "2022-02-14T18:01:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496476",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:134'></a>
Replying to [mkoeppe](#comment%3A133):
> Replying to [gh-tobiasdiez](#comment%3A132):
> > adding these force statements doesn't currently work.

> 
> You reported that `--with-system-gcc=force` does not work


... and we can fix it if you show us the config.log



---

archive/issue_comments_496477.json:
```json
{
    "body": "<a id='comment:5'></a>\nI didn't check the force argument, but ecl, arb, ntl, ppl are not recognized.",
    "created_at": "2022-02-14T18:03:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496477",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:5'></a>
I didn't check the force argument, but ecl, arb, ntl, ppl are not recognized.



---

archive/issue_comments_496478.json:
```json
{
    "body": "<a id='comment:6'></a>\nyes, because of the misconfigured gcc (I just explained it in [comment:130](#comment%3A130))",
    "created_at": "2022-02-14T18:07:00Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496478",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
yes, because of the misconfigured gcc (I just explained it in [comment:130](#comment%3A130))



---

archive/issue_comments_496479.json:
```json
{
    "body": "<a id='comment:137'></a>\nReplying to [gh-tobiasdiez](#comment%3A132):\n> > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\n> \n> Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. \n\n\nBoth.",
    "created_at": "2022-02-14T18:09:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496479",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:137'></a>
Replying to [gh-tobiasdiez](#comment%3A132):
> > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.

> 
> Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. 


Both.



---

archive/issue_comments_496480.json:
```json
{
    "body": "**Changing commit** from \"[7b76d0b4e85640ddb7ff5427ca93270595cb3e71](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)\" to \"[9af27b5b2c797a5e90cc0986870b695147029473](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)\".",
    "created_at": "2022-02-14T18:23:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7b76d0b4e85640ddb7ff5427ca93270595cb3e71](https://github.com/sagemath/sagetrac-mirror/commit/7b76d0b4e85640ddb7ff5427ca93270595cb3e71)" to "[9af27b5b2c797a5e90cc0986870b695147029473](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)".



---

archive/issue_comments_496481.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473\">9af27b5</a></td><td><code>Fix log output</code></td></tr></table>\n",
    "created_at": "2022-02-14T18:23:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496481",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473">9af27b5</a></td><td><code>Fix log output</code></td></tr></table>




---

archive/issue_comments_496482.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559\">5940d76</a></td><td><code>Try again with system gcc</code></td></tr></table>\n",
    "created_at": "2022-02-14T19:15:50Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496482",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559">5940d76</a></td><td><code>Try again with system gcc</code></td></tr></table>




---

archive/issue_comments_496483.json:
```json
{
    "body": "**Changing commit** from \"[9af27b5b2c797a5e90cc0986870b695147029473](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)\" to \"[5940d76d46fa1f5762f69f446d756a5a1ca38559](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)\".",
    "created_at": "2022-02-14T19:15:50Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9af27b5b2c797a5e90cc0986870b695147029473](https://github.com/sagemath/sagetrac-mirror/commit/9af27b5b2c797a5e90cc0986870b695147029473)" to "[5940d76d46fa1f5762f69f446d756a5a1ca38559](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)".



---

archive/issue_comments_496484.json:
```json
{
    "body": "<a id='comment:140'></a>\nReplying to [mkoeppe](#comment%3A137):\n> Replying to [gh-tobiasdiez](#comment%3A132):\n> > > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.\n\n> > \n> > Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. \n\n> \n> Both. \n\n\nWhat's the point of the force except that the workflow fails early? Wouldn't it make more sense to let it run through and see what error it produces?",
    "created_at": "2022-02-14T19:18:19Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496484",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:140'></a>
Replying to [mkoeppe](#comment%3A137):
> Replying to [gh-tobiasdiez](#comment%3A132):
> > > the configure script should really be invoked with `--with-system-xyz=force` for all packages for which we have `spkg-configure.m4`.

> > 
> > Not sure if that's really a good idea or if it would be better to just exclude versions of conda packages that are known to not work. 

> 
> Both. 


What's the point of the force except that the workflow fails early? Wouldn't it make more sense to let it run through and see what error it produces?



---

archive/issue_comments_496485.json:
```json
{
    "body": "<a id='comment:141'></a>\nReplying to [gh-tobiasdiez](#comment%3A140):\n> What's the point of the force except that the workflow fails early? \n\n\nFailing early is good. \n\n> Wouldn't it make more sense to let it run through and see what error it produces?\n\n\nNo, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.",
    "created_at": "2022-02-14T19:30:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496485",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:141'></a>
Replying to [gh-tobiasdiez](#comment%3A140):
> What's the point of the force except that the workflow fails early? 


Failing early is good. 

> Wouldn't it make more sense to let it run through and see what error it produces?


No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.



---

archive/issue_comments_496486.json:
```json
{
    "body": "<a id='comment:142'></a>\nReplying to [git](#comment%3A139):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559\">5940d76</a></td><td><code>Try again with system gcc</code></td></tr></table>\n\n\nLocally this fails, output can be found at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true in a bit.\n\nIt accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place). Nothing of this is specific to the github action and can easily be investigated after creating a conda env locally.\n\nBut can we do this error analysis and corresponding improvements please in a follow-up ticket? The version using prefix works with almost no test failures (apart from giac, which is broken and has already a ticket). Moreover, in this ticket, I tried to codify the instructions of the wiki in a github workflow. The instructions didn't work for me verbatim in a fresh clone, nor via the github action. The current version works relatively well in my eyes. I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.",
    "created_at": "2022-02-14T19:53:29Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496486",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:142'></a>
Replying to [git](#comment%3A139):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559">5940d76</a></td><td><code>Try again with system gcc</code></td></tr></table>


Locally this fails, output can be found at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true in a bit.

It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place). Nothing of this is specific to the github action and can easily be investigated after creating a conda env locally.

But can we do this error analysis and corresponding improvements please in a follow-up ticket? The version using prefix works with almost no test failures (apart from giac, which is broken and has already a ticket). Moreover, in this ticket, I tried to codify the instructions of the wiki in a github workflow. The instructions didn't work for me verbatim in a fresh clone, nor via the github action. The current version works relatively well in my eyes. I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.



---

archive/issue_comments_496487.json:
```json
{
    "body": "<a id='comment:143'></a>\nReplying to [mkoeppe](#comment%3A141):\n> Replying to [gh-tobiasdiez](#comment%3A140):\n> > What's the point of the force except that the workflow fails early? \n\n> \n> Failing early is good. \n> \n> > Wouldn't it make more sense to let it run through and see what error it produces?\n\n> \n> No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.\n> \n\n\nWhat about adding a warning annotation in the github workflow when a system package is not recognized? Then you still get the information that the config didn't work as expected but keep the benefit of seeing error messages. This should become helpful down the road, as the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.",
    "created_at": "2022-02-14T19:57:00Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496487",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:143'></a>
Replying to [mkoeppe](#comment%3A141):
> Replying to [gh-tobiasdiez](#comment%3A140):
> > What's the point of the force except that the workflow fails early? 

> 
> Failing early is good. 
> 
> > Wouldn't it make more sense to let it run through and see what error it produces?

> 
> No, because we do not want to send developers to manually diagnose build or run problems that have already been diagnosed and codified in our configure tests.
> 


What about adding a warning annotation in the github workflow when a system package is not recognized? Then you still get the information that the config didn't work as expected but keep the benefit of seeing error messages. This should become helpful down the road, as the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.



---

archive/issue_comments_496488.json:
```json
{
    "body": "<a id='comment:4'></a>\ncomment:121 - the workflow should be testing something that we can recommend to developers. As of the current branch it's \"let's misconfigure creatively so that configure does not end with an error; please ignore everything that the configure script says because it does not matter. There may be errors in build and run later, YMMV.\"",
    "created_at": "2022-02-14T19:58:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496488",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
comment:121 - the workflow should be testing something that we can recommend to developers. As of the current branch it's "let's misconfigure creatively so that configure does not end with an error; please ignore everything that the configure script says because it does not matter. There may be errors in build and run later, YMMV."



---

archive/issue_comments_496489.json:
```json
{
    "body": "<a id='comment:145'></a>\nReplying to [gh-tobiasdiez](#comment%3A142):\n> I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.\n\n\nI've already offered to fix the problem with `--with-system-gcc=force`",
    "created_at": "2022-02-14T20:02:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496489",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:145'></a>
Replying to [gh-tobiasdiez](#comment%3A142):
> I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.


I've already offered to fix the problem with `--with-system-gcc=force`



---

archive/issue_comments_496490.json:
```json
{
    "body": "<a id='comment:146'></a>\nReplying to [gh-tobiasdiez](#comment%3A142):\n> It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\n\nThese reports would be more useful if you attach the config.log",
    "created_at": "2022-02-14T20:09:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496490",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:146'></a>
Replying to [gh-tobiasdiez](#comment%3A142):
> It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).


These reports would be more useful if you attach the config.log



---

archive/issue_comments_496491.json:
```json
{
    "body": "<a id='comment:147'></a>\nReplying to [mkoeppe](#comment%3A145):\n> Replying to [gh-tobiasdiez](#comment%3A142):\n> > I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.\n\n> \n> I've already offered to fix the problem with `--with-system-gcc=force`\n\n\nCan you please give the full commands that create a working conda env and are able to recognize gcc and ecl. As you can see here `with-system-gcc` doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true",
    "created_at": "2022-02-14T20:10:13Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496491",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:147'></a>
Replying to [mkoeppe](#comment%3A145):
> Replying to [gh-tobiasdiez](#comment%3A142):
> > I'm happy to try a different combination of commands, but then please check yourself that these work locally for you.

> 
> I've already offered to fix the problem with `--with-system-gcc=force`


Can you please give the full commands that create a working conda env and are able to recognize gcc and ecl. As you can see here `with-system-gcc` doesn't work: https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true



---

archive/issue_comments_496492.json:
```json
{
    "body": "<a id='comment:148'></a>\nReplying to [mkoeppe](#comment%3A146):\n> Replying to [gh-tobiasdiez](#comment%3A142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\n> \n> These reports would be more useful if you attach the config.log\n> \n\n((Yes, it's available now at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true)",
    "created_at": "2022-02-14T20:10:48Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496492",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:148'></a>
Replying to [mkoeppe](#comment%3A146):
> Replying to [gh-tobiasdiez](#comment%3A142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).

> 
> These reports would be more useful if you attach the config.log
> 

((Yes, it's available now at https://github.com/sagemath/sagetrac-mirror/runs/5189468934?check_suite_focus=true)



---

archive/attachments_021438.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "config.log",
    "asset_url": "tarball://root/attachments/ticket30845/config.log",
    "created_at": "2022-02-14T20:19:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket30845/config.log",
    "user": "https://github.com/tobiasdiez"
}
```



---

archive/issue_comments_496493.json:
```json
{
    "body": "<a id='comment:149'></a>\nAttachment [config.log](https://github.com/sagemath/sage/files/ticket30845/config.log) by @tobiasdiez created at 2022-02-14 20:19:01\n\nReplying to [mkoeppe](#comment%3A146):\n> Replying to [gh-tobiasdiez](#comment%3A142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).\n\n> \n> These reports would be more useful if you attach the config.log\n> \n\n\nNow attached to the ticket.",
    "created_at": "2022-02-14T20:19:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496493",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:149'></a>
Attachment [config.log](https://github.com/sagemath/sage/files/ticket30845/config.log) by @tobiasdiez created at 2022-02-14 20:19:01

Replying to [mkoeppe](#comment%3A146):
> Replying to [gh-tobiasdiez](#comment%3A142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part. But then a few other packages are still not properly recognized:  `ecl bdw-gc libhomfly` (which was the reason why I added the prefix in the first place).

> 
> These reports would be more useful if you attach the config.log
> 


Now attached to the ticket.



---

archive/issue_comments_496494.json:
```json
{
    "body": "<a id='comment:150'></a>\nReplying to [mkoeppe](#comment%3A146):\n> Replying to [gh-tobiasdiez](#comment%3A142):\n> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part.\n\n\nOK, here's why it does not accept it when the (questionable, but perhaps currently necessary) option `--prefix=$CONDA_PREFIX` is given:\n`build/pkgs/gcc/spkg-configure.m4` has these lines:\n\n```\n    if test -f \"$SAGE_LOCAL/bin/gcc\"; then\n        # Special value for SAGE_INSTALL_GCC if GCC is already installed\n        SAGE_INSTALL_GCC=exists\n        # Set yes since this implies we have already installed GCC and want to keep\n        # it selected\n        sage_spkg_install_gcc=yes\n\n        # Check whether it actually works...\n        # See https://trac.sagemath.org/ticket/24599\n        SAGE_CHECK_BROKEN_GCC()\n[...]\n```",
    "created_at": "2022-02-14T20:23:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496494",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:150'></a>
Replying to [mkoeppe](#comment%3A146):
> Replying to [gh-tobiasdiez](#comment%3A142):
> > It accepts the conda gcc if I remove the `--prefix=$CONDA_PREFIX` part.


OK, here's why it does not accept it when the (questionable, but perhaps currently necessary) option `--prefix=$CONDA_PREFIX` is given:
`build/pkgs/gcc/spkg-configure.m4` has these lines:

```
    if test -f "$SAGE_LOCAL/bin/gcc"; then
        # Special value for SAGE_INSTALL_GCC if GCC is already installed
        SAGE_INSTALL_GCC=exists
        # Set yes since this implies we have already installed GCC and want to keep
        # it selected
        sage_spkg_install_gcc=yes

        # Check whether it actually works...
        # See https://trac.sagemath.org/ticket/24599
        SAGE_CHECK_BROKEN_GCC()
[...]
```



---

archive/issue_comments_496495.json:
```json
{
    "body": "<a id='comment:1'></a>\nI'll work on a fix for this later today.",
    "created_at": "2022-02-14T20:25:18Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496495",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
I'll work on a fix for this later today.



---

archive/issue_comments_496496.json:
```json
{
    "body": "<a id='comment:152'></a>\nReplying to [gh-tobiasdiez](#comment%3A149):\n> Replying to [mkoeppe](#comment%3A146):\n> > These reports would be more useful if you attach the config.log\n\n> \n> Now attached to the ticket.\n\n\nThanks. From config.log:\n\n```\n## --------------------------------------------------- ##\n## Checking whether SageMath should install SPKG gc... ##\n## --------------------------------------------------- ##\nconfigure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG\nconfigure:19437: result: no\nconfigure:19440: checking whether we run on WSL\nconfigure:19444: result: yes; disabling using of system gc\nconfigure:19693: no suitable system package found for SPKG gc\n```\nThis is why `ecl` and `homfly` are not used.",
    "created_at": "2022-02-14T20:29:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496496",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:152'></a>
Replying to [gh-tobiasdiez](#comment%3A149):
> Replying to [mkoeppe](#comment%3A146):
> > These reports would be more useful if you attach the config.log

> 
> Now attached to the ticket.


Thanks. From config.log:

```
## --------------------------------------------------- ##
## Checking whether SageMath should install SPKG gc... ##
## --------------------------------------------------- ##
configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG
configure:19437: result: no
configure:19440: checking whether we run on WSL
configure:19444: result: yes; disabling using of system gc
configure:19693: no suitable system package found for SPKG gc
```
This is why `ecl` and `homfly` are not used.



---

archive/issue_comments_496497.json:
```json
{
    "body": "<a id='comment:3'></a>\n`ecl` is rejected because `gc` is rejected on WSL, see #30629: Reject system libgc that breaks ECL build on WSL\n\nThis rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)",
    "created_at": "2022-02-14T20:29:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496497",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
`ecl` is rejected because `gc` is rejected on WSL, see #30629: Reject system libgc that breaks ECL build on WSL

This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)



---

archive/issue_comments_496498.json:
```json
{
    "body": "<a id='comment:154'></a>\nReplying to [dimpase](#comment%3A153):\n> This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)\n\n\nThis one is pretty subtle. `gc` is used by both ECL and libhomfly. So only if BOTH can be used from the system, then we do not need to build `gc` itself.",
    "created_at": "2022-02-14T20:31:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496498",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:154'></a>
Replying to [dimpase](#comment%3A153):
> This rejection should not happen if ECL is already provided, I think. (ditto for the other consumers of `gc` - `libhomfly`)


This one is pretty subtle. `gc` is used by both ECL and libhomfly. So only if BOTH can be used from the system, then we do not need to build `gc` itself.



---

archive/issue_comments_496499.json:
```json
{
    "body": "<a id='comment:5'></a>\nActually, Jammy already has fixed `gc`.\nhttps://launchpad.net/ubuntu/+source/libgc\nhttps://bugs.launchpad.net/ubuntu/+source/libgc/+bug/1897371/comments/1",
    "created_at": "2022-02-14T20:39:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496499",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
Actually, Jammy already has fixed `gc`.
https://launchpad.net/ubuntu/+source/libgc
https://bugs.launchpad.net/ubuntu/+source/libgc/+bug/1897371/comments/1



---

archive/issue_comments_496500.json:
```json
{
    "body": "<a id='comment:6'></a>\nSo we need an improved test",
    "created_at": "2022-02-14T20:42:27Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496500",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
So we need an improved test



---

archive/issue_comments_496501.json:
```json
{
    "body": "<a id='comment:7'></a>\nis it `gc`  from Conda (it should be OK, right?)",
    "created_at": "2022-02-14T20:48:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496501",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
is it `gc`  from Conda (it should be OK, right?)



---

archive/issue_comments_496502.json:
```json
{
    "body": "<a id='comment:158'></a>\nReplying to [dimpase](#comment%3A157):\n> is it `gc`  from Conda (it should be OK, right?)\n\n\nYes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17",
    "created_at": "2022-02-14T20:55:11Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496502",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:158'></a>
Replying to [dimpase](#comment%3A157):
> is it `gc`  from Conda (it should be OK, right?)


Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17



---

archive/issue_comments_496503.json:
```json
{
    "body": "**Changing commit** from \"[5940d76d46fa1f5762f69f446d756a5a1ca38559](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)\" to \"[970b01e290cf96f0d5607064c10fa360bf8e720c](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)\".",
    "created_at": "2022-02-14T21:01:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496503",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5940d76d46fa1f5762f69f446d756a5a1ca38559](https://github.com/sagemath/sagetrac-mirror/commit/5940d76d46fa1f5762f69f446d756a5a1ca38559)" to "[970b01e290cf96f0d5607064c10fa360bf8e720c](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)".



---

archive/issue_comments_496504.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c\">970b01e</a></td><td><code>Remove conda prefx</code></td></tr></table>\n",
    "created_at": "2022-02-14T21:01:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c">970b01e</a></td><td><code>Remove conda prefx</code></td></tr></table>




---

archive/issue_comments_496505.json:
```json
{
    "body": "<a id='comment:0'></a>\nConda's gc would only be too old if it were built with a particular option.\n\nThey probably use it to build ecl, and it won't fly if it was broken!",
    "created_at": "2022-02-14T21:04:18Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496505",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
Conda's gc would only be too old if it were built with a particular option.

They probably use it to build ecl, and it won't fly if it was broken!



---

archive/issue_comments_496506.json:
```json
{
    "body": "**Changing commit** from \"[970b01e290cf96f0d5607064c10fa360bf8e720c](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)\" to \"[9799fd7584ff844149cc1005e6629a25cdcb8b9a](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)\".",
    "created_at": "2022-02-14T21:07:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[970b01e290cf96f0d5607064c10fa360bf8e720c](https://github.com/sagemath/sagetrac-mirror/commit/970b01e290cf96f0d5607064c10fa360bf8e720c)" to "[9799fd7584ff844149cc1005e6629a25cdcb8b9a](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)".



---

archive/issue_comments_496507.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a\">9799fd7</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr></table>\n",
    "created_at": "2022-02-14T21:07:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a">9799fd7</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr></table>




---

archive/issue_comments_496508.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere's an attempt, not really tested yet",
    "created_at": "2022-02-14T21:07:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496508",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Here's an attempt, not really tested yet



---

archive/issue_comments_496509.json:
```json
{
    "body": "**Changing commit** from \"[9799fd7584ff844149cc1005e6629a25cdcb8b9a](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)\" to \"[757bd73e08627853311ff17680b04417b2847de5](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)\".",
    "created_at": "2022-02-14T23:21:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496509",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9799fd7584ff844149cc1005e6629a25cdcb8b9a](https://github.com/sagemath/sagetrac-mirror/commit/9799fd7584ff844149cc1005e6629a25cdcb8b9a)" to "[757bd73e08627853311ff17680b04417b2847de5](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)".



---

archive/issue_comments_496510.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcf3dde352aa6d53d3143f796d4702c11475bda0\">dcf3dde</a></td><td><code>Revert \"Remove conda prefx\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5\">757bd73</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr></table>\n",
    "created_at": "2022-02-14T23:21:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcf3dde352aa6d53d3143f796d4702c11475bda0">dcf3dde</a></td><td><code>Revert "Remove conda prefx"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5">757bd73</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr></table>




---

archive/issue_comments_496511.json:
```json
{
    "body": "<a id='comment:4'></a>\nTested locally with `EXTRA_CONFIGURE_ARGS=--prefix=/opt/conda tox -e docker-conda-forge-standard -- config.status`",
    "created_at": "2022-02-14T23:21:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496511",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Tested locally with `EXTRA_CONFIGURE_ARGS=--prefix=/opt/conda tox -e docker-conda-forge-standard -- config.status`



---

archive/issue_comments_496512.json:
```json
{
    "body": "<a id='comment:165'></a>\nReplying to [mkoeppe](#comment%3A91):\n> I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...\n\n\nNow I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.",
    "created_at": "2022-02-15T01:57:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496512",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:165'></a>
Replying to [mkoeppe](#comment%3A91):
> I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...


Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.



---

archive/issue_comments_496513.json:
```json
{
    "body": "**Dependencies:** #33330, #33345",
    "created_at": "2022-02-15T01:57:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496513",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #33330, #33345



---

archive/issue_comments_496514.json:
```json
{
    "body": "**Changing commit** from \"[757bd73e08627853311ff17680b04417b2847de5](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)\" to \"[b4f76aa13dfc153ff811da654d0ee543d99afca7](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)\".",
    "created_at": "2022-02-15T02:05:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496514",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[757bd73e08627853311ff17680b04417b2847de5](https://github.com/sagemath/sagetrac-mirror/commit/757bd73e08627853311ff17680b04417b2847de5)" to "[b4f76aa13dfc153ff811da654d0ee543d99afca7](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)".



---

archive/issue_comments_496515.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919\">613198a</a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/566664d7a3e1994af407ab8b20cdf210a35bf8d8\">566664d</a></td><td><code>Merge #33330</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dda3c48bf82ccfcbc3b7b5e3a1cee5c27b9aaca6\">dda3c48</a></td><td><code>configure --with-system-standard-packages: New option</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc8aaa38981cb2d71f894b7b5ee5aab1341630a0\">bc8aaa3</a></td><td><code>Merge #33345</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7\">b4f76aa</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>\n",
    "created_at": "2022-02-15T02:05:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919">613198a</a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/566664d7a3e1994af407ab8b20cdf210a35bf8d8">566664d</a></td><td><code>Merge #33330</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dda3c48bf82ccfcbc3b7b5e3a1cee5c27b9aaca6">dda3c48</a></td><td><code>configure --with-system-standard-packages: New option</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc8aaa38981cb2d71f894b7b5ee5aab1341630a0">bc8aaa3</a></td><td><code>Merge #33345</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7">b4f76aa</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>




---

archive/issue_comments_496516.json:
```json
{
    "body": "**Changing commit** from \"[b4f76aa13dfc153ff811da654d0ee543d99afca7](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)\" to \"[a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)\".",
    "created_at": "2022-02-15T04:26:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b4f76aa13dfc153ff811da654d0ee543d99afca7](https://github.com/sagemath/sagetrac-mirror/commit/b4f76aa13dfc153ff811da654d0ee543d99afca7)" to "[a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)".



---

archive/issue_comments_496517.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bbaf448bad39f543ccf06860fa72c457a0d65fd\">3bbaf44</a></td><td><code>bootstrap: Only use SPKG_USE_SYSTEM_STANDARD_PACKAGES for packages with spkg-configure.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2998104fad3cc2b16f19b7a85e4e0d84144741b1\">2998104</a></td><td><code>Merge #33345</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc\">a9812f3</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>\n",
    "created_at": "2022-02-15T04:26:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bbaf448bad39f543ccf06860fa72c457a0d65fd">3bbaf44</a></td><td><code>bootstrap: Only use SPKG_USE_SYSTEM_STANDARD_PACKAGES for packages with spkg-configure.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2998104fad3cc2b16f19b7a85e4e0d84144741b1">2998104</a></td><td><code>Merge #33345</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc">a9812f3</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-standard-packages=force</code></td></tr></table>




---

archive/issue_comments_496518.json:
```json
{
    "body": "<a id='comment:168'></a>\nReplying to [mkoeppe](#comment%3A152):\n> Replying to [gh-tobiasdiez](#comment%3A149):\n> > Replying to [mkoeppe](#comment%3A146):\n> > > These reports would be more useful if you attach the config.log\n\n> > \n> > Now attached to the ticket.\n\n> \n> Thanks. From config.log:\n> \n> ```\n> ## --------------------------------------------------- ##\n> ## Checking whether SageMath should install SPKG gc... ##\n> ## --------------------------------------------------- ##\n> configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG\n> configure:19437: result: no\n> configure:19440: checking whether we run on WSL\n> configure:19444: result: yes; disabling using of system gc\n> configure:19693: no suitable system package found for SPKG gc\n> ```\n> This is why `ecl` and `homfly` are not used.\n\n\nThat makes sense. Sorry, should have investigated this before deviating from the instructions outlined in the wiki. Thanks for your patience and investigation.",
    "created_at": "2022-02-15T12:15:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496518",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:168'></a>
Replying to [mkoeppe](#comment%3A152):
> Replying to [gh-tobiasdiez](#comment%3A149):
> > Replying to [mkoeppe](#comment%3A146):
> > > These reports would be more useful if you attach the config.log

> > 
> > Now attached to the ticket.

> 
> Thanks. From config.log:
> 
> ```
> ## --------------------------------------------------- ##
> ## Checking whether SageMath should install SPKG gc... ##
> ## --------------------------------------------------- ##
> configure:19428: checking whether any of libatomic_ops is installed as or will be installed as SPKG
> configure:19437: result: no
> configure:19440: checking whether we run on WSL
> configure:19444: result: yes; disabling using of system gc
> configure:19693: no suitable system package found for SPKG gc
> ```
> This is why `ecl` and `homfly` are not used.


That makes sense. Sorry, should have investigated this before deviating from the instructions outlined in the wiki. Thanks for your patience and investigation.



---

archive/issue_comments_496519.json:
```json
{
    "body": "<a id='comment:169'></a>\nReplying to [mkoeppe](#comment%3A165):\n> Replying to [mkoeppe](#comment%3A91):\n> > I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...\n\n> \n> Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.\n\n\nticket:30845#comment:143 ?",
    "created_at": "2022-02-15T12:16:35Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496519",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:169'></a>
Replying to [mkoeppe](#comment%3A165):
> Replying to [mkoeppe](#comment%3A91):
> > I don't have a better solution at the moment, but at least there's a reasonably short way to write it as `configure --with-system-{gcc,lcalc}=force`...

> 
> Now I have a better solution: With #33345, we can use `configure --with-system-standard-packages=force`.


ticket:30845#comment:143 ?



---

archive/issue_comments_496520.json:
```json
{
    "body": "<a id='comment:170'></a>\nReplying to [gh-tobiasdiez](#comment%3A158):\n> Replying to [dimpase](#comment%3A157):\n> > is it `gc`  from Conda (it should be OK, right?)\n\n> \n> Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17\n\n\nUpstream says one has to check that\n\n```\nstrings /usr/lib/x86_64-linux-gnu/libgc.so | grep \"Wrong __data_start/_end pair\"\n``` \ndoes not find anything. But this rules out all 8.0.4 (and possibly earlier) installations of libgc, not only broken ones.",
    "created_at": "2022-02-15T12:21:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496520",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:170'></a>
Replying to [gh-tobiasdiez](#comment%3A158):
> Replying to [dimpase](#comment%3A157):
> > is it `gc`  from Conda (it should be OK, right?)

> 
> Yes it's bdw-gc 8.0.4, which is probably to old. There is a PR updating to 8.0.6 but that's unmerged for quite some time now https://github.com/conda-forge/bdw-gc-feedstock/pull/17


Upstream says one has to check that

```
strings /usr/lib/x86_64-linux-gnu/libgc.so | grep "Wrong __data_start/_end pair"
``` 
does not find anything. But this rules out all 8.0.4 (and possibly earlier) installations of libgc, not only broken ones.



---

archive/issue_comments_496521.json:
```json
{
    "body": "<a id='comment:171'></a>\nReplying to [gh-tobiasdiez](#comment%3A143):\n> What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n\nWe don't have a mechanism for that, see discussion in #29499.",
    "created_at": "2022-02-15T15:55:42Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496521",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:171'></a>
Replying to [gh-tobiasdiez](#comment%3A143):
> What about adding a warning annotation in the github workflow when a system package is not recognized? 


We don't have a mechanism for that, see discussion in #29499.



---

archive/issue_comments_496522.json:
```json
{
    "body": "<a id='comment:172'></a>\nReplying to [gh-tobiasdiez](#comment%3A143):\n> the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\n\nThat's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo",
    "created_at": "2022-02-15T15:59:11Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496522",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:172'></a>
Replying to [gh-tobiasdiez](#comment%3A143):
> the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.


That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo



---

archive/issue_comments_496523.json:
```json
{
    "body": "<a id='comment:3'></a>\nHow about adding another job (via matrix) that uses `src/environment-optional.yml`?",
    "created_at": "2022-02-15T16:03:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496523",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
How about adding another job (via matrix) that uses `src/environment-optional.yml`?



---

archive/issue_comments_496524.json:
```json
{
    "body": "<a id='comment:4'></a>\nAlso, adding jobs that test other python versions could probably be useful",
    "created_at": "2022-02-15T16:07:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496524",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Also, adding jobs that test other python versions could probably be useful



---

archive/issue_comments_496525.json:
```json
{
    "body": "<a id='comment:175'></a>\nReplying to [mkoeppe](#comment%3A171):\n> Replying to [gh-tobiasdiez](#comment%3A143):\n> > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> \n> We don't have a mechanism for that, see discussion in #29499.\n\n\nOne could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.",
    "created_at": "2022-02-15T16:49:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496525",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:175'></a>
Replying to [mkoeppe](#comment%3A171):
> Replying to [gh-tobiasdiez](#comment%3A143):
> > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> 
> We don't have a mechanism for that, see discussion in #29499.


One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.



---

archive/issue_comments_496526.json:
```json
{
    "body": "<a id='comment:176'></a>\nReplying to [mkoeppe](#comment%3A173):\n> How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n\nProbably wait with this until this workflow here passes without errors. There is not much of an advantage in having 5 different matrix flows fail.",
    "created_at": "2022-02-15T16:51:25Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496526",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:176'></a>
Replying to [mkoeppe](#comment%3A173):
> How about adding another job (via matrix) that uses `src/environment-optional.yml`?


Probably wait with this until this workflow here passes without errors. There is not much of an advantage in having 5 different matrix flows fail.



---

archive/issue_comments_496527.json:
```json
{
    "body": "<a id='comment:177'></a>\nReplying to [mkoeppe](#comment%3A172):\n> Replying to [gh-tobiasdiez](#comment%3A143):\n> > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\n> \n> That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo\n\n\nBut in this case the workflow does not simply fail because the package is not accepted, right?",
    "created_at": "2022-02-15T16:52:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496527",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:177'></a>
Replying to [mkoeppe](#comment%3A172):
> Replying to [gh-tobiasdiez](#comment%3A143):
> > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.

> 
> That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo


But in this case the workflow does not simply fail because the package is not accepted, right?



---

archive/issue_comments_496528.json:
```json
{
    "body": "<a id='comment:178'></a>\nReplying to [gh-tobiasdiez](#comment%3A175):\n> Replying to [mkoeppe](#comment%3A171):\n> > Replying to [gh-tobiasdiez](#comment%3A143):\n> > > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> > \n> > We don't have a mechanism for that, see discussion in #29499.\n\n> \n> One could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.\n\n\nNo, the problem is that the configuration variables need to be set for the accepted system packages. ticket:29499#comment:3",
    "created_at": "2022-02-15T17:04:17Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496528",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:178'></a>
Replying to [gh-tobiasdiez](#comment%3A175):
> Replying to [mkoeppe](#comment%3A171):
> > Replying to [gh-tobiasdiez](#comment%3A143):
> > > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> > 
> > We don't have a mechanism for that, see discussion in #29499.

> 
> One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.


No, the problem is that the configuration variables need to be set for the accepted system packages. ticket:29499#comment:3



---

archive/issue_comments_496529.json:
```json
{
    "body": "<a id='comment:179'></a>\nReplying to [gh-tobiasdiez](#comment%3A176):\n> Replying to [mkoeppe](#comment%3A173):\n> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> \n> Probably wait with this until this workflow here passes without errors. \n\n\nJust reduce the errors in the `ptest` to warnings. This would be in line with the entire portability test suite.",
    "created_at": "2022-02-15T17:05:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496529",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:179'></a>
Replying to [gh-tobiasdiez](#comment%3A176):
> Replying to [mkoeppe](#comment%3A173):
> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> 
> Probably wait with this until this workflow here passes without errors. 


Just reduce the errors in the `ptest` to warnings. This would be in line with the entire portability test suite.



---

archive/issue_comments_496530.json:
```json
{
    "body": "<a id='comment:180'></a>\nReplying to [gh-tobiasdiez](#comment%3A177):\n> Replying to [mkoeppe](#comment%3A172):\n> > Replying to [gh-tobiasdiez](#comment%3A143):\n> > > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.\n\n> > \n> > That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo\n\n> \n> But in this case the workflow does not simply fail because the package is not accepted, right?\n\n\nThat's right, Sage will just build the SPKG.",
    "created_at": "2022-02-15T17:20:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496530",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:180'></a>
Replying to [gh-tobiasdiez](#comment%3A177):
> Replying to [mkoeppe](#comment%3A172):
> > Replying to [gh-tobiasdiez](#comment%3A143):
> > > the conda packages are quite up to date and thus may fail to be recognized for the simple reason that they are too new.

> > 
> > That's not really specific to conda-forge but also true for various cutting-edge distributions including archlinux and gentoo

> 
> But in this case the workflow does not simply fail because the package is not accepted, right?


That's right, Sage will just build the SPKG.



---

archive/issue_comments_496531.json:
```json
{
    "body": "<a id='comment:1'></a>\nWhen a Sage user/developer follows our (to-be-updated) instructions with `--with-system-standard-packages=force` and it gives the configure error regarding the unsuitable system package, there is a clear recourse: Find and install a version that works.\n\nWhen Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in `conda.txt` files if possible; or file a conda bug report. \n\nSeeing error messages from using a system package that `configure` knows to reject does not help. It only leads to developers engaging in unproductive guesswork. \n\nFor updating Sage and our `spkg-configure.m4` scripts to work with new versions, local development and testing on many platforms is necessary anyway; it does not help if there's 1 platform that already speculatively displays some errors.",
    "created_at": "2022-02-15T17:28:32Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496531",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
When a Sage user/developer follows our (to-be-updated) instructions with `--with-system-standard-packages=force` and it gives the configure error regarding the unsuitable system package, there is a clear recourse: Find and install a version that works.

When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in `conda.txt` files if possible; or file a conda bug report. 

Seeing error messages from using a system package that `configure` knows to reject does not help. It only leads to developers engaging in unproductive guesswork. 

For updating Sage and our `spkg-configure.m4` scripts to work with new versions, local development and testing on many platforms is necessary anyway; it does not help if there's 1 platform that already speculatively displays some errors.



---

archive/issue_comments_496532.json:
```json
{
    "body": "<a id='comment:182'></a>\nReplying to [mkoeppe](#comment%3A178):\n> Replying to [gh-tobiasdiez](#comment%3A175):\n> > Replying to [mkoeppe](#comment%3A171):\n> > > Replying to [gh-tobiasdiez](#comment%3A143):\n> > > > What about adding a warning annotation in the github workflow when a system package is not recognized? \n\n> > > \n> > > We don't have a mechanism for that, see discussion in #29499.\n\n> > \n> > One could add a problem matcher for \"no suitable system package; standard, will be installed as an SPKG\" for now.\n\n> \n> No, the problem is that the configuration variables need to be set for the accepted system packages. ticket:29499#comment:3\n> \n\n\nI meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview.",
    "created_at": "2022-02-15T17:31:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496532",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:182'></a>
Replying to [mkoeppe](#comment%3A178):
> Replying to [gh-tobiasdiez](#comment%3A175):
> > Replying to [mkoeppe](#comment%3A171):
> > > Replying to [gh-tobiasdiez](#comment%3A143):
> > > > What about adding a warning annotation in the github workflow when a system package is not recognized? 

> > > 
> > > We don't have a mechanism for that, see discussion in #29499.

> > 
> > One could add a problem matcher for "no suitable system package; standard, will be installed as an SPKG" for now.

> 
> No, the problem is that the configuration variables need to be set for the accepted system packages. ticket:29499#comment:3
> 


I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview.



---

archive/issue_comments_496533.json:
```json
{
    "body": "<a id='comment:183'></a>\nReplying to [gh-tobiasdiez](#comment%3A182):\n> I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\n\nSure, +1 on that, that's a good idea.",
    "created_at": "2022-02-15T17:32:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496533",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:183'></a>
Replying to [gh-tobiasdiez](#comment%3A182):
> I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 


Sure, +1 on that, that's a good idea.



---

archive/issue_comments_496534.json:
```json
{
    "body": "<a id='comment:4'></a>\nI have some of this in tox.yml, matching configure warnings and error",
    "created_at": "2022-02-15T17:35:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496534",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
I have some of this in tox.yml, matching configure warnings and error



---

archive/issue_comments_496535.json:
```json
{
    "body": "**Changing commit** from \"[a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)\" to \"[6ff193fe4608756ee7b99b0b9f465beaab5bc7bf](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)\".",
    "created_at": "2022-02-15T18:02:59Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc](https://github.com/sagemath/sagetrac-mirror/commit/a9812f3bd9e1780f3e3f94a8a84fc89afb4953dc)" to "[6ff193fe4608756ee7b99b0b9f465beaab5bc7bf](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)".



---

archive/issue_comments_496536.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec\">c1c9e61</a></td><td><code>Add matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf\">6ff193f</a></td><td><code>Add problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-15T18:02:59Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec">c1c9e61</a></td><td><code>Add matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf">6ff193f</a></td><td><code>Add problem matcher</code></td></tr></table>




---

archive/issue_comments_496537.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b\">3a25ddb</a></td><td><code>Fix path to problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-15T20:49:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b">3a25ddb</a></td><td><code>Fix path to problem matcher</code></td></tr></table>




---

archive/issue_comments_496538.json:
```json
{
    "body": "**Changing commit** from \"[6ff193fe4608756ee7b99b0b9f465beaab5bc7bf](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)\" to \"[3a25ddbe43563899df90142213fc99622e8a050b](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)\".",
    "created_at": "2022-02-15T20:49:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6ff193fe4608756ee7b99b0b9f465beaab5bc7bf](https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf)" to "[3a25ddbe43563899df90142213fc99622e8a050b](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)".



---

archive/issue_comments_496539.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b\">a3fd48c</a></td><td><code>Improve problem matcher</code></td></tr></table>\n",
    "created_at": "2022-02-16T11:08:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b">a3fd48c</a></td><td><code>Improve problem matcher</code></td></tr></table>




---

archive/issue_comments_496540.json:
```json
{
    "body": "**Changing commit** from \"[3a25ddbe43563899df90142213fc99622e8a050b](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)\" to \"[a3fd48c0337090a9a042977600eb9f2832b77c1b](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)\".",
    "created_at": "2022-02-16T11:08:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496540",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3a25ddbe43563899df90142213fc99622e8a050b](https://github.com/sagemath/sagetrac-mirror/commit/3a25ddbe43563899df90142213fc99622e8a050b)" to "[a3fd48c0337090a9a042977600eb9f2832b77c1b](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)".



---

archive/issue_comments_496541.json:
```json
{
    "body": "<a id='comment:188'></a>\nReplying to [mkoeppe](#comment%3A183):\n> Replying to [gh-tobiasdiez](#comment%3A182):\n> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\n> \n> Sure, +1 on that, that's a good idea.\n\n\nOkay, this is now implemented. See https://github.com/sagemath/sagetrac-mirror/actions/runs/1852417654",
    "created_at": "2022-02-16T12:32:03Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496541",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:188'></a>
Replying to [mkoeppe](#comment%3A183):
> Replying to [gh-tobiasdiez](#comment%3A182):
> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 

> 
> Sure, +1 on that, that's a good idea.


Okay, this is now implemented. See https://github.com/sagemath/sagetrac-mirror/actions/runs/1852417654



---

archive/issue_comments_496542.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe tests now fail with the following error:\n\n```\n************************************************************************\nIt seems that you are attempting to run Sage from an unpacked source\ntarball, but you have not compiled it yet (or maybe the build has not\nfinished). You should run `make` in the Sage root directory first.\nIf you did not intend to build Sage from source, you should download\na binary tarball instead. Read README.txt for more information.\n************************************************************************\n```\nIs this a consequence of me merging the latest develop branch, or did I accidentally misconfigured something?\nHow can one overwrite this check?",
    "created_at": "2022-02-16T12:33:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496542",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>
The tests now fail with the following error:

```
************************************************************************
It seems that you are attempting to run Sage from an unpacked source
tarball, but you have not compiled it yet (or maybe the build has not
finished). You should run `make` in the Sage root directory first.
If you did not intend to build Sage from source, you should download
a binary tarball instead. Read README.txt for more information.
************************************************************************
```
Is this a consequence of me merging the latest develop branch, or did I accidentally misconfigured something?
How can one overwrite this check?



---

archive/issue_comments_496543.json:
```json
{
    "body": "**Changing dependencies** from \"#33330, #33345\" to \"\".",
    "created_at": "2022-02-16T12:34:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496543",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing dependencies** from "#33330, #33345" to "".



---

archive/issue_comments_496544.json:
```json
{
    "body": "<a id='comment:191'></a>\nReplying to [mkoeppe](#comment%3A173):\n> How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n\nDone, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9",
    "created_at": "2022-02-16T12:36:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496544",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:191'></a>
Replying to [mkoeppe](#comment%3A173):
> How about adding another job (via matrix) that uses `src/environment-optional.yml`?


Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9



---

archive/issue_comments_496545.json:
```json
{
    "body": "<a id='comment:192'></a>\nReplying to [git](#comment%3A185):\n> Branch pushed to git repo; I updated commit sha1. This was a forced push. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec\">c1c9e61</a></td><td><code>Add matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf\">6ff193f</a></td><td><code>Add problem matcher</code></td></tr></table>\n\n\nThis nuked my changes, intended?",
    "created_at": "2022-02-16T16:52:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496545",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:192'></a>
Replying to [git](#comment%3A185):
> Branch pushed to git repo; I updated commit sha1. This was a forced push. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1c9e6123b0f4c516e3007415e731dab1f38b5ec">c1c9e61</a></td><td><code>Add matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ff193fe4608756ee7b99b0b9f465beaab5bc7bf">6ff193f</a></td><td><code>Add problem matcher</code></td></tr></table>


This nuked my changes, intended?



---

archive/issue_comments_496546.json:
```json
{
    "body": "<a id='comment:193'></a>\nReplying to [gh-tobiasdiez](#comment%3A190):\n> Dependencies #33330, #33345 deleted\n\n\n?",
    "created_at": "2022-02-16T16:53:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496546",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:193'></a>
Replying to [gh-tobiasdiez](#comment%3A190):
> Dependencies #33330, #33345 deleted


?



---

archive/issue_comments_496547.json:
```json
{
    "body": "<a id='comment:194'></a>\nReplying to [mkoeppe](#comment%3A193):\n> Replying to [gh-tobiasdiez](#comment%3A190):\n> > Dependencies #33330, #33345 deleted\n\n> \n> ?\n\n\nNo longer needed.",
    "created_at": "2022-02-16T17:31:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496547",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:194'></a>
Replying to [mkoeppe](#comment%3A193):
> Replying to [gh-tobiasdiez](#comment%3A190):
> > Dependencies #33330, #33345 deleted

> 
> ?


No longer needed.



---

archive/issue_comments_496548.json:
```json
{
    "body": "<a id='comment:195'></a>\nReplying to [gh-tobiasdiez](#comment%3A191):\n> Replying to [mkoeppe](#comment%3A173):\n> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> \n> Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\n\nShould be fixed with #33358",
    "created_at": "2022-02-16T17:35:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496548",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:195'></a>
Replying to [gh-tobiasdiez](#comment%3A191):
> Replying to [mkoeppe](#comment%3A173):
> > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> 
> Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9


Should be fixed with #33358



---

archive/issue_comments_496549.json:
```json
{
    "body": "<a id='comment:196'></a>\nReplying to [mkoeppe](#comment%3A183):\n> Replying to [gh-tobiasdiez](#comment%3A182):\n> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print \"no suitable system package; standard, will be installed as an SPKG\", which is detected and reported in the action overview. \n\n> \n> Sure, +1 on that, that's a good idea.\n\n\nWait, I missed that you said \"run configure without `-with-system = force`\".\n\nI was +1 on adding the problem matchers.",
    "created_at": "2022-02-16T17:37:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496549",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:196'></a>
Replying to [mkoeppe](#comment%3A183):
> Replying to [gh-tobiasdiez](#comment%3A182):
> > I meant as a github annotation. Just run configure without `-with-system = force`. Then configure will print "no suitable system package; standard, will be installed as an SPKG", which is detected and reported in the action overview. 

> 
> Sure, +1 on that, that's a good idea.


Wait, I missed that you said "run configure without `-with-system = force`".

I was +1 on adding the problem matchers.



---

archive/issue_comments_496550.json:
```json
{
    "body": "<a id='comment:7'></a>\nIn [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.",
    "created_at": "2022-02-16T17:39:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496550",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
In [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.



---

archive/issue_events_276573.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T17:39:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276573"
}
```



---

archive/issue_events_276574.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T17:39:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276574"
}
```



---

archive/issue_comments_496551.json:
```json
{
    "body": "<a id='comment:199'></a>\nReplying to [mkoeppe](#comment%3A197):\n> In [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.\n\n\n> When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. \n\n\nThis is still accomplished with the current problem matchers, and even easier. Developer looks at the workflow run, sees that system packages are not accepted and can take action. In addition, she can directly see what errors result from not accepting the system package.\n\nI don't see any advantage in hiding useful information (what does break because of the missing package).",
    "created_at": "2022-02-16T17:58:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496551",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:199'></a>
Replying to [mkoeppe](#comment%3A197):
> In [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.


> When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. 


This is still accomplished with the current problem matchers, and even easier. Developer looks at the workflow run, sees that system packages are not accepted and can take action. In addition, she can directly see what errors result from not accepting the system package.

I don't see any advantage in hiding useful information (what does break because of the missing package).



---

archive/issue_comments_496552.json:
```json
{
    "body": "<a id='comment:200'></a>\nReplying to [isuruf](#comment%3A195):\n> Replying to [gh-tobiasdiez](#comment%3A191):\n> > Replying to [mkoeppe](#comment%3A173):\n> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> > \n> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\n> \n> Should be fixed with #33358\n\n\nThanks!",
    "created_at": "2022-02-16T17:59:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496552",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:200'></a>
Replying to [isuruf](#comment%3A195):
> Replying to [gh-tobiasdiez](#comment%3A191):
> > Replying to [mkoeppe](#comment%3A173):
> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> > 
> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9

> 
> Should be fixed with #33358


Thanks!



---

archive/issue_comments_496553.json:
```json
{
    "body": "<a id='comment:1'></a>\nAny idea on how to fix ticket:30845#comment:189?",
    "created_at": "2022-02-16T17:59:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496553",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:1'></a>
Any idea on how to fix ticket:30845#comment:189?



---

archive/issue_comments_496554.json:
```json
{
    "body": "<a id='comment:202'></a>\nReplying to [gh-tobiasdiez](#comment%3A199):\n> I don't see any advantage in hiding useful information\n\n\nI've already explained that it's not useful for those who know how to update our configure tests.",
    "created_at": "2022-02-16T18:01:50Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496554",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:202'></a>
Replying to [gh-tobiasdiez](#comment%3A199):
> I don't see any advantage in hiding useful information


I've already explained that it's not useful for those who know how to update our configure tests.



---

archive/issue_comments_496555.json:
```json
{
    "body": "<a id='comment:203'></a>\nReplying to [gh-tobiasdiez](#comment%3A201):\n> Any idea on how to fix ticket:30845#comment:189?\n\n\nYes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.",
    "created_at": "2022-02-16T18:04:06Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496555",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:203'></a>
Replying to [gh-tobiasdiez](#comment%3A201):
> Any idea on how to fix ticket:30845#comment:189?


Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.



---

archive/issue_comments_496556.json:
```json
{
    "body": "<a id='comment:204'></a>\nReplying to [gh-tobiasdiez](#comment%3A199):\n> Replying to [mkoeppe](#comment%3A197):\n> > In [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.\n\n> \n> > When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. \n\n> \n> This is still accomplished with the current problem matchers, and even easier. \n\n\nBut it misses the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.",
    "created_at": "2022-02-16T18:07:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496556",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:204'></a>
Replying to [gh-tobiasdiez](#comment%3A199):
> Replying to [mkoeppe](#comment%3A197):
> > In [comment:181](#comment%3A181) I explained why we DON'T want to have it run anyway and produce mysterious errors that send developers into doing unproductive guesswork.

> 
> > When Sage developers see this in the CI run, there is also a clear course of action: Adjust the conda-specific version constraints in conda.txt files if possible; or file a conda bug report. 

> 
> This is still accomplished with the current problem matchers, and even easier. 


But it misses the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.



---

archive/issue_comments_496557.json:
```json
{
    "body": "<a id='comment:5'></a>\nAlso [comment:178](#comment%3A178).",
    "created_at": "2022-02-16T18:24:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496557",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Also [comment:178](#comment%3A178).



---

archive/issue_comments_496558.json:
```json
{
    "body": "<a id='comment:206'></a>\nReplying to [mkoeppe](#comment%3A203):\n> Replying to [gh-tobiasdiez](#comment%3A201):\n> > Any idea on how to fix ticket:30845#comment:189?\n\n> \n> Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.\n\n\nAnd how does one fix it without using prefix (which according to you isn't desired)?",
    "created_at": "2022-02-16T18:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496558",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:206'></a>
Replying to [mkoeppe](#comment%3A203):
> Replying to [gh-tobiasdiez](#comment%3A201):
> > Any idea on how to fix ticket:30845#comment:189?

> 
> Yes, you didn't install the Sage library where you promised that it would be installed. `SAGE_LOCAL` (set by `--prefix`) defaults to `SAGE_ROOT/local` and `SAGE_VENV` defaults to a subdirectory of it. But you installed the Sage library instead into the system site-packages.


And how does one fix it without using prefix (which according to you isn't desired)?



---

archive/issue_comments_496559.json:
```json
{
    "body": "<a id='comment:7'></a>\nFor now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.",
    "created_at": "2022-02-16T18:33:02Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496559",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.



---

archive/issue_comments_496560.json:
```json
{
    "body": "**Changing commit** from \"[a3fd48c0337090a9a042977600eb9f2832b77c1b](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)\" to \"[8426d2d57f710d2b64c46e0bcde09ee22ed75851](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)\".",
    "created_at": "2022-02-16T18:49:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a3fd48c0337090a9a042977600eb9f2832b77c1b](https://github.com/sagemath/sagetrac-mirror/commit/a3fd48c0337090a9a042977600eb9f2832b77c1b)" to "[8426d2d57f710d2b64c46e0bcde09ee22ed75851](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)".



---

archive/issue_comments_496561.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76660199b8496a45b96c9783515d6de0a868506e\">7666019</a></td><td><code>Back to using prefix for now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a0f3194d19df7342fc7f7f3558277dbb79bf8d5\">8a0f319</a></td><td><code>Fix for rename of conda e-antic package to libeantic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8a7b0f0e33ae8c39e8fe45b138c0b50dcba392a\">c8a7b0f</a></td><td><code>Merge remote-tracking branch 'trac/u/isuruf/eantic' into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919\">613198a</a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851\">8426d2d</a></td><td><code>Merge remote-tracking branch 'trac/public/build/conda-addpackages-runci' into public/build/conda-runci</code></td></tr></table>\n",
    "created_at": "2022-02-16T18:49:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76660199b8496a45b96c9783515d6de0a868506e">7666019</a></td><td><code>Back to using prefix for now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a0f3194d19df7342fc7f7f3558277dbb79bf8d5">8a0f319</a></td><td><code>Fix for rename of conda e-antic package to libeantic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8a7b0f0e33ae8c39e8fe45b138c0b50dcba392a">c8a7b0f</a></td><td><code>Merge remote-tracking branch 'trac/u/isuruf/eantic' into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/613198af5826276e721a7bd92c2500d91243a919">613198a</a></td><td><code>Add primecountpy</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851">8426d2d</a></td><td><code>Merge remote-tracking branch 'trac/public/build/conda-addpackages-runci' into public/build/conda-runci</code></td></tr></table>




---

archive/issue_comments_496562.json:
```json
{
    "body": "**Dependencies:** #33358, #33330",
    "created_at": "2022-02-16T18:50:34Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496562",
    "user": "https://github.com/tobiasdiez"
}
```

**Dependencies:** #33358, #33330



---

archive/issue_comments_496563.json:
```json
{
    "body": "<a id='comment:210'></a>\nReplying to [isuruf](#comment%3A195):\n> Replying to [gh-tobiasdiez](#comment%3A191):\n> > Replying to [mkoeppe](#comment%3A173):\n> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?\n\n> > \n> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9\n\n> \n> Should be fixed with #33358\n\n\nIt is indeed correctly using lcalc 2 now. Thanks!",
    "created_at": "2022-02-16T19:34:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496563",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:210'></a>
Replying to [isuruf](#comment%3A195):
> Replying to [gh-tobiasdiez](#comment%3A191):
> > Replying to [mkoeppe](#comment%3A173):
> > > How about adding another job (via matrix) that uses `src/environment-optional.yml`?

> > 
> > Done, but it is currently failing (as reported before). Also added a minimal matrix for python versions 3.8 + 3.9

> 
> Should be fixed with #33358


It is indeed correctly using lcalc 2 now. Thanks!



---

archive/issue_comments_496564.json:
```json
{
    "body": "<a id='comment:211'></a>\nReplying to [mkoeppe](#comment%3A207):\n> For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.\n\n\nThanks. I've reverted to using --prefix (with --without-system-gcc). Let's put your improvements to the gcc detection script in a follow-up ticket.",
    "created_at": "2022-02-16T19:35:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496564",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:211'></a>
Replying to [mkoeppe](#comment%3A207):
> For now, using `--prefix` is the best option. That's why I provided commits 9799fd7/757bd73.


Thanks. I've reverted to using --prefix (with --without-system-gcc). Let's put your improvements to the gcc detection script in a follow-up ticket.



---

archive/issue_comments_496565.json:
```json
{
    "body": "<a id='comment:212'></a>\nReplying to [mkoeppe](#comment%3A202):\n> Replying to [gh-tobiasdiez](#comment%3A199):\n> > I don't see any advantage in hiding useful information\n\n> \n> I've already explained that it's not useful for those who know how to update our configure tests.\n\n\nThere are also people that don't know much about these configure scripts but still want to work on the conda environment.\n\nThe point of this ticket (at least for me), is having a CI infrastructure to confirm that updates to the conda evniroment such as #33330 and #33358 indeed have a positive impact. For this it is not helpful if the workflow exists early because some conda package got updated in the meantime and now the corresponding \"system\" package is rejected by sage.\n\nTo be honest, I feel tired by this discussion and think we already invested more time discussing pros and cons then developer will ever spend while chasing mysterious bugs potentially coming from this. If its so important to you, I would like to ask you to implement it in a follow-up ticket.",
    "created_at": "2022-02-16T19:37:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496565",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:212'></a>
Replying to [mkoeppe](#comment%3A202):
> Replying to [gh-tobiasdiez](#comment%3A199):
> > I don't see any advantage in hiding useful information

> 
> I've already explained that it's not useful for those who know how to update our configure tests.


There are also people that don't know much about these configure scripts but still want to work on the conda environment.

The point of this ticket (at least for me), is having a CI infrastructure to confirm that updates to the conda evniroment such as #33330 and #33358 indeed have a positive impact. For this it is not helpful if the workflow exists early because some conda package got updated in the meantime and now the corresponding "system" package is rejected by sage.

To be honest, I feel tired by this discussion and think we already invested more time discussing pros and cons then developer will ever spend while chasing mysterious bugs potentially coming from this. If its so important to you, I would like to ask you to implement it in a follow-up ticket.



---

archive/issue_comments_496566.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt's now working: build succeeds and most tests pass in all tested configs. https://github.com/sagemath/sagetrac-mirror/actions/runs/1854640215\n\nLet's move potential improvements (like removing --prefix, --without-system-gcc, fixes to giac, updates to the docs etc) to follow-up tickets.",
    "created_at": "2022-02-16T19:40:41Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496566",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'></a>
It's now working: build succeeds and most tests pass in all tested configs. https://github.com/sagemath/sagetrac-mirror/actions/runs/1854640215

Let's move potential improvements (like removing --prefix, --without-system-gcc, fixes to giac, updates to the docs etc) to follow-up tickets.



---

archive/issue_events_276575.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-16T19:40:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276575"
}
```



---

archive/issue_events_276576.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-16T19:40:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276576"
}
```



---

archive/issue_comments_496567.json:
```json
{
    "body": "<a id='comment:214'></a>\nReplying to [gh-tobiasdiez](#comment%3A212):\n> Replying to [mkoeppe](#comment%3A202):\n> > Replying to [gh-tobiasdiez](#comment%3A199):\n> > > I don't see any advantage in hiding useful information\n\n> > \n> > I've already explained that it's not useful for those who know how to update our configure tests.\n\n> \n> There are also people that don't know much about these configure scripts but still want to work on the conda environment.\n\n\nYes, and they can do that as I explained in [comment:181](#comment%3A181). They don't need to see the errors if they don't want to work on the configure scripts.",
    "created_at": "2022-02-16T19:41:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496567",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:214'></a>
Replying to [gh-tobiasdiez](#comment%3A212):
> Replying to [mkoeppe](#comment%3A202):
> > Replying to [gh-tobiasdiez](#comment%3A199):
> > > I don't see any advantage in hiding useful information

> > 
> > I've already explained that it's not useful for those who know how to update our configure tests.

> 
> There are also people that don't know much about these configure scripts but still want to work on the conda environment.


Yes, and they can do that as I explained in [comment:181](#comment%3A181). They don't need to see the errors if they don't want to work on the configure scripts.



---

archive/issue_events_276577.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T19:44:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276577"
}
```



---

archive/issue_events_276578.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-16T19:44:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276578"
}
```



---

archive/issue_comments_496568.json:
```json
{
    "body": "<a id='comment:215'></a>\nReplying to [gh-tobiasdiez](#comment%3A213):\n> It's now working: build succeeds and most tests pass in all tested configs.\n\n\nIt still doesn't pass the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.",
    "created_at": "2022-02-16T19:44:01Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496568",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:215'></a>
Replying to [gh-tobiasdiez](#comment%3A213):
> It's now working: build succeeds and most tests pass in all tested configs.


It still doesn't pass the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.



---

archive/issue_comments_496569.json:
```json
{
    "body": "<a id='comment:216'></a>\nReplying to [gh-tobiasdiez](#comment%3A212):\n> If it's so important to you, I would like to ask you to implement it in a follow-up ticket.\n\n\nI already did, but you removed the commits that implemented it.",
    "created_at": "2022-02-16T19:45:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496569",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:216'></a>
Replying to [gh-tobiasdiez](#comment%3A212):
> If it's so important to you, I would like to ask you to implement it in a follow-up ticket.


I already did, but you removed the commits that implemented it.



---

archive/issue_comments_496570.json:
```json
{
    "body": "<a id='comment:217'></a>\nReplying to [mkoeppe](#comment%3A215):\n> Replying to [gh-tobiasdiez](#comment%3A213):\n> > It's now working: build succeeds and most tests pass in all tested configs.\n\n> \n> It still doesn't pass the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.\n> \n\n\nC'mon, according to your own information using --prefix is the best way currently. Without any changes to gcc detection or whatever (which is not the point of this ticket), this only works with --without-system-gcc.",
    "created_at": "2022-02-16T19:47:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496570",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:217'></a>
Replying to [mkoeppe](#comment%3A215):
> Replying to [gh-tobiasdiez](#comment%3A213):
> > It's now working: build succeeds and most tests pass in all tested configs.

> 
> It still doesn't pass the criterion of [comment:121](#comment%3A121) - does it test what we would recommend to developers.
> 


C'mon, according to your own information using --prefix is the best way currently. Without any changes to gcc detection or whatever (which is not the point of this ticket), this only works with --without-system-gcc.



---

archive/issue_comments_496571.json:
```json
{
    "body": "<a id='comment:8'></a>\n`@`gh-tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix.",
    "created_at": "2022-02-16T20:41:59Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496571",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:8'></a>
`@`gh-tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix.



---

archive/issue_comments_496572.json:
```json
{
    "body": "<a id='comment:9'></a>\nI'll put these commits on #33361 now",
    "created_at": "2022-02-16T20:48:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496572",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
I'll put these commits on #33361 now



---

archive/issue_comments_496573.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d547541e0ca4e3806dc9c917d7901e76376bdd3f\">d547541</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce6f8fd6326a3c7db0b3fa83421edf72d27734fb\">ce6f8fd</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ba100510e6ff5168e5f61287fe44a96206cc6f0\">5ba1005</a></td><td><code>Merge remote-tracking branch 'trac/u/mkoeppe/configure__handle_the_case_of_sage_local___a_system_directory_with_gcc_better' into public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30\">1c2c97e</a></td><td><code>Remove without-system-gcc</code></td></tr></table>\n",
    "created_at": "2022-02-17T12:08:48Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d547541e0ca4e3806dc9c917d7901e76376bdd3f">d547541</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce6f8fd6326a3c7db0b3fa83421edf72d27734fb">ce6f8fd</a></td><td><code>build/pkgs/gcc/spkg-configure.m4: Handle the case of SAGE_LOCAL = a system directory with gcc better (fixup)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ba100510e6ff5168e5f61287fe44a96206cc6f0">5ba1005</a></td><td><code>Merge remote-tracking branch 'trac/u/mkoeppe/configure__handle_the_case_of_sage_local___a_system_directory_with_gcc_better' into public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30">1c2c97e</a></td><td><code>Remove without-system-gcc</code></td></tr></table>




---

archive/issue_comments_496574.json:
```json
{
    "body": "**Changing commit** from \"[8426d2d57f710d2b64c46e0bcde09ee22ed75851](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)\" to \"[1c2c97ed3a08904ea91dd856cb09b1032d549c30](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)\".",
    "created_at": "2022-02-17T12:08:48Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496574",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8426d2d57f710d2b64c46e0bcde09ee22ed75851](https://github.com/sagemath/sagetrac-mirror/commit/8426d2d57f710d2b64c46e0bcde09ee22ed75851)" to "[1c2c97ed3a08904ea91dd856cb09b1032d549c30](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)".



---

archive/issue_comments_496575.json:
```json
{
    "body": "<a id='comment:221'></a>\nReplying to [mkoeppe](#comment%3A219):\n> I'll put these commits on #33361 now\n\n\nThanks",
    "created_at": "2022-02-17T12:09:32Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496575",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:221'></a>
Replying to [mkoeppe](#comment%3A219):
> I'll put these commits on #33361 now


Thanks



---

archive/issue_events_276579.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-17T12:11:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276579"
}
```



---

archive/issue_events_276580.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-17T12:11:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276580"
}
```



---

archive/issue_comments_496576.json:
```json
{
    "body": "<a id='comment:222'></a>\nReplying to [isuruf](#comment%3A218):\n> `@`gh-tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix. \n\n\nDone by merging #33361. (For the record, I initially removed these commits because it seemed like the whole prefix thing wasn't necessary).\n\nStill a bit confused why #33361 couldn't just be a follow-up on top of this ticket, but, well, I guess I'm used to a different developing/merging strategy.",
    "created_at": "2022-02-17T12:11:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496576",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:222'></a>
Replying to [isuruf](#comment%3A218):
> `@`gh-tobiasdiez, can you restore @mkoeppe's commits that fixed the gcc detection? Then we can use --prefix. 


Done by merging #33361. (For the record, I initially removed these commits because it seemed like the whole prefix thing wasn't necessary).

Still a bit confused why #33361 couldn't just be a follow-up on top of this ticket, but, well, I guess I'm used to a different developing/merging strategy.



---

archive/issue_comments_496577.json:
```json
{
    "body": "**Changing dependencies** from \"#33358, #33330\" to \"#33358, #33330, #33361\".",
    "created_at": "2022-02-17T12:12:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496577",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing dependencies** from "#33358, #33330" to "#33358, #33330, #33361".



---

archive/issue_comments_496578.json:
```json
{
    "body": "<a id='comment:4'></a>\nSeems to work well, no gc errors anymore and all standard conda packages are detected successfully (even with the `environment-optional.yml).\n\nSo should be good to go now.",
    "created_at": "2022-02-17T12:23:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496578",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>
Seems to work well, no gc errors anymore and all standard conda packages are detected successfully (even with the `environment-optional.yml).

So should be good to go now.



---

archive/issue_comments_496579.json:
```json
{
    "body": "<a id='comment:5'></a>\nHow is there no `gc` error any more? What has changed in this respect?",
    "created_at": "2022-02-17T17:07:35Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496579",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
How is there no `gc` error any more? What has changed in this respect?



---

archive/issue_comments_496580.json:
```json
{
    "body": "<a id='comment:226'></a>\nReplying to [dimpase](#comment%3A225):\n> How is there no `gc` error any more? What has changed in this respect? \n\n\n#33361 fixed it.",
    "created_at": "2022-02-17T17:45:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496580",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:226'></a>
Replying to [dimpase](#comment%3A225):
> How is there no `gc` error any more? What has changed in this respect? 


#33361 fixed it.



---

archive/issue_comments_496581.json:
```json
{
    "body": "<a id='comment:227'></a>\nReplying to [gh-tobiasdiez](#comment%3A226):\n> Replying to [dimpase](#comment%3A225):\n> > How is there no `gc` error any more? What has changed in this respect? \n\n> \n> #33361 fixed it.\n\nthis must be close a miracle - as only `gcc` was touched there.",
    "created_at": "2022-02-17T17:52:18Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496581",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:227'></a>
Replying to [gh-tobiasdiez](#comment%3A226):
> Replying to [dimpase](#comment%3A225):
> > How is there no `gc` error any more? What has changed in this respect? 

> 
> #33361 fixed it.

this must be close a miracle - as only `gcc` was touched there.



---

archive/issue_comments_496582.json:
```json
{
    "body": "<a id='comment:8'></a>\n`gc` was rejected via SPKG_DEPCHECK on `gcc`.",
    "created_at": "2022-02-17T17:53:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496582",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
`gc` was rejected via SPKG_DEPCHECK on `gcc`.



---

archive/issue_comments_496583.json:
```json
{
    "body": "<a id='comment:229'></a>\nReplying to [mkoeppe](#comment%3A228):\n> `gc` was rejected via SPKG_DEPCHECK on `gcc`.\n\nDoes this mean that somehow #33361 is blessing `gcc`'s deps?\nHmm, not sure I follow.",
    "created_at": "2022-02-17T18:16:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496583",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:229'></a>
Replying to [mkoeppe](#comment%3A228):
> `gc` was rejected via SPKG_DEPCHECK on `gcc`.

Does this mean that somehow #33361 is blessing `gcc`'s deps?
Hmm, not sure I follow.



---

archive/issue_comments_496584.json:
```json
{
    "body": "<a id='comment:0'></a>\nno, that's really weird. `gc` is not used by `gcc`... OK, this is a Church of gcc spkg, and I'm a non-believer...",
    "created_at": "2022-02-17T18:52:35Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496584",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>
no, that's really weird. `gc` is not used by `gcc`... OK, this is a Church of gcc spkg, and I'm a non-believer...



---

archive/issue_comments_496585.json:
```json
{
    "body": "<a id='comment:231'></a>\nReplying to [mkoeppe](#comment%3A228):\n> `gc` was rejected via SPKG_DEPCHECK on `gcc`.\n\n\nSorry, I was wrong - I misremembered",
    "created_at": "2022-02-17T18:54:50Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496585",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:231'></a>
Replying to [mkoeppe](#comment%3A228):
> `gc` was rejected via SPKG_DEPCHECK on `gcc`.


Sorry, I was wrong - I misremembered



---

archive/issue_comments_496586.json:
```json
{
    "body": "<a id='comment:2'></a>\nThere was no problem with `gc` except within Tobias's WSL install.",
    "created_at": "2022-02-17T18:55:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496586",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
There was no problem with `gc` except within Tobias's WSL install.



---

archive/issue_comments_496587.json:
```json
{
    "body": "<a id='comment:3'></a>\nSorry for the missing c and the confusion it caused :-)",
    "created_at": "2022-02-17T19:37:13Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496587",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'></a>
Sorry for the missing c and the confusion it caused :-)



---

archive/issue_comments_496588.json:
```json
{
    "body": "<a id='comment:4'></a>\n![](https://i.stack.imgur.com/jiFfM.jpg)",
    "created_at": "2022-02-17T20:29:26Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496588",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
![](https://i.stack.imgur.com/jiFfM.jpg)



---

archive/issue_comments_496589.json:
```json
{
    "body": "<a id='comment:235'></a>\nReplying to [mkoeppe](#comment%3A92):\n> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n\nWith dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.",
    "created_at": "2022-03-15T21:08:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496589",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:235'></a>
Replying to [mkoeppe](#comment%3A92):
> Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`


With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.



---

archive/issue_comments_496590.json:
```json
{
    "body": "<a id='comment:6'></a>\n@isuruf - `--with-system-lrcalc=force` fails because conda-forge does not provide lrcalc 2.x yet",
    "created_at": "2022-03-15T21:46:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496590",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
@isuruf - `--with-system-lrcalc=force` fails because conda-forge does not provide lrcalc 2.x yet



---

archive/issue_comments_496591.json:
```json
{
    "body": "<a id='comment:7'></a>\nFixed by\n\n- https://github.com/conda-forge/lrcalc-feedstock/pull/7",
    "created_at": "2022-03-16T08:20:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496591",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>
Fixed by

- https://github.com/conda-forge/lrcalc-feedstock/pull/7



---

archive/issue_comments_496592.json:
```json
{
    "body": "<a id='comment:238'></a>\nReplying to [mkoeppe](#comment%3A235):\n> Replying to [mkoeppe](#comment%3A92):\n> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`\n\n> \n> With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.\n\n\n\nIf a system package is not used, then an error message is displayed in the github flow, so these force arguments are not necessary (or can later be added as part of #33345) .\n\nCan we please get this ticket in?",
    "created_at": "2022-03-16T17:55:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496592",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:238'></a>
Replying to [mkoeppe](#comment%3A235):
> Replying to [mkoeppe](#comment%3A92):
> > Or generate it as `$(for pkg in $(./sage -package list :standard: --has-file spkg-configure.m4); do echo --with-system-$pkg=force; done)`

> 
> With dependency #33361 positively reviewed, but #33345 (`configure --with-system-standard-packages=force`) stalled, let's use the above as a solution.



If a system package is not used, then an error message is displayed in the github flow, so these force arguments are not necessary (or can later be added as part of #33345) .

Can we please get this ticket in?



---

archive/issue_comments_496593.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ea60619c478a4220a204843e9938968e3052677\">9ea6061</a></td><td><code>Merge tag '9.6.beta5' into t/30845/public/build/conda-runci</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352\">574c6df</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-...=force</code></td></tr></table>\n",
    "created_at": "2022-03-16T18:57:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ea60619c478a4220a204843e9938968e3052677">9ea6061</a></td><td><code>Merge tag '9.6.beta5' into t/30845/public/build/conda-runci</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352">574c6df</a></td><td><code>.github/workflows/ci-conda.yml: Use configure --with-system-...=force</code></td></tr></table>




---

archive/issue_comments_496594.json:
```json
{
    "body": "**Changing commit** from \"[1c2c97ed3a08904ea91dd856cb09b1032d549c30](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)\" to \"[574c6dfa3f79cdefe1996087e5567a01e32a9352](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)\".",
    "created_at": "2022-03-16T18:57:22Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496594",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1c2c97ed3a08904ea91dd856cb09b1032d549c30](https://github.com/sagemath/sagetrac-mirror/commit/1c2c97ed3a08904ea91dd856cb09b1032d549c30)" to "[574c6dfa3f79cdefe1996087e5567a01e32a9352](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)".



---

archive/issue_comments_496595.json:
```json
{
    "body": "<a id='comment:240'></a>\nReplying to [gh-tobiasdiez](#comment%3A238):\n> Can we please get this ticket in? \n\n\nWorking on it, as you can see",
    "created_at": "2022-03-16T19:00:24Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496595",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:240'></a>
Replying to [gh-tobiasdiez](#comment%3A238):
> Can we please get this ticket in? 


Working on it, as you can see



---

archive/issue_comments_496596.json:
```json
{
    "body": "<a id='comment:241'></a>\nReplying to [slelievre](#comment%3A237):\n> Fixed by\n> \n> - https://github.com/conda-forge/lrcalc-feedstock/pull/7\n\n\nGreat, now I see that lrcalc 2.1. Still need https://pypi.org/project/lrcalc/ in conda-forge, or we need to install it with pip.",
    "created_at": "2022-03-16T19:13:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496596",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:241'></a>
Replying to [slelievre](#comment%3A237):
> Fixed by
> 
> - https://github.com/conda-forge/lrcalc-feedstock/pull/7


Great, now I see that lrcalc 2.1. Still need https://pypi.org/project/lrcalc/ in conda-forge, or we need to install it with pip.



---

archive/issue_comments_496597.json:
```json
{
    "body": "<a id='comment:242'></a>\nReplying to [mkoeppe](#comment%3A240):\n> Replying to [gh-tobiasdiez](#comment%3A238):\n> > Can we please get this ticket in? \n\n> \n> Working on it, as you can see\n\n\nCan you please revert 574c6df thanks!",
    "created_at": "2022-03-16T19:25:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496597",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:242'></a>
Replying to [mkoeppe](#comment%3A240):
> Replying to [gh-tobiasdiez](#comment%3A238):
> > Can we please get this ticket in? 

> 
> Working on it, as you can see


Can you please revert 574c6df thanks!



---

archive/issue_comments_496598.json:
```json
{
    "body": "<a id='comment:3'></a>\nI'm also getting\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular\nchecking for SINGULAR... no\n...\nconfigure: error: \n\n    Given --with-system-singular=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-singular)\n```\n(https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)",
    "created_at": "2022-03-16T19:40:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496598",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
I'm also getting

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular
checking for SINGULAR... no
...
configure: error: 

    Given --with-system-singular=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-singular)
```
(https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)



---

archive/issue_comments_496599.json:
```json
{
    "body": "**Changing author** from \"Tobias Diez\" to \"Tobias Diez, Matthias Koeppe\".",
    "created_at": "2022-03-16T19:40:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496599",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Tobias Diez" to "Tobias Diez, Matthias Koeppe".



---

archive/issue_events_276581.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-16T19:41:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276581"
}
```



---

archive/issue_events_276582.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-16T19:41:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276582"
}
```



---

archive/issue_comments_496600.json:
```json
{
    "body": "**Changing commit** from \"[574c6dfa3f79cdefe1996087e5567a01e32a9352](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)\" to \"[a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)\".",
    "created_at": "2022-03-16T19:45:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[574c6dfa3f79cdefe1996087e5567a01e32a9352](https://github.com/sagemath/sagetrac-mirror/commit/574c6dfa3f79cdefe1996087e5567a01e32a9352)" to "[a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)".



---

archive/issue_comments_496601.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb\">a01bdd9</a></td><td><code>build/pkgs/lrcalc/distros/conda.txt: Set version bound >= 2</code></td></tr></table>\n",
    "created_at": "2022-03-16T19:45:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb">a01bdd9</a></td><td><code>build/pkgs/lrcalc/distros/conda.txt: Set version bound >= 2</code></td></tr></table>




---

archive/issue_comments_496602.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8\">739e4cd</a></td><td><code>build/pkgs/singular/distros/conda.txt: Set version lower bound</code></td></tr></table>\n",
    "created_at": "2022-03-16T19:48:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8">739e4cd</a></td><td><code>build/pkgs/singular/distros/conda.txt: Set version lower bound</code></td></tr></table>




---

archive/issue_comments_496603.json:
```json
{
    "body": "**Changing commit** from \"[a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)\" to \"[739e4cd599ed50b27b17a8c5b67d4036bb1a10c8](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)\".",
    "created_at": "2022-03-16T19:48:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496603",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb](https://github.com/sagemath/sagetrac-mirror/commit/a01bdd9a6d5469431e1c1ef6cdef46c9446b26eb)" to "[739e4cd599ed50b27b17a8c5b67d4036bb1a10c8](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)".



---

archive/issue_comments_496604.json:
```json
{
    "body": "<a id='comment:8'></a>\nWorking on both lrcalc and singular issue. Can you add `python-lrcalc` as the name for conda package for `lrcalc_python`?",
    "created_at": "2022-03-16T19:58:20Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496604",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:8'></a>
Working on both lrcalc and singular issue. Can you add `python-lrcalc` as the name for conda package for `lrcalc_python`?



---

archive/issue_comments_496605.json:
```json
{
    "body": "<a id='comment:9'></a>\nWill do, thanks!",
    "created_at": "2022-03-16T20:00:06Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496605",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
Will do, thanks!



---

archive/issue_comments_496606.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/587f57a0a4f1eeefcc6e54ead3322dbefe316b13\">587f57a</a></td><td><code>build/pkgs/lrcalc_python/distros/conda.txt: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6\">8af68a0</a></td><td><code>build/pkgs/singular/distros/conda.txt: Change version specification</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:03:17Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/587f57a0a4f1eeefcc6e54ead3322dbefe316b13">587f57a</a></td><td><code>build/pkgs/lrcalc_python/distros/conda.txt: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6">8af68a0</a></td><td><code>build/pkgs/singular/distros/conda.txt: Change version specification</code></td></tr></table>




---

archive/issue_comments_496607.json:
```json
{
    "body": "**Changing commit** from \"[739e4cd599ed50b27b17a8c5b67d4036bb1a10c8](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)\" to \"[8af68a0815367328708edbb6e1967ce9a3e01aa6](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)\".",
    "created_at": "2022-03-16T20:03:17Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496607",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[739e4cd599ed50b27b17a8c5b67d4036bb1a10c8](https://github.com/sagemath/sagetrac-mirror/commit/739e4cd599ed50b27b17a8c5b67d4036bb1a10c8)" to "[8af68a0815367328708edbb6e1967ce9a3e01aa6](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)".



---

archive/issue_comments_496608.json:
```json
{
    "body": "<a id='comment:1'></a>\nCan you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`",
    "created_at": "2022-03-16T20:04:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496608",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:1'></a>
Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`



---

archive/issue_comments_496609.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584\">9cbee4c</a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:06:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584">9cbee4c</a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>




---

archive/issue_comments_496610.json:
```json
{
    "body": "**Changing commit** from \"[8af68a0815367328708edbb6e1967ce9a3e01aa6](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)\" to \"[9cbee4cbbb26273eb6cc5a19205e8f0f085a6584](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)\".",
    "created_at": "2022-03-16T20:06:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8af68a0815367328708edbb6e1967ce9a3e01aa6](https://github.com/sagemath/sagetrac-mirror/commit/8af68a0815367328708edbb6e1967ce9a3e01aa6)" to "[9cbee4cbbb26273eb6cc5a19205e8f0f085a6584](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)".



---

archive/issue_comments_496611.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [mkoeppe](#comment%3A243):\n> I'm also getting\n> \n> ```\n> Checking whether SageMath should install SPKG singular...\n> checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\n> checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular\n> checking for SINGULAR... no\n> ...\n> configure: error: \n> \n>     Given --with-system-singular=force, but no system package could be used.\n>     That's an error.  Please install the indicated package to continue.\n>     (To override this error, use ./configure --without-system-singular)\n> ```\n> (https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)\n\n\nCan we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n\nSimilarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584\">9cbee4c</a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>\n",
    "created_at": "2022-03-16T20:07:03Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496611",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'></a>
Replying to [mkoeppe](#comment%3A243):
> I'm also getting
> 
> ```
> Checking whether SageMath should install SPKG singular...
> checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
> checking for Singular... /usr/share/miniconda/envs/sage-build/bin/Singular
> checking for SINGULAR... no
> ...
> configure: error: 
> 
>     Given --with-system-singular=force, but no system package could be used.
>     That's an error.  Please install the indicated package to continue.
>     (To override this error, use ./configure --without-system-singular)
> ```
> (https://github.com/mkoeppe/sage/runs/5575546912?check_suite_focus=true)


Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.

Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584">9cbee4c</a></td><td><code>build/pkgs/singular/distros/conda.txt: Use singular>=4.2.1.p3</code></td></tr></table>




---

archive/issue_comments_496612.json:
```json
{
    "body": "<a id='comment:254'></a>\nReplying to [gh-tobiasdiez](#comment%3A253):\n> Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n> \n> Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\n\nPlease, Tobias, an author repeatedly demanding that the ticket goes in \"as is\" is not helpful and is not part of the collaborative workflow of the Sage project.",
    "created_at": "2022-03-16T20:09:18Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496612",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:254'></a>
Replying to [gh-tobiasdiez](#comment%3A253):
> Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.
> 
> Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).


Please, Tobias, an author repeatedly demanding that the ticket goes in "as is" is not helpful and is not part of the collaborative workflow of the Sage project.



---

archive/issue_comments_496613.json:
```json
{
    "body": "<a id='comment:255'></a>\nReplying to [isuruf](#comment%3A251):\n> Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`\n\n\nThanks, this works.",
    "created_at": "2022-03-16T20:09:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496613",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:255'></a>
Replying to [isuruf](#comment%3A251):
> Can you also do `singular>=4.2.1.p3`? Apparently conda thinks `4.2.1.p3` is a development version and is `<4.2.1`


Thanks, this works.



---

archive/issue_comments_496614.json:
```json
{
    "body": "<a id='comment:256'></a>\nReplying to [mkoeppe](#comment%3A254):\n> Replying to [gh-tobiasdiez](#comment%3A253):\n> > Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.\n> > \n> > Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).\n\n> \n> Please, Tobias, an author repeatedly demanding that the ticket goes in \"as is\" is not helpful and is not part of the collaborative workflow of the Sage project. \n\n\nThat's not what I'm saying. I just don't see the need that these changes, that then need further changes etc need to be part of this ticket. I'm happy to adjust the github workflow if you have any comments/suggestions on this.",
    "created_at": "2022-03-16T20:29:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496614",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:256'></a>
Replying to [mkoeppe](#comment%3A254):
> Replying to [gh-tobiasdiez](#comment%3A253):
> > Can we please do this in a follow-up ticket (i.e. remove the force for now). This has nothing to do with the github action action in this ticket.
> > 
> > Similarly, the changes to the conda package versions / package names should go to their own tickets (based on this ticket here to check if they indeed work as intended).

> 
> Please, Tobias, an author repeatedly demanding that the ticket goes in "as is" is not helpful and is not part of the collaborative workflow of the Sage project. 


That's not what I'm saying. I just don't see the need that these changes, that then need further changes etc need to be part of this ticket. I'm happy to adjust the github workflow if you have any comments/suggestions on this.



---

archive/issue_comments_496615.json:
```json
{
    "body": "<a id='comment:7'></a>\nI see that `python-lrcalc` 2.1 is now available in the conda-forge channel. Thanks @isuruf! \n\nTests running at https://github.com/mkoeppe/sage/actions/runs/1996031338",
    "created_at": "2022-03-17T01:17:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496615",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
I see that `python-lrcalc` 2.1 is now available in the conda-forge channel. Thanks @isuruf! 

Tests running at https://github.com/mkoeppe/sage/actions/runs/1996031338



---

archive/issue_comments_496616.json:
```json
{
    "body": "<a id='comment:8'></a>\nThere's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion",
    "created_at": "2022-03-17T03:37:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496616",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion



---

archive/issue_comments_496617.json:
```json
{
    "body": "**Changing commit** from \"[9cbee4cbbb26273eb6cc5a19205e8f0f085a6584](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)\" to \"[9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)\".",
    "created_at": "2022-03-17T06:25:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9cbee4cbbb26273eb6cc5a19205e8f0f085a6584](https://github.com/sagemath/sagetrac-mirror/commit/9cbee4cbbb26273eb6cc5a19205e8f0f085a6584)" to "[9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)".



---

archive/issue_comments_496618.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2\">9f8cb1d</a></td><td><code>.github/workflows/ci-conda.yml: Also test on macos-latest</code></td></tr></table>\n",
    "created_at": "2022-03-17T06:25:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2">9f8cb1d</a></td><td><code>.github/workflows/ci-conda.yml: Also test on macos-latest</code></td></tr></table>




---

archive/issue_comments_496619.json:
```json
{
    "body": "<a id='comment:0'></a>\nI have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n\nsee https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true",
    "created_at": "2022-03-17T06:26:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496619",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:0'></a>
I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.

see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true



---

archive/issue_comments_496620.json:
```json
{
    "body": "<a id='comment:261'></a>\nReplying to [mkoeppe](#comment%3A260):\n> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> \n> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\n\nthis looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget\nto append them to `LDFLAGS` for testing in `AC_RUN_IF_ELSE`. Something like this should make it work\n(assuming these flags are getting into `PPL_LDFLAGS` at all):\n\n```diff\n--- a/m4/ppl.m4\n+++ b/m4/ppl.m4\n@@ -96,9 +96,11 @@ else\n   if test \"x$enable_ppltest\" = xyes\n   then\n     ac_save_CPPFLAGS=\"$CPPFLAGS\"\n+    ac_save_LDFLAGS=\"$LDFLAGS\"\n     ac_save_LIBS=\"$LIBS\"\n     CPPFLAGS=\"$CPPFLAGS $PPL_CPPFLAGS\"\n     LIBS=\"$LIBS $PPL_LIBS\"\n+    LDFLAGS=\"$LDFLAGS $PPL_LDFLAGS\"\n \n dnl Now check if the installed PPL is sufficiently new.\n dnl (Also sanity checks the results of ppl-config to some extent.)\n@@ -238,6 +240,7 @@ main() {\n \n     CPPFLAGS=\"$ac_save_CPPFLAGS\"\n     LIBS=\"$ac_save_LIBS\"\n+    LDFLAGS=\"$ac_save_LDFLAGS\"\n   fi\n fi\n \n@@ -261,6 +264,7 @@ else\n       echo \"*** Could not run PPL test program, checking why...\"\n       CPPFLAGS=\"$CPPFLAGS $PPL_CPPFLAGS\"\n       LIBS=\"$LIBS $PPL_LIBS\"\n+      LDFLAGS=\"$LDFLAGS $PPL_LDFLAGS\"\n       AC_LINK_IFELSE([AC_LANG_PROGRAM([[\n #include <ppl.hh>\n using namespace Parma_Polyhedra_Library;\n@@ -287,6 +291,7 @@ using namespace Parma_Polyhedra_Library;\n ])\n       CPPFLAGS=\"$ac_save_CPPFLAGS\"\n       LIBS=\"$ac_save_LIBS\"\n+      LDFLAGS=\"$ac_save_LDFLAGS\"\n     fi\n   fi\n   PPL_CPPFLAGS=\"\"\n```\n\nUntested.",
    "created_at": "2022-03-17T09:24:27Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496620",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:261'></a>
Replying to [mkoeppe](#comment%3A260):
> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> 
> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true


this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget
to append them to `LDFLAGS` for testing in `AC_RUN_IF_ELSE`. Something like this should make it work
(assuming these flags are getting into `PPL_LDFLAGS` at all):

```diff
--- a/m4/ppl.m4
+++ b/m4/ppl.m4
@@ -96,9 +96,11 @@ else
   if test "x$enable_ppltest" = xyes
   then
     ac_save_CPPFLAGS="$CPPFLAGS"
+    ac_save_LDFLAGS="$LDFLAGS"
     ac_save_LIBS="$LIBS"
     CPPFLAGS="$CPPFLAGS $PPL_CPPFLAGS"
     LIBS="$LIBS $PPL_LIBS"
+    LDFLAGS="$LDFLAGS $PPL_LDFLAGS"
 
 dnl Now check if the installed PPL is sufficiently new.
 dnl (Also sanity checks the results of ppl-config to some extent.)
@@ -238,6 +240,7 @@ main() {
 
     CPPFLAGS="$ac_save_CPPFLAGS"
     LIBS="$ac_save_LIBS"
+    LDFLAGS="$ac_save_LDFLAGS"
   fi
 fi
 
@@ -261,6 +264,7 @@ else
       echo "*** Could not run PPL test program, checking why..."
       CPPFLAGS="$CPPFLAGS $PPL_CPPFLAGS"
       LIBS="$LIBS $PPL_LIBS"
+      LDFLAGS="$LDFLAGS $PPL_LDFLAGS"
       AC_LINK_IFELSE([AC_LANG_PROGRAM([[
 #include <ppl.hh>
 using namespace Parma_Polyhedra_Library;
@@ -287,6 +291,7 @@ using namespace Parma_Polyhedra_Library;
 ])
       CPPFLAGS="$ac_save_CPPFLAGS"
       LIBS="$ac_save_LIBS"
+      LDFLAGS="$ac_save_LDFLAGS"
     fi
   fi
   PPL_CPPFLAGS=""
```

Untested.



---

archive/issue_comments_496621.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a\">7bb23f9</a></td><td><code>Try again without lower limit for singular</code></td></tr></table>\n",
    "created_at": "2022-03-17T09:38:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a">7bb23f9</a></td><td><code>Try again without lower limit for singular</code></td></tr></table>




---

archive/issue_comments_496622.json:
```json
{
    "body": "**Changing commit** from \"[9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)\" to \"[7bb23f9208d93660c60401605f9ed59c7569477a](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)\".",
    "created_at": "2022-03-17T09:38:52Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2](https://github.com/sagemath/sagetrac-mirror/commit/9f8cb1d94dfaaf8c3d556df47e07fafd582d67e2)" to "[7bb23f9208d93660c60401605f9ed59c7569477a](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)".



---

archive/issue_comments_496623.json:
```json
{
    "body": "**Changing commit** from \"[7bb23f9208d93660c60401605f9ed59c7569477a](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)\" to \"[886d8952e21c95388207df2509c6954ff3ed66c2](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)\".",
    "created_at": "2022-03-17T09:41:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7bb23f9208d93660c60401605f9ed59c7569477a](https://github.com/sagemath/sagetrac-mirror/commit/7bb23f9208d93660c60401605f9ed59c7569477a)" to "[886d8952e21c95388207df2509c6954ff3ed66c2](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)".



---

archive/issue_comments_496624.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2\">886d895</a></td><td><code>...and without lrcalc lower bound</code></td></tr></table>\n",
    "created_at": "2022-03-17T09:41:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2">886d895</a></td><td><code>...and without lrcalc lower bound</code></td></tr></table>




---

archive/issue_comments_496625.json:
```json
{
    "body": "<a id='comment:264'></a>\nNo, it's a bug in the conda package with binary relocation. Will fix shortly.\n\nReplying to [dimpase](#comment%3A261):\n> Replying to [mkoeppe](#comment%3A260):\n> > I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> > \n> > see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\n> \n> this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget\n",
    "created_at": "2022-03-17T09:44:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496625",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:264'></a>
No, it's a bug in the conda package with binary relocation. Will fix shortly.

Replying to [dimpase](#comment%3A261):
> Replying to [mkoeppe](#comment%3A260):
> > I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> > 
> > see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true

> 
> this looks to me like a bug in `m4/ppl.m4`. They extract `-L`, etc, flags into `PPL_LDFLAGS` but forget




---

archive/issue_comments_496626.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary. It also looks like on github `lcalc 2.1` and `singular 4.2.1.p3` are used automatically. This is also expected since conda always tries to use the most recent versions and only in very rare instances lower bounds are necessary (essentially only if there are two different branches in the dependency resolution tree, and conda would choose the 'wrong' one). Why did you added these lower bounds?",
    "created_at": "2022-03-17T12:58:35Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496626",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:5'></a>
I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary. It also looks like on github `lcalc 2.1` and `singular 4.2.1.p3` are used automatically. This is also expected since conda always tries to use the most recent versions and only in very rare instances lower bounds are necessary (essentially only if there are two different branches in the dependency resolution tree, and conda would choose the 'wrong' one). Why did you added these lower bounds?



---

archive/issue_comments_496627.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [mkoeppe](#comment%3A260):\n> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.\n> \n> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true\n\n\nAnd which advantages does one now gain from the fact that the github workflow already quits after the configure step, and doesn't run build and tests?\n\nMoreover, after the change with the force parameter the github matcher is no longer working correctly since now \" no suitable system package; this is an error\" is displayed in the logs.",
    "created_at": "2022-03-17T13:55:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496627",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>
Replying to [mkoeppe](#comment%3A260):
> I have also added tests on `macos-latest`. This reproduces an error that I saw on my machine: `ppl` is rejected by the configure script.
> 
> see https://github.com/mkoeppe/sage/runs/5581501610?check_suite_focus=true


And which advantages does one now gain from the fact that the github workflow already quits after the configure step, and doesn't run build and tests?

Moreover, after the change with the force parameter the github matcher is no longer working correctly since now " no suitable system package; this is an error" is displayed in the logs.



---

archive/issue_comments_496628.json:
```json
{
    "body": "**Changing commit** from \"[886d8952e21c95388207df2509c6954ff3ed66c2](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)\" to \"[a93b23651fa91e445eefd3122e1929f1a87c4a9b](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)\".",
    "created_at": "2022-03-17T15:09:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[886d8952e21c95388207df2509c6954ff3ed66c2](https://github.com/sagemath/sagetrac-mirror/commit/886d8952e21c95388207df2509c6954ff3ed66c2)" to "[a93b23651fa91e445eefd3122e1929f1a87c4a9b](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)".



---

archive/issue_comments_496629.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b\">a93b236</a></td><td><code>.github/workflows/ci-conda.yml: Reorder matrix</code></td></tr></table>\n",
    "created_at": "2022-03-17T15:09:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b">a93b236</a></td><td><code>.github/workflows/ci-conda.yml: Reorder matrix</code></td></tr></table>




---

archive/issue_comments_496630.json:
```json
{
    "body": "<a id='comment:268'></a>\nReplying to [gh-tobiasdiez](#comment%3A265):\n> I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary\n\n\nYes, they are not needed any more, thanks.",
    "created_at": "2022-03-17T15:10:08Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496630",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:268'></a>
Replying to [gh-tobiasdiez](#comment%3A265):
> I've reverted the changes to the lower bounds to singular and lrcalc since for me they were not necessary


Yes, they are not needed any more, thanks.



---

archive/issue_comments_496631.json:
```json
{
    "body": "<a id='comment:9'></a>\n@isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb\n\n```\nWarning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n  \n  ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n  Rolling back transaction: ...working... done\n  Warning: \n  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n  ==> script messages <==\n  <None>\n  ==> script output <==\n  stdout: Warning: GDB is not codesigned.\n  Generating and installing gdb_codesign certificate\n  \n  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n  error: Something went wrong when installing the certificate\n  \n  return code: 1\n  \n  ()\n  \n  \n  \n  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n  ==> script messages <==\n  <None>\n  ==> script output <==\n  stdout: Warning: GDB is not codesigned.\n  Generating and installing gdb_codesign certificate\n  \n  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n  error: Something went wrong when installing the certificate\n  \n  return code: 1\n  \n```",
    "created_at": "2022-03-17T15:12:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496631",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
@isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb

```
Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
  
  ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
  Rolling back transaction: ...working... done
  Warning: 
  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
  ==> script messages <==
  <None>
  ==> script output <==
  stdout: Warning: GDB is not codesigned.
  Generating and installing gdb_codesign certificate
  
  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
  error: Something went wrong when installing the certificate
  
  return code: 1
  
  ()
  
  
  
  LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
  location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
  ==> script messages <==
  <None>
  ==> script output <==
  stdout: Warning: GDB is not codesigned.
  Generating and installing gdb_codesign certificate
  
  stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
  error: Something went wrong when installing the certificate
  
  return code: 1
  
```



---

archive/issue_comments_496632.json:
```json
{
    "body": "<a id='comment:0'></a>\n@isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?",
    "created_at": "2022-03-17T16:32:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496632",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:0'></a>
@isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?



---

archive/issue_comments_496633.json:
```json
{
    "body": "<a id='comment:271'></a>\nReplying to [mkoeppe](#comment%3A258):\n> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion\n\n\nThis one is specific to Linux; it's fine on macos.",
    "created_at": "2022-03-17T16:37:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496633",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:271'></a>
Replying to [mkoeppe](#comment%3A258):
> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion


This one is specific to Linux; it's fine on macos.



---

archive/issue_comments_496634.json:
```json
{
    "body": "**Changing commit** from \"[a93b23651fa91e445eefd3122e1929f1a87c4a9b](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)\" to \"[ed0967c881b63c928391ce4cbe8f7bf6370d187c](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)\".",
    "created_at": "2022-03-17T17:00:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a93b23651fa91e445eefd3122e1929f1a87c4a9b](https://github.com/sagemath/sagetrac-mirror/commit/a93b23651fa91e445eefd3122e1929f1a87c4a9b)" to "[ed0967c881b63c928391ce4cbe8f7bf6370d187c](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)".



---

archive/issue_comments_496635.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c\">ed0967c</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>\n",
    "created_at": "2022-03-17T17:00:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c">ed0967c</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>




---

archive/issue_comments_496636.json:
```json
{
    "body": "<a id='comment:273'></a>\nReplying to [git](#comment%3A272):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c\">ed0967c</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>\n\n\nError: Unable to process command '::add-matcher::.github/workflows/configure-systempackage-problem-matcher.json' successfully.\nError: After parsing a value an unexpected character was encountered: {. Path 'problemMatcher[0]', line 15, position 8.",
    "created_at": "2022-03-17T19:21:02Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496636",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:273'></a>
Replying to [git](#comment%3A272):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c">ed0967c</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Also match 'no suitable system package; this is an error'</code></td></tr></table>


Error: Unable to process command '::add-matcher::.github/workflows/configure-systempackage-problem-matcher.json' successfully.
Error: After parsing a value an unexpected character was encountered: {. Path 'problemMatcher[0]', line 15, position 8.



---

archive/issue_comments_496637.json:
```json
{
    "body": "<a id='comment:4'></a>\nIs there something else that is left to do?",
    "created_at": "2022-03-17T19:21:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496637",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>
Is there something else that is left to do?



---

archive/issue_comments_496638.json:
```json
{
    "body": "<a id='comment:275'></a>\nReplying to [mkoeppe](#comment%3A270):\n> @isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?\n\n\nNot easy to do. It's better to silence in the doctest machinery",
    "created_at": "2022-03-17T19:32:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496638",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:275'></a>
Replying to [mkoeppe](#comment%3A270):
> @isuruf, on macos I see lots of warnings `ld: warning: -pie being ignored. It is only used when linking a main executable` in the doctests. I see this is coming from `LDFLAGS` in the conda environments. Is this something that can be fixed, or should we silence this warning in our doctest machinery?


Not easy to do. It's better to silence in the doctest machinery



---

archive/issue_comments_496639.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK, I'll do that so that the noise from these warnings does not hide real failures",
    "created_at": "2022-03-17T19:33:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496639",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
OK, I'll do that so that the noise from these warnings does not hide real failures



---

archive/issue_comments_496640.json:
```json
{
    "body": "<a id='comment:277'></a>\nCan you open an issue in https://github.com/conda-forge/gdb-feedstock/?\n\nReplying to [mkoeppe](#comment%3A269):\n> @isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb\n> \n> ```\n> Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n>   \n>   ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.\n>   Rolling back transaction: ...working... done\n>   Warning: \n>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n>   ==> script messages <==\n>   <None>\n>   ==> script output <==\n>   stdout: Warning: GDB is not codesigned.\n>   Generating and installing gdb_codesign certificate\n>   \n>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n>   error: Something went wrong when installing the certificate\n>   \n>   return code: 1\n>   \n>   ()\n>   \n>   \n>   \n>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3\n>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh\n>   ==> script messages <==\n>   <None>\n>   ==> script output <==\n>   stdout: Warning: GDB is not codesigned.\n>   Generating and installing gdb_codesign certificate\n>   \n>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory\n>   error: Something went wrong when installing the certificate\n>   \n>   return code: 1\n>   \n> ```\n",
    "created_at": "2022-03-17T19:37:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496640",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:277'></a>
Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?

Replying to [mkoeppe](#comment%3A269):
> @isuruf, on macos with `environment-optional.yml` (https://github.com/mkoeppe/sage/runs/5586815094?check_suite_focus=true), I am getting an error from gdb
> 
> ```
> Warning: ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
>   
>   ERROR conda.core.link:_execute(699): An error occurred while installing package 'conda-forge::gdb-11.1-py38h36b043a_3'.
>   Rolling back transaction: ...working... done
>   Warning: 
>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
>   ==> script messages <==
>   <None>
>   ==> script output <==
>   stdout: Warning: GDB is not codesigned.
>   Generating and installing gdb_codesign certificate
>   
>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
>   error: Something went wrong when installing the certificate
>   
>   return code: 1
>   
>   ()
>   
>   
>   
>   LinkError: post-link script failed for package conda-forge::gdb-11.1-py38h36b043a_3
>   location of failed script: /usr/local/miniconda/envs/sage-build/bin/.gdb-post-link.sh
>   ==> script messages <==
>   <None>
>   ==> script output <==
>   stdout: Warning: GDB is not codesigned.
>   Generating and installing gdb_codesign certificate
>   
>   stderr: cat: /usr/local/miniconda/envs/sage-build/etc/gdb/.messages.txt: No such file or directory
>   error: Something went wrong when installing the certificate
>   
>   return code: 1
>   
> ```




---

archive/issue_comments_496641.json:
```json
{
    "body": "<a id='comment:8'></a>\nA minor thing to fix: Installing sagelib downgrades `scipy`, `networkx` via install-requires; that's now #33520.",
    "created_at": "2022-03-17T19:41:59Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496641",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
A minor thing to fix: Installing sagelib downgrades `scipy`, `networkx` via install-requires; that's now #33520.



---

archive/issue_comments_496642.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146\">d7dfa69</a></td><td><code>sage.features.pkg_systems.SagePackageSystem: Check if there are any installation records</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:51:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496642",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146">d7dfa69</a></td><td><code>sage.features.pkg_systems.SagePackageSystem: Check if there are any installation records</code></td></tr></table>




---

archive/issue_comments_496643.json:
```json
{
    "body": "**Changing commit** from \"[ed0967c881b63c928391ce4cbe8f7bf6370d187c](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)\" to \"[d7dfa69ce69c843bd000a80266276f17b9421146](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)\".",
    "created_at": "2022-03-17T19:51:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ed0967c881b63c928391ce4cbe8f7bf6370d187c](https://github.com/sagemath/sagetrac-mirror/commit/ed0967c881b63c928391ce4cbe8f7bf6370d187c)" to "[d7dfa69ce69c843bd000a80266276f17b9421146](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)".



---

archive/issue_comments_496644.json:
```json
{
    "body": "**Changing dependencies** from \"#33358, #33330, #33361\" to \"#33358, #33330, #33361, #33141\".",
    "created_at": "2022-03-17T19:52:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496644",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#33358, #33330, #33361" to "#33358, #33330, #33361, #33141".



---

archive/issue_comments_496645.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07545e9bf3eb33b7f3456d0cd588ead12be69703\">07545e9</a></td><td><code>Fix sage_setup doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa971bd929f7c95829710e00c5b6774304ffa964\">aa971bd</a></td><td><code>Fix doctest in sage_docbuild/__init__.py. Most of the test rely on location that are writable or the presence of documentation sources.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54bd2f5cbb8b7f8c0771b503565246b7e7abd530\">54bd2f5</a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c1dc29874c195a4ee6a370ca73b86840f5f3b06\">6c1dc29</a></td><td><code>replace optional build tag with sage_spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18308fc6efa732b7174b2e7368e95c73c6fd533c\">18308fc</a></td><td><code>get rid of the last optional build tag</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2c9eeace4712372fd8e41d06f96771af6109c3e\">e2c9eea</a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5382264eb319f8d650fb1ec8bb0bf36ca2d96f25\">5382264</a></td><td><code>make doctest in find_extra_files more robust by sorting the result so that the order is stable.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c\">6b24c05</a></td><td><code>Merge #33141</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:52:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07545e9bf3eb33b7f3456d0cd588ead12be69703">07545e9</a></td><td><code>Fix sage_setup doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa971bd929f7c95829710e00c5b6774304ffa964">aa971bd</a></td><td><code>Fix doctest in sage_docbuild/__init__.py. Most of the test rely on location that are writable or the presence of documentation sources.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54bd2f5cbb8b7f8c0771b503565246b7e7abd530">54bd2f5</a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c1dc29874c195a4ee6a370ca73b86840f5f3b06">6c1dc29</a></td><td><code>replace optional build tag with sage_spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18308fc6efa732b7174b2e7368e95c73c6fd533c">18308fc</a></td><td><code>get rid of the last optional build tag</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2c9eeace4712372fd8e41d06f96771af6109c3e">e2c9eea</a></td><td><code>Merge branch 'develop' into distro_doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5382264eb319f8d650fb1ec8bb0bf36ca2d96f25">5382264</a></td><td><code>make doctest in find_extra_files more robust by sorting the result so that the order is stable.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c">6b24c05</a></td><td><code>Merge #33141</code></td></tr></table>




---

archive/issue_comments_496646.json:
```json
{
    "body": "**Changing commit** from \"[d7dfa69ce69c843bd000a80266276f17b9421146](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)\" to \"[6b24c05f1b19135fcd50cedd535d749a48cf024c](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)\".",
    "created_at": "2022-03-17T19:52:38Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496646",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d7dfa69ce69c843bd000a80266276f17b9421146](https://github.com/sagemath/sagetrac-mirror/commit/d7dfa69ce69c843bd000a80266276f17b9421146)" to "[6b24c05f1b19135fcd50cedd535d749a48cf024c](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)".



---

archive/issue_comments_496647.json:
```json
{
    "body": "**Changing commit** from \"[6b24c05f1b19135fcd50cedd535d749a48cf024c](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)\" to \"[a408a001d19fc2466fb2c468814598d2379e0290](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)\".",
    "created_at": "2022-03-17T19:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496647",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6b24c05f1b19135fcd50cedd535d749a48cf024c](https://github.com/sagemath/sagetrac-mirror/commit/6b24c05f1b19135fcd50cedd535d749a48cf024c)" to "[a408a001d19fc2466fb2c468814598d2379e0290](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)".



---

archive/issue_comments_496648.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290\">a408a00</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix syntax</code></td></tr></table>\n",
    "created_at": "2022-03-17T19:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290">a408a00</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix syntax</code></td></tr></table>




---

archive/issue_comments_496649.json:
```json
{
    "body": "**Changing commit** from \"[a408a001d19fc2466fb2c468814598d2379e0290](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)\" to \"[8631ae1d1770f7e6ea5e28463c523fc6cd29e42c](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)\".",
    "created_at": "2022-03-17T20:02:57Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a408a001d19fc2466fb2c468814598d2379e0290](https://github.com/sagemath/sagetrac-mirror/commit/a408a001d19fc2466fb2c468814598d2379e0290)" to "[8631ae1d1770f7e6ea5e28463c523fc6cd29e42c](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)".



---

archive/issue_comments_496650.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c\">8631ae1</a></td><td><code>src/sage/doctest/parsing.py: Filter out ld warnings on macOS conda</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:02:57Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c">8631ae1</a></td><td><code>src/sage/doctest/parsing.py: Filter out ld warnings on macOS conda</code></td></tr></table>




---

archive/issue_comments_496651.json:
```json
{
    "body": "**Changing commit** from \"[8631ae1d1770f7e6ea5e28463c523fc6cd29e42c](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)\" to \"[acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)\".",
    "created_at": "2022-03-17T20:05:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8631ae1d1770f7e6ea5e28463c523fc6cd29e42c](https://github.com/sagemath/sagetrac-mirror/commit/8631ae1d1770f7e6ea5e28463c523fc6cd29e42c)" to "[acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)".



---

archive/issue_comments_496652.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65\">acf80df</a></td><td><code>build/pkgs/gdb/distros/conda.txt: Disable</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:05:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496652",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65">acf80df</a></td><td><code>build/pkgs/gdb/distros/conda.txt: Disable</code></td></tr></table>




---

archive/issue_comments_496653.json:
```json
{
    "body": "<a id='comment:285'></a>\nReplying to [isuruf](#comment%3A277):\n> Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?\n\n\nWill do. For now I've disabled it",
    "created_at": "2022-03-17T20:06:13Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496653",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:285'></a>
Replying to [isuruf](#comment%3A277):
> Can you open an issue in https://github.com/conda-forge/gdb-feedstock/?


Will do. For now I've disabled it



---

archive/issue_comments_496654.json:
```json
{
    "body": "<a id='comment:6'></a>\nI've opened https://github.com/conda-forge/gdb-feedstock/issues/53",
    "created_at": "2022-03-17T20:24:55Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496654",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
I've opened https://github.com/conda-forge/gdb-feedstock/issues/53



---

archive/issue_comments_496655.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428\">b431edb</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>\n",
    "created_at": "2022-03-17T20:27:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496655",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428">b431edb</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>




---

archive/issue_comments_496656.json:
```json
{
    "body": "**Changing commit** from \"[acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)\" to \"[b431edb380db1a4bd7fc07c5619bc350a45ca428](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)\".",
    "created_at": "2022-03-17T20:27:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496656",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65](https://github.com/sagemath/sagetrac-mirror/commit/acf80dfe0c61f4b43f13c6ec168f7ba149b3bb65)" to "[b431edb380db1a4bd7fc07c5619bc350a45ca428](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)".



---

archive/issue_comments_496657.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe, Dima Pasechnik\" to \"Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634\".",
    "created_at": "2022-03-17T21:44:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496657",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Matthias Koeppe, Dima Pasechnik" to "Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634".



---

archive/issue_comments_496658.json:
```json
{
    "body": "<a id='comment:289'></a>\nReplying to [git](#comment%3A287):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428\">b431edb</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>\n\n\n`echo \"::remove-matcher owner=configure-systempackage::\"` in the workflow has to be probably be changed as well now.",
    "created_at": "2022-03-17T22:27:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496658",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:289'></a>
Replying to [git](#comment%3A287):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428">b431edb</a></td><td><code>.github/workflows/configure-systempackage-problem-matcher.json: Fix 'Duplicate owner name'</code></td></tr></table>


`echo "::remove-matcher owner=configure-systempackage::"` in the workflow has to be probably be changed as well now.



---

archive/issue_comments_496659.json:
```json
{
    "body": "<a id='comment:290'></a>\nBtw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.",
    "created_at": "2022-03-17T22:29:34Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496659",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:290'></a>
Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.



---

archive/issue_comments_496660.json:
```json
{
    "body": "<a id='comment:1'></a>\nmacos-latest-3.8-environment: https://github.com/mkoeppe/sage/runs/5591728773?check_suite_focus=true\n\n```\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/env.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/expect.py  # 40 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/gap.py  # 75 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/mwrank.py  # 6 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/quit.py  # 6 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interpreter.py  # 2 doctests failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interface_magic.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/ipython_kernel/install.py  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/structure/coerce_actions.pyx  # 1 doctest failed\nsage -t --random-seed=295057506920321218473335936870781003380 src/sage/tests/cmdline.py  # 2 doctests failed\n```",
    "created_at": "2022-03-17T22:56:43Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496660",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
macos-latest-3.8-environment: https://github.com/mkoeppe/sage/runs/5591728773?check_suite_focus=true

```
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/env.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/expect.py  # 40 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/gap.py  # 75 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/mwrank.py  # 6 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/interfaces/quit.py  # 6 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interpreter.py  # 2 doctests failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/interface_magic.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/repl/ipython_kernel/install.py  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/structure/coerce_actions.pyx  # 1 doctest failed
sage -t --random-seed=295057506920321218473335936870781003380 src/sage/tests/cmdline.py  # 2 doctests failed
```



---

archive/issue_comments_496661.json:
```json
{
    "body": "<a id='comment:2'></a>\nI think the many failures from `sage.interfaces` are the failure of too recent versions of `ptyprocess` (#32147).",
    "created_at": "2022-03-17T23:00:48Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496661",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
I think the many failures from `sage.interfaces` are the failure of too recent versions of `ptyprocess` (#32147).



---

archive/issue_comments_496662.json:
```json
{
    "body": "<a id='comment:3'></a>\n@isuruf unfortunately, the only working version of ptyprocess (0.5.1) on macOS is only available on outdated python versions in conda-forge.\n\n```\nptyprocess                     0.5.1          py27_0  conda-forge         \nptyprocess                     0.5.1          py34_0  conda-forge         \nptyprocess                     0.5.1          py35_0  conda-forge         \nptyprocess                     0.5.1          py36_0  conda-forge         \n```",
    "created_at": "2022-03-17T23:08:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496662",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
@isuruf unfortunately, the only working version of ptyprocess (0.5.1) on macOS is only available on outdated python versions in conda-forge.

```
ptyprocess                     0.5.1          py27_0  conda-forge         
ptyprocess                     0.5.1          py34_0  conda-forge         
ptyprocess                     0.5.1          py35_0  conda-forge         
ptyprocess                     0.5.1          py36_0  conda-forge         
```



---

archive/issue_comments_496663.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84\">6f9a2d0</a></td><td><code>src/setup.cfg.m4: Add ptyprocess to install-requires to get version constraint</code></td></tr></table>\n",
    "created_at": "2022-03-17T23:09:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496663",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84">6f9a2d0</a></td><td><code>src/setup.cfg.m4: Add ptyprocess to install-requires to get version constraint</code></td></tr></table>




---

archive/issue_comments_496664.json:
```json
{
    "body": "**Changing commit** from \"[b431edb380db1a4bd7fc07c5619bc350a45ca428](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)\" to \"[6f9a2d052cae43ba87c35c601d443ac2ca7a6b84](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)\".",
    "created_at": "2022-03-17T23:09:05Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b431edb380db1a4bd7fc07c5619bc350a45ca428](https://github.com/sagemath/sagetrac-mirror/commit/b431edb380db1a4bd7fc07c5619bc350a45ca428)" to "[6f9a2d052cae43ba87c35c601d443ac2ca7a6b84](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)".



---

archive/issue_comments_496665.json:
```json
{
    "body": "<a id='comment:295'></a>\nReplying to [gh-tobiasdiez](#comment%3A290):\n> Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.\n\n\nThanks, yes, but the pipeline is pretty clogged",
    "created_at": "2022-03-17T23:23:03Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496665",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:295'></a>
Replying to [gh-tobiasdiez](#comment%3A290):
> Btw, the new workflow is running in the sagetrac-mirror repo (https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml) so you don't have to run this manually in your own fork.


Thanks, yes, but the pipeline is pretty clogged



---

archive/issue_comments_496666.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4\">4de700d</a></td><td><code>.github/workflows/ci-conda.yml: Update ::remove-matcher</code></td></tr></table>\n",
    "created_at": "2022-03-17T23:24:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496666",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4">4de700d</a></td><td><code>.github/workflows/ci-conda.yml: Update ::remove-matcher</code></td></tr></table>




---

archive/issue_comments_496667.json:
```json
{
    "body": "**Changing commit** from \"[6f9a2d052cae43ba87c35c601d443ac2ca7a6b84](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)\" to \"[4de700d8ed1265e7781a0d2296d68cc7846c7ac4](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)\".",
    "created_at": "2022-03-17T23:24:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496667",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6f9a2d052cae43ba87c35c601d443ac2ca7a6b84](https://github.com/sagemath/sagetrac-mirror/commit/6f9a2d052cae43ba87c35c601d443ac2ca7a6b84)" to "[4de700d8ed1265e7781a0d2296d68cc7846c7ac4](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)".



---

archive/issue_comments_496668.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634\" to \"Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113\".",
    "created_at": "2022-03-17T23:31:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496668",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2000712634" to "Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113".



---

archive/issue_comments_496669.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe other failures on macOS are very minor.",
    "created_at": "2022-03-17T23:32:34Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496669",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
The other failures on macOS are very minor.



---

archive/issue_comments_496670.json:
```json
{
    "body": "<a id='comment:299'></a>\nReplying to [mkoeppe](#comment%3A258):\n> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion\n\n\nThis failure on Linux is the remaining big issue.",
    "created_at": "2022-03-17T23:36:06Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496670",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:299'></a>
Replying to [mkoeppe](#comment%3A258):
> There's something wrong with libgiac, in the doctests of `src/sage/calculus/calculus.py` it looks like infinite recursion


This failure on Linux is the remaining big issue.



---

archive/issue_comments_496671.json:
```json
{
    "body": "<a id='comment:0'></a>\n(The log of these runs is about 250 MB uncompressed, not fun to look at.)",
    "created_at": "2022-03-17T23:43:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496671",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:0'></a>
(The log of these runs is about 250 MB uncompressed, not fun to look at.)



---

archive/issue_comments_496672.json:
```json
{
    "body": "<a id='comment:1'></a>\nThere's also some cysignals-related breakage on Linux:\n\n```\n2022-03-17T21:25:16.4730359Z **********************************************************************\n2022-03-17T21:25:16.4812929Z File \"src/sage/functions/min_max.py\", line 240, in sage.functions.min_max.MaxSymbolic._evalf_\n2022-03-17T21:25:16.4813319Z Failed example:\n2022-03-17T21:25:16.4813740Z     sig_on_count() # check sig_on/off pairings (virtual doctest)\n2022-03-17T21:25:16.4814033Z Expected:\n2022-03-17T21:25:16.4814224Z     0\n2022-03-17T21:25:16.4814414Z Got:\n2022-03-17T21:25:16.4814603Z     2947\n2022-03-17T21:25:16.4935843Z **********************************************************************\n```",
    "created_at": "2022-03-17T23:52:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496672",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
There's also some cysignals-related breakage on Linux:

```
2022-03-17T21:25:16.4730359Z **********************************************************************
2022-03-17T21:25:16.4812929Z File "src/sage/functions/min_max.py", line 240, in sage.functions.min_max.MaxSymbolic._evalf_
2022-03-17T21:25:16.4813319Z Failed example:
2022-03-17T21:25:16.4813740Z     sig_on_count() # check sig_on/off pairings (virtual doctest)
2022-03-17T21:25:16.4814033Z Expected:
2022-03-17T21:25:16.4814224Z     0
2022-03-17T21:25:16.4814414Z Got:
2022-03-17T21:25:16.4814603Z     2947
2022-03-17T21:25:16.4935843Z **********************************************************************
```



---

archive/issue_comments_496673.json:
```json
{
    "body": "<a id='comment:2'></a>\ngiac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29",
    "created_at": "2022-03-18T06:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496673",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:2'></a>
giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29



---

archive/issue_comments_496674.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b508d1dcf7a04d7c56cfb4225be954f718225129\">b508d1d</a></td><td><code>Cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294\">93fce5a</a></td><td><code>Continue on error in config step</code></td></tr></table>\n",
    "created_at": "2022-03-18T08:58:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b508d1dcf7a04d7c56cfb4225be954f718225129">b508d1d</a></td><td><code>Cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294">93fce5a</a></td><td><code>Continue on error in config step</code></td></tr></table>




---

archive/issue_comments_496675.json:
```json
{
    "body": "**Changing commit** from \"[4de700d8ed1265e7781a0d2296d68cc7846c7ac4](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)\" to \"[93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)\".",
    "created_at": "2022-03-18T08:58:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496675",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4de700d8ed1265e7781a0d2296d68cc7846c7ac4](https://github.com/sagemath/sagetrac-mirror/commit/4de700d8ed1265e7781a0d2296d68cc7846c7ac4)" to "[93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)".



---

archive/issue_comments_496676.json:
```json
{
    "body": "<a id='comment:4'></a>\nMost doctests are now passing, so this should be good to go now (leaving fixes to the other tests to follow-up tickets).",
    "created_at": "2022-03-18T08:59:15Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496676",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>
Most doctests are now passing, so this should be good to go now (leaving fixes to the other tests to follow-up tickets).



---

archive/issue_events_276583.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-18T08:59:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276583"
}
```



---

archive/issue_events_276584.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-18T08:59:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276584"
}
```



---

archive/issue_comments_496677.json:
```json
{
    "body": "<a id='comment:5'></a>\n`continue-on-error` makes no sense because the unconfigured source tree cannot be tested.",
    "created_at": "2022-03-18T15:11:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496677",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
`continue-on-error` makes no sense because the unconfigured source tree cannot be tested.



---

archive/issue_comments_496678.json:
```json
{
    "body": "<a id='comment:306'></a>\nReplying to [isuruf](#comment%3A302):\n> giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29\n\n\nThanks @isuruf, looking great.",
    "created_at": "2022-03-18T15:15:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496678",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:306'></a>
Replying to [isuruf](#comment%3A302):
> giac error should be fixed with https://github.com/conda-forge/giac-feedstock/pull/29


Thanks @isuruf, looking great.



---

archive/issue_comments_496679.json:
```json
{
    "body": "<a id='comment:307'></a>\nReplying to [mkoeppe](#comment%3A305):\n> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n\nOther than that, it's in good shape now. Could someone review my changes please?",
    "created_at": "2022-03-18T15:20:09Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496679",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:307'></a>
Replying to [mkoeppe](#comment%3A305):
> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.


Other than that, it's in good shape now. Could someone review my changes please?



---

archive/issue_comments_496680.json:
```json
{
    "body": "<a id='comment:308'></a>\nReplying to [mkoeppe](#comment%3A305):\n> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n\nThat largely depends on the nature of the error. If the error in the config step is critical, then the build step will fail and no tests are run. Moreover, there is no harm in executing also the other steps, the workflow will still be displayed as failed due to the error in the config job. You just get a bit more information.",
    "created_at": "2022-03-18T15:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496680",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:308'></a>
Replying to [mkoeppe](#comment%3A305):
> `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.


That largely depends on the nature of the error. If the error in the config step is critical, then the build step will fail and no tests are run. Moreover, there is no harm in executing also the other steps, the workflow will still be displayed as failed due to the error in the config job. You just get a bit more information.



---

archive/issue_comments_496681.json:
```json
{
    "body": "<a id='comment:309'></a>\nReplying to [gh-tobiasdiez](#comment%3A308):\n> Replying to [mkoeppe](#comment%3A305):\n> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> \n> That largely depends on the nature of the error. \n\n\nNo, it doesn't. On error, the generated files are not generated.",
    "created_at": "2022-03-18T15:47:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496681",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:309'></a>
Replying to [gh-tobiasdiez](#comment%3A308):
> Replying to [mkoeppe](#comment%3A305):
> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> 
> That largely depends on the nature of the error. 


No, it doesn't. On error, the generated files are not generated.



---

archive/issue_comments_496682.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113\" to \"Matthias Koeppe, Dima Pasechnik, Tobias Diez\".",
    "created_at": "2022-03-18T15:48:29Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496682",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing reviewer** from "Matthias Koeppe, Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/2001401113" to "Matthias Koeppe, Dima Pasechnik, Tobias Diez".



---

archive/issue_comments_496683.json:
```json
{
    "body": "<a id='comment:310'></a>\nReplying to [mkoeppe](#comment%3A307):\n> Replying to [mkoeppe](#comment%3A305):\n> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> \n> Other than that, it's in good shape now. Could someone review my changes please?\n\n\nI'm fine with these changes (although they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow; but lets not be overly pedantic).",
    "created_at": "2022-03-18T15:48:29Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496683",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:310'></a>
Replying to [mkoeppe](#comment%3A307):
> Replying to [mkoeppe](#comment%3A305):
> > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> 
> Other than that, it's in good shape now. Could someone review my changes please?


I'm fine with these changes (although they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow; but lets not be overly pedantic).



---

archive/issue_events_276585.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T15:57:43Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "rename": {
        "from": "GH Actions: Add test for conda without SPKG",
        "to": "Fixes for the conda-for-Sage-developers installation method, add GH Actions workflow"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276585"
}
```



---

archive/issue_comments_496684.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,11 +4,7 @@\n \n Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml\n \n-During the work on this issue the following issues have been detected:\n-- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`\n-- Migrate documentation from wiki to developer docs\n-- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)\n-- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env\n+Fixes:\n - #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`\n - environment-optional: lcalc 1 is installed and then not recognized / leads to error\n \n@@ -23,4 +19,5 @@\n ```\n - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n \n-Fixing these problems will be addressed in a follow-up ticket.\n+Follow-ups: See Meta-ticket #33331\n+\n``````\n",
    "created_at": "2022-03-18T16:04:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496684",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,11 +4,7 @@
 
 Run: https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-conda.yml
 
-During the work on this issue the following issues have been detected:
-- Update documentation to use conda to manage python dependencies instead of relying on `pip -r requirements.txt`
-- Migrate documentation from wiki to developer docs
-- Documentation doesn't mention the use of `--prefix=$CONDA_PREFIX` (without this things like `ecl-config` are not found)
-- The correct version of rpy2, scipy, sphinx among other packages is not installed in the conda env
+Fixes:
 - #33330: primecountpy is not installed in the conda env because its not listed in `environment.yml`
 - environment-optional: lcalc 1 is installed and then not recognized / leads to error
 
@@ -23,4 +19,5 @@
 ```
 - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
 
-Fixing these problems will be addressed in a follow-up ticket.
+Follow-ups: See Meta-ticket #33331
+
``````




---

archive/issue_comments_496685.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.\n+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.\n \n This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)\n \n``````\n",
    "created_at": "2022-03-18T16:05:39Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496685",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This follows the steps outlined at https://wiki.sagemath.org/Conda.
+Add github action workflow that checks the build of sage in a conda environment, completely bypassing the installation of any sage package. This is based on the steps outlined at https://wiki.sagemath.org/Conda.
 
 This also tests that the generated `src/environment*.yml` files work correctly. (See documentation added in #28745)
 
``````




---

archive/issue_comments_496686.json:
```json
{
    "body": "<a id='comment:314'></a>\nReplying to [mkoeppe](#comment%3A309):\n> Replying to [gh-tobiasdiez](#comment%3A308):\n> > Replying to [mkoeppe](#comment%3A305):\n> > > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.\n\n> > \n> > That largely depends on the nature of the error. \n\n> \n> No, it doesn't. On error, the generated files are not generated.\n\n\nI tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.",
    "created_at": "2022-03-18T16:10:58Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496686",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:314'></a>
Replying to [mkoeppe](#comment%3A309):
> Replying to [gh-tobiasdiez](#comment%3A308):
> > Replying to [mkoeppe](#comment%3A305):
> > > `continue-on-error` makes no sense because the unconfigured source tree cannot be tested.

> > 
> > That largely depends on the nature of the error. 

> 
> No, it doesn't. On error, the generated files are not generated.


I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.



---

archive/issue_comments_496687.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,6 +18,12 @@\n     compilation terminated.\n ```\n - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.\n+- Disable conda distro information for `gdb` because it is broken on macOS.\n+- Add conda distro information for `lrcalc_python`\n+- Filter out conda-specific `ld` warnings in doctests\n+- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed\n+- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires\n+\n \n Follow-ups: See Meta-ticket #33331\n \n``````\n",
    "created_at": "2022-03-18T16:16:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496687",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,6 +18,12 @@
     compilation terminated.
 ```
 - environment-optional: probably related, pari 2.11.4 is installed by conda instead of the newest 2.13.2. This version is then rejected by `configure` as being too old.
+- Disable conda distro information for `gdb` because it is broken on macOS.
+- Add conda distro information for `lrcalc_python`
+- Filter out conda-specific `ld` warnings in doctests
+- In the feature test for `sage_spkg`, check whether any Sage packages are actually installed
+- Include an upper version bound for `ptyprocess` in sagemath-standard's install-requires
+
 
 Follow-ups: See Meta-ticket #33331
 
``````




---

archive/issue_comments_496688.json:
```json
{
    "body": "<a id='comment:316'></a>\nReplying to [gh-tobiasdiez](#comment%3A314):\n> I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.\n\n\nYou are right.",
    "created_at": "2022-03-18T16:18:27Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496688",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:316'></a>
Replying to [gh-tobiasdiez](#comment%3A314):
> I tried it locally and the necessary files seem to be still present when `with-system-SPKG=force` triggers an error. Having a quick look at the code these errors are also deferred to the very end of the configure script.


You are right.



---

archive/issue_comments_496689.json:
```json
{
    "body": "<a id='comment:7'></a>\nNevertheless, `continue-on-error` makes no sense as I have explained throughout the thread, [comment:141](#comment%3A141) etc.",
    "created_at": "2022-03-18T16:20:14Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496689",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Nevertheless, `continue-on-error` makes no sense as I have explained throughout the thread, [comment:141](#comment%3A141) etc.



---

archive/issue_events_276586.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:33:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276586"
}
```



---

archive/issue_events_276587.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:33:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276587"
}
```



---

archive/issue_comments_496690.json:
```json
{
    "body": "<a id='comment:8'></a>\nBut it's fine for now, let's see that we can get it merged in 9.6.",
    "created_at": "2022-03-18T16:33:33Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496690",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
But it's fine for now, let's see that we can get it merged in 9.6.



---

archive/issue_comments_496691.json:
```json
{
    "body": "<a id='comment:9'></a>\nOnward to documenting it, #33426?",
    "created_at": "2022-03-18T16:34:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496691",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
Onward to documenting it, #33426?



---

archive/issue_events_276588.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T16:39:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276588"
}
```



---

archive/issue_comments_496692.json:
```json
{
    "body": "<a id='comment:321'></a>\nReplying to [gh-tobiasdiez](#comment%3A310):\n> they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow\n\n\nYes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.\n\nSometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.\n\nBut sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - \"what does it test\"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage.",
    "created_at": "2022-03-18T16:55:17Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496692",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:321'></a>
Replying to [gh-tobiasdiez](#comment%3A310):
> they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow


Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.

Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.

But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - "what does it test"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage.



---

archive/issue_comments_496693.json:
```json
{
    "body": "<a id='comment:2'></a>\nSome of the test suite failures that we saw are from ipython 8.x; #33170 updates the doctests",
    "created_at": "2022-03-18T21:29:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496693",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Some of the test suite failures that we saw are from ipython 8.x; #33170 updates the doctests



---

archive/issue_comments_496694.json:
```json
{
    "body": "<a id='comment:323'></a>\nReplying to [mkoeppe](#comment%3A318):\n> But it's fine for now, let's see that we can get it merged in 9.6.\n\n\nThanks for the review!",
    "created_at": "2022-03-18T22:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496694",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:323'></a>
Replying to [mkoeppe](#comment%3A318):
> But it's fine for now, let's see that we can get it merged in 9.6.


Thanks for the review!



---

archive/issue_comments_496695.json:
```json
{
    "body": "<a id='comment:324'></a>\nReplying to [mkoeppe](#comment%3A319):\n> Onward to documenting it, #33426?\n\n\nYes!",
    "created_at": "2022-03-18T22:12:34Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496695",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:324'></a>
Replying to [mkoeppe](#comment%3A319):
> Onward to documenting it, #33426?


Yes!



---

archive/issue_comments_496696.json:
```json
{
    "body": "<a id='comment:325'></a>\nReplying to [mkoeppe](#comment%3A321):\n> Replying to [gh-tobiasdiez](#comment%3A310):\n> > they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow\n\n> \n> Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.\n> \n> Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.\n> \n> But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - \"what does it test\"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage. \n\n\nIn general I agree that a ticket has to have a clear scope and improvement. For this ticket here, the github workflow essentially didn't change in the past 4 weeks, and at this point it was already clear that the workflow works in principle, with the caveat that a lot of docstests failed. In my opinion, it would have been better to merge the ticket already (with the few additional improvements to the workflow that we have discussed), then follow-up tickets could have easily improved different aspects of the conda environment, while the previous runs of the ci would have served as a baseline. Even thinks like the addition of the tests for macos could have been small follow-up tickets. I really think the tendency of the sage developers to create a lot of parallel, inter-dependent tickets makes reviewing harder and slows down the process. A more linear approach would increase the dev experience and velocity in my opinion.\n\nAnyway, I'm happy that this ticket is finally ready to be merged.",
    "created_at": "2022-03-18T22:27:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496696",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:325'></a>
Replying to [mkoeppe](#comment%3A321):
> Replying to [gh-tobiasdiez](#comment%3A310):
> > they probably should have been extracted to their own tickets as they don't have to do anything with the github workflow

> 
> Yes, the fix to `src/sage/features/pkg_systems.py` could perhaps have been made a separate ticket and a dependency here. But it would have been difficult to test it separately because the present ticket is its only use case.
> 
> Sometimes the scope of a ticket needs to be adjusted during development. You already know that sometimes the scope turns out to be too big and it is necessary break out smaller, more manageable and more clearly defined tickets.
> 
> But sometimes the scope of a ticket also turns out to be too small and the ticket is not viable on its own. This is what happened on the present ticket. The workflow documented in the wiki https://wiki.sagemath.org/Conda has never actually worked. Creating a GH Actions workflow based on a semi-quasi-working variant of it, by itself was not convincing as a ticket (comment:121 - "what does it test"). With the broader scope of actually fixing this way of installing Sage and testing something that we can recommend to developers, the ticket has a viable scope: The changes bring a clear improvement to Sage. 


In general I agree that a ticket has to have a clear scope and improvement. For this ticket here, the github workflow essentially didn't change in the past 4 weeks, and at this point it was already clear that the workflow works in principle, with the caveat that a lot of docstests failed. In my opinion, it would have been better to merge the ticket already (with the few additional improvements to the workflow that we have discussed), then follow-up tickets could have easily improved different aspects of the conda environment, while the previous runs of the ci would have served as a baseline. Even thinks like the addition of the tests for macos could have been small follow-up tickets. I really think the tendency of the sage developers to create a lot of parallel, inter-dependent tickets makes reviewing harder and slows down the process. A more linear approach would increase the dev experience and velocity in my opinion.

Anyway, I'm happy that this ticket is finally ready to be merged.



---

archive/issue_comments_496697.json:
```json
{
    "body": "<a id='comment:326'></a>\nReplying to [gh-tobiasdiez](#comment%3A325):\n> it was already clear that the workflow works in principle\n\n\nThe project generally uses a standard for tickets higher than that.\nYes, there's a tradeoff between velocity and stability.",
    "created_at": "2022-03-18T22:53:14Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496697",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:326'></a>
Replying to [gh-tobiasdiez](#comment%3A325):
> it was already clear that the workflow works in principle


The project generally uses a standard for tickets higher than that.
Yes, there's a tradeoff between velocity and stability.



---

archive/issue_comments_496698.json:
```json
{
    "body": "<a id='comment:7'></a>\nIs there a ticket for the remaining failures after this ticket?",
    "created_at": "2022-03-21T07:28:40Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496698",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:7'></a>
Is there a ticket for the remaining failures after this ticket?



---

archive/issue_comments_496699.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes, they are collected in #33331.",
    "created_at": "2022-03-21T10:09:50Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496699",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'></a>
Yes, they are collected in #33331.



---

archive/issue_events_276589.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-27T15:44:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276589"
}
```



---

archive/issue_events_276590.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6dbf0930e703352dc29f808f3d78c5385bbc74f8",
    "created_at": "2022-03-27T15:44:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30845#event-276590"
}
```



---

archive/issue_comments_496700.json:
```json
{
    "body": "**Changing branch** from \"[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)\" to \"[93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)\".",
    "created_at": "2022-03-27T15:44:10Z",
    "issue": "https://github.com/sagemath/sage/issues/30845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30845#issuecomment-496700",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/build/conda-runci](https://github.com/sagemath/sagetrac-mirror/tree/public/build/conda-runci)" to "[93fce5a1589fcfca91e8be56f13d15f4de646294](https://github.com/sagemath/sagetrac-mirror/commit/93fce5a1589fcfca91e8be56f13d15f4de646294)".
