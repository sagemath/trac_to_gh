# Issue 30587: Remove import of 'ppl' at startup using lazy_import with feature

archive/issues_030350.json:
```json
{
    "body": "Currently, sage imports `ppl` (from `pplpy`) at startup, via `sage.geometry.cone`, `sage.geometry.integral_points`, and `sage.geometry.lattice_polytopes`. \n\nThis should be changed, both\n- as preparation for other backends for polyhedral cones (in particular `PyNormaliz`)\n- for the modularization of sagelib (#29705).\n\n\nIn addition we add documentation to the option `feature` of lazy import and while we are at it, use this option for backend normaliz as well.\n\n\nCC:  @kliem @novoselt @vbraun winfried @jplab @orlitzky @videlec\n\nKeywords: sd111\n\nBranch/Commit: 17c4cdb90244a584e7ee5d98796877d06bfae009\n\nReviewer: Matthias Koeppe, Jonathan Kliem\n\nAuthor: Jonathan Kliem, Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30587\n\n",
    "closed_at": "2020-12-14T23:53:29Z",
    "created_at": "2020-09-16T20:28:37Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Remove import of 'ppl' at startup using lazy_import with feature",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30587",
    "user": "https://github.com/mkoeppe"
}
```
Currently, sage imports `ppl` (from `pplpy`) at startup, via `sage.geometry.cone`, `sage.geometry.integral_points`, and `sage.geometry.lattice_polytopes`. 

This should be changed, both
- as preparation for other backends for polyhedral cones (in particular `PyNormaliz`)
- for the modularization of sagelib (#29705).


In addition we add documentation to the option `feature` of lazy import and while we are at it, use this option for backend normaliz as well.


CC:  @kliem @novoselt @vbraun winfried @jplab @orlitzky @videlec

Keywords: sd111

Branch/Commit: 17c4cdb90244a584e7ee5d98796877d06bfae009

Reviewer: Matthias Koeppe, Jonathan Kliem

Author: Jonathan Kliem, Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30587





---

archive/issue_comments_461698.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461698",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_461699.json:
```json
{
    "body": "<a id='comment:3'></a>I'm looking at this at the moment.\n\nI think one needs to also take case of `Polyhedron_base`, because once it is lazily imported, then it immediately imports all depencies, in particular the stuff from `ppl`.\n\nSo if the goal is to have a working sage as good as possible without `ppl`, then this should be touched as well.\n\n(I tested adding a line `from foo import nonsense` into `backend_ppl.py`. Sage is starting all right, but polyhedra are unusable. However, only backend ppl should fail.)",
    "created_at": "2020-12-07T20:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461699",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>I'm looking at this at the moment.

I think one needs to also take case of `Polyhedron_base`, because once it is lazily imported, then it immediately imports all depencies, in particular the stuff from `ppl`.

So if the goal is to have a working sage as good as possible without `ppl`, then this should be touched as well.

(I tested adding a line `from foo import nonsense` into `backend_ppl.py`. Sage is starting all right, but polyhedra are unusable. However, only backend ppl should fail.)



---

archive/issue_comments_461700.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2020-12-07T21:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461700",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_461701.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-07T21:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461701",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_461702.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-09T21:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461702",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_461703.json:
```json
{
    "body": "<a id='comment:7'></a>If the imports would not wind up in an extremely hot path, you might also work around the circular imports with local ones (`from foo import whatever` within the function that needs `whatever`). Those don't get run until the function is called, but it does introduce a tiny redundant dictionary lookup the second, third, etc times the function is called.",
    "created_at": "2020-12-09T21:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461703",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:7'></a>If the imports would not wind up in an extremely hot path, you might also work around the circular imports with local ones (`from foo import whatever` within the function that needs `whatever`). Those don't get run until the function is called, but it does introduce a tiny redundant dictionary lookup the second, third, etc times the function is called.



---

archive/issue_comments_461704.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T09:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461705.json:
```json
{
    "body": "<a id='comment:9'></a>So lazy import appears to be a bit slower.\n\nFor `%timeit polytopes.cube()` I went from 411 \u00b5s to 417. I don't know if this is acceptable.\nSo there appears to be a overhead of about 6 \u00b5s per call.\n\n---\nNew commits:",
    "created_at": "2020-12-10T09:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461705",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>So lazy import appears to be a bit slower.

For `%timeit polytopes.cube()` I went from 411 µs to 417. I don't know if this is acceptable.
So there appears to be a overhead of about 6 µs per call.

---
New commits:



---

archive/issue_comments_461706.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T10:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461707.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,10 @@\n This should be changed, both\n - as preparation for other backends for polyhedral cones (in particular `PyNormaliz`)\n - for the modularization of sagelib (#29705).\n+\n+\n+In addition we add documentation to the option `feature` of lazy import and while we are at it, use this option for backend normaliz as well.\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-12-10T10:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461707",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,10 @@
 This should be changed, both
 - as preparation for other backends for polyhedral cones (in particular `PyNormaliz`)
 - for the modularization of sagelib (#29705).
+
+
+In addition we add documentation to the option `feature` of lazy import and while we are at it, use this option for backend normaliz as well.
+
 
 Comment: 1
 
``````




---

archive/issue_comments_461708.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-10T10:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461708",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_461709.json:
```json
{
    "body": "<a id='comment:12'></a>In the doctest for `lazy_import`, this text:\n\n```\n+ To install foo using the Sage package manager, you can try to run:\n+        !sage -i non-existing-package\n```\nwill only appear on sage-the-distribution but not in downstream packaged sage, so it's best to use `...` here",
    "created_at": "2020-12-10T16:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461709",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>In the doctest for `lazy_import`, this text:

```
+ To install foo using the Sage package manager, you can try to run:
+        !sage -i non-existing-package
```
will only appear on sage-the-distribution but not in downstream packaged sage, so it's best to use `...` here



---

archive/issue_comments_461710.json:
```json
{
    "body": "<a id='comment:13'></a>Ok, I wasn't exactly sure, what part would appear and what part would not.",
    "created_at": "2020-12-10T16:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461710",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'></a>Ok, I wasn't exactly sure, what part would appear and what part would not.



---

archive/issue_comments_461711.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T16:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461712.json:
```json
{
    "body": "<a id='comment:15'></a>In fact, perhaps `LazyImport.__repr__` should catch this error and print itself in a friendlier way?",
    "created_at": "2020-12-10T16:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461712",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>In fact, perhaps `LazyImport.__repr__` should catch this error and print itself in a friendlier way?



---

archive/issue_comments_461713.json:
```json
{
    "body": "<a id='comment:16'></a>Also typo `An example of and import `: and->an",
    "created_at": "2020-12-10T16:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461713",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Also typo `An example of and import `: and->an



---

archive/issue_comments_461714.json:
```json
{
    "body": "<a id='comment:17'></a>Another data point regarding performance: Without this ticket, I am getting\n\n```\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n51.7 \u00b5s \u00b1 866 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n53.9 \u00b5s \u00b1 774 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n52.8 \u00b5s \u00b1 738 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n```\n\nRight after building this branch, I am getting:\n\n```\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n88.2 \u00b5s \u00b1 22.3 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n57.2 \u00b5s \u00b1 1.22 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n53.5 \u00b5s \u00b1 307 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: %timeit Polyhedron(vertices=[[]])                                                     \n53.2 \u00b5s \u00b1 508 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n```\n\nSo I don't think that we should be concerned about the performance impact here.",
    "created_at": "2020-12-10T16:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461714",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Another data point regarding performance: Without this ticket, I am getting

```
sage: %timeit Polyhedron(vertices=[[]])                                                     
51.7 µs ± 866 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: %timeit Polyhedron(vertices=[[]])                                                     
53.9 µs ± 774 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: %timeit Polyhedron(vertices=[[]])                                                     
52.8 µs ± 738 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
```

Right after building this branch, I am getting:

```
sage: %timeit Polyhedron(vertices=[[]])                                                     
88.2 µs ± 22.3 µs per loop (mean ± std. dev. of 7 runs, 1 loop each)
sage: %timeit Polyhedron(vertices=[[]])                                                     
57.2 µs ± 1.22 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: %timeit Polyhedron(vertices=[[]])                                                     
53.5 µs ± 307 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: %timeit Polyhedron(vertices=[[]])                                                     
53.2 µs ± 508 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
```

So I don't think that we should be concerned about the performance impact here.



---

archive/issue_comments_461715.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T17:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461716.json:
```json
{
    "body": "<a id='comment:19'></a>I think the repr should express somehow that it is a `LazyImport` object so that users who see this output can know where this is coming from.",
    "created_at": "2020-12-10T18:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461716",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>I think the repr should express somehow that it is a `LazyImport` object so that users who see this output can know where this is coming from.



---

archive/issue_comments_461717.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T18:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461717",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461718.json:
```json
{
    "body": "<a id='comment:21'></a>Hm... perhaps only for failed imports?",
    "created_at": "2020-12-10T18:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461718",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Hm... perhaps only for failed imports?



---

archive/issue_comments_461719.json:
```json
{
    "body": "<a id='comment:22'></a>Well the other thing is lying as well. But sure.",
    "created_at": "2020-12-10T19:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461719",
    "user": "https://github.com/kliem"
}
```

<a id='comment:22'></a>Well the other thing is lying as well. But sure.



---

archive/issue_comments_461720.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T19:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461721.json:
```json
{
    "body": "<a id='comment:24'></a>patchbot shows errors",
    "created_at": "2020-12-10T23:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461721",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>patchbot shows errors



---

archive/issue_comments_461722.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-10T23:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461722",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_461723.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-11T07:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461723",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461724.json:
```json
{
    "body": "<a id='comment:27'></a>Somehow forgot that.",
    "created_at": "2020-12-11T07:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461724",
    "user": "https://github.com/kliem"
}
```

<a id='comment:27'></a>Somehow forgot that.



---

archive/issue_comments_461725.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-11T07:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461725",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_461726.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-11T20:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461726",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_461727.json:
```json
{
    "body": "<a id='comment:29'></a>Thank you. So I guess I know how that mechanism works, you can ping me, to do it with other packages.",
    "created_at": "2020-12-11T20:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461727",
    "user": "https://github.com/kliem"
}
```

<a id='comment:29'></a>Thank you. So I guess I know how that mechanism works, you can ping me, to do it with other packages.



---

archive/issue_comments_461728.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-12-13T09:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461728",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_461729.json:
```json
{
    "body": "<a id='comment:30'></a>On OSX:\n\n```\n**********************************************************************\nFile \"src/sage/misc/lazy_import.pyx\", line 1073, in sage.misc.lazy_import.?\nFailed example:\n    not_there\nExpected:\n    Failed lazy import:\n    foo is not available.\n    Importing not_there failed: No module named 'foo'\n    No equivalent system packages for ... are known to Sage.\n    ...\nGot:\n    Failed lazy import:\n    foo is not available.\n    Importing not_there failed: No module named 'foo'\n    To install foo using the unknown package manager, you can try to run:\n    # install the following packages:\n    To install foo using the Sage package manager, you can try to run:\n      !sage -i non-existing-package\n    No equivalent system packages for pip are known to Sage.\n**********************************************************************\n```",
    "created_at": "2020-12-13T09:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461729",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>On OSX:

```
**********************************************************************
File "src/sage/misc/lazy_import.pyx", line 1073, in sage.misc.lazy_import.?
Failed example:
    not_there
Expected:
    Failed lazy import:
    foo is not available.
    Importing not_there failed: No module named 'foo'
    No equivalent system packages for ... are known to Sage.
    ...
Got:
    Failed lazy import:
    foo is not available.
    Importing not_there failed: No module named 'foo'
    To install foo using the unknown package manager, you can try to run:
    # install the following packages:
    To install foo using the Sage package manager, you can try to run:
      !sage -i non-existing-package
    No equivalent system packages for pip are known to Sage.
**********************************************************************
```



---

archive/issue_comments_461730.json:
```json
{
    "body": "<a id='comment:31'></a>Looks like we never tested the runtime system package advice on macOS without homebrew. `unknown` needs special-casing",
    "created_at": "2020-12-13T17:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461730",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>Looks like we never tested the runtime system package advice on macOS without homebrew. `unknown` needs special-casing



---

archive/issue_comments_461731.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-13T17:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461731",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461732.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-13T17:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461732",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461733.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-13T17:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461733",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_461734.json:
```json
{
    "body": "<a id='comment:35'></a>Thanks for the quick fix.",
    "created_at": "2020-12-13T18:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461734",
    "user": "https://github.com/kliem"
}
```

<a id='comment:35'></a>Thanks for the quick fix.



---

archive/issue_comments_461735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-13T18:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461735",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_461736.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-14T23:53:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30587#issuecomment-461736",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_079544.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-14T23:53:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30587",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30587#event-79544"
}
```
