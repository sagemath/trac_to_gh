# Issue 30010: Split sage_setup.docbuild out to a separate distribution sage_docbuild

archive/issues_029773.json:
```json
{
    "assignees": [],
    "body": "`sage_setup.docbuild`, created in #19127, has very different dependencies compared to `sage_setup`:\n\nIt depends on `sagelib` and `sphinx`, \nwhereas the rest of `sage_setup` is for building `sagelib`.\n\nWe remove the nesting within `sage_setup`, creating a new top-level package `sage_docbuild`.\n\nWe split it out as a separate pip-installable distribution package `sage_docbuild`.  \n\nUsing the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.\n\nThis is preparation for #29868 (pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf)\n\n\n\nDepends on #31344\nDepends on #31353\n\nCC:  @kiwifb @jhpalmieri @isuruf @mwageringel @haraldschilly @mezzarobba\n\nKeywords: **sd111**\n\nBranch/Commit: **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**\n\nReviewer: **John Palmieri**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **refactoring**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30010_\n\n",
    "closed_at": "2021-03-09T00:00:35Z",
    "created_at": "2020-06-28T16:16:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Split sage_setup.docbuild out to a separate distribution sage_docbuild",
    "type": "issue",
    "updated_at": "2021-03-09T00:00:35Z",
    "url": "https://github.com/sagemath/sage/issues/30010",
    "user": "https://github.com/mkoeppe"
}
```
`sage_setup.docbuild`, created in #19127, has very different dependencies compared to `sage_setup`:

It depends on `sagelib` and `sphinx`, 
whereas the rest of `sage_setup` is for building `sagelib`.

We remove the nesting within `sage_setup`, creating a new top-level package `sage_docbuild`.

We split it out as a separate pip-installable distribution package `sage_docbuild`.  

Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.

This is preparation for #29868 (pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf)



Depends on #31344
Depends on #31353

CC:  @kiwifb @jhpalmieri @isuruf @mwageringel @haraldschilly @mezzarobba

Keywords: **sd111**

Branch/Commit: **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**

Reviewer: **John Palmieri**

Author: **Matthias Koeppe**

Component: **refactoring**

_Issue created by migration from https://trac.sagemath.org/ticket/30010_





---

archive/issue_events_413233.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T16:16:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413233"
}
```



---

archive/issue_events_413234.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T16:16:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413234"
}
```



---

archive/issue_events_413235.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T16:16:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413235"
}
```



---

archive/issue_events_413236.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T16:16:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413236"
}
```



---

archive/issue_comments_474999.json:
```json
{
    "body": "Dependencies: **#29847**",
    "created_at": "2020-06-28T16:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-474999",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29847**



---

archive/issue_comments_475000.json:
```json
{
    "body": "Changed dependencies from **#29847** to none",
    "created_at": "2020-07-13T19:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475000",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29847** to none



---

archive/issue_comments_475001.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,7 @@\n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n \n-We split it out.\n+We split it out as a separate distutils package `sage_setup-docbuild`.\n \n+Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.\n+\n``````\n",
    "created_at": "2020-07-13T19:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475001",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,7 @@
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
 
-We split it out.
+We split it out as a separate distutils package `sage_setup-docbuild`.
 
+Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.
+
``````




---

archive/issue_events_413237.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-13T19:51:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "title_is": "Split sage_setup.docbuild out to a separate distribution (distutils package)",
    "title_was": "Split sage_setup.docbuild out to a separate package",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413237"
}
```



---

archive/issue_comments_475002.json:
```json
{
    "body": "Dependencies: **#29950**",
    "created_at": "2020-07-13T19:53:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475002",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29950**



---

archive/issue_comments_475003.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n \n-We split it out as a separate distutils package `sage_setup-docbuild`.\n+We split it out as a separate distutils package `sage_setup.docbuild`.\n \n Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.\n \n``````\n",
    "created_at": "2020-07-13T20:40:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475003",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
 
-We split it out as a separate distutils package `sage_setup-docbuild`.
+We split it out as a separate distutils package `sage_setup.docbuild`.
 
 Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.
 
``````




---

archive/issue_comments_475004.json:
```json
{
    "body": "Branch: **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**",
    "created_at": "2020-07-13T21:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475004",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**



---

archive/issue_comments_475005.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4\">b8e366e</a></td><td><code>build/pkgs/sagelib/spkg-src: chmod +x</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0473ef3670f0a39c7d0141c09b9e9fc738d3d0b2\">0473ef3</a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9\">06a3609</a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6\">174626c</a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825\">034a7f7</a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8\">d3c608b</a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06\">7244371</a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f\">4344f89</a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72c50400438e4ef24c483245830f44067829805e\">72c5040</a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04\">ce79954</a></td><td><code>build/pkgs/sage_setup_docbuild: New</code></td></tr></table>\n",
    "created_at": "2020-07-13T21:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475005",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4">b8e366e</a></td><td><code>build/pkgs/sagelib/spkg-src: chmod +x</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0473ef3670f0a39c7d0141c09b9e9fc738d3d0b2">0473ef3</a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9">06a3609</a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6">174626c</a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825">034a7f7</a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8">d3c608b</a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06">7244371</a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f">4344f89</a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72c50400438e4ef24c483245830f44067829805e">72c5040</a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04">ce79954</a></td><td><code>build/pkgs/sage_setup_docbuild: New</code></td></tr></table>




---

archive/issue_comments_475006.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-07-13T21:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475006",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_475007.json:
```json
{
    "body": "Commit: **[ce79954](https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04)**",
    "created_at": "2020-07-13T21:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475007",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[ce79954](https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04)**



---

archive/issue_events_413238.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-14T00:06:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413238"
}
```



---

archive/issue_comments_475008.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,10 @@\n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n \n-We split it out as a separate distutils package `sage_setup.docbuild`.\n+We split it out as a separate distutils package `sage_setup.docbuild`.  \n \n Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.\n \n+\n+Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.\n+\n``````\n",
    "created_at": "2020-07-14T02:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475008",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,10 @@
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
 
-We split it out as a separate distutils package `sage_setup.docbuild`.
+We split it out as a separate distutils package `sage_setup.docbuild`.  
 
 Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.
 
+
+Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.
+
``````




---

archive/issue_comments_475009.json:
```json
{
    "body": "Changed commit from **[ce79954](https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04)** to **[e6b5f75](https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36)**",
    "created_at": "2020-07-15T18:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475009",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ce79954](https://github.com/sagemath/sagetrac-mirror/commit/ce799549f0335c64a159d273136fc0233cd53e04)** to **[e6b5f75](https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36)**



---

archive/issue_comments_475010.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36\">e6b5f75</a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage_setup/docbuild</code></td></tr></table>\n",
    "created_at": "2020-07-15T18:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475010",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36">e6b5f75</a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage_setup/docbuild</code></td></tr></table>




---

archive/issue_comments_475011.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116\">cbfe485</a></td><td><code>build/pkgs/sage_setup_docbuild: Set version</code></td></tr></table>\n",
    "created_at": "2020-07-15T19:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475011",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116">cbfe485</a></td><td><code>build/pkgs/sage_setup_docbuild: Set version</code></td></tr></table>




---

archive/issue_comments_475012.json:
```json
{
    "body": "Changed commit from **[e6b5f75](https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36)** to **[cbfe485](https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116)**",
    "created_at": "2020-07-15T19:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475012",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e6b5f75](https://github.com/sagemath/sagetrac-mirror/commit/e6b5f7563bf65a38281dc58eaa27b1ba70303d36)** to **[cbfe485](https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116)**



---

archive/issue_comments_475013.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIn the new `spkg-install` file, why\n\n```\n. sage-dist-helpers\n```\nWhy do this at all, and if you're going to do it, why not use `source` instead of `.`, to be consistent with how `sage-spkg` does things?",
    "created_at": "2020-07-20T22:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475013",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

In the new `spkg-install` file, why

```
. sage-dist-helpers
```
Why do this at all, and if you're going to do it, why not use `source` instead of `.`, to be consistent with how `sage-spkg` does things?



---

archive/issue_comments_475014.json:
```json
{
    "body": "Changed commit from **[cbfe485](https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116)** to **[39781d1](https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d)**",
    "created_at": "2020-07-20T22:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475014",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cbfe485](https://github.com/sagemath/sagetrac-mirror/commit/cbfe485a49b26aa10d1539781b38028c61bad116)** to **[39781d1](https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d)**



---

archive/issue_comments_475015.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d\">39781d1</a></td><td><code>build/pkgs/sage_setup_docbuild/spkg-install: Remove useless use of sage-dist-helpers</code></td></tr></table>\n",
    "created_at": "2020-07-20T22:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475015",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d">39781d1</a></td><td><code>build/pkgs/sage_setup_docbuild/spkg-install: Remove useless use of sage-dist-helpers</code></td></tr></table>




---

archive/issue_comments_475016.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks. This was a leftover from when I was using `sdh_pip_install`.",
    "created_at": "2020-07-20T22:38:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475016",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks. This was a leftover from when I was using `sdh_pip_install`.



---

archive/issue_comments_475017.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nCan you please add `sage_setup_docbuild` to `DOC_DEPENDENCIES` in `build/make/Makefile.in`?\n\nEdit: No, sorry, it's already there. I just built Sage and it build `sage_setup_docbuild` at the end, after the documentation. I don't know why.",
    "created_at": "2020-07-21T00:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475017",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Can you please add `sage_setup_docbuild` to `DOC_DEPENDENCIES` in `build/make/Makefile.in`?

Edit: No, sorry, it's already there. I just built Sage and it build `sage_setup_docbuild` at the end, after the documentation. I don't know why.



---

archive/issue_comments_475018.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHm... it's possible that it is always built because its dependency sagelib is always built...",
    "created_at": "2020-07-21T00:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475018",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Hm... it's possible that it is always built because its dependency sagelib is always built...



---

archive/issue_comments_475019.json:
```json
{
    "body": "Changed commit from **[39781d1](https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d)** to **[0237faa](https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1)**",
    "created_at": "2020-08-10T01:19:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475019",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[39781d1](https://github.com/sagemath/sagetrac-mirror/commit/39781d1dc5c13e46d6e302deaac9b9500894347d)** to **[0237faa](https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1)**



---

archive/issue_comments_475020.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcad5184daba6a9d1d347950b3908fc98ec856ce\">fcad518</a></td><td><code>Merge tag '9.2.beta7' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55c3fbc565fd7884f3df9555de83dd326ace276e\">55c3fbc</a></td><td><code>src/sage_setup/clean.py: Fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58\">01b96b0</a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca\">8a19fe2</a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473\">ccc67b0</a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1\">0237faa</a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr></table>\n",
    "created_at": "2020-08-10T01:19:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475020",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcad5184daba6a9d1d347950b3908fc98ec856ce">fcad518</a></td><td><code>Merge tag '9.2.beta7' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55c3fbc565fd7884f3df9555de83dd326ace276e">55c3fbc</a></td><td><code>src/sage_setup/clean.py: Fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58">01b96b0</a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca">8a19fe2</a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473">ccc67b0</a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1">0237faa</a></td><td><code>Merge branch 't/29950/build_sagelib_using_installed_sage_setup' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr></table>




---

archive/issue_comments_475021.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1\">7d1af54</a></td><td><code>build/pkgs/sage_setup_docbuild: Make sagelib an order-only dep</code></td></tr></table>\n",
    "created_at": "2020-08-10T01:21:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475021",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1">7d1af54</a></td><td><code>build/pkgs/sage_setup_docbuild: Make sagelib an order-only dep</code></td></tr></table>




---

archive/issue_comments_475022.json:
```json
{
    "body": "Changed commit from **[0237faa](https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1)** to **[7d1af54](https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1)**",
    "created_at": "2020-08-10T01:21:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475022",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0237faa](https://github.com/sagemath/sagetrac-mirror/commit/0237faaac34ea8a6c70907d73ec4b3b7ce3ee7d1)** to **[7d1af54](https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1)**



---

archive/issue_events_413239.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413239"
}
```



---

archive/issue_events_413240.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413240"
}
```



---

archive/issue_comments_475023.json:
```json
{
    "body": "Changed dependencies from **#29950** to **#29500**",
    "created_at": "2020-09-08T22:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475023",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29950** to **#29500**



---

archive/issue_comments_475024.json:
```json
{
    "body": "Changed commit from **[7d1af54](https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1)** to **[14ab446](https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5)**",
    "created_at": "2020-09-08T22:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475024",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7d1af54](https://github.com/sagemath/sagetrac-mirror/commit/7d1af540838048f4b60318b93e4f8801547730c1)** to **[14ab446](https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5)**



---

archive/issue_comments_475025.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8aa6fd96607c207a0f9563c583978cd50ddc52a7\">8aa6fd9</a></td><td><code>build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d369aabcda2feff14b4f1d14fe824e591d8c5c36\">d369aab</a></td><td><code>build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d435ab90d74d86264d681371034700a8214e6d3\">2d435ab</a></td><td><code>build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55993b6e25560af5e582aed7fcfbb56d317b92fe\">55993b6</a></td><td><code>build/bin/sage-dist-helpers: Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a646747dbf7c823030e1b23419348ff795a0661\">0a64674</a></td><td><code>build/pkgs/gambit/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca586938cbdd91114a10dd3364201c8076412485\">ca58693</a></td><td><code>build/pkgs/pillow/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65773f7b632e0c93b073fdce0e2a0eed14ef495c\">65773f7</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5\">14ab446</a></td><td><code>build/pkgs/sage_setup_docbuild/spkg-install: Install via setup.py bdist_wheel</code></td></tr></table>\n",
    "created_at": "2020-09-08T22:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475025",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8aa6fd96607c207a0f9563c583978cd50ddc52a7">8aa6fd9</a></td><td><code>build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d369aabcda2feff14b4f1d14fe824e591d8c5c36">d369aab</a></td><td><code>build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d435ab90d74d86264d681371034700a8214e6d3">2d435ab</a></td><td><code>build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55993b6e25560af5e582aed7fcfbb56d317b92fe">55993b6</a></td><td><code>build/bin/sage-dist-helpers: Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a646747dbf7c823030e1b23419348ff795a0661">0a64674</a></td><td><code>build/pkgs/gambit/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca586938cbdd91114a10dd3364201c8076412485">ca58693</a></td><td><code>build/pkgs/pillow/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65773f7b632e0c93b073fdce0e2a0eed14ef495c">65773f7</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30010/split_sage_setup_docbuild_out_to_a_separate_package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5">14ab446</a></td><td><code>build/pkgs/sage_setup_docbuild/spkg-install: Install via setup.py bdist_wheel</code></td></tr></table>




---

archive/issue_comments_475026.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI wrote these comments before the most recent change, but I think they are still relevant:\n\nI propose the following change:\n\n```diff\ndiff --git a/build/pkgs/sage_setup_docbuild/dependencies b/build/pkgs/sage_setup_docbuild/dependencies\nindex 20f527f0f1..b21990c270 100644\n--- a/build/pkgs/sage_setup_docbuild/dependencies\n+++ b/build/pkgs/sage_setup_docbuild/dependencies\n@@ -1 +1 @@\n-$(PYTHON) sphinx six | $(PYTHON_TOOLCHAIN) sagelib\n+$(PYTHON) sphinx | $(PYTHON_TOOLCHAIN) sagelib\ndiff --git a/build/pkgs/sage_setup_docbuild/src/requirements.txt b/build/pkgs/sage_setup_docbuild/src/requirements.txt\nindex 2dedc630e9..4e5dd84d0e 100644\n--- a/build/pkgs/sage_setup_docbuild/src/requirements.txt\n+++ b/build/pkgs/sage_setup_docbuild/src/requirements.txt\n@@ -1,3 +1,2 @@\n #sage\n sphinx\n-six\ndiff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py\nindex 032365d6bd..92d19b883e 100644\n--- a/src/sage_setup/docbuild/ext/sage_autodoc.py\n+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py\n@@ -26,8 +26,6 @@ AUTHORS:\n - Kwankyu Lee (2018-12-26): rebase on the latest sphinx.ext.autodoc\n \n \"\"\"\n-from six import PY2, itervalues, text_type, class_types, string_types\n-\n import inspect\n import re\n import sys\n@@ -1176,27 +1174,19 @@ class ClassDocumenter(DocstringSignatureMixin, ModuleLevelDocumenter):\n         if ret:\n             module = getattr(self.object, '__module__', False)\n             name = getattr(self.object, '__name__', False)\n-            if PY2:\n-                if name and module:\n-                    cls = getattr(sys.modules[module], name, None)\n-                    self.doc_as_attr = (self.objpath != name.split('.') and\n-                                        self.object is cls)\n-                else:\n-                    self.doc_as_attr = True\n+            qualname = getattr(self.object, '__qualname__', name)\n+            if qualname and module:\n+                # walk the standard attribute lookup path for this object\n+                qualname_parts = qualname.split('.')\n+                cls = getattr(sys.modules[module], qualname_parts[0], None)\n+                for part in qualname_parts[1:]:\n+                    if cls is None:\n+                        break\n+                    cls = getattr(cls, part, None)\n+                self.doc_as_attr = (self.objpath != qualname_parts and\n+                                    self.object is cls)\n             else:\n-                qualname = getattr(self.object, '__qualname__', name)\n-                if qualname and module:\n-                    # walk the standard attribute lookup path for this object\n-                    qualname_parts = qualname.split('.')\n-                    cls = getattr(sys.modules[module], qualname_parts[0], None)\n-                    for part in qualname_parts[1:]:\n-                        if cls is None:\n-                            break\n-                        cls = getattr(cls, part, None)\n-                    self.doc_as_attr = (self.objpath != qualname_parts and\n-                                        self.object is cls)\n-                else:\n-                    self.doc_as_attr = True\n+                self.doc_as_attr = True\n         return ret\n \n     def format_args(self):\n\n```\n\n- Also, I don't understand the \"tarball\" aspects of this. There is no tarball, is there? So why have `spkg-src`?\n\n- Is it built in `build/pkgs/sage_setup_docbuild/src/`? After building, I see new directories `build` and `sage_setup.docbuild.egg-info` there.\n\n- The installation log file says `package init file 'sage_setup/__init__.py' not found (or not a regular file)`. I assume this is not a big issue, since everything worked after installation.",
    "created_at": "2020-09-08T23:09:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475026",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

I wrote these comments before the most recent change, but I think they are still relevant:

I propose the following change:

```diff
diff --git a/build/pkgs/sage_setup_docbuild/dependencies b/build/pkgs/sage_setup_docbuild/dependencies
index 20f527f0f1..b21990c270 100644
--- a/build/pkgs/sage_setup_docbuild/dependencies
+++ b/build/pkgs/sage_setup_docbuild/dependencies
@@ -1 +1 @@
-$(PYTHON) sphinx six | $(PYTHON_TOOLCHAIN) sagelib
+$(PYTHON) sphinx | $(PYTHON_TOOLCHAIN) sagelib
diff --git a/build/pkgs/sage_setup_docbuild/src/requirements.txt b/build/pkgs/sage_setup_docbuild/src/requirements.txt
index 2dedc630e9..4e5dd84d0e 100644
--- a/build/pkgs/sage_setup_docbuild/src/requirements.txt
+++ b/build/pkgs/sage_setup_docbuild/src/requirements.txt
@@ -1,3 +1,2 @@
 #sage
 sphinx
-six
diff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py
index 032365d6bd..92d19b883e 100644
--- a/src/sage_setup/docbuild/ext/sage_autodoc.py
+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py
@@ -26,8 +26,6 @@ AUTHORS:
 - Kwankyu Lee (2018-12-26): rebase on the latest sphinx.ext.autodoc
 
 """
-from six import PY2, itervalues, text_type, class_types, string_types
-
 import inspect
 import re
 import sys
@@ -1176,27 +1174,19 @@ class ClassDocumenter(DocstringSignatureMixin, ModuleLevelDocumenter):
         if ret:
             module = getattr(self.object, '__module__', False)
             name = getattr(self.object, '__name__', False)
-            if PY2:
-                if name and module:
-                    cls = getattr(sys.modules[module], name, None)
-                    self.doc_as_attr = (self.objpath != name.split('.') and
-                                        self.object is cls)
-                else:
-                    self.doc_as_attr = True
+            qualname = getattr(self.object, '__qualname__', name)
+            if qualname and module:
+                # walk the standard attribute lookup path for this object
+                qualname_parts = qualname.split('.')
+                cls = getattr(sys.modules[module], qualname_parts[0], None)
+                for part in qualname_parts[1:]:
+                    if cls is None:
+                        break
+                    cls = getattr(cls, part, None)
+                self.doc_as_attr = (self.objpath != qualname_parts and
+                                    self.object is cls)
             else:
-                qualname = getattr(self.object, '__qualname__', name)
-                if qualname and module:
-                    # walk the standard attribute lookup path for this object
-                    qualname_parts = qualname.split('.')
-                    cls = getattr(sys.modules[module], qualname_parts[0], None)
-                    for part in qualname_parts[1:]:
-                        if cls is None:
-                            break
-                        cls = getattr(cls, part, None)
-                    self.doc_as_attr = (self.objpath != qualname_parts and
-                                        self.object is cls)
-                else:
-                    self.doc_as_attr = True
+                self.doc_as_attr = True
         return ret
 
     def format_args(self):

```

- Also, I don't understand the "tarball" aspects of this. There is no tarball, is there? So why have `spkg-src`?

- Is it built in `build/pkgs/sage_setup_docbuild/src/`? After building, I see new directories `build` and `sage_setup.docbuild.egg-info` there.

- The installation log file says `package init file 'sage_setup/__init__.py' not found (or not a regular file)`. I assume this is not a big issue, since everything worked after installation.



---

archive/issue_comments_475027.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI agree with these changes; could you push them to the branch please?",
    "created_at": "2020-09-09T00:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475027",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

I agree with these changes; could you push them to the branch please?



---

archive/issue_comments_475028.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@jhpalmieri](#comment:23):\n> - Also, I don't understand the \"tarball\" aspects of this. There is no tarball, is there? So why have `spkg-src`?\n\nThe spkg-src script can build a tarball for the purpose of uploading a source distribution to PyPI.\n\n> - Is it built in `build/pkgs/sage_setup_docbuild/src/`? After building, I see new directories `build` and `sage_setup.docbuild.egg-info` there.\n\nThat's right. \n\nI should probably add a `sage_setup_docbuild-clean` target that deletes them.\n\n> - The installation log file says `package init file 'sage_setup/__init__.py' not found (or not a regular file)`. I assume this is not a big issue, since everything worked after installation.\n\nThis is not an error. `sage_setup` is now a native namespace package - these do not have `__init__.py` files.",
    "created_at": "2020-09-09T00:37:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475028",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@jhpalmieri](#comment:23):
> - Also, I don't understand the "tarball" aspects of this. There is no tarball, is there? So why have `spkg-src`?

The spkg-src script can build a tarball for the purpose of uploading a source distribution to PyPI.

> - Is it built in `build/pkgs/sage_setup_docbuild/src/`? After building, I see new directories `build` and `sage_setup.docbuild.egg-info` there.

That's right. 

I should probably add a `sage_setup_docbuild-clean` target that deletes them.

> - The installation log file says `package init file 'sage_setup/__init__.py' not found (or not a regular file)`. I assume this is not a big issue, since everything worked after installation.

This is not an error. `sage_setup` is now a native namespace package - these do not have `__init__.py` files.



---

archive/issue_comments_475029.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)**",
    "created_at": "2020-09-09T02:32:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475029",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)**



---

archive/issue_comments_475030.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2020-09-09T02:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475030",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_413241.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-09-09T02:34:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413241"
}
```



---

archive/issue_events_413242.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-09-09T02:34:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413242"
}
```



---

archive/issue_comments_475031.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAdding a `sage_setup_docbuild-clean` would be nice, and/or an `spkg-postinst` script \u2014\u00a0can happen either here or on another ticket.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881\">4ad7d7e</a></td><td><code>trac 30010: remove six as a dependency of sage_setup_docbuild</code></td></tr></table>\n",
    "created_at": "2020-09-09T02:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475031",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:27" align="right">comment:27</div>

Adding a `sage_setup_docbuild-clean` would be nice, and/or an `spkg-postinst` script — can happen either here or on another ticket.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881">4ad7d7e</a></td><td><code>trac 30010: remove six as a dependency of sage_setup_docbuild</code></td></tr></table>




---

archive/issue_comments_475032.json:
```json
{
    "body": "Changed commit from **[14ab446](https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5)** to **[4ad7d7e](https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881)**",
    "created_at": "2020-09-09T02:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475032",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[14ab446](https://github.com/sagemath/sagetrac-mirror/commit/14ab446a58821df23bcb2d5c4f441fe4fa876ed5)** to **[4ad7d7e](https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881)**



---

archive/issue_comments_475033.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThank you. I think I'll be doing the cleaning via #29386.",
    "created_at": "2020-09-09T03:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475033",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Thank you. I think I'll be doing the cleaning via #29386.



---

archive/issue_comments_475034.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI'm getting lots of \n\n```\nsage -t --long --warn-long 44.0 --random-seed=0 src/sage_setup/find.py\n**********************************************************************\nFile \"src/sage_setup/find.py\", line 38, in sage_setup.find.read_distribution\nFailed example:\n    from sage_setup.find import read_distribution\nException raised:\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 720, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1145, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage_setup.find.read_distribution[1]>\", line 1, in <module>\n        from sage_setup.find import read_distribution\n    ModuleNotFoundError: No module named 'sage_setup.find'\n**********************************************************************\n```\nAre incremental builds supported?",
    "created_at": "2020-09-27T18:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475034",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>

I'm getting lots of 

```
sage -t --long --warn-long 44.0 --random-seed=0 src/sage_setup/find.py
**********************************************************************
File "src/sage_setup/find.py", line 38, in sage_setup.find.read_distribution
Failed example:
    from sage_setup.find import read_distribution
Exception raised:
    Traceback (most recent call last):
      File "/home/release/Sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 720, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1145, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage_setup.find.read_distribution[1]>", line 1, in <module>
        from sage_setup.find import read_distribution
    ModuleNotFoundError: No module named 'sage_setup.find'
**********************************************************************
```
Are incremental builds supported?



---

archive/issue_events_413243.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-27T18:00:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413243"
}
```



---

archive/issue_events_413244.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-27T18:00:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413244"
}
```



---

archive/issue_comments_475035.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI'll revisit this ticket at the start of the 9.3 series",
    "created_at": "2020-09-27T18:11:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475035",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

I'll revisit this ticket at the start of the 9.3 series



---

archive/issue_events_413245.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T06:39:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413245"
}
```



---

archive/issue_events_413246.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-14T06:39:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413246"
}
```



---

archive/issue_comments_475036.json:
```json
{
    "body": "Changed dependencies from **#29500** to **#28925**",
    "created_at": "2020-11-14T06:39:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475036",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29500** to **#28925**



---

archive/issue_comments_475037.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T17:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475037",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_475038.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,12 @@\n-`sage_setup.docbuild` has very different dependencies:\n+`sage_setup.docbuild` has very different dependencies compared to `sage_setup`:\n \n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n \n-We split it out as a separate distutils package `sage_setup.docbuild`.  \n-\n-Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.\n-\n+We split it out as a separate distutils package `sage_docbuild`.  \n \n Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.\n \n+This is preparation for #29868 (pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf)\n+\n+\n``````\n",
    "created_at": "2021-02-21T18:46:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475038",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,12 @@
-`sage_setup.docbuild` has very different dependencies:
+`sage_setup.docbuild` has very different dependencies compared to `sage_setup`:
 
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
 
-We split it out as a separate distutils package `sage_setup.docbuild`.  
-
-Because some external packages use `sage_setup.docbuild` to build their own documentation, we do not change the package hierarchy. Instead we turn `sage_setup` into a native namespace package.
-
+We split it out as a separate distutils package `sage_docbuild`.  
 
 Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.
 
+This is preparation for #29868 (pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf)
+
+
``````




---

archive/issue_comments_475039.json:
```json
{
    "body": "Changed dependencies from **#28925** to none",
    "created_at": "2021-02-21T18:46:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475039",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#28925** to none



---

archive/issue_events_413247.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-21T18:46:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "title_is": "Split sage_setup.docbuild out to a separate distribution sage_docbuild",
    "title_was": "Split sage_setup.docbuild out to a separate distribution (distutils package)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413247"
}
```



---

archive/issue_comments_475040.json:
```json
{
    "body": "Dependencies: **#31344, #31353**",
    "created_at": "2021-02-21T18:52:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475040",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31344, #31353**



---

archive/issue_comments_475041.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**",
    "created_at": "2021-02-21T19:08:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475041",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**



---

archive/issue_comments_475042.json:
```json
{
    "body": "Changed commit from **[4ad7d7e](https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881)** to **[c76fea5](https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b)**",
    "created_at": "2021-02-21T19:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475042",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4ad7d7e](https://github.com/sagemath/sagetrac-mirror/commit/4ad7d7e15c9d4ff92213e2b52ad4ed8c2fc32881)** to **[c76fea5](https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b)**



---

archive/issue_comments_475043.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b\">c76fea5</a></td><td><code>src/sage/doctest/control.py: When adding sage_setup, add sage_doctest too</code></td></tr></table>\n",
    "created_at": "2021-02-21T19:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475043",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b">c76fea5</a></td><td><code>src/sage/doctest/control.py: When adding sage_setup, add sage_doctest too</code></td></tr></table>




---

archive/issue_comments_475044.json:
```json
{
    "body": "Changed commit from **[c76fea5](https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b)** to **[c262e44](https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b)**",
    "created_at": "2021-02-21T19:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475044",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c76fea5](https://github.com/sagemath/sagetrac-mirror/commit/c76fea5430f83e40c1b3218395829031fb509e7b)** to **[c262e44](https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b)**



---

archive/issue_comments_475045.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b\">c262e44</a></td><td><code>build/pkgs/sage_docbuild/src: Update metadata</code></td></tr></table>\n",
    "created_at": "2021-02-21T19:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475045",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b">c262e44</a></td><td><code>build/pkgs/sage_docbuild/src: Update metadata</code></td></tr></table>




---

archive/issue_events_413248.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-21T19:33:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413248"
}
```



---

archive/issue_events_413249.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-21T19:33:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413249"
}
```



---

archive/issue_events_413250.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-21T19:33:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413250"
}
```



---

archive/issue_events_413251.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-21T19:33:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413251"
}
```



---

archive/issue_comments_475046.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,9 @@\n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n \n-We split it out as a separate distutils package `sage_docbuild`.  \n+We remove the nesting within `sage_setup`, creating a new top-level package `sage_docbuild`.\n+\n+We split it out as a separate pip-installable distribution package `sage_docbuild`.  \n \n Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.\n \n``````\n",
    "created_at": "2021-02-21T19:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475046",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,9 @@
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
 
-We split it out as a separate distutils package `sage_docbuild`.  
+We remove the nesting within `sage_setup`, creating a new top-level package `sage_docbuild`.
+
+We split it out as a separate pip-installable distribution package `sage_docbuild`.  
 
 Using the `spkg-src` script, a pip-installable tarball can be generated, which could be uploaded to PyPI -- for the use by external packages that want to build documentation.
 
``````




---

archive/issue_comments_475047.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52778c3bf8035a174a296dfc92f7145c96447492\">52778c3</a></td><td><code>build/pkgs/sage_docbuild/spkg-install: Use sdh_setup_bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c\">b6abe5e</a></td><td><code>src/sage/docs/conf.py: Use absolute module names for sage_docbuild extensions</code></td></tr></table>\n",
    "created_at": "2021-02-21T19:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475047",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52778c3bf8035a174a296dfc92f7145c96447492">52778c3</a></td><td><code>build/pkgs/sage_docbuild/spkg-install: Use sdh_setup_bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c">b6abe5e</a></td><td><code>src/sage/docs/conf.py: Use absolute module names for sage_docbuild extensions</code></td></tr></table>




---

archive/issue_comments_475048.json:
```json
{
    "body": "Changed commit from **[c262e44](https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b)** to **[b6abe5e](https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c)**",
    "created_at": "2021-02-21T19:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475048",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c262e44](https://github.com/sagemath/sagetrac-mirror/commit/c262e44786dd4b7d4f5147cd81d510873e76c86b)** to **[b6abe5e](https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c)**



---

archive/issue_comments_475049.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-`sage_setup.docbuild` has very different dependencies compared to `sage_setup`:\n+`sage_setup.docbuild`, created in #19127, has very different dependencies compared to `sage_setup`:\n \n It depends on `sagelib` and `sphinx`, \n whereas the rest of `sage_setup` is for building `sagelib`.\n``````\n",
    "created_at": "2021-02-21T23:32:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475049",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-`sage_setup.docbuild` has very different dependencies compared to `sage_setup`:
+`sage_setup.docbuild`, created in #19127, has very different dependencies compared to `sage_setup`:
 
 It depends on `sagelib` and `sphinx`, 
 whereas the rest of `sage_setup` is for building `sagelib`.
``````




---

archive/issue_comments_475050.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nDoctesting fails for me:\n\n```\n./sage -t -p --all --long --logfile=logs/ptestlong.log\nRunning doctests with ID 2021-02-23-09-29-26-45521505.\nGit branch: t/30010/split_sage_setup_docbuild_out_to_a_separate_package\nUsing --optional=build,dochtml,homebrew,pip,sage,sage_spkg\nDoctesting entire Sage library.\nTraceback (most recent call last):\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/src/bin/sage-runtests\", line 182, in <module>\n    err = DC.run()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 1206, in run\n    self.expand_files_into_sources()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 790, in expand_files_into_sources\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 790, in <listcomp>\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/sources.py\", line 527, in __init__\n    raise ValueError(\"unknown file extension %r\"%ext)\nValueError: unknown file extension ''\nmake: *** [ptestlong] Error 1\n```",
    "created_at": "2021-02-23T19:02:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475050",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">comment:43</div>

Doctesting fails for me:

```
./sage -t -p --all --long --logfile=logs/ptestlong.log
Running doctests with ID 2021-02-23-09-29-26-45521505.
Git branch: t/30010/split_sage_setup_docbuild_out_to_a_separate_package
Using --optional=build,dochtml,homebrew,pip,sage,sage_spkg
Doctesting entire Sage library.
Traceback (most recent call last):
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/src/bin/sage-runtests", line 182, in <module>
    err = DC.run()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py", line 1206, in run
    self.expand_files_into_sources()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py", line 790, in expand_files_into_sources
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/control.py", line 790, in <listcomp>
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/sources.py", line 527, in __init__
    raise ValueError("unknown file extension %r"%ext)
ValueError: unknown file extension ''
make: *** [ptestlong] Error 1
```



---

archive/issue_comments_475051.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI think the problem is this:\n\n```diff\ndiff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py\nindex 7d2b84b9c3..eafcf924de 100644\n--- a/src/sage/doctest/control.py\n+++ b/src/sage/doctest/control.py\n@@ -697,6 +697,7 @@ class DocTestController(SageObject):\n             # don't make sense to run outside a build environment\n             if have_git:\n                 self.files.append(opj(SAGE_SRC, 'sage_setup'))\n+                self.files.append(opj(SAGE_SRC, 'sage_doctest'))\n             self.files.append(SAGE_DOC_SRC)\n \n         if self.options.all or (self.options.new and not have_git):\n```\nShould `sage_doctest` be `sage_docbuild` instead?",
    "created_at": "2021-02-23T19:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475051",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

I think the problem is this:

```diff
diff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py
index 7d2b84b9c3..eafcf924de 100644
--- a/src/sage/doctest/control.py
+++ b/src/sage/doctest/control.py
@@ -697,6 +697,7 @@ class DocTestController(SageObject):
             # don't make sense to run outside a build environment
             if have_git:
                 self.files.append(opj(SAGE_SRC, 'sage_setup'))
+                self.files.append(opj(SAGE_SRC, 'sage_doctest'))
             self.files.append(SAGE_DOC_SRC)
 
         if self.options.all or (self.options.new and not have_git):
```
Should `sage_doctest` be `sage_docbuild` instead?



---

archive/issue_comments_475052.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nYes, thanks for catching this! Please push it to the ticket",
    "created_at": "2021-02-23T19:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475052",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

Yes, thanks for catching this! Please push it to the ticket



---

archive/issue_comments_475053.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)**",
    "created_at": "2021-02-23T19:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475053",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)**



---

archive/issue_comments_475054.json:
```json
{
    "body": "Changed commit from **[b6abe5e](https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c)** to **[b42920b](https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239)**",
    "created_at": "2021-02-23T21:10:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475054",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[b6abe5e](https://github.com/sagemath/sagetrac-mirror/commit/b6abe5e15d30a729d24730607ba47331406f244c)** to **[b42920b](https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239)**



---

archive/issue_comments_475055.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThe directory structure looks very strange: inside `SAGE_ROOT/build/pkgs/sage_docbuild/src/` I see\n\n```\nbuild\n  lib\n     build\n        lib\n           build\n              lib\n                 build\n                    lib\n                       sage_docbuild\n                 sage_docbuild\n           sage_docbuild\n     sage_docbuild\n```\nwhere indentations indicate levels of subdirectories. For example, I see `SAGE_ROOT/build/pkgs/sage_docbuild/src/build/lib/build/lib/build/lib/build/lib/sage_docbuild`. All of the `sage_docbuild` directories look identical.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239\">b42920b</a></td><td><code>trac 30010: (typo) change sage_doctest -> sage_docbuild</code></td></tr></table>\n",
    "created_at": "2021-02-23T21:10:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475055",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:47" align="right">comment:47</div>

The directory structure looks very strange: inside `SAGE_ROOT/build/pkgs/sage_docbuild/src/` I see

```
build
  lib
     build
        lib
           build
              lib
                 build
                    lib
                       sage_docbuild
                 sage_docbuild
           sage_docbuild
     sage_docbuild
```
where indentations indicate levels of subdirectories. For example, I see `SAGE_ROOT/build/pkgs/sage_docbuild/src/build/lib/build/lib/build/lib/build/lib/sage_docbuild`. All of the `sage_docbuild` directories look identical.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239">b42920b</a></td><td><code>trac 30010: (typo) change sage_doctest -> sage_docbuild</code></td></tr></table>




---

archive/issue_comments_475056.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**",
    "created_at": "2021-02-23T21:18:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475056",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/split_sage_setup_docbuild_out_to_a_separate_package)** to **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)**



---

archive/issue_comments_475057.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThanks for catching this! This commit should fix it\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4\">0a472f2</a></td><td><code>build/pkgs/sage_docbuild/src/setup.py: Restrict find_namespace_packages to sage_docbuild</code></td></tr></table>\n",
    "created_at": "2021-02-23T21:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475057",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

Thanks for catching this! This commit should fix it

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4">0a472f2</a></td><td><code>build/pkgs/sage_docbuild/src/setup.py: Restrict find_namespace_packages to sage_docbuild</code></td></tr></table>




---

archive/issue_comments_475058.json:
```json
{
    "body": "Changed commit from **[b42920b](https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239)** to **[0a472f2](https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4)**",
    "created_at": "2021-02-23T21:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475058",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[b42920b](https://github.com/sagemath/sagetrac-mirror/commit/b42920b7fed686280aed51c9bf8392565297c239)** to **[0a472f2](https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4)**



---

archive/issue_comments_475059.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nPerhaps for another ticket, but shouldn't `make distclean` clean up build artifacts like those subdirectories of `build/pkgs/PKG/src/`? To test the most recent change, I had to delete the extraneous stuff by hand, or alternatively start with a fresh tarball. Since I'm testing with various branches combined (to allow docbuilding to succeed on my Mac, for example), I would rather not use a fresh tarball in these situations.",
    "created_at": "2021-02-23T22:15:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475059",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:50" align="right">comment:50</div>

Perhaps for another ticket, but shouldn't `make distclean` clean up build artifacts like those subdirectories of `build/pkgs/PKG/src/`? To test the most recent change, I had to delete the extraneous stuff by hand, or alternatively start with a fresh tarball. Since I'm testing with various branches combined (to allow docbuilding to succeed on my Mac, for example), I would rather not use a fresh tarball in these situations.



---

archive/issue_comments_475060.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nYes, a target `sage_docbuild-clean` is definitely missing, I'll add one.",
    "created_at": "2021-02-23T23:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475060",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

Yes, a target `sage_docbuild-clean` is definitely missing, I'll add one.



---

archive/issue_comments_475061.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@jhpalmieri](#comment:50):\n> I would rather not use a fresh tarball in these situations.\n\nWhat works really well for me is `git worktree` - easy to create a new \"distclean\" copy of the branch with this",
    "created_at": "2021-02-23T23:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475061",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@jhpalmieri](#comment:50):
> I would rather not use a fresh tarball in these situations.

What works really well for me is `git worktree` - easy to create a new "distclean" copy of the branch with this



---

archive/issue_comments_475062.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI get this at the start of doctesting:\n\n```\n    ModuleNotFoundError in doctesting framework\n**********************************************************************\nTraceback (most recent call last):\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 2508, in __call__\n    doctests, extras = self._run(runner, options, results)\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 2551, in _run\n    doctests, extras = self.source.create_doctests(sage_namespace)\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/sources.py\", line 733, in create_doctests\n    load(filename, namespace) # errors raised here will be caught in DocTestTask\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/repl/load.py\", line 252, in load\n    exec(code, globals)\n  File \"./clean.py\", line 18, in <module>\nModuleNotFoundError: No module named 'sage_setup.find'\n```\nleading to\n\n```\nsage -t --long --random-seed=0 src/sage_setup/clean.py  # ModuleNotFoundError in doctesting framework\n```\nand then I get other doctest failures:\n\n```\nsage -t --long --random-seed=0 src/sage_setup/find.py  # 6 doctests failed\nsage -t --long --random-seed=0 src/sage_setup/util.py  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage_setup/optional_extension.py  # 2 doctests failed\n```\nThese all have a similar form:\n\n```\n**********************************************************************\nFile \"src/sage_setup/find.py\", line 38, in sage_setup.find.read_distribution\nFailed example:\n    from sage_setup.find import read_distribution\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage_setup.find.read_distribution[1]>\", line 1, in <module>\n        from sage_setup.find import read_distribution\n    ModuleNotFoundError: No module named 'sage_setup.find'\n**********************************************************************\nFile \"src/sage_setup/find.py\", line 92, in sage_setup.find.find_python_sources\nFailed example:\n    from sage_setup.find import find_python_sources\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage_setup.find.find_python_sources[1]>\", line 1, in <module>\n        from sage_setup.find import find_python_sources\n    ModuleNotFoundError: No module named 'sage_setup.find'\n```",
    "created_at": "2021-02-23T23:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475062",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:53" align="right">comment:53</div>

I get this at the start of doctesting:

```
    ModuleNotFoundError in doctesting framework
**********************************************************************
Traceback (most recent call last):
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 2508, in __call__
    doctests, extras = self._run(runner, options, results)
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 2551, in _run
    doctests, extras = self.source.create_doctests(sage_namespace)
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/sources.py", line 733, in create_doctests
    load(filename, namespace) # errors raised here will be caught in DocTestTask
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/repl/load.py", line 252, in load
    exec(code, globals)
  File "./clean.py", line 18, in <module>
ModuleNotFoundError: No module named 'sage_setup.find'
```
leading to

```
sage -t --long --random-seed=0 src/sage_setup/clean.py  # ModuleNotFoundError in doctesting framework
```
and then I get other doctest failures:

```
sage -t --long --random-seed=0 src/sage_setup/find.py  # 6 doctests failed
sage -t --long --random-seed=0 src/sage_setup/util.py  # 2 doctests failed
sage -t --long --random-seed=0 src/sage_setup/optional_extension.py  # 2 doctests failed
```
These all have a similar form:

```
**********************************************************************
File "src/sage_setup/find.py", line 38, in sage_setup.find.read_distribution
Failed example:
    from sage_setup.find import read_distribution
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage_setup.find.read_distribution[1]>", line 1, in <module>
        from sage_setup.find import read_distribution
    ModuleNotFoundError: No module named 'sage_setup.find'
**********************************************************************
File "src/sage_setup/find.py", line 92, in sage_setup.find.find_python_sources
Failed example:
    from sage_setup.find import find_python_sources
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage_setup.find.find_python_sources[1]>", line 1, in <module>
        from sage_setup.find import find_python_sources
    ModuleNotFoundError: No module named 'sage_setup.find'
```



---

archive/issue_comments_475063.json:
```json
{
    "body": "Changed commit from **[0a472f2](https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4)** to **[1dfeb84](https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4)**",
    "created_at": "2021-02-24T01:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475063",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0a472f2](https://github.com/sagemath/sagetrac-mirror/commit/0a472f20758eb2b6e277cdcf59b8db6a58b585b4)** to **[1dfeb84](https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4)**



---

archive/issue_comments_475064.json:
```json
{
    "body": "<div id=\"comment:54\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4\">1dfeb84</a></td><td><code>build/make/Makefile.in (sage_docbuild-clean): New, run it from build-clean</code></td></tr></table>\n",
    "created_at": "2021-02-24T01:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475064",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:54"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4">1dfeb84</a></td><td><code>build/make/Makefile.in (sage_docbuild-clean): New, run it from build-clean</code></td></tr></table>




---

archive/issue_comments_475065.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nI don't know how to reproduce the `ModuleNotFoundError`... could you run `make sagelib-clean sagelib` and test again?",
    "created_at": "2021-02-24T01:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475065",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">comment:55</div>

I don't know how to reproduce the `ModuleNotFoundError`... could you run `make sagelib-clean sagelib` and test again?



---

archive/issue_comments_475066.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@mkoeppe](#comment:55):\n> I don't know how to reproduce the `ModuleNotFoundError`... could you run `make sagelib-clean sagelib` and test again?\n\nI did that and got the same failures. This was with Sage's own Python and #18272. Then I switched to just this branch and used homebrew's Python and got the same errors.",
    "created_at": "2021-02-24T05:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475066",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@mkoeppe](#comment:55):
> I don't know how to reproduce the `ModuleNotFoundError`... could you run `make sagelib-clean sagelib` and test again?

I did that and got the same failures. This was with Sage's own Python and #18272. Then I switched to just this branch and used homebrew's Python and got the same errors.



---

archive/issue_comments_475067.json:
```json
{
    "body": "Changed commit from **[1dfeb84](https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4)** to **[881c4af](https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd)**",
    "created_at": "2021-02-24T06:08:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475067",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1dfeb84](https://github.com/sagemath/sagetrac-mirror/commit/1dfeb84b5e99dbff354f993b3a762b2218ce23d4)** to **[881c4af](https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd)**



---

archive/issue_comments_475068.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd\">881c4af</a></td><td><code>src/sage_setup/__init__.py: Restore</code></td></tr></table>\n",
    "created_at": "2021-02-24T06:08:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475068",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd">881c4af</a></td><td><code>src/sage_setup/__init__.py: Restore</code></td></tr></table>




---

archive/issue_comments_475069.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nThanks for testing - I've found the problem now. As a leftover from the previous version of the branch, `sage_setup` had lost its `__init__.py` file, causing an incomplete installation of it in `site-packages`",
    "created_at": "2021-02-24T06:10:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475069",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

Thanks for testing - I've found the problem now. As a leftover from the previous version of the branch, `sage_setup` had lost its `__init__.py` file, causing an incomplete installation of it in `site-packages`



---

archive/issue_comments_475070.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nNow the `ext` directory is missing from `build/pkgs/sage_docbuild/src/build/lib/sage_docbuild` and similarly for `local/lib/python3.9/site-packages/sage_docbuild`, so the documentation fails to build. It thinks it succeeds \u2014 no error \u2014 but the log file says things like\n\n```\nBuilding ja/a_tour_of_sage.\n\n[a_tour_of] Extension error:\n[a_tour_of] Could not import extension sage_docbuild.ext.inventory_builder (exception: No module named 'sage_docbuild.ext')\nBuild finished. The built documents can be found in /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/share/doc/sage/html/ja/a_tour_of_sage\n```",
    "created_at": "2021-02-24T18:21:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475070",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:59" align="right">comment:59</div>

Now the `ext` directory is missing from `build/pkgs/sage_docbuild/src/build/lib/sage_docbuild` and similarly for `local/lib/python3.9/site-packages/sage_docbuild`, so the documentation fails to build. It thinks it succeeds — no error — but the log file says things like

```
Building ja/a_tour_of_sage.

[a_tour_of] Extension error:
[a_tour_of] Could not import extension sage_docbuild.ext.inventory_builder (exception: No module named 'sage_docbuild.ext')
Build finished. The built documents can be found in /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.beta7/local/share/doc/sage/html/ja/a_tour_of_sage
```



---

archive/issue_comments_475071.json:
```json
{
    "body": "Changed commit from **[881c4af](https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd)** to **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**",
    "created_at": "2021-02-24T18:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475071",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[881c4af](https://github.com/sagemath/sagetrac-mirror/commit/881c4af5246e462c3e5cb8253a13a79209a885cd)** to **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**



---

archive/issue_comments_475072.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4eca937ccecf113fb05563af09f753e461effa95\">4eca937</a></td><td><code>build/pkgs/sage_docbuild/src/setup.{cfg,py}: Use an explicit list of packages, add install_requires</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d\">aaab1d3</a></td><td><code>build/pkgs/sage_docbuild/dependencies: Add dependencies on .py files</code></td></tr></table>\n",
    "created_at": "2021-02-24T18:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475072",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4eca937ccecf113fb05563af09f753e461effa95">4eca937</a></td><td><code>build/pkgs/sage_docbuild/src/setup.{cfg,py}: Use an explicit list of packages, add install_requires</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d">aaab1d3</a></td><td><code>build/pkgs/sage_docbuild/dependencies: Add dependencies on .py files</code></td></tr></table>




---

archive/issue_comments_475073.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nSorry, thanks for your patience with this. I was using `find_namespace_packages` wrong, now I have just replaced it with an explicit list of packages.",
    "created_at": "2021-02-24T18:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475073",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:61" align="right">comment:61</div>

Sorry, thanks for your patience with this. I was using `find_namespace_packages` wrong, now I have just replaced it with an explicit list of packages.



---

archive/issue_comments_475074.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nCan you explain the `dependencies` file? \n\n```\n$(PYTHON) sphinx ../pkgs/sage_docbuild/src/sage_docbuild/*.py ../pkgs/sage_docbuild/src/sage_docbuild/ext/*.py | $(PYTHON_TOOLCHAIN) sagelib\n```\nI don't know what `.../*.py` is supposed to accomplish: how does `make` know what py files are supposed to be there or what to do with those targets?",
    "created_at": "2021-02-25T00:59:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475074",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:62" align="right">comment:62</div>

Can you explain the `dependencies` file? 

```
$(PYTHON) sphinx ../pkgs/sage_docbuild/src/sage_docbuild/*.py ../pkgs/sage_docbuild/src/sage_docbuild/ext/*.py | $(PYTHON_TOOLCHAIN) sagelib
```
I don't know what `.../*.py` is supposed to accomplish: how does `make` know what py files are supposed to be there or what to do with those targets?



---

archive/issue_comments_475075.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThese dependencies point to `$SAGE_SRC/docbuild` (going through the symbolic link at `$SAGE_ROOT/build/pkgs/sage_docbuild/src`). `make` expands the wildcard pattern to the source file names there. When they are newer than the timestamp file `$SAGE_LOCAL/var/lib/sage/installed/sage_docbuild-9.3.beta7`, this triggers a rebuild/reinstallation of the package `sage_docbuild`.",
    "created_at": "2021-02-25T01:33:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475075",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:63" align="right">comment:63</div>

These dependencies point to `$SAGE_SRC/docbuild` (going through the symbolic link at `$SAGE_ROOT/build/pkgs/sage_docbuild/src`). `make` expands the wildcard pattern to the source file names there. When they are newer than the timestamp file `$SAGE_LOCAL/var/lib/sage/installed/sage_docbuild-9.3.beta7`, this triggers a rebuild/reinstallation of the package `sage_docbuild`.



---

archive/issue_events_413252.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-02-25T04:16:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413252"
}
```



---

archive/issue_events_413253.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-02-25T04:16:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413253"
}
```



---

archive/issue_comments_475076.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nOkay, thanks, that makes sense. This is working for me now, both building from scratch and upgrading from #31344.",
    "created_at": "2021-02-25T04:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475076",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:64" align="right">comment:64</div>

Okay, thanks, that makes sense. This is working for me now, both building from scratch and upgrading from #31344.



---

archive/issue_comments_475077.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nThank you!",
    "created_at": "2021-02-25T04:39:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475077",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:65" align="right">comment:65</div>

Thank you!



---

archive/issue_comments_475078.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**",
    "created_at": "2021-03-09T00:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30010#issuecomment-475078",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/split_sage_setup_docbuild_out_to_a_separate_package)** to **[aaab1d3](https://github.com/sagemath/sagetrac-mirror/commit/aaab1d3713d1bd2afb922466a086f8e85849a02d)**



---

archive/issue_events_413254.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-09T00:00:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413254"
}
```



---

archive/issue_events_413255.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "be3cce834056bfebca6bd0224f3ece37bc7a59da",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-03-09T00:00:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30010",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30010#event-413255"
}
```
