# Issue 30604: fix scipy for XCode 12

archive/issues_030367.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @mkoeppe @jhpalmieri\n\nBranch/Commit: **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **John Palmieri**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30604_\n\n",
    "closed_at": "2020-09-23T21:28:07Z",
    "created_at": "2020-09-18T20:08:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix scipy for XCode 12",
    "type": "issue",
    "updated_at": "2020-09-23T21:28:07Z",
    "url": "https://github.com/sagemath/sage/issues/30604",
    "user": "https://github.com/dimpase"
}
```


CC:  @mkoeppe @jhpalmieri

Branch/Commit: **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **John Palmieri**

Author: **Dima Pasechnik**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/30604_





---

archive/issue_events_421933.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-18T20:08:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421933"
}
```



---

archive/issue_events_421934.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-18T20:08:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421934"
}
```



---

archive/issue_events_421935.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-18T20:08:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421935"
}
```



---

archive/issue_events_421936.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-18T20:08:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421936"
}
```



---

archive/issue_comments_488401.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nupstream already have some of these fixes in master, but not all.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd\"><code>711fe05</code></a></td><td><code>missing extern decls and #include statements for scipy on xcode12</code></td></tr></table>\n",
    "created_at": "2020-09-18T20:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488401",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

upstream already have some of these fixes in master, but not all.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd"><code>711fe05</code></a></td><td><code>missing extern decls and #include statements for scipy on xcode12</code></td></tr></table>




---

archive/issue_comments_488402.json:
```json
{
    "body": "Branch: **[u/dimpase/packages/scipy/xcode12fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/scipy/xcode12fix)**",
    "created_at": "2020-09-18T20:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488402",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/packages/scipy/xcode12fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/scipy/xcode12fix)**



---

archive/issue_events_421937.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-18T20:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421937"
}
```



---

archive/issue_comments_488403.json:
```json
{
    "body": "Commit: **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**",
    "created_at": "2020-09-18T20:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488403",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**



---

archive/issue_comments_488404.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nPR for the upstream master branch: https://github.com/scipy/scipy/pull/12864",
    "created_at": "2020-09-18T21:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488404",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

PR for the upstream master branch: https://github.com/scipy/scipy/pull/12864



---

archive/issue_events_421938.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-09-18T21:25:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421938"
}
```



---

archive/issue_events_421939.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-09-18T21:25:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421939"
}
```



---

archive/issue_comments_488405.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe changes look sensible, I don't imagine them causing breakage on other platforms, and `scipy` now builds for me with Xcode 12.",
    "created_at": "2020-09-18T21:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488405",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

The changes look sensible, I don't imagine them causing breakage on other platforms, and `scipy` now builds for me with Xcode 12.



---

archive/issue_comments_488406.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2020-09-18T21:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488406",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_421940.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-19T14:41:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421940"
}
```



---

archive/issue_events_421941.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-19T14:41:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421941"
}
```



---

archive/issue_comments_488407.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2020-09-20T14:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488407",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_488408.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nour PR is accepted upstream.\n\nDo you know if Sage's scipy passed its tests on macOS before ?\nIt does not in this configuration.",
    "created_at": "2020-09-20T14:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488408",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

our PR is accepted upstream.

Do you know if Sage's scipy passed its tests on macOS before ?
It does not in this configuration.



---

archive/issue_comments_488409.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIt seems that [when I checked a year ago](https://groups.google.com/d/msg/sage-devel/abysgIIVGZI/fF7efL9RAwAJ), it did pass its test suite.",
    "created_at": "2020-09-20T16:48:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488409",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

It seems that [when I checked a year ago](https://groups.google.com/d/msg/sage-devel/abysgIIVGZI/fF7efL9RAwAJ), it did pass its test suite.



---

archive/issue_comments_488410.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nActually, sorry, I misunderstood. I don't know if I've ever run scipy's tests: I typically only run tests using the spkg-check files in Sage (via SAGE_CHECK=yes), and scipy doesn't have one of those. So I didn't run its tests a year ago.",
    "created_at": "2020-09-20T17:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488410",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

Actually, sorry, I misunderstood. I don't know if I've ever run scipy's tests: I typically only run tests using the spkg-check files in Sage (via SAGE_CHECK=yes), and scipy doesn't have one of those. So I didn't run its tests a year ago.



---

archive/issue_comments_488411.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOne can fire up Python and do\n\n```\n>>> import scipy\n>>> scipy.test()\n```\nfor a relatively short testsuite.\n(It requires `pytest` installed).",
    "created_at": "2020-09-20T18:24:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488411",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

One can fire up Python and do

```
>>> import scipy
>>> scipy.test()
```
for a relatively short testsuite.
(It requires `pytest` installed).



---

archive/issue_comments_488412.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI don't have any machine with Xcode 11 to test with, unfortunately.",
    "created_at": "2020-09-20T18:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488412",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

I don't have any machine with Xcode 11 to test with, unfortunately.



---

archive/issue_comments_488413.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI also don't have Xcode 11 any more, but my systemwide scipy on Mac and ubuntu both have similar numbers:\n\nUbuntu 20.04:\n\n============================ 25461 passed, 2015 skipped, 10989 deselected, 75 xfailed, 7 xpassed, 10 warnings in 459.37s (0:07:39) =============================\n\nMac 10.15, Xcode 12\n\n============================ 25497 passed, 1980 skipped, 10989 deselected, 75 xfailed, 6 xpassed, 10 warnings in 398.20s (0:06:38) =============================",
    "created_at": "2020-09-20T20:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488413",
    "user": "https://github.com/zlscherr"
}
```

<div id="comment:10" align="right">comment:10</div>

I also don't have Xcode 11 any more, but my systemwide scipy on Mac and ubuntu both have similar numbers:

Ubuntu 20.04:

============================ 25461 passed, 2015 skipped, 10989 deselected, 75 xfailed, 7 xpassed, 10 warnings in 459.37s (0:07:39) =============================

Mac 10.15, Xcode 12

============================ 25497 passed, 1980 skipped, 10989 deselected, 75 xfailed, 6 xpassed, 10 warnings in 398.20s (0:06:38) =============================



---

archive/issue_comments_488414.json:
```json
{
    "body": "Attachment: **[scipy-test-failure.txt](https://github.com/sagemath/sage/files/ticket30604/scipy-test-failure.txt)**\n\nfailure report",
    "created_at": "2020-09-20T20:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488414",
    "user": "https://github.com/DaveWitteMorris"
}
```

Attachment: **[scipy-test-failure.txt](https://github.com/sagemath/sage/files/ticket30604/scipy-test-failure.txt)**

failure report



---

archive/issue_comments_488415.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIn case it's any help: I ran `scipy.test()` inside sage (or, at least, I think that's what I did) and I seemed to get only one failure.  It seems to be in `test_hyperu_around_0` in `test_mpmath.py`. (The failure report from the end of the run is attached as scipy-test-failure.txt.)  This is sage 9.2b12 on Mac OS 10.15.6. I think my XCode version is 11.0.",
    "created_at": "2020-09-20T20:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488415",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:11" align="right">comment:11</div>

In case it's any help: I ran `scipy.test()` inside sage (or, at least, I think that's what I did) and I seemed to get only one failure.  It seems to be in `test_hyperu_around_0` in `test_mpmath.py`. (The failure report from the end of the run is attached as scipy-test-failure.txt.)  This is sage 9.2b12 on Mac OS 10.15.6. I think my XCode version is 11.0.



---

archive/issue_comments_488416.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThat Xcode 12 update raises the question whether the clang-12 - compiled code meant to be compatible with the clang-11 - compiled code, in particular C++ might be an issue.",
    "created_at": "2020-09-20T21:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488416",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

That Xcode 12 update raises the question whether the clang-12 - compiled code meant to be compatible with the clang-11 - compiled code, in particular C++ might be an issue.



---

archive/issue_comments_488417.json:
```json
{
    "body": "Changed branch from **[u/dimpase/packages/scipy/xcode12fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/scipy/xcode12fix)** to **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**",
    "created_at": "2020-09-23T21:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30604#issuecomment-488417",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/packages/scipy/xcode12fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/scipy/xcode12fix)** to **[`711fe05`](https://github.com/sagemath/sagetrac-mirror/commit/711fe05025795e44b84233e065d240859ccae5bd)**



---

archive/issue_events_421942.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-23T21:28:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421942"
}
```



---

archive/issue_events_421943.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d55e6c9835c8f6b42ddc4958152f147a3e54c740",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-09-23T21:28:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30604",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30604#event-421943"
}
```
