# Issue 30604: fix scipy for XCode 12

archive/issues_030367.json:
```json
{
    "body": "\n\nCC:  @mkoeppe @jhpalmieri\n\nBranch/Commit: 711fe05025795e44b84233e065d240859ccae5bd\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: John Palmieri\n\nAuthor: Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30604\n\n",
    "closed_at": "2020-09-23T21:28:07Z",
    "created_at": "2020-09-18T20:08:09Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "fix scipy for XCode 12",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30604",
    "user": "https://github.com/dimpase"
}
```


CC:  @mkoeppe @jhpalmieri

Branch/Commit: 711fe05025795e44b84233e065d240859ccae5bd

Upstream: Fixed upstream, in a later stable release.

Reviewer: John Palmieri

Author: Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30604





---

archive/issue_comments_605139.json:
```json
{
    "body": "<a id='comment:1'></a>upstream already have some of these fixes in master, but not all.\n\n---\nNew commits:",
    "created_at": "2020-09-18T20:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605139",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>upstream already have some of these fixes in master, but not all.

---
New commits:



---

archive/issue_comments_605140.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dimpase/packages/scipy/xcode12fix\"",
    "created_at": "2020-09-18T20:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605140",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "" to "u/dimpase/packages/scipy/xcode12fix"



---

archive/issue_comments_605141.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-18T20:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605141",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_605142.json:
```json
{
    "body": "Changing commit from \"\" to \"711fe05025795e44b84233e065d240859ccae5bd\"",
    "created_at": "2020-09-18T20:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605142",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "711fe05025795e44b84233e065d240859ccae5bd"



---

archive/issue_comments_605143.json:
```json
{
    "body": "<a id='comment:2'></a>PR for the upstream master branch: https://github.com/scipy/scipy/pull/12864",
    "created_at": "2020-09-18T21:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605143",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>PR for the upstream master branch: https://github.com/scipy/scipy/pull/12864



---

archive/issue_comments_605144.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-18T21:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605144",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_605145.json:
```json
{
    "body": "<a id='comment:3'></a>The changes look sensible, I don't imagine them causing breakage on other platforms, and `scipy` now builds for me with Xcode 12.",
    "created_at": "2020-09-18T21:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605145",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>The changes look sensible, I don't imagine them causing breakage on other platforms, and `scipy` now builds for me with Xcode 12.



---

archive/issue_comments_605146.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Palmieri\"",
    "created_at": "2020-09-18T21:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605146",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "John Palmieri"



---

archive/issue_comments_605147.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2020-09-19T14:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605147",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_605148.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2020-09-20T14:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605148",
    "user": "https://github.com/dimpase"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Fixed upstream, in a later stable release."



---

archive/issue_comments_605149.json:
```json
{
    "body": "<a id='comment:5'></a>our PR is accepted upstream.\n\nDo you know if Sage's scipy passed its tests on macOS before ?\nIt does not in this configuration.",
    "created_at": "2020-09-20T14:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605149",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>our PR is accepted upstream.

Do you know if Sage's scipy passed its tests on macOS before ?
It does not in this configuration.



---

archive/issue_comments_605150.json:
```json
{
    "body": "<a id='comment:6'></a>It seems that [when I checked a year ago](https://groups.google.com/d/msg/sage-devel/abysgIIVGZI/fF7efL9RAwAJ), it did pass its test suite.",
    "created_at": "2020-09-20T16:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605150",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>It seems that [when I checked a year ago](https://groups.google.com/d/msg/sage-devel/abysgIIVGZI/fF7efL9RAwAJ), it did pass its test suite.



---

archive/issue_comments_605151.json:
```json
{
    "body": "<a id='comment:7'></a>Actually, sorry, I misunderstood. I don't know if I've ever run scipy's tests: I typically only run tests using the spkg-check files in Sage (via SAGE_CHECK=yes), and scipy doesn't have one of those. So I didn't run its tests a year ago.",
    "created_at": "2020-09-20T17:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605151",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>Actually, sorry, I misunderstood. I don't know if I've ever run scipy's tests: I typically only run tests using the spkg-check files in Sage (via SAGE_CHECK=yes), and scipy doesn't have one of those. So I didn't run its tests a year ago.



---

archive/issue_comments_605152.json:
```json
{
    "body": "<a id='comment:8'></a>One can fire up Python and do\n\n```\n>>> import scipy\n>>> scipy.test()\n```\nfor a relatively short testsuite.\n(It requires `pytest` installed).",
    "created_at": "2020-09-20T18:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605152",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>One can fire up Python and do

```
>>> import scipy
>>> scipy.test()
```
for a relatively short testsuite.
(It requires `pytest` installed).



---

archive/issue_comments_605153.json:
```json
{
    "body": "<a id='comment:9'></a>I don't have any machine with Xcode 11 to test with, unfortunately.",
    "created_at": "2020-09-20T18:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605153",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>I don't have any machine with Xcode 11 to test with, unfortunately.



---

archive/issue_comments_605154.json:
```json
{
    "body": "<a id='comment:10'></a>I also don't have Xcode 11 any more, but my systemwide scipy on Mac and ubuntu both have similar numbers:\n\nUbuntu 20.04:\n\n============================ 25461 passed, 2015 skipped, 10989 deselected, 75 xfailed, 7 xpassed, 10 warnings in 459.37s (0:07:39) =============================\n\nMac 10.15, Xcode 12\n\n============================ 25497 passed, 1980 skipped, 10989 deselected, 75 xfailed, 6 xpassed, 10 warnings in 398.20s (0:06:38) =============================",
    "created_at": "2020-09-20T20:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605154",
    "user": "https://github.com/zlscherr"
}
```

<a id='comment:10'></a>I also don't have Xcode 11 any more, but my systemwide scipy on Mac and ubuntu both have similar numbers:

Ubuntu 20.04:

============================ 25461 passed, 2015 skipped, 10989 deselected, 75 xfailed, 7 xpassed, 10 warnings in 459.37s (0:07:39) =============================

Mac 10.15, Xcode 12

============================ 25497 passed, 1980 skipped, 10989 deselected, 75 xfailed, 6 xpassed, 10 warnings in 398.20s (0:06:38) =============================



---

archive/issue_comments_605155.json:
```json
{
    "body": "Attachment [scipy-test-failure.txt](tarball://root/attachments/some-uuid/ticket30604/scipy-test-failure.txt) by @DaveWitteMorris created at 2020-09-20 20:35:31\n\nfailure report",
    "created_at": "2020-09-20T20:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605155",
    "user": "https://github.com/DaveWitteMorris"
}
```

Attachment [scipy-test-failure.txt](tarball://root/attachments/some-uuid/ticket30604/scipy-test-failure.txt) by @DaveWitteMorris created at 2020-09-20 20:35:31

failure report



---

archive/issue_comments_605156.json:
```json
{
    "body": "<a id='comment:11'></a>In case it's any help: I ran `scipy.test()` inside sage (or, at least, I think that's what I did) and I seemed to get only one failure.  It seems to be in `test_hyperu_around_0` in `test_mpmath.py`. (The failure report from the end of the run is attached as scipy-test-failure.txt.)  This is sage 9.2b12 on Mac OS 10.15.6. I think my XCode version is 11.0.",
    "created_at": "2020-09-20T20:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605156",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:11'></a>In case it's any help: I ran `scipy.test()` inside sage (or, at least, I think that's what I did) and I seemed to get only one failure.  It seems to be in `test_hyperu_around_0` in `test_mpmath.py`. (The failure report from the end of the run is attached as scipy-test-failure.txt.)  This is sage 9.2b12 on Mac OS 10.15.6. I think my XCode version is 11.0.



---

archive/issue_comments_605157.json:
```json
{
    "body": "<a id='comment:12'></a>That Xcode 12 update raises the question whether the clang-12 - compiled code meant to be compatible with the clang-11 - compiled code, in particular C++ might be an issue.",
    "created_at": "2020-09-20T21:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605157",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>That Xcode 12 update raises the question whether the clang-12 - compiled code meant to be compatible with the clang-11 - compiled code, in particular C++ might be an issue.



---

archive/issue_comments_605158.json:
```json
{
    "body": "Changing branch from \"u/dimpase/packages/scipy/xcode12fix\" to \"711fe05025795e44b84233e065d240859ccae5bd\"",
    "created_at": "2020-09-23T21:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605158",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dimpase/packages/scipy/xcode12fix" to "711fe05025795e44b84233e065d240859ccae5bd"



---

archive/issue_comments_605159.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-09-23T21:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30604#issuecomment-605159",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_079586.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-23T21:28:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30604",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30604#event-79586"
}
```
