# Issue 30078: Check for duplicate hyperplanes in arrangements over any base ring

archive/issues_029841.json:
```json
{
    "body": "A hyperplane arrangement is supposed to be checked for duplicate hyperplanes.\nThis works well in `QQ`:\n\n```\nsage: H1.<x,y> = HyperplaneArrangements(base_ring=QQ)\nsage: A = H1([1,1,0],[2,2,0], warn_duplicates=True)\n/usr/local/sagemath/dev/local/lib/python3.7/site-packages/sage/geometry/hyperplane_arrangement/arrangement.py:3352: UserWarning: Input contained 2 hyperplanes, but only 1 are distinct.\n  warn('Input contained {0} hyperplanes, but only {1} are distinct.'.format(n, len(hyperplanes)))\nsage: A\nArrangement <x + 1>\n\nsage: A.n_regions()\n2\n```\n\nIn other base rings, this check can fail, resulting in false statements about the arrangement:\n\n```\nsage: R = QQ[sqrt(2)]\nsage: H2.<x,y> = HyperplaneArrangements(base_ring=R)\nsage: B = H2([1,1,0],[2,2,0], warn_duplicates=True)\nsage: B\nArrangement <x + 1 | 2*x + 2>\n\nsage: B.n_regions()\n3\n```\n\n**CC:**  @jplab\n\n**Keywords:** HyperplaneArrangements\n\n**Branch/Commit:** [b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Julian Ritter\n\nIssue created by migration from https://trac.sagemath.org/ticket/30078\n\n",
    "closed_at": "2022-03-21T23:34:47Z",
    "created_at": "2020-07-06T13:51:08Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "title": "Check for duplicate hyperplanes in arrangements over any base ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/30078",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```
A hyperplane arrangement is supposed to be checked for duplicate hyperplanes.
This works well in `QQ`:

```
sage: H1.<x,y> = HyperplaneArrangements(base_ring=QQ)
sage: A = H1([1,1,0],[2,2,0], warn_duplicates=True)
/usr/local/sagemath/dev/local/lib/python3.7/site-packages/sage/geometry/hyperplane_arrangement/arrangement.py:3352: UserWarning: Input contained 2 hyperplanes, but only 1 are distinct.
  warn('Input contained {0} hyperplanes, but only {1} are distinct.'.format(n, len(hyperplanes)))
sage: A
Arrangement <x + 1>

sage: A.n_regions()
2
```

In other base rings, this check can fail, resulting in false statements about the arrangement:

```
sage: R = QQ[sqrt(2)]
sage: H2.<x,y> = HyperplaneArrangements(base_ring=R)
sage: B = H2([1,1,0],[2,2,0], warn_duplicates=True)
sage: B
Arrangement <x + 1 | 2*x + 2>

sage: B.n_regions()
3
```

**CC:**  @jplab

**Keywords:** HyperplaneArrangements

**Branch/Commit:** [b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)

**Reviewer:** Matthias Koeppe

**Author:** Julian Ritter

Issue created by migration from https://trac.sagemath.org/ticket/30078





---

archive/issue_events_268644.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nailuj",
    "created_at": "2020-07-06T13:57:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268644"
}
```



---

archive/issue_comments_478912.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe error can be tracked down to the `primitive` method for hyperplanes:\nIt is supposed to rescale linear multiples of hyperplane directions to a canonical \"primitive\" one.\nThis is currently not properly implied for every `base_ring`, as it uses `gcd` and `lcm` which for some base rings are just one regardless of the arguments.\n\nFurthermore, the method currently uses `x.denom()` and `x.numer()` instead of `x.denominator()` and `x.numerator()`, two aliases which are only defined for `QQ`.\n\nOne solution would be to normalize the hyperplane equations instead of working with `gcd` and `lcm`. But this gives \"ugly\" equations, contrary to what the `primitive` method is meant to provide.",
    "created_at": "2020-07-06T13:57:28Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478912",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

<a id='comment:1'></a>
The error can be tracked down to the `primitive` method for hyperplanes:
It is supposed to rescale linear multiples of hyperplane directions to a canonical "primitive" one.
This is currently not properly implied for every `base_ring`, as it uses `gcd` and `lcm` which for some base rings are just one regardless of the arguments.

Furthermore, the method currently uses `x.denom()` and `x.numer()` instead of `x.denominator()` and `x.numerator()`, two aliases which are only defined for `QQ`.

One solution would be to normalize the hyperplane equations instead of working with `gcd` and `lcm`. But this gives "ugly" equations, contrary to what the `primitive` method is meant to provide.



---

archive/issue_comments_478913.json:
```json
{
    "body": "**Branch:** [u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring)",
    "created_at": "2020-07-06T14:02:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478913",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

**Branch:** [u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring)



---

archive/issue_comments_478914.json:
```json
{
    "body": "**Commit:** [49db0e34eb135c0ecef7b3b09ee2760ae099d8da](https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da)",
    "created_at": "2020-07-06T19:55:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478914",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [49db0e34eb135c0ecef7b3b09ee2760ae099d8da](https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da)



---

archive/issue_comments_478915.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da\">49db0e3</a></td><td><code>Replace aliases by full method names</code></td></tr></table>\n",
    "created_at": "2020-07-06T19:55:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478915",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da">49db0e3</a></td><td><code>Replace aliases by full method names</code></td></tr></table>




---

archive/issue_events_268645.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268645"
}
```



---

archive/issue_events_268646.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268646"
}
```



---

archive/issue_comments_478916.json:
```json
{
    "body": "<a id='comment:5'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478916",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_268647.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268647"
}
```



---

archive/issue_events_268648.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268648"
}
```



---

archive/issue_events_268649.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268649"
}
```



---

archive/issue_events_268650.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268650"
}
```



---

archive/issue_comments_478917.json:
```json
{
    "body": "<a id='comment:6'></a>\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478917",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_478918.json:
```json
{
    "body": "<a id='comment:7'></a>\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478918",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_268651.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268651"
}
```



---

archive/issue_events_268652.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268652"
}
```



---

archive/issue_comments_478919.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d\">216f6df</a></td><td><code>Change behavior of primitive() for rings other than QQ</code></td></tr></table>\n",
    "created_at": "2022-03-16T17:03:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478919",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d">216f6df</a></td><td><code>Change behavior of primitive() for rings other than QQ</code></td></tr></table>




---

archive/issue_comments_478920.json:
```json
{
    "body": "**Changing commit** from \"[49db0e34eb135c0ecef7b3b09ee2760ae099d8da](https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da)\" to \"[216f6df74100fc78ebf05fd84696d927eb14114d](https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d)\".",
    "created_at": "2022-03-16T17:03:45Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478920",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[49db0e34eb135c0ecef7b3b09ee2760ae099d8da](https://github.com/sagemath/sagetrac-mirror/commit/49db0e34eb135c0ecef7b3b09ee2760ae099d8da)" to "[216f6df74100fc78ebf05fd84696d927eb14114d](https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d)".



---

archive/issue_comments_478921.json:
```json
{
    "body": "**Author:** Julian Ritter",
    "created_at": "2022-03-16T17:19:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478921",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

**Author:** Julian Ritter



---

archive/issue_comments_478922.json:
```json
{
    "body": "<a id='comment:9'></a>\nI kept the existing procedure of `primitive()` for `QQ` (using `numerator`, `denominator`, `gcd` and `lcm`) and introduced a new one for other base rings: The linear expression is scaled such that the first nonzero entry of the normal vector is one or negative one (as before, depending on the original sign and whether the option `signed` is set).\n\nThis seems to be compatible with all examples provided in the classes concerned, pass all the existing doctests in the hyperplane_arrangements folder and solve the problem of this ticket. It should also solve ticket #30749. I included suitable tests in the code.\n\nNote however that this does change the coefficients by which hyperplanes are stored in an arrangement not based on `QQ`. This could break user code whenever it relies on a specific scaling of the linear expression. I would argue that fixing the mathematically incorrect statements yielded by the current implementation outweighs this inconvenience.",
    "created_at": "2022-03-16T17:19:56Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478922",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

<a id='comment:9'></a>
I kept the existing procedure of `primitive()` for `QQ` (using `numerator`, `denominator`, `gcd` and `lcm`) and introduced a new one for other base rings: The linear expression is scaled such that the first nonzero entry of the normal vector is one or negative one (as before, depending on the original sign and whether the option `signed` is set).

This seems to be compatible with all examples provided in the classes concerned, pass all the existing doctests in the hyperplane_arrangements folder and solve the problem of this ticket. It should also solve ticket #30749. I included suitable tests in the code.

Note however that this does change the coefficients by which hyperplanes are stored in an arrangement not based on `QQ`. This could break user code whenever it relies on a specific scaling of the linear expression. I would argue that fixing the mathematically incorrect statements yielded by the current implementation outweighs this inconvenience.



---

archive/issue_events_268653.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nailuj",
    "created_at": "2022-03-16T17:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268653"
}
```



---

archive/issue_events_268654.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nailuj",
    "created_at": "2022-03-16T17:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268654"
}
```



---

archive/issue_comments_478923.json:
```json
{
    "body": "<a id='comment:10'></a>\n\n```\n+        from sage.rings.all import QQ\n```\nPlease use a more specific import, see https://doc.sagemath.org/html/en/developer/packaging_sage_library.html#module-level-runtime-dependencies",
    "created_at": "2022-03-17T16:06:53Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478923",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>

```
+        from sage.rings.all import QQ
```
Please use a more specific import, see https://doc.sagemath.org/html/en/developer/packaging_sage_library.html#module-level-runtime-dependencies



---

archive/issue_comments_478924.json:
```json
{
    "body": "<a id='comment:11'></a>\nLikewise here:\n\n```\n+            from sage.arith.all import lcm, gcd\n```",
    "created_at": "2022-03-17T16:07:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478924",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Likewise here:

```
+            from sage.arith.all import lcm, gcd
```



---

archive/issue_comments_478925.json:
```json
{
    "body": "<a id='comment:12'></a>\nAlso, it would be good if you could rewrite these doctests so that they do not go through `SR`.\n\n```\n+        Check that :trac:`30078` is fixed::\n+\n+            sage: R = QQ[sqrt(2)]\n```",
    "created_at": "2022-03-17T16:10:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478925",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
Also, it would be good if you could rewrite these doctests so that they do not go through `SR`.

```
+        Check that :trac:`30078` is fixed::
+
+            sage: R = QQ[sqrt(2)]
```



---

archive/issue_comments_478926.json:
```json
{
    "body": "<a id='comment:13'></a>\n(This is for modularization purposes, see #32432)",
    "created_at": "2022-03-17T16:11:44Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478926",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
(This is for modularization purposes, see #32432)



---

archive/issue_comments_478927.json:
```json
{
    "body": "<a id='comment:14'></a>\nAlso the list brackets can be omitted here:\n\n```\n+            d = lcm([x.denominator() for x in coeffs])\n+            n = gcd([x.numerator() for x in coeffs])\n```",
    "created_at": "2022-03-17T16:14:07Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478927",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Also the list brackets can be omitted here:

```
+            d = lcm([x.denominator() for x in coeffs])
+            n = gcd([x.numerator() for x in coeffs])
```



---

archive/issue_comments_478928.json:
```json
{
    "body": "<a id='comment:15'></a>\nAlso `./sage -tox -e pycodestyle src/sage/geometry/hyperplane_arrangement/hyperplane.py` complains about style, some of the warnings are on the code changed in the ticket",
    "created_at": "2022-03-17T16:18:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478928",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Also `./sage -tox -e pycodestyle src/sage/geometry/hyperplane_arrangement/hyperplane.py` complains about style, some of the warnings are on the code changed in the ticket



---

archive/issue_events_268655.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-17T16:18:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268655"
}
```



---

archive/issue_events_268656.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-17T16:18:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268656"
}
```



---

archive/issue_comments_478929.json:
```json
{
    "body": "**Changing commit** from \"[216f6df74100fc78ebf05fd84696d927eb14114d](https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d)\" to \"[63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8](https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8)\".",
    "created_at": "2022-03-18T19:04:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[216f6df74100fc78ebf05fd84696d927eb14114d](https://github.com/sagemath/sagetrac-mirror/commit/216f6df74100fc78ebf05fd84696d927eb14114d)" to "[63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8](https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8)".



---

archive/issue_comments_478930.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cecc4b5cf66a7fdcd2a4ebc1c3448dd227078cf5\">cecc4b5</a></td><td><code>More specific imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17786004734368e62f3fdb6f172cfd93442aa6ec\">1778600</a></td><td><code>Simplified doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8\">63a2b4e</a></td><td><code>pycodestyle cleanup</code></td></tr></table>\n",
    "created_at": "2022-03-18T19:04:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cecc4b5cf66a7fdcd2a4ebc1c3448dd227078cf5">cecc4b5</a></td><td><code>More specific imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17786004734368e62f3fdb6f172cfd93442aa6ec">1778600</a></td><td><code>Simplified doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8">63a2b4e</a></td><td><code>pycodestyle cleanup</code></td></tr></table>




---

archive/issue_comments_478931.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac\">bec2e96</a></td><td><code>Limit pycodestyle cleanup to the method modified in this ticket</code></td></tr></table>\n",
    "created_at": "2022-03-18T19:27:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478931",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac">bec2e96</a></td><td><code>Limit pycodestyle cleanup to the method modified in this ticket</code></td></tr></table>




---

archive/issue_comments_478932.json:
```json
{
    "body": "**Changing commit** from \"[63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8](https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8)\" to \"[bec2e96b3547e44518149073b94a1284610355ac](https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac)\".",
    "created_at": "2022-03-18T19:27:31Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8](https://github.com/sagemath/sagetrac-mirror/commit/63a2b4ea5e8ceeb49f3f7ae41a21931545124ed8)" to "[bec2e96b3547e44518149073b94a1284610355ac](https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac)".



---

archive/issue_comments_478933.json:
```json
{
    "body": "<a id='comment:19'></a>\nThanks for the helpful suggestions!\n\n\nReplying to [mkoeppe](#comment%3A12):\n> Also, it would be good if you could rewrite these doctests so that they do not go through `SR`.\n> \n> ```\n> +        Check that :trac:`30078` is fixed::\n> +\n> +            sage: R = QQ[sqrt(2)]\n> ```\n\n\nI am not really sure about what goes through `SR` and what doesn\u2019t. For the tests to be meaningful, the base ring would have to contain some non-rationals. I replaced `QQ[sqrt(2)]` by `AA`. Is that fine?",
    "created_at": "2022-03-18T19:45:37Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478933",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

<a id='comment:19'></a>
Thanks for the helpful suggestions!


Replying to [mkoeppe](#comment%3A12):
> Also, it would be good if you could rewrite these doctests so that they do not go through `SR`.
> 
> ```
> +        Check that :trac:`30078` is fixed::
> +
> +            sage: R = QQ[sqrt(2)]
> ```


I am not really sure about what goes through `SR` and what doesn’t. For the tests to be meaningful, the base ring would have to contain some non-rationals. I replaced `QQ[sqrt(2)]` by `AA`. Is that fine?



---

archive/issue_events_268657.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nailuj",
    "created_at": "2022-03-18T19:45:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268657"
}
```



---

archive/issue_events_268658.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/nailuj",
    "created_at": "2022-03-18T19:45:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268658"
}
```



---

archive/issue_comments_478934.json:
```json
{
    "body": "<a id='comment:20'></a>\n\n```\nsage: ((1+sqrt(5))/2).parent()\nSymbolic Ring\nsage: ((1+AA(5).sqrt())/2).parent()\nAlgebraic Real Field\n```",
    "created_at": "2022-03-18T20:00:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478934",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>

```
sage: ((1+sqrt(5))/2).parent()
Symbolic Ring
sage: ((1+AA(5).sqrt())/2).parent()
Algebraic Real Field
```



---

archive/issue_comments_478935.json:
```json
{
    "body": "<a id='comment:21'></a>\nand instead of `QQ[sqrt(2)]` you can write \n\n```\nsage: QuadraticField(2)\nNumber Field in a with defining polynomial x^2 - 2 with a = 1.414213562373095?\n```",
    "created_at": "2022-03-18T20:03:54Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478935",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
and instead of `QQ[sqrt(2)]` you can write 

```
sage: QuadraticField(2)
Number Field in a with defining polynomial x^2 - 2 with a = 1.414213562373095?
```



---

archive/issue_comments_478936.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1\">c1f4173</a></td><td><code>Avoid computations using Symbolic Ring in doctests</code></td></tr></table>\n",
    "created_at": "2022-03-18T20:19:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1">c1f4173</a></td><td><code>Avoid computations using Symbolic Ring in doctests</code></td></tr></table>




---

archive/issue_comments_478937.json:
```json
{
    "body": "**Changing commit** from \"[bec2e96b3547e44518149073b94a1284610355ac](https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac)\" to \"[c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1](https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1)\".",
    "created_at": "2022-03-18T20:19:46Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bec2e96b3547e44518149073b94a1284610355ac](https://github.com/sagemath/sagetrac-mirror/commit/bec2e96b3547e44518149073b94a1284610355ac)" to "[c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1](https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1)".



---

archive/issue_comments_478938.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [mkoeppe](#comment%3A21):\n> and instead of `QQ[sqrt(2)]` you can write \n> \n> ```\n> sage: QuadraticField(2)\n> Number Field in a with defining polynomial x^2 - 2 with a = 1.414213562373095?\n> ```\n\n\nThanks, I didn\u2019t know that!",
    "created_at": "2022-03-18T20:20:36Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478938",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

<a id='comment:23'></a>
Replying to [mkoeppe](#comment%3A21):
> and instead of `QQ[sqrt(2)]` you can write 
> 
> ```
> sage: QuadraticField(2)
> Number Field in a with defining polynomial x^2 - 2 with a = 1.414213562373095?
> ```


Thanks, I didn’t know that!



---

archive/issue_comments_478939.json:
```json
{
    "body": "<a id='comment:24'></a>\n\n```\n+            sage: R = QuadraticField(2)\n+            sage: H.<x,y> = HyperplaneArrangements(base_ring=R)\n+            sage: B = H([1,1,0], [2,2,0], [sqrt(2),sqrt(2),0])\n```\nMake that `R.<sqrt2> = QuadraticField(2)` and use `sqrt2` instead of `sqrt(2)`",
    "created_at": "2022-03-18T20:40:08Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478939",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>

```
+            sage: R = QuadraticField(2)
+            sage: H.<x,y> = HyperplaneArrangements(base_ring=R)
+            sage: B = H([1,1,0], [2,2,0], [sqrt(2),sqrt(2),0])
```
Make that `R.<sqrt2> = QuadraticField(2)` and use `sqrt2` instead of `sqrt(2)`



---

archive/issue_comments_478940.json:
```json
{
    "body": "**Changing commit** from \"[c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1](https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1)\" to \"[b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)\".",
    "created_at": "2022-03-18T20:49:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1](https://github.com/sagemath/sagetrac-mirror/commit/c1f4173bf8dcfdd7e1b9bb899f58f38ef8e54db1)" to "[b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)".



---

archive/issue_comments_478941.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d\">b7f7a7f</a></td><td><code>Correct variable name in quadratic field</code></td></tr></table>\n",
    "created_at": "2022-03-18T20:49:21Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d">b7f7a7f</a></td><td><code>Correct variable name in quadratic field</code></td></tr></table>




---

archive/issue_comments_478942.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [mkoeppe](#comment%3A24):\n> \n> ```\n> +            sage: R = QuadraticField(2)\n> +            sage: H.<x,y> = HyperplaneArrangements(base_ring=R)\n> +            sage: B = H([1,1,0], [2,2,0], [sqrt(2),sqrt(2),0])\n> ```\n> Make that `R.<sqrt2> = QuadraticField(2)` and use `sqrt2` instead of `sqrt(2)`\n\n\nOh, I see. When sqrt(2) is used, it will initially be a symbolic expression and turned into an element of `R` later, which can be avoided by explicitly using the element of the quadratic field, correct?",
    "created_at": "2022-03-18T20:56:49Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478942",
    "user": "https://trac.sagemath.org/admin/accounts/users/nailuj"
}
```

<a id='comment:26'></a>
Replying to [mkoeppe](#comment%3A24):
> 
> ```
> +            sage: R = QuadraticField(2)
> +            sage: H.<x,y> = HyperplaneArrangements(base_ring=R)
> +            sage: B = H([1,1,0], [2,2,0], [sqrt(2),sqrt(2),0])
> ```
> Make that `R.<sqrt2> = QuadraticField(2)` and use `sqrt2` instead of `sqrt(2)`


Oh, I see. When sqrt(2) is used, it will initially be a symbolic expression and turned into an element of `R` later, which can be avoided by explicitly using the element of the quadratic field, correct?



---

archive/issue_comments_478943.json:
```json
{
    "body": "<a id='comment:27'></a>\nThat's right.",
    "created_at": "2022-03-18T20:58:08Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478943",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
That's right.



---

archive/issue_comments_478944.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2022-03-18T22:25:26Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478944",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_events_268659.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T22:25:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268659"
}
```



---

archive/issue_events_268660.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-18T22:25:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268660"
}
```



---

archive/issue_comments_478945.json:
```json
{
    "body": "**Changing branch** from \"[u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring)\" to \"[b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)\".",
    "created_at": "2022-03-21T23:34:47Z",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30078#issuecomment-478945",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/check_for_duplicate_hyperplanes_in_arrangements_over_any_base_ring)" to "[b7f7a7f44f71ff49e0551b76db5d01d44d500d2d](https://github.com/sagemath/sagetrac-mirror/commit/b7f7a7f44f71ff49e0551b76db5d01d44d500d2d)".



---

archive/issue_events_268661.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-21T23:34:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268661"
}
```



---

archive/issue_events_268662.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d79b00d98a2dab18501ae484ab33cc6d513c47de",
    "created_at": "2022-03-21T23:34:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30078",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30078#event-268662"
}
```
