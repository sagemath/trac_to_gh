# Issue 30578: Add src/requirements.txt for installation of sagelib in a venv

archive/issues_030341.json:
```json
{
    "body": "After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n\nIn this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n\nA virtual environment using it can be created and doctested using:\n\n```\n./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n```\n(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n\nRelated:\n- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n- #28752 Make sagelib pip-installable in a conda environment\n\nFollow-up tickets:\n- #30371 In-place (editable) installs of sagelib in a venv\n- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n \n\nCC:  @tobiasdiez @kiwifb @jhpalmieri @videlec\n\nKeywords: sd111\n\nBranch: u/mkoeppe/add-src-requirements-txt\n\nDependencies: #30527, #30013\n\nCommit: 9ad6b36a3523c3d04f66a62662d09d5e8dfa5142\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/30578\n\n",
    "closed_at": "2021-07-29T19:13:51Z",
    "created_at": "2020-09-15T20:20:49Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Add src/requirements.txt for installation of sagelib in a venv",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30578",
    "user": "https://github.com/mkoeppe"
}
```
After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  

In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)

A virtual environment using it can be created and doctested using:

```
./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
```
(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)

Related:
- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
- #28752 Make sagelib pip-installable in a conda environment

Follow-up tickets:
- #30371 In-place (editable) installs of sagelib in a venv
- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
 

CC:  @tobiasdiez @kiwifb @jhpalmieri @videlec

Keywords: sd111

Branch: u/mkoeppe/add-src-requirements-txt

Dependencies: #30527, #30013

Commit: 9ad6b36a3523c3d04f66a62662d09d5e8dfa5142

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/30578





---

archive/issue_comments_604499.json:
```json
{
    "body": "Changing dependencies from \"#30527\" to \"#29500, #30527, #22731\"",
    "created_at": "2020-09-15T20:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604499",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30527" to "#29500, #30527, #22731"



---

archive/issue_comments_604500.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n In this ticket, we create `src/requirements.txt` to facilitate this.\n+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n \n We add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n \n``````\n",
    "created_at": "2020-09-15T20:22:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604500",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,7 @@
 After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
 In this ticket, we create `src/requirements.txt` to facilitate this.
+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
 
 We add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
 
``````




---

archive/issue_comments_604501.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/add-src-requirements-txt\"",
    "created_at": "2020-09-15T20:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604501",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/add-src-requirements-txt"



---

archive/issue_comments_604502.json:
```json
{
    "body": "<a id='comment:4'></a>What do you think about generating the requirements.txt file from a pipfile: https://pipenv-fork.readthedocs.io/en/latest/advanced.html#generating-a-requirements-txt? (Maybe as part of this ticket or as #29041)\n\n---\nLast 10 new commits:",
    "created_at": "2020-09-15T20:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604502",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>What do you think about generating the requirements.txt file from a pipfile: https://pipenv-fork.readthedocs.io/en/latest/advanced.html#generating-a-requirements-txt? (Maybe as part of this ticket or as #29041)

---
Last 10 new commits:



---

archive/issue_comments_604503.json:
```json
{
    "body": "Changing commit from \"\" to \"1d88afe7a80236573849fe1fd23590c4443a3382\"",
    "created_at": "2020-09-15T20:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604503",
    "user": "https://github.com/tobiasdiez"
}
```

Changing commit from "" to "1d88afe7a80236573849fe1fd23590c4443a3382"



---

archive/issue_comments_604504.json:
```json
{
    "body": "<a id='comment:5'></a>Yes, I started to play a bit with pipenv, and this looks like a possible route.\n\nI would like to keep that for #29041 though.\n\nOn the present ticket I would only want to do the most rudimentary thing - basically to try out the adjustments that sagelib will need (see #22731).",
    "created_at": "2020-09-15T20:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604504",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Yes, I started to play a bit with pipenv, and this looks like a possible route.

I would like to keep that for #29041 though.

On the present ticket I would only want to do the most rudimentary thing - basically to try out the adjustments that sagelib will need (see #22731).



---

archive/issue_comments_604505.json:
```json
{
    "body": "Changing commit from \"1d88afe7a80236573849fe1fd23590c4443a3382\" to \"ba2a6b94c3782fa044e70384fb7dab906353e96b\"",
    "created_at": "2020-09-15T21:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1d88afe7a80236573849fe1fd23590c4443a3382" to "ba2a6b94c3782fa044e70384fb7dab906353e96b"



---

archive/issue_comments_604506.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-15T21:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604507.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-15T22:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604508.json:
```json
{
    "body": "Changing commit from \"ba2a6b94c3782fa044e70384fb7dab906353e96b\" to \"033a95a9362c31a48e24750f63be5e76254c37a8\"",
    "created_at": "2020-09-15T22:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604508",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ba2a6b94c3782fa044e70384fb7dab906353e96b" to "033a95a9362c31a48e24750f63be5e76254c37a8"



---

archive/issue_comments_604509.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `src/requirements.txt` to facilitate this.\n+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+We add a tox environment to `src/tox.ini`, enabling the command\n+`../sage -sh -c 'tox -e develop'` (with #30410: `../sage -tox -e develop`) for building sagelib in a venv.\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.\n+\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-09-17T02:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604509",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,23 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `src/requirements.txt` to facilitate this.
+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+We add a tox environment to `src/tox.ini`, enabling the command
+`../sage -sh -c 'tox -e develop'` (with #30410: `../sage -tox -e develop`) for building sagelib in a venv.
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.
+
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604510.json:
```json
{
    "body": "Changing commit from \"033a95a9362c31a48e24750f63be5e76254c37a8\" to \"4ed815a432dab3f03f17c792506377f86d2f13e6\"",
    "created_at": "2020-09-17T02:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "033a95a9362c31a48e24750f63be5e76254c37a8" to "4ed815a432dab3f03f17c792506377f86d2f13e6"



---

archive/issue_comments_604511.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-17T02:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604511",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604512.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-21T01:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604512",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604513.json:
```json
{
    "body": "Changing commit from \"4ed815a432dab3f03f17c792506377f86d2f13e6\" to \"85175ab94703854ec80ceae0a32ec6bf08c13d60\"",
    "created_at": "2020-09-21T01:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604513",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4ed815a432dab3f03f17c792506377f86d2f13e6" to "85175ab94703854ec80ceae0a32ec6bf08c13d60"



---

archive/issue_comments_604514.json:
```json
{
    "body": "Changing dependencies from \"#29500, #30527, #22731\" to \"#29500, #30527, #30658, #22731\"",
    "created_at": "2020-09-26T00:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604514",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29500, #30527, #22731" to "#29500, #30527, #30658, #22731"



---

archive/issue_comments_604515.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-26T00:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604516.json:
```json
{
    "body": "Changing commit from \"85175ab94703854ec80ceae0a32ec6bf08c13d60\" to \"63490fd5202fd38d7d6540da1e06e580305d0954\"",
    "created_at": "2020-09-26T00:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "85175ab94703854ec80ceae0a32ec6bf08c13d60" to "63490fd5202fd38d7d6540da1e06e580305d0954"



---

archive/issue_comments_604517.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-26T00:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604518.json:
```json
{
    "body": "Changing commit from \"63490fd5202fd38d7d6540da1e06e580305d0954\" to \"4e3a2c3e2f75d6c8b20d11d22e0efd24718baaf6\"",
    "created_at": "2020-09-26T00:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604518",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "63490fd5202fd38d7d6540da1e06e580305d0954" to "4e3a2c3e2f75d6c8b20d11d22e0efd24718baaf6"



---

archive/issue_comments_604519.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-16T21:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604519",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604520.json:
```json
{
    "body": "Changing commit from \"4e3a2c3e2f75d6c8b20d11d22e0efd24718baaf6\" to \"659f723dc36795501ae960c61dce1e9f463c117f\"",
    "created_at": "2020-10-16T21:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604520",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4e3a2c3e2f75d6c8b20d11d22e0efd24718baaf6" to "659f723dc36795501ae960c61dce1e9f463c117f"



---

archive/issue_comments_604521.json:
```json
{
    "body": "Changing work_issues from \"\" to \"rebase on #30779\"",
    "created_at": "2020-10-16T22:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604521",
    "user": "https://github.com/mkoeppe"
}
```

Changing work_issues from "" to "rebase on #30779"



---

archive/issue_comments_604522.json:
```json
{
    "body": "Changing dependencies from \"#29500, #30527, #30658, #22731\" to \"#30527, #22731 | #30779\"",
    "created_at": "2020-10-16T22:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604522",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29500, #30527, #30658, #22731" to "#30527, #22731 | #30779"



---

archive/issue_events_079502.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30578#event-79502"
}
```



---

archive/issue_comments_604523.json:
```json
{
    "body": "Changing work_issues from \"rebase on #30779\" to \"\"",
    "created_at": "2020-11-11T02:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604523",
    "user": "https://github.com/mkoeppe"
}
```

Changing work_issues from "rebase on #30779" to ""



---

archive/issue_comments_604524.json:
```json
{
    "body": "Changing dependencies from \"#30527, #22731 | #30779\" to \"#30527, #22731, #30780\"",
    "created_at": "2020-11-11T02:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604524",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30527, #22731 | #30779" to "#30527, #22731, #30780"



---

archive/issue_comments_604525.json:
```json
{
    "body": "Changing commit from \"659f723dc36795501ae960c61dce1e9f463c117f\" to \"22a92ce79d166fdaab35bf56aae64ebc830a9090\"",
    "created_at": "2020-11-11T02:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "659f723dc36795501ae960c61dce1e9f463c117f" to "22a92ce79d166fdaab35bf56aae64ebc830a9090"



---

archive/issue_comments_604526.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-11-11T02:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_604527.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `src/requirements.txt` to facilitate this.\n+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+We add a tox environment to `src/tox.ini`, enabling the command\n+`../sage -sh -c 'tox -e develop'` (with #30410: `../sage -tox -e develop`) for building sagelib in a venv.  (This requires `sage -i pip2pi` from #30527.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.\n+\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-11T03:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604527",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,23 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `src/requirements.txt` to facilitate this.
+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+We add a tox environment to `src/tox.ini`, enabling the command
+`../sage -sh -c 'tox -e develop'` (with #30410: `../sage -tox -e develop`) for building sagelib in a venv.  (This requires `sage -i pip2pi` from #30527.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.
+
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604528.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-11T03:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604528",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604529.json:
```json
{
    "body": "Changing commit from \"22a92ce79d166fdaab35bf56aae64ebc830a9090\" to \"9e9b41980a6c128689f9a3ff07b118493d60e969\"",
    "created_at": "2020-11-11T03:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "22a92ce79d166fdaab35bf56aae64ebc830a9090" to "9e9b41980a6c128689f9a3ff07b118493d60e969"



---

archive/issue_comments_604530.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `src/requirements.txt` to facilitate this.\n+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+We add a tox environment to `src/tox.ini`, enabling the command\n+`../sage -tox -e develop` for building sagelib in a venv.  (This requires `sage -i pip2pi` from #30527.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.\n+\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-11T03:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604530",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,23 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `src/requirements.txt` to facilitate this.
+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+We add a tox environment to `src/tox.ini`, enabling the command
+`../sage -tox -e develop` for building sagelib in a venv.  (This requires `sage -i pip2pi` from #30527.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+The existing `src/setup.py` is copied into `build/pkgs/sagelib/src`  to replace the symlink. In this way, the changes to `src/setup.py` made in this ticket do not affect the existing build process of the Sage library.
+
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604531.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,25 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> \n+ src/requirements.txt` to facilitate this.\n+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created using:\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+(This requires `sage -i pip2pi` from #30527.)\n+\n+\n+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-11T05:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604531",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,25 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> 
+ src/requirements.txt` to facilitate this.
+(This duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created using:
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+(This requires `sage -i pip2pi` from #30527.)
+
+
+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604532.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,24 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.\n+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created using:\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+(This requires `sage -i pip2pi` from #30527.)\n+\n+\n+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-11T05:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604532",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,24 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.
+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created using:
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+(This requires `sage -i pip2pi` from #30527.)
+
+
+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604533.json:
```json
{
    "body": "Changing dependencies from \"#30527, #22731, #30780\" to \"#30527, #22731, #30780, #30013\"",
    "created_at": "2020-11-11T05:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604533",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30527, #22731, #30780" to "#30527, #22731, #30780, #30013"



---

archive/issue_comments_604534.json:
```json
{
    "body": "Changing commit from \"9e9b41980a6c128689f9a3ff07b118493d60e969\" to \"a4fd2844cb54c0df8252d9e649b6dce88c6c7ddc\"",
    "created_at": "2020-11-11T05:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9e9b41980a6c128689f9a3ff07b118493d60e969" to "a4fd2844cb54c0df8252d9e649b6dce88c6c7ddc"



---

archive/issue_comments_604535.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-11T05:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604536.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.\n+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(This requires `sage -i pip2pi` from #30527.)\n+\n+\n+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-13T06:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604536",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,27 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.
+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(This requires `sage -i pip2pi` from #30527.)
+
+
+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604537.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-11-13T06:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_604538.json:
```json
{
    "body": "Changing commit from \"a4fd2844cb54c0df8252d9e649b6dce88c6c7ddc\" to \"d3f368341972005f50ea31262d38a61af63f59f4\"",
    "created_at": "2020-11-13T06:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a4fd2844cb54c0df8252d9e649b6dce88c6c7ddc" to "d3f368341972005f50ea31262d38a61af63f59f4"



---

archive/issue_comments_604539.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-11-13T06:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604539",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_604540.json:
```json
{
    "body": "<a id='comment:30'></a>Now, with #30013 merged, the correct sage script is executed in the venv created by tox.\n\nWhat remains to be done is to add more packages to requirements.txt - in particular `ipywidgets` so that the doctester can run.",
    "created_at": "2020-11-13T07:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604540",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>Now, with #30013 merged, the correct sage script is executed in the venv created by tox.

What remains to be done is to add more packages to requirements.txt - in particular `ipywidgets` so that the doctester can run.



---

archive/issue_comments_604541.json:
```json
{
    "body": "Changing commit from \"d3f368341972005f50ea31262d38a61af63f59f4\" to \"8c03c6b52aedd82a5254f95660ed3acfbbb9c339\"",
    "created_at": "2020-11-14T01:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604541",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d3f368341972005f50ea31262d38a61af63f59f4" to "8c03c6b52aedd82a5254f95660ed3acfbbb9c339"



---

archive/issue_comments_604542.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-11-14T01:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_604543.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,22 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n+\n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created and doctested using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` - from #30527.)\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n \n \n Dependencies: #30527\n``````\n",
    "created_at": "2020-11-14T01:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604543",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,22 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
+
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created and doctested using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` - from #30527.)
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
 
 
 Dependencies: #30527
``````




---

archive/issue_comments_604544.json:
```json
{
    "body": "Changing commit from \"8c03c6b52aedd82a5254f95660ed3acfbbb9c339\" to \"e2d498f4e7f779b5ac38bda9c69ce89955cacd66\"",
    "created_at": "2020-11-14T02:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604544",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8c03c6b52aedd82a5254f95660ed3acfbbb9c339" to "e2d498f4e7f779b5ac38bda9c69ce89955cacd66"



---

archive/issue_comments_604545.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-14T02:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604545",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_604546.json:
```json
{
    "body": "<a id='comment:34'></a>This works; only minor issues in doctests remain.\n\n```\nFile \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/sage/interfaces/gap_workspace.py\", line 55, in sage.interfaces.gap_workspace.gap_workspace_file\nFailed example:\n    name1 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]\nExpected nothing\nGot:\n    Traceback (most recent call last):\n      File \"<string>\", line 1, in <module>\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/all.py\", line 125, in <module>\n        import sage.misc.lazy_import\n    ModuleNotFoundError: No module named 'sage.misc.lazy_import'\n```\nThere are also some doctest errors in the pexpect interfaces for singular and gap.",
    "created_at": "2020-11-14T02:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604546",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>This works; only minor issues in doctests remain.

```
File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/sage/interfaces/gap_workspace.py", line 55, in sage.interfaces.gap_workspace.gap_workspace_file
Failed example:
    name1 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]
Expected nothing
Got:
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/all.py", line 125, in <module>
        import sage.misc.lazy_import
    ModuleNotFoundError: No module named 'sage.misc.lazy_import'
```
There are also some doctest errors in the pexpect interfaces for singular and gap.



---

archive/issue_comments_604547.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-11-14T02:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604547",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_604548.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.\n+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(This requires `sage -i pip2pi` from #30527.)\n+\n+\n+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)\n+\n+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-14T02:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604548",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,27 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate this.
+(This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(This requires `sage -i pip2pi` from #30527.)
+
+
+(We also add a tox environment `develop` to `src/tox.ini`, enabling the command `../sage -tox -e develop` for building sagelib in a venv - but this needs further work in #30371.)
+
+We also add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604549.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created and doctested using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` - from #30527.)\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+ \n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-14T02:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604549",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,23 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created and doctested using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` - from #30527.)
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+ 
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604550.json:
```json
{
    "body": "<a id='comment:36'></a>The `fpylll` package unfortunately does not install because it does not declare its build dependencies correctly. Reported upstream: https://github.com/fplll/fpylll/issues/185",
    "created_at": "2020-11-14T03:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604550",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>The `fpylll` package unfortunately does not install because it does not declare its build dependencies correctly. Reported upstream: https://github.com/fplll/fpylll/issues/185



---

archive/issue_comments_604551.json:
```json
{
    "body": "Changing commit from \"e2d498f4e7f779b5ac38bda9c69ce89955cacd66\" to \"db148ac28b1b5052c496c55a1c4ec0ee04395dc9\"",
    "created_at": "2020-11-14T03:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604551",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e2d498f4e7f779b5ac38bda9c69ce89955cacd66" to "db148ac28b1b5052c496c55a1c4ec0ee04395dc9"



---

archive/issue_comments_604552.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-14T03:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604553.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-14T04:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_604554.json:
```json
{
    "body": "Changing commit from \"db148ac28b1b5052c496c55a1c4ec0ee04395dc9\" to \"9ad6b36a3523c3d04f66a62662d09d5e8dfa5142\"",
    "created_at": "2020-11-14T04:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604554",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "db148ac28b1b5052c496c55a1c4ec0ee04395dc9" to "9ad6b36a3523c3d04f66a62662d09d5e8dfa5142"



---

archive/issue_comments_604555.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  \n \n+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)\n+\n+A virtual environment using it can be created and doctested using:\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'\n+```\n+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)\n+\n+Related:\n+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment\n+- #28752 Make sagelib pip-installable in a conda environment\n+\n+Follow-up tickets:\n+- #30371 In-place (editable) installs of sagelib in a venv\n+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`\n+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.\n+ \n \n Dependencies: #30527\n \n``````\n",
    "created_at": "2020-11-14T04:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604555",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,23 @@
+After #30527, it is possible to install Python packages built by the Sage distribution into user-defined venvs.  
 
+In this ticket, we create `build/pkgs/sagelib/src/requirements.txt -> src/requirements.txt` to facilitate installing sagelib into such a venv. (This file duplicates some information also available in `build/pkgs`; #29041 will rectify this.)
+
+A virtual environment using it can be created and doctested using:
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v -v)'
+```
+(Reusing wheels built by the Sage distribution requires to do `sage -i pip2pi` first - this is from #30527.)
+
+Related:
+- #28746 Developer's Guide: Add instructions for sagelib development in a conda environment
+- #28752 Make sagelib pip-installable in a conda environment
+
+Follow-up tickets:
+- #30371 In-place (editable) installs of sagelib in a venv
+- #29041 at `./bootstrap` time, generate `requirements.txt`, `constraints.txt`, `setup.cfg [install_requires]`, `Pipfile` from `build/pkgs`
+- add documentation on how to set up the virtual environment, using either plain `python -m venv`, `virtualenv` (20.x), or `pipenv`.
+ 
 
 Dependencies: #30527
 
``````




---

archive/issue_comments_604556.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604556",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_604557.json:
```json
{
    "body": "Changing dependencies from \"#30527, #22731, #30780, #30013\" to \"#30527, #30013\"",
    "created_at": "2020-12-06T21:20:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604557",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30527, #22731, #30780, #30013" to "#30527, #30013"



---

archive/issue_events_079503.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-18T04:46:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30578#event-79503"
}
```



---

archive/issue_events_079504.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-01-18T04:46:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30578#event-79504"
}
```



---

archive/issue_comments_604558.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe\" to \"\"",
    "created_at": "2021-01-18T04:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604558",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Matthias Koeppe" to ""



---

archive/issue_comments_604559.json:
```json
{
    "body": "<a id='comment:43'></a>Let's skip this ticket and do #30913 directly.",
    "created_at": "2021-01-18T04:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604559",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>Let's skip this ticket and do #30913 directly.



---

archive/issue_events_079505.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-07-29T19:13:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30578#event-79505"
}
```



---

archive/issue_comments_604560.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2021-07-29T19:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30578#issuecomment-604560",
    "user": "https://github.com/fchapoton"
}
```

Resolution: duplicate
