# Issue 30281: remove __reduce__ method from Mutability

archive/issues_030044.json:
```json
{
    "assignees": [],
    "body": "The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and even then it must be overloaded manually in most cases anyway.\n\nWe suggest to remove that method from `Mutability`.\n\nCC:  @tscrim @mkoeppe @egourgoulhon\n\nBranch/Commit: **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**\n\nReviewer: **Travis Scrimshaw, Matthias Koeppe**\n\nAuthor: **Michael Jung**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30281_\n\n",
    "closed_at": "2020-08-20T22:23:03Z",
    "created_at": "2020-08-03T16:48:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "remove __reduce__ method from Mutability",
    "type": "issue",
    "updated_at": "2020-08-20T22:23:03Z",
    "url": "https://github.com/sagemath/sage/issues/30281",
    "user": "https://github.com/mjungmath"
}
```
The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and even then it must be overloaded manually in most cases anyway.

We suggest to remove that method from `Mutability`.

CC:  @tscrim @mkoeppe @egourgoulhon

Branch/Commit: **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**

Reviewer: **Travis Scrimshaw, Matthias Koeppe**

Author: **Michael Jung**

_Issue created by migration from https://trac.sagemath.org/ticket/30281_





---

archive/issue_events_385218.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-08-03T16:48:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385218"
}
```



---

archive/issue_events_385219.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-08-03T16:48:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385219"
}
```



---

archive/issue_comments_483348.json:
```json
{
    "body": "Author: **Michael Jung**",
    "created_at": "2020-08-03T16:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483348",
    "user": "https://github.com/mjungmath"
}
```

Author: **Michael Jung**



---

archive/issue_comments_483349.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n+The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and must be overloaded manually in most cases anyway.\n \n+We suggest to remove that method from `Mutability`.\n``````\n",
    "created_at": "2020-08-03T16:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483349",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
+The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and must be overloaded manually in most cases anyway.
 
+We suggest to remove that method from `Mutability`.
``````




---

archive/issue_events_385220.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-08-03T16:53:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385220"
}
```



---

archive/issue_comments_483350.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and must be overloaded manually in most cases anyway.\n+The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and even then it must be overloaded manually in most cases anyway.\n \n We suggest to remove that method from `Mutability`.\n``````\n",
    "created_at": "2020-08-03T16:54:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483350",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and must be overloaded manually in most cases anyway.
+The class `Mutability` used to be a mixin class for mutable objects. However, not every class inheriting from it uses pickling and even then it must be overloaded manually in most cases anyway.
 
 We suggest to remove that method from `Mutability`.
``````




---

archive/issue_comments_483351.json:
```json
{
    "body": "Branch: **[u/gh-mjungmath/remove___reduce___method_from_mutability](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/remove___reduce___method_from_mutability)**",
    "created_at": "2020-08-03T16:59:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483351",
    "user": "https://github.com/mjungmath"
}
```

Branch: **[u/gh-mjungmath/remove___reduce___method_from_mutability](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/remove___reduce___method_from_mutability)**



---

archive/issue_comments_483352.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8\">f0230f0</a></td><td><code>Trac #30281: `__reduce__` method removed</code></td></tr></table>\n",
    "created_at": "2020-08-03T16:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483352",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:4'>Comment 4:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8">f0230f0</a></td><td><code>Trac #30281: `__reduce__` method removed</code></td></tr></table>




---

archive/issue_events_385221.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2020-08-03T16:59:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385221"
}
```



---

archive/issue_comments_483353.json:
```json
{
    "body": "Commit: **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**",
    "created_at": "2020-08-03T16:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483353",
    "user": "https://github.com/mjungmath"
}
```

Commit: **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**



---

archive/issue_comments_483354.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nIs this for a ticket where the existence of this method is a creating a problem?",
    "created_at": "2020-08-03T17:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483354",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>Comment 5:</a>
Is this for a ticket where the existence of this method is a creating a problem?



---

archive/issue_comments_483355.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nYes. See [[comment:10](#comment%3A10)](https://github.com/sagemath/sage/issues/30261#comment:10) in #30261 and all the following by Travis.",
    "created_at": "2020-08-03T17:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483355",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:6'>Comment 6:</a>
Yes. See [[comment:10](#comment%3A10)](https://github.com/sagemath/sage/issues/30261#comment:10) in #30261 and all the following by Travis.



---

archive/issue_comments_483356.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nIt seems that inheriting from `Mutability` causes a pickling test. Probably that is the reason why it is endowed with this method.",
    "created_at": "2020-08-03T18:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483356",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:7'>Comment 7:</a>
It seems that inheriting from `Mutability` causes a pickling test. Probably that is the reason why it is endowed with this method.



---

archive/issue_comments_483357.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nYes. When there is a `__reduce__` method, then it is tested. \nThe correct fix is to implement pickling for your class in #30261.",
    "created_at": "2020-08-03T18:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483357",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>Comment 8:</a>
Yes. When there is a `__reduce__` method, then it is tested. 
The correct fix is to implement pickling for your class in #30261.



---

archive/issue_comments_483358.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@mkoeppe](#comment%3A8):\n> Yes. When there is a `__reduce__` method, then it is tested. \n> The correct fix is to implement pickling for your class in #30261.\n\nThis is exactly the reason why we remove `__reduce__` from `Mutability`. But even then, pickling is tested (see #30280).",
    "created_at": "2020-08-03T19:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483358",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@mkoeppe](#comment%3A8):
> Yes. When there is a `__reduce__` method, then it is tested. 
> The correct fix is to implement pickling for your class in #30261.

This is exactly the reason why we remove `__reduce__` from `Mutability`. But even then, pickling is tested (see #30280).



---

archive/issue_comments_483359.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nThis `__reduce__` method is bad because it it tries to unpickle anything as a `Mutability` object. So a Python class that inherits from this must then contend with this, which puts more of burden on the implementer. Perhaps there is a better way to do this, but it is not immediate to me how to do this...",
    "created_at": "2020-08-04T00:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483359",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
This `__reduce__` method is bad because it it tries to unpickle anything as a `Mutability` object. So a Python class that inherits from this must then contend with this, which puts more of burden on the implementer. Perhaps there is a better way to do this, but it is not immediate to me how to do this...



---

archive/issue_comments_483360.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2020-08-07T22:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483360",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_483361.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI really think this should be removed. However, we need to make sure that when we pickle and unpickle an immutable object `X` it remains immutable.",
    "created_at": "2020-08-07T22:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483361",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'>Comment 11:</a>
I really think this should be removed. However, we need to make sure that when we pickle and unpickle an immutable object `X` it remains immutable.



---

archive/issue_comments_483362.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nFine with me too",
    "created_at": "2020-08-07T22:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483362",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'>Comment 12:</a>
Fine with me too



---

archive/issue_comments_483363.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Matthias Koeppe**",
    "created_at": "2020-08-18T15:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483363",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Matthias Koeppe**



---

archive/issue_events_385222.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-18T15:55:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385222"
}
```



---

archive/issue_events_385223.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-18T15:55:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385223"
}
```



---

archive/issue_events_385224.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-20T22:23:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385224"
}
```



---

archive/issue_events_385225.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "eb2156d1708964e693ccee062d3120dc2d528df0",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-20T22:23:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30281#event-385225"
}
```



---

archive/issue_comments_483364.json:
```json
{
    "body": "Changed branch from **[u/gh-mjungmath/remove___reduce___method_from_mutability](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/remove___reduce___method_from_mutability)** to **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**",
    "created_at": "2020-08-20T22:23:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30281",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30281#issuecomment-483364",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-mjungmath/remove___reduce___method_from_mutability](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/remove___reduce___method_from_mutability)** to **[f0230f0](https://github.com/sagemath/sagetrac-mirror/commit/f0230f0bccfb3ca11db0e77633530ced20ba0ba8)**
