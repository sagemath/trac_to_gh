# Issue 30857: additional compatibility wrappers after #24483

archive/issues_030620.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @videlec @NathanDunfield\n\nBranch: **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Marc Mezzarobba**\n\nComponent: **basic arithmetic**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30857_\n\n",
    "closed_at": "2020-12-13T00:43:27Z",
    "created_at": "2020-11-03T16:24:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "additional compatibility wrappers after #24483",
    "type": "issue",
    "updated_at": "2021-02-15T14:22:07Z",
    "url": "https://github.com/sagemath/sage/issues/30857",
    "user": "https://github.com/mezzarobba"
}
```


CC:  @videlec @NathanDunfield

Branch: **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**

Reviewer: **Vincent Delecroix**

Author: **Marc Mezzarobba**

Component: **basic arithmetic**

_Issue created by migration from https://trac.sagemath.org/ticket/30857_





---

archive/issue_events_427724.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T16:24:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427724"
}
```



---

archive/issue_events_427725.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T16:24:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427725"
}
```



---

archive/issue_events_427726.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T16:24:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427726"
}
```



---

archive/issue_events_427727.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T16:24:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427727"
}
```



---

archive/issue_events_427728.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T17:51:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "title_is": "additional compatibility wrappers after #24483",
    "title_was": "compatibility wrappers after #24483",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427728"
}
```



---

archive/issue_comments_494054.json:
```json
{
    "body": "Branch: **[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)**",
    "created_at": "2020-11-03T17:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494054",
    "user": "https://github.com/mezzarobba"
}
```

Branch: **[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)**



---

archive/issue_events_427729.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T17:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427729"
}
```



---

archive/issue_comments_494055.json:
```json
{
    "body": "Author: **Marc Mezzarobba**",
    "created_at": "2020-11-03T17:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494055",
    "user": "https://github.com/mezzarobba"
}
```

Author: **Marc Mezzarobba**



---

archive/issue_comments_494056.json:
```json
{
    "body": "Commit: **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**",
    "created_at": "2020-11-03T17:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494056",
    "user": "https://github.com/mezzarobba"
}
```

Commit: **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**



---

archive/issue_comments_494057.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI don't know if there is a standard way of keeping deprecated *Cython* interfaces (so that `cimport`ing from the old location still works, that is).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713\"><code>532ad6e</code></a></td><td><code>#30857 additional compatibility wrappers after #24483</code></td></tr></table>\n",
    "created_at": "2020-11-03T17:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494057",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:1" align="right">comment:1</div>

I don't know if there is a standard way of keeping deprecated *Cython* interfaces (so that `cimport`ing from the old location still works, that is).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713"><code>532ad6e</code></a></td><td><code>#30857 additional compatibility wrappers after #24483</code></td></tr></table>




---

archive/issue_events_427730.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T17:51:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427730"
}
```



---

archive/issue_events_427731.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-03T17:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427731"
}
```



---

archive/issue_comments_494058.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n>  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).\n\nI don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:\n\n```\nsage: import snappy\nPlink failed to import tkinter.\ndoctest:warning\n...\nDeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\ndoctest:warning\n```\n\nFurthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?",
    "created_at": "2020-12-01T21:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494058",
    "user": "https://github.com/soehms"
}
```

<div id="comment:3" align="right">comment:3</div>

>  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).

I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:

```
sage: import snappy
Plink failed to import tkinter.
doctest:warning
...
DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
doctest:warning
```

Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?



---

archive/issue_comments_494059.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@soehms](#comment:3):\n> >  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).\n\n> \n> I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:\n> \n> ```\n> sage: import snappy\n> Plink failed to import tkinter.\n> doctest:warning\n> ...\n> DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\n> See http://trac.sagemath.org/24483 for details.\n> doctest:warning\n> ```\n> \n> Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?                                        \n\nEasy: Nathan Dunfield has a trac account!",
    "created_at": "2020-12-02T07:15:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494059",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@soehms](#comment:3):
> >  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).

> 
> I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:
> 
> ```
> sage: import snappy
> Plink failed to import tkinter.
> doctest:warning
> ...
> DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
> See http://trac.sagemath.org/24483 for details.
> doctest:warning
> ```
> 
> Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?                                        

Easy: Nathan Dunfield has a trac account!



---

archive/issue_events_427732.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-12-02T07:17:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427732"
}
```



---

archive/issue_events_427733.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-12-02T07:17:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427733"
}
```



---

archive/issue_comments_494060.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2020-12-02T07:17:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494060",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_494061.json:
```json
{
    "body": "Changed branch from **[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)** to **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**",
    "created_at": "2020-12-13T00:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494061",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)** to **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)**



---

archive/issue_events_427734.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-13T00:43:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427734"
}
```



---

archive/issue_events_427735.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e6d607125e28a7dd132a95c8456dbaecda0257ae",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-12-13T00:43:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30857#event-427735"
}
```



---

archive/issue_comments_494062.json:
```json
{
    "body": "Changed commit from **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)** to none",
    "created_at": "2020-12-14T03:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494062",
    "user": "https://github.com/NathanDunfield"
}
```

Changed commit from **[`532ad6e`](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)** to none



---

archive/issue_comments_494063.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nMarc and Vincent: thanks for the heads up, [we have made](https://github.com/3-manifolds/SnapPy/commit/8a2d42f8665268c3) it so `SnapPy` checks both module locations in such a way that the `DeprecationWarning` should not appear.",
    "created_at": "2020-12-14T03:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494063",
    "user": "https://github.com/NathanDunfield"
}
```

<div id="comment:8" align="right">comment:8</div>

Marc and Vincent: thanks for the heads up, [we have made](https://github.com/3-manifolds/SnapPy/commit/8a2d42f8665268c3) it so `SnapPy` checks both module locations in such a way that the `DeprecationWarning` should not appear.



---

archive/issue_comments_494064.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@NathanDunfield](#comment:8):\n\nNathan,\n\nFYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):\n\n```\nsage: import snappy\nPlink failed to import tkinter.\n/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/snap/shapes.py:4: DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\n  from sage.rings.complex_field import ComplexField\n/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/verify/verifyCanonical.py:6: DeprecationWarning: the complex_number module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\n  from .squareExtensions import find_shapes_as_complex_sqrt_lin_combinations\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-710a7f18823c> in <module>\n----> 1 import snappy\n\n~/devel/sage/local/lib/python3.9/site-packages/snappy/__init__.py in <module>\n      5 #logging.debug('This message should go to the log file')\n      6 import sys\n----> 7 from .SnapPy import (AbelianGroup, HolonomyGroup, FundamentalGroup,\n      8                      DirichletDomain, CuspNeighborhood, SymmetryGroup,\n      9                      AlternatingKnotExteriors, NonalternatingKnotExteriors,\n\ncython/core/fundamental_group.pyx in init SnapPy()\n\ncython/core/fundamental_group.pyx in SnapPy.HolonomyGroup.use_field_conversion()\n\nTypeError: can't set attributes of built-in/extension type 'type'\n```\n\nI suspect this to be caused by the upgrade to Python 3.9.1 (#30589).",
    "created_at": "2021-02-15T08:28:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494064",
    "user": "https://github.com/soehms"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@NathanDunfield](#comment:8):

Nathan,

FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):

```
sage: import snappy
Plink failed to import tkinter.
/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/snap/shapes.py:4: DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
  from sage.rings.complex_field import ComplexField
/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/verify/verifyCanonical.py:6: DeprecationWarning: the complex_number module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
  from .squareExtensions import find_shapes_as_complex_sqrt_lin_combinations
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-710a7f18823c> in <module>
----> 1 import snappy

~/devel/sage/local/lib/python3.9/site-packages/snappy/__init__.py in <module>
      5 #logging.debug('This message should go to the log file')
      6 import sys
----> 7 from .SnapPy import (AbelianGroup, HolonomyGroup, FundamentalGroup,
      8                      DirichletDomain, CuspNeighborhood, SymmetryGroup,
      9                      AlternatingKnotExteriors, NonalternatingKnotExteriors,

cython/core/fundamental_group.pyx in init SnapPy()

cython/core/fundamental_group.pyx in SnapPy.HolonomyGroup.use_field_conversion()

TypeError: can't set attributes of built-in/extension type 'type'
```

I suspect this to be caused by the upgrade to Python 3.9.1 (#30589).



---

archive/issue_comments_494065.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@soehms](#comment:9):\n> FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):\n\nThanks for the heads up.  I believe this fixed in the development version of SnapPy, see https://github.com/3-manifolds/SnapPy/issues/22",
    "created_at": "2021-02-15T14:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30857#issuecomment-494065",
    "user": "https://github.com/NathanDunfield"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@soehms](#comment:9):
> FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):

Thanks for the heads up.  I believe this fixed in the development version of SnapPy, see https://github.com/3-manifolds/SnapPy/issues/22
