# Issue 30857: additional compatibility wrappers after #24483

archive/issues_030620.json:
```json
{
    "body": "\n\n**CC:**  @videlec @NathanDunfield\n\n**Branch:** [532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Marc Mezzarobba\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30857\n\n",
    "closed_at": "2020-12-13T00:43:27Z",
    "created_at": "2020-11-03T16:24:49Z",
    "labels": [
        "component: basic arithmetic",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "additional compatibility wrappers after #24483",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30857",
    "user": "https://github.com/mezzarobba"
}
```


**CC:**  @videlec @NathanDunfield

**Branch:** [532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)

**Reviewer:** Vincent Delecroix

**Author:** Marc Mezzarobba

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/30857





---

archive/issue_events_090733.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "rename": {
        "from": "compatibility wrappers after #24483",
        "to": "additional compatibility wrappers after #24483"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30857#event-90733"
}
```



---

archive/issue_comments_612484.json:
```json
{
    "body": "**Branch:** [u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)",
    "created_at": "2020-11-03T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612484",
    "user": "https://github.com/mezzarobba"
}
```

**Branch:** [u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)



---

archive/issue_comments_612485.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-11-03T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612485",
    "user": "https://github.com/mezzarobba"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_612486.json:
```json
{
    "body": "**Author:** Marc Mezzarobba",
    "created_at": "2020-11-03T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612486",
    "user": "https://github.com/mezzarobba"
}
```

**Author:** Marc Mezzarobba



---

archive/issue_comments_612487.json:
```json
{
    "body": "**Commit:** [532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)",
    "created_at": "2020-11-03T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612487",
    "user": "https://github.com/mezzarobba"
}
```

**Commit:** [532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)



---

archive/issue_comments_612488.json:
```json
{
    "body": "<a id='comment:1'></a>\nI don't know if there is a standard way of keeping deprecated *Cython* interfaces (so that `cimport`ing from the old location still works, that is).\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713\">532ad6e</a></td><td><code>#30857 additional compatibility wrappers after #24483</code></td></tr></table>\n",
    "created_at": "2020-11-03T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612488",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:1'></a>
I don't know if there is a standard way of keeping deprecated *Cython* interfaces (so that `cimport`ing from the old location still works, that is).

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713">532ad6e</a></td><td><code>#30857 additional compatibility wrappers after #24483</code></td></tr></table>




---

archive/issue_comments_612489.json:
```json
{
    "body": "<a id='comment:3'></a>\n>  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).\n\n\nI don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:\n\n```\nsage: import snappy\nPlink failed to import tkinter.\ndoctest:warning\n...\nDeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\ndoctest:warning\n```\n\nFurthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?",
    "created_at": "2020-12-01T21:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612489",
    "user": "https://github.com/soehms"
}
```

<a id='comment:3'></a>
>  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).


I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:

```
sage: import snappy
Plink failed to import tkinter.
doctest:warning
...
DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
doctest:warning
```

Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?



---

archive/issue_comments_612490.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [soehms](#comment%3A3):\n> >  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).\n\n> \n> I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:\n> \n> \n> ```\n> sage: import snappy\n> Plink failed to import tkinter.\n> doctest:warning\n> ...\n> DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\n> See http://trac.sagemath.org/24483 for details.\n> doctest:warning\n> ```\n> \n> Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?                                        \n\n\nEasy: Nathan Dunfield has a trac account!",
    "created_at": "2020-12-02T07:15:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612490",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
Replying to [soehms](#comment%3A3):
> >  I don't know if there is a standard way of keeping deprecated Cython interfaces (so that cimporting from the old location still works, that is).

> 
> I don't know this, either. But anyway, as the ticket does what it should, I think we should let it pass before the next release, since otherwise #24483 could break some external packages completely, for example SnaPy:
> 
> 
> ```
> sage: import snappy
> Plink failed to import tkinter.
> doctest:warning
> ...
> DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
> See http://trac.sagemath.org/24483 for details.
> doctest:warning
> ```
> 
> Furthermore, the maintainers of SnaPy probably want to implement an adaption, to get rid of that warning. Did somebody inform them, already?                                        


Easy: Nathan Dunfield has a trac account!



---

archive/issue_comments_612491.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-12-02T07:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612491",
    "user": "https://github.com/videlec"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_612492.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2020-12-02T07:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612492",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_612493.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2020-12-13T00:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612493",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_612494.json:
```json
{
    "body": "**Changing branch** from \"[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)\" to \"[532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)\".",
    "created_at": "2020-12-13T00:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612494",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mmezzarobba/30857](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/30857)" to "[532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)".



---

archive/issue_events_090734.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-13T00:43:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30857#event-90734"
}
```



---

archive/issue_comments_612495.json:
```json
{
    "body": "**Changing commit** from \"[532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)\" to \"\".",
    "created_at": "2020-12-14T03:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612495",
    "user": "https://github.com/NathanDunfield"
}
```

**Changing commit** from "[532ad6ed0fb3682a9e1a8714415eccbb4a393713](https://github.com/sagemath/sagetrac-mirror/commit/532ad6ed0fb3682a9e1a8714415eccbb4a393713)" to "".



---

archive/issue_comments_612496.json:
```json
{
    "body": "<a id='comment:8'></a>\nMarc and Vincent: thanks for the heads up, [we have made](https://github.com/3-manifolds/SnapPy/commit/8a2d42f8665268c3) it so `SnapPy` checks both module locations in such a way that the `DeprecationWarning` should not appear.",
    "created_at": "2020-12-14T03:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612496",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:8'></a>
Marc and Vincent: thanks for the heads up, [we have made](https://github.com/3-manifolds/SnapPy/commit/8a2d42f8665268c3) it so `SnapPy` checks both module locations in such a way that the `DeprecationWarning` should not appear.



---

archive/issue_comments_612497.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [dunfield](#comment%3A8):\n\nNathan,\n\nFYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):\n\n```\nsage: import snappy\nPlink failed to import tkinter.\n/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/snap/shapes.py:4: DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\n  from sage.rings.complex_field import ComplexField\n/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/verify/verifyCanonical.py:6: DeprecationWarning: the complex_number module is deprecated, please use sage.rings.complex_mpfr\nSee http://trac.sagemath.org/24483 for details.\n  from .squareExtensions import find_shapes_as_complex_sqrt_lin_combinations\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-710a7f18823c> in <module>\n----> 1 import snappy\n\n~/devel/sage/local/lib/python3.9/site-packages/snappy/__init__.py in <module>\n      5 #logging.debug('This message should go to the log file')\n      6 import sys\n----> 7 from .SnapPy import (AbelianGroup, HolonomyGroup, FundamentalGroup,\n      8                      DirichletDomain, CuspNeighborhood, SymmetryGroup,\n      9                      AlternatingKnotExteriors, NonalternatingKnotExteriors,\n\ncython/core/fundamental_group.pyx in init SnapPy()\n\ncython/core/fundamental_group.pyx in SnapPy.HolonomyGroup.use_field_conversion()\n\nTypeError: can't set attributes of built-in/extension type 'type'\n```\n\nI suspect this to be caused by the upgrade to Python 3.9.1 (#30589).",
    "created_at": "2021-02-15T08:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612497",
    "user": "https://github.com/soehms"
}
```

<a id='comment:9'></a>
Replying to [dunfield](#comment%3A8):

Nathan,

FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):

```
sage: import snappy
Plink failed to import tkinter.
/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/snap/shapes.py:4: DeprecationWarning: the complex_field module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
  from sage.rings.complex_field import ComplexField
/home/sebastian/devel/sage/local/lib/python3.9/site-packages/snappy/verify/verifyCanonical.py:6: DeprecationWarning: the complex_number module is deprecated, please use sage.rings.complex_mpfr
See http://trac.sagemath.org/24483 for details.
  from .squareExtensions import find_shapes_as_complex_sqrt_lin_combinations
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-710a7f18823c> in <module>
----> 1 import snappy

~/devel/sage/local/lib/python3.9/site-packages/snappy/__init__.py in <module>
      5 #logging.debug('This message should go to the log file')
      6 import sys
----> 7 from .SnapPy import (AbelianGroup, HolonomyGroup, FundamentalGroup,
      8                      DirichletDomain, CuspNeighborhood, SymmetryGroup,
      9                      AlternatingKnotExteriors, NonalternatingKnotExteriors,

cython/core/fundamental_group.pyx in init SnapPy()

cython/core/fundamental_group.pyx in SnapPy.HolonomyGroup.use_field_conversion()

TypeError: can't set attributes of built-in/extension type 'type'
```

I suspect this to be caused by the upgrade to Python 3.9.1 (#30589).



---

archive/issue_comments_612498.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [soehms](#comment%3A9):\n> FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):\n\n\nThanks for the heads up.  I believe this fixed in the development version of SnapPy, see https://github.com/3-manifolds/SnapPy/issues/22",
    "created_at": "2021-02-15T14:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30857",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30857#issuecomment-612498",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:10'></a>
Replying to [soehms](#comment%3A9):
> FYI: It seems that once again the import of SnapPy inside Sage is broken with the new beta release (observed while working on #30352):


Thanks for the heads up.  I believe this fixed in the development version of SnapPy, see https://github.com/3-manifolds/SnapPy/issues/22
