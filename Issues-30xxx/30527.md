# Issue 30527: Create PEP 503 simple repository for wheels built during installation

archive/issues_030290.json:
```json
{
    "assignees": [],
    "body": "As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):\n\nWe create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n\nWe do this using the command `dir2pi` from https://pypi.org/project/pip2pi/\n\n\nFollow-up:\n- #30578 - Add `src/requirements.txt` for installation of `sagelib` in a venv\n\n---\n\nReferences:\n\n- https://github.com/pytorch/pytorch/issues/25639 \"Implement pep 503 Simple Repository API for deployment\"\n\n- https://pypi.org/project/piprepo/ - create PEP 503 package repo\n\n- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index\n\n- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes\n\n\n\nCC:  @slel @tobiasdiez @embray @jhpalmieri\n\nKeywords: **sd111**\n\nBranch/Commit: **[u/mkoeppe/pep-503-simple-repository-for-wheels](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pep-503-simple-repository-for-wheels) @ [333e50c](https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c)**\n\nReviewer: **Tobias Diez**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30527_\n\n",
    "created_at": "2020-09-08T05:28:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wishlist%20item",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Create PEP 503 simple repository for wheels built during installation",
    "type": "issue",
    "updated_at": "2021-09-30T18:43:54Z",
    "url": "https://github.com/sagemath/sage/issues/30527",
    "user": "https://github.com/mkoeppe"
}
```
As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):

We create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.

We do this using the command `dir2pi` from https://pypi.org/project/pip2pi/


Follow-up:
- #30578 - Add `src/requirements.txt` for installation of `sagelib` in a venv

---

References:

- https://github.com/pytorch/pytorch/issues/25639 "Implement pep 503 Simple Repository API for deployment"

- https://pypi.org/project/piprepo/ - create PEP 503 package repo

- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index

- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes



CC:  @slel @tobiasdiez @embray @jhpalmieri

Keywords: **sd111**

Branch/Commit: **[u/mkoeppe/pep-503-simple-repository-for-wheels](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pep-503-simple-repository-for-wheels) @ [333e50c](https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c)**

Reviewer: **Tobias Diez**

Author: **Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/30527_





---

archive/issue_events_420810.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:28:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420810"
}
```



---

archive/issue_events_420811.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:28:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420811"
}
```



---

archive/issue_events_420812.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:28:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420812"
}
```



---

archive/issue_events_420813.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T05:28:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420813"
}
```



---

archive/issue_comments_486780.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n`piprepo` can be used for this task, but it has excessive dependencies",
    "created_at": "2020-09-08T05:36:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486780",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

`piprepo` can be used for this task, but it has excessive dependencies



---

archive/issue_comments_486781.json:
```json
{
    "body": "Dependencies: **#29500**",
    "created_at": "2020-09-08T06:05:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486781",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29500**



---

archive/issue_comments_486782.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere is also pypiserver, see eg https://stackoverflow.com/a/51528588/873661 for how to use it with pipenv",
    "created_at": "2020-09-08T09:04:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486782",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:3" align="right">comment:3</div>

There is also pypiserver, see eg https://stackoverflow.com/a/51528588/873661 for how to use it with pipenv



---

archive/issue_comments_486783.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWell, we don't want to run a server for this, but following this link I found https://github.com/wolever/pip2pi",
    "created_at": "2020-09-08T17:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486783",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Well, we don't want to run a server for this, but following this link I found https://github.com/wolever/pip2pi



---

archive/issue_comments_486784.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):\n \n-We create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n+We create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n \n ---\n \n``````\n",
    "created_at": "2020-09-08T17:42:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486784",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):
 
-We create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.
+We create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.
 
 ---
 
``````




---

archive/issue_comments_486785.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,10 @@\n As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):\n \n We create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n+\n+We do this using the command `dir2pi` from https://pypi.org/project/pip2pi/\n+\n+\n \n ---\n \n``````\n",
    "created_at": "2020-09-08T18:05:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486785",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,10 @@
 As a follow-up to #29500 (Install all Python packages via `pip wheel`, store wheels in `$SAGE_LOCAL/var/lib/sage/wheels`):
 
 We create a [PEP 503](https://www.python.org/dev/peps/pep-0503/) compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.
+
+We do this using the command `dir2pi` from https://pypi.org/project/pip2pi/
+
+
 
 ---
 
``````




---

archive/issue_comments_486786.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYeah I agree, a server is not required (although the overhead of creating a simple server on listing on localhost should be pretty minimal). If pip2pi works with pipenv and pip, then that's perfect!",
    "created_at": "2020-09-08T19:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486786",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:7" align="right">comment:7</div>

Yeah I agree, a server is not required (although the overhead of creating a simple server on listing on localhost should be pretty minimal). If pip2pi works with pipenv and pip, then that's perfect!



---

archive/issue_comments_486787.json:
```json
{
    "body": "Branch: **[u/mkoeppe/pep-503-simple-repository-for-wheels](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pep-503-simple-repository-for-wheels)**",
    "created_at": "2020-09-08T21:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486787",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/pep-503-simple-repository-for-wheels](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pep-503-simple-repository-for-wheels)**



---

archive/issue_events_420814.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-08T22:57:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420814"
}
```



---

archive/issue_comments_486788.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8aa6fd96607c207a0f9563c583978cd50ddc52a7\">8aa6fd9</a></td><td><code>build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d369aabcda2feff14b4f1d14fe824e591d8c5c36\">d369aab</a></td><td><code>build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d435ab90d74d86264d681371034700a8214e6d3\">2d435ab</a></td><td><code>build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55993b6e25560af5e582aed7fcfbb56d317b92fe\">55993b6</a></td><td><code>build/bin/sage-dist-helpers: Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a646747dbf7c823030e1b23419348ff795a0661\">0a64674</a></td><td><code>build/pkgs/gambit/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca586938cbdd91114a10dd3364201c8076412485\">ca58693</a></td><td><code>build/pkgs/pillow/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/207d80f99b8498b9d34e6dd7cee4f0d3d00e53c5\">207d80f</a></td><td><code>build/pkgs/pip2pi: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe\">2555e19</a></td><td><code>build/make/install: At the end, update the repository index</code></td></tr></table>\n",
    "created_at": "2020-09-08T22:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486788",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8aa6fd96607c207a0f9563c583978cd50ddc52a7">8aa6fd9</a></td><td><code>build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d369aabcda2feff14b4f1d14fe824e591d8c5c36">d369aab</a></td><td><code>build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d435ab90d74d86264d681371034700a8214e6d3">2d435ab</a></td><td><code>build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55993b6e25560af5e582aed7fcfbb56d317b92fe">55993b6</a></td><td><code>build/bin/sage-dist-helpers: Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a646747dbf7c823030e1b23419348ff795a0661">0a64674</a></td><td><code>build/pkgs/gambit/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca586938cbdd91114a10dd3364201c8076412485">ca58693</a></td><td><code>build/pkgs/pillow/spkg-install.in: Install via bdist_wheel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/207d80f99b8498b9d34e6dd7cee4f0d3d00e53c5">207d80f</a></td><td><code>build/pkgs/pip2pi: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe">2555e19</a></td><td><code>build/make/install: At the end, update the repository index</code></td></tr></table>




---

archive/issue_comments_486789.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-09-08T22:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486789",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_486790.json:
```json
{
    "body": "Commit: **[2555e19](https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe)**",
    "created_at": "2020-09-08T22:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486790",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[2555e19](https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe)**



---

archive/issue_comments_486791.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWhat is the reason that sage needs to build wheels for standard packages, and not just downloads them from pypi?\n\nIs it because some packages have patches applied? In this case, I would propose to migrate these patches to proper forks of the packages which are then published to pypi including their wheel. This has a few advantages, mainly that the build of sage is speedup and simplified, and that the wider python community can profit from these patches.\n\nWhat do you think?",
    "created_at": "2020-09-09T07:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486791",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:10" align="right">comment:10</div>

What is the reason that sage needs to build wheels for standard packages, and not just downloads them from pypi?

Is it because some packages have patches applied? In this case, I would propose to migrate these patches to proper forks of the packages which are then published to pypi including their wheel. This has a few advantages, mainly that the build of sage is speedup and simplified, and that the wider python community can profit from these patches.

What do you think?



---

archive/issue_comments_486792.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@tobiasdiez](#comment:10):\n> What is the reason that sage needs to build wheels for standard packages, and not just downloads them from pypi?\n\nSage-the-distribution is a deployment mechanism.  Compiling all packages from source gives us full control and eliminates possible ABI problems from mixing prebuilt wheels that were compiled on different systems. Building from source also has advantages such as generating architecture-specific code (see #27122). \n\n> Is it because some packages have patches applied?\n\nIn some cases, yes, in other cases, just specific configuration.\n\n> In this case, I would propose to migrate these patches to proper forks of the packages which are then published to pypi including their wheel. This has a few advantages, mainly that the build of sage is speedup and simplified, and that the wider python community can profit from these patches.\n\nWe don't have intentions to take over maintenance of these packages. Whenever possible, we send our patches upstream. In many cases, it is just a matter of mismatched release schedules, and we have to keep patches only for a limited time until upstream makes a new stable release including a particular patch. For example, consider the `numpy` patch added in #29766. It is actually from upstream, but not included in any stable release. But we need the patch because we want Sage-the-distribution to support a particular platform.",
    "created_at": "2020-09-09T15:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486792",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@tobiasdiez](#comment:10):
> What is the reason that sage needs to build wheels for standard packages, and not just downloads them from pypi?

Sage-the-distribution is a deployment mechanism.  Compiling all packages from source gives us full control and eliminates possible ABI problems from mixing prebuilt wheels that were compiled on different systems. Building from source also has advantages such as generating architecture-specific code (see #27122). 

> Is it because some packages have patches applied?

In some cases, yes, in other cases, just specific configuration.

> In this case, I would propose to migrate these patches to proper forks of the packages which are then published to pypi including their wheel. This has a few advantages, mainly that the build of sage is speedup and simplified, and that the wider python community can profit from these patches.

We don't have intentions to take over maintenance of these packages. Whenever possible, we send our patches upstream. In many cases, it is just a matter of mismatched release schedules, and we have to keep patches only for a limited time until upstream makes a new stable release including a particular patch. For example, consider the `numpy` patch added in #29766. It is actually from upstream, but not included in any stable release. But we need the patch because we want Sage-the-distribution to support a particular platform.



---

archive/issue_comments_486793.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks for the detailed explanation. Makes things clearer for me now.\n\n> Compiling all packages from source gives us full control and eliminates possible ABI problems from mixing prebuilt wheels that were compiled on different systems. Building from source also has advantages such as generating architecture-specific code\n\nBut isn't the concept of compile-once-reuse-often the main point of wheels? By design, it's the responsibility of the the maintainer (= publisher of the wheel) that the wheel is useable and optimized for the particular platforms they are published. This also make sense since she is the export of the code of the library.\n\nI feel none of the advantages of wheels outlined in https://www.python.org/dev/peps/pep-0427/ can really prove effective if wheels are rebuilt from code every time.\n> The wheel binary package format frees installers from having to know about the build system, saves time by amortizing compile time over many installations, and removes the need to install a build system in the target environment.\n\nIn my opinion, the build process of sage would immensely profit from all these advantages.\n\n\nAnyway, this discussion is somewhat orthogonal to this ticket (sorry!). So concerning the changes, the code looks good to me. I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). However, I don't feel familiar enough with the build script to change the status to positive review.",
    "created_at": "2020-09-09T16:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486793",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks for the detailed explanation. Makes things clearer for me now.

> Compiling all packages from source gives us full control and eliminates possible ABI problems from mixing prebuilt wheels that were compiled on different systems. Building from source also has advantages such as generating architecture-specific code

But isn't the concept of compile-once-reuse-often the main point of wheels? By design, it's the responsibility of the the maintainer (= publisher of the wheel) that the wheel is useable and optimized for the particular platforms they are published. This also make sense since she is the export of the code of the library.

I feel none of the advantages of wheels outlined in https://www.python.org/dev/peps/pep-0427/ can really prove effective if wheels are rebuilt from code every time.
> The wheel binary package format frees installers from having to know about the build system, saves time by amortizing compile time over many installations, and removes the need to install a build system in the target environment.

In my opinion, the build process of sage would immensely profit from all these advantages.


Anyway, this discussion is somewhat orthogonal to this ticket (sorry!). So concerning the changes, the code looks good to me. I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). However, I don't feel familiar enough with the build script to change the status to positive review.



---

archive/issue_comments_486794.json:
```json
{
    "body": "Reviewer: **Tobias Diez,**",
    "created_at": "2020-09-09T16:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486794",
    "user": "https://github.com/tobiasdiez"
}
```

Reviewer: **Tobias Diez,**



---

archive/issue_comments_486795.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@tobiasdiez](#comment:12):\n> But isn't the concept of compile-once-reuse-often the main point of wheels? By design, it's the responsibility of the the maintainer (= publisher of the wheel) that the wheel is useable and optimized for the particular platforms they are published. This also make sense since she is the export of the code of the library.\n\nIn practice, wheels are offered on PyPI with the broadest possible platform compatibility, typically using https://github.com/pypa/manylinux -- this is the opposite of \"optimized\".",
    "created_at": "2020-09-09T16:24:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486795",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@tobiasdiez](#comment:12):
> But isn't the concept of compile-once-reuse-often the main point of wheels? By design, it's the responsibility of the the maintainer (= publisher of the wheel) that the wheel is useable and optimized for the particular platforms they are published. This also make sense since she is the export of the code of the library.

In practice, wheels are offered on PyPI with the broadest possible platform compatibility, typically using https://github.com/pypa/manylinux -- this is the opposite of "optimized".



---

archive/issue_comments_486796.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@tobiasdiez](#comment:12):\n> I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). \n\nYes, this should be removed, but I prefer to keep tickets narrowly focused. A separate ticket can do this.",
    "created_at": "2020-09-09T16:25:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486796",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@tobiasdiez](#comment:12):
> I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). 

Yes, this should be removed, but I prefer to keep tickets narrowly focused. A separate ticket can do this.



---

archive/issue_comments_486797.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tobiasdiez](#comment:12):\n> But isn't the concept of compile-once-reuse-often the main point of wheels? \n\nWheels are a format for deployment. Public distribution of wheels on a package index is one use case. Here on this ticket we use it for local deployment -- users can installs these wheels into their venvs.",
    "created_at": "2020-09-09T16:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486797",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tobiasdiez](#comment:12):
> But isn't the concept of compile-once-reuse-often the main point of wheels? 

Wheels are a format for deployment. Public distribution of wheels on a package index is one use case. Here on this ticket we use it for local deployment -- users can installs these wheels into their venvs.



---

archive/issue_comments_486798.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@tobiasdiez](#comment:12):\n> I feel none of the advantages of wheels outlined in https://www.python.org/dev/peps/pep-0427/ can really prove effective if wheels are rebuilt from code every time. [...]\n> In my opinion, the build process of sage would immensely profit from all these advantages.\n\nI prefer to think about this not as a question of improving \"the\" build process of sage, but to offer more options for building sage. This is for example also the purpose of the modularization plan outlined in #29705 - make modularized parts of the Sage library deployable via PyPI.",
    "created_at": "2020-09-09T16:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486798",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@tobiasdiez](#comment:12):
> I feel none of the advantages of wheels outlined in https://www.python.org/dev/peps/pep-0427/ can really prove effective if wheels are rebuilt from code every time. [...]
> In my opinion, the build process of sage would immensely profit from all these advantages.

I prefer to think about this not as a question of improving "the" build process of sage, but to offer more options for building sage. This is for example also the purpose of the modularization plan outlined in #29705 - make modularized parts of the Sage library deployable via PyPI.



---

archive/issue_comments_486799.json:
```json
{
    "body": "Changed reviewer from **Tobias Diez,** to **Tobias Diez, ...**",
    "created_at": "2020-09-09T16:51:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486799",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Tobias Diez,** to **Tobias Diez, ...**



---

archive/issue_comments_486800.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mkoeppe](#comment:14):\n> Replying to [@tobiasdiez](#comment:12):\n> > I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). \n\n> \n> Yes, this should be removed, but I prefer to keep tickets narrowly focused. A separate ticket can do this.\n\nIt's added in the new file `sage-pip-uninstall`.",
    "created_at": "2020-09-09T16:57:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486800",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mkoeppe](#comment:14):
> Replying to [@tobiasdiez](#comment:12):
> > I'm only wondering if the pip2 support in the uninstallation script is really necessary (since only python3 is supported now). 

> 
> Yes, this should be removed, but I prefer to keep tickets narrowly focused. A separate ticket can do this.

It's added in the new file `sage-pip-uninstall`.



---

archive/issue_comments_486801.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOk, I'll clean it up - but in #29500 (dependency of this ticket)",
    "created_at": "2020-09-09T17:19:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486801",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Ok, I'll clean it up - but in #29500 (dependency of this ticket)



---

archive/issue_comments_486802.json:
```json
{
    "body": "Changed commit from **[2555e19](https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe)** to **[e66243f](https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764)**",
    "created_at": "2020-09-09T17:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486802",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2555e19](https://github.com/sagemath/sagetrac-mirror/commit/2555e19712ee6bc2f9b4edf982b5f86d1bb9a6fe)** to **[e66243f](https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764)**



---

archive/issue_comments_486803.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a747c48eca1be0104c202e4922e5386aa794d08\">5a747c4</a></td><td><code>build/bin/sage-pip-{install,uninstall}: Remove pip2 support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764\">e66243f</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr></table>\n",
    "created_at": "2020-09-09T17:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486803",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a747c48eca1be0104c202e4922e5386aa794d08">5a747c4</a></td><td><code>build/bin/sage-pip-{install,uninstall}: Remove pip2 support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764">e66243f</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr></table>




---

archive/issue_comments_486804.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n We do this using the command `dir2pi` from https://pypi.org/project/pip2pi/\n \n \n+Follow-up:\n+- #30578 - Add `src/requirements.txt` for installation of `sagelib` in a venv\n \n ---\n \n``````\n",
    "created_at": "2020-09-18T05:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486804",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 We do this using the command `dir2pi` from https://pypi.org/project/pip2pi/
 
 
+Follow-up:
+- #30578 - Add `src/requirements.txt` for installation of `sagelib` in a venv
 
 ---
 
``````




---

archive/issue_comments_486805.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ee21109dfb001feec2b032c197defb91cc75783\">9ee2110</a></td><td><code>build/bin/sage-dist-helpers: Also use $sudo for storing the wheel file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7aac84ab4dd86ad6203a99eb82371c1d2a46363\">d7aac84</a></td><td><code>src/doc/en/developer/packaging.rst: Update sdh_... documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b7c7a04d658838ce511e352edb9c03f42c4a7f2\">9b7c7a0</a></td><td><code>build/bin/sage-pip-{install,uninstall}: Fix typo in comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4135e8b236d2e5491b3ee96cbd00196dc5b6e036\">4135e8b</a></td><td><code>build/bin/sage-pip-install: Remove an outdated comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2e707561ab3044221b57151ae4cc67d502fe9f8\">f2e7075</a></td><td><code>Merge tag '9.2.beta13' into t/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60\">5a2491a</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr></table>\n",
    "created_at": "2020-09-21T22:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486805",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ee21109dfb001feec2b032c197defb91cc75783">9ee2110</a></td><td><code>build/bin/sage-dist-helpers: Also use $sudo for storing the wheel file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7aac84ab4dd86ad6203a99eb82371c1d2a46363">d7aac84</a></td><td><code>src/doc/en/developer/packaging.rst: Update sdh_... documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b7c7a04d658838ce511e352edb9c03f42c4a7f2">9b7c7a0</a></td><td><code>build/bin/sage-pip-{install,uninstall}: Fix typo in comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4135e8b236d2e5491b3ee96cbd00196dc5b6e036">4135e8b</a></td><td><code>build/bin/sage-pip-install: Remove an outdated comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2e707561ab3044221b57151ae4cc67d502fe9f8">f2e7075</a></td><td><code>Merge tag '9.2.beta13' into t/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60">5a2491a</a></td><td><code>Merge branch 't/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr></table>




---

archive/issue_comments_486806.json:
```json
{
    "body": "Changed commit from **[e66243f](https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764)** to **[5a2491a](https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60)**",
    "created_at": "2020-09-21T22:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486806",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e66243f](https://github.com/sagemath/sagetrac-mirror/commit/e66243f23a20a6499b0ad33c5538ae4f36b31764)** to **[5a2491a](https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60)**



---

archive/issue_comments_486807.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/147ec0f455c60ac72f51fdee97af2643b24d6dbf\">147ec0f</a></td><td><code>build/pkgs/pip2pi: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9\">e79de96</a></td><td><code>build/make/install: At the end, update the repository index</code></td></tr></table>\n",
    "created_at": "2020-11-11T02:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486807",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/147ec0f455c60ac72f51fdee97af2643b24d6dbf">147ec0f</a></td><td><code>build/pkgs/pip2pi: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9">e79de96</a></td><td><code>build/make/install: At the end, update the repository index</code></td></tr></table>




---

archive/issue_comments_486808.json:
```json
{
    "body": "Changed commit from **[5a2491a](https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60)** to **[e79de96](https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9)**",
    "created_at": "2020-11-11T02:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486808",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5a2491a](https://github.com/sagemath/sagetrac-mirror/commit/5a2491a5c4ef99ba8e63ebb5c81ae69e45605c60)** to **[e79de96](https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9)**



---

archive/issue_comments_486809.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nRebased, needs review",
    "created_at": "2020-11-11T02:39:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486809",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

Rebased, needs review



---

archive/issue_comments_486810.json:
```json
{
    "body": "Changed dependencies from **#29500** to none",
    "created_at": "2020-11-11T02:39:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486810",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29500** to none



---

archive/issue_comments_486811.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nLGTM!",
    "created_at": "2020-11-27T11:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486811",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:25" align="right">comment:25</div>

LGTM!



---

archive/issue_comments_486812.json:
```json
{
    "body": "Changed reviewer from **Tobias Diez, ...** to **Tobias Diez**",
    "created_at": "2020-11-27T11:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486812",
    "user": "https://github.com/tobiasdiez"
}
```

Changed reviewer from **Tobias Diez, ...** to **Tobias Diez**



---

archive/issue_events_420815.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-27T11:00:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420815"
}
```



---

archive/issue_events_420816.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-27T11:00:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420816"
}
```



---

archive/issue_comments_486813.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThank you!",
    "created_at": "2020-11-27T18:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486813",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Thank you!



---

archive/issue_comments_486814.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nLooks like some script is silently ignoring errors (and there is an error, too):\n\n```\n$ ./sage -i pip2pi\n[...]\n[sagelib-9.3.beta2] Finished cleaning, time: 0.15 seconds.\n[sagelib-9.3.beta2] \n[sagelib-9.3.beta2] real\t0m2.307s\n[sagelib-9.3.beta2] user\t0m1.765s\n[sagelib-9.3.beta2] sys\t0m0.539s\ntouch \"/home/release/Sage/local/var/lib/sage/installed/sagelib-9.3.beta2\"\nmake[1]: Leaving directory '/home/release/Sage/build/make'\n\nreal\t0m4.280s\nuser\t0m3.292s\nsys\t0m0.942s\nTraceback (most recent call last):\n  File \"/home/release/Sage/local/bin/dir2pi\", line 8, in <module>\n    sys.exit(dir2pi())\n  File \"/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py\", line 308, in dir2pi\n    return _dir2pi(option, argv)\n  File \"/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py\", line 377, in _dir2pi\n    cgi.escape(pkg_dir_name),\nAttributeError: module 'cgi' has no attribute 'escape'\nSage build/upgrade complete!\n```\nAlso docbuild fails on buildbots but not on my machine with\n\n```\n[dochtml] [spkg     ] building [inventory]: targets for 271 source files that are out of date\n[dochtml] [spkg     ] updating environment: [new config] 271 added, 0 changed, 0 removed\n[dochtml] [spkg     ] /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree\n[dochtml] [spkg     ] The inventory files are in local/share/doc/sage/inventory/en/reference/spkg.\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\n[dochtml]     return _run_code(code, main_globals, None,\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/runpy.py\", line 87, in _run_code\n[dochtml]     exec(code, run_globals)\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py\", line 1730, in main\n[dochtml]     builder()\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py\", line 343, in _wrapper\n[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py\", line 569, in _wrapper\n[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py\", line 555, in _build_everything_except_bibliography\n[dochtml]     build_many(build_ref_doc, non_references)\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py\", line 295, in build_many\n[dochtml]     _build_many(target, args, processes=NUM_THREADS)\n[dochtml]   File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/utils.py\", line 289, in build_many\n[dochtml]     raise worker_exc.original_exception\n[dochtml] OSError: /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree\nmake[1]: *** [doc-html-mathjax] Error 1\n```",
    "created_at": "2020-12-05T11:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486814",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

Looks like some script is silently ignoring errors (and there is an error, too):

```
$ ./sage -i pip2pi
[...]
[sagelib-9.3.beta2] Finished cleaning, time: 0.15 seconds.
[sagelib-9.3.beta2] 
[sagelib-9.3.beta2] real	0m2.307s
[sagelib-9.3.beta2] user	0m1.765s
[sagelib-9.3.beta2] sys	0m0.539s
touch "/home/release/Sage/local/var/lib/sage/installed/sagelib-9.3.beta2"
make[1]: Leaving directory '/home/release/Sage/build/make'

real	0m4.280s
user	0m3.292s
sys	0m0.942s
Traceback (most recent call last):
  File "/home/release/Sage/local/bin/dir2pi", line 8, in <module>
    sys.exit(dir2pi())
  File "/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py", line 308, in dir2pi
    return _dir2pi(option, argv)
  File "/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py", line 377, in _dir2pi
    cgi.escape(pkg_dir_name),
AttributeError: module 'cgi' has no attribute 'escape'
Sage build/upgrade complete!
```
Also docbuild fails on buildbots but not on my machine with

```
[dochtml] [spkg     ] building [inventory]: targets for 271 source files that are out of date
[dochtml] [spkg     ] updating environment: [new config] 271 added, 0 changed, 0 removed
[dochtml] [spkg     ] /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree
[dochtml] [spkg     ] The inventory files are in local/share/doc/sage/inventory/en/reference/spkg.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/runpy.py", line 194, in _run_module_as_main
[dochtml]     return _run_code(code, main_globals, None,
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/runpy.py", line 87, in _run_code
[dochtml]     exec(code, run_globals)
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 1730, in main
[dochtml]     builder()
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 343, in _wrapper
[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 569, in _wrapper
[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 555, in _build_everything_except_bibliography
[dochtml]     build_many(build_ref_doc, non_references)
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 295, in build_many
[dochtml]     _build_many(target, args, processes=NUM_THREADS)
[dochtml]   File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.8/site-packages/sage_setup/docbuild/utils.py", line 289, in build_many
[dochtml]     raise worker_exc.original_exception
[dochtml] OSError: /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree
make[1]: *** [doc-html-mathjax] Error 1
```



---

archive/issue_events_420817.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-05T11:49:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420817"
}
```



---

archive/issue_events_420818.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-05T11:49:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420818"
}
```



---

archive/issue_comments_486815.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@vbraun](#comment:27):\n> Looks like some script is silently ignoring errors (and there is an error, too):\n> \n> ```\n> $ ./sage -i pip2pi\n> [...]\n> [sagelib-9.3.beta2] Finished cleaning, time: 0.15 seconds.\n> [sagelib-9.3.beta2] \n> [sagelib-9.3.beta2] real\t0m2.307s\n> [sagelib-9.3.beta2] user\t0m1.765s\n> [sagelib-9.3.beta2] sys\t0m0.539s\n> touch \"/home/release/Sage/local/var/lib/sage/installed/sagelib-9.3.beta2\"\n> make[1]: Leaving directory '/home/release/Sage/build/make'\n> \n> real\t0m4.280s\n> user\t0m3.292s\n> sys\t0m0.942s\n> Traceback (most recent call last):\n>   File \"/home/release/Sage/local/bin/dir2pi\", line 8, in <module>\n>     sys.exit(dir2pi())\n>   File \"/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py\", line 308, in dir2pi\n>     return _dir2pi(option, argv)\n>   File \"/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py\", line 377, in _dir2pi\n>     cgi.escape(pkg_dir_name),\n> AttributeError: module 'cgi' has no attribute 'escape'\n> Sage build/upgrade complete!\n> ```\n\nLooks like this package is not ready for Python 3.8, https://github.com/wolever/pip2pi/issues/111",
    "created_at": "2020-12-05T18:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486815",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@vbraun](#comment:27):
> Looks like some script is silently ignoring errors (and there is an error, too):
> 
> ```
> $ ./sage -i pip2pi
> [...]
> [sagelib-9.3.beta2] Finished cleaning, time: 0.15 seconds.
> [sagelib-9.3.beta2] 
> [sagelib-9.3.beta2] real	0m2.307s
> [sagelib-9.3.beta2] user	0m1.765s
> [sagelib-9.3.beta2] sys	0m0.539s
> touch "/home/release/Sage/local/var/lib/sage/installed/sagelib-9.3.beta2"
> make[1]: Leaving directory '/home/release/Sage/build/make'
> 
> real	0m4.280s
> user	0m3.292s
> sys	0m0.942s
> Traceback (most recent call last):
>   File "/home/release/Sage/local/bin/dir2pi", line 8, in <module>
>     sys.exit(dir2pi())
>   File "/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py", line 308, in dir2pi
>     return _dir2pi(option, argv)
>   File "/home/release/Sage/local/lib64/python3.8/site-packages/libpip2pi/commands.py", line 377, in _dir2pi
>     cgi.escape(pkg_dir_name),
> AttributeError: module 'cgi' has no attribute 'escape'
> Sage build/upgrade complete!
> ```

Looks like this package is not ready for Python 3.8, https://github.com/wolever/pip2pi/issues/111



---

archive/issue_comments_486816.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nhttps://github.com/wolever/pip2pi/pull/106",
    "created_at": "2020-12-05T19:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486816",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

https://github.com/wolever/pip2pi/pull/106



---

archive/issue_comments_486817.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee4a7435e0fc6b57550ffc8ef0aa1890428afd4b\">ee4a743</a></td><td><code>Merge tag '9.3.beta2' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bae6a13496b7cbf3eac6f7407dd30626e4d9591\">9bae6a1</a></td><td><code>build/pkgs/pip2pi: Make it a normal package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117\">4e7f968</a></td><td><code>build/pkgs/pip2pi/patches: Add patch for python >=3.8 support</code></td></tr></table>\n",
    "created_at": "2020-12-06T04:49:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486817",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee4a7435e0fc6b57550ffc8ef0aa1890428afd4b">ee4a743</a></td><td><code>Merge tag '9.3.beta2' into t/30527/pep-503-simple-repository-for-wheels</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bae6a13496b7cbf3eac6f7407dd30626e4d9591">9bae6a1</a></td><td><code>build/pkgs/pip2pi: Make it a normal package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117">4e7f968</a></td><td><code>build/pkgs/pip2pi/patches: Add patch for python >=3.8 support</code></td></tr></table>




---

archive/issue_comments_486818.json:
```json
{
    "body": "Changed commit from **[e79de96](https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9)** to **[4e7f968](https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117)**",
    "created_at": "2020-12-06T04:49:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486818",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e79de96](https://github.com/sagemath/sagetrac-mirror/commit/e79de9681ebd117165148769af5104dd125452e9)** to **[4e7f968](https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117)**



---

archive/issue_events_420819.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T04:49:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420819"
}
```



---

archive/issue_events_420820.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T04:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420820"
}
```



---

archive/issue_comments_486819.json:
```json
{
    "body": "Changed commit from **[4e7f968](https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117)** to **[333e50c](https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c)**",
    "created_at": "2020-12-06T04:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486819",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4e7f968](https://github.com/sagemath/sagetrac-mirror/commit/4e7f9681d286bf74b8b589eb3387a41f02460117)** to **[333e50c](https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c)**



---

archive/issue_comments_486820.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c\">333e50c</a></td><td><code>build/make/install: Do not ignore errors from dir2pi</code></td></tr></table>\n",
    "created_at": "2020-12-06T04:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486820",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/333e50c002787d5fc828109388d83f5f9b7bd78c">333e50c</a></td><td><code>build/make/install: Do not ignore errors from dir2pi</code></td></tr></table>




---

archive/issue_comments_486821.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@vbraun](#comment:27):\n> Also docbuild fails on buildbots but not on my machine with\n> \n> ```\n> [dochtml] [spkg     ] /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree\n> ```\n\nTo debug this on the affected buildbots, it should be checked whether the file `index.rst` in the same directory is generated correctly by `bootstrap`.",
    "created_at": "2020-12-06T04:59:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486821",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@vbraun](#comment:27):
> Also docbuild fails on buildbots but not on my machine with
> 
> ```
> [dochtml] [spkg     ] /Users/buildbot-sage/slave/sage_git/build/src/doc/en/reference/spkg/pip2pi.rst: WARNING: document isn't included in any toctree
> ```

To debug this on the affected buildbots, it should be checked whether the file `index.rst` in the same directory is generated correctly by `bootstrap`.



---

archive/issue_comments_486822.json:
```json
{
    "body": "Changed keywords from none to **sd111**",
    "created_at": "2020-12-06T17:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486822",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from none to **sd111**



---

archive/issue_comments_486823.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nWaiting for review",
    "created_at": "2020-12-22T06:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486823",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Waiting for review



---

archive/issue_comments_486824.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486824",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_420821.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420821"
}
```



---

archive/issue_events_420822.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420822"
}
```



---

archive/issue_events_420823.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420823"
}
```



---

archive/issue_events_420824.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420824"
}
```



---

archive/issue_comments_486825.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486825",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_486826.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI tried `make pip2pi` (after rebasing to the latest beta), and although the package built, I got an error message afterwards:\n\n```\n[pip2pi-0.8.1] Finished installing pip2pi-0.8.1\n\nreal\t0m33.466s\nuser\t0m3.670s\nsys\t0m1.412s\nTraceback (most recent call last):\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/bin/dir2pi\", line 8, in <module>\n    sys.exit(dir2pi())\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/lib/python3.9/site-packages/libpip2pi/commands.py\", line 312, in dir2pi\n    return _dir2pi(option, argv)\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/lib/python3.9/site-packages/libpip2pi/commands.py\", line 340, in _dir2pi\n    raise ValueError(\"no such directory: %r\" %(pkgdir, ))\nValueError: no such directory: ''\nError updating PEP 503 simple repository index\nmake: *** [pip2pi] Error 1\n```",
    "created_at": "2021-09-30T18:40:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486826",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:39" align="right">comment:39</div>

I tried `make pip2pi` (after rebasing to the latest beta), and although the package built, I got an error message afterwards:

```
[pip2pi-0.8.1] Finished installing pip2pi-0.8.1

real	0m33.466s
user	0m3.670s
sys	0m1.412s
Traceback (most recent call last):
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/bin/dir2pi", line 8, in <module>
    sys.exit(dir2pi())
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/lib/python3.9/site-packages/libpip2pi/commands.py", line 312, in dir2pi
    return _dir2pi(option, argv)
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/lib/python3.9/site-packages/libpip2pi/commands.py", line 340, in _dir2pi
    raise ValueError("no such directory: %r" %(pkgdir, ))
ValueError: no such directory: ''
Error updating PEP 503 simple repository index
make: *** [pip2pi] Error 1
```



---

archive/issue_events_420825.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T18:43:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420825"
}
```



---

archive/issue_events_420826.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T18:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420826"
}
```



---

archive/issue_events_420827.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T18:43:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420827"
}
```



---

archive/issue_events_420828.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T18:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30527#event-420828"
}
```



---

archive/issue_comments_486827.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThanks for testing. Looks like this now needs updating to the recent build system changes (probably the SAGE_LOCAL/SAGE_VENV split). There's no urgency to this ticket because I learned that one can use `--find-links` instead of `--index-url`. So I've changed the milestone",
    "created_at": "2021-09-30T18:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30527#issuecomment-486827",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Thanks for testing. Looks like this now needs updating to the recent build system changes (probably the SAGE_LOCAL/SAGE_VENV split). There's no urgency to this ticket because I learned that one can use `--find-links` instead of `--index-url`. So I've changed the milestone
