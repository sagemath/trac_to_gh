# Issue 30559: Refine python3's SAGE_SPKG_DEPCHECK: Remove sqlite

archive/issues_030322.json:
```json
{
    "body": "Currently we have `SAGE_SPKG_DEPCHECK([sqlite libpng bzip2 xz libffi], ...)`, which causes system python3 to be rejected on many systems.\n\nWe should review whether this can be made more fine-grained.\n\n`SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.\n\n**Package `sqlite`**....\n\n```\n$ grep sqlite build/pkgs/*/dependencies\nbuild/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped\nbuild/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)\nbuild/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n```\n\n`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.\n\n`cryptominisat` does not seem to depend on sqlite at all.\n\nIn this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as \"not required\" if system python3 will be used.\n\n---\n\nFollow-up tickets may address the following dependencies:\n- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi \n- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  \n\nSee also:\n- #28019 If system mpir is found, yasm should not be built\n\n\nCC:  @orlitzky @dimpase slellievre @mwageringel @kiwifb @antonio-rojas @embray\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nBranch: 4731840945a8598cbc97367e2b4ad60e6d9c6c7c\n\nCommit: 4731840945a8598cbc97367e2b4ad60e6d9c6c7c\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30559\n\n",
    "closed_at": "2020-11-29T11:58:11Z",
    "created_at": "2020-09-11T19:50:39Z",
    "labels": [
        "component: build: configure",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Refine python3's SAGE_SPKG_DEPCHECK: Remove sqlite",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30559",
    "user": "https://github.com/mkoeppe"
}
```
Currently we have `SAGE_SPKG_DEPCHECK([sqlite libpng bzip2 xz libffi], ...)`, which causes system python3 to be rejected on many systems.

We should review whether this can be made more fine-grained.

`SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.

**Package `sqlite`**....

```
$ grep sqlite build/pkgs/*/dependencies
build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped
build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)
build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
```

`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.

`cryptominisat` does not seem to depend on sqlite at all.

In this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as "not required" if system python3 will be used.

---

Follow-up tickets may address the following dependencies:
- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi 
- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  

See also:
- #28019 If system mpir is found, yasm should not be built


CC:  @orlitzky @dimpase slellievre @mwageringel @kiwifb @antonio-rojas @embray

Reviewer: John Palmieri

Author: Matthias Koeppe

Branch: 4731840945a8598cbc97367e2b4ad60e6d9c6c7c

Commit: 4731840945a8598cbc97367e2b4ad60e6d9c6c7c

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30559





---

archive/issue_comments_432027.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build: configure.",
    "created_at": "2020-09-11T19:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432027",
    "user": "https://github.com/mkoeppe"
}
```

Changing component from PLEASE CHANGE to build: configure.



---

archive/issue_events_079427.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-08T17:31:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30559#event-79427"
}
```



---

archive/issue_comments_432028.json:
```json
{
    "body": "<a id='comment:9'></a>I don't really understand m4 syntax, but for sqlite, it looks like `build/pkgs/python3/spkg-configure.m4` checks both that `sqlite` as a package has been installed and separately whether the system Python includes an `sqlite` module. Shouldn't just the second of these be good enough?",
    "created_at": "2020-10-10T21:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432028",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>I don't really understand m4 syntax, but for sqlite, it looks like `build/pkgs/python3/spkg-configure.m4` checks both that `sqlite` as a package has been installed and separately whether the system Python includes an `sqlite` module. Shouldn't just the second of these be good enough?



---

archive/issue_comments_432029.json:
```json
{
    "body": "<a id='comment:10'></a>The \"depcheck\" macro is used generally for avoiding a problem with conflicting shared libraries. Here, if we install `sqlite` from SPKG for any reason, then we insist that also `python3` must be built from SPKG. Otherwise, the system python's sqlite module is linked to some other libsqlite3, and then IF we load it together with our libsqlite3, this could lead to trouble.\n\nNow, as the ticket summary explains, ACTUALLY we never use our libsqlite3 for anything other than building python3. \n\nSo because of that, I think that we could, as you say, remove the depcheck for sqlite3 from spkg-configure.m4\n\nHowever, if we ever add another package (providing a shared library linked into a Python module) that ALSO uses libsqlite3, then we would have to put the depcheck back...",
    "created_at": "2020-10-10T21:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432029",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>The "depcheck" macro is used generally for avoiding a problem with conflicting shared libraries. Here, if we install `sqlite` from SPKG for any reason, then we insist that also `python3` must be built from SPKG. Otherwise, the system python's sqlite module is linked to some other libsqlite3, and then IF we load it together with our libsqlite3, this could lead to trouble.

Now, as the ticket summary explains, ACTUALLY we never use our libsqlite3 for anything other than building python3. 

So because of that, I think that we could, as you say, remove the depcheck for sqlite3 from spkg-configure.m4

However, if we ever add another package (providing a shared library linked into a Python module) that ALSO uses libsqlite3, then we would have to put the depcheck back...



---

archive/issue_comments_432030.json:
```json
{
    "body": "<a id='comment:11'></a>Moreover, again because python3 is the unique package that uses sqlite3 directly, if system python3 is available, we do not have to build sqlite3 from SPKG even if we don't find system sqlite3.",
    "created_at": "2020-10-10T21:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432030",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Moreover, again because python3 is the unique package that uses sqlite3 directly, if system python3 is available, we do not have to build sqlite3 from SPKG even if we don't find system sqlite3.



---

archive/issue_comments_432031.json:
```json
{
    "body": "<a id='comment:12'></a>This is all rather complicated, and I am not sure if our current spkg-configure framework is able to express it cleanly. But I think it would be very valuable to sort it out -- the missing sqlite (headers) are probably the top reason why we might reject python3 at least on macOS",
    "created_at": "2020-10-10T21:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432031",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>This is all rather complicated, and I am not sure if our current spkg-configure framework is able to express it cleanly. But I think it would be very valuable to sort it out -- the missing sqlite (headers) are probably the top reason why we might reject python3 at least on macOS



---

archive/issue_comments_432032.json:
```json
{
    "body": "<a id='comment:13'></a>We would have to pay attention if another package were added to use `sqlite3`, but as long as that doesn't happen, couldn't we just duplicate code from `spkg-configure.m4` for `python3` into the one for `sqlite3`? That is, put the checks for a valid system `python3` into the `spkg-configure.m4` script for `sqlite3`, and only if those fail, check to see if there is a valid `sqlite3` package that Sage can use when building its `python3`.",
    "created_at": "2020-10-10T22:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432032",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>We would have to pay attention if another package were added to use `sqlite3`, but as long as that doesn't happen, couldn't we just duplicate code from `spkg-configure.m4` for `python3` into the one for `sqlite3`? That is, put the checks for a valid system `python3` into the `spkg-configure.m4` script for `sqlite3`, and only if those fail, check to see if there is a valid `sqlite3` package that Sage can use when building its `python3`.



---

archive/issue_comments_432033.json:
```json
{
    "body": "<a id='comment:16'></a>Here's a version that might work\n\n---\nNew commits:",
    "created_at": "2020-10-10T23:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432033",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Here's a version that might work

---
New commits:



---

archive/issue_comments_432034.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-10T23:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432034",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432035.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-10T23:06:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432035",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432036.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-11T01:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432036",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_432037.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-16T22:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432037",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_432038.json:
```json
{
    "body": "<a id='comment:22'></a>Unfortunately (?), sqlite is no longer broken on my mac running Big Sur, at least according to Sage's `./configure`, so it's a little harder to test this, but if I run `./configure --with-system-sqlite=no`, then without this branch Python gets built, while with it, the system Python 3 is used.",
    "created_at": "2020-10-16T22:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432038",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>Unfortunately (?), sqlite is no longer broken on my mac running Big Sur, at least according to Sage's `./configure`, so it's a little harder to test this, but if I run `./configure --with-system-sqlite=no`, then without this branch Python gets built, while with it, the system Python 3 is used.



---

archive/issue_comments_432039.json:
```json
{
    "body": "<a id='comment:23'></a>Thanks!",
    "created_at": "2020-10-17T21:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432039",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Thanks!



---

archive/issue_comments_432040.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-10-25T09:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432040",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_432041.json:
```json
{
    "body": "<a id='comment:24'></a>\n```\n[sagelib-9.2] [1/1] gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/home/release/Sage/build/pkgs/sagelib/src -I/usr/include/python3.8 -I/home/release/Sage/local/lib64/python3.8/site-packages/numpy/core/include -Ibuild/cythonized -I/home/release/Sage/local/include -I/usr/include/python3.8 -c build/cythonized/sage/misc/sage_ostools.c -o build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99\n[sagelib-9.2] gcc -pthread -shared -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-rpath-link,/home/release/Sage/local/lib -L/home/release/Sage/local/lib -Wl,-rpath,/home/release/Sage/local/lib build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -L/usr/lib64 -lsqlite3 -o build/lib.linux-x86_64-3.8/sage/misc/sage_ostools.cpython-38-x86_64-linux-gnu.so\n[sagelib-9.2] /usr/bin/ld: cannot find -lsqlite3\n[sagelib-9.2] collect2: error: ld returned 1 exit status\n[sagelib-9.2] error: command 'gcc' failed with exit status 1\n```\nNote: there is no libsqlite3.so and I don't have sqlite3-devel installed\n\n```\n$ ll /usr/lib64/libsqlite3*\nlrwxrwxrwx. 1 root root      19 Oct 11 10:30 /usr/lib64/libsqlite3.so.0 -> libsqlite3.so.0.8.6\n-rwxr-xr-x. 1 root root 1280944 Oct 11 10:30 /usr/lib64/libsqlite3.so.0.8.6\n```",
    "created_at": "2020-10-25T09:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432041",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>
```
[sagelib-9.2] [1/1] gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/home/release/Sage/build/pkgs/sagelib/src -I/usr/include/python3.8 -I/home/release/Sage/local/lib64/python3.8/site-packages/numpy/core/include -Ibuild/cythonized -I/home/release/Sage/local/include -I/usr/include/python3.8 -c build/cythonized/sage/misc/sage_ostools.c -o build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99
[sagelib-9.2] gcc -pthread -shared -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-rpath-link,/home/release/Sage/local/lib -L/home/release/Sage/local/lib -Wl,-rpath,/home/release/Sage/local/lib build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -L/usr/lib64 -lsqlite3 -o build/lib.linux-x86_64-3.8/sage/misc/sage_ostools.cpython-38-x86_64-linux-gnu.so
[sagelib-9.2] /usr/bin/ld: cannot find -lsqlite3
[sagelib-9.2] collect2: error: ld returned 1 exit status
[sagelib-9.2] error: command 'gcc' failed with exit status 1
```
Note: there is no libsqlite3.so and I don't have sqlite3-devel installed

```
$ ll /usr/lib64/libsqlite3*
lrwxrwxrwx. 1 root root      19 Oct 11 10:30 /usr/lib64/libsqlite3.so.0 -> libsqlite3.so.0.8.6
-rwxr-xr-x. 1 root root 1280944 Oct 11 10:30 /usr/lib64/libsqlite3.so.0.8.6
```



---

archive/issue_comments_432042.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-02T21:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432042",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432043.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-11-02T21:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432043",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_432044.json:
```json
{
    "body": "<a id='comment:27'></a>this seems to need testing on Cygwin",
    "created_at": "2020-11-11T10:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432044",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>this seems to need testing on Cygwin



---

archive/issue_comments_432045.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-11T17:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432046.json:
```json
{
    "body": "<a id='comment:29'></a>Cygwin test now running at https://github.com/mkoeppe/sage/actions/runs/358167921",
    "created_at": "2020-11-11T17:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432046",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Cygwin test now running at https://github.com/mkoeppe/sage/actions/runs/358167921



---

archive/issue_comments_432047.json:
```json
{
    "body": "<a id='comment:30'></a>The Cygwin tests look okay to me. Shall we merge it?",
    "created_at": "2020-11-22T20:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432047",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>The Cygwin tests look okay to me. Shall we merge it?



---

archive/issue_comments_432048.json:
```json
{
    "body": "<a id='comment:31'></a>I haven't yet seen a Cygwin test to proceed to actually running Sage because of the general fragility of the multi-stage GH actions (I restarted the workflow several times...). But I think we can proceed anyway, it should not hold up this improvement.",
    "created_at": "2020-11-22T20:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432048",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>I haven't yet seen a Cygwin test to proceed to actually running Sage because of the general fragility of the multi-stage GH actions (I restarted the workflow several times...). But I think we can proceed anyway, it should not hold up this improvement.



---

archive/issue_comments_432049.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-22T22:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432049",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_432050.json:
```json
{
    "body": "<a id='comment:32'></a>Okay, let's try again, then.",
    "created_at": "2020-11-22T22:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432050",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>Okay, let's try again, then.



---

archive/issue_comments_432051.json:
```json
{
    "body": "<a id='comment:33'></a>Thanks!",
    "created_at": "2020-11-22T23:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432051",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>Thanks!



---

archive/issue_events_079428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-29T11:58:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30559#event-79428"
}
```



---

archive/issue_comments_432052.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-29T11:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30559#issuecomment-432052",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
