# Issue 30559: Refine python3's SAGE_SPKG_DEPCHECK: Remove sqlite

archive/issues_030322.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nCurrently we have `SAGE_SPKG_DEPCHECK([sqlite libpng bzip2 xz libffi], ...)`, which causes system python3 to be rejected on many systems.\n\nWe should review whether this can be made more fine-grained.\n\n`SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.\n\n**Package `sqlite`**....\n\n```\n$ grep sqlite build/pkgs/*/dependencies\nbuild/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped\nbuild/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)\nbuild/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n```\n\n`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.\n\n`cryptominisat` does not seem to depend on sqlite at all.\n\nIn this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as \"not required\" if system python3 will be used.\n\n---\n\nFollow-up tickets may address the following dependencies:\n- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi \n- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  \n\nSee also:\n- #28019 If system mpir is found, yasm should not be built\n\n\nCC:  @orlitzky @dimpase @slel @mwageringel @kiwifb @antonio-rojas @embray\n\nComponent: **build: configure**\n\nAuthor: **Matthias Koeppe**\n\nBranch: **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**\n\nReviewer: **John Palmieri**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/30559_\n\n",
    "closed_at": "2020-11-29T11:58:11Z",
    "created_at": "2020-09-11T19:50:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Refine python3's SAGE_SPKG_DEPCHECK: Remove sqlite",
    "type": "issue",
    "updated_at": "2023-01-08T08:45:06Z",
    "url": "https://github.com/sagemath/sage/issues/30559",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

Currently we have `SAGE_SPKG_DEPCHECK([sqlite libpng bzip2 xz libffi], ...)`, which causes system python3 to be rejected on many systems.

We should review whether this can be made more fine-grained.

`SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.

**Package `sqlite`**....

```
$ grep sqlite build/pkgs/*/dependencies
build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped
build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)
build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
```

`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.

`cryptominisat` does not seem to depend on sqlite at all.

In this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as "not required" if system python3 will be used.

---

Follow-up tickets may address the following dependencies:
- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi 
- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  

See also:
- #28019 If system mpir is found, yasm should not be built


CC:  @orlitzky @dimpase @slel @mwageringel @kiwifb @antonio-rojas @embray

Component: **build: configure**

Author: **Matthias Koeppe**

Branch: **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**

Reviewer: **John Palmieri**

_Issue created by migration from https://trac.sagemath.org/ticket/30559_





---

archive/issue_events_418189.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-11T19:50:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418189"
}
```



---

archive/issue_events_418190.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-11T19:50:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418190"
}
```



---

archive/issue_events_418191.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-11T19:50:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418191"
}
```



---

archive/issue_events_418192.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-11T19:51:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418192"
}
```



---

archive/issue_comments_487452.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,12 @@\n We should review whether this can be made more fine-grained.\n \n `SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.\n+\n+**Package `sqlite`**....\n+\n+**Package `libpng`**.....\n+\n+**Package `bzip2`**......\n \n **Package `xz`** represents both the shared library `liblzma` and the `xz` binary. \n \n@@ -20,5 +26,5 @@\n \n It needs to be checked whether this is the case for `python3`.\n \n+**Package `libffi`**....\n \n-\n``````\n",
    "created_at": "2020-09-11T22:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487452",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,12 @@
 We should review whether this can be made more fine-grained.
 
 `SAGE_SPKG_DEPCHECK` is specifically for checking whether we are going to install a shared library that may interfere with a system-provided version of the same shared library that the package is linked against.
+
+**Package `sqlite`**....
+
+**Package `libpng`**.....
+
+**Package `bzip2`**......
 
 **Package `xz`** represents both the shared library `liblzma` and the `xz` binary. 
 
@@ -20,5 +26,5 @@
 
 It needs to be checked whether this is the case for `python3`.
 
+**Package `libffi`**....
 
-
``````




---

archive/issue_comments_487453.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,7 +22,7 @@\n build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n ```\n-In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking and have nothing to do with the shared library.\n+In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking the tarball) and have nothing to do with the shared library.\n \n It needs to be checked whether this is the case for `python3`.\n \n``````\n",
    "created_at": "2020-09-11T22:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487453",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,7 +22,7 @@
 build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
 build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
 ```
-In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking and have nothing to do with the shared library.
+In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking the tarball) and have nothing to do with the shared library.
 
 It needs to be checked whether this is the case for `python3`.
 
``````




---

archive/issue_comments_487454.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,3 +28,7 @@\n \n **Package `libffi`**....\n \n+\n+See also:\n+- #28019 If system mpir is found, yasm should not be built\n+\n``````\n",
    "created_at": "2020-09-12T06:25:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487454",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,3 +28,7 @@
 
 **Package `libffi`**....
 
+
+See also:
+- #28019 If system mpir is found, yasm should not be built
+
``````




---

archive/issue_comments_487455.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n \n **Package `bzip2`**......\n \n-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary. \n+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  \n \n ```\n  grep xz build/pkgs/*/dependencies\n``````\n",
    "created_at": "2020-09-12T06:26:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487455",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 
 **Package `bzip2`**......
 
-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary. 
+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  
 
 ```
  grep xz build/pkgs/*/dependencies
``````




---

archive/issue_comments_487456.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,14 +6,45 @@\n \n **Package `sqlite`**....\n \n+```\n+$ grep sqlite build/pkgs/*/dependencies\n+build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped\n+build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)\n+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n+```\n+\n **Package `libpng`**.....\n \n+```\n+$ grep libpng build/pkgs/*/dependencies\n+build/pkgs/brial/dependencies:boost_cropped m4ri libpng | pkgconf\n+build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped\n+build/pkgs/freetype/dependencies:libpng bzip2\n+build/pkgs/giac/dependencies:readline libpng $(MP_LIBRARY) mpfr mpfi ntl gsl pari glpk curl\n+build/pkgs/libgd/dependencies:libpng freetype\n+build/pkgs/libtheora/dependencies:libogg libpng\n+build/pkgs/m4ri/dependencies:libpng\n+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n+build/pkgs/sagelib/dependencies:FORCE $(SCRIPTS) arb boost_cropped $(BLAS) brial cliquer cypari cysignals cython ecl eclib ecm flint libgd gap givaro glpk gmpy2 gsl iml jinja2 jupyter_core lcalc lrcalc libbraiding libhomfly libpng linbox m4ri m4rie mpc mpfi mpfr $(MP_LIBRARY) ntl numpy pari pip pkgconfig planarity ppl pplpy pycygwin pynac $(PYTHON) ratpoints readline rw sage_conf singular symmetrica zn_poly $(PCFILES)\n+build/pkgs/tachyon/dependencies:libpng\n+```\n+\n **Package `bzip2`**......\n+\n+```\n+$ grep bzip2 build/pkgs/*/dependencies\n+build/pkgs/cbc/dependencies:readline zlib bzip2 $(BLAS)\n+build/pkgs/cmake/dependencies:curl zlib bzip2 xz\n+build/pkgs/freetype/dependencies:libpng bzip2\n+build/pkgs/pcre/dependencies:bzip2\n+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n+build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n+```\n \n **Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  \n \n ```\n- grep xz build/pkgs/*/dependencies\n+$ grep xz build/pkgs/*/dependencies\n build/pkgs/cmake/dependencies:curl zlib bzip2 xz\n build/pkgs/gcc/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz\n build/pkgs/gdb/dependencies:mpfr zlib ncurses $(PYTHON) xz\n@@ -28,6 +59,11 @@\n \n **Package `libffi`**....\n \n+```\n+$ grep libffi build/pkgs/*/dependencies\n+build/pkgs/ecl/dependencies:$(MP_LIBRARY) readline gc libffi\n+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n+```\n \n See also:\n - #28019 If system mpir is found, yasm should not be built\n``````\n",
    "created_at": "2020-09-12T06:43:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487456",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,14 +6,45 @@
 
 **Package `sqlite`**....
 
+```
+$ grep sqlite build/pkgs/*/dependencies
+build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped
+build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)
+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
+```
+
 **Package `libpng`**.....
 
+```
+$ grep libpng build/pkgs/*/dependencies
+build/pkgs/brial/dependencies:boost_cropped m4ri libpng | pkgconf
+build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped
+build/pkgs/freetype/dependencies:libpng bzip2
+build/pkgs/giac/dependencies:readline libpng $(MP_LIBRARY) mpfr mpfi ntl gsl pari glpk curl
+build/pkgs/libgd/dependencies:libpng freetype
+build/pkgs/libtheora/dependencies:libogg libpng
+build/pkgs/m4ri/dependencies:libpng
+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
+build/pkgs/sagelib/dependencies:FORCE $(SCRIPTS) arb boost_cropped $(BLAS) brial cliquer cypari cysignals cython ecl eclib ecm flint libgd gap givaro glpk gmpy2 gsl iml jinja2 jupyter_core lcalc lrcalc libbraiding libhomfly libpng linbox m4ri m4rie mpc mpfi mpfr $(MP_LIBRARY) ntl numpy pari pip pkgconfig planarity ppl pplpy pycygwin pynac $(PYTHON) ratpoints readline rw sage_conf singular symmetrica zn_poly $(PCFILES)
+build/pkgs/tachyon/dependencies:libpng
+```
+
 **Package `bzip2`**......
+
+```
+$ grep bzip2 build/pkgs/*/dependencies
+build/pkgs/cbc/dependencies:readline zlib bzip2 $(BLAS)
+build/pkgs/cmake/dependencies:curl zlib bzip2 xz
+build/pkgs/freetype/dependencies:libpng bzip2
+build/pkgs/pcre/dependencies:bzip2
+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
+build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
+```
 
 **Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  
 
 ```
- grep xz build/pkgs/*/dependencies
+$ grep xz build/pkgs/*/dependencies
 build/pkgs/cmake/dependencies:curl zlib bzip2 xz
 build/pkgs/gcc/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz
 build/pkgs/gdb/dependencies:mpfr zlib ncurses $(PYTHON) xz
@@ -28,6 +59,11 @@
 
 **Package `libffi`**....
 
+```
+$ grep libffi build/pkgs/*/dependencies
+build/pkgs/ecl/dependencies:$(MP_LIBRARY) readline gc libffi
+build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
+```
 
 See also:
 - #28019 If system mpir is found, yasm should not be built
``````




---

archive/issue_comments_487457.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,6 +12,10 @@\n build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)\n build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n ```\n+\n+`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.\n+\n+`cryptominisat` does not seem to depend on sqlite at all.\n \n **Package `libpng`**.....\n \n@@ -53,9 +57,9 @@\n build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n ```\n-In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking the tarball) and have nothing to do with the shared library.\n+In this list, `cmake`, `r`, `python3` all depend on `liblzma`. \n+The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file`) and have nothing to do with the shared library.\n \n-It needs to be checked whether this is the case for `python3`.\n \n **Package `libffi`**....\n \n``````\n",
    "created_at": "2020-09-12T07:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487457",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,6 +12,10 @@
 build/pkgs/elliptic_curves/dependencies:| sqlite $(PYTHON)
 build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
 ```
+
+`elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.
+
+`cryptominisat` does not seem to depend on sqlite at all.
 
 **Package `libpng`**.....
 
@@ -53,9 +57,9 @@
 build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
 build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
 ```
-In this list, probably some of the dependencies are merely build-time dependencies on the `xz` binary (in particular for unpacking the tarball) and have nothing to do with the shared library.
+In this list, `cmake`, `r`, `python3` all depend on `liblzma`. 
+The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file`) and have nothing to do with the shared library.
 
-It needs to be checked whether this is the case for `python3`.
 
 **Package `libffi`**....
 
``````




---

archive/issue_events_418193.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-08T17:31:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418193"
}
```



---

archive/issue_events_418194.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-08T17:31:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418194"
}
```



---

archive/issue_comments_487458.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI don't really understand m4 syntax, but for sqlite, it looks like `build/pkgs/python3/spkg-configure.m4` checks both that `sqlite` as a package has been installed and separately whether the system Python includes an `sqlite` module. Shouldn't just the second of these be good enough?",
    "created_at": "2020-10-10T21:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487458",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

I don't really understand m4 syntax, but for sqlite, it looks like `build/pkgs/python3/spkg-configure.m4` checks both that `sqlite` as a package has been installed and separately whether the system Python includes an `sqlite` module. Shouldn't just the second of these be good enough?



---

archive/issue_comments_487459.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThe \"depcheck\" macro is used generally for avoiding a problem with conflicting shared libraries. Here, if we install `sqlite` from SPKG for any reason, then we insist that also `python3` must be built from SPKG. Otherwise, the system python's sqlite module is linked to some other libsqlite3, and then IF we load it together with our libsqlite3, this could lead to trouble.\n\nNow, as the ticket summary explains, ACTUALLY we never use our libsqlite3 for anything other than building python3. \n\nSo because of that, I think that we could, as you say, remove the depcheck for sqlite3 from spkg-configure.m4\n\nHowever, if we ever add another package (providing a shared library linked into a Python module) that ALSO uses libsqlite3, then we would have to put the depcheck back...",
    "created_at": "2020-10-10T21:29:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487459",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

The "depcheck" macro is used generally for avoiding a problem with conflicting shared libraries. Here, if we install `sqlite` from SPKG for any reason, then we insist that also `python3` must be built from SPKG. Otherwise, the system python's sqlite module is linked to some other libsqlite3, and then IF we load it together with our libsqlite3, this could lead to trouble.

Now, as the ticket summary explains, ACTUALLY we never use our libsqlite3 for anything other than building python3. 

So because of that, I think that we could, as you say, remove the depcheck for sqlite3 from spkg-configure.m4

However, if we ever add another package (providing a shared library linked into a Python module) that ALSO uses libsqlite3, then we would have to put the depcheck back...



---

archive/issue_comments_487460.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMoreover, again because python3 is the unique package that uses sqlite3 directly, if system python3 is available, we do not have to build sqlite3 from SPKG even if we don't find system sqlite3.",
    "created_at": "2020-10-10T21:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487460",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Moreover, again because python3 is the unique package that uses sqlite3 directly, if system python3 is available, we do not have to build sqlite3 from SPKG even if we don't find system sqlite3.



---

archive/issue_comments_487461.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThis is all rather complicated, and I am not sure if our current spkg-configure framework is able to express it cleanly. But I think it would be very valuable to sort it out -- the missing sqlite (headers) are probably the top reason why we might reject python3 at least on macOS",
    "created_at": "2020-10-10T21:33:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487461",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

This is all rather complicated, and I am not sure if our current spkg-configure framework is able to express it cleanly. But I think it would be very valuable to sort it out -- the missing sqlite (headers) are probably the top reason why we might reject python3 at least on macOS



---

archive/issue_comments_487462.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWe would have to pay attention if another package were added to use `sqlite3`, but as long as that doesn't happen, couldn't we just duplicate code from `spkg-configure.m4` for `python3` into the one for `sqlite3`? That is, put the checks for a valid system `python3` into the `spkg-configure.m4` script for `sqlite3`, and only if those fail, check to see if there is a valid `sqlite3` package that Sage can use when building its `python3`.",
    "created_at": "2020-10-10T22:04:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487462",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

We would have to pay attention if another package were added to use `sqlite3`, but as long as that doesn't happen, couldn't we just duplicate code from `spkg-configure.m4` for `python3` into the one for `sqlite3`? That is, put the checks for a valid system `python3` into the `spkg-configure.m4` script for `sqlite3`, and only if those fail, check to see if there is a valid `sqlite3` package that Sage can use when building its `python3`.



---

archive/issue_comments_487463.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-10-10T22:45:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487463",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_487464.json:
```json
{
    "body": "Branch: **[u/mkoeppe/refine_python3_s_sage_spkg_depcheck](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refine_python3_s_sage_spkg_depcheck)**",
    "created_at": "2020-10-10T23:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487464",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/refine_python3_s_sage_spkg_depcheck](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refine_python3_s_sage_spkg_depcheck)**



---

archive/issue_comments_487465.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHere's a version that might work\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd3fc1e3a2135793e5b2178659be0050f457a078\"><code>dd3fc1e</code></a></td><td><code>build/pkgs/python3/spkg-configure.m4: Remove DEPCHECK on sqlite</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe\"><code>efb9dcc</code></a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Set as not required if system python3 will be used</code></td></tr></table>\n",
    "created_at": "2020-10-10T23:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487465",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Here's a version that might work

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd3fc1e3a2135793e5b2178659be0050f457a078"><code>dd3fc1e</code></a></td><td><code>build/pkgs/python3/spkg-configure.m4: Remove DEPCHECK on sqlite</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe"><code>efb9dcc</code></a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Set as not required if system python3 will be used</code></td></tr></table>




---

archive/issue_comments_487466.json:
```json
{
    "body": "Commit: **[`efb9dcc`](https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe)**",
    "created_at": "2020-10-10T23:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487466",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`efb9dcc`](https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe)**



---

archive/issue_comments_487467.json:
```json
{
    "body": "Changed commit from **[`efb9dcc`](https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe)** to **[`a39a9f1`](https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb)**",
    "created_at": "2020-10-10T23:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487467",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`efb9dcc`](https://github.com/sagemath/sagetrac-mirror/commit/efb9dcc8f5b54d52d2c321beccbe57477121e2fe)** to **[`a39a9f1`](https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb)**



---

archive/issue_comments_487468.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb\"><code>a39a9f1</code></a></td><td><code>build/pkgs/cryptominisat/dependencies: Remove unused dep on sqlite</code></td></tr></table>\n",
    "created_at": "2020-10-10T23:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487468",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb"><code>a39a9f1</code></a></td><td><code>build/pkgs/cryptominisat/dependencies: Remove unused dep on sqlite</code></td></tr></table>




---

archive/issue_comments_487469.json:
```json
{
    "body": "Changed commit from **[`a39a9f1`](https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb)** to **[`362f6c9`](https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8)**",
    "created_at": "2020-10-10T23:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487469",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a39a9f1`](https://github.com/sagemath/sagetrac-mirror/commit/a39a9f175db87cd646209a61528a2987d937a4fb)** to **[`362f6c9`](https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8)**



---

archive/issue_comments_487470.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8\"><code>362f6c9</code></a></td><td><code>build/pkgs/elliptic_curves/dependencies: Remove sqlite; the package only uses it through the sqlite python module</code></td></tr></table>\n",
    "created_at": "2020-10-10T23:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487470",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8"><code>362f6c9</code></a></td><td><code>build/pkgs/elliptic_curves/dependencies: Remove sqlite; the package only uses it through the sqlite python module</code></td></tr></table>




---

archive/issue_comments_487471.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -58,7 +58,7 @@\n build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n ```\n In this list, `cmake`, `r`, `python3` all depend on `liblzma`. \n-The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file`) and have nothing to do with the shared library.\n+The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file` - when `sage-bootstrap-python` is < 3.3 - see https://docs.python.org/3/library/tarfile.html) and have nothing to do with the shared library.\n \n \n **Package `libffi`**....\n``````\n",
    "created_at": "2020-10-11T01:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487471",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -58,7 +58,7 @@
 build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
 ```
 In this list, `cmake`, `r`, `python3` all depend on `liblzma`. 
-The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file`) and have nothing to do with the shared library.
+The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file` - when `sage-bootstrap-python` is < 3.3 - see https://docs.python.org/3/library/tarfile.html) and have nothing to do with the shared library.
 
 
 **Package `libffi`**....
``````




---

archive/issue_events_418195.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-11T01:42:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418195"
}
```



---

archive/issue_comments_487472.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,6 +16,12 @@\n `elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.\n \n `cryptominisat` does not seem to depend on sqlite at all.\n+\n+In this ticket, we remove these unnecessary dependencies, the sqlite depcheck for python3; and set `sqlite` as \"not required\" if system python3 will be used.\n+\n+---\n+\n+Follow-up tickets may address the following dependencies:\n \n **Package `libpng`**.....\n \n``````\n",
    "created_at": "2020-10-11T01:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,6 +16,12 @@
 `elliptic_curves` only seems to use the Python module sqlite - it does not depend on sqlite itself.
 
 `cryptominisat` does not seem to depend on sqlite at all.
+
+In this ticket, we remove these unnecessary dependencies, the sqlite depcheck for python3; and set `sqlite` as "not required" if system python3 will be used.
+
+---
+
+Follow-up tickets may address the following dependencies:
 
 **Package `libpng`**.....
 
``````




---

archive/issue_events_418196.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-11T01:42:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "title_is": "Refine python3's SAGE_SPKG_DEPCHECK: Remove sqlite",
    "title_was": "Refine python3's SAGE_SPKG_DEPCHECK",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418196"
}
```



---

archive/issue_comments_487473.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n \n `cryptominisat` does not seem to depend on sqlite at all.\n \n-In this ticket, we remove these unnecessary dependencies, the sqlite depcheck for python3; and set `sqlite` as \"not required\" if system python3 will be used.\n+In this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as \"not required\" if system python3 will be used.\n \n ---\n \n``````\n",
    "created_at": "2020-10-11T02:52:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487473",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
 
 `cryptominisat` does not seem to depend on sqlite at all.
 
-In this ticket, we remove these unnecessary dependencies, the sqlite depcheck for python3; and set `sqlite` as "not required" if system python3 will be used.
+In this ticket, we remove these unnecessary dependencies and the sqlite depcheck for python3; and set `sqlite` as "not required" if system python3 will be used.
 
 ---
 
``````




---

archive/issue_comments_487474.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nUnfortunately (?), sqlite is no longer broken on my mac running Big Sur, at least according to Sage's `./configure`, so it's a little harder to test this, but if I run `./configure --with-system-sqlite=no`, then without this branch Python gets built, while with it, the system Python 3 is used.",
    "created_at": "2020-10-16T22:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487474",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

Unfortunately (?), sqlite is no longer broken on my mac running Big Sur, at least according to Sage's `./configure`, so it's a little harder to test this, but if I run `./configure --with-system-sqlite=no`, then without this branch Python gets built, while with it, the system Python 3 is used.



---

archive/issue_comments_487475.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2020-10-16T22:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487475",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_418197.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-10-16T22:08:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418197"
}
```



---

archive/issue_events_418198.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-10-16T22:08:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418198"
}
```



---

archive/issue_comments_487476.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThanks!",
    "created_at": "2020-10-17T21:57:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487476",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

Thanks!



---

archive/issue_events_418199.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-10-25T09:50:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418199"
}
```



---

archive/issue_events_418200.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-10-25T09:50:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418200"
}
```



---

archive/issue_comments_487477.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n\n```\n[sagelib-9.2] [1/1] gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/home/release/Sage/build/pkgs/sagelib/src -I/usr/include/python3.8 -I/home/release/Sage/local/lib64/python3.8/site-packages/numpy/core/include -Ibuild/cythonized -I/home/release/Sage/local/include -I/usr/include/python3.8 -c build/cythonized/sage/misc/sage_ostools.c -o build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99\n[sagelib-9.2] gcc -pthread -shared -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-rpath-link,/home/release/Sage/local/lib -L/home/release/Sage/local/lib -Wl,-rpath,/home/release/Sage/local/lib build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -L/usr/lib64 -lsqlite3 -o build/lib.linux-x86_64-3.8/sage/misc/sage_ostools.cpython-38-x86_64-linux-gnu.so\n[sagelib-9.2] /usr/bin/ld: cannot find -lsqlite3\n[sagelib-9.2] collect2: error: ld returned 1 exit status\n[sagelib-9.2] error: command 'gcc' failed with exit status 1\n```\nNote: there is no libsqlite3.so and I don't have sqlite3-devel installed\n\n```\n$ ll /usr/lib64/libsqlite3*\nlrwxrwxrwx. 1 root root      19 Oct 11 10:30 /usr/lib64/libsqlite3.so.0 -> libsqlite3.so.0.8.6\n-rwxr-xr-x. 1 root root 1280944 Oct 11 10:30 /usr/lib64/libsqlite3.so.0.8.6\n```",
    "created_at": "2020-10-25T09:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487477",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>


```
[sagelib-9.2] [1/1] gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/home/release/Sage/build/pkgs/sagelib/src -I/usr/include/python3.8 -I/home/release/Sage/local/lib64/python3.8/site-packages/numpy/core/include -Ibuild/cythonized -I/home/release/Sage/local/include -I/usr/include/python3.8 -c build/cythonized/sage/misc/sage_ostools.c -o build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99
[sagelib-9.2] gcc -pthread -shared -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-z,relro -Wl,--as-needed -Wl,-z,now -g -Wl,-rpath-link,/home/release/Sage/local/lib -L/home/release/Sage/local/lib -Wl,-rpath,/home/release/Sage/local/lib build/temp.linux-x86_64-3.8/build/cythonized/sage/misc/sage_ostools.o -L/usr/lib64 -lsqlite3 -o build/lib.linux-x86_64-3.8/sage/misc/sage_ostools.cpython-38-x86_64-linux-gnu.so
[sagelib-9.2] /usr/bin/ld: cannot find -lsqlite3
[sagelib-9.2] collect2: error: ld returned 1 exit status
[sagelib-9.2] error: command 'gcc' failed with exit status 1
```
Note: there is no libsqlite3.so and I don't have sqlite3-devel installed

```
$ ll /usr/lib64/libsqlite3*
lrwxrwxrwx. 1 root root      19 Oct 11 10:30 /usr/lib64/libsqlite3.so.0 -> libsqlite3.so.0.8.6
-rwxr-xr-x. 1 root root 1280944 Oct 11 10:30 /usr/lib64/libsqlite3.so.0.8.6
```



---

archive/issue_comments_487478.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ca87428c17d63b6a32d1e2a4ec0e9a0ddd50e17\"><code>5ca8742</code></a></td><td><code>Merge tag '9.3.beta0' into t/30559/refine_python3_s_sage_spkg_depcheck</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec\"><code>08e3369</code></a></td><td><code>sage.misc.sage_ostools: Link to sqlite only on Cygwin</code></td></tr></table>\n",
    "created_at": "2020-11-02T21:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487478",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ca87428c17d63b6a32d1e2a4ec0e9a0ddd50e17"><code>5ca8742</code></a></td><td><code>Merge tag '9.3.beta0' into t/30559/refine_python3_s_sage_spkg_depcheck</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec"><code>08e3369</code></a></td><td><code>sage.misc.sage_ostools: Link to sqlite only on Cygwin</code></td></tr></table>




---

archive/issue_comments_487479.json:
```json
{
    "body": "Changed commit from **[`362f6c9`](https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8)** to **[`08e3369`](https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec)**",
    "created_at": "2020-11-02T21:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487479",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`362f6c9`](https://github.com/sagemath/sagetrac-mirror/commit/362f6c96c5cec54d25a3ffc230b23212d651bcc8)** to **[`08e3369`](https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec)**



---

archive/issue_events_418201.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-02T21:37:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418201"
}
```



---

archive/issue_events_418202.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-02T21:37:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418202"
}
```



---

archive/issue_comments_487480.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nthis seems to need testing on Cygwin",
    "created_at": "2020-11-11T10:36:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487480",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

this seems to need testing on Cygwin



---

archive/issue_comments_487481.json:
```json
{
    "body": "Changed commit from **[`08e3369`](https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec)** to **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**",
    "created_at": "2020-11-11T17:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487481",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`08e3369`](https://github.com/sagemath/sagetrac-mirror/commit/08e336912b15b2e76c5441a40e31f278e24275ec)** to **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**



---

archive/issue_comments_487482.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c\"><code>4731840</code></a></td><td><code>Merge tag '9.3.beta1' into t/30559/refine_python3_s_sage_spkg_depcheck</code></td></tr></table>\n",
    "created_at": "2020-11-11T17:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487482",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c"><code>4731840</code></a></td><td><code>Merge tag '9.3.beta1' into t/30559/refine_python3_s_sage_spkg_depcheck</code></td></tr></table>




---

archive/issue_comments_487483.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nCygwin test now running at https://github.com/mkoeppe/sage/actions/runs/358167921",
    "created_at": "2020-11-11T17:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487483",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Cygwin test now running at https://github.com/mkoeppe/sage/actions/runs/358167921



---

archive/issue_comments_487484.json:
```json
{
    "body": "Changed reviewer from **John Palmieri** to **John Palmieri, https://github.com/mkoeppe/sage/actions/runs/358167921**",
    "created_at": "2020-11-11T17:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487484",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **John Palmieri** to **John Palmieri, https://github.com/mkoeppe/sage/actions/runs/358167921**



---

archive/issue_comments_487485.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nThe Cygwin tests look okay to me. Shall we merge it?",
    "created_at": "2020-11-22T20:55:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487485",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

The Cygwin tests look okay to me. Shall we merge it?



---

archive/issue_comments_487486.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI haven't yet seen a Cygwin test to proceed to actually running Sage because of the general fragility of the multi-stage GH actions (I restarted the workflow several times...). But I think we can proceed anyway, it should not hold up this improvement.",
    "created_at": "2020-11-22T20:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487486",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

I haven't yet seen a Cygwin test to proceed to actually running Sage because of the general fragility of the multi-stage GH actions (I restarted the workflow several times...). But I think we can proceed anyway, it should not hold up this improvement.



---

archive/issue_comments_487487.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOkay, let's try again, then.",
    "created_at": "2020-11-22T22:54:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487487",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

Okay, let's try again, then.



---

archive/issue_events_418203.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-11-22T22:54:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418203"
}
```



---

archive/issue_events_418204.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-11-22T22:54:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418204"
}
```



---

archive/issue_comments_487488.json:
```json
{
    "body": "Changed reviewer from **John Palmieri, https://github.com/mkoeppe/sage/actions/runs/358167921** to **John Palmieri**",
    "created_at": "2020-11-22T22:54:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487488",
    "user": "https://github.com/jhpalmieri"
}
```

Changed reviewer from **John Palmieri, https://github.com/mkoeppe/sage/actions/runs/358167921** to **John Palmieri**



---

archive/issue_comments_487489.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThanks!",
    "created_at": "2020-11-22T23:00:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487489",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Thanks!



---

archive/issue_comments_487490.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -51,21 +51,7 @@\n build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n ```\n \n-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  \n-\n-```\n-$ grep xz build/pkgs/*/dependencies\n-build/pkgs/cmake/dependencies:curl zlib bzip2 xz\n-build/pkgs/gcc/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz\n-build/pkgs/gdb/dependencies:mpfr zlib ncurses $(PYTHON) xz\n-build/pkgs/gfortran/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz\n-build/pkgs/p_group_cohomology/dependencies:$(PYTHON)... | $(PYTHON_TOOLCHAIN) matplotlib gap xz $(SAGERUNTIME) ipywidgets\n-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n-build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n-```\n-In this list, `cmake`, `r`, `python3` all depend on `liblzma`. \n-The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file` - when `sage-bootstrap-python` is < 3.3 - see https://docs.python.org/3/library/tarfile.html) and have nothing to do with the shared library.\n-\n+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  #30948\n \n **Package `libffi`**....\n \n``````\n",
    "created_at": "2020-11-22T23:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487490",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -51,21 +51,7 @@
 build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
 ```
 
-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  
-
-```
-$ grep xz build/pkgs/*/dependencies
-build/pkgs/cmake/dependencies:curl zlib bzip2 xz
-build/pkgs/gcc/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz
-build/pkgs/gdb/dependencies:mpfr zlib ncurses $(PYTHON) xz
-build/pkgs/gfortran/dependencies:| $(MP_LIBRARY) mpfr mpc zlib xz
-build/pkgs/p_group_cohomology/dependencies:$(PYTHON)... | $(PYTHON_TOOLCHAIN) matplotlib gap xz $(SAGERUNTIME) ipywidgets
-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
-build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
-```
-In this list, `cmake`, `r`, `python3` all depend on `liblzma`. 
-The others are merely build-time dependencies on the `xz` binary (for unpacking the tarball in `sage_bootstrap.uncompress.tar_file` - when `sage-bootstrap-python` is < 3.3 - see https://docs.python.org/3/library/tarfile.html) and have nothing to do with the shared library.
-
+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  #30948
 
 **Package `libffi`**....
 
``````




---

archive/issue_comments_487491.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,44 +22,9 @@\n ---\n \n Follow-up tickets may address the following dependencies:\n-\n-**Package `libpng`**.....\n-\n-```\n-$ grep libpng build/pkgs/*/dependencies\n-build/pkgs/brial/dependencies:boost_cropped m4ri libpng | pkgconf\n-build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped\n-build/pkgs/freetype/dependencies:libpng bzip2\n-build/pkgs/giac/dependencies:readline libpng $(MP_LIBRARY) mpfr mpfi ntl gsl pari glpk curl\n-build/pkgs/libgd/dependencies:libpng freetype\n-build/pkgs/libtheora/dependencies:libogg libpng\n-build/pkgs/m4ri/dependencies:libpng\n-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n-build/pkgs/sagelib/dependencies:FORCE $(SCRIPTS) arb boost_cropped $(BLAS) brial cliquer cypari cysignals cython ecl eclib ecm flint libgd gap givaro glpk gmpy2 gsl iml jinja2 jupyter_core lcalc lrcalc libbraiding libhomfly libpng linbox m4ri m4rie mpc mpfi mpfr $(MP_LIBRARY) ntl numpy pari pip pkgconfig planarity ppl pplpy pycygwin pynac $(PYTHON) ratpoints readline rw sage_conf singular symmetrica zn_poly $(PCFILES)\n-build/pkgs/tachyon/dependencies:libpng\n-```\n-\n-**Package `bzip2`**......\n-\n-```\n-$ grep bzip2 build/pkgs/*/dependencies\n-build/pkgs/cbc/dependencies:readline zlib bzip2 $(BLAS)\n-build/pkgs/cmake/dependencies:curl zlib bzip2 xz\n-build/pkgs/freetype/dependencies:libpng bzip2\n-build/pkgs/pcre/dependencies:bzip2\n-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n-build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf\n-```\n-\n-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  #30948\n-\n-**Package `libffi`**....\n-\n-```\n-$ grep libffi build/pkgs/*/dependencies\n-build/pkgs/ecl/dependencies:$(MP_LIBRARY) readline gc libffi\n-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi\n-```\n+- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi \n+- #30948\n+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  \n \n See also:\n - #28019 If system mpir is found, yasm should not be built\n``````\n",
    "created_at": "2020-11-22T23:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487491",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,44 +22,9 @@
 ---
 
 Follow-up tickets may address the following dependencies:
-
-**Package `libpng`**.....
-
-```
-$ grep libpng build/pkgs/*/dependencies
-build/pkgs/brial/dependencies:boost_cropped m4ri libpng | pkgconf
-build/pkgs/cryptominisat/dependencies:$(PYTHON) m4ri zlib libpng | cmake sqlite boost_cropped
-build/pkgs/freetype/dependencies:libpng bzip2
-build/pkgs/giac/dependencies:readline libpng $(MP_LIBRARY) mpfr mpfi ntl gsl pari glpk curl
-build/pkgs/libgd/dependencies:libpng freetype
-build/pkgs/libtheora/dependencies:libogg libpng
-build/pkgs/m4ri/dependencies:libpng
-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
-build/pkgs/sagelib/dependencies:FORCE $(SCRIPTS) arb boost_cropped $(BLAS) brial cliquer cypari cysignals cython ecl eclib ecm flint libgd gap givaro glpk gmpy2 gsl iml jinja2 jupyter_core lcalc lrcalc libbraiding libhomfly libpng linbox m4ri m4rie mpc mpfi mpfr $(MP_LIBRARY) ntl numpy pari pip pkgconfig planarity ppl pplpy pycygwin pynac $(PYTHON) ratpoints readline rw sage_conf singular symmetrica zn_poly $(PCFILES)
-build/pkgs/tachyon/dependencies:libpng
-```
-
-**Package `bzip2`**......
-
-```
-$ grep bzip2 build/pkgs/*/dependencies
-build/pkgs/cbc/dependencies:readline zlib bzip2 $(BLAS)
-build/pkgs/cmake/dependencies:curl zlib bzip2 xz
-build/pkgs/freetype/dependencies:libpng bzip2
-build/pkgs/pcre/dependencies:bzip2
-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
-build/pkgs/r/dependencies:$(BLAS) gfortran iconv readline bzip2 xz pcre curl | pkgconf
-```
-
-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  #30948
-
-**Package `libffi`**....
-
-```
-$ grep libffi build/pkgs/*/dependencies
-build/pkgs/ecl/dependencies:$(MP_LIBRARY) readline gc libffi
-build/pkgs/python3/dependencies:zlib readline sqlite libpng bzip2 xz libffi
-```
+- #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi 
+- #30948
+**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  
 
 See also:
 - #28019 If system mpir is found, yasm should not be built
``````




---

archive/issue_comments_487492.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,8 +23,7 @@\n \n Follow-up tickets may address the following dependencies:\n - #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi \n-- #30948\n-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  \n+- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  \n \n See also:\n - #28019 If system mpir is found, yasm should not be built\n``````\n",
    "created_at": "2020-11-22T23:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487492",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,8 +23,7 @@
 
 Follow-up tickets may address the following dependencies:
 - #30949 Refine python3's `SAGE_SPKG_DEPCHECK`: libpng, bzip2, xz, libffi 
-- #30948
-**Package `xz`** represents both the shared library `liblzma` and the `xz` binary.  
+- #30948 Package `xz` represents both the shared library `liblzma` and the `xz` binary.  
 
 See also:
 - #28019 If system mpir is found, yasm should not be built
``````




---

archive/issue_comments_487493.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/refine_python3_s_sage_spkg_depcheck](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refine_python3_s_sage_spkg_depcheck)** to **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**",
    "created_at": "2020-11-29T11:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487493",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/refine_python3_s_sage_spkg_depcheck](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/refine_python3_s_sage_spkg_depcheck)** to **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)**



---

archive/issue_events_418205.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-29T11:58:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418205"
}
```



---

archive/issue_events_418206.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "97c6b930bd9b5e12d21ba23d1b95fc1d4593753b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-11-29T11:58:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/30559#event-418206"
}
```



---

archive/issue_comments_487494.json:
```json
{
    "body": "Changed commit from **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)** to none",
    "created_at": "2023-01-08T08:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/30559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/30559#issuecomment-487494",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`4731840`](https://github.com/sagemath/sagetrac-mirror/commit/4731840945a8598cbc97367e2b4ad60e6d9c6c7c)** to none
