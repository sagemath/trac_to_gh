# Issue 30237: Make .coxeter_matrix() return a CoxeterMatrix for coxeter3-implemented groups

archive/issues_030000.json:
```json
{
    "body": "This patch fixes all of the following, which currently throw errors:\n\n```python\nW = CoxeterGroup(['B', 3], implementation='coxeter3')\nW.coxeter_type()\n# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'\nW([1,2,1]).reduced_words()\n# IndexError: matrix index out of range\nR.<v> = LaurentPolynomialRing(ZZ)\nIwahoriHeckeAlgebra(W, v, -1/v)\n# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'\n```\n\nThe underlying problem in all cases is that `W.coxeter_matrix()` does not return a `CoxeterMatrix`; I've altered this to return the (correctly indexed) coxeter matrix and added a test.\n\nThis also removes a completely unused function `CoxeterGroup.m(i, j)` which seemingly existed only to workaround the fact that `.coxeter_matrix()` was incorrectly indexed (and in fact is ill-founded, it would cause an error on a group with affine Cartan type). This removal breaks no tests in `libs/coxeter3`.\n\nKeywords: CoxeterGroup,CoxeterMatrix,coxeter,coxeter3\n\nBranch/Commit: bd9b5c661d13f4c37a7c72430603b3ce92f0b5d2\n\nReviewer: Travis Scrimshaw\n\nAuthor: Chase Meadors\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30237\n\n",
    "closed_at": "2020-08-10T18:49:53Z",
    "created_at": "2020-07-28T06:45:29Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Make .coxeter_matrix() return a CoxeterMatrix for coxeter3-implemented groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30237",
    "user": "https://github.com/cemulate"
}
```
This patch fixes all of the following, which currently throw errors:

```python
W = CoxeterGroup(['B', 3], implementation='coxeter3')
W.coxeter_type()
# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'
W([1,2,1]).reduced_words()
# IndexError: matrix index out of range
R.<v> = LaurentPolynomialRing(ZZ)
IwahoriHeckeAlgebra(W, v, -1/v)
# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'
```

The underlying problem in all cases is that `W.coxeter_matrix()` does not return a `CoxeterMatrix`; I've altered this to return the (correctly indexed) coxeter matrix and added a test.

This also removes a completely unused function `CoxeterGroup.m(i, j)` which seemingly existed only to workaround the fact that `.coxeter_matrix()` was incorrectly indexed (and in fact is ill-founded, it would cause an error on a group with affine Cartan type). This removal breaks no tests in `libs/coxeter3`.

Keywords: CoxeterGroup,CoxeterMatrix,coxeter,coxeter3

Branch/Commit: bd9b5c661d13f4c37a7c72430603b3ce92f0b5d2

Reviewer: Travis Scrimshaw

Author: Chase Meadors

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30237





---

archive/issue_comments_454535.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-07-28T10:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_454536.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,19 @@\n+This patch fixes all of the following, which currently throw errors:\n \n+```python\n+W = CoxeterGroup(['B', 3], implementation='coxeter3')\n+W.coxeter_type()\n+# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'\n+W([1,2,1]).reduced_words()\n+# IndexError: matrix index out of range\n+R.<v> = LaurentPolynomialRing(ZZ)\n+IwahoriHeckeAlgebra(W, v, -1/v)\n+# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'\n+```\n+\n+The underlying problem in all cases is that `W.coxeter_matrix()` does not return a `CoxeterMatrix`; I've altered this to return the (correctly indexed) coxeter matrix and added a test.\n+\n+This also removes a completely unused function `CoxeterGroup.m(i, j)` which seemingly existed only to workaround the fact that `.coxeter_matrix()` was incorrectly indexed (and in fact is ill-founded, it would cause an error on a group with affine Cartan type). This removal breaks no tests in `libs/coxeter3`.\n \n Comment: 1\n \n```\n",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454536",
    "user": "https://github.com/cemulate"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,19 @@
+This patch fixes all of the following, which currently throw errors:
 
+```python
+W = CoxeterGroup(['B', 3], implementation='coxeter3')
+W.coxeter_type()
+# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'
+W([1,2,1]).reduced_words()
+# IndexError: matrix index out of range
+R.<v> = LaurentPolynomialRing(ZZ)
+IwahoriHeckeAlgebra(W, v, -1/v)
+# AttributeError: 'sage.matrix.matrix_integer_dense.Matrix_integer_dense' object has no attribute 'coxeter_type'
+```
+
+The underlying problem in all cases is that `W.coxeter_matrix()` does not return a `CoxeterMatrix`; I've altered this to return the (correctly indexed) coxeter matrix and added a test.
+
+This also removes a completely unused function `CoxeterGroup.m(i, j)` which seemingly existed only to workaround the fact that `.coxeter_matrix()` was incorrectly indexed (and in fact is ill-founded, it would cause an error on a group with affine Cartan type). This removal breaks no tests in `libs/coxeter3`.
 
 Comment: 1
 
```




---

archive/issue_comments_454537.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454537",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_454538.json:
```json
{
    "body": "Changing keywords from \"\" to \"CoxeterGroup,CoxeterMatrix,coxeter,coxeter3\".",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454538",
    "user": "https://github.com/cemulate"
}
```

Changing keywords from "" to "CoxeterGroup,CoxeterMatrix,coxeter,coxeter3".



---

archive/issue_comments_454539.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454539",
    "user": "https://github.com/cemulate"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_454540.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454540",
    "user": "https://github.com/cemulate"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_454541.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454541",
    "user": "https://github.com/cemulate"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454542.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2020-07-28T10:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454542",
    "user": "https://github.com/cemulate"
}
```

Changing priority from major to minor.



---

archive/issue_comments_454543.json:
```json
{
    "body": "<a id='comment:4'></a>The `m()` method might not be used in the code, but some user might be using it in their personal code. You should issue a deprecation instead with the appropriate redirect:\n\n```python\nfrom sage.misc.superseded import deprecation\ndeprecation(30237, \"the .m(i, j) method has been deprecated; instead use .coxeter_matrix()[i,j]\")\n```\nor whatever message is appropriate.\n\nOther than that, LGTM.",
    "created_at": "2020-07-30T00:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454543",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>The `m()` method might not be used in the code, but some user might be using it in their personal code. You should issue a deprecation instead with the appropriate redirect:

```python
from sage.misc.superseded import deprecation
deprecation(30237, "the .m(i, j) method has been deprecated; instead use .coxeter_matrix()[i,j]")
```
or whatever message is appropriate.

Other than that, LGTM.



---

archive/issue_comments_454544.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-30T19:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454544",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454545.json:
```json
{
    "body": "<a id='comment:6'></a>Done.",
    "created_at": "2020-07-30T19:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454545",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:6'></a>Done.



---

archive/issue_comments_454546.json:
```json
{
    "body": "<a id='comment:7'></a>It needs to be doctested with a docstring as well.",
    "created_at": "2020-07-30T23:34:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454546",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>It needs to be doctested with a docstring as well.



---

archive/issue_comments_454547.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-30T23:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454547",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454548.json:
```json
{
    "body": "<a id='comment:9'></a>Ah, sorry, wasn't sure if that needed to be done in this case. It's there now.",
    "created_at": "2020-07-30T23:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454548",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:9'></a>Ah, sorry, wasn't sure if that needed to be done in this case. It's there now.



---

archive/issue_comments_454549.json:
```json
{
    "body": "<a id='comment:10'></a>Can you quickly add a docstring just saying `This is deprecated, use ``self.coxeter_matrix()[i,j]`` instead.`?",
    "created_at": "2020-07-30T23:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454549",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Can you quickly add a docstring just saying `This is deprecated, use ``self.coxeter_matrix()[i,j]`` instead.`?



---

archive/issue_comments_454550.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-30T23:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454551.json:
```json
{
    "body": "<a id='comment:12'></a>Done.",
    "created_at": "2020-07-30T23:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454551",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:12'></a>Done.



---

archive/issue_comments_454552.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-30T23:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454553.json:
```json
{
    "body": "<a id='comment:14'></a>Sorry, one last thing. It needs to actually have the same result/behavior as before.",
    "created_at": "2020-07-30T23:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454553",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>Sorry, one last thing. It needs to actually have the same result/behavior as before.



---

archive/issue_comments_454554.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T00:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454554",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454555.json:
```json
{
    "body": "<a id='comment:16'></a>I hope I understood correctly; I made it have the same behavior as before by \"fixing\" it; should it instead have the same *implementation* as before (which would cause the old doctests to throw errors)? Thanks for guiding me through the protocol here, by the way.",
    "created_at": "2020-07-31T00:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454555",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:16'></a>I hope I understood correctly; I made it have the same behavior as before by "fixing" it; should it instead have the same *implementation* as before (which would cause the old doctests to throw errors)? Thanks for guiding me through the protocol here, by the way.



---

archive/issue_comments_454556.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-31T07:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454556",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454557.json:
```json
{
    "body": "<a id='comment:17'></a>Perfect, thank you.",
    "created_at": "2020-07-31T07:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454557",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>Perfect, thank you.



---

archive/issue_comments_454558.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-10T18:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30237#issuecomment-454558",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_078152.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-10T18:49:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30237",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30237#event-78152"
}
```
