# Issue 30404: Add pyright and pycodestyle checks as Github actions

archive/issues_030167.json:
```json
{
    "body": "Currently, the linters (pycodestyle, pyflakes, ...) run as plugins of patchbot. This has a few disadvantages: a) the lint results depend on the version of the tools installed by the owner of the patchbot b) it takes quite some time until the results are available and c) you need people to run the patchbot.\n\nThis ticket adds pyright, relint and pycodestyle checks as Github actions. They run really fast (about 2min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.\n\nAlthough only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.\n\nWhat is left to do is to add the integration of the github action output to trac - #30877\n\nCC:  @saraedum @mkoeppe @fchapoton @mjungmath @embray @slel @dimpase\n\nKeywords: code style, lint\n\nBranch/Commit: 51828da28a18b1c0d161f09a91417abd9f652088\n\nReviewer: Matthias Koeppe\n\nAuthor: Tobias Diez\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/30404\n\n",
    "closed_at": "2020-11-20T22:15:09Z",
    "created_at": "2020-08-20T11:33:38Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Add pyright and pycodestyle checks as Github actions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30404",
    "user": "https://github.com/tobiasdiez"
}
```
Currently, the linters (pycodestyle, pyflakes, ...) run as plugins of patchbot. This has a few disadvantages: a) the lint results depend on the version of the tools installed by the owner of the patchbot b) it takes quite some time until the results are available and c) you need people to run the patchbot.

This ticket adds pyright, relint and pycodestyle checks as Github actions. They run really fast (about 2min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.

Although only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.

What is left to do is to add the integration of the github action output to trac - #30877

CC:  @saraedum @mkoeppe @fchapoton @mjungmath @embray @slel @dimpase

Keywords: code style, lint

Branch/Commit: 51828da28a18b1c0d161f09a91417abd9f652088

Reviewer: Matthias Koeppe

Author: Tobias Diez

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/30404





---

archive/issue_comments_600157.json:
```json
{
    "body": "<a id='comment:1'></a>Option A: I think this is politically impossible. I know that some of the contributors here have (or at least had) strong feelings about github. That likely did not improve with Microsoft buying them.\n\nOption B*: Every branch here is already mirrored on [GitLab](GitLab). I believe what's missing here is better docs: https://gitlab.com/sagemath/dev/trac\n\nOption C*: You could add the linter to [GitLab](GitLab) CI. If I remember embray's comments correctly it's really easy to write a trac plugin that shows the gitlab CI status here on trac.",
    "created_at": "2020-08-20T11:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600157",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:1'></a>Option A: I think this is politically impossible. I know that some of the contributors here have (or at least had) strong feelings about github. That likely did not improve with Microsoft buying them.

Option B*: Every branch here is already mirrored on [GitLab](GitLab). I believe what's missing here is better docs: https://gitlab.com/sagemath/dev/trac

Option C*: You could add the linter to [GitLab](GitLab) CI. If I remember embray's comments correctly it's really easy to write a trac plugin that shows the gitlab CI status here on trac.



---

archive/issue_comments_600158.json:
```json
{
    "body": "<a id='comment:2'></a>Note there's also https://github.com/sagemath/sagetrac-mirror - but I don't know at what intervals it is mirrored.",
    "created_at": "2020-08-20T12:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600158",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Note there's also https://github.com/sagemath/sagetrac-mirror - but I don't know at what intervals it is mirrored.



---

archive/issue_comments_600159.json:
```json
{
    "body": "<a id='comment:3'></a>Perfect `@`mkoeppe! In this case, the integration should be fairly straightforward and amounts to adding the adding a link to the badge, by\n\n\n```\n<a href=\"https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH\"><img src=\"https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push\"/></a>\n```\n\n\nGiving something similar to\n\n![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)\n\nwith a link to https://github.com/tobiasdiez/sage/actions?query=workflow%3ALint+branch%3Apatch-2\n(its sadly not possible to directly link to the workflow output)\n\nThis leaves the following todo list:\n- Restrict current github actions to master and develop branch\n- Activate gitub actions in sagetrac-mirror\n- Add the link to the badge to trac\n\nI can do the first task. Could somebody else then do point 2 and 3?",
    "created_at": "2020-08-20T13:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600159",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'></a>Perfect `@`mkoeppe! In this case, the integration should be fairly straightforward and amounts to adding the adding a link to the badge, by


```
<a href="https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH"><img src="https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push"/></a>
```


Giving something similar to

![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)

with a link to https://github.com/tobiasdiez/sage/actions?query=workflow%3ALint+branch%3Apatch-2
(its sadly not possible to directly link to the workflow output)

This leaves the following todo list:
- Restrict current github actions to master and develop branch
- Activate gitub actions in sagetrac-mirror
- Add the link to the badge to trac

I can do the first task. Could somebody else then do point 2 and 3?



---

archive/issue_comments_600160.json:
```json
{
    "body": "<a id='comment:5'></a>My suggestion is to first focus on local operation. For example, finding a place for the  pycodestyle configuration in the Sage source tree (this should not be configured in  `.github/workflows/`, nor in the patchbot sources!) -- perhaps this should go to `src/tox.ini`, and then provide corresponding documentation on how to run it and why. Next, change the patchbot so that it uses the configuration from that file. This will make sure that things don't fall out of sync.",
    "created_at": "2020-08-20T13:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600160",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>My suggestion is to first focus on local operation. For example, finding a place for the  pycodestyle configuration in the Sage source tree (this should not be configured in  `.github/workflows/`, nor in the patchbot sources!) -- perhaps this should go to `src/tox.ini`, and then provide corresponding documentation on how to run it and why. Next, change the patchbot so that it uses the configuration from that file. This will make sure that things don't fall out of sync.



---

archive/issue_comments_600161.json:
```json
{
    "body": "Changing keywords from \"\" to \"code style, lint\".",
    "created_at": "2020-08-20T14:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600161",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "code style, lint".



---

archive/issue_comments_600162.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-08-20T14:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600162",
    "user": "https://github.com/slel"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_600163.json:
```json
{
    "body": "<a id='comment:7'></a>Moving the config to src/tox.ini is done in #30408.\n\nShould I continue with the above plan and restrict the current github workflows to the master & develop branch?",
    "created_at": "2020-08-20T18:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600163",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:7'></a>Moving the config to src/tox.ini is done in #30408.

Should I continue with the above plan and restrict the current github workflows to the master & develop branch?



---

archive/issue_comments_600164.json:
```json
{
    "body": "<a id='comment:8'></a>Take a look at the other workflows from my portability tests. They are configured to run on every push to a tag and on every pull request. That's I think also the right granularity for the new workflow",
    "created_at": "2020-08-21T00:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600164",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Take a look at the other workflows from my portability tests. They are configured to run on every push to a tag and on every pull request. That's I think also the right granularity for the new workflow



---

archive/issue_comments_600165.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [gh-tobiasdiez](#comment%3A7):\n> Moving the config to src/tox.ini is done in #30408.\n\n\nYou could make #30408 a dependency of this ticket & merge in the branch",
    "created_at": "2020-08-21T00:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600165",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Replying to [gh-tobiasdiez](#comment%3A7):
> Moving the config to src/tox.ini is done in #30408.


You could make #30408 a dependency of this ticket & merge in the branch



---

archive/issue_comments_600166.json:
```json
{
    "body": "Changing branch from \"\" to \"public/build/lintGithub\"",
    "created_at": "2020-08-22T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600166",
    "user": "https://github.com/tobiasdiez"
}
```

Changing branch from "" to "public/build/lintGithub"



---

archive/issue_comments_600167.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-22T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600167",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_600168.json:
```json
{
    "body": "<a id='comment:10'></a>I've now changed the workflow to use tox, which is enabled by #30408. Moreover, I realized based on the above comment by mkoeppe that the other Github actions are already restricted to only run on pushes with tags. Thus, they don't run on normal pushes to sagetrac-mirror, so no further action needed there.\n\n\n\n\n> They are configured to run on every push to a tag and on every pull request. That's I think also the right granularity for the new workflow\n\n\nI think the lint workflow should run on every push and pull request. In this way, the developer gets immediate feedback, and this is similar to the patchbot that also runs on every \"push\".\nMoreover, they run very quickly so there is no problem in running them on every push.\n\nSo this leaves the following todo's.\n- Peer-review this ticket\n- Activate gitub actions in sagetrac-mirror\n- Merge the dependencies #30408, #30361\n- Double check that the workflow runs successful on sagetrac-mirror\n- Merge\n- Add the link to the badge to trac as described above\n\nAfterwards, the workflow can be extended to include further linters. It might also be good to later add a basic build & doctest workflow that runs on every push.\n\n---\nNew commits:",
    "created_at": "2020-08-22T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600168",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:10'></a>I've now changed the workflow to use tox, which is enabled by #30408. Moreover, I realized based on the above comment by mkoeppe that the other Github actions are already restricted to only run on pushes with tags. Thus, they don't run on normal pushes to sagetrac-mirror, so no further action needed there.




> They are configured to run on every push to a tag and on every pull request. That's I think also the right granularity for the new workflow


I think the lint workflow should run on every push and pull request. In this way, the developer gets immediate feedback, and this is similar to the patchbot that also runs on every "push".
Moreover, they run very quickly so there is no problem in running them on every push.

So this leaves the following todo's.
- Peer-review this ticket
- Activate gitub actions in sagetrac-mirror
- Merge the dependencies #30408, #30361
- Double check that the workflow runs successful on sagetrac-mirror
- Merge
- Add the link to the badge to trac as described above

Afterwards, the workflow can be extended to include further linters. It might also be good to later add a basic build & doctest workflow that runs on every push.

---
New commits:



---

archive/issue_comments_600169.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30408, #30361\"",
    "created_at": "2020-08-22T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600169",
    "user": "https://github.com/tobiasdiez"
}
```

Changing dependencies from "" to "#30408, #30361"



---

archive/issue_comments_600170.json:
```json
{
    "body": "Changing commit from \"\" to \"2e88f614ec248e40ef76d76b61231f3c5f76af74\"",
    "created_at": "2020-08-22T11:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600170",
    "user": "https://github.com/tobiasdiez"
}
```

Changing commit from "" to "2e88f614ec248e40ef76d76b61231f3c5f76af74"



---

archive/issue_comments_600171.json:
```json
{
    "body": "Changing work_issues from \"\" to \"merge dependencies\"",
    "created_at": "2020-09-05T18:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600171",
    "user": "https://github.com/mkoeppe"
}
```

Changing work_issues from "" to "merge dependencies"



---

archive/issue_comments_600172.json:
```json
{
    "body": "Changing author from \"\" to \"Tobias Diez\"",
    "created_at": "2020-09-05T18:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600172",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Tobias Diez"



---

archive/issue_comments_600173.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-09-05T18:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600173",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_600174.json:
```json
{
    "body": "<a id='comment:12'></a>`@`mkoeppe, what should I do here? The dependencies are rather indirect (it works without #30361, it just tests more code). Moreover, this github action is currently nowhere invoked and hence not checked / tested....",
    "created_at": "2020-09-05T20:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600174",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:12'></a>`@`mkoeppe, what should I do here? The dependencies are rather indirect (it works without #30361, it just tests more code). Moreover, this github action is currently nowhere invoked and hence not checked / tested....



---

archive/issue_comments_600175.json:
```json
{
    "body": "<a id='comment:13'></a>Ticket description: \"The pyright check currently fails, as there is no configuration file\"",
    "created_at": "2020-09-05T20:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600175",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Ticket description: "The pyright check currently fails, as there is no configuration file"



---

archive/issue_comments_600176.json:
```json
{
    "body": "<a id='comment:14'></a>Yes, but even with the configuration files added the github workflow fails as there is no typing information yet(and the one added in #29775 is not complete) and pycodestyle reports over 600 errors as well.\n\nFixing these points requires more effort from the whole sage community.\n\nThe aim of this ticket is to add the github actions so that one has a consistent check, which at some point in the future hopefully turns green.",
    "created_at": "2020-09-06T11:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600176",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:14'></a>Yes, but even with the configuration files added the github workflow fails as there is no typing information yet(and the one added in #29775 is not complete) and pycodestyle reports over 600 errors as well.

Fixing these points requires more effort from the whole sage community.

The aim of this ticket is to add the github actions so that one has a consistent check, which at some point in the future hopefully turns green.



---

archive/issue_comments_600177.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-09-06T11:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600177",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_600178.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-09-18T21:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600178",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_600179.json:
```json
{
    "body": "<a id='comment:15'></a>Should invoke relint as well (added in #30467).",
    "created_at": "2020-09-18T21:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600179",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:15'></a>Should invoke relint as well (added in #30467).



---

archive/issue_comments_600180.json:
```json
{
    "body": "<a id='comment:16'></a>Could just run all tox environments...",
    "created_at": "2020-09-18T21:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600180",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Could just run all tox environments...



---

archive/issue_events_078843.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30404#event-78843"
}
```



---

archive/issue_comments_600181.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-08T14:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_600182.json:
```json
{
    "body": "Changing commit from \"2e88f614ec248e40ef76d76b61231f3c5f76af74\" to \"51828da28a18b1c0d161f09a91417abd9f652088\"",
    "created_at": "2020-11-08T14:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2e88f614ec248e40ef76d76b61231f3c5f76af74" to "51828da28a18b1c0d161f09a91417abd9f652088"



---

archive/issue_comments_600183.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-11-08T14:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600183",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_600184.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,20 @@\n Currently, the linters (pycodestyle, pyflakes, ...) run as plugins of patchbot. This has a few disadvantages: a) the lint results depend on the version of the tools installed by the owner of the patchbot b) it takes quite some time until the results are available and c) you need people to run the patchbot.\n \n-At https://github.com/sagemath/sage/pull/95 I added the pyright and pycodestyle checks as Github actions. They run really fast (about 10min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.\n+This ticket adds pyright, relint and pycodestyle checks as Github actions. They run really fast (about 2min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.\n \n-The pyright check currently fails, as there is no configuration file (which is added in #30361). The pycodestyle check also fails as there are currently over 600 errors that for some reason were missed by the patchbot (see https://github.com/tobiasdiez/sage/runs/1007221345?check_suite_focus=true) (I only activated those rules that are also run by the patchbot).\n+Although only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.\n \n-**Question 1:** What should be done about these errors?\n+What is left to do is to add the integration of the github action output to trac. That can be done as follows:\n+1. Sync trac branches to sagetrac-mirror (by post-commit hook)\n+2. Activate github actions in the sagetrac-mirror github repo\n+3. Add the following code to either the patchbot output or to the trac ticket header (next to the patchbot button)\n \n-**Question 2:** What is the best way apply the Github actions to new code contributions?\n+```\n+<a href=\"https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH\"><img src=\"https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push\"/></a>\n+```\n+Here BRANCH needs to be replaced by the branch.\n+Giving something similar to\n \n-*Option A:* Switch from trac to pull requests via Github (refs #30363)\n+![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)\n \n-*Option B:* Mirror every branch on trac to Github (it's not clear to me how to best integrate the results from the Github actions then here on trac; one option would be to use the Github API to create pull requests automatically for each trac ticket)\n-\n-*Option C:* Integrate the Github actions directly in the patchbot (how?)\n-\n+As this requires rights to the github repo and trac config, I cannot do this and have to leave it to somebody else.\n``````\n",
    "created_at": "2020-11-08T14:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600184",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,20 @@
 Currently, the linters (pycodestyle, pyflakes, ...) run as plugins of patchbot. This has a few disadvantages: a) the lint results depend on the version of the tools installed by the owner of the patchbot b) it takes quite some time until the results are available and c) you need people to run the patchbot.
 
-At https://github.com/sagemath/sage/pull/95 I added the pyright and pycodestyle checks as Github actions. They run really fast (about 10min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.
+This ticket adds pyright, relint and pycodestyle checks as Github actions. They run really fast (about 2min), have reliable results as the version of the linters can be controlled and uses Github server instead of people's machines.
 
-The pyright check currently fails, as there is no configuration file (which is added in #30361). The pycodestyle check also fails as there are currently over 600 errors that for some reason were missed by the patchbot (see https://github.com/tobiasdiez/sage/runs/1007221345?check_suite_focus=true) (I only activated those rules that are also run by the patchbot).
+Although only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.
 
-**Question 1:** What should be done about these errors?
+What is left to do is to add the integration of the github action output to trac. That can be done as follows:
+1. Sync trac branches to sagetrac-mirror (by post-commit hook)
+2. Activate github actions in the sagetrac-mirror github repo
+3. Add the following code to either the patchbot output or to the trac ticket header (next to the patchbot button)
 
-**Question 2:** What is the best way apply the Github actions to new code contributions?
+```
+<a href="https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH"><img src="https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push"/></a>
+```
+Here BRANCH needs to be replaced by the branch.
+Giving something similar to
 
-*Option A:* Switch from trac to pull requests via Github (refs #30363)
+![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)
 
-*Option B:* Mirror every branch on trac to Github (it's not clear to me how to best integrate the results from the Github actions then here on trac; one option would be to use the Github API to create pull requests automatically for each trac ticket)
-
-*Option C:* Integrate the Github actions directly in the patchbot (how?)
-
+As this requires rights to the github repo and trac config, I cannot do this and have to leave it to somebody else.
``````




---

archive/issue_comments_600185.json:
```json
{
    "body": "<a id='comment:19'></a>I've now added relint. This is now ready for review.",
    "created_at": "2020-11-08T14:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600185",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:19'></a>I've now added relint. This is now ready for review.



---

archive/issue_comments_600186.json:
```json
{
    "body": "Changing dependencies from \"#30408, #30361\" to \"\"",
    "created_at": "2020-11-09T04:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600186",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30408, #30361" to ""



---

archive/issue_comments_600187.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,17 +4,4 @@\n \n Although only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.\n \n-What is left to do is to add the integration of the github action output to trac. That can be done as follows:\n-1. Sync trac branches to sagetrac-mirror (by post-commit hook)\n-2. Activate github actions in the sagetrac-mirror github repo\n-3. Add the following code to either the patchbot output or to the trac ticket header (next to the patchbot button)\n-\n-```\n-<a href=\"https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH\"><img src=\"https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push\"/></a>\n-```\n-Here BRANCH needs to be replaced by the branch.\n-Giving something similar to\n-\n-![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)\n-\n-As this requires rights to the github repo and trac config, I cannot do this and have to leave it to somebody else.\n+What is left to do is to add the integration of the github action output to trac - #30877\n``````\n",
    "created_at": "2020-11-09T04:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600187",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,17 +4,4 @@
 
 Although only those rules are activated that are also run by the patchbot, the pycodestyle and relint checks currently fail with a lot of errors. See https://github.com/tobiasdiez/sage/actions/runs/352364668. Thus, making these tests pass requires more work by the sage community.
 
-What is left to do is to add the integration of the github action output to trac. That can be done as follows:
-1. Sync trac branches to sagetrac-mirror (by post-commit hook)
-2. Activate github actions in the sagetrac-mirror github repo
-3. Add the following code to either the patchbot output or to the trac ticket header (next to the patchbot button)
-
-```
-<a href="https://github.com/sagemath/sagetrac-mirror/actions?query=workflow%3ALint+branch%3BRANCH"><img src="https://github.com/sagemath/sagetrac-mirror/workflows/Lint/badge.svg?branch=BRANCH&event=push"/></a>
-```
-Here BRANCH needs to be replaced by the branch.
-Giving something similar to
-
-![](https://github.com/tobiasdiez/sage/workflows/Lint/badge.svg?branch=patch-2&event=push)
-
-As this requires rights to the github repo and trac config, I cannot do this and have to leave it to somebody else.
+What is left to do is to add the integration of the github action output to trac - #30877
``````




---

archive/issue_comments_600188.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-09T04:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600188",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_600189.json:
```json
{
    "body": "<a id='comment:20'></a>This seems to work well. \n\nI have moved the part of the ticket description that describes Trac integration to the new ticket #30877. But actually, given that the new push mirror for Trac ended up using GitLab instead of GitHub (see #30736), you should probably look into creating [GitLab](GitLab) pipelines for the same checks.",
    "created_at": "2020-11-09T04:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600189",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>This seems to work well. 

I have moved the part of the ticket description that describes Trac integration to the new ticket #30877. But actually, given that the new push mirror for Trac ended up using GitLab instead of GitHub (see #30736), you should probably look into creating [GitLab](GitLab) pipelines for the same checks.



---

archive/issue_comments_600190.json:
```json
{
    "body": "Changing work_issues from \"merge dependencies\" to \"\"",
    "created_at": "2020-11-09T04:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600190",
    "user": "https://github.com/mkoeppe"
}
```

Changing work_issues from "merge dependencies" to ""



---

archive/issue_comments_600191.json:
```json
{
    "body": "<a id='comment:21'></a>Thanks for the review!\n\nI think you can make a good argument to have both Gitlab as well as Github as push mirrors.",
    "created_at": "2020-11-09T11:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600191",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:21'></a>Thanks for the review!

I think you can make a good argument to have both Gitlab as well as Github as push mirrors.



---

archive/issue_comments_600192.json:
```json
{
    "body": "<a id='comment:22'></a>reviewer name missing",
    "created_at": "2020-11-09T14:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600192",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>reviewer name missing



---

archive/issue_comments_600193.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-11-09T16:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600193",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_600194.json:
```json
{
    "body": "Changing branch from \"public/build/lintGithub\" to \"51828da28a18b1c0d161f09a91417abd9f652088\"",
    "created_at": "2020-11-20T22:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600194",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/build/lintGithub" to "51828da28a18b1c0d161f09a91417abd9f652088"



---

archive/issue_comments_600195.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-20T22:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30404#issuecomment-600195",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_078844.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-20T22:15:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30404",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30404#event-78844"
}
```
