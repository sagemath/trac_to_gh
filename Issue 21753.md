# Issue 21753: "Rational" input issue for graphs.CompleteGraph

Issue created by migration from https://trac.sagemath.org/ticket/21990

Original creator: pelegm

Original creation time: 2016-11-29 09:27:34

Keywords: complete_graph

From reddit: https://www.reddit.com/r/sagemath/comments/4wr20g/rational_input_issue_for_graphscompletegraph/

The lines responsible to it:

```python
        if format is None and isinstance(data, (int, Integer)):
            format = 'int'
```


We can add something like this

```python
        if format is None and isinstance(data, Rational):
            if data.is_integer():
                data = Integer(data)
                format = 'int'
```

just before.

What do you think?


---

Comment by jdemeyer created at 2016-11-29 09:36:05

Honestly, I think this is not a bug. The behaviour of the function should depend on the input type, not on the input value. Therefore, if `graphs.CompleteGraph(5/2)` does not work, then `graphs.CompleteGraph(6/2)` should not work either.

In any case, if you think that rationals should work here, you should use `operator.index()` instead of special-casing `Rational`.


---

Comment by pelegm created at 2016-11-29 09:42:16

Ok, thanks for your feedback. Let's see if there are any other opinions, and if not, the release manager can probably close this ticket (should we mark it as invalid somehow in this case?)


---

Comment by pelegm created at 2016-11-29 09:43:15

One more thing: if we think that this is not a bug, perhaps we do want to have a more informative error message when one tries to construct a complete graph with a rational argument.


---

Comment by dcoudert created at 2016-11-29 18:34:09

Indeed it is confusing.

```
sage: 6/2
3
sage: graphs.CompleteGraph(6/2)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: This input cannot be turned into a graph
sage: graphs.CompleteGraph(6//2)
Complete graph: Graph on 3 vertices
```



---

Comment by jmantysalo created at 2016-11-29 19:43:38

But if `P=x^2+5` and `Q=x^2+4`, should `CompleteGraph(P-Q)` return the one-element graph? IMO no.

This is just the same thing. Sometimes division of integers happens to return a value that is an integer, but still of the type rational. Difference on polynomials may also be a value that is an integer.


---

Comment by jdemeyer created at 2016-11-29 20:02:40

I agree with jmantysalo here.


---

Comment by dcoudert created at 2016-11-29 21:14:45

You are right.


---

Comment by jmantysalo created at 2016-11-30 05:33:15

I think we have a common view here and suggest this to be closed as wontfix.

(Actually, I do not say that it is necessarily a good thing to have "type-based" checks. What is good is consistency. As we have decided to have types, then let it be so.

Maybe there could be some "common mistakes for [SageMath](SageMath) beginner" for things like this? `is_prime(4/2)` would be easiest example to explain.)


---

Comment by jmantysalo created at 2016-11-30 05:33:15

Changing status from new to needs_review.


---

Comment by pelegm created at 2016-11-30 11:34:01

> is_prime(4/2) would be easiest example to explain.) 

Well, this is very weird. This is somewhat related to Kleene's three-state logic. The question whether a given rational symbol, without any further assumptions, is an integer, should return "Unknown".  Similarly, the question whether a given rational symbol is prime should return unknown.  Therefore, it only makes sense that at least one example of an explicit rational number will be prime. 4/2 should definitely be such.

This is also the case in:
* Sympy
* Wolfram Alpha
* XCas

This is also discussed here: https://groups.google.com/forum/#!msg/sage-support/OcmTApLRi2s/HQgU0cTUAwAJ, and it seems like the conclusion is the change it.


---

Comment by vdelecroix created at 2016-12-23 23:09:14

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-21 18:03:11

Resolution: invalid
