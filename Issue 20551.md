# Issue 20551: Compute dimensions of individual generalized eigenspaces

Issue created by migration from https://trac.sagemath.org/ticket/20788

Original creator: kedlaya

Original creation time: 2016-06-09 00:13:55

CC:  gregorybard

Keywords: matrices, eigenspaces, dimension

Given a square matrix `M` over a field and an element `t` of the field, it is easy to compute the dimension of the left eigenspace of `M` with eigenvalue `t`, by computing the rank of `M-t` and subtracting it from the dimension of `M`. There should be a method for this.

Computing the multiplicity of the generalized eigenspace is slightly more involved, but also not difficult. There should be a method for this too; I already have it written and will get it onto this ticket soon.

It would also be useful to have methods returning eigenspaces and generalized eigenspaces for individual eigenvalues, without computing all of them.


---

Comment by kedlaya created at 2016-08-22 03:01:25

Here is a patch with the function I proposed. I could use some more robust doctests; any suggestions?
----
New commits:


---

Comment by kedlaya created at 2016-08-22 03:01:25

Changing status from new to needs_review.


---

Comment by git created at 2016-08-22 03:10:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2016-08-29 00:25:13

Some experimental evidence suggests that this function leaks memory in a serious way; presumably one of the steps is at fault, but I haven't been able to isolate which one. Might be a job for valgrind here.


---

Comment by git created at 2016-09-03 19:55:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2016-09-03 19:57:36

I added a step to square the matrix at each iteration; this reduces the dependence on the nilpotency index from linear to logarithmic. I think this is a win on average: the only issue is doing extra matrix mults when the index is small, but this isn't too costly compared to the echelonization anyway.


---

Comment by chapoton created at 2017-04-17 09:15:59

I added a few doctests.
----
New commits:


---

Comment by kedlaya created at 2017-08-23 15:40:38

Those doctests look good to me.


---

Comment by git created at 2017-08-23 18:16:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-23 18:19:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-08-23 19:10:39

One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.


---

Comment by tscrim created at 2017-08-23 19:10:39

Changing keywords from "matrices, eigenspaces, dimension" to "matrices, eigenspaces, dimension, days88, IME coding sprints".


---

Comment by tscrim created at 2017-08-23 19:10:48

Changing keywords from "matrices, eigenspaces, dimension, days88, IME coding sprints" to "matrices, eigenspaces, dimension, days88, IMA coding sprints".


---

Comment by git created at 2017-08-23 20:28:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2017-08-23 20:30:06

Replying to [comment:11 tscrim]:
> One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.

Done and done.


---

Comment by kedlaya created at 2017-08-23 20:30:06

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-10 11:56:35

Resolution: fixed
