# Issue 21104: Better wrapping of IML

archive/issues_021104.json:
```json
{
    "body": "CC:  @ClementPernet\n\nThe `IML` package should be better wrapped up, for instance in `sage/libs/IML`. The `cdef` are hidden in `sage/matrix/matrix_integer_dense.pyx`.\n\nThe problem is that `IML` somehow conflicts with linbox (which also includes `IML`).\n\nFor instance, adding : \n\n```cdef extern from \"linbox/solutions/solve.h\" namespace \"LinBox\":\n     pass```\n\non top of `sage/matrix/matrix_integer_dense.pyx` prevents it from compiling.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21341\n\n",
    "created_at": "2016-08-26T07:58:40Z",
    "labels": [
        "interfaces",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Better wrapping of IML",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21104",
    "user": "Bouillaguet"
}
```
CC:  @ClementPernet

The `IML` package should be better wrapped up, for instance in `sage/libs/IML`. The `cdef` are hidden in `sage/matrix/matrix_integer_dense.pyx`.

The problem is that `IML` somehow conflicts with linbox (which also includes `IML`).

For instance, adding : 

```cdef extern from "linbox/solutions/solve.h" namespace "LinBox":
     pass```

on top of `sage/matrix/matrix_integer_dense.pyx` prevents it from compiling.

Issue created by migration from https://trac.sagemath.org/ticket/21341





---

archive/issue_comments_292408.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd75\".",
    "created_at": "2016-08-26T08:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292408",
    "user": "Bouillaguet"
}
```

Changing keywords from "" to "sd75".



---

archive/issue_comments_292409.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-27T14:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292409",
    "user": "Bouillaguet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292410.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-08-27T14:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292410",
    "user": "Bouillaguet"
}
```

New commits:



---

archive/issue_comments_292411.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-27T18:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292411",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_292412.json:
```json
{
    "body": "What is the point of this:\n\n```\ncdef long iml_nullspaceMP(long n, long m, const mpz_t *A, mpz_t * *mp_N_pass):\n    return nullspaceMP(n, m, A, mp_N_pass)\n\ncdef iml_nonsingSolvLlhsMM(SOLU_POS solupos, long n, long m, mpz_t *mp_A, mpz_t *mp_B, mpz_t mp_N, mpz_t mp_D):\n    nonsingSolvLlhsMM(solupos, n, m, mp_A, mp_B, mp_N, mp_D)\n```\n\nWhy not just call the IML functions directly?\n\nIf it's related to the problem in the ticket description, I'd rather try to fix that problem or at least understand why it does not work.",
    "created_at": "2016-08-27T18:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292412",
    "user": "@jdemeyer"
}
```

What is the point of this:

```
cdef long iml_nullspaceMP(long n, long m, const mpz_t *A, mpz_t * *mp_N_pass):
    return nullspaceMP(n, m, A, mp_N_pass)

cdef iml_nonsingSolvLlhsMM(SOLU_POS solupos, long n, long m, mpz_t *mp_A, mpz_t *mp_B, mpz_t mp_N, mpz_t mp_D):
    nonsingSolvLlhsMM(solupos, n, m, mp_A, mp_B, mp_N, mp_D)
```

Why not just call the IML functions directly?

If it's related to the problem in the ticket description, I'd rather try to fix that problem or at least understand why it does not work.



---

archive/issue_comments_292413.json:
```json
{
    "body": "I think this is an upstream linbox bug.",
    "created_at": "2016-08-27T20:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292413",
    "user": "@jdemeyer"
}
```

I think this is an upstream linbox bug.



---

archive/issue_comments_292414.json:
```json
{
    "body": "In code like\n\n```\ncdef enum SOLU_POS:\n        LeftSolu = 101\n        RightSolu = 102\n```\n\nit's better to not put the values (101 and 102) since this confuses people to think that Cython actually uses those values (it just ignores them). Also: use 4 spaces of indentation.",
    "created_at": "2016-08-27T21:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292414",
    "user": "@jdemeyer"
}
```

In code like

```
cdef enum SOLU_POS:
        LeftSolu = 101
        RightSolu = 102
```

it's better to not put the values (101 and 102) since this confuses people to think that Cython actually uses those values (it just ignores them). Also: use 4 spaces of indentation.



---

archive/issue_comments_292415.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-28T06:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292415",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292416.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-28T06:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292416",
    "user": "Bouillaguet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_292417.json:
```json
{
    "body": "Jeroen, does this suit you (also see my \"private\" email)?",
    "created_at": "2016-08-28T06:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292417",
    "user": "Bouillaguet"
}
```

Jeroen, does this suit you (also see my "private" email)?



---

archive/issue_comments_292418.json:
```json
{
    "body": "Let's see what the patchbot says (you can remind me if the patchbot tests pass).",
    "created_at": "2016-08-30T08:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292418",
    "user": "@jdemeyer"
}
```

Let's see what the patchbot says (you can remind me if the patchbot tests pass).



---

archive/issue_comments_292419.json:
```json
{
    "body": "And fill in your name as author...",
    "created_at": "2016-08-30T09:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292419",
    "user": "@jdemeyer"
}
```

And fill in your name as author...



---

archive/issue_comments_292420.json:
```json
{
    "body": "Oops.",
    "created_at": "2016-08-30T09:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292420",
    "user": "Bouillaguet"
}
```

Oops.



---

archive/issue_comments_292421.json:
```json
{
    "body": "Jeroen, the tests fail on the patchbot for an unrelated reason (a deprecation warning in generic_graph.pyx). I can't reproduce the problem on my machine. How do you feel about the ticket?",
    "created_at": "2016-09-01T15:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292421",
    "user": "Bouillaguet"
}
```

Jeroen, the tests fail on the patchbot for an unrelated reason (a deprecation warning in generic_graph.pyx). I can't reproduce the problem on my machine. How do you feel about the ticket?



---

archive/issue_comments_292422.json:
```json
{
    "body": "The patchbot failures are indeed unrelated.",
    "created_at": "2016-09-01T15:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292422",
    "user": "@jdemeyer"
}
```

The patchbot failures are indeed unrelated.



---

archive/issue_comments_292423.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-01T15:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292423",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292424.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-09-04T00:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21104",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21104#issuecomment-292424",
    "user": "@vbraun"
}
```

Resolution: fixed
