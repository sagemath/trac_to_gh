# Issue 19280: Graphs: canonical_label() and return_graph -parameter

archive/issues_019280.json:
```json
{
    "body": "CC:  dcoudert\n\nSeveral problems I noticed on `generic_graph.py`:\n\n- Indentation in docstring for `return_graph` is wrong.\n\n- That parameter seems to have no effect when `algorithm='sage'`:\n\n\n```\nsage: G = Graph({10: [20]})\nsage: G.canonical_label(algorithm='sage', return_graph=False)\nGraph on 2 vertices\nsage: G.vertices()\n[10, 20]\nsage: G.canonical_label(algorithm='sage', return_graph=True)\nGraph on 2 vertices\nsage: G.vertices()\n[10, 20]\n```\n\n\n- I installed bliss with `sage -i` and it seems to be fine. I got normal messages from gcc and then `Successfully installed bliss-0.73`, and  `'bliss' in sage.misc.package.optional_packages()[0]` says `True`. But still\n\n\n```\nsage: G.canonical_label(algorithm='bliss', return_graph=True)\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n . . . \nImportError: You must install the 'bliss' package to run this command.\n```\n\n\n- Why the name of the parameter `return_graph` in this, but `inplace` in all other functions?\n\nIssue created by migration from https://trac.sagemath.org/ticket/19517\n\n",
    "created_at": "2015-11-04T08:26:49Z",
    "labels": [
        "graph theory",
        "major",
        "bug"
    ],
    "title": "Graphs: canonical_label() and return_graph -parameter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19280",
    "user": "jmantysalo"
}
```
CC:  dcoudert

Several problems I noticed on `generic_graph.py`:

- Indentation in docstring for `return_graph` is wrong.

- That parameter seems to have no effect when `algorithm='sage'`:


```
sage: G = Graph({10: [20]})
sage: G.canonical_label(algorithm='sage', return_graph=False)
Graph on 2 vertices
sage: G.vertices()
[10, 20]
sage: G.canonical_label(algorithm='sage', return_graph=True)
Graph on 2 vertices
sage: G.vertices()
[10, 20]
```


- I installed bliss with `sage -i` and it seems to be fine. I got normal messages from gcc and then `Successfully installed bliss-0.73`, and  `'bliss' in sage.misc.package.optional_packages()[0]` says `True`. But still


```
sage: G.canonical_label(algorithm='bliss', return_graph=True)
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
 . . . 
ImportError: You must install the 'bliss' package to run this command.
```


- Why the name of the parameter `return_graph` in this, but `inplace` in all other functions?

Issue created by migration from https://trac.sagemath.org/ticket/19517





---

archive/issue_comments_264678.json:
```json
{
    "body": "Hello !\n\nAll your remarks seem correct (and easy to fix) but I have no idea what the problem with the bliss package comes from `O_o`\n\nNathann",
    "created_at": "2015-11-05T14:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264678",
    "user": "ncohen"
}
```

Hello !

All your remarks seem correct (and easy to fix) but I have no idea what the problem with the bliss package comes from `O_o`

Nathann



---

archive/issue_comments_264679.json:
```json
{
    "body": "There is something strange with `bliss` installation, see https://groups.google.com/forum/#!topic/sage-devel/_1OYNuVNltM\n\n`return_graph` is not converse of `inplace`. I guess. It is badly documented. What is the meaning of it's output? A list of pairs somehow... Try\n\n\n```\nG = graphs.PetersenGraph()\nG.relabel(lambda x: chr(ord('a')+x))\nG.canonical_label(return_graph=False)\n```\n\n\nAnd why it deletes vertex positioning contraty to `relabel`? Try for example\n\n\n```\nG = graphs.PetersenGraph()\nG.relabel(lambda x: chr(ord('a')+x))\nG.show()\nG = G.canonical_label()\nG.canonical_label().show()\n```\n",
    "created_at": "2015-11-05T15:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264679",
    "user": "jmantysalo"
}
```

There is something strange with `bliss` installation, see https://groups.google.com/forum/#!topic/sage-devel/_1OYNuVNltM

`return_graph` is not converse of `inplace`. I guess. It is badly documented. What is the meaning of it's output? A list of pairs somehow... Try


```
G = graphs.PetersenGraph()
G.relabel(lambda x: chr(ord('a')+x))
G.canonical_label(return_graph=False)
```


And why it deletes vertex positioning contraty to `relabel`? Try for example


```
G = graphs.PetersenGraph()
G.relabel(lambda x: chr(ord('a')+x))
G.show()
G = G.canonical_label()
G.canonical_label().show()
```




---

archive/issue_comments_264680.json:
```json
{
    "body": "> There is something strange with `bliss` installation, see https://groups.google.com/forum/#!topic/sage-devel/_1OYNuVNltM\n\nSomething like that happened during the last update of bliss, but Jeroen noticed it at the last minute:\nhttp://trac.sagemath.org/ticket/19483#comment:15\n\n> `return_graph` is not converse of `inplace`. I guess. It is badly documented. What is the meaning of it's output?\n\n(assuming that you are talking of 'canonical_label')\n\n`return_graph` tells whether or not you want the actual graph. Somethimes you only need the labelling, and not the whole graph.\n\n\n A list of pairs somehow... Try\n> \n> {{{\n> G = graphs.PetersenGraph()\n> G.relabel(lambda x: chr(ord('a')+x))\n> G.canonical_label(return_graph=False)\n> }}}\n\nThese pairs are the edges of the relabeled graph\n\n```\nsage: Graph(G.canonical_label(return_graph=False)) == graphs.PetersenGraph().canonical_label()\nTrue\n```\n\n\nCan't say that I see the point to return this instead of a `Graph` object...\n\n> And why it deletes vertex positioning contraty to `relabel`? Try for example\n\nProbably because the graph is built from the list of edges, instead of being built as a relabelled copy of the original graph. Why do you ask these questions like there is a mystical explanation behind? It's a bug, that's all. It just needs to be fixed.\n\nNathann",
    "created_at": "2015-11-05T15:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264680",
    "user": "ncohen"
}
```

> There is something strange with `bliss` installation, see https://groups.google.com/forum/#!topic/sage-devel/_1OYNuVNltM

Something like that happened during the last update of bliss, but Jeroen noticed it at the last minute:
http://trac.sagemath.org/ticket/19483#comment:15

> `return_graph` is not converse of `inplace`. I guess. It is badly documented. What is the meaning of it's output?

(assuming that you are talking of 'canonical_label')

`return_graph` tells whether or not you want the actual graph. Somethimes you only need the labelling, and not the whole graph.


 A list of pairs somehow... Try
> 
> {{{
> G = graphs.PetersenGraph()
> G.relabel(lambda x: chr(ord('a')+x))
> G.canonical_label(return_graph=False)
> }}}

These pairs are the edges of the relabeled graph

```
sage: Graph(G.canonical_label(return_graph=False)) == graphs.PetersenGraph().canonical_label()
True
```


Can't say that I see the point to return this instead of a `Graph` object...

> And why it deletes vertex positioning contraty to `relabel`? Try for example

Probably because the graph is built from the list of edges, instead of being built as a relabelled copy of the original graph. Why do you ask these questions like there is a mystical explanation behind? It's a bug, that's all. It just needs to be fixed.

Nathann



---

archive/issue_comments_264681.json:
```json
{
    "body": "OK, modified the description. I do not think that forgetting vertex positions is necessarily a bug. But to remember them on `relabel()` and to forget on `canonical_label()` is.",
    "created_at": "2015-11-06T06:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264681",
    "user": "jmantysalo"
}
```

OK, modified the description. I do not think that forgetting vertex positions is necessarily a bug. But to remember them on `relabel()` and to forget on `canonical_label()` is.



---

archive/issue_comments_264682.json:
```json
{
    "body": "Getting back to this old ticket... First of all I changed the check for parameters to better understand what happens. Now `algorithm='bliss'` will always raise an error if Bliss is not installed, even when the graph has multiedges and Bliss could not be used anyway.\n\nI think that this should just compute canonical relabeling and call `.relabel()`. That would take care the problem of vertex positions.\n----\nNew commits:",
    "created_at": "2017-10-30T11:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264682",
    "user": "jmantysalo"
}
```

Getting back to this old ticket... First of all I changed the check for parameters to better understand what happens. Now `algorithm='bliss'` will always raise an error if Bliss is not installed, even when the graph has multiedges and Bliss could not be used anyway.

I think that this should just compute canonical relabeling and call `.relabel()`. That would take care the problem of vertex positions.
----
New commits:



---

archive/issue_comments_264683.json:
```json
{
    "body": "It's true that this method needs significant cleaning. \n- The first line of description is not standard and could be `Return a canonical labeling of the vertices of this (di)graph `.\n- In the INPUT block, the parameters could be better explained\n- an OUTPUT block could be useful as the output depends on the parameters\netc.\n\n\n\none doctest fails because I have bliss installed. So you could do:\n\n```\n-            sage: G.canonical_label(edge_labels=True, certificate=True)\n-            (Graph on 5 vertices, {0: 4, 1: 3, 2: 0, 3: 1, 4: 2})\n+            sage: G.canonical_label(edge_labels=True, certificate=True, algorithm='sage')\n+            (Graph on 5 vertices, {0: 4, 1: 3, 2: 0, 3: 1, 4: 2})\n+            sage: G.canonical_label(edge_labels=True, certificate=True, algorithm='bliss') # optional - bliss\n+            (Graph on 5 vertices, {{0: 4, 1: 3, 2: 1, 3: 0, 4: 2})\n```\n\nThe last 2 lines might be placed with the examples using bliss.",
    "created_at": "2017-10-30T12:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264683",
    "user": "dcoudert"
}
```

It's true that this method needs significant cleaning. 
- The first line of description is not standard and could be `Return a canonical labeling of the vertices of this (di)graph `.
- In the INPUT block, the parameters could be better explained
- an OUTPUT block could be useful as the output depends on the parameters
etc.



one doctest fails because I have bliss installed. So you could do:

```
-            sage: G.canonical_label(edge_labels=True, certificate=True)
-            (Graph on 5 vertices, {0: 4, 1: 3, 2: 0, 3: 1, 4: 2})
+            sage: G.canonical_label(edge_labels=True, certificate=True, algorithm='sage')
+            (Graph on 5 vertices, {0: 4, 1: 3, 2: 0, 3: 1, 4: 2})
+            sage: G.canonical_label(edge_labels=True, certificate=True, algorithm='bliss') # optional - bliss
+            (Graph on 5 vertices, {{0: 4, 1: 3, 2: 1, 3: 0, 4: 2})
```

The last 2 lines might be placed with the examples using bliss.



---

archive/issue_comments_264684.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-31T06:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264684",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264685.json:
```json
{
    "body": "Ah, I did not notice the line `not edge_labels` I removed. Now corrected that one.\n\n(These must also be said in `INPUT`section.)",
    "created_at": "2017-10-31T06:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264685",
    "user": "jmantysalo"
}
```

Ah, I did not notice the line `not edge_labels` I removed. Now corrected that one.

(These must also be said in `INPUT`section.)



---

archive/issue_comments_264686.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-31T08:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264686",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264687.json:
```json
{
    "body": "Just noticed that Bliss with `return_graph=False` returns set of edges, not a dictionary of mapping. Hence we must copy a part of `relabel`:\n\n\n```\nattributes_to_update = ('_pos', '_assoc', '_embedding')\nfor attr in attributes_to_update:\n    if hasattr(self, attr) and getattr(self, attr) is not None:\n        new_attr = {}\n        for v,value in iteritems(getattr(self, attr)):\n            new_attr[perm[v]] = value\n\n        setattr(self, attr, new_attr)\n```\n",
    "created_at": "2017-11-01T05:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264687",
    "user": "jmantysalo"
}
```

Just noticed that Bliss with `return_graph=False` returns set of edges, not a dictionary of mapping. Hence we must copy a part of `relabel`:


```
attributes_to_update = ('_pos', '_assoc', '_embedding')
for attr in attributes_to_update:
    if hasattr(self, attr) and getattr(self, attr) is not None:
        new_attr = {}
        for v,value in iteritems(getattr(self, attr)):
            new_attr[perm[v]] = value

        setattr(self, attr, new_attr)
```




---

archive/issue_comments_264688.json:
```json
{
    "body": "Forget, I was blind when writing my last comment.\n\nWe could do something like\n\n\n```\n         if algorithm == 'bliss':\n            vert_dict = canonical_form(self, partition, certificate=True)[1]\n            return self.relabel(vert_dict, inplace=not return_graph)\n```\n\n\nmaybe... But what the hell this function is supposed to do??? `certificate` seems a wrong word here, but at least `certificate=True` works similarly with both `algorithm='sage'` and `algorithm='bliss'`.",
    "created_at": "2017-11-01T05:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264688",
    "user": "jmantysalo"
}
```

Forget, I was blind when writing my last comment.

We could do something like


```
         if algorithm == 'bliss':
            vert_dict = canonical_form(self, partition, certificate=True)[1]
            return self.relabel(vert_dict, inplace=not return_graph)
```


maybe... But what the hell this function is supposed to do??? `certificate` seems a wrong word here, but at least `certificate=True` works similarly with both `algorithm='sage'` and `algorithm='bliss'`.



---

archive/issue_comments_264689.json:
```json
{
    "body": "Just came here after the sage-devel post by Jori. Is there anything controversial here? Or were you just fishing for reviewers :-)",
    "created_at": "2017-11-02T23:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264689",
    "user": "jdemeyer"
}
```

Just came here after the sage-devel post by Jori. Is there anything controversial here? Or were you just fishing for reviewers :-)



---

archive/issue_comments_264690.json:
```json
{
    "body": "Replying to [comment:13 jdemeyer]:\n> Just came here after the sage-devel post by Jori. Is there anything controversial here?\n\nI guess not, but not sure, so I write a short message to sage-devel.\n\n> Or were you just fishing for reviewers :-)\n\nNot really. It would be more helpful to get comments about what this should do. `certificate` vs. `return_graph` - whaat?",
    "created_at": "2017-11-03T04:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264690",
    "user": "jmantysalo"
}
```

Replying to [comment:13 jdemeyer]:
> Just came here after the sage-devel post by Jori. Is there anything controversial here?

I guess not, but not sure, so I write a short message to sage-devel.

> Or were you just fishing for reviewers :-)

Not really. It would be more helpful to get comments about what this should do. `certificate` vs. `return_graph` - whaat?



---

archive/issue_comments_264691.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-03T05:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264691",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264692.json:
```json
{
    "body": "Some modifications to docstring. Now also vertex positions are preserved even when Bliss is used.\n\nMust add many tests to this.",
    "created_at": "2017-11-03T05:46:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264692",
    "user": "jmantysalo"
}
```

Some modifications to docstring. Now also vertex positions are preserved even when Bliss is used.

Must add many tests to this.



---

archive/issue_comments_264693.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-03T08:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264693",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264694.json:
```json
{
    "body": "Currently Bliss have no verbose mode, and the docstring of `search_tree` says \"verbosity \u2013 currently ignored\". Hence I just removed the parameter.\n\nI changed docstring and allowed `return_graph=False` only when `bliss=True` is explicitly said.\n\nDocstring modified.\n\nNow this needs comments.",
    "created_at": "2017-11-03T08:35:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264694",
    "user": "jmantysalo"
}
```

Currently Bliss have no verbose mode, and the docstring of `search_tree` says "verbosity â€“ currently ignored". Hence I just removed the parameter.

I changed docstring and allowed `return_graph=False` only when `bliss=True` is explicitly said.

Docstring modified.

Now this needs comments.



---

archive/issue_comments_264695.json:
```json
{
    "body": "In `bliss.pyx`:\n- `canonical graph of G. Otherwise, it returns its set of edges.` -> `canonical graph of `G`. Otherwise, it returns its set of edges.`\n\nIn `generic_graph.py`:\n- unfortunately you can not remove parameter `verbosity` like that, although it is `currently ignored`. A deprecation warning is needed.\n- In the documentation, you must use ```True``, ``False```\n\nI don't see any place where the `certificate` parameter is used, but it might be useful to some users, no ?\n\nput the ticket to needs review when ready.",
    "created_at": "2017-11-03T11:03:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264695",
    "user": "dcoudert"
}
```

In `bliss.pyx`:
- `canonical graph of G. Otherwise, it returns its set of edges.` -> `canonical graph of `G`. Otherwise, it returns its set of edges.`

In `generic_graph.py`:
- unfortunately you can not remove parameter `verbosity` like that, although it is `currently ignored`. A deprecation warning is needed.
- In the documentation, you must use ```True``, ``False```

I don't see any place where the `certificate` parameter is used, but it might be useful to some users, no ?

put the ticket to needs review when ready.



---

archive/issue_comments_264696.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-03T18:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264696",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264697.json:
```json
{
    "body": "Found a bug in my code. Deprecation and your suggestions done.\n\nI also tried to make better examples. Still lacking an example of partition, also I will check that the parameter is really used.",
    "created_at": "2017-11-03T18:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264697",
    "user": "jmantysalo"
}
```

Found a bug in my code. Deprecation and your suggestions done.

I also tried to make better examples. Still lacking an example of partition, also I will check that the parameter is really used.



---

archive/issue_comments_264698.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-04T16:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264698",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264699.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-04T17:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264699",
    "user": "jmantysalo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264700.json:
```json
{
    "body": "Maybe these changes should be integrated to Sage now, and get back to this later? One parameter is still missing examples and documentation, but that can be done later.",
    "created_at": "2017-11-04T17:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264700",
    "user": "jmantysalo"
}
```

Maybe these changes should be integrated to Sage now, and get back to this later? One parameter is still missing examples and documentation, but that can be done later.



---

archive/issue_comments_264701.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-11-05T08:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264701",
    "user": "dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264702.json:
```json
{
    "body": "In `bliss.pyx`, you changed some ```G``` and `G` to ``G``, but this last form is not well taken into account when building the doc. You must also use `r\"\"\"`. You should also do the same in `generic_graph.py`.\n\nIn the toc, you added `Return the canonically labeled graph.` but this is different from the sentence in the method. I suggest to use only `Return the canonical graph`.\n\nYou don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)\n\n\nSome comments on the parameters\n\n```\n-        - ``certificate`` -- if ``True``, a dictionary mapping from the\n-          (di)graph to its canonical label will be given.\n+        - ``certificate`` -- boolean (default: ``False``). When set to ``True``,\n+          a dictionary mapping from the vertices of the (di)graph to its canonical\n+          label will also be returned.\n```\n\n\n\n```\n-        - ``edge_labels`` -- default ``False``, otherwise allows\n-          only permutations respecting edge labels.\n+        - ``edge_labels`` -- boolean (default: ``False``). When set to ``True``,\n+          allows only permutations respecting edge labels.\n```\n\n\n\n```\n-        - ``algorithm``, a string -- the algorithm to use; currently available:\n+        - ``algorithm`` -- a string (default: ``None``). The algorithm to use;\n+          currently available:\n```\n\n\n\n```\n-        - ``return_graph`` -- if set, instead of graph return the list of\n-          edges of the the canonical graph; only available when Bliss is\n-          explicitly set as algorithm\n+        - ``return_graph`` -- boolean (default: ``True``). When set to ``False``,\n+          returns the list of edges of the the canonical graph instead of the\n+          canonical graph; only available when ``'bliss'`` is explicitly set as\n+          algorithm.\n```\n\n\nuse `bliss` and not `Bliss` to avoid confusion.\n\n`return_graph='false'` -> `return_graph=False`\n\n`graph with multiedges` -> `graph with multiple edges` to be consistent with the names of methods (ok, not with the constructor parameter).\n\n\nFailing example in `generic_graph.py`:\n\n```\nFailed example:\n    g\nExpected:\n    Graph on 6 vertices\nGot:\n    Grid Graph for [2, 3]: Graph on 6 vertices\n```\n\n\nFor parameter `partition`, I tried the following:\n\n```\nsage: G = graphs.PetersenGraph()\nsage: C = G.coloring()\nsage: C\n[[1, 3, 5, 9], [0, 2, 6], [4, 7, 8]]\nsage: C[::-1]\n[[4, 7, 8], [0, 2, 6], [1, 3, 5, 9]]\nsage: A = G.canonical_label(partition=C, algorithm='bliss')\nsage: B = G.canonical_label(partition=C[::-1], algorithm='bliss')\nsage: A == B\nFalse\nsage: B = G.canonical_label(partition=[C[0], C[2], C[1]], algorithm='bliss')\nsage: A == B\nFalse\nsage: A = G.canonical_label(partition=C, algorithm='bliss')\nsage: B = G.canonical_label(partition=[C[0], C[1], C[2][::-1]], algorithm='bliss')\nsage: A == B\nTrue\n```\n\nBy the way, it's boring to type `algorithm='bliss'` when bliss is your default algorithm...",
    "created_at": "2017-11-05T08:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264702",
    "user": "dcoudert"
}
```

In `bliss.pyx`, you changed some ```G``` and `G` to ``G``, but this last form is not well taken into account when building the doc. You must also use `r"""`. You should also do the same in `generic_graph.py`.

In the toc, you added `Return the canonically labeled graph.` but this is different from the sentence in the method. I suggest to use only `Return the canonical graph`.

You don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)


Some comments on the parameters

```
-        - ``certificate`` -- if ``True``, a dictionary mapping from the
-          (di)graph to its canonical label will be given.
+        - ``certificate`` -- boolean (default: ``False``). When set to ``True``,
+          a dictionary mapping from the vertices of the (di)graph to its canonical
+          label will also be returned.
```



```
-        - ``edge_labels`` -- default ``False``, otherwise allows
-          only permutations respecting edge labels.
+        - ``edge_labels`` -- boolean (default: ``False``). When set to ``True``,
+          allows only permutations respecting edge labels.
```



```
-        - ``algorithm``, a string -- the algorithm to use; currently available:
+        - ``algorithm`` -- a string (default: ``None``). The algorithm to use;
+          currently available:
```



```
-        - ``return_graph`` -- if set, instead of graph return the list of
-          edges of the the canonical graph; only available when Bliss is
-          explicitly set as algorithm
+        - ``return_graph`` -- boolean (default: ``True``). When set to ``False``,
+          returns the list of edges of the the canonical graph instead of the
+          canonical graph; only available when ``'bliss'`` is explicitly set as
+          algorithm.
```


use `bliss` and not `Bliss` to avoid confusion.

`return_graph='false'` -> `return_graph=False`

`graph with multiedges` -> `graph with multiple edges` to be consistent with the names of methods (ok, not with the constructor parameter).


Failing example in `generic_graph.py`:

```
Failed example:
    g
Expected:
    Graph on 6 vertices
Got:
    Grid Graph for [2, 3]: Graph on 6 vertices
```


For parameter `partition`, I tried the following:

```
sage: G = graphs.PetersenGraph()
sage: C = G.coloring()
sage: C
[[1, 3, 5, 9], [0, 2, 6], [4, 7, 8]]
sage: C[::-1]
[[4, 7, 8], [0, 2, 6], [1, 3, 5, 9]]
sage: A = G.canonical_label(partition=C, algorithm='bliss')
sage: B = G.canonical_label(partition=C[::-1], algorithm='bliss')
sage: A == B
False
sage: B = G.canonical_label(partition=[C[0], C[2], C[1]], algorithm='bliss')
sage: A == B
False
sage: A = G.canonical_label(partition=C, algorithm='bliss')
sage: B = G.canonical_label(partition=[C[0], C[1], C[2][::-1]], algorithm='bliss')
sage: A == B
True
```

By the way, it's boring to type `algorithm='bliss'` when bliss is your default algorithm...



---

archive/issue_comments_264703.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-05T13:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264703",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264704.json:
```json
{
    "body": "Replying to [comment:25 dcoudert]:\n\nThanks for comments. I did most of them, but some comments:\n\n> In `bliss.pyx`, you changed some ```G``` and `G` to ``G``, but this last form is not well taken into account when building the doc.\n\nThis is sometimes hard to decide. I guess we should use ``x`` only when referring to mathematical definition without any connection to the specific function parameters we are documenting.\n\n> In the toc, you added `Return the canonically labeled graph.` but this is different from the sentence in the method. I suggest to use only `Return the canonical graph`.\n\nI changed that.\n\nIn general I try to write a one-line description of the function to TOC when possible. For example `is_uniform` is explained as \"Return True if all congruences of the lattice consists of equal-sized blocks.\" in TOC, but the function starts with \"Return True if the lattice is uniform - -\" and then explains what is uniform.\n\n> You don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)\n\nBut then there is [Graph canonization](https://en.wikipedia.org/wiki/Graph_canonization), so what to do?\n\n> For parameter `partition`, I tried the following:\n\nFor that we must first define what means to be \"canonical\" but still \"restrict permutations\". That's why I suggest postponing that to another ticket.\n\n> By the way, it's boring to type `algorithm='bliss'` when bliss is your default algorithm...\n\nTrue, but there is no other choise for most examples.\n\nE: I am not sure if the function should keep the graph's name or not. However, now it is consistent with `relabel()`.",
    "created_at": "2017-11-05T13:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264704",
    "user": "jmantysalo"
}
```

Replying to [comment:25 dcoudert]:

Thanks for comments. I did most of them, but some comments:

> In `bliss.pyx`, you changed some ```G``` and `G` to ``G``, but this last form is not well taken into account when building the doc.

This is sometimes hard to decide. I guess we should use ``x`` only when referring to mathematical definition without any connection to the specific function parameters we are documenting.

> In the toc, you added `Return the canonically labeled graph.` but this is different from the sentence in the method. I suggest to use only `Return the canonical graph`.

I changed that.

In general I try to write a one-line description of the function to TOC when possible. For example `is_uniform` is explained as "Return True if all congruences of the lattice consists of equal-sized blocks." in TOC, but the function starts with "Return True if the lattice is uniform - -" and then explains what is uniform.

> You don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)

But then there is [Graph canonization](https://en.wikipedia.org/wiki/Graph_canonization), so what to do?

> For parameter `partition`, I tried the following:

For that we must first define what means to be "canonical" but still "restrict permutations". That's why I suggest postponing that to another ticket.

> By the way, it's boring to type `algorithm='bliss'` when bliss is your default algorithm...

True, but there is no other choise for most examples.

E: I am not sure if the function should keep the graph's name or not. However, now it is consistent with `relabel()`.



---

archive/issue_comments_264705.json:
```json
{
    "body": "> In general I try to write a one-line description of the function to TOC when possible. For example `is_uniform` is explained as \"Return True if all congruences of the lattice consists of equal-sized blocks.\" in TOC, but the function starts with \"Return True if the lattice is uniform - -\" and then explains what is uniform.\n \nAgreed. A significant effort remains to be done for cleaning the graph module. \n\n  \n\n> > You don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)\n> \n> But then there is [Graph canonization](https://en.wikipedia.org/wiki/Graph_canonization), so what to do?\n \nYou are right. I did not see that. So let's use graph canonization.\n\nCould you add a link to the wikipedia page ?\n\n \n\n> > For parameter `partition`, I tried the following:\n> \n> For that we must first define what means to be \"canonical\" but still \"restrict permutations\". That's why I suggest postponing that to another ticket.\n\nAgreed. It's already much better\n\n \n\n> E: I am not sure if the function should keep the graph's name or not. However, now it is consistent with `relabel()`.\n\nI have no opinion on that.",
    "created_at": "2017-11-05T14:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264705",
    "user": "dcoudert"
}
```

> In general I try to write a one-line description of the function to TOC when possible. For example `is_uniform` is explained as "Return True if all congruences of the lattice consists of equal-sized blocks." in TOC, but the function starts with "Return True if the lattice is uniform - -" and then explains what is uniform.
 
Agreed. A significant effort remains to be done for cleaning the graph module. 

  

> > You don't want to use [canonization](https://en.wikipedia.org/wiki/Canonization) but [canonicalization](https://en.wikipedia.org/wiki/Canonicalization), right ? ;)
> 
> But then there is [Graph canonization](https://en.wikipedia.org/wiki/Graph_canonization), so what to do?
 
You are right. I did not see that. So let's use graph canonization.

Could you add a link to the wikipedia page ?

 

> > For parameter `partition`, I tried the following:
> 
> For that we must first define what means to be "canonical" but still "restrict permutations". That's why I suggest postponing that to another ticket.

Agreed. It's already much better

 

> E: I am not sure if the function should keep the graph's name or not. However, now it is consistent with `relabel()`.

I have no opinion on that.



---

archive/issue_comments_264706.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-05T17:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264706",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264707.json:
```json
{
    "body": "Replying to [comment:28 dcoudert]:\n\n> Could you add a link to the wikipedia page ?\n\nGood idea. Done.",
    "created_at": "2017-11-05T17:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264707",
    "user": "jmantysalo"
}
```

Replying to [comment:28 dcoudert]:

> Could you add a link to the wikipedia page ?

Good idea. Done.



---

archive/issue_comments_264708.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-11-05T17:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264708",
    "user": "jmantysalo"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264709.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-05T17:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264709",
    "user": "dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264710.json:
```json
{
    "body": "Good. The doc displays nicely now (I like the \\cong stuff).",
    "created_at": "2017-11-05T17:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264710",
    "user": "dcoudert"
}
```

Good. The doc displays nicely now (I like the \cong stuff).



---

archive/issue_comments_264711.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-11-08T19:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19280#issuecomment-264711",
    "user": "vbraun"
}
```

Resolution: fixed
