# Issue 22112: Graph.vertices() should not sort by default

archive/issues_022112.json:
```json
{
    "body": "CC:  stefan @jm58660 @jhpalmieri\n\nWhy does `Graph.vertices()` need to *sort* the list of vertices?\n\nIssue created by migration from https://trac.sagemath.org/ticket/22349\n\n",
    "created_at": "2017-02-10T16:07:32Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Graph.vertices() should not sort by default",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22112",
    "user": "https://github.com/jdemeyer"
}
```
CC:  stefan @jm58660 @jhpalmieri

Why does `Graph.vertices()` need to *sort* the list of vertices?

Issue created by migration from https://trac.sagemath.org/ticket/22349





---

archive/issue_comments_306803.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-10T17:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306804.json:
```json
{
    "body": "What you propose to do is not an easy task. I suspect that many algorithms assume that the vertices are sorted. For sure, many algorithms assume that the ordering is always the same when calling `vertices()` and `vertex_iterator()`, so I hope that what you propose preserves this strong assumption.\n\nIs your long term plan to remove parameter `sort` from the methods or just to set its default value to false ?\nI don't know the potential problems of sorting with Python 3, so I'm not sure of the motivation.\n\nMany many tests are broken\n\n```\nsage -t src/sage/graphs/generic_graph.py  # 45 doctests failed\nsage -t src/sage/graphs/generators/smallgraphs.py  # 4 doctests failed\nsage -t src/sage/graphs/strongly_regular_db.pyx  # 1 doctest failed\nsage -t src/sage/graphs/graph.py  # 11 doctests failed\nsage -t src/sage/graphs/base/static_sparse_graph.pyx  # 1 doctest failed\nsage -t src/sage/graphs/generators/families.py  # 3 doctests failed\nsage -t src/sage/graphs/digraph.py  # 10 doctests failed\nsage -t src/sage/graphs/digraph_generators.py  # 3 doctests failed\nsage -t src/sage/graphs/base/graph_backends.pyx  # 2 doctests failed\nsage -t src/sage/graphs/generic_graph_pyx.pyx  # 3 doctests failed\nsage -t src/sage/graphs/comparability.pyx  # 1 doctest failed\nsage -t src/sage/graphs/bipartite_graph.py  # 3 doctests failed\nsage -t src/sage/graphs/base/c_graph.pyx  # 1 doctest failed\nsage -t src/sage/graphs/graph_decompositions/vertex_separation.pyx  # 4 doctests failed\nsage -t src/sage/graphs/schnyder.py  # 1 doctest failed\nsage -t src/sage/graphs/line_graph.py  # 3 doctests failed\nsage -t src/sage/graphs/isgci.py  # 1 doctest failed\nsage -t src/sage/graphs/graph_decompositions/graph_products.pyx  # 1 doctest failed\nsage -t src/sage/quivers/path_semigroup.py  # 3 doctests failed\nsage -t src/sage/groups/perm_gps/partn_ref/refinement_graphs.pyx  # 1 doctest failed\n```\n\nfor instance (random copy/paste)\n\n```\nFile \"src/sage/graphs/line_graph.py\", line 466, in sage.graphs.line_graph.root_graph\nFailed example:\n    root_graph(graphs.DiamondGraph())\nExpected:\n    (Graph on 4 vertices, {0: (0, 3), 1: (0, 1), 2: (0, 2), 3: (1, 2)})\nGot:\n    (Graph on 4 vertices, {0: (1, 2), 1: (0, 1), 2: (0, 2), 3: (0, 3)})\n**********************************************************************\nFile \"src/sage/graphs/base/graph_backends.pyx\", line 802, in sage.graphs.base.graph_backends.NetworkXGraphDeprecated.mutate\nFailed example:\n    G.edges(sort=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.base.graph_backends.NetworkXGraphDeprecated.mutate[5]>\", line 1, in <module>\n        G.edges(sort=False)\n    TypeError: edges() got an unexpected keyword argument 'sort'\n**********************************************************************\nFile \"src/sage/graphs/digraph.py\", line 3424, in sage.graphs.digraph.DiGraph.flow_polytope\nFailed example:\n    fl.vertices(sort=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.digraph.DiGraph.flow_polytope[19]>\", line 1, in <module>\n        fl.vertices(sort=False)\n    TypeError: __call__() got an unexpected keyword argument 'sort'\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 20558, in sage.graphs.generic_graph.GenericGraph.?\nFailed example:\n    d.automorphism_group(algorithm='sage')\nExpected:\n    Permutation Group with generators [('01','02')('10','20')('11','22')('12','21')]\nGot:\n    Permutation Group with generators [()]\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 20197, in sage.graphs.generic_graph.GenericGraph.degree_to_cell\nFailed example:\n    G.degree_to_cell('111', cell)\nExpected:\n    0\nGot:\n    1\n```",
    "created_at": "2017-02-11T10:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306804",
    "user": "https://github.com/dcoudert"
}
```

What you propose to do is not an easy task. I suspect that many algorithms assume that the vertices are sorted. For sure, many algorithms assume that the ordering is always the same when calling `vertices()` and `vertex_iterator()`, so I hope that what you propose preserves this strong assumption.

Is your long term plan to remove parameter `sort` from the methods or just to set its default value to false ?
I don't know the potential problems of sorting with Python 3, so I'm not sure of the motivation.

Many many tests are broken

```
sage -t src/sage/graphs/generic_graph.py  # 45 doctests failed
sage -t src/sage/graphs/generators/smallgraphs.py  # 4 doctests failed
sage -t src/sage/graphs/strongly_regular_db.pyx  # 1 doctest failed
sage -t src/sage/graphs/graph.py  # 11 doctests failed
sage -t src/sage/graphs/base/static_sparse_graph.pyx  # 1 doctest failed
sage -t src/sage/graphs/generators/families.py  # 3 doctests failed
sage -t src/sage/graphs/digraph.py  # 10 doctests failed
sage -t src/sage/graphs/digraph_generators.py  # 3 doctests failed
sage -t src/sage/graphs/base/graph_backends.pyx  # 2 doctests failed
sage -t src/sage/graphs/generic_graph_pyx.pyx  # 3 doctests failed
sage -t src/sage/graphs/comparability.pyx  # 1 doctest failed
sage -t src/sage/graphs/bipartite_graph.py  # 3 doctests failed
sage -t src/sage/graphs/base/c_graph.pyx  # 1 doctest failed
sage -t src/sage/graphs/graph_decompositions/vertex_separation.pyx  # 4 doctests failed
sage -t src/sage/graphs/schnyder.py  # 1 doctest failed
sage -t src/sage/graphs/line_graph.py  # 3 doctests failed
sage -t src/sage/graphs/isgci.py  # 1 doctest failed
sage -t src/sage/graphs/graph_decompositions/graph_products.pyx  # 1 doctest failed
sage -t src/sage/quivers/path_semigroup.py  # 3 doctests failed
sage -t src/sage/groups/perm_gps/partn_ref/refinement_graphs.pyx  # 1 doctest failed
```

for instance (random copy/paste)

```
File "src/sage/graphs/line_graph.py", line 466, in sage.graphs.line_graph.root_graph
Failed example:
    root_graph(graphs.DiamondGraph())
Expected:
    (Graph on 4 vertices, {0: (0, 3), 1: (0, 1), 2: (0, 2), 3: (1, 2)})
Got:
    (Graph on 4 vertices, {0: (1, 2), 1: (0, 1), 2: (0, 2), 3: (0, 3)})
**********************************************************************
File "src/sage/graphs/base/graph_backends.pyx", line 802, in sage.graphs.base.graph_backends.NetworkXGraphDeprecated.mutate
Failed example:
    G.edges(sort=False)
Exception raised:
    Traceback (most recent call last):
      File "/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.base.graph_backends.NetworkXGraphDeprecated.mutate[5]>", line 1, in <module>
        G.edges(sort=False)
    TypeError: edges() got an unexpected keyword argument 'sort'
**********************************************************************
File "src/sage/graphs/digraph.py", line 3424, in sage.graphs.digraph.DiGraph.flow_polytope
Failed example:
    fl.vertices(sort=False)
Exception raised:
    Traceback (most recent call last):
      File "/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.digraph.DiGraph.flow_polytope[19]>", line 1, in <module>
        fl.vertices(sort=False)
    TypeError: __call__() got an unexpected keyword argument 'sort'
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 20558, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    d.automorphism_group(algorithm='sage')
Expected:
    Permutation Group with generators [('01','02')('10','20')('11','22')('12','21')]
Got:
    Permutation Group with generators [()]
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 20197, in sage.graphs.generic_graph.GenericGraph.degree_to_cell
Failed example:
    G.degree_to_cell('111', cell)
Expected:
    0
Got:
    1
```



---

archive/issue_comments_306805.json:
```json
{
    "body": "Replying to [comment:9 dcoudert]:\n> What you propose to do is not an easy task.\n\n\nI never claimed that it was easy. But it has to be done in order to support Python 3.\n\n> For sure, many algorithms assume that the ordering is always the same when calling `vertices()` and `vertex_iterator()`, so I hope that what you propose preserves this strong assumption.\n\n\nIt should remain the same, yes.\n\n> Is your long term plan to remove parameter `sort` from the methods or just to set its default value to false ?\n\n\nI don't care much. I guess once the default is `False`, there will be little reason left to keep the `sort` keyword.\n\n> I don't know the potential problems of sorting with Python 3, so I'm not sure of the motivation.\n\n\nThe problem is that you cannot sort arbitrary things in Python 3. For example:\n\n```\n>>> sorted([1, \"hello\"])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: unorderable types: str() < int()\n```",
    "created_at": "2017-02-11T13:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306805",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:9 dcoudert]:
> What you propose to do is not an easy task.


I never claimed that it was easy. But it has to be done in order to support Python 3.

> For sure, many algorithms assume that the ordering is always the same when calling `vertices()` and `vertex_iterator()`, so I hope that what you propose preserves this strong assumption.


It should remain the same, yes.

> Is your long term plan to remove parameter `sort` from the methods or just to set its default value to false ?


I don't care much. I guess once the default is `False`, there will be little reason left to keep the `sort` keyword.

> I don't know the potential problems of sorting with Python 3, so I'm not sure of the motivation.


The problem is that you cannot sort arbitrary things in Python 3. For example:

```
>>> sorted([1, "hello"])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unorderable types: str() < int()
```



---

archive/issue_comments_306806.json:
```json
{
    "body": "Now I understand the need for this big change.\n\nIs there a way to sort arbitrary things in Python 3 ? some trick ?",
    "created_at": "2017-02-11T15:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306806",
    "user": "https://github.com/dcoudert"
}
```

Now I understand the need for this big change.

Is there a way to sort arbitrary things in Python 3 ? some trick ?



---

archive/issue_comments_306807.json:
```json
{
    "body": "Replying to [comment:11 dcoudert]:\n> Is there a way to sort arbitrary things in Python 3 ?\n\n\nOf course there is. The question is: what would you expect from such \"arbitrary\" sorting?\n\nAnd if it's arbitrary anyway: why would you want to \"sort\" in the first place?",
    "created_at": "2017-02-11T15:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306807",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 dcoudert]:
> Is there a way to sort arbitrary things in Python 3 ?


Of course there is. The question is: what would you expect from such "arbitrary" sorting?

And if it's arbitrary anyway: why would you want to "sort" in the first place?



---

archive/issue_comments_306808.json:
```json
{
    "body": "As far as I understand, there are at least two different issues here:\n* some algorithms want a consistent and easy to test order on the vertices, typically (but probably not only) to loop over the unordered pairs of vertices normalized by putting the smalled vertex first;\n* in interactive use, when there is a natural order on the vertices (in practice, mostly when they are integers, strings, or possibly nested tuples of such things), *people* want to see the vertices, edges, etc. listed in an order that makes the output easy to read, and it would be a significant regression to take that away from them.\n\nAdditionally, it may well be the case that some algorithms also rely on vertices of a certain type (say tuples of integers) automatically coming out sorted in a particular order, I'm not sure.",
    "created_at": "2017-02-14T18:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306808",
    "user": "https://github.com/mezzarobba"
}
```

As far as I understand, there are at least two different issues here:
* some algorithms want a consistent and easy to test order on the vertices, typically (but probably not only) to loop over the unordered pairs of vertices normalized by putting the smalled vertex first;
* in interactive use, when there is a natural order on the vertices (in practice, mostly when they are integers, strings, or possibly nested tuples of such things), *people* want to see the vertices, edges, etc. listed in an order that makes the output easy to read, and it would be a significant regression to take that away from them.

Additionally, it may well be the case that some algorithms also rely on vertices of a certain type (say tuples of integers) automatically coming out sorted in a particular order, I'm not sure.



---

archive/issue_comments_306809.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-15T08:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306809",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306810.json:
```json
{
    "body": "Replying to [comment:11 dcoudert]:\n> Now I understand the need for this big change.\n> \n> Is there a way to sort arbitrary things in Python 3 ? some trick ?\n\n\none way is\n\n>>> sorted( ..., key=str )\n\n\nYou could of course use another key function that uses some sorting heuristic (something like the key function used by https://pypi.python.org/pypi/natsort)\n\nDisplay functions in IPython have hooks for nice sorting (used for dicts and sets), so if graphs need to display their keys and edges in a nice way, that's probably the hook to go for.\n\nAlgorithms that need their edges sorted should either insist on sortable labels or sort by index tuples or something like that (something that is guaranteed to be sortable regardless of what the user decides to use as labels).",
    "created_at": "2017-11-06T11:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306810",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:11 dcoudert]:
> Now I understand the need for this big change.
> 
> Is there a way to sort arbitrary things in Python 3 ? some trick ?


one way is

>>> sorted( ..., key=str )


You could of course use another key function that uses some sorting heuristic (something like the key function used by https://pypi.python.org/pypi/natsort)

Display functions in IPython have hooks for nice sorting (used for dicts and sets), so if graphs need to display their keys and edges in a nice way, that's probably the hook to go for.

Algorithms that need their edges sorted should either insist on sortable labels or sort by index tuples or something like that (something that is guaranteed to be sortable regardless of what the user decides to use as labels).



---

archive/issue_comments_306811.json:
```json
{
    "body": "Replying to [comment:13 mmezzarobba]:\n> * in interactive use, when there is a natural order on the vertices (in practice, mostly when they are integers, strings, or possibly nested tuples of such things), *people* want to see the vertices, edges, etc. listed in an order that makes the output easy to read, and it would be a significant regression to take that away from them.\n\n\nIn that case, the best solution is probably to use a custom class for this. It would behave exactly like a Python `list` (or `tuple`) in all possible ways, except that it would be sorted on display.",
    "created_at": "2017-11-06T12:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306811",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:13 mmezzarobba]:
> * in interactive use, when there is a natural order on the vertices (in practice, mostly when they are integers, strings, or possibly nested tuples of such things), *people* want to see the vertices, edges, etc. listed in an order that makes the output easy to read, and it would be a significant regression to take that away from them.


In that case, the best solution is probably to use a custom class for this. It would behave exactly like a Python `list` (or `tuple`) in all possible ways, except that it would be sorted on display.



---

archive/issue_comments_306812.json:
```json
{
    "body": "Replying to [comment:17 nbruin]:\n> Display functions in IPython have hooks for nice sorting (used for dicts and sets), so if graphs need to display their keys and edges in a nice way, that's probably the hook to go for.\n\n\nNils, I only just saw your comment now. But yes, this was exactly my point too.",
    "created_at": "2017-11-06T12:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306812",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:17 nbruin]:
> Display functions in IPython have hooks for nice sorting (used for dicts and sets), so if graphs need to display their keys and edges in a nice way, that's probably the hook to go for.


Nils, I only just saw your comment now. But yes, this was exactly my point too.



---

archive/issue_comments_306813.json:
```json
{
    "body": "Replying to [comment:17 nbruin]:\n> Algorithms that need their edges sorted should either insist on sortable labels or sort by index tuples or something like that (something that is guaranteed to be sortable regardless of what the user decides to use as labels). \n\n\nThey could simply sort by `id()`, provided that the same label is not represented by several physically distinct objects that compare equal. Unfortunately, this probably does happen (see #22374).",
    "created_at": "2017-11-06T12:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306813",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:17 nbruin]:
> Algorithms that need their edges sorted should either insist on sortable labels or sort by index tuples or something like that (something that is guaranteed to be sortable regardless of what the user decides to use as labels). 


They could simply sort by `id()`, provided that the same label is not represented by several physically distinct objects that compare equal. Unfortunately, this probably does happen (see #22374).



---

archive/issue_comments_306814.json:
```json
{
    "body": "Replying to [comment:20 mmezzarobba]:\n> They could simply sort by `id()`\n\n\nIf you want to sort by `id()`, what is the purpose of sorting at all? I mean, it's not sorting, it's putting in a deterministic (but otherwise arbitrary) order. Assuming that methods like `vertices()` return the vertices in a deterministic order, I don't see the point.",
    "created_at": "2017-11-06T12:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306814",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:20 mmezzarobba]:
> They could simply sort by `id()`


If you want to sort by `id()`, what is the purpose of sorting at all? I mean, it's not sorting, it's putting in a deterministic (but otherwise arbitrary) order. Assuming that methods like `vertices()` return the vertices in a deterministic order, I don't see the point.



---

archive/issue_comments_306815.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> Replying to [comment:20 mmezzarobba]:\n> > They could simply sort by `id()`\n\n> \n> If you want to sort by `id()`, what is the purpose of sorting at all? I mean, it's not sorting, it's putting in a deterministic (but otherwise arbitrary) order. Assuming that methods like `vertices()` return the vertices in a deterministic order, I don't see the point.\n\n\nAll I'm saying is that some algorithms do want to access the vertices in some arbitrary deterministic order, typically in order to iterate over the unordered pairs {v,v'}, and, as far as I remember, currently rely on the output of `vertices()` etc. being sorted to do that. If all the methods these algorithms use to access the vertices return them in the same deterministic order, then indeed, there is no need to do anything, otherwise, sorting by `id()` may be a better option than requiring the labels to be ordered.",
    "created_at": "2017-11-06T13:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306815",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:21 jdemeyer]:
> Replying to [comment:20 mmezzarobba]:
> > They could simply sort by `id()`

> 
> If you want to sort by `id()`, what is the purpose of sorting at all? I mean, it's not sorting, it's putting in a deterministic (but otherwise arbitrary) order. Assuming that methods like `vertices()` return the vertices in a deterministic order, I don't see the point.


All I'm saying is that some algorithms do want to access the vertices in some arbitrary deterministic order, typically in order to iterate over the unordered pairs {v,v'}, and, as far as I remember, currently rely on the output of `vertices()` etc. being sorted to do that. If all the methods these algorithms use to access the vertices return them in the same deterministic order, then indeed, there is no need to do anything, otherwise, sorting by `id()` may be a better option than requiring the labels to be ordered.



---

archive/issue_events_058551.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-29T12:51:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58551"
}
```



---

archive/issue_comments_306816.json:
```json
{
    "body": "Changing keywords from \"\" to \"richcmp\".",
    "created_at": "2018-03-29T12:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306816",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "richcmp".



---

archive/issue_comments_306817.json:
```json
{
    "body": "Changing keywords from \"richcmp\" to \"python3, richcmp\".",
    "created_at": "2018-07-11T15:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306817",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "richcmp" to "python3, richcmp".



---

archive/issue_events_058552.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-08-30T15:51:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58552"
}
```



---

archive/issue_events_058553.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-08-30T15:51:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58553"
}
```



---

archive/issue_comments_306818.json:
```json
{
    "body": "Apart from the need for ensuring that the internal order of vertices/edges during iterations is always the same (many algorithms assume that we have such a fixed order, whatever it is) and doing our best to preserve a nice display for interactive use, I think we have another issue:\n- For an edge `(u, v, label)` in an undirected graph, we usually have `u <= v`. So somehow we have a sorting here and many algorithms assume that vertices are ordered (not all). If I understand well, it is a problem with Python3 if vertex labels are of different types. We must find a solution for that.\n- In many algorithms, we have tests like `if u < v`. Again a big problem.\nSo what can we do ?\n\nThe only good news here is that vertices must be immutable.",
    "created_at": "2018-08-31T16:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306818",
    "user": "https://github.com/dcoudert"
}
```

Apart from the need for ensuring that the internal order of vertices/edges during iterations is always the same (many algorithms assume that we have such a fixed order, whatever it is) and doing our best to preserve a nice display for interactive use, I think we have another issue:
- For an edge `(u, v, label)` in an undirected graph, we usually have `u <= v`. So somehow we have a sorting here and many algorithms assume that vertices are ordered (not all). If I understand well, it is a problem with Python3 if vertex labels are of different types. We must find a solution for that.
- In many algorithms, we have tests like `if u < v`. Again a big problem.
So what can we do ?

The only good news here is that vertices must be immutable.



---

archive/issue_comments_306819.json:
```json
{
    "body": "#26169 Trial for not sorting multiple edges",
    "created_at": "2018-09-01T09:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306819",
    "user": "https://github.com/dcoudert"
}
```

#26169 Trial for not sorting multiple edges



---

archive/issue_comments_306820.json:
```json
{
    "body": "Do we already have a plan for this ticket? I know that there have many graph-related Python 3 tickets, but I'm a bit lost on the overall plan.",
    "created_at": "2019-01-07T08:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306820",
    "user": "https://github.com/jdemeyer"
}
```

Do we already have a plan for this ticket? I know that there have many graph-related Python 3 tickets, but I'm a bit lost on the overall plan.



---

archive/issue_comments_306821.json:
```json
{
    "body": "I am asking because there are now only a handful of doctest failures remaining in #22029 and they are almost all due to sorting in graphs.",
    "created_at": "2019-01-07T08:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306821",
    "user": "https://github.com/jdemeyer"
}
```

I am asking because there are now only a handful of doctest failures remaining in #22029 and they are almost all due to sorting in graphs.



---

archive/issue_comments_306822.json:
```json
{
    "body": "There are 3 different points here: 1) sorting the list of vertices, 2) sorting the list of edges, and 3) sorting the vertices of an edge.\n\nFor 1), we made huge progresses in reducing the dependency of methods to `.vertices()`. I'm not sure how many methods still rely on it. Most of them now use the ordering given by  `list(G)` without making specific assumption on that order. We create a mapping when needed, and pass it to some methods. We can certainly completely avoid that dependency, but can we do that without deprecation ? \n\nFor 2), similarly, we have reduced the number of methods relying on `.edges()`, plus we can use `sort=False` parameter. We can try and see...\n\n3) is more tricky and I don't know how to do that yet.",
    "created_at": "2019-01-07T08:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306822",
    "user": "https://github.com/dcoudert"
}
```

There are 3 different points here: 1) sorting the list of vertices, 2) sorting the list of edges, and 3) sorting the vertices of an edge.

For 1), we made huge progresses in reducing the dependency of methods to `.vertices()`. I'm not sure how many methods still rely on it. Most of them now use the ordering given by  `list(G)` without making specific assumption on that order. We create a mapping when needed, and pass it to some methods. We can certainly completely avoid that dependency, but can we do that without deprecation ? 

For 2), similarly, we have reduced the number of methods relying on `.edges()`, plus we can use `sort=False` parameter. We can try and see...

3) is more tricky and I don't know how to do that yet.



---

archive/issue_comments_306823.json:
```json
{
    "body": "For 1) there is still an issue with `relabel()`: #27027",
    "created_at": "2019-01-07T09:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306823",
    "user": "https://github.com/jdemeyer"
}
```

For 1) there is still an issue with `relabel()`: #27027



---

archive/issue_comments_306824.json:
```json
{
    "body": "And one more with `graph_isom_equivalent_non_edge_labeled_graph()`: #27029",
    "created_at": "2019-01-07T15:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306824",
    "user": "https://github.com/jdemeyer"
}
```

And one more with `graph_isom_equivalent_non_edge_labeled_graph()`: #27029



---

archive/issue_events_058554.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-22T21:09:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58554"
}
```



---

archive/issue_events_058555.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-22T21:09:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58555"
}
```



---

archive/issue_comments_306825.json:
```json
{
    "body": "We have now drastically reduced the dependency to `.vertices()` and `.edges()` in the graph module (except in doctests, but we can specify `sort=True` or just change the expected output). \nWe must now identify the remaining tasks to do and schedule the work. I propose to do that in #26640 to get a full picture.",
    "created_at": "2019-02-23T10:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306825",
    "user": "https://github.com/dcoudert"
}
```

We have now drastically reduced the dependency to `.vertices()` and `.edges()` in the graph module (except in doctests, but we can specify `sort=True` or just change the expected output). 
We must now identify the remaining tasks to do and schedule the work. I propose to do that in #26640 to get a full picture.



---

archive/issue_comments_306826.json:
```json
{
    "body": "Here is a concrete proposal for this ticket:\n\n1. If no `sort` option is given (the default), give a deprecation and try to sort but fail gracefully if the input is not sortable.\n\n2. If a `sort` option is given, do as before.",
    "created_at": "2019-02-24T13:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306826",
    "user": "https://github.com/jdemeyer"
}
```

Here is a concrete proposal for this ticket:

1. If no `sort` option is given (the default), give a deprecation and try to sort but fail gracefully if the input is not sortable.

2. If a `sort` option is given, do as before.



---

archive/issue_comments_306827.json:
```json
{
    "body": "I also like the idea that somebody posted on sage-devel (I don't remember who) that `.vertices()` and `.edges()` should return a \"view\" which could have various operations on it.",
    "created_at": "2019-02-24T13:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306827",
    "user": "https://github.com/jdemeyer"
}
```

I also like the idea that somebody posted on sage-devel (I don't remember who) that `.vertices()` and `.edges()` should return a "view" which could have various operations on it.



---

archive/issue_comments_306828.json:
```json
{
    "body": "It's Thierry ([this message](https://groups.google.com/d/msg/sage-devel/uEHBKekJ_Cw/peoyx4PaBQAJ)). I also like this idea. Should we do that here, before in another ticket, or later ?\n\n\nNetworkx now also use views [networkx.Graph.edges](https://networkx.github.io/documentation/latest/reference/classes/generated/networkx.Graph.edges.html#networkx.Graph.edges).",
    "created_at": "2019-02-24T13:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306828",
    "user": "https://github.com/dcoudert"
}
```

It's Thierry ([this message](https://groups.google.com/d/msg/sage-devel/uEHBKekJ_Cw/peoyx4PaBQAJ)). I also like this idea. Should we do that here, before in another ticket, or later ?


Networkx now also use views [networkx.Graph.edges](https://networkx.github.io/documentation/latest/reference/classes/generated/networkx.Graph.edges.html#networkx.Graph.edges).



---

archive/issue_comments_306829.json:
```json
{
    "body": "A proposal for an `EdgeView` in #27408.",
    "created_at": "2019-03-03T21:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306829",
    "user": "https://github.com/dcoudert"
}
```

A proposal for an `EdgeView` in #27408.



---

archive/issue_comments_306830.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306830",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_058556.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58556"
}
```



---

archive/issue_events_058557.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58557"
}
```



---

archive/issue_comments_306831.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306831",
    "user": "https://github.com/embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_events_058558.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:54:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58558"
}
```



---

archive/issue_comments_306832.json:
```json
{
    "body": "Now that we have EdgesView #27408 and Python3, we have few remaining methods methods effectively relying on the order of the vertices and/or edges. So we should restart working on this ticket for 9.2.",
    "created_at": "2020-04-18T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306832",
    "user": "https://github.com/dcoudert"
}
```

Now that we have EdgesView #27408 and Python3, we have few remaining methods methods effectively relying on the order of the vertices and/or edges. So we should restart working on this ticket for 9.2.



---

archive/issue_events_058559.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-04-18T10:16:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58559"
}
```



---

archive/issue_comments_306833.json:
```json
{
    "body": "With #30145, we propose to deprecate `edge_iterator`, thus generalizing the use of `.edges` method and so of `EdgesView`. After that, it should be easier to deprecate sorting edges by default.",
    "created_at": "2020-07-15T12:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306833",
    "user": "https://github.com/dcoudert"
}
```

With #30145, we propose to deprecate `edge_iterator`, thus generalizing the use of `.edges` method and so of `EdgesView`. After that, it should be easier to deprecate sorting edges by default.



---

archive/issue_events_058560.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58560"
}
```



---

archive/issue_events_058561.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58561"
}
```



---

archive/issue_comments_306834.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306834",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_058562.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58562"
}
```



---

archive/issue_events_058563.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58563"
}
```



---

archive/issue_events_058564.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58564"
}
```



---

archive/issue_events_058565.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58565"
}
```



---

archive/issue_events_058566.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58566"
}
```



---

archive/issue_events_058567.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58567"
}
```



---

archive/issue_comments_306835.json:
```json
{
    "body": "Actually, #27408 has silently (not mentioned in the ticket) introduced a deprecation warning for sorting edges by default, but it is used in method `.edges(...)` only when `sort is None` and the default value of `sort` is `True`. So I think no-one is aware of it.\n\nI'm not sure how to make this deprecation warning visible without breaking numerous doctests.",
    "created_at": "2022-03-10T15:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306835",
    "user": "https://github.com/dcoudert"
}
```

Actually, #27408 has silently (not mentioned in the ticket) introduced a deprecation warning for sorting edges by default, but it is used in method `.edges(...)` only when `sort is None` and the default value of `sort` is `True`. So I think no-one is aware of it.

I'm not sure how to make this deprecation warning visible without breaking numerous doctests.



---

archive/issue_events_058568.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58568"
}
```



---

archive/issue_events_058569.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58569"
}
```



---

archive/issue_comments_306836.json:
```json
{
    "body": "Replying to [comment:52 dcoudert]:\n> Actually, #27408 has silently (not mentioned in the ticket) introduced a deprecation warning for sorting edges by default, but it is used in method `.edges(...)` only when `sort is None` and the default value of `sort` is `True`. So I think no-one is aware of it.\n> \n> I'm not sure how to make this deprecation warning visible without breaking numerous doctests.\n\n\nI'd be interested in seeing this ticket resolved, perhaps you could ask about how to go about this deprecation on sage-devel? Or I am happy to follow this up if you'd prefer.",
    "created_at": "2022-06-28T12:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306836",
    "user": "https://github.com/alexjbest"
}
```

Replying to [comment:52 dcoudert]:
> Actually, #27408 has silently (not mentioned in the ticket) introduced a deprecation warning for sorting edges by default, but it is used in method `.edges(...)` only when `sort is None` and the default value of `sort` is `True`. So I think no-one is aware of it.
> 
> I'm not sure how to make this deprecation warning visible without breaking numerous doctests.


I'd be interested in seeing this ticket resolved, perhaps you could ask about how to go about this deprecation on sage-devel? Or I am happy to follow this up if you'd prefer.



---

archive/issue_comments_306837.json:
```json
{
    "body": "The difficulty is that we still have some methods relying on `.vertices()`, and I don't know how to avoid that.\n\nFor instance in `graph.py`: `effective_resistance_matrix`, `common_neighbors_matrix`, `orientations` (but this one can be avoided easily), `chromatic_quasisymmetric_function`, `twograph`, `write_to_eps`. And there might be other modules using graphs and relying on the ordering of the vertices given by `.vertices()` (e.g., `combinat`, `geometry`, `groups`, `matroids`, `schemes`, `topology`, etc..\n\nSo the first step might be to identify methods/modules relying on `.vertices()` and try to modify them. Once done, we will be able to safely deprecate sorting by default.",
    "created_at": "2022-06-28T13:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306837",
    "user": "https://github.com/dcoudert"
}
```

The difficulty is that we still have some methods relying on `.vertices()`, and I don't know how to avoid that.

For instance in `graph.py`: `effective_resistance_matrix`, `common_neighbors_matrix`, `orientations` (but this one can be avoided easily), `chromatic_quasisymmetric_function`, `twograph`, `write_to_eps`. And there might be other modules using graphs and relying on the ordering of the vertices given by `.vertices()` (e.g., `combinat`, `geometry`, `groups`, `matroids`, `schemes`, `topology`, etc..

So the first step might be to identify methods/modules relying on `.vertices()` and try to modify them. Once done, we will be able to safely deprecate sorting by default.



---

archive/issue_comments_306838.json:
```json
{
    "body": "The `.vertices()` method is probably used lots of times, but one fix could be:\n\n- every time it's used, add the argument `sort=False` or `sort=True` as necessary,\n- and then change the default to `sort=False`.\n\nMaybe it's easier with edges: add the explicit argument everywhere and then change the default to `None`.\n\nOr is that too na\u00efve? I tried this change:\n\n```diff\ndiff --git a/src/sage/graphs/graph.py b/src/sage/graphs/graph.py\nindex 1579f23ad8..5dbb937b6b 100644\n--- a/src/sage/graphs/graph.py\n+++ b/src/sage/graphs/graph.py\n@@ -3480,7 +3480,7 @@ class Graph(GenericGraph):\n             name = 'An orientation of ' + name\n \n         if not self.size():\n-            D = DiGraph(data=[self.vertices(), []],\n+            D = DiGraph(data=[self.vertices(sort=False), []],\n                         format='vertices_and_edges',\n                         name=name,\n                         pos=self._pos,\n@@ -3494,7 +3494,7 @@ class Graph(GenericGraph):\n \n         E = [[(u,v,label), (v,u,label)] if u != v else [(u,v,label)]\n              for u,v,label in self.edge_iterator()]\n-        verts = self.vertices()\n+        verts = self.vertices(sort=False)\n         for edges in itertools.product(*E):\n             D = DiGraph(data=[verts, edges],\n                         format='vertices_and_edges',\n@@ -4009,7 +4009,7 @@ class Graph(GenericGraph):\n             R = t.parent()\n         M = QuasiSymmetricFunctions(R).M()\n         ret = M.zero()\n-        V = self.vertices()\n+        V = self.vertices(sort=False)\n \n         def asc(sigma):\n             stat = 0\n@@ -6185,7 +6185,7 @@ class Graph(GenericGraph):\n                 T.append([x, y, z])\n \n         T = TwoGraph(T)\n-        T.relabel({i: v for i,v in enumerate(self.vertices())})\n+        T.relabel({i: v for i,v in enumerate(self.vertices(sort=False))})\n \n         return T\n \n@@ -6221,7 +6221,7 @@ class Graph(GenericGraph):\n         if filename[-4:] != '.eps':\n             filename += '.eps'\n         f = open(filename, 'w')\n-        f.write( print_graph_eps(self.vertices(), self.edge_iterator(), pos) )\n+        f.write( print_graph_eps(self.vertices(sort=False), self.edge_iterator(), pos) )\n         f.close()\n \n     @doc_index(\"Algorithmically hard stuff\")\n@@ -7940,7 +7940,7 @@ class Graph(GenericGraph):\n             D = None\n         elif self.order() == 1:\n             D = create_prime_node()\n-            D.children.append(create_normal_node(self.vertices()[0]))\n+            D.children.append(create_normal_node(self.vertices(sort=False)[0]))\n         else:\n             D = habib_maurer_algorithm(self)\n \n@@ -9225,7 +9225,7 @@ class Graph(GenericGraph):\n         if not n:\n             raise ValueError('unable to compute effective resistance for an empty Graph object')\n         if vertices is None:\n-            vertices = self.vertices()\n+            vertices = self.vertices(sort=False)\n         self._scream_if_not_simple()\n         if not self.is_connected():\n             raise ValueError('the Graph is not a connected graph')\n@@ -9458,7 +9458,7 @@ class Graph(GenericGraph):\n         \"\"\"\n         self._scream_if_not_simple()\n         if vertices is None:\n-            vertices = self.vertices()\n+            vertices = self.vertices(sort=False)\n         set_immutable = kwds.pop('immutable', False)\n         A = self.adjacency_matrix(vertices=vertices, base_ring=base_ring, immutable=True, **kwds)\n         M = A**2\n```\nand all tests in the graphs directory still passed.",
    "created_at": "2022-06-28T22:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306838",
    "user": "https://github.com/jhpalmieri"
}
```

The `.vertices()` method is probably used lots of times, but one fix could be:

- every time it's used, add the argument `sort=False` or `sort=True` as necessary,
- and then change the default to `sort=False`.

Maybe it's easier with edges: add the explicit argument everywhere and then change the default to `None`.

Or is that too nave? I tried this change:

```diff
diff --git a/src/sage/graphs/graph.py b/src/sage/graphs/graph.py
index 1579f23ad8..5dbb937b6b 100644
--- a/src/sage/graphs/graph.py
+++ b/src/sage/graphs/graph.py
@@ -3480,7 +3480,7 @@ class Graph(GenericGraph):
             name = 'An orientation of ' + name
 
         if not self.size():
-            D = DiGraph(data=[self.vertices(), []],
+            D = DiGraph(data=[self.vertices(sort=False), []],
                         format='vertices_and_edges',
                         name=name,
                         pos=self._pos,
@@ -3494,7 +3494,7 @@ class Graph(GenericGraph):
 
         E = [[(u,v,label), (v,u,label)] if u != v else [(u,v,label)]
              for u,v,label in self.edge_iterator()]
-        verts = self.vertices()
+        verts = self.vertices(sort=False)
         for edges in itertools.product(*E):
             D = DiGraph(data=[verts, edges],
                         format='vertices_and_edges',
@@ -4009,7 +4009,7 @@ class Graph(GenericGraph):
             R = t.parent()
         M = QuasiSymmetricFunctions(R).M()
         ret = M.zero()
-        V = self.vertices()
+        V = self.vertices(sort=False)
 
         def asc(sigma):
             stat = 0
@@ -6185,7 +6185,7 @@ class Graph(GenericGraph):
                 T.append([x, y, z])
 
         T = TwoGraph(T)
-        T.relabel({i: v for i,v in enumerate(self.vertices())})
+        T.relabel({i: v for i,v in enumerate(self.vertices(sort=False))})
 
         return T
 
@@ -6221,7 +6221,7 @@ class Graph(GenericGraph):
         if filename[-4:] != '.eps':
             filename += '.eps'
         f = open(filename, 'w')
-        f.write( print_graph_eps(self.vertices(), self.edge_iterator(), pos) )
+        f.write( print_graph_eps(self.vertices(sort=False), self.edge_iterator(), pos) )
         f.close()
 
     @doc_index("Algorithmically hard stuff")
@@ -7940,7 +7940,7 @@ class Graph(GenericGraph):
             D = None
         elif self.order() == 1:
             D = create_prime_node()
-            D.children.append(create_normal_node(self.vertices()[0]))
+            D.children.append(create_normal_node(self.vertices(sort=False)[0]))
         else:
             D = habib_maurer_algorithm(self)
 
@@ -9225,7 +9225,7 @@ class Graph(GenericGraph):
         if not n:
             raise ValueError('unable to compute effective resistance for an empty Graph object')
         if vertices is None:
-            vertices = self.vertices()
+            vertices = self.vertices(sort=False)
         self._scream_if_not_simple()
         if not self.is_connected():
             raise ValueError('the Graph is not a connected graph')
@@ -9458,7 +9458,7 @@ class Graph(GenericGraph):
         """
         self._scream_if_not_simple()
         if vertices is None:
-            vertices = self.vertices()
+            vertices = self.vertices(sort=False)
         set_immutable = kwds.pop('immutable', False)
         A = self.adjacency_matrix(vertices=vertices, base_ring=base_ring, immutable=True, **kwds)
         M = A**2
```
and all tests in the graphs directory still passed.



---

archive/issue_comments_306839.json:
```json
{
    "body": "We cannot blindly use `.vertices(sort=False)`. It will clearly break badly some methods, for instance methods building adjacency or laplacian matrices, etc.\nWe already pave the way by reducing the number of situations in which we call `.vertices()`, but we still have work to do to reduce the dependency. We did the same for `.edges()`.\n\nThe safe way is to use only `.vertices(sort=True)`, and whenever possible, avoid calls to `.vertices()`. For instance, I see in `generic_graph.py` a call to `self.vertices(sort=False)[0]` while we have `self.order() == 1`. So we can avoid this call.\n\nThen, we can set the default to `None` with a deprecation warning that the default will be changed to `False`.",
    "created_at": "2022-06-29T06:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306839",
    "user": "https://github.com/dcoudert"
}
```

We cannot blindly use `.vertices(sort=False)`. It will clearly break badly some methods, for instance methods building adjacency or laplacian matrices, etc.
We already pave the way by reducing the number of situations in which we call `.vertices()`, but we still have work to do to reduce the dependency. We did the same for `.edges()`.

The safe way is to use only `.vertices(sort=True)`, and whenever possible, avoid calls to `.vertices()`. For instance, I see in `generic_graph.py` a call to `self.vertices(sort=False)[0]` while we have `self.order() == 1`. So we can avoid this call.

Then, we can set the default to `None` with a deprecation warning that the default will be changed to `False`.



---

archive/issue_comments_306840.json:
```json
{
    "body": "Replying to [comment:57 dcoudert]:\n> We cannot blindly use `.vertices(sort=False)`.\n\n\nThat's not what I suggested. Please reread the first bullet point.",
    "created_at": "2022-06-30T04:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306840",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:57 dcoudert]:
> We cannot blindly use `.vertices(sort=False)`.


That's not what I suggested. Please reread the first bullet point.



---

archive/issue_comments_306841.json:
```json
{
    "body": "Right, I missed some parts.\nI agree with your proposal, but we need an appropriate deprecation warning to inform users of the change. It's a big change.",
    "created_at": "2022-06-30T09:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306841",
    "user": "https://github.com/dcoudert"
}
```

Right, I missed some parts.
I agree with your proposal, but we need an appropriate deprecation warning to inform users of the change. It's a big change.



---

archive/issue_comments_306842.json:
```json
{
    "body": "The best I can think of right now is:\n\n- Make the default `sort=None` and raise a deprecation warning if this default gets used, thereby requiring an explicit argument everywhere in the Sage library.\n\n- So use `sort=False` or `sort=True` as appropriate in the library.\n\nThen later we can change the default to `sort=False`.",
    "created_at": "2022-07-15T21:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306842",
    "user": "https://github.com/jhpalmieri"
}
```

The best I can think of right now is:

- Make the default `sort=None` and raise a deprecation warning if this default gets used, thereby requiring an explicit argument everywhere in the Sage library.

- So use `sort=False` or `sort=True` as appropriate in the library.

Then later we can change the default to `sort=False`.



---

archive/issue_comments_306843.json:
```json
{
    "body": "Here is a start. This does what I proposed in comment:60, and all tests pass. I was not that careful in choosing `sort=True` or `sort=False`, and so I would not surprised if we could use `sort=False` in more places. Feel free to modify the branch.\n\n---\nNew commits:",
    "created_at": "2022-07-16T01:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306843",
    "user": "https://github.com/jhpalmieri"
}
```

Here is a start. This does what I proposed in comment:60, and all tests pass. I was not that careful in choosing `sort=True` or `sort=False`, and so I would not surprised if we could use `sort=False` in more places. Feel free to modify the branch.

---
New commits:



---

archive/issue_comments_306844.json:
```json
{
    "body": "The key changes are in `graphs/generic_graph.py`:\n\n```diff\n@@ -10972,15 +10974,20 @@ class GenericGraph(GenericGraph_pyx):\n         for u in self._backend.iterator_nbrs(vertex):\n             yield u\n \n-    def vertices(self, sort=True, key=None, degree=None, vertex_property=None):\n+    def vertices(self, sort=None, key=None, degree=None, vertex_property=None):\n         r\"\"\"\n         Return a list of the vertices.\n \n         INPUT:\n \n-        - ``sort`` -- boolean (default: ``True``); if ``True``, vertices are\n+        - ``sort`` -- boolean (default: ``None``); if ``True``, vertices are\n           sorted according to the default ordering\n \n+          As of :trac:`22349`, this argument must be explicitly\n+          specified (unless a ``key`` is given); otherwise a warning\n+          is printed and ``sort=True`` is used. The default will\n+          eventually be changed to ``False``.\n+\n         - ``key`` -- a function (default: ``None``); a function that takes a\n           vertex as its one argument and returns a value that can be used for\n           comparisons in the sorting algorithm (we must have ``sort=True``)\n```\nand\n\n```diff\n@@ -11065,9 +11072,23 @@ class GenericGraph(GenericGraph_pyx):\n             Traceback (most recent call last):\n             ...\n             ValueError: sort keyword is False, yet a key function is given\n+\n+        Deprecation warning for ``sort=None`` (:trac:`22349`)::\n+\n+            sage: G = graphs.HouseGraph()\n+            sage: G.vertices()\n+            doctest:...: DeprecationWarning: parameter 'sort' will be set to False by default in the future\n+            See http://trac.sagemath.org/22349 for details.\n+            [0, 1, 2, 3, 4]\n         \"\"\"\n+        if sort is None:\n+            if key is None:\n+                deprecation(22349, \"parameter 'sort' will be set to False by default in the future\")\n+            sort = True\n+\n         if (not sort) and key:\n             raise ValueError('sort keyword is False, yet a key function is given')\n+\n         if sort:\n             return sorted(self.vertex_iterator(degree=degree, vertex_property=vertex_property), key=key)\n         return list(self.vertex_iterator(degree=degree, vertex_property=vertex_property))\n```\nand similar for `edges` (although `edges` already printed a warning if `None` was used, but `None` was not the default, so it had to be called explicitly as `g.edges(sort=None)` to trigger the warning before).",
    "created_at": "2022-07-16T01:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306844",
    "user": "https://github.com/jhpalmieri"
}
```

The key changes are in `graphs/generic_graph.py`:

```diff
@@ -10972,15 +10974,20 @@ class GenericGraph(GenericGraph_pyx):
         for u in self._backend.iterator_nbrs(vertex):
             yield u
 
-    def vertices(self, sort=True, key=None, degree=None, vertex_property=None):
+    def vertices(self, sort=None, key=None, degree=None, vertex_property=None):
         r"""
         Return a list of the vertices.
 
         INPUT:
 
-        - ``sort`` -- boolean (default: ``True``); if ``True``, vertices are
+        - ``sort`` -- boolean (default: ``None``); if ``True``, vertices are
           sorted according to the default ordering
 
+          As of :trac:`22349`, this argument must be explicitly
+          specified (unless a ``key`` is given); otherwise a warning
+          is printed and ``sort=True`` is used. The default will
+          eventually be changed to ``False``.
+
         - ``key`` -- a function (default: ``None``); a function that takes a
           vertex as its one argument and returns a value that can be used for
           comparisons in the sorting algorithm (we must have ``sort=True``)
```
and

```diff
@@ -11065,9 +11072,23 @@ class GenericGraph(GenericGraph_pyx):
             Traceback (most recent call last):
             ...
             ValueError: sort keyword is False, yet a key function is given
+
+        Deprecation warning for ``sort=None`` (:trac:`22349`)::
+
+            sage: G = graphs.HouseGraph()
+            sage: G.vertices()
+            doctest:...: DeprecationWarning: parameter 'sort' will be set to False by default in the future
+            See http://trac.sagemath.org/22349 for details.
+            [0, 1, 2, 3, 4]
         """
+        if sort is None:
+            if key is None:
+                deprecation(22349, "parameter 'sort' will be set to False by default in the future")
+            sort = True
+
         if (not sort) and key:
             raise ValueError('sort keyword is False, yet a key function is given')
+
         if sort:
             return sorted(self.vertex_iterator(degree=degree, vertex_property=vertex_property), key=key)
         return list(self.vertex_iterator(degree=degree, vertex_property=vertex_property))
```
and similar for `edges` (although `edges` already printed a warning if `None` was used, but `None` was not the default, so it had to be called explicitly as `g.edges(sort=None)` to trigger the warning before).



---

archive/issue_comments_306845.json:
```json
{
    "body": "I'm impressed !\n\nI'm currently doing some tests and will push later some corrections.",
    "created_at": "2022-07-16T18:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306845",
    "user": "https://github.com/dcoudert"
}
```

I'm impressed !

I'm currently doing some tests and will push later some corrections.



---

archive/issue_comments_306846.json:
```json
{
    "body": "I did a few changes in graphs and many tests. I have not detected any problem yet, but others may raise some issues.\n\nThis ticket highlights many places were the usage of graphs must be improved. I did some (minor) corrections in `src/sage/schemes/curves/zariski_vankampen.py` as example, but more can be done in this file.\nTypically, it is better to use `for u in G:` than `for u in G.vertices(sort=False):`. The ordering of the vertices is the same, but we avoid building the list of vertices. Tests like `u in G.vertices(sort=False)` should be replaced by `u in G`. etc.\nIn future tickets, we should address (very bad) code like this in `src/sage/geometry/hyperplane_arrangement/library.py`\n\n```diff\n-        for e in G.edges():\n-            i = G.vertices().index(e[0])\n-            j = G.vertices().index(e[1])\n+        for e in G.edges(sort=True):\n+            i = G.vertices(sort=True).index(e[0])\n+            j = G.vertices(sort=True).index(e[1])\n```\nClearly, we need to define a mapping from vertices to index.\n\n---\nNew commits:",
    "created_at": "2022-07-17T09:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306846",
    "user": "https://github.com/dcoudert"
}
```

I did a few changes in graphs and many tests. I have not detected any problem yet, but others may raise some issues.

This ticket highlights many places were the usage of graphs must be improved. I did some (minor) corrections in `src/sage/schemes/curves/zariski_vankampen.py` as example, but more can be done in this file.
Typically, it is better to use `for u in G:` than `for u in G.vertices(sort=False):`. The ordering of the vertices is the same, but we avoid building the list of vertices. Tests like `u in G.vertices(sort=False)` should be replaced by `u in G`. etc.
In future tickets, we should address (very bad) code like this in `src/sage/geometry/hyperplane_arrangement/library.py`

```diff
-        for e in G.edges():
-            i = G.vertices().index(e[0])
-            j = G.vertices().index(e[1])
+        for e in G.edges(sort=True):
+            i = G.vertices(sort=True).index(e[0])
+            j = G.vertices(sort=True).index(e[1])
```
Clearly, we need to define a mapping from vertices to index.

---
New commits:



---

archive/issue_comments_306847.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-17T09:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306847",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_306848.json:
```json
{
    "body": "Great! I'm happy with your changes. We can try to get it merged soon, although with this many files affected, there might very well be merge conflicts.",
    "created_at": "2022-07-17T16:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306848",
    "user": "https://github.com/jhpalmieri"
}
```

Great! I'm happy with your changes. We can try to get it merged soon, although with this many files affected, there might very well be merge conflicts.



---

archive/issue_comments_306849.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-07-17T16:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306849",
    "user": "https://github.com/jhpalmieri"
}
```

Changing priority from major to critical.



---

archive/issue_comments_306850.json:
```json
{
    "body": "Positive review from me for your contributions.",
    "created_at": "2022-07-17T16:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306850",
    "user": "https://github.com/jhpalmieri"
}
```

Positive review from me for your contributions.



---

archive/issue_comments_306851.json:
```json
{
    "body": "We will certainly get merge conflicts (due to the many tickets improving the coding style for instance), but let's try.\n\nPositive review from me too.",
    "created_at": "2022-07-17T16:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306851",
    "user": "https://github.com/dcoudert"
}
```

We will certainly get merge conflicts (due to the many tickets improving the coding style for instance), but let's try.

Positive review from me too.



---

archive/issue_comments_306852.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-17T16:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306852",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_306853.json:
```json
{
    "body": "Merge failure on top of:\n\n83a3df1c99 Trac #34131: some doc polishing in symbolic\n\ndee5229b00 Trac #34130: some doc polishing in groups\n\nfd80fa111f Trac #34126: some doc polishing in categories\n\n718d356f1c Trac #34125: some doc polishing in modular\n\n49390d8bcf Trac #34124: some doc polishing in combinat\n\naf94c25b54 Trac #34096: Fix typo: enviroment -> environment\n\nd04c189c8e Trac #34050: add some space around == in paths and rational\n\n1634bb6946 Trac #34047: Typo in _repr_Expression in symbolic/expression.pyx\n\ndc8086fd57 Trac #34154: Fix repeated word typos\n\n17b1c177aa Trac #34148: fix and activate pycodestyle E306\n\n785bdbd0ec Trac #34136: modernize super() in rings (part one)\n\n9882001355 Trac #34129: Dummy packages should write proper log files\n\ndbc6b9e161 Trac #34109: pep8 for sagedoc.py\n\n5e6a3318c8 Trac #34103: randomize infinite recursion\n\n17ba76f00b Trac #34093: Wrong evaluation of elements of CBF[x] on polynomials from other rings\n\n4657052737 Trac #34122: Bug in is_planar() method for directed graphs\n\nc9cfb5395f Trac #34087: inverse reciprocal trig functions not (back)translated to/from Mathematica\n\n1d6d055563 Trac #34076: pycodestyle cleanup in src/sage/graphs/genus.pyx\n\n043d862b5d Trac #34071: pycodestyle cleanup in asteroidal_triples.pyx, chrompoly.pyx, cliquer.pyx, convexity_properties.pyx\n\nb9b25dc735 Trac #34070: pycodestyle cleanup in src/sage/graphs/centrality.pyx\n\n4ef2c6597d Trac #34069: pycodestyle cleanup in src/sage/graphs/comparability.pyx\n\n5b1146766b Trac #34066: Tachyon help message\n\n798adaa5a3 Trac #34065: pycodestyle cleanup in src/sage/graphs/bliss.pyx\n\nce62be23a2 Trac #34063: pycodestyle cleanup in src/sage/graphs/base/\n\na0eadb3e40 Trac #34059: Fix trivial case in conversion of list to number field element\n\nfea0ac50a6 Trac #34057: changes about avoiding double dieses\n\n9eefd5c27e Trac #34145: modernize super in geometry/\n\n01e117dfd8 Trac #34137: modernize super in categories/\n\n6c79334402 Trac #33819: build.yml: In workflow_dispatch, make container and base tag selectable; add doc\n\n6a64ab8d00 Trac #33760: do not update _pos, _pos3d, _embedding on vertex/edge deletions\n\ndbf091dbbb Trac #34139: fix the linter\n\n625ac58151 Updated [SageMath](SageMath) version to 9.7.beta5\n\n\n\nmerge was not clean: conflicts in src/sage/groups/perm_gps/partn_ref/refinement_graphs.pyx",
    "created_at": "2022-07-18T19:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306853",
    "user": "https://github.com/vbraun"
}
```

Merge failure on top of:

83a3df1c99 Trac #34131: some doc polishing in symbolic

dee5229b00 Trac #34130: some doc polishing in groups

fd80fa111f Trac #34126: some doc polishing in categories

718d356f1c Trac #34125: some doc polishing in modular

49390d8bcf Trac #34124: some doc polishing in combinat

af94c25b54 Trac #34096: Fix typo: enviroment -> environment

d04c189c8e Trac #34050: add some space around == in paths and rational

1634bb6946 Trac #34047: Typo in _repr_Expression in symbolic/expression.pyx

dc8086fd57 Trac #34154: Fix repeated word typos

17b1c177aa Trac #34148: fix and activate pycodestyle E306

785bdbd0ec Trac #34136: modernize super() in rings (part one)

9882001355 Trac #34129: Dummy packages should write proper log files

dbc6b9e161 Trac #34109: pep8 for sagedoc.py

5e6a3318c8 Trac #34103: randomize infinite recursion

17ba76f00b Trac #34093: Wrong evaluation of elements of CBF[x] on polynomials from other rings

4657052737 Trac #34122: Bug in is_planar() method for directed graphs

c9cfb5395f Trac #34087: inverse reciprocal trig functions not (back)translated to/from Mathematica

1d6d055563 Trac #34076: pycodestyle cleanup in src/sage/graphs/genus.pyx

043d862b5d Trac #34071: pycodestyle cleanup in asteroidal_triples.pyx, chrompoly.pyx, cliquer.pyx, convexity_properties.pyx

b9b25dc735 Trac #34070: pycodestyle cleanup in src/sage/graphs/centrality.pyx

4ef2c6597d Trac #34069: pycodestyle cleanup in src/sage/graphs/comparability.pyx

5b1146766b Trac #34066: Tachyon help message

798adaa5a3 Trac #34065: pycodestyle cleanup in src/sage/graphs/bliss.pyx

ce62be23a2 Trac #34063: pycodestyle cleanup in src/sage/graphs/base/

a0eadb3e40 Trac #34059: Fix trivial case in conversion of list to number field element

fea0ac50a6 Trac #34057: changes about avoiding double dieses

9eefd5c27e Trac #34145: modernize super in geometry/

01e117dfd8 Trac #34137: modernize super in categories/

6c79334402 Trac #33819: build.yml: In workflow_dispatch, make container and base tag selectable; add doc

6a64ab8d00 Trac #33760: do not update _pos, _pos3d, _embedding on vertex/edge deletions

dbf091dbbb Trac #34139: fix the linter

625ac58151 Updated [SageMath](SageMath) version to 9.7.beta5



merge was not clean: conflicts in src/sage/groups/perm_gps/partn_ref/refinement_graphs.pyx



---

archive/issue_comments_306854.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-18T19:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306854",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306855.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-07-18T20:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306855",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_306856.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-18T20:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306856",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_306857.json:
```json
{
    "body": "Rebased over #34130.",
    "created_at": "2022-07-18T20:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306857",
    "user": "https://github.com/jhpalmieri"
}
```

Rebased over #34130.



---

archive/issue_comments_306858.json:
```json
{
    "body": "Merge failure on top of:\n\n7f7149489c Updated [SageMath](SageMath) version to 9.7.beta6\n\n\n\nmerge was not clean: conflicts in src/sage/combinat/yang_baxter_graph.py",
    "created_at": "2022-07-24T22:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306858",
    "user": "https://github.com/vbraun"
}
```

Merge failure on top of:

7f7149489c Updated [SageMath](SageMath) version to 9.7.beta6



merge was not clean: conflicts in src/sage/combinat/yang_baxter_graph.py



---

archive/issue_comments_306859.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-24T22:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306859",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306860.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-25T02:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306860",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306861.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-25T02:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306861",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_306862.json:
```json
{
    "body": "Merged 9.7.beta6.",
    "created_at": "2022-07-25T02:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306862",
    "user": "https://github.com/jhpalmieri"
}
```

Merged 9.7.beta6.



---

archive/issue_comments_306863.json:
```json
{
    "body": "Let's hope this one can be merged soon to avoid new conflicts.",
    "created_at": "2022-07-25T08:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306863",
    "user": "https://github.com/dcoudert"
}
```

Let's hope this one can be merged soon to avoid new conflicts.



---

archive/issue_comments_306864.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-28T21:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306864",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306865.json:
```json
{
    "body": "see patchbot",
    "created_at": "2022-07-28T21:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306865",
    "user": "https://github.com/vbraun"
}
```

see patchbot



---

archive/issue_comments_306866.json:
```json
{
    "body": "Replying to [comment:77 vbraun]:\n> see patchbot\n\n\nWhich part? I believe the \"deprecation number\" warning is from this change:\n\n```diff\n@@ -12229,7 +12255,8 @@ class GenericGraph(GenericGraph_pyx):\n             [(0, 1, None), (0, 2, None), (1, 3, None), (2, 3, None), (2, 4, None), (3, 4, None)]\n         \"\"\"\n         if sort is None:\n-            deprecation(27408, \"parameter 'sort' will be set to False by default in the future\")\n+            if key is None:\n+                deprecation(27408, \"parameter 'sort' will be set to False by default in the future\")\n             sort = True\n \n         if vertices is not None and vertices in self:\n```\nand that seems appropriate: no reason to change the ticket number. (That's the only match for \"27408\" in the changes for this ticket.)\n\nThe `pyflakes` warnings are not related to this ticket: they are in files touched by this ticket but not where we've modified them. (In addition, I don't understand the warning about `simplicial_complex.py`)",
    "created_at": "2022-07-28T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306866",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:77 vbraun]:
> see patchbot


Which part? I believe the "deprecation number" warning is from this change:

```diff
@@ -12229,7 +12255,8 @@ class GenericGraph(GenericGraph_pyx):
             [(0, 1, None), (0, 2, None), (1, 3, None), (2, 3, None), (2, 4, None), (3, 4, None)]
         """
         if sort is None:
-            deprecation(27408, "parameter 'sort' will be set to False by default in the future")
+            if key is None:
+                deprecation(27408, "parameter 'sort' will be set to False by default in the future")
             sort = True
 
         if vertices is not None and vertices in self:
```
and that seems appropriate: no reason to change the ticket number. (That's the only match for "27408" in the changes for this ticket.)

The `pyflakes` warnings are not related to this ticket: they are in files touched by this ticket but not where we've modified them. (In addition, I don't understand the warning about `simplicial_complex.py`)



---

archive/issue_comments_306867.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-28T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306867",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_306868.json:
```json
{
    "body": "It is more fundamental: there is a test failing for `src/sage/graphs/edge_connectivity.pyx`.",
    "created_at": "2022-07-29T02:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306868",
    "user": "https://github.com/tscrim"
}
```

It is more fundamental: there is a test failing for `src/sage/graphs/edge_connectivity.pyx`.



---

archive/issue_comments_306869.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-29T02:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306869",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_306870.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-29T05:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306871.json:
```json
{
    "body": "Doctest fixed.",
    "created_at": "2022-07-29T05:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306871",
    "user": "https://github.com/jhpalmieri"
}
```

Doctest fixed.



---

archive/issue_comments_306872.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-29T05:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306872",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_058570.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-04T22:47:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22112#event-58570"
}
```



---

archive/issue_comments_306873.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-04T22:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22112#issuecomment-306873",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
