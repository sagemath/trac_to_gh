# Issue 28004: Bug with NumberField.abs_val

archive/issues_028004.json:
```json
{
    "body": "CC:  @slel\n\nThe abs_val function from NumberField is incorrect : for a complex place it computes the square of the absolute value, and not the absolute value.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28241\n\n",
    "created_at": "2019-07-23T16:08:46Z",
    "labels": [
        "component: number fields",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Bug with NumberField.abs_val",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28004",
    "user": "https://trac.sagemath.org/admin/accounts/users/mercatp"
}
```
CC:  @slel

The abs_val function from NumberField is incorrect : for a complex place it computes the square of the absolute value, and not the absolute value.

Issue created by migration from https://trac.sagemath.org/ticket/28241





---

archive/issue_comments_395311.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-23T16:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395311",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_395312.json:
```json
{
    "body": "Changing keywords from \"\" to \"days100\".",
    "created_at": "2019-07-24T20:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395312",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "" to "days100".



---

archive/issue_comments_395313.json:
```json
{
    "body": "These changes introduce doctest failures in Sage\n\n```\n----------------------------------------------------------------------\nsage -t --long number_field/S_unit_solver.py  # 12 doctests failed\nsage -t --long number_field/number_field.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n",
    "created_at": "2019-07-25T11:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395313",
    "user": "https://github.com/videlec"
}
```

These changes introduce doctest failures in Sage

```
----------------------------------------------------------------------
sage -t --long number_field/S_unit_solver.py  # 12 doctests failed
sage -t --long number_field/number_field.py  # 2 doctests failed
----------------------------------------------------------------------
```




---

archive/issue_comments_395314.json:
```json
{
    "body": "It looks likes for every of these tests, it is enough to replace wrong result by the new one given by sage after introducting my change, and it's ok.\nBut I understand nothing to what is done by S_unit_solver.py, so I would'nt be able to say if the new values are really correct. \n\nReplying to [comment:7 vdelecroix]:\n> These changes introduce doctest failures in Sage\n> {{{\n> ----------------------------------------------------------------------\n> sage -t --long number_field/S_unit_solver.py  # 12 doctests failed\n> sage -t --long number_field/number_field.py  # 2 doctests failed\n> ----------------------------------------------------------------------\n> }}}",
    "created_at": "2019-07-25T12:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395314",
    "user": "https://trac.sagemath.org/admin/accounts/users/mercatp"
}
```

It looks likes for every of these tests, it is enough to replace wrong result by the new one given by sage after introducting my change, and it's ok.
But I understand nothing to what is done by S_unit_solver.py, so I would'nt be able to say if the new values are really correct. 

Replying to [comment:7 vdelecroix]:
> These changes introduce doctest failures in Sage
> {{{
> ----------------------------------------------------------------------
> sage -t --long number_field/S_unit_solver.py  # 12 doctests failed
> sage -t --long number_field/number_field.py  # 2 doctests failed
> ----------------------------------------------------------------------
> }}}



---

archive/issue_events_070253.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70253"
}
```



---

archive/issue_comments_395315.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395315",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_395316.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395316",
    "user": "https://github.com/mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_events_070254.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70254"
}
```



---

archive/issue_events_070255.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70255"
}
```



---

archive/issue_events_070256.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70256"
}
```



---

archive/issue_events_070257.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70257"
}
```



---

archive/issue_comments_395317.json:
```json
{
    "body": "Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395317",
    "user": "https://github.com/mkoeppe"
}
```

Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_070258.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70258"
}
```



---

archive/issue_events_070259.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70259"
}
```



---

archive/issue_comments_395318.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2021-07-21T13:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395318",
    "user": "https://github.com/slel"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_395319.json:
```json
{
    "body": "Please add examples illustrating the fix\nand the triangle inequality.",
    "created_at": "2021-07-21T13:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395319",
    "user": "https://github.com/slel"
}
```

Please add examples illustrating the fix
and the triangle inequality.



---

archive/issue_events_070260.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70260"
}
```



---

archive/issue_events_070261.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70261"
}
```



---

archive/issue_events_070262.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70262"
}
```



---

archive/issue_events_070263.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70263"
}
```



---

archive/issue_comments_395320.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28004#issuecomment-395320",
    "user": "https://github.com/mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_070264.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70264"
}
```



---

archive/issue_events_070265.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70265"
}
```



---

archive/issue_events_070266.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70266"
}
```



---

archive/issue_events_070267.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28004",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28004#event-70267"
}
```
