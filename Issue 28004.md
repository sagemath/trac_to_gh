# Issue 28004: Bug with NumberField.abs_val

Issue created by migration from https://trac.sagemath.org/ticket/28241

Original creator: mercatp

Original creation time: 2019-07-23 16:08:46

CC:  slelievre

The abs_val function from NumberField is incorrect : for a complex place it computes the square of the absolute value, and not the absolute value.


---

Comment by git created at 2019-07-23 16:13:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2019-07-24 20:30:40

Changing keywords from "" to "days100".


---

Comment by vdelecroix created at 2019-07-25 11:33:01

These changes introduce doctest failures in Sage

```
----------------------------------------------------------------------
sage -t --long number_field/S_unit_solver.py  # 12 doctests failed
sage -t --long number_field/number_field.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

Comment by mercatp created at 2019-07-25 12:31:56

It looks likes for every of these tests, it is enough to replace wrong result by the new one given by sage after introducting my change, and it's ok.
But I understand nothing to what is done by S_unit_solver.py, so I would'nt be able to say if the new values are really correct. 

Replying to [comment:7 vdelecroix]:
> These changes introduce doctest failures in Sage
> {{{
> ----------------------------------------------------------------------
> sage -t --long number_field/S_unit_solver.py  # 12 doctests failed
> sage -t --long number_field/number_field.py  # 2 doctests failed
> ----------------------------------------------------------------------
> }}}


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-05-10 17:42:09

Moving to 9.4, as 9.3 has been released.


---

Comment by slelievre created at 2021-07-21 13:52:34

Changing status from new to needs_info.


---

Comment by slelievre created at 2021-07-21 13:52:34

Please add examples illustrating the fix
and the triangle inequality.


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.
