# Issue 21905: log of algebraic number (QQbar element) gets inprecise

archive/issues_021905.json:
```json
{
    "body": "CC:  @behackl @cheuberg\n\nAt the moment we have\n\n```\nsage: log(QQbar(sqrt(2)))\n0.346573590279973\nsage: type(_)\n<type 'sage.rings.real_mpfr.RealNumber'>\n```\n\nSo the logarithm of an exact value loses the exactness.\n\nI would expect a symbolic expression\n\n```\nsage: log(QQbar(sqrt(2)))\nlog(1.414213562373095?)\n```\n\nwhere the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22142\n\n",
    "created_at": "2017-01-05T18:43:29Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "log of algebraic number (QQbar element) gets inprecise",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21905",
    "user": "https://github.com/dkrenn"
}
```
CC:  @behackl @cheuberg

At the moment we have

```
sage: log(QQbar(sqrt(2)))
0.346573590279973
sage: type(_)
<type 'sage.rings.real_mpfr.RealNumber'>
```

So the logarithm of an exact value loses the exactness.

I would expect a symbolic expression

```
sage: log(QQbar(sqrt(2)))
log(1.414213562373095?)
```

where the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.

Issue created by migration from https://trac.sagemath.org/ticket/22142





---

archive/issue_comments_303637.json:
```json
{
    "body": "I have a Pynac patch that does this:\n\n```\nsage: log(QQbar(sqrt(2)))\nlog(1.414213562373095?)\nsage: log(QQbar(sqrt(2))*1.)\n0.346573590279973\n```\n\nHowever, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).\n\nEDIT: or if not all functions, then which?",
    "created_at": "2017-01-07T07:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303637",
    "user": "https://github.com/rwst"
}
```

I have a Pynac patch that does this:

```
sage: log(QQbar(sqrt(2)))
log(1.414213562373095?)
sage: log(QQbar(sqrt(2))*1.)
0.346573590279973
```

However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).

EDIT: or if not all functions, then which?



---

archive/issue_comments_303638.json:
```json
{
    "body": "BTW `polylog` does it already, so this is clearly an inconsistency within Pynac:\n\n```\nsage: polylog(QQbar(sqrt(2)),3)\npolylog(1.414213562373095?, 3)\n```\n",
    "created_at": "2017-01-07T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303638",
    "user": "https://github.com/rwst"
}
```

BTW `polylog` does it already, so this is clearly an inconsistency within Pynac:

```
sage: polylog(QQbar(sqrt(2)),3)
polylog(1.414213562373095?, 3)
```




---

archive/issue_comments_303639.json:
```json
{
    "body": "Changing keywords from \"\" to \"Pynac\".",
    "created_at": "2017-01-07T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303639",
    "user": "https://github.com/rwst"
}
```

Changing keywords from "" to "Pynac".



---

archive/issue_comments_303640.json:
```json
{
    "body": "Replying to [comment:1 rws]:\n> I have a Pynac patch that does this:\n> {{{\n> sage: log(QQbar(sqrt(2)))\n> log(1.414213562373095?)\n> sage: log(QQbar(sqrt(2))*1.)\n> 0.346573590279973\n> }}}\n\nGood. Thanks :)\n\n> However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).\n>\n> EDIT: or if not all functions, then which?\n\nIMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?",
    "created_at": "2017-01-08T09:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303640",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:1 rws]:
> I have a Pynac patch that does this:
> {{{
> sage: log(QQbar(sqrt(2)))
> log(1.414213562373095?)
> sage: log(QQbar(sqrt(2))*1.)
> 0.346573590279973
> }}}

Good. Thanks :)

> However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).
>
> EDIT: or if not all functions, then which?

IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?



---

archive/issue_comments_303641.json:
```json
{
    "body": "Replying to [comment:4 dkrenn]:\n> IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?\n\nNo drawbacks. I just needed confirmation.",
    "created_at": "2017-01-08T09:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303641",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:4 dkrenn]:
> IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?

No drawbacks. I just needed confirmation.



---

archive/issue_comments_303642.json:
```json
{
    "body": "For completeness, I mention the [sage-devel thread on gamma(QQbar(...))](https://groups.google.com/d/msg/sage-devel/jqs3LNeKq5M/v24xFt1zAgAJ)",
    "created_at": "2017-01-09T08:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303642",
    "user": "https://github.com/cheuberg"
}
```

For completeness, I mention the [sage-devel thread on gamma(QQbar(...))](https://groups.google.com/d/msg/sage-devel/jqs3LNeKq5M/v24xFt1zAgAJ)



---

archive/issue_comments_303643.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303643",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_303644.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303644",
    "user": "https://github.com/dkrenn"
}
```

New commits:



---

archive/issue_comments_303645.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-04T13:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_303646.json:
```json
{
    "body": "Is fine modulo the dependency.",
    "created_at": "2017-02-05T08:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303646",
    "user": "https://github.com/rwst"
}
```

Is fine modulo the dependency.



---

archive/issue_comments_303647.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-05T08:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303647",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303648.json:
```json
{
    "body": "The dependency needs to be a ticket number...",
    "created_at": "2017-02-12T22:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303648",
    "user": "https://github.com/vbraun"
}
```

The dependency needs to be a ticket number...



---

archive/issue_comments_303649.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-12T22:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303649",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_303650.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-13T05:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303650",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_303651.json:
```json
{
    "body": "Replying to [comment:11 vbraun]:\n> The dependency needs to be a ticket number... \n\nTicket number was already there; just the \"pynac...\" has not been removed.",
    "created_at": "2017-02-13T05:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303651",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:11 vbraun]:
> The dependency needs to be a ticket number... 

Ticket number was already there; just the "pynac..." has not been removed.



---

archive/issue_events_020654.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-02-16T22:28:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21905#event-20654"
}
```



---

archive/issue_comments_303652.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-16T22:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21905",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21905#issuecomment-303652",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
