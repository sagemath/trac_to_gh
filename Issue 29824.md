# Issue 29824: EuclideanSpace constructor is slow

archive/issues_029824.json:
```json
{
    "body": "CC:  @egourgoulhon @tscrim @nbruin @mwageringel @mjungmath\n\n\n```\nsage: %time EuclideanSpace(5)\nCPU times: user 177 ms, sys: 10.4 ms, total: 187 ms\nWall time: 196 ms\n5-dimensional Euclidean space E^5\nsage: %time EuclideanSpace(20)\nCPU times: user 2.16 s, sys: 56 ms, total: 2.21 s\nWall time: 2.08 s\n20-dimensional Euclidean space E^20\nsage: %time EuclideanSpace(40)\nCPU times: user 8.06 s, sys: 188 ms, total: 8.25 s\nWall time: 7.84 s\n40-dimensional Euclidean space E^40\nsage: %time EuclideanSpace(80)\nCPU times: user 32.8 s, sys: 758 ms, total: 33.6 s\nWall time: 31.5 s\n80-dimensional Euclidean space E^80\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30061\n\n",
    "created_at": "2020-07-04T03:35:59Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "EuclideanSpace constructor is slow",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29824",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @egourgoulhon @tscrim @nbruin @mwageringel @mjungmath


```
sage: %time EuclideanSpace(5)
CPU times: user 177 ms, sys: 10.4 ms, total: 187 ms
Wall time: 196 ms
5-dimensional Euclidean space E^5
sage: %time EuclideanSpace(20)
CPU times: user 2.16 s, sys: 56 ms, total: 2.21 s
Wall time: 2.08 s
20-dimensional Euclidean space E^20
sage: %time EuclideanSpace(40)
CPU times: user 8.06 s, sys: 188 ms, total: 8.25 s
Wall time: 7.84 s
40-dimensional Euclidean space E^40
sage: %time EuclideanSpace(80)
CPU times: user 32.8 s, sys: 758 ms, total: 33.6 s
Wall time: 31.5 s
80-dimensional Euclidean space E^80
```


Issue created by migration from https://trac.sagemath.org/ticket/30061





---

archive/issue_comments_423115.json:
```json
{
    "body": "Most of the time spent seems to come from SR (Maxima). Is it possible to speed things up for this easy special case, avoiding symbolic computation completely?",
    "created_at": "2020-07-04T05:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423115",
    "user": "https://github.com/mkoeppe"
}
```

Most of the time spent seems to come from SR (Maxima). Is it possible to speed things up for this easy special case, avoiding symbolic computation completely?



---

archive/issue_comments_423116.json:
```json
{
    "body": "`EuclideanSpace(n)` creates the following objects:\n1. a real smooth manifold `E` of dimension `n`\n2. a chart `X` on `E`, representing the Cartesian coordinates\n3. the coordinate vector frame associated with `X`\n4. a Riemannian metric `g` on `E`, with its components w.r.t. `X` initialized to `diag(1,1,...,1)` \n5. the Levi-Civita connection associated with `g`, with its components w.r.t. `X` initialized to `0`\n\nMost of the CPU time is spent in step 2, actually in creating the symbolic variables (elements of `SR`) representing the Cartesian coordinates. The latter operation is equivalent to\n\n```\nsage: def create_coords(n):\n....:     coords = SR.var([\"x{}\".format(i) for i in range(n)], domain='real')\n....:     for x in coords:\n....:         assume(x, 'real')\n```\n\nand we have:\n\n```\nsage: %time EuclideanSpace(5)\nCPU times: user 345 ms, sys: 28 ms, total: 373 ms\nWall time: 373 ms\n5-dimensional Euclidean space E^5\nsage: %time create_coords(5)\nCPU times: user 456 ms, sys: 338 \u00b5s, total: 456 ms\nWall time: 402 ms\n```\n\n\n```\nsage: %time EuclideanSpace(20)\nCPU times: user 3.66 s, sys: 58.9 ms, total: 3.72 s\nWall time: 3.48 s\n20-dimensional Euclidean space E^20\nsage: %time create_coords(20)\nCPU times: user 3.38 s, sys: 75.3 ms, total: 3.45 s\nWall time: 3.21 s\n```\n\n\n```\nsage: %time EuclideanSpace(40)\nCPU times: user 12.6 s, sys: 253 ms, total: 12.8 s\nWall time: 11.9 s\n40-dimensional EuclideanSR.var([\"x{}\".format(i) for i in range(n)], space E^40\nsage: %time create_coords(40)\nCPU times: user 12.2 s, sys: 226 ms, total: 12.5 s\nWall time: 11.4 s\n```\n\nActually, it turns out that what takes most of CPU time is demanding that the symbolic variables are real. Indeed, if we skip `domain='real'` and `assume(x, 'real')` (each uses roughly half of the CPU time and, although they look redundant, both are actually necessary for efficient simplifications), we get very small times:\n\n```\nsage: %time coords = SR.var([\"x{}\".format(i) for i in range(40)])\nCPU times: user 336 \u00b5s, sys: 9 \u00b5s, total: 345 \u00b5s\nWall time: 350 \u00b5s\n```\n\nI don't know why `SR.var('x', domain='real')` and `assume(x, 'real')` are so slow...\n\nNB: in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via\n\n```\nsage: E = EuclideanSpace(5)\nsage: E.set_calculus_method('sympy')\n```\n\nchart coordinates could be stored as SymPy variables, instead of SR ones.",
    "created_at": "2020-07-04T17:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423116",
    "user": "https://github.com/egourgoulhon"
}
```

`EuclideanSpace(n)` creates the following objects:
1. a real smooth manifold `E` of dimension `n`
2. a chart `X` on `E`, representing the Cartesian coordinates
3. the coordinate vector frame associated with `X`
4. a Riemannian metric `g` on `E`, with its components w.r.t. `X` initialized to `diag(1,1,...,1)` 
5. the Levi-Civita connection associated with `g`, with its components w.r.t. `X` initialized to `0`

Most of the CPU time is spent in step 2, actually in creating the symbolic variables (elements of `SR`) representing the Cartesian coordinates. The latter operation is equivalent to

```
sage: def create_coords(n):
....:     coords = SR.var(["x{}".format(i) for i in range(n)], domain='real')
....:     for x in coords:
....:         assume(x, 'real')
```

and we have:

```
sage: %time EuclideanSpace(5)
CPU times: user 345 ms, sys: 28 ms, total: 373 ms
Wall time: 373 ms
5-dimensional Euclidean space E^5
sage: %time create_coords(5)
CPU times: user 456 ms, sys: 338 µs, total: 456 ms
Wall time: 402 ms
```


```
sage: %time EuclideanSpace(20)
CPU times: user 3.66 s, sys: 58.9 ms, total: 3.72 s
Wall time: 3.48 s
20-dimensional Euclidean space E^20
sage: %time create_coords(20)
CPU times: user 3.38 s, sys: 75.3 ms, total: 3.45 s
Wall time: 3.21 s
```


```
sage: %time EuclideanSpace(40)
CPU times: user 12.6 s, sys: 253 ms, total: 12.8 s
Wall time: 11.9 s
40-dimensional EuclideanSR.var(["x{}".format(i) for i in range(n)], space E^40
sage: %time create_coords(40)
CPU times: user 12.2 s, sys: 226 ms, total: 12.5 s
Wall time: 11.4 s
```

Actually, it turns out that what takes most of CPU time is demanding that the symbolic variables are real. Indeed, if we skip `domain='real'` and `assume(x, 'real')` (each uses roughly half of the CPU time and, although they look redundant, both are actually necessary for efficient simplifications), we get very small times:

```
sage: %time coords = SR.var(["x{}".format(i) for i in range(40)])
CPU times: user 336 µs, sys: 9 µs, total: 345 µs
Wall time: 350 µs
```

I don't know why `SR.var('x', domain='real')` and `assume(x, 'real')` are so slow...

NB: in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via

```
sage: E = EuclideanSpace(5)
sage: E.set_calculus_method('sympy')
```

chart coordinates could be stored as SymPy variables, instead of SR ones.



---

archive/issue_comments_423117.json:
```json
{
    "body": "Thanks very much for the explanation and analysis!\n\nReplying to [comment:2 egourgoulhon]:\n> I don't know why `SR.var('x', domain='real')` and `assume(x, 'real')` are so slow...\n\nI have created #30065 for this",
    "created_at": "2020-07-04T18:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423117",
    "user": "https://github.com/mkoeppe"
}
```

Thanks very much for the explanation and analysis!

Replying to [comment:2 egourgoulhon]:
> I don't know why `SR.var('x', domain='real')` and `assume(x, 'real')` are so slow...

I have created #30065 for this



---

archive/issue_comments_423118.json:
```json
{
    "body": "Replying to [comment:2 egourgoulhon]:\n> in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via\n> {{{\n> sage: E = EuclideanSpace(5)\n> sage: E.set_calculus_method('sympy')\n> }}}\n> chart coordinates could be stored as SymPy variables, instead of SR ones.\n\nThanks, I'll try this.\n\nActually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions?",
    "created_at": "2020-07-04T18:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423118",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:2 egourgoulhon]:
> in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via
> {{{
> sage: E = EuclideanSpace(5)
> sage: E.set_calculus_method('sympy')
> }}}
> chart coordinates could be stored as SymPy variables, instead of SR ones.

Thanks, I'll try this.

Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions?



---

archive/issue_comments_423119.json:
```json
{
    "body": "In a related direction, would it be of interest to have a category of \"algebraic\" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?",
    "created_at": "2020-07-04T18:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423119",
    "user": "https://github.com/mkoeppe"
}
```

In a related direction, would it be of interest to have a category of "algebraic" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?



---

archive/issue_comments_423120.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> Replying to [comment:2 egourgoulhon]:\n> > in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via\n> > {{{\n> > sage: E = EuclideanSpace(5)\n> > sage: E.set_calculus_method('sympy')\n> > }}}\n> > chart coordinates could be stored as SymPy variables, instead of SR ones.\n> \n> Thanks, I'll try this.\n> \n> Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? \n\nYes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. \n\nActually, it should be relatively easy to add a new calculus method, in addition to the two ones already implemented (SR and SymPy), via the classes [CalculusMethod](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/calculus_method.html) and [ChartFunction](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/chart_func.html).",
    "created_at": "2020-07-04T21:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423120",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:4 mkoeppe]:
> Replying to [comment:2 egourgoulhon]:
> > in the current setting, chart coordinates are stored as SR variables; but since SymPy can be used as the symbolic backend on manifolds, via
> > {{{
> > sage: E = EuclideanSpace(5)
> > sage: E.set_calculus_method('sympy')
> > }}}
> > chart coordinates could be stored as SymPy variables, instead of SR ones.
> 
> Thanks, I'll try this.
> 
> Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? 

Yes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. 

Actually, it should be relatively easy to add a new calculus method, in addition to the two ones already implemented (SR and SymPy), via the classes [CalculusMethod](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/calculus_method.html) and [ChartFunction](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/chart_func.html).



---

archive/issue_comments_423121.json:
```json
{
    "body": "Replying to [comment:5 mkoeppe]:\n> In a related direction, would it be of interest to have a category of \"algebraic\" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?\n\nYes, I think so.",
    "created_at": "2020-07-04T21:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423121",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:5 mkoeppe]:
> In a related direction, would it be of interest to have a category of "algebraic" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?

Yes, I think so.



---

archive/issue_comments_423122.json:
```json
{
    "body": "Replying to [comment:6 egourgoulhon]:\n> > Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? \n> \n> Yes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. \n> \n> Actually, it should be relatively easy to add a new calculus method, in addition to the two ones already implemented (SR and SymPy), via the classes [CalculusMethod](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/calculus_method.html) and [ChartFunction](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/chart_func.html).\n\nThanks! I have created #30070 for this.",
    "created_at": "2020-07-05T00:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423122",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:6 egourgoulhon]:
> > Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? 
> 
> Yes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. 
> 
> Actually, it should be relatively easy to add a new calculus method, in addition to the two ones already implemented (SR and SymPy), via the classes [CalculusMethod](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/calculus_method.html) and [ChartFunction](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/chart_func.html).

Thanks! I have created #30070 for this.



---

archive/issue_comments_423123.json:
```json
{
    "body": "Replying to [comment:7 egourgoulhon]:\n> Replying to [comment:5 mkoeppe]:\n> > In a related direction, would it be of interest to have a category of \"algebraic\" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?\n> \n> Yes, I think so.\n\nOK, I have created #30069 for the case of real algebraic manifolds.\n\n\nDoes sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?",
    "created_at": "2020-07-05T00:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423123",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:7 egourgoulhon]:
> Replying to [comment:5 mkoeppe]:
> > In a related direction, would it be of interest to have a category of "algebraic" differential manifolds, as a differential geometry view on real varieties and semialgebraic sets (and their boundaries)?
> 
> Yes, I think so.

OK, I have created #30069 for the case of real algebraic manifolds.


Does sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?



---

archive/issue_comments_423124.json:
```json
{
    "body": "Replying to [comment:6 egourgoulhon]:\n> Replying to [comment:4 mkoeppe]:\n> > Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? \n> \n> Yes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. \n> \nActually, for spherical coordinates, there is already some issue with rational functions at the level of the metric tensor itself, since the components of the Euclidean metric involve the sine function.",
    "created_at": "2020-07-05T08:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423124",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:6 egourgoulhon]:
> Replying to [comment:4 mkoeppe]:
> > Actually, would it make sense (at least for simple cases) to have a calculus method that only uses Sage's rational functions? 
> 
> Yes, as soon as you don't have to take a square root, as for instance in evaluating the volume n-form on a pseudo-Riemannian manifold (aka Levi-Civita tensor). In particular, this would forbid the computation of the triple scalar product within spherical coordinates in the Euclidean 3-space. 
> 
Actually, for spherical coordinates, there is already some issue with rational functions at the level of the metric tensor itself, since the components of the Euclidean metric involve the sine function.



---

archive/issue_comments_423125.json:
```json
{
    "body": "Replying to [comment:9 mkoeppe]:\n> \n> OK, I have created #30069 for the case of real algebraic manifolds.\n> \nVery good.\n> \n> Does sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?\nNo, manifolds with boundary are not implemented yet; it would be nice to have them.",
    "created_at": "2020-07-05T09:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423125",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:9 mkoeppe]:
> 
> OK, I have created #30069 for the case of real algebraic manifolds.
> 
Very good.
> 
> Does sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?
No, manifolds with boundary are not implemented yet; it would be nice to have them.



---

archive/issue_comments_423126.json:
```json
{
    "body": "With #30065 and #30074:\n\n```\nsage: %prun EuclideanSpace(1000)\n\n         53513603 function calls (53508842 primitive calls) in 37.037 seconds\n\n   Ordered by: internal time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n  2002006    4.658    0.000    4.786    0.000 tensorfield.py:684(_del_restrictions)\n  3003010    3.263    0.000    3.766    0.000 tensorfield.py:667(_del_derived)\n  2002000    3.076    0.000   18.325    0.000 free_module_tensor.py:1191(_set_comp_unsafe)\n  2002000    3.047    0.000   25.990    0.000 tensorfield_paral.py:820(set_comp)\n  2002000    2.571    0.000   22.942    0.000 free_module_tensor.py:1263(set_comp)\n  2002000    2.478    0.000    7.194    0.000 comp.py:864(__setitem__)\n  2002000    2.147    0.000    2.147    0.000 free_module_tensor.py:1474(del_other_comp)\n  2003000    2.029    0.000    2.398    0.000 comp.py:616(_check_indices)\n  2002000    1.825    0.000   20.150    0.000 tensorfield_paral.py:730(_set_comp_unsafe)\n  2002006    1.697    0.000    9.256    0.000 tensorfield_paral.py:708(_del_derived)\n        1    1.532    1.532   36.171   36.171 free_module_basis.py:566(__init__)\n  1002000    1.095    0.000    1.108    0.000 scalarfield.py:1154(is_trivial_zero)\n  1001003    0.931    0.000    7.942    0.000 vectorfield.py:1612(_del_derived)\n  8071534    0.813    0.000    0.813    0.000 {built-in method builtins.isinstance}\n        1    0.722    0.722   15.342   15.342 free_module_basis.py:375(__init__)\n  1001003    0.675    0.000    0.675    0.000 vectorfield.py:292(_del_dependencies)\n  2004002    0.656    0.000    0.656    0.000 finite_rank_free_module.py:2037(irange)\n  1001000    0.603    0.000    5.144    0.000 diff_form.py:1241(_del_derived)\n     6800    0.532    0.000    0.598    0.000 maxima_lib.py:412(_eval_line)\n  2045310    0.378    0.000    0.378    0.000 {built-in method builtins.hasattr}\n  1001003    0.335    0.000    5.137    0.000 multivectorfield.py:966(_del_derived)\n  5005023    0.334    0.000    0.334    0.000 {method 'clear' of 'dict' objects}\n```\n",
    "created_at": "2020-07-06T07:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423126",
    "user": "https://github.com/mkoeppe"
}
```

With #30065 and #30074:

```
sage: %prun EuclideanSpace(1000)

         53513603 function calls (53508842 primitive calls) in 37.037 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  2002006    4.658    0.000    4.786    0.000 tensorfield.py:684(_del_restrictions)
  3003010    3.263    0.000    3.766    0.000 tensorfield.py:667(_del_derived)
  2002000    3.076    0.000   18.325    0.000 free_module_tensor.py:1191(_set_comp_unsafe)
  2002000    3.047    0.000   25.990    0.000 tensorfield_paral.py:820(set_comp)
  2002000    2.571    0.000   22.942    0.000 free_module_tensor.py:1263(set_comp)
  2002000    2.478    0.000    7.194    0.000 comp.py:864(__setitem__)
  2002000    2.147    0.000    2.147    0.000 free_module_tensor.py:1474(del_other_comp)
  2003000    2.029    0.000    2.398    0.000 comp.py:616(_check_indices)
  2002000    1.825    0.000   20.150    0.000 tensorfield_paral.py:730(_set_comp_unsafe)
  2002006    1.697    0.000    9.256    0.000 tensorfield_paral.py:708(_del_derived)
        1    1.532    1.532   36.171   36.171 free_module_basis.py:566(__init__)
  1002000    1.095    0.000    1.108    0.000 scalarfield.py:1154(is_trivial_zero)
  1001003    0.931    0.000    7.942    0.000 vectorfield.py:1612(_del_derived)
  8071534    0.813    0.000    0.813    0.000 {built-in method builtins.isinstance}
        1    0.722    0.722   15.342   15.342 free_module_basis.py:375(__init__)
  1001003    0.675    0.000    0.675    0.000 vectorfield.py:292(_del_dependencies)
  2004002    0.656    0.000    0.656    0.000 finite_rank_free_module.py:2037(irange)
  1001000    0.603    0.000    5.144    0.000 diff_form.py:1241(_del_derived)
     6800    0.532    0.000    0.598    0.000 maxima_lib.py:412(_eval_line)
  2045310    0.378    0.000    0.378    0.000 {built-in method builtins.hasattr}
  1001003    0.335    0.000    5.137    0.000 multivectorfield.py:966(_del_derived)
  5005023    0.334    0.000    0.334    0.000 {method 'clear' of 'dict' objects}
```




---

archive/issue_comments_423127.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n\nRegarding the new ticket description, I would not say that the first three examples, namely `VectorSpace(QQ, 5)`, `CombinatorialFreeModule(QQ, range(5))` and `AffineSpace(RR, 5)` do construct an Euclidean space, because their ouputs are not endowed with a scalar product, are they?",
    "created_at": "2020-07-06T13:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423127",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:13 mkoeppe]:

Regarding the new ticket description, I would not say that the first three examples, namely `VectorSpace(QQ, 5)`, `CombinatorialFreeModule(QQ, range(5))` and `AffineSpace(RR, 5)` do construct an Euclidean space, because their ouputs are not endowed with a scalar product, are they?



---

archive/issue_comments_423128.json:
```json
{
    "body": "Of course, I agree. The summary already showed the categories of the spaces, but I've added two headers to emphasize this point.",
    "created_at": "2020-07-06T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423128",
    "user": "https://github.com/mkoeppe"
}
```

Of course, I agree. The summary already showed the categories of the spaces, but I've added two headers to emphasize this point.



---

archive/issue_comments_423129.json:
```json
{
    "body": "Replying to [comment:11 egourgoulhon]:\n> Replying to [comment:9 mkoeppe]:\n> > Does sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?\n> No, manifolds with boundary are not implemented yet; it would be nice to have them. \n\nI have created #30080 for this",
    "created_at": "2020-07-06T18:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423129",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:11 egourgoulhon]:
> Replying to [comment:9 mkoeppe]:
> > Does sage-manifolds currently implement manifolds with boundary, or is it planned to implement them?
> No, manifolds with boundary are not implemented yet; it would be nice to have them. 

I have created #30080 for this



---

archive/issue_comments_423130.json:
```json
{
    "body": "For further speedups of `EuclideanSpace(1000)`, it seems one would need to work on\n`sage.tensor.modules.free_module_basis.FreeModuleCoBasis.__init__` and `FreeModuleBasis.__init__`. They dominate the computation now, using non-sparse operations, calling `sage.manifolds.differentiable.tensorfield_paral.TensorFieldParal.set_comp` 1000<sup>2</sup> times. Does it make sense to make this sparse in some way? Would major speedups be expected from cythonizing this module?",
    "created_at": "2020-07-07T02:45:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423130",
    "user": "https://github.com/mkoeppe"
}
```

For further speedups of `EuclideanSpace(1000)`, it seems one would need to work on
`sage.tensor.modules.free_module_basis.FreeModuleCoBasis.__init__` and `FreeModuleBasis.__init__`. They dominate the computation now, using non-sparse operations, calling `sage.manifolds.differentiable.tensorfield_paral.TensorFieldParal.set_comp` 1000<sup>2</sup> times. Does it make sense to make this sparse in some way? Would major speedups be expected from cythonizing this module?



---

archive/issue_comments_423131.json:
```json
{
    "body": "Replying to [comment:21 mkoeppe]:\n> For further speedups of `EuclideanSpace(1000)`, it seems one would need to work on\n> `sage.tensor.modules.free_module_basis.FreeModuleCoBasis.__init__` and `FreeModuleBasis.__init__`. They dominate the computation now, using non-sparse operations, calling `sage.manifolds.differentiable.tensorfield_paral.TensorFieldParal.set_comp` 1000<sup>2</sup> times. Does it make sense to make this sparse in some way? \nYes, actually in the current framework, any uninitialized component of a vector/tensor is considered to be zero. So in `FreeModuleBasis.__init__`, we could skip the loop initializing the components of the basis vector to zero:\n\n```diff\n        for i in fmodule.irange():\n            v = fmodule.element_class(fmodule)\n-           for j in fmodule.irange():\n-               v.set_comp(self)[j] = fmodule._ring.zero()\n            v.set_comp(self)[i] = fmodule._ring.one()\n            vl.append(v)\n```\n\nThis would make the number of calls to `TensorFieldParal.set_comp` to be 1000, instead in of 1000<sup>2</sup> !\nSimilarly in `FreeModuleCoBasis.__init_`:\n\n```diff\n        for i in self._fmodule.irange():\n            v = self._fmodule.linear_form()\n-           for j in self._fmodule.irange():\n-               v.set_comp(basis)[j] = 0\n-           v.set_comp(basis)[i] = 1\n+           v.set_comp(basis)[i] = self._fmodule._ring.one()\n            vl.append(v)\n```\n\nThe above unnecessary initializations to zero have been implemented at the early stage of the manifolds project, when we were not certain to keep the storage convention of having uninitialized components to be zero. Given the heavy use of that convention now, it's pretty safe to remove these lines.",
    "created_at": "2020-07-07T09:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423131",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:21 mkoeppe]:
> For further speedups of `EuclideanSpace(1000)`, it seems one would need to work on
> `sage.tensor.modules.free_module_basis.FreeModuleCoBasis.__init__` and `FreeModuleBasis.__init__`. They dominate the computation now, using non-sparse operations, calling `sage.manifolds.differentiable.tensorfield_paral.TensorFieldParal.set_comp` 1000<sup>2</sup> times. Does it make sense to make this sparse in some way? 
Yes, actually in the current framework, any uninitialized component of a vector/tensor is considered to be zero. So in `FreeModuleBasis.__init__`, we could skip the loop initializing the components of the basis vector to zero:

```diff
        for i in fmodule.irange():
            v = fmodule.element_class(fmodule)
-           for j in fmodule.irange():
-               v.set_comp(self)[j] = fmodule._ring.zero()
            v.set_comp(self)[i] = fmodule._ring.one()
            vl.append(v)
```

This would make the number of calls to `TensorFieldParal.set_comp` to be 1000, instead in of 1000<sup>2</sup> !
Similarly in `FreeModuleCoBasis.__init_`:

```diff
        for i in self._fmodule.irange():
            v = self._fmodule.linear_form()
-           for j in self._fmodule.irange():
-               v.set_comp(basis)[j] = 0
-           v.set_comp(basis)[i] = 1
+           v.set_comp(basis)[i] = self._fmodule._ring.one()
            vl.append(v)
```

The above unnecessary initializations to zero have been implemented at the early stage of the manifolds project, when we were not certain to keep the storage convention of having uninitialized components to be zero. Given the heavy use of that convention now, it's pretty safe to remove these lines.



---

archive/issue_comments_423132.json:
```json
{
    "body": "The changes suggested in comment:22 are implemented in the above branch.\n----\nNew commits:",
    "created_at": "2020-07-07T16:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423132",
    "user": "https://github.com/egourgoulhon"
}
```

The changes suggested in comment:22 are implemented in the above branch.
----
New commits:



---

archive/issue_comments_423133.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-07T16:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_423134.json:
```json
{
    "body": "Merged in the tickets listed as dependencies",
    "created_at": "2020-07-07T16:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423134",
    "user": "https://github.com/mkoeppe"
}
```

Merged in the tickets listed as dependencies



---

archive/issue_comments_423135.json:
```json
{
    "body": "Replying to [comment:23 egourgoulhon]:\n> The changes suggested in comment:22 are implemented in the above branch.\n\nGreat! Together with the merged tickets, this now gives:\n\n```\nsage: %time EuclideanSpace(5)\nCPU times: user 4.87 ms, sys: 372 \u00b5s, total: 5.24 ms\nWall time: 4.93 ms\n5-dimensional Euclidean space E^5\nsage: %time EuclideanSpace(80)\nCPU times: user 106 ms, sys: 4.52 ms, total: 110 ms\nWall time: 92 ms\n80-dimensional Euclidean space E^80\nsage: %time EuclideanSpace(1000)\nCPU times: user 1.04 s, sys: 33.5 ms, total: 1.07 s\nWall time: 986 ms\n```\n",
    "created_at": "2020-07-07T16:45:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423135",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:23 egourgoulhon]:
> The changes suggested in comment:22 are implemented in the above branch.

Great! Together with the merged tickets, this now gives:

```
sage: %time EuclideanSpace(5)
CPU times: user 4.87 ms, sys: 372 µs, total: 5.24 ms
Wall time: 4.93 ms
5-dimensional Euclidean space E^5
sage: %time EuclideanSpace(80)
CPU times: user 106 ms, sys: 4.52 ms, total: 110 ms
Wall time: 92 ms
80-dimensional Euclidean space E^80
sage: %time EuclideanSpace(1000)
CPU times: user 1.04 s, sys: 33.5 ms, total: 1.07 s
Wall time: 986 ms
```




---

archive/issue_comments_423136.json:
```json
{
    "body": "And some caching is happening too. The second time:\n\n```\nsage: %time EuclideanSpace(1000)\nCPU times: user 207 ms, sys: 5.63 ms, total: 213 ms\nWall time: 212 ms\n1000-dimensional Euclidean space E^1000\n```\n",
    "created_at": "2020-07-07T16:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423136",
    "user": "https://github.com/mkoeppe"
}
```

And some caching is happening too. The second time:

```
sage: %time EuclideanSpace(1000)
CPU times: user 207 ms, sys: 5.63 ms, total: 213 ms
Wall time: 212 ms
1000-dimensional Euclidean space E^1000
```




---

archive/issue_comments_423137.json:
```json
{
    "body": "That's faster than `VectorSpace(QQ, 1000, inner_product_matrix=matrix.identity(1000))`",
    "created_at": "2020-07-07T16:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423137",
    "user": "https://github.com/mkoeppe"
}
```

That's faster than `VectorSpace(QQ, 1000, inner_product_matrix=matrix.identity(1000))`



---

archive/issue_comments_423138.json:
```json
{
    "body": "Most of the caching is coming from #30074. Making the real-declared symbolic variables known to Maxima is costly the first time; after that, it's free.",
    "created_at": "2020-07-07T16:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423138",
    "user": "https://github.com/mkoeppe"
}
```

Most of the caching is coming from #30074. Making the real-declared symbolic variables known to Maxima is costly the first time; after that, it's free.



---

archive/issue_comments_423139.json:
```json
{
    "body": "First time:\n\n```\nsage: %prun EuclideanSpace(10000)\n         4614917 function calls (4585885 primitive calls) in 42.685 seconds\n\n   Ordered by: internal time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n    80096   35.217    0.000   35.779    0.000 maxima_lib.py:412(_eval_line)\n       25    0.529    0.021    0.529    0.021 {built-in method sage.libs.ecl.ecl_eval}\n    10000    0.425    0.000   39.373    0.004 {method 'var' of 'sage.symbolic.ring.SymbolicRing' objects}\n    20000    0.377    0.000   38.550    0.002 assumptions.py:213(assume)\n    20048    0.323    0.000    0.382    0.000 maxima_lib.py:274(max_to_string)\n    20006    0.275    0.000    0.288    0.000 free_module_tensor.py:258(__init__)\n    20000    0.208    0.000    0.460    0.000 assumptions.py:396(preprocess_assumptions)\n       56    0.207    0.004    0.207    0.004 {built-in method _imp.create_dynamic}\n    50000    0.190    0.000    0.190    0.000 latex.py:463(__add__)\n   209119    0.165    0.000    0.165    0.000 {built-in method builtins.hasattr}\n    20007    0.164    0.000    0.180    0.000 tensorfield_paral.py:689(_init_derived)\n  10032/1    0.139    0.000   42.050   42.050 {sage.misc.classcall_metaclass.typecall}\n    10139    0.129    0.000    0.130    0.000 {built-in method builtins.repr}\n    20001    0.125    0.000    0.143    0.000 interface.py:620(__getattr__)\n      714    0.119    0.000    0.119    0.000 {built-in method marshal.loads}\n   546190    0.114    0.000    0.114    0.000 {built-in method builtins.isinstance}\n        1    0.102    0.102   39.733   39.733 chart.py:1610(_init_coordinates)\n    10003    0.091    0.000    0.107    0.000 chart_func.py:318(__init__)\n    10000    0.091    0.000    0.460    0.000 {method '_maxima_init_' of 'sage.structure.sage_object.SageObject' objects}\n    40024    0.090    0.000    0.099    0.000 interface.py:491(_next_var_name)\n    20000    0.087    0.000   13.550    0.001 interface.py:587(function_call)\n    40024    0.086    0.000   15.460    0.000 maxima_lib.py:492(set)\n    30024    0.086    0.000   13.245    0.000 interface.py:251(__call__)\n    30024    0.082    0.000   13.139    0.000 interface.py:706(__init__)\n    30000    0.080    0.000    0.237    0.000 scalarfield.py:1154(is_trivial_zero)\n    20000    0.079    0.000    3.032    0.000 interface.py:534(_convert_args_kwds)\n    20024    0.078    0.000   16.639    0.001 interface.py:981(__del__)\n    20000    0.077    0.000    0.416    0.000 free_module_tensor.py:1191(_set_comp_unsafe)\n   160195    0.074    0.000    0.074    0.000 {method 'find' of 'str' objects}\n    30000    0.069    0.000    0.126    0.000 chart_func.py:810(is_trivial_zero)\n    10000    0.065    0.000    0.118    0.000 diff_form.py:1241(_del_derived)\n    10001    0.061    0.000    0.069    0.000 interface.py:419(_relation_symbols)\n    20048    0.059    0.000    0.059    0.000 {method 'python' of 'sage.libs.ecl.EclObject' objects}\n    90434    0.057    0.000    0.057    0.000 {method 'split' of 'str' objects}\n    20006    0.051    0.000    0.053    0.000 tensorfield.py:684(_del_restrictions)\n    30024    0.051    0.000   13.056    0.000 maxima_lib.py:561(_create)\n    56/50    0.049    0.001    0.054    0.001 {built-in method _imp.exec_dynamic}\n    20000    0.045    0.000    0.045    0.000 infinity.py:1020(gen)\n    30010    0.044    0.000    0.051    0.000 tensorfield.py:667(_del_derived)\n    20000    0.044    0.000   21.876    0.001 interface.py:653(__call__)\n    20001    0.044    0.000    0.070    0.000 vectorfield_module.py:1765(dual_exterior_power)\n    20000    0.042    0.000    0.251    0.000 comp.py:864(__setitem__)\n    30000    0.042    0.000    0.050    0.000 comp.py:616(_check_indices)\n    20000    0.041    0.000    0.043    0.000 interface.py:603(_function_call_string)\n    10001    0.040    0.000    0.332    0.000 vectorfield.py:1533(__init__)\n    10000    0.040    0.000    0.224    0.000 expression_conversions.py:155(__call__)\n    20024    0.039    0.000   16.518    0.001 maxima_lib.py:516(clear)\n```\n",
    "created_at": "2020-07-07T16:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423139",
    "user": "https://github.com/mkoeppe"
}
```

First time:

```
sage: %prun EuclideanSpace(10000)
         4614917 function calls (4585885 primitive calls) in 42.685 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    80096   35.217    0.000   35.779    0.000 maxima_lib.py:412(_eval_line)
       25    0.529    0.021    0.529    0.021 {built-in method sage.libs.ecl.ecl_eval}
    10000    0.425    0.000   39.373    0.004 {method 'var' of 'sage.symbolic.ring.SymbolicRing' objects}
    20000    0.377    0.000   38.550    0.002 assumptions.py:213(assume)
    20048    0.323    0.000    0.382    0.000 maxima_lib.py:274(max_to_string)
    20006    0.275    0.000    0.288    0.000 free_module_tensor.py:258(__init__)
    20000    0.208    0.000    0.460    0.000 assumptions.py:396(preprocess_assumptions)
       56    0.207    0.004    0.207    0.004 {built-in method _imp.create_dynamic}
    50000    0.190    0.000    0.190    0.000 latex.py:463(__add__)
   209119    0.165    0.000    0.165    0.000 {built-in method builtins.hasattr}
    20007    0.164    0.000    0.180    0.000 tensorfield_paral.py:689(_init_derived)
  10032/1    0.139    0.000   42.050   42.050 {sage.misc.classcall_metaclass.typecall}
    10139    0.129    0.000    0.130    0.000 {built-in method builtins.repr}
    20001    0.125    0.000    0.143    0.000 interface.py:620(__getattr__)
      714    0.119    0.000    0.119    0.000 {built-in method marshal.loads}
   546190    0.114    0.000    0.114    0.000 {built-in method builtins.isinstance}
        1    0.102    0.102   39.733   39.733 chart.py:1610(_init_coordinates)
    10003    0.091    0.000    0.107    0.000 chart_func.py:318(__init__)
    10000    0.091    0.000    0.460    0.000 {method '_maxima_init_' of 'sage.structure.sage_object.SageObject' objects}
    40024    0.090    0.000    0.099    0.000 interface.py:491(_next_var_name)
    20000    0.087    0.000   13.550    0.001 interface.py:587(function_call)
    40024    0.086    0.000   15.460    0.000 maxima_lib.py:492(set)
    30024    0.086    0.000   13.245    0.000 interface.py:251(__call__)
    30024    0.082    0.000   13.139    0.000 interface.py:706(__init__)
    30000    0.080    0.000    0.237    0.000 scalarfield.py:1154(is_trivial_zero)
    20000    0.079    0.000    3.032    0.000 interface.py:534(_convert_args_kwds)
    20024    0.078    0.000   16.639    0.001 interface.py:981(__del__)
    20000    0.077    0.000    0.416    0.000 free_module_tensor.py:1191(_set_comp_unsafe)
   160195    0.074    0.000    0.074    0.000 {method 'find' of 'str' objects}
    30000    0.069    0.000    0.126    0.000 chart_func.py:810(is_trivial_zero)
    10000    0.065    0.000    0.118    0.000 diff_form.py:1241(_del_derived)
    10001    0.061    0.000    0.069    0.000 interface.py:419(_relation_symbols)
    20048    0.059    0.000    0.059    0.000 {method 'python' of 'sage.libs.ecl.EclObject' objects}
    90434    0.057    0.000    0.057    0.000 {method 'split' of 'str' objects}
    20006    0.051    0.000    0.053    0.000 tensorfield.py:684(_del_restrictions)
    30024    0.051    0.000   13.056    0.000 maxima_lib.py:561(_create)
    56/50    0.049    0.001    0.054    0.001 {built-in method _imp.exec_dynamic}
    20000    0.045    0.000    0.045    0.000 infinity.py:1020(gen)
    30010    0.044    0.000    0.051    0.000 tensorfield.py:667(_del_derived)
    20000    0.044    0.000   21.876    0.001 interface.py:653(__call__)
    20001    0.044    0.000    0.070    0.000 vectorfield_module.py:1765(dual_exterior_power)
    20000    0.042    0.000    0.251    0.000 comp.py:864(__setitem__)
    30000    0.042    0.000    0.050    0.000 comp.py:616(_check_indices)
    20000    0.041    0.000    0.043    0.000 interface.py:603(_function_call_string)
    10001    0.040    0.000    0.332    0.000 vectorfield.py:1533(__init__)
    10000    0.040    0.000    0.224    0.000 expression_conversions.py:155(__call__)
    20024    0.039    0.000   16.518    0.001 maxima_lib.py:516(clear)
```




---

archive/issue_comments_423140.json:
```json
{
    "body": "Second time:\n\n```\n         2221257 function calls (2221199 primitive calls) in 2.982 seconds\n\n   Ordered by: internal time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n    50000    0.297    0.000    0.297    0.000 latex.py:463(__add__)\n    30010    0.243    0.000    0.251    0.000 tensorfield.py:667(_del_derived)\n    20006    0.214    0.000    0.226    0.000 free_module_tensor.py:258(__init__)\n    10000    0.178    0.000    0.266    0.000 {method 'var' of 'sage.symbolic.ring.SymbolicRing' objects}\n    10003    0.091    0.000    0.107    0.000 chart_func.py:318(__init__)\n    30000    0.086    0.000    0.254    0.000 scalarfield.py:1154(is_trivial_zero)\n    20000    0.085    0.000    0.656    0.000 free_module_tensor.py:1191(_set_comp_unsafe)\n    10000    0.077    0.000    0.136    0.000 diff_form.py:1241(_del_derived)\n   130046    0.075    0.000    0.075    0.000 {built-in method builtins.hasattr}\n    30000    0.074    0.000    0.134    0.000 chart_func.py:810(is_trivial_zero)\n    20007    0.073    0.000    0.090    0.000 tensorfield_paral.py:689(_init_derived)\n    20000    0.068    0.000    0.085    0.000 assumptions.py:396(preprocess_assumptions)\n    20006    0.055    0.000    0.057    0.000 tensorfield.py:684(_del_restrictions)\n    20001    0.049    0.000    0.076    0.000 vectorfield_module.py:1765(dual_exterior_power)\n   270213    0.048    0.000    0.048    0.000 {built-in method builtins.isinstance}\n    30000    0.045    0.000    0.054    0.000 comp.py:616(_check_indices)\n        1    0.044    0.044    0.412    0.412 chart.py:1610(_init_coordinates)\n    20000    0.044    0.000    0.271    0.000 comp.py:864(__setitem__)\n    10001    0.042    0.000    0.276    0.000 vectorfield.py:1533(__init__)\n    30001    0.040    0.000    0.040    0.000 chart_func.py:460(expr)\n    20000    0.034    0.000    0.714    0.000 free_module_tensor.py:1263(set_comp)\n    10001    0.034    0.000    0.243    0.000 diff_form.py:1137(__init__)\n    20000    0.033    0.000    0.746    0.000 tensorfield_paral.py:820(set_comp)\n    30000    0.033    0.000    0.033    0.000 {method '_latex_' of 'sage.symbolic.expression.Expression' objects}\n    10001    0.033    0.000    0.059    0.000 free_module_alt_form.py:298(_new_comp)\n    30000    0.033    0.000    0.033    0.000 free_module_tensor.py:923(set_name)\n    10001    0.028    0.000    0.054    0.000 free_module_element.py:230(_new_comp)\n    10000    0.027    0.000    0.065    0.000 comp.py:3061(_ordered_indices)\n    20000    0.026    0.000    0.026    0.000 free_module_tensor.py:1474(del_other_comp)\n    10001    0.026    0.000    0.026    0.000 chart.py:311(<genexpr>)\n    10000    0.025    0.000    0.178    0.000 comp.py:4784(__setitem__)\n   120055    0.025    0.000    0.042    0.000 {built-in method builtins.len}\n    10001    0.024    0.000    0.024    0.000 euclidean.py:858(<genexpr>)\n    30010    0.024    0.000    0.024    0.000 tensorfield.py:654(_init_derived)\n    10001    0.023    0.000    0.023    0.000 vectorframe.py:1764(<genexpr>)\n    10001    0.023    0.000    0.038    0.000 vectorfield_module.py:1709(exterior_power)\n        3    0.022    0.007    0.339    0.113 free_module_basis.py:208(set_name)\n    20005    0.022    0.000    0.052    0.000 comp.py:496(__init__)\n        1    0.022    0.022    1.688    1.688 free_module_basis.py:566(__init__)\n    20006    0.022    0.000    0.318    0.000 tensorfield_paral.py:708(_del_derived)\n```\n",
    "created_at": "2020-07-07T16:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423140",
    "user": "https://github.com/mkoeppe"
}
```

Second time:

```
         2221257 function calls (2221199 primitive calls) in 2.982 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    50000    0.297    0.000    0.297    0.000 latex.py:463(__add__)
    30010    0.243    0.000    0.251    0.000 tensorfield.py:667(_del_derived)
    20006    0.214    0.000    0.226    0.000 free_module_tensor.py:258(__init__)
    10000    0.178    0.000    0.266    0.000 {method 'var' of 'sage.symbolic.ring.SymbolicRing' objects}
    10003    0.091    0.000    0.107    0.000 chart_func.py:318(__init__)
    30000    0.086    0.000    0.254    0.000 scalarfield.py:1154(is_trivial_zero)
    20000    0.085    0.000    0.656    0.000 free_module_tensor.py:1191(_set_comp_unsafe)
    10000    0.077    0.000    0.136    0.000 diff_form.py:1241(_del_derived)
   130046    0.075    0.000    0.075    0.000 {built-in method builtins.hasattr}
    30000    0.074    0.000    0.134    0.000 chart_func.py:810(is_trivial_zero)
    20007    0.073    0.000    0.090    0.000 tensorfield_paral.py:689(_init_derived)
    20000    0.068    0.000    0.085    0.000 assumptions.py:396(preprocess_assumptions)
    20006    0.055    0.000    0.057    0.000 tensorfield.py:684(_del_restrictions)
    20001    0.049    0.000    0.076    0.000 vectorfield_module.py:1765(dual_exterior_power)
   270213    0.048    0.000    0.048    0.000 {built-in method builtins.isinstance}
    30000    0.045    0.000    0.054    0.000 comp.py:616(_check_indices)
        1    0.044    0.044    0.412    0.412 chart.py:1610(_init_coordinates)
    20000    0.044    0.000    0.271    0.000 comp.py:864(__setitem__)
    10001    0.042    0.000    0.276    0.000 vectorfield.py:1533(__init__)
    30001    0.040    0.000    0.040    0.000 chart_func.py:460(expr)
    20000    0.034    0.000    0.714    0.000 free_module_tensor.py:1263(set_comp)
    10001    0.034    0.000    0.243    0.000 diff_form.py:1137(__init__)
    20000    0.033    0.000    0.746    0.000 tensorfield_paral.py:820(set_comp)
    30000    0.033    0.000    0.033    0.000 {method '_latex_' of 'sage.symbolic.expression.Expression' objects}
    10001    0.033    0.000    0.059    0.000 free_module_alt_form.py:298(_new_comp)
    30000    0.033    0.000    0.033    0.000 free_module_tensor.py:923(set_name)
    10001    0.028    0.000    0.054    0.000 free_module_element.py:230(_new_comp)
    10000    0.027    0.000    0.065    0.000 comp.py:3061(_ordered_indices)
    20000    0.026    0.000    0.026    0.000 free_module_tensor.py:1474(del_other_comp)
    10001    0.026    0.000    0.026    0.000 chart.py:311(<genexpr>)
    10000    0.025    0.000    0.178    0.000 comp.py:4784(__setitem__)
   120055    0.025    0.000    0.042    0.000 {built-in method builtins.len}
    10001    0.024    0.000    0.024    0.000 euclidean.py:858(<genexpr>)
    30010    0.024    0.000    0.024    0.000 tensorfield.py:654(_init_derived)
    10001    0.023    0.000    0.023    0.000 vectorframe.py:1764(<genexpr>)
    10001    0.023    0.000    0.038    0.000 vectorfield_module.py:1709(exterior_power)
        3    0.022    0.007    0.339    0.113 free_module_basis.py:208(set_name)
    20005    0.022    0.000    0.052    0.000 comp.py:496(__init__)
        1    0.022    0.022    1.688    1.688 free_module_basis.py:566(__init__)
    20006    0.022    0.000    0.318    0.000 tensorfield_paral.py:708(_del_derived)
```




---

archive/issue_comments_423141.json:
```json
{
    "body": "First time profile, filtered to methods in `maxima_lib` and `sage.libs.ecl`:\n\n```\nsage: %prun EuclideanSpace(5000)\n    40096    7.970    0.000    8.203    0.000 maxima_lib.py:412(_eval_line)\n       25    0.511    0.020    0.511    0.020 {built-in method sage.libs.ecl.ecl_eval}\n    10048    0.133    0.000    0.158    0.000 maxima_lib.py:274(max_to_string)\n    20024    0.037    0.000    3.505    0.000 maxima_lib.py:492(set)\n    15024    0.021    0.000    2.934    0.000 maxima_lib.py:561(_create)\n    10024    0.017    0.000    3.597    0.000 maxima_lib.py:516(clear)\n    40096    0.015    0.000    0.017    0.000 maxima_lib.py:463(<listcomp>)\n     5023    0.007    0.000    0.275    0.000 maxima_lib.py:541(get)\n```\n",
    "created_at": "2020-07-07T17:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423141",
    "user": "https://github.com/mkoeppe"
}
```

First time profile, filtered to methods in `maxima_lib` and `sage.libs.ecl`:

```
sage: %prun EuclideanSpace(5000)
    40096    7.970    0.000    8.203    0.000 maxima_lib.py:412(_eval_line)
       25    0.511    0.020    0.511    0.020 {built-in method sage.libs.ecl.ecl_eval}
    10048    0.133    0.000    0.158    0.000 maxima_lib.py:274(max_to_string)
    20024    0.037    0.000    3.505    0.000 maxima_lib.py:492(set)
    15024    0.021    0.000    2.934    0.000 maxima_lib.py:561(_create)
    10024    0.017    0.000    3.597    0.000 maxima_lib.py:516(clear)
    40096    0.015    0.000    0.017    0.000 maxima_lib.py:463(<listcomp>)
     5023    0.007    0.000    0.275    0.000 maxima_lib.py:541(get)
```




---

archive/issue_comments_423142.json:
```json
{
    "body": "The time spent on `maxima_lib` can probably still be reduced a little by using ECL objects directly for \"context\", but I will not work on this at the moment.",
    "created_at": "2020-07-07T18:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423142",
    "user": "https://github.com/mkoeppe"
}
```

The time spent on `maxima_lib` can probably still be reduced a little by using ECL objects directly for "context", but I will not work on this at the moment.



---

archive/issue_comments_423143.json:
```json
{
    "body": "Replying to [comment:34 mkoeppe]:\n> The time spent on `maxima_lib` can probably still be reduced a little by using ECL objects directly for \"context\", but I will not work on this at the moment.\nThis is #30086 (just for saving the thought and some preliminary work on it).",
    "created_at": "2020-07-07T18:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423143",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:34 mkoeppe]:
> The time spent on `maxima_lib` can probably still be reduced a little by using ECL objects directly for "context", but I will not work on this at the moment.
This is #30086 (just for saving the thought and some preliminary work on it).



---

archive/issue_comments_423144.json:
```json
{
    "body": "Next I think we can benchmark some other basic operations in the spaces",
    "created_at": "2020-07-07T18:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423144",
    "user": "https://github.com/mkoeppe"
}
```

Next I think we can benchmark some other basic operations in the spaces



---

archive/issue_comments_423145.json:
```json
{
    "body": "Does `EuclideanSpace` know how to compute geodesics, and thus distances?",
    "created_at": "2020-07-08T00:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423145",
    "user": "https://github.com/mkoeppe"
}
```

Does `EuclideanSpace` know how to compute geodesics, and thus distances?



---

archive/issue_comments_423146.json:
```json
{
    "body": "Replying to [comment:40 mkoeppe]:\n> Does `EuclideanSpace` know how to compute geodesics, and thus distances?\nYes it does, via [IntegratedGeodesic](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/integrated_curve.html). Note however that for Euclidean spaces, geodesics are trivial (straight lines).",
    "created_at": "2020-07-08T06:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423146",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:40 mkoeppe]:
> Does `EuclideanSpace` know how to compute geodesics, and thus distances?
Yes it does, via [IntegratedGeodesic](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/integrated_curve.html). Note however that for Euclidean spaces, geodesics are trivial (straight lines).



---

archive/issue_comments_423147.json:
```json
{
    "body": "By the way, an overview of `EuclideanSpace` capabilities is in this [thematic tutorial](https://doc.sagemath.org/html/en/thematic_tutorials/vector_calculus.html); see also the  [associated notebooks](https://sagemanifolds.obspm.fr/vector_calculus.html) and this [section of the reference manual](https://doc.sagemath.org/html/en/reference/manifolds/euclidean_space.html).",
    "created_at": "2020-07-08T07:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423147",
    "user": "https://github.com/egourgoulhon"
}
```

By the way, an overview of `EuclideanSpace` capabilities is in this [thematic tutorial](https://doc.sagemath.org/html/en/thematic_tutorials/vector_calculus.html); see also the  [associated notebooks](https://sagemanifolds.obspm.fr/vector_calculus.html) and this [section of the reference manual](https://doc.sagemath.org/html/en/reference/manifolds/euclidean_space.html).



---

archive/issue_comments_423148.json:
```json
{
    "body": "Thanks for the pointers. It's on my list of things to learn more systematically about sage-manifolds.",
    "created_at": "2020-07-08T13:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423148",
    "user": "https://github.com/mkoeppe"
}
```

Thanks for the pointers. It's on my list of things to learn more systematically about sage-manifolds.



---

archive/issue_comments_423149.json:
```json
{
    "body": "Replying to [comment:41 egourgoulhon]:\n> Replying to [comment:40 mkoeppe]:\n> > Does `EuclideanSpace` know how to compute geodesics, and thus distances?\n> Yes it does, via [IntegratedGeodesic](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/integrated_curve.html).\n\nShould it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?",
    "created_at": "2020-07-08T13:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423149",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:41 egourgoulhon]:
> Replying to [comment:40 mkoeppe]:
> > Does `EuclideanSpace` know how to compute geodesics, and thus distances?
> Yes it does, via [IntegratedGeodesic](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/integrated_curve.html).

Should it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?



---

archive/issue_comments_423150.json:
```json
{
    "body": "Replying to [comment:44 mkoeppe]:\n> \n> Should it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?\n\nYes. It will be easy to implement the distance function by means of the Cartesian chart.",
    "created_at": "2020-07-08T21:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423150",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:44 mkoeppe]:
> 
> Should it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?

Yes. It will be easy to implement the distance function by means of the Cartesian chart.



---

archive/issue_comments_423151.json:
```json
{
    "body": "Replying to [comment:45 egourgoulhon]:\n> Replying to [comment:44 mkoeppe]:\n> > \n> > Should it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?\n> \n> Yes. It will be easy to implement the distance function by means of the Cartesian chart. \n\nThanks. I have added this task to #30062.",
    "created_at": "2020-07-10T18:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423151",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:45 egourgoulhon]:
> Replying to [comment:44 mkoeppe]:
> > 
> > Should it (and presumably other manifold classes) be added to the category `MetricSpaces` then (#30062)?
> 
> Yes. It will be easy to implement the distance function by means of the Cartesian chart. 

Thanks. I have added this task to #30062.



---

archive/issue_comments_423152.json:
```json
{
    "body": "Should we set this ticket to \"needs_review\"?",
    "created_at": "2020-07-14T19:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423152",
    "user": "https://github.com/mkoeppe"
}
```

Should we set this ticket to "needs_review"?



---

archive/issue_comments_423153.json:
```json
{
    "body": "Can you please briefly summarize in the description what has actually been done and what the new benefits are? It is very difficult for me to piece that all together just from the comments and cross references to other tickets. Thanks! :)\n\nIn general, I would wait until the dependent tickets are merged. However, I am a bad role model due to my impatience.",
    "created_at": "2020-07-15T13:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423153",
    "user": "https://github.com/mjungmath"
}
```

Can you please briefly summarize in the description what has actually been done and what the new benefits are? It is very difficult for me to piece that all together just from the comments and cross references to other tickets. Thanks! :)

In general, I would wait until the dependent tickets are merged. However, I am a bad role model due to my impatience.



---

archive/issue_comments_423154.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-15T14:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423154",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_423155.json:
```json
{
    "body": "Replying to [comment:49 mkoeppe]:\n> Should we set this ticket to \"needs_review\"?\nYes, indeed.",
    "created_at": "2020-07-15T14:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423155",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:49 mkoeppe]:
> Should we set this ticket to "needs_review"?
Yes, indeed.



---

archive/issue_comments_423156.json:
```json
{
    "body": "Replying to [comment:50 gh-mjungmath]:\n> Can you please briefly summarize in the description what has actually been done and what the new benefits are? It is very difficult for me to piece that all together just from the comments and cross references to other tickets. Thanks! :)\n\nThe code added in this ticket is described in comment:22 and comment:23.\nThe other code in the ticket branch arises from the dependencies tickets #30065 and #30074.",
    "created_at": "2020-07-15T14:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423156",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:50 gh-mjungmath]:
> Can you please briefly summarize in the description what has actually been done and what the new benefits are? It is very difficult for me to piece that all together just from the comments and cross references to other tickets. Thanks! :)

The code added in this ticket is described in comment:22 and comment:23.
The other code in the ticket branch arises from the dependencies tickets #30065 and #30074.



---

archive/issue_comments_423157.json:
```json
{
    "body": "Replying to [comment:53 egourgoulhon]:\n> The code added in this ticket is described in comment:22 and comment:23.\n> The other code in the ticket branch arises from the dependencies tickets #30065 and #30074.\n> \nThanks!",
    "created_at": "2020-07-15T14:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423157",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:53 egourgoulhon]:
> The code added in this ticket is described in comment:22 and comment:23.
> The other code in the ticket branch arises from the dependencies tickets #30065 and #30074.
> 
Thanks!



---

archive/issue_comments_423158.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-19T00:56:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423158",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_423159.json:
```json
{
    "body": "Patchbot not green. The latest branch of #30074 has not been merged yet.",
    "created_at": "2020-07-19T10:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423159",
    "user": "https://github.com/mjungmath"
}
```

Patchbot not green. The latest branch of #30074 has not been merged yet.



---

archive/issue_comments_423160.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-07-19T10:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423160",
    "user": "https://github.com/mjungmath"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_423161.json:
```json
{
    "body": "That is not a real error (the other patchbot also came back green). You don't need to have all of the other branches merged in.",
    "created_at": "2020-07-19T12:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423161",
    "user": "https://github.com/tscrim"
}
```

That is not a real error (the other patchbot also came back green). You don't need to have all of the other branches merged in.



---

archive/issue_comments_423162.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-07-19T12:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423162",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_423163.json:
```json
{
    "body": "Replying to [comment:62 tscrim]:\n> That is not a real error (the other patchbot also came back green).\nIt is a real error. Pyflakes is complaining about an unused import.\n\n> You don't need to have all of the other branches merged in.\nWhy is that? Wouldn't that cause a merge conflict later on?",
    "created_at": "2020-07-19T12:53:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423163",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:62 tscrim]:
> That is not a real error (the other patchbot also came back green).
It is a real error. Pyflakes is complaining about an unused import.

> You don't need to have all of the other branches merged in.
Why is that? Wouldn't that cause a merge conflict later on?



---

archive/issue_comments_423164.json:
```json
{
    "body": "Replying to [comment:63 gh-mjungmath]:\n> Replying to [comment:62 tscrim]:\n> > That is not a real error (the other patchbot also came back green).\n> It is a real error. Pyflakes is complaining about an unused import.\n\nNo, it is not. Pyflakes are not real errors (but they are good to clear).\n\n> > You don't need to have all of the other branches merged in.\n> Why is that? Wouldn't that cause in a merge conflict later on?\n\nThere is no need to add unnecessary extra merge commits when there is no conflict or a need to have the latest branch. If later changes on the first branch are done to unrelated parts to the changes on this branch, there is no conflict.\n\nAddendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.",
    "created_at": "2020-07-19T12:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423164",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:63 gh-mjungmath]:
> Replying to [comment:62 tscrim]:
> > That is not a real error (the other patchbot also came back green).
> It is a real error. Pyflakes is complaining about an unused import.

No, it is not. Pyflakes are not real errors (but they are good to clear).

> > You don't need to have all of the other branches merged in.
> Why is that? Wouldn't that cause in a merge conflict later on?

There is no need to add unnecessary extra merge commits when there is no conflict or a need to have the latest branch. If later changes on the first branch are done to unrelated parts to the changes on this branch, there is no conflict.

Addendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.



---

archive/issue_comments_423165.json:
```json
{
    "body": "Replying to [comment:64 tscrim]:\n> Replying to [comment:63 gh-mjungmath]:\n> > Replying to [comment:62 tscrim]:\n> > > That is not a real error (the other patchbot also came back green).\n> > It is a real error. Pyflakes is complaining about an unused import.\n> \n> No, it is not. Pyflakes are not real errors (but they are good to clear).\nOkay, I see what you mean.\n\nReplying to [comment:64 tscrim]:\n> Addendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.\n\nMh. Sorry, I don't get it. The #30074 will be merged into develop first because of the dependence, right? Afterwards, this ticket will be merged. If this ticket consists of an older version than #30074, this would cause a merge conflict, wouldn't it? Or, at least, the pyflakes error would be added again.",
    "created_at": "2020-07-19T13:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423165",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:64 tscrim]:
> Replying to [comment:63 gh-mjungmath]:
> > Replying to [comment:62 tscrim]:
> > > That is not a real error (the other patchbot also came back green).
> > It is a real error. Pyflakes is complaining about an unused import.
> 
> No, it is not. Pyflakes are not real errors (but they are good to clear).
Okay, I see what you mean.

Replying to [comment:64 tscrim]:
> Addendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.

Mh. Sorry, I don't get it. The #30074 will be merged into develop first because of the dependence, right? Afterwards, this ticket will be merged. If this ticket consists of an older version than #30074, this would cause a merge conflict, wouldn't it? Or, at least, the pyflakes error would be added again.



---

archive/issue_comments_423166.json:
```json
{
    "body": "Replying to [comment:65 gh-mjungmath]:\n> Replying to [comment:64 tscrim]:\n> > Addendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.\n> \n> Mh. Sorry, I don't get it. The #30074 will be merged into develop first because of the dependence, right? Afterwards, this ticket will be merged. If this ticket consists of an older version than #30074, this would cause a merge conflict, wouldn't it? Or, at least, the pyflakes error would be added again.\n\nNo. The result will look like this:\n\n```\nB--0--X--T----M\n    \\        /\n     0--0--H\n```\n\nwhere `T` is this branch and `H` is the head of #30074. So the #30074 branch will be merged first (all commits marked `0` starting from the latest beta `B` and `H`), then the commits from this branch (labelled `X` and `T`), which will result in the merge commit `M`. This would be exactly the same as if you merged in the latest commits from #30074 because that would be doing the same thing. The only difference is you have an extra merge commit in where this branch is pointing to.",
    "created_at": "2020-07-19T13:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423166",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:65 gh-mjungmath]:
> Replying to [comment:64 tscrim]:
> > Addendum - The pyflakes is handled on the later commits from #30074. So changing that here would cause a merge conflict and resolve a problem already fixed.
> 
> Mh. Sorry, I don't get it. The #30074 will be merged into develop first because of the dependence, right? Afterwards, this ticket will be merged. If this ticket consists of an older version than #30074, this would cause a merge conflict, wouldn't it? Or, at least, the pyflakes error would be added again.

No. The result will look like this:

```
B--0--X--T----M
    \        /
     0--0--H
```

where `T` is this branch and `H` is the head of #30074. So the #30074 branch will be merged first (all commits marked `0` starting from the latest beta `B` and `H`), then the commits from this branch (labelled `X` and `T`), which will result in the merge commit `M`. This would be exactly the same as if you merged in the latest commits from #30074 because that would be doing the same thing. The only difference is you have an extra merge commit in where this branch is pointing to.



---

archive/issue_comments_423167.json:
```json
{
    "body": "Replying to [comment:66 tscrim]:\n> No. The result will look like this:\n> {{{\n> B--0--X--T----M\n>     \\        /\n>      0--0--H\n> }}}\n> where `T` is this branch and `H` is the head of #30074. So the #30074 branch will be merged first (all commits marked `0` starting from the latest beta `B` and `H`), then the commits from this branch (labelled `X` and `T`), which will result in the merge commit `M`. This would be exactly the same as if you merged in the latest commits from #30074 because that would be doing the same thing. The only difference is you have an extra merge commit in where this branch is pointing to.\n\nAh, I see. This is because the commit in #30074 is more recent, right?",
    "created_at": "2020-07-19T13:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423167",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:66 tscrim]:
> No. The result will look like this:
> {{{
> B--0--X--T----M
>     \        /
>      0--0--H
> }}}
> where `T` is this branch and `H` is the head of #30074. So the #30074 branch will be merged first (all commits marked `0` starting from the latest beta `B` and `H`), then the commits from this branch (labelled `X` and `T`), which will result in the merge commit `M`. This would be exactly the same as if you merged in the latest commits from #30074 because that would be doing the same thing. The only difference is you have an extra merge commit in where this branch is pointing to.

Ah, I see. This is because the commit in #30074 is more recent, right?



---

archive/issue_comments_423168.json:
```json
{
    "body": "Replying to [comment:67 gh-mjungmath]:\n> Ah, I see. This is because the commit in #30074 is more recent, right?\n\nYes, but it is still based off a common base commit.",
    "created_at": "2020-07-19T14:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423168",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:67 gh-mjungmath]:
> Ah, I see. This is because the commit in #30074 is more recent, right?

Yes, but it is still based off a common base commit.



---

archive/issue_comments_423169.json:
```json
{
    "body": "Replying to [comment:68 tscrim]:\n> Replying to [comment:67 gh-mjungmath]:\n> > Ah, I see. This is because the commit in #30074 is more recent, right?\n> \n> Yes, but it is still based off a common base commit.\n\nAh well. Thank you for explaining this, and sorry for delaying the process. This is good to know for future commits of mine.",
    "created_at": "2020-07-19T14:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423169",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:68 tscrim]:
> Replying to [comment:67 gh-mjungmath]:
> > Ah, I see. This is because the commit in #30074 is more recent, right?
> 
> Yes, but it is still based off a common base commit.

Ah well. Thank you for explaining this, and sorry for delaying the process. This is good to know for future commits of mine.



---

archive/issue_comments_423170.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-02T08:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29824#issuecomment-423170",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_077334.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-02T08:20:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29824",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29824#event-77334"
}
```
