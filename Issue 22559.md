# Issue 22559: Deprecate deprecated_callable_import

archive/issues_022559.json:
```json
{
    "body": "CC:  @videlec\n\nThe functionality of `deprecated_callable_import` can be achieved in a simpler and more general way by a lazy import with deprecation.\n\nSo we deprecate `deprecated_callable_import` in this ticket and remove all existing uses. Those existing uses come from #17034, #17867, #19096, #19315, #20908 so they can be removed.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22796\n\n",
    "created_at": "2017-04-11T12:23:53Z",
    "labels": [
        "misc",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Deprecate deprecated_callable_import",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22559",
    "user": "@jdemeyer"
}
```
CC:  @videlec

The functionality of `deprecated_callable_import` can be achieved in a simpler and more general way by a lazy import with deprecation.

So we deprecate `deprecated_callable_import` in this ticket and remove all existing uses. Those existing uses come from #17034, #17867, #19096, #19315, #20908 so they can be removed.

Issue created by migration from https://trac.sagemath.org/ticket/22796





---

archive/issue_comments_314370.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-04-11T13:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314370",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_314371.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-11T13:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314371",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_314372.json:
```json
{
    "body": "To make `lazy_import` invisible, I think the following is cleaner\n\n```\nfrom sage.misc.lazy_import import lazy_import\nlazy_import('sage.some.package', 'some_function', deprecation=666)\ndel lazy_import\n```\n",
    "created_at": "2017-04-11T13:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314372",
    "user": "@videlec"
}
```

To make `lazy_import` invisible, I think the following is cleaner

```
from sage.misc.lazy_import import lazy_import
lazy_import('sage.some.package', 'some_function', deprecation=666)
del lazy_import
```




---

archive/issue_comments_314373.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> I think the following is cleaner\n\nI think that `import lazy_import as _lazy_import` is better, because there are less chances for mistakes (one could easily forget to add the `del lazy_import` or accidentally remove that statement).",
    "created_at": "2017-04-11T13:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314373",
    "user": "@jdemeyer"
}
```

Replying to [comment:6 vdelecroix]:
> I think the following is cleaner

I think that `import lazy_import as _lazy_import` is better, because there are less chances for mistakes (one could easily forget to add the `del lazy_import` or accidentally remove that statement).



---

archive/issue_comments_314374.json:
```json
{
    "body": "This looks good to me.",
    "created_at": "2017-05-09T15:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314374",
    "user": "@dimpase"
}
```

This looks good to me.



---

archive/issue_comments_314375.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-09T15:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314375",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314376.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-11T22:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314376",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314377.json:
```json
{
    "body": "Merge conflict...",
    "created_at": "2017-05-11T22:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314377",
    "user": "@vbraun"
}
```

Merge conflict...



---

archive/issue_comments_314378.json:
```json
{
    "body": "it does merge cleanly in 8.0.beta5, thus I have no idea where the merge conflict comes from.",
    "created_at": "2017-05-11T22:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314378",
    "user": "@dimpase"
}
```

it does merge cleanly in 8.0.beta5, thus I have no idea where the merge conflict comes from.



---

archive/issue_comments_314379.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-05-12T08:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314379",
    "user": "@dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_314380.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-13T09:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314380",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314381.json:
```json
{
    "body": "Merge conflict... Obviously the merge conflict comes from stuff in beta6, duh.",
    "created_at": "2017-05-13T09:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314381",
    "user": "@vbraun"
}
```

Merge conflict... Obviously the merge conflict comes from stuff in beta6, duh.



---

archive/issue_comments_314382.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-05-13T20:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314382",
    "user": "@dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_314383.json:
```json
{
    "body": "it was weird seeing \"Merge conflict\" against a branch that was not public yet :-)\nanyhow, it's a trivial merge, one chunk was to be deleted.",
    "created_at": "2017-05-13T20:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314383",
    "user": "@dimpase"
}
```

it was weird seeing "Merge conflict" against a branch that was not public yet :-)
anyhow, it's a trivial merge, one chunk was to be deleted.



---

archive/issue_comments_314384.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-14T09:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314384",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314385.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py\n**********************************************************************\nFile \"src/sage/combinat/designs/design_catalog.py\", line 77, in sage.combinat.designs.design_catalog\nFailed example:\n    'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)\nExpected:\n    False\nGot:\n    True\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.combinat.designs.design_catalog\n    [2 tests, 1 failure, 0.27 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.3 seconds\n    cpu time: 0.3 seconds\n    cumulative wall time: 0.3 seconds\n```\n",
    "created_at": "2017-05-14T09:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314385",
    "user": "@vbraun"
}
```


```
sage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py
**********************************************************************
File "src/sage/combinat/designs/design_catalog.py", line 77, in sage.combinat.designs.design_catalog
Failed example:
    'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)
Expected:
    False
Got:
    True
**********************************************************************
1 item had failures:
   1 of   3 in sage.combinat.designs.design_catalog
    [2 tests, 1 failure, 0.27 s]
----------------------------------------------------------------------
sage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 0.3 seconds
    cpu time: 0.3 seconds
    cumulative wall time: 0.3 seconds
```




---

archive/issue_comments_314386.json:
```json
{
    "body": "should the following be applied:\n\n```\n--- a/src/sage/combinat/designs/design_catalog.py\n+++ b/src/sage/combinat/designs/design_catalog.py\n@@ -74,7 +74,7 @@ REFERENCES:\n \n TESTS::\n \n-    sage: 'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)\n+    sage: 'deprecated_callable_import' in dir(designs)\n     False\n \"\"\"\n from __future__ import absolute_import\n```\n\n\n(I don't get the `absolute_import` part in this test---surely `absolute_import` is all over the place; removing it from the test makes the test pass)",
    "created_at": "2017-05-14T10:34:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314386",
    "user": "@dimpase"
}
```

should the following be applied:

```
--- a/src/sage/combinat/designs/design_catalog.py
+++ b/src/sage/combinat/designs/design_catalog.py
@@ -74,7 +74,7 @@ REFERENCES:
 
 TESTS::
 
-    sage: 'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)
+    sage: 'deprecated_callable_import' in dir(designs)
     False
 """
 from __future__ import absolute_import
```


(I don't get the `absolute_import` part in this test---surely `absolute_import` is all over the place; removing it from the test makes the test pass)



---

archive/issue_comments_314387.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-05-14T17:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314387",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_314388.json:
```json
{
    "body": "oops, wrong branch",
    "created_at": "2017-05-14T17:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314388",
    "user": "@dimpase"
}
```

oops, wrong branch



---

archive/issue_comments_314389.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-14T17:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314389",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_314390.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-14T17:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314390",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_314391.json:
```json
{
    "body": "the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.",
    "created_at": "2017-05-14T17:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314391",
    "user": "@dimpase"
}
```

the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.



---

archive/issue_comments_314392.json:
```json
{
    "body": "Replying to [comment:19 dimpase]:\n> the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.\n\nWell, the test was about `absolute_import` and `deprecated_callable_import`. You only fixed the latter, I now fixed the former too.",
    "created_at": "2017-05-15T16:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314392",
    "user": "@jdemeyer"
}
```

Replying to [comment:19 dimpase]:
> the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.

Well, the test was about `absolute_import` and `deprecated_callable_import`. You only fixed the latter, I now fixed the former too.



---

archive/issue_comments_314393.json:
```json
{
    "body": "Sage imports drive me mad elsewhere too: #22799#comment:90\n:-)\n----\nNew commits:",
    "created_at": "2017-05-15T16:37:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314393",
    "user": "@dimpase"
}
```

Sage imports drive me mad elsewhere too: #22799#comment:90
:-)
----
New commits:



---

archive/issue_comments_314394.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-15T16:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314394",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314395.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-16T22:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22559#issuecomment-314395",
    "user": "@vbraun"
}
```

Resolution: fixed
