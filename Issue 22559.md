# Issue 22559: Deprecate deprecated_callable_import

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-04-11 12:23:53

CC:  vdelecroix

The functionality of `deprecated_callable_import` can be achieved in a simpler and more general way by a lazy import with deprecation.

So we deprecate `deprecated_callable_import` in this ticket and remove all existing uses. Those existing uses come from #17034, #17867, #19096, #19315, #20908 so they can be removed.


---

Comment by git created at 2017-04-11 13:03:27

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-04-11 13:07:43

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2017-04-11 13:47:01

To make `lazy_import` invisible, I think the following is cleaner

```
from sage.misc.lazy_import import lazy_import
lazy_import('sage.some.package', 'some_function', deprecation=666)
del lazy_import
```



---

Comment by jdemeyer created at 2017-04-11 13:49:28

Replying to [comment:6 vdelecroix]:
> I think the following is cleaner

I think that `import lazy_import as _lazy_import` is better, because there are less chances for mistakes (one could easily forget to add the `del lazy_import` or accidentally remove that statement).


---

Comment by dimpase created at 2017-05-09 15:40:45

This looks good to me.


---

Comment by dimpase created at 2017-05-09 15:40:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-05-11 22:02:40

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-05-11 22:02:40

Merge conflict...


---

Comment by dimpase created at 2017-05-11 22:34:52

it does merge cleanly in 8.0.beta5, thus I have no idea where the merge conflict comes from.


---

Comment by dimpase created at 2017-05-12 08:36:45

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2017-05-13 09:06:16

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-05-13 09:06:16

Merge conflict... Obviously the merge conflict comes from stuff in beta6, duh.


---

Comment by dimpase created at 2017-05-13 20:00:06

Changing status from needs_work to positive_review.


---

Comment by dimpase created at 2017-05-13 20:00:06

it was weird seeing "Merge conflict" against a branch that was not public yet :-)
anyhow, it's a trivial merge, one chunk was to be deleted.


---

Comment by vbraun created at 2017-05-14 09:34:07

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-05-14 09:34:07


```
sage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py
**********************************************************************
File "src/sage/combinat/designs/design_catalog.py", line 77, in sage.combinat.designs.design_catalog
Failed example:
    'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)
Expected:
    False
Got:
    True
**********************************************************************
1 item had failures:
   1 of   3 in sage.combinat.designs.design_catalog
    [2 tests, 1 failure, 0.27 s]
----------------------------------------------------------------------
sage -t --long --warn-long 72.0 src/sage/combinat/designs/design_catalog.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 0.3 seconds
    cpu time: 0.3 seconds
    cumulative wall time: 0.3 seconds
```



---

Comment by dimpase created at 2017-05-14 10:34:31

should the following be applied:

```
--- a/src/sage/combinat/designs/design_catalog.py
+++ b/src/sage/combinat/designs/design_catalog.py
`@``@` -74,7 +74,7 `@``@` REFERENCES:
 
 TESTS::
 
-    sage: 'absolute_import' in dir(designs) or 'deprecated_callable_import' in dir(designs)
+    sage: 'deprecated_callable_import' in dir(designs)
     False
 """
 from __future__ import absolute_import
```


(I don't get the `absolute_import` part in this test---surely `absolute_import` is all over the place; removing it from the test makes the test pass)


---

Comment by git created at 2017-05-14 17:47:47

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dimpase created at 2017-05-14 17:48:27

oops, wrong branch


---

Comment by git created at 2017-05-14 17:52:48

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2017-05-14 17:56:08

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2017-05-14 17:56:08

the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.


---

Comment by jdemeyer created at 2017-05-15 16:31:56

Replying to [comment:19 dimpase]:
> the last commit removes an obsolete test - there is no `deprecated_callable_import` anywhere any more anyway.

Well, the test was about `absolute_import` and `deprecated_callable_import`. You only fixed the latter, I now fixed the former too.


---

Comment by dimpase created at 2017-05-15 16:37:43

Sage imports drive me mad elsewhere too: #22799#comment:90
:-)
----
New commits:


---

Comment by dimpase created at 2017-05-15 16:43:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-05-16 22:22:09

Resolution: fixed
