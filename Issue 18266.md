# Issue 18266: ClasscallMetaclass doesn't work with six's with_metaclass

Issue created by migration from https://trac.sagemath.org/ticket/18503

Original creator: jpswanson

Original creation time: 2015-05-25 19:59:10

CC:  ohanar

Keywords: ClasscallMetaclass, six, with_metaclass, metaclass, python3

Title says it all. MWE:


```
from sage.misc.classcall_metaclass import ClasscallMetaclass
from six import with_metaclass
class foo(with_metaclass(ClasscallMetaclass)):
    pass
```


throws an error


```
TypeError: type.__new__(metaclass) is not safe, use sage.misc.classcall_metaclass.ClasscallMetaclass.__new__()
```


in six.pyc in with_metaclass(meta, *bases). If mixed Python 2 and Python 3 becomes a reality (e.g. #18492), this'll need to be fixed.


---

Comment by ohanar created at 2015-05-25 22:34:45

New commits:


---

Comment by ohanar created at 2015-05-25 22:34:45

Changing status from new to needs_review.


---

Comment by jpswanson created at 2015-05-25 22:43:39

Changing status from needs_review to positive_review.


---

Comment by jpswanson created at 2015-05-25 22:43:39

Good enough. It's a bit infortunate to have to add a slightly modified version of six to Sage, but we might run into other Cython-specific issues with it and development on six seems to have stopped for the last year or so.


---

Comment by jpswanson created at 2015-05-26 00:56:22

Changing keywords from "ClasscallMetaclass, six, with_metaclass, metaclass, python3" to "ClasscallMetaclass, six, with_metaclass, metaclass, python3, days64.25".


---

Comment by vbraun created at 2015-05-26 17:46:16

Resolution: fixed
