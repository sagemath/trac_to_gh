# Issue 27677: py3: hash collisions of Laurent polynomials

Issue created by migration from https://trac.sagemath.org/ticket/27914

Original creator: @mwageringel

Original creation time: 2019-06-01 10:36:02

This ticket adjusts the hash of multivariate Laurent polynomials, so that it agrees with the hash of univariate Laurent polynomials.

This solves the following problem: Using Python 3, this doctest in `laurent_polynomial.pyx` fails about 1 out of 4 times.

```
            sage: L.<w,z> = LaurentPolynomialRing(QQ)
            sage: len({hash(w^i*z^j) for i in [-2..2] for j in [-2..2]})
            25
```

Due to hash collisions, the result can be smaller than 25 (such as 23 or 21). This gets even worse when using a larger range of monomials.

Regardless of that, it is desirable that univariate and multivariate Laurent polynomials have the same hash anyway. The univariate hash implementation does not seem to have these collisions, so adopting that implementation solves this problem.

For reference, the univariate and multivariate hashes were implemented in #21272 and #23864.


---

Comment by @mwageringel created at 2019-06-01 11:10:50

New commits:


---

Comment by @mwageringel created at 2019-06-01 11:10:50

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-06-02 16:59:26

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-06-02 16:59:26

ok, let it be


---

Comment by vbraun created at 2019-06-05 18:30:49

Resolution: fixed
