# Issue 31046: 1000× speedup of conjugate of double dense matrices

Issue created by migration from https://trac.sagemath.org/ticket/31283

Original creator: @mwageringel

Original creation time: 2021-01-22 22:02:22

CC:  tscrim

This ticket implements `conjugate` more efficiently for matrices over CDF and RDF. This speeds up taking the conjugate, and by extension Hermitian transpose, a lot.

Before:


```
sage: A = matrix.random(CDF, 80)
sage: %timeit A.C
28.7 ms ± 628 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
sage: %timeit A.H
30.2 ms ± 572 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
```


This is a performance bottleneck because it is much slower than matrix multiplication for example, even though that would have worse complexity.

After:


```
sage: A = matrix.random(CDF, 80)
sage: %timeit A.C
5.96 µs ± 36.9 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
sage: %timeit A.H
14 µs ± 59.7 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
```




---

Comment by @mwageringel created at 2021-01-22 22:09:04

New commits:


---

Comment by @mwageringel created at 2021-01-22 22:09:04

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2021-01-23 13:28:55

The bot is green. Please review.


---

Comment by tscrim created at 2021-01-23 14:25:22

LGTM


---

Comment by tscrim created at 2021-01-23 14:25:38

Changing status from needs_review to positive_review.


---

Comment by @mwageringel created at 2021-01-23 14:32:03

Thank you.


---

Comment by vbraun created at 2021-01-31 20:53:02

Resolution: fixed
