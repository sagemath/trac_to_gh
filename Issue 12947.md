# Issue 12947: ._apply_module_morphism() in combinat/free_module.py doesn't handle zero element properly

archive/issues_012947.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  saliola@gmail.com\n\na potential defect in ._apply_module_morphism function calls list( self.basis().keys() ) when self.is_zero() is True.  This works fine if self.basis() is a finite set, but causes a problem if self.basis() is an infinite set with an iteration function.   In this case, the function hangs trying to list the infinite set.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13119\n\n",
    "created_at": "2012-06-15T20:11:14Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "._apply_module_morphism() in combinat/free_module.py doesn't handle zero element properly",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12947",
    "user": "https://github.com/zabrocki"
}
```
Assignee: sage-combinat

CC:  saliola@gmail.com

a potential defect in ._apply_module_morphism function calls list( self.basis().keys() ) when self.is_zero() is True.  This works fine if self.basis() is a finite set, but causes a problem if self.basis() is an infinite set with an iteration function.   In this case, the function hangs trying to list the infinite set.

Issue created by migration from https://trac.sagemath.org/ticket/13119





---

archive/issue_comments_155763.json:
```json
{
    "body": "I added a patch to this ticket.  Discussion is at https://groups.google.com/d/topic/sage-combinat-devel/yPjfNINtVbk/discussion\n\nI changed one thing in addition since I had originally reported this bug.  That is, if the codomain is not known and it looks for the parent of an element of the image to determine the codomain then raise a value error if the element returned by the function doesn't have a parent.",
    "created_at": "2012-11-24T19:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155763",
    "user": "https://github.com/zabrocki"
}
```

I added a patch to this ticket.  Discussion is at https://groups.google.com/d/topic/sage-combinat-devel/yPjfNINtVbk/discussion

I changed one thing in addition since I had originally reported this bug.  That is, if the codomain is not known and it looks for the parent of an element of the image to determine the codomain then raise a value error if the element returned by the function doesn't have a parent.



---

archive/issue_comments_155764.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-24T19:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155764",
    "user": "https://github.com/zabrocki"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_155765.json:
```json
{
    "body": "Removed a bit of whitespace within the function\n\nApply: trac_13119_apply_module_morphism_bugfix-mz.patch",
    "created_at": "2012-11-24T20:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155765",
    "user": "https://github.com/zabrocki"
}
```

Removed a bit of whitespace within the function

Apply: trac_13119_apply_module_morphism_bugfix-mz.patch



---

archive/issue_comments_155766.json:
```json
{
    "body": "Hey Mike,\n\nTwo minor things:\n- Could you use the auto-linking `:func:`on_basis`` in the docstring?\n- Since at some point, there is a shift to Python 3, I think we should start using that syntax:\n\n```\nraise ValueError('Codomain could not be determined')\n```\n\nLooks good to me otherwise.\n\nThanks,\n\nTravis\n\nFor patchbot:\n\nApply only: trac_13119_apply_module_morphism_bugfix-mz.patch",
    "created_at": "2012-12-17T07:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155766",
    "user": "https://github.com/tscrim"
}
```

Hey Mike,

Two minor things:
- Could you use the auto-linking `:func:`on_basis`` in the docstring?
- Since at some point, there is a shift to Python 3, I think we should start using that syntax:

```
raise ValueError('Codomain could not be determined')
```

Looks good to me otherwise.

Thanks,

Travis

For patchbot:

Apply only: trac_13119_apply_module_morphism_bugfix-mz.patch



---

archive/issue_comments_155767.json:
```json
{
    "body": "Attachment [trac_13119_apply_module_morphism_bugfix-mz.patch](tarball://root/attachments/some-uuid/ticket13119/trac_13119_apply_module_morphism_bugfix-mz.patch) by @zabrocki created at 2012-12-17 15:30:51\n\nHi Travis,\nThanks for picking this up.  I made your changes and caught one or two more fixes in the docstring.\n-Mike",
    "created_at": "2012-12-17T15:30:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155767",
    "user": "https://github.com/zabrocki"
}
```

Attachment [trac_13119_apply_module_morphism_bugfix-mz.patch](tarball://root/attachments/some-uuid/ticket13119/trac_13119_apply_module_morphism_bugfix-mz.patch) by @zabrocki created at 2012-12-17 15:30:51

Hi Travis,
Thanks for picking this up.  I made your changes and caught one or two more fixes in the docstring.
-Mike



---

archive/issue_comments_155768.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-12-17T17:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155768",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_155769.json:
```json
{
    "body": "Looks good. Thanks Mike.",
    "created_at": "2012-12-17T17:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155769",
    "user": "https://github.com/tscrim"
}
```

Looks good. Thanks Mike.



---

archive/issue_comments_155770.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-12-27T10:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12947",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12947#issuecomment-155770",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
