# Issue 12947: ._apply_module_morphism() in combinat/free_module.py doesn't handle zero element properly

Issue created by migration from https://trac.sagemath.org/ticket/13119

Original creator: zabrocki

Original creation time: 2012-06-15 20:11:14

Assignee: sage-combinat

CC:  saliola@gmail.com

a potential defect in ._apply_module_morphism function calls list( self.basis().keys() ) when self.is_zero() is True.  This works fine if self.basis() is a finite set, but causes a problem if self.basis() is an infinite set with an iteration function.   In this case, the function hangs trying to list the infinite set.


---

Comment by zabrocki created at 2012-11-24 19:09:18

I added a patch to this ticket.  Discussion is at https://groups.google.com/d/topic/sage-combinat-devel/yPjfNINtVbk/discussion

I changed one thing in addition since I had originally reported this bug.  That is, if the codomain is not known and it looks for the parent of an element of the image to determine the codomain then raise a value error if the element returned by the function doesn't have a parent.


---

Comment by zabrocki created at 2012-11-24 19:09:39

Changing status from new to needs_review.


---

Comment by zabrocki created at 2012-11-24 20:50:24

Removed a bit of whitespace within the function

Apply: trac_13119_apply_module_morphism_bugfix-mz.patch


---

Comment by tscrim created at 2012-12-17 07:31:19

Hey Mike,

Two minor things:
- Could you use the auto-linking `:func:`on_basis`` in the docstring?
- Since at some point, there is a shift to Python 3, I think we should start using that syntax:

```
raise ValueError('Codomain could not be determined')
```

Looks good to me otherwise.

Thanks,

Travis

For patchbot:

Apply only: trac_13119_apply_module_morphism_bugfix-mz.patch


---

Attachment

Hi Travis,
Thanks for picking this up.  I made your changes and caught one or two more fixes in the docstring.
-Mike


---

Comment by tscrim created at 2012-12-17 17:44:06

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2012-12-17 17:44:06

Looks good. Thanks Mike.


---

Comment by jdemeyer created at 2012-12-27 10:24:52

Resolution: fixed
