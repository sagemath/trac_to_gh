# Issue 23900: Invertibility of simplification_isomorphism

Issue created by migration from Trac.

Original creator: wphooper

Original creation time: 2017-11-01 04:12:13

Keywords: simplification_isomorphism

The simplification_isomorphism() method in the class
sage.groups.finitely_presented.FinitelyPresentedGroup_with_category
returns an isomorphism, which would in particular mean it is invertible. It would be useful to be able to access the inverse, however there is no obvious way to access this inverse.

Running the following code

```python
G.<a,b,c> = FreeGroup()
H = G / [a*b*c, a*b^2, c*b/c^2]
I = H.simplification_isomorphism()
print(type(I))
~I
```

Results in:

```
<class 'sage.groups.finitely_presented.GroupMorphismWithGensImages'>
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-7-106829259be7> in <module>()
      3 I = H.simplification_isomorphism()
      4 print(type(I))
----> 5 ~I

TypeError: bad operand type for unary ~: 'GroupMorphismWithGensImages'
```


I'm not sure if ~I would be the way to invert the map, but there are no obvious inversion methods in I, and the type of I suggests it is not invertible.

Thank you for your help. I am happy to help in any way I can, but I don't have much experience with creating patches, etc.


---

Comment by roed created at 2017-11-04 07:18:14

If you look at the source for `simplification_isomorphism` you'll see

```
I = self.gap().IsomorphismSimplifiedFpGroup()
domain = self
codomain = wrap_FpGroup(I.Range())
phi = lambda x: codomain(I.ImageElm(x.gap()))
HS = self.Hom(codomain)
return GroupMorphismWithGensImages(HS, phi)
```


The first step toward finding an inverse in Sage is to figure out how to do it in Gap....


---

Comment by roed created at 2017-11-04 07:18:59

You can look at 47.12-1 in https://www.gap-system.org/Manuals/doc/ref/chap47.html


---

Comment by wphooper created at 2017-11-10 21:16:41

I'm sorry about being slow to respond: I've been busy.

When I get a chance, I'll try to figure out how to do this myself so that I can submit a patch. Thanks for your help.


---

Comment by roed created at 2017-11-10 22:13:47

Replying to [comment:3 wphooper]:
> I'm sorry about being slow to respond: I've been busy.
> 
> When I get a chance, I'll try to figure out how to do this myself so that I can submit a patch. Thanks for your help.

No problem; we're all busy. Feel free to comment here if you get stuck.
