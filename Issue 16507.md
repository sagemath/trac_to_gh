# Issue 16507: Random failure in elliptic_curves/constructor.py

archive/issues_016507.json:
```json
{
    "body": "CC:  @pjbruin @JohnCremona\n\nKeywords: random_fail\n\nThe code is from #11474:\n\n```\nsage -t --long src/sage/schemes/elliptic_curves/constructor.py\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/constructor.py\", line 365, in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args\nFailed example:\n    E.gens()\nExpected:\n    [(-2 : 3 : 1), (1 : -1 : 1), (4 : -7 : 1)]\nGot:\n    [(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/constructor.py\", line 368, in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args\nFailed example:\n    E.gens()\nExpected:\n    [(-2 : 3 : 1), (1 : -1 : 1), (4 : -7 : 1)]\nGot:\n    [(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]\n**********************************************************************\n1 item had failures:\n   2 of  19 in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args\n    [182 tests, 2 failures, 67.70 s]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16744\n\n",
    "created_at": "2014-07-30T13:50:12Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Random failure in elliptic_curves/constructor.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16507",
    "user": "https://github.com/vbraun"
}
```
CC:  @pjbruin @JohnCremona

Keywords: random_fail

The code is from #11474:

```
sage -t --long src/sage/schemes/elliptic_curves/constructor.py
**********************************************************************
File "src/sage/schemes/elliptic_curves/constructor.py", line 365, in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args
Failed example:
    E.gens()
Expected:
    [(-2 : 3 : 1), (1 : -1 : 1), (4 : -7 : 1)]
Got:
    [(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]
**********************************************************************
File "src/sage/schemes/elliptic_curves/constructor.py", line 368, in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args
Failed example:
    E.gens()
Expected:
    [(-2 : 3 : 1), (1 : -1 : 1), (4 : -7 : 1)]
Got:
    [(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]
**********************************************************************
1 item had failures:
   2 of  19 in sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args
    [182 tests, 2 failures, 67.70 s]
```


Issue created by migration from https://trac.sagemath.org/ticket/16744





---

archive/issue_comments_216911.json:
```json
{
    "body": "It seems that this doctest is intended to illustrate that specifying \"gens=\" when cponstructing a curve from its label might be ignored when the curve is in the database.  But there is a danger:  the default database contains curves of conductors up to 10000 but does *not* contain their generators.  So this is a test whose output will depend on whether or not the optional extended database is installed, something which we have been trying to avoid.\n\nI hope the authors of #11474 (not me!) will be able to say whether I have got this diagnosis right.",
    "created_at": "2014-07-30T13:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216911",
    "user": "https://github.com/JohnCremona"
}
```

It seems that this doctest is intended to illustrate that specifying "gens=" when cponstructing a curve from its label might be ignored when the curve is in the database.  But there is a danger:  the default database contains curves of conductors up to 10000 but does *not* contain their generators.  So this is a test whose output will depend on whether or not the optional extended database is installed, something which we have been trying to avoid.

I hope the authors of #11474 (not me!) will be able to say whether I have got this diagnosis right.



---

archive/issue_comments_216912.json:
```json
{
    "body": "I'm responsible for that doctest.  The unexpected `[(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]` are the generators found by mwrank, not the ones in the database.  The fact that the same curve is used in an earlier doctest in that file might be the cause; I'll look into it.",
    "created_at": "2014-07-30T19:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216912",
    "user": "https://github.com/pjbruin"
}
```

I'm responsible for that doctest.  The unexpected `[(-2 : 3 : 1), (-7/4 : 25/8 : 1), (1 : -1 : 1)]` are the generators found by mwrank, not the ones in the database.  The fact that the same curve is used in an earlier doctest in that file might be the cause; I'll look into it.



---

archive/issue_comments_216913.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-30T21:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216913",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_216914.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-07-30T21:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216914",
    "user": "https://github.com/pjbruin"
}
```

Changing priority from major to minor.



---

archive/issue_comments_216915.json:
```json
{
    "body": "The problem was that curve 5077a1 could still be in the cache from an earlier doctest.  In this case the `gens` parameter (in the first failing doctest) would be ignored and the generators would be computed using mwrank.  This commit replaces the curve 5077a1 by 433a1, which is not used in any other doctest.",
    "created_at": "2014-07-30T21:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216915",
    "user": "https://github.com/pjbruin"
}
```

The problem was that curve 5077a1 could still be in the cache from an earlier doctest.  In this case the `gens` parameter (in the first failing doctest) would be ignored and the generators would be computed using mwrank.  This commit replaces the curve 5077a1 by 433a1, which is not used in any other doctest.



---

archive/issue_comments_216916.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-05T09:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216916",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_016007.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2014-08-06T12:07:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16507#event-16007"
}
```



---

archive/issue_comments_216917.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-06T12:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16507",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16507#issuecomment-216917",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
