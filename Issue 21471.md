# Issue 21471: Detect XCode version

Issue created by migration from https://trac.sagemath.org/ticket/21708

Original creator: mkoeppe

Original creation time: 2016-10-15 18:19:37

CC:  vbraun embray jdemeyer tscrim aschilling slelievre

Outdated XCode versions frequently cause build trouble.

We should detect the XCode version in `configure` and refuse to build until the user has updated XCode to latest.

- https://gist.github.com/jcayzac/5882969
- http://apple.stackexchange.com/questions/180957/determine-xcode-command-line-tools-version
- http://stackoverflow.com/questions/21272479/how-can-i-find-out-if-i-have-xcode-commandline-tools-installed
- http://stackoverflow.com/questions/15371925/how-to-check-if-command-line-tools-is-installed


---

Comment by jdemeyer created at 2016-10-15 19:29:12

Replying to [ticket:21708 mkoeppe]:
> We should detect the XCode version in `configure` and refuse to build until the user has updated XCode to latest.

I don't like these kind of checks. They are often annoying are rarely helpful. (I remember that MPIR at some point had very strict compiler checks. Often, those checks would fail and MPIR would refuse to build. But if the check was bypassed, MPIR built just fine)

Besides, are we sure that "Outdated XCode versions frequently cause build trouble"? I know that badly/partially installed XCode versions frequently cause build trouble. If you want to add a check, I would focus on that first.


---

Comment by mkoeppe created at 2016-10-15 19:47:31

I actually don't like such tests either, but I think it's better than having users find out after hours of building sage when building one of the later packages breaks.

I don't know much about the project's infrastructure for testing (buildbots?). So I don't know if we ever test automatically on different Mac OS versions, different XCode versions etc.

Travis CI has some infrastructure for that: https://docs.travis-ci.com/user/osx-ci-environment/
Perhaps we can use it?


---

Comment by mkoeppe created at 2016-10-15 21:51:38

Trying it out at https://travis-ci.org/mkoeppe/sage/jobs/167955367


---

Comment by vbraun created at 2016-10-15 21:54:55

* I agree that its super annoying

* Since the Xcode version is loosely tied to the OS version we would also effectively shut out older OSX versions.

* Apple tends to cut off developers when they don't use the latest Xcode as well. 

* The free TravisCI is afaik too slow to build Sage, let alone test it.


---

Comment by mkoeppe created at 2016-10-16 18:33:12

Replying to [comment:4 vbraun]:
> * The free TravisCI is afaik too slow to build Sage, let alone test it.

Yes, I tried it (see https://travis-ci.org/mkoeppe/sage/jobs/167999674) and even on a build without gcc, we're hitting a "per-job time limit" , which turns out to be ... 50 minutes (https://docs.travis-ci.com/user/customizing-the-build/#Build-Timeouts).


---

Comment by slelievre created at 2020-07-25 19:08:43

The capitalisation is Xcode rather than XCode.


---

Comment by mkoeppe created at 2020-07-25 20:17:57

FWIW, homebrew has an Xcode version check but it does not work very well

```
Warning: A newer Command Line Tools release is available.
Update them from Software Update in System Preferences or run:
  softwareupdate --all --install --force
$ softwareupdate --all --install --force
Software Update Tool

Finding available software
No updates are available.
```



---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
