# Issue 30679: genus() returns negative vaue.

Issue created by migration from https://trac.sagemath.org/ticket/30916

Original creator: @iwaokimura

Original creation time: 2020-11-15 02:12:10

Keywords: genus, function field

genus() for an algebraic function field returns negative value.
This is because a defining polynomial is not irreducible over a base field, the extension() method should raise an error.
Example:

```
In [1]: k=FunctionField(FiniteField(5), "T");  k
Rational function field in T over Finite Field of size 5
In [2]: T=k.gen(); T
T
In [3]: u=polygen(k, "u"); u
u
In [4]: M.<u>=k.extension(4*u^4 + T^4); M
Function field in u defined by 4*u^4 + T^4
In [5]: M.genus()
-3
```



---

Comment by @DavidAyotte created at 2021-03-16 18:57:39

Hello! I've looked at the source code and it is indeed possible to create a "Function field extension" using an reducible polynomial. In fact, the class "FunctionField_polymod" state this warning:



```
.. WARNING::

        It is not checked if the polynomial used to define the function field is irreducible
        Hence it is not guaranteed that this object really is a field!
        This is illustrated below.

    ::

        sage: K.<x> = FunctionField(QQ)
        sage: R.<y> = K[]
        sage: L.<y> = K.extension(x^2 - y^2)
        sage: (y - x)*(y + x)
        0
        sage: 1/(y - x)
        1
        sage: y - x == 0; y + x == 0
        False
        False
```


I believe that one workaround to this could be to add a keyword "check=False" that would verify if the defining polynomial is irreducible. The default value would be "False" since a lot a code seems to depend of the fact that we can create an extension which is not a field (i.e. a ring extension). But maybe there is a better way to do this.


---

Comment by @DavidAyotte created at 2021-03-17 14:44:26

I have added a keyword "check" to the method "extension". If anybody has a better way to do this feel free to change it. 
----
New commits:


---

Comment by @DavidAyotte created at 2021-03-17 14:45:55

Set assignee to @DavidAyotte.


---

Comment by mkoeppe created at 2021-05-10 17:42:09

Moving to 9.4, as 9.3 has been released.
