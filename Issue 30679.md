# Issue 30679: genus() returns negative vaue.

archive/issues_030679.json:
```json
{
    "body": "Keywords: genus, function field\n\ngenus() for an algebraic function field returns negative value.\nThis is because a defining polynomial is not irreducible over a base field, the extension() method should raise an error.\nExample:\n\n```\nIn [1]: k=FunctionField(FiniteField(5), \"T\");  k\nRational function field in T over Finite Field of size 5\nIn [2]: T=k.gen(); T\nT\nIn [3]: u=polygen(k, \"u\"); u\nu\nIn [4]: M.<u>=k.extension(4*u^4 + T^4); M\nFunction field in u defined by 4*u^4 + T^4\nIn [5]: M.genus()\n-3\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30916\n\n",
    "created_at": "2020-11-15T02:12:10Z",
    "labels": [
        "number theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "genus() returns negative vaue.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30679",
    "user": "@iwaokimura"
}
```
Keywords: genus, function field

genus() for an algebraic function field returns negative value.
This is because a defining polynomial is not irreducible over a base field, the extension() method should raise an error.
Example:

```
In [1]: k=FunctionField(FiniteField(5), "T");  k
Rational function field in T over Finite Field of size 5
In [2]: T=k.gen(); T
T
In [3]: u=polygen(k, "u"); u
u
In [4]: M.<u>=k.extension(4*u^4 + T^4); M
Function field in u defined by 4*u^4 + T^4
In [5]: M.genus()
-3
```


Issue created by migration from https://trac.sagemath.org/ticket/30916





---

archive/issue_comments_438685.json:
```json
{
    "body": "Hello! I've looked at the source code and it is indeed possible to create a \"Function field extension\" using an reducible polynomial. In fact, the class \"FunctionField_polymod\" state this warning:\n\n\n\n```\n.. WARNING::\n\n        It is not checked if the polynomial used to define the function field is irreducible\n        Hence it is not guaranteed that this object really is a field!\n        This is illustrated below.\n\n    ::\n\n        sage: K.<x> = FunctionField(QQ)\n        sage: R.<y> = K[]\n        sage: L.<y> = K.extension(x^2 - y^2)\n        sage: (y - x)*(y + x)\n        0\n        sage: 1/(y - x)\n        1\n        sage: y - x == 0; y + x == 0\n        False\n        False\n```\n\n\nI believe that one workaround to this could be to add a keyword \"check=False\" that would verify if the defining polynomial is irreducible. The default value would be \"False\" since a lot a code seems to depend of the fact that we can create an extension which is not a field (i.e. a ring extension). But maybe there is a better way to do this.",
    "created_at": "2021-03-16T18:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30679#issuecomment-438685",
    "user": "@DavidAyotte"
}
```

Hello! I've looked at the source code and it is indeed possible to create a "Function field extension" using an reducible polynomial. In fact, the class "FunctionField_polymod" state this warning:



```
.. WARNING::

        It is not checked if the polynomial used to define the function field is irreducible
        Hence it is not guaranteed that this object really is a field!
        This is illustrated below.

    ::

        sage: K.<x> = FunctionField(QQ)
        sage: R.<y> = K[]
        sage: L.<y> = K.extension(x^2 - y^2)
        sage: (y - x)*(y + x)
        0
        sage: 1/(y - x)
        1
        sage: y - x == 0; y + x == 0
        False
        False
```


I believe that one workaround to this could be to add a keyword "check=False" that would verify if the defining polynomial is irreducible. The default value would be "False" since a lot a code seems to depend of the fact that we can create an extension which is not a field (i.e. a ring extension). But maybe there is a better way to do this.



---

archive/issue_comments_438686.json:
```json
{
    "body": "I have added a keyword \"check\" to the method \"extension\". If anybody has a better way to do this feel free to change it. \n----\nNew commits:",
    "created_at": "2021-03-17T14:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30679#issuecomment-438686",
    "user": "@DavidAyotte"
}
```

I have added a keyword "check" to the method "extension". If anybody has a better way to do this feel free to change it. 
----
New commits:



---

archive/issue_comments_438687.json:
```json
{
    "body": "Set assignee to @DavidAyotte.",
    "created_at": "2021-03-17T14:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30679#issuecomment-438687",
    "user": "@DavidAyotte"
}
```

Set assignee to @DavidAyotte.



---

archive/issue_comments_438688.json:
```json
{
    "body": "Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30679#issuecomment-438688",
    "user": "mkoeppe"
}
```

Moving to 9.4, as 9.3 has been released.
