# Issue 19793: Change SAGE_DOC environment variables

Issue created by migration from https://trac.sagemath.org/ticket/20030

Original creator: jdemeyer

Original creation time: 2016-02-10 10:58:33

CC:  fbissey

Replace
`SAGE_DOC` -> `SAGE_DOC_SRC`
`SAGE_DOC_OUTPUT` -> `SAGE_DOC`


---

Comment by jdemeyer created at 2016-02-10 11:01:48

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2016-02-10 11:01:48

New commits:


---

Comment by git created at 2016-02-10 11:13:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2016-02-10 21:15:02

Looks good to me.


---

Comment by fbissey created at 2016-02-10 21:15:02

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-10 23:47:51

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-02-10 23:47:51

Breaks incremental updates

```
File "src/sage/misc/sageinspect.py", line 25, in sage.misc.sageinspect
Failed example:
    sage_getdoc(sage.rings.rational).lstrip()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.sageinspect[2]>", line 1, in <module>
        sage_getdoc(sage.rings.rational).lstrip()
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sageinspect.py", line 1829, in sage_getdoc
        s = sage.misc.sagedoc.format(r, embedded=(embedded_override or EMBEDDED_MODE))
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py", line 664, in format
        s = detex(s, embedded=embedded)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py", line 219, in detex
        s = sphinxify(s, format='text')
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sagenb-0.11.6.1-py2.7.egg/sagenb/misc/sphinxify.py", line 121, in sphinxify
        confoverrides, None, None, True)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/application.py", line 107, in __init__
        confoverrides or {}, self.tags)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/config.py", line 227, in __init__
        os.chdir(dirname)
    OSError: [Errno 2] No such file or directory: '/home/buildslave-sage/slave/sage_git/build/local/share/doc/sage/en/introspect'
```



---

Comment by fbissey created at 2016-02-11 00:17:01

Yes I have now noticed in the last hour that this change would require to have at least `en/introspect/conf.py` and `common/conf.py` in the doc folder, shipped under the new `SAGE_DOC`. Alternatively the function `generate_configuration` in the sage notebook at `sagenb/misc/sphinxify.py` needs to be fixed. I would be quite eager for it to be.

However including https://github.com/sagemath/sagenb/pull/363 in `sagenb` would be sufficient to fix the problem.


---

Comment by fbissey created at 2016-02-11 09:25:12

Why is `sphinxify.py` part of `sagenb` rather than `sage`? I think the functionality should be moved in the future, especially if we want to deprecate `sagenb`.


---

Comment by jdemeyer created at 2016-02-11 09:29:33

Yes, I was also very surprised to see that.


---

Comment by jdemeyer created at 2016-02-11 13:48:51

Changing status from needs_work to positive_review.


---

Comment by fbissey created at 2016-02-13 04:02:59

Changing status from positive_review to needs_work.


---

Comment by fbissey created at 2016-02-13 04:02:59

Found one error, line 804 of `sagedoc.py` needs to be changed from `SAGE_DOC` to `SAGE_DOC_SRC`.


---

Comment by fbissey created at 2016-02-14 08:48:50

Corrected missing `SAGE_DOC_SRC`.
----
New commits:


---

Comment by fbissey created at 2016-02-14 08:49:18

Changing status from needs_work to positive_review.


---

Comment by fbissey created at 2016-02-14 09:07:25

#20047 is for the matching change in `sagenb`.


---

Comment by vbraun created at 2016-02-23 22:56:06

still pending?


---

Comment by fbissey created at 2016-02-23 22:58:07

Replying to [comment:16 vbraun]:
> still pending?
Slight problems in #20047, the new `sagenb` tarball is not ready, it should have included a new dependency (or sticked to the old ones).


---

Comment by jdemeyer created at 2016-02-24 09:21:20

This should be merged through #20047, which contains the branch here. Not sure which milestone I should set then.


---

Comment by vbraun created at 2016-02-25 09:26:27

If this ticket can't be merged alone and can't depend on #20047 (because it is contained there) then it should be closed. Alternatively make this ticket depend on #20047 which will result in an trivial merge commit (adding no new code).


---

Comment by jdemeyer created at 2016-02-25 09:37:33

OK, then you can just close this ticket when you merge #20047.


---

Comment by vbraun created at 2016-02-25 09:58:08

Resolution: duplicate
