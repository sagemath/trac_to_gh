# Issue 19793: Change SAGE_DOC environment variables

archive/issues_019793.json:
```json
{
    "body": "CC:  @kiwifb\n\nReplace\n`SAGE_DOC` -> `SAGE_DOC_SRC`\n`SAGE_DOC_OUTPUT` -> `SAGE_DOC`\n\nIssue created by migration from https://trac.sagemath.org/ticket/20030\n\n",
    "created_at": "2016-02-10T10:58:33Z",
    "labels": [
        "misc",
        "blocker",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Change SAGE_DOC environment variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19793",
    "user": "@jdemeyer"
}
```
CC:  @kiwifb

Replace
`SAGE_DOC` -> `SAGE_DOC_SRC`
`SAGE_DOC_OUTPUT` -> `SAGE_DOC`

Issue created by migration from https://trac.sagemath.org/ticket/20030





---

archive/issue_comments_272086.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-10T11:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272086",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_272087.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-02-10T11:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272087",
    "user": "@jdemeyer"
}
```

New commits:



---

archive/issue_comments_272088.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-10T11:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272088",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272089.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2016-02-10T21:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272089",
    "user": "@kiwifb"
}
```

Looks good to me.



---

archive/issue_comments_272090.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-10T21:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272090",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272091.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-10T23:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272091",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_272092.json:
```json
{
    "body": "Breaks incremental updates\n\n```\nFile \"src/sage/misc/sageinspect.py\", line 25, in sage.misc.sageinspect\nFailed example:\n    sage_getdoc(sage.rings.rational).lstrip()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.sageinspect[2]>\", line 1, in <module>\n        sage_getdoc(sage.rings.rational).lstrip()\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sageinspect.py\", line 1829, in sage_getdoc\n        s = sage.misc.sagedoc.format(r, embedded=(embedded_override or EMBEDDED_MODE))\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py\", line 664, in format\n        s = detex(s, embedded=embedded)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py\", line 219, in detex\n        s = sphinxify(s, format='text')\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sagenb-0.11.6.1-py2.7.egg/sagenb/misc/sphinxify.py\", line 121, in sphinxify\n        confoverrides, None, None, True)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/application.py\", line 107, in __init__\n        confoverrides or {}, self.tags)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/config.py\", line 227, in __init__\n        os.chdir(dirname)\n    OSError: [Errno 2] No such file or directory: '/home/buildslave-sage/slave/sage_git/build/local/share/doc/sage/en/introspect'\n```\n",
    "created_at": "2016-02-10T23:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272092",
    "user": "@vbraun"
}
```

Breaks incremental updates

```
File "src/sage/misc/sageinspect.py", line 25, in sage.misc.sageinspect
Failed example:
    sage_getdoc(sage.rings.rational).lstrip()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.sageinspect[2]>", line 1, in <module>
        sage_getdoc(sage.rings.rational).lstrip()
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sageinspect.py", line 1829, in sage_getdoc
        s = sage.misc.sagedoc.format(r, embedded=(embedded_override or EMBEDDED_MODE))
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py", line 664, in format
        s = detex(s, embedded=embedded)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sagedoc.py", line 219, in detex
        s = sphinxify(s, format='text')
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sagenb-0.11.6.1-py2.7.egg/sagenb/misc/sphinxify.py", line 121, in sphinxify
        confoverrides, None, None, True)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/application.py", line 107, in __init__
        confoverrides or {}, self.tags)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx/config.py", line 227, in __init__
        os.chdir(dirname)
    OSError: [Errno 2] No such file or directory: '/home/buildslave-sage/slave/sage_git/build/local/share/doc/sage/en/introspect'
```




---

archive/issue_comments_272093.json:
```json
{
    "body": "Yes I have now noticed in the last hour that this change would require to have at least `en/introspect/conf.py` and `common/conf.py` in the doc folder, shipped under the new `SAGE_DOC`. Alternatively the function `generate_configuration` in the sage notebook at `sagenb/misc/sphinxify.py` needs to be fixed. I would be quite eager for it to be.\n\nHowever including https://github.com/sagemath/sagenb/pull/363 in `sagenb` would be sufficient to fix the problem.",
    "created_at": "2016-02-11T00:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272093",
    "user": "@kiwifb"
}
```

Yes I have now noticed in the last hour that this change would require to have at least `en/introspect/conf.py` and `common/conf.py` in the doc folder, shipped under the new `SAGE_DOC`. Alternatively the function `generate_configuration` in the sage notebook at `sagenb/misc/sphinxify.py` needs to be fixed. I would be quite eager for it to be.

However including https://github.com/sagemath/sagenb/pull/363 in `sagenb` would be sufficient to fix the problem.



---

archive/issue_comments_272094.json:
```json
{
    "body": "Why is `sphinxify.py` part of `sagenb` rather than `sage`? I think the functionality should be moved in the future, especially if we want to deprecate `sagenb`.",
    "created_at": "2016-02-11T09:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272094",
    "user": "@kiwifb"
}
```

Why is `sphinxify.py` part of `sagenb` rather than `sage`? I think the functionality should be moved in the future, especially if we want to deprecate `sagenb`.



---

archive/issue_comments_272095.json:
```json
{
    "body": "Yes, I was also very surprised to see that.",
    "created_at": "2016-02-11T09:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272095",
    "user": "@jdemeyer"
}
```

Yes, I was also very surprised to see that.



---

archive/issue_comments_272096.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-02-11T13:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272096",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_272097.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-13T04:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272097",
    "user": "@kiwifb"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_272098.json:
```json
{
    "body": "Found one error, line 804 of `sagedoc.py` needs to be changed from `SAGE_DOC` to `SAGE_DOC_SRC`.",
    "created_at": "2016-02-13T04:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272098",
    "user": "@kiwifb"
}
```

Found one error, line 804 of `sagedoc.py` needs to be changed from `SAGE_DOC` to `SAGE_DOC_SRC`.



---

archive/issue_comments_272099.json:
```json
{
    "body": "Corrected missing `SAGE_DOC_SRC`.\n----\nNew commits:",
    "created_at": "2016-02-14T08:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272099",
    "user": "@kiwifb"
}
```

Corrected missing `SAGE_DOC_SRC`.
----
New commits:



---

archive/issue_comments_272100.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-02-14T08:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272100",
    "user": "@kiwifb"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_272101.json:
```json
{
    "body": "#20047 is for the matching change in `sagenb`.",
    "created_at": "2016-02-14T09:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272101",
    "user": "@kiwifb"
}
```

#20047 is for the matching change in `sagenb`.



---

archive/issue_comments_272102.json:
```json
{
    "body": "still pending?",
    "created_at": "2016-02-23T22:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272102",
    "user": "@vbraun"
}
```

still pending?



---

archive/issue_comments_272103.json:
```json
{
    "body": "Replying to [comment:16 vbraun]:\n> still pending?\nSlight problems in #20047, the new `sagenb` tarball is not ready, it should have included a new dependency (or sticked to the old ones).",
    "created_at": "2016-02-23T22:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272103",
    "user": "@kiwifb"
}
```

Replying to [comment:16 vbraun]:
> still pending?
Slight problems in #20047, the new `sagenb` tarball is not ready, it should have included a new dependency (or sticked to the old ones).



---

archive/issue_comments_272104.json:
```json
{
    "body": "This should be merged through #20047, which contains the branch here. Not sure which milestone I should set then.",
    "created_at": "2016-02-24T09:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272104",
    "user": "@jdemeyer"
}
```

This should be merged through #20047, which contains the branch here. Not sure which milestone I should set then.



---

archive/issue_comments_272105.json:
```json
{
    "body": "If this ticket can't be merged alone and can't depend on #20047 (because it is contained there) then it should be closed. Alternatively make this ticket depend on #20047 which will result in an trivial merge commit (adding no new code).",
    "created_at": "2016-02-25T09:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272105",
    "user": "@vbraun"
}
```

If this ticket can't be merged alone and can't depend on #20047 (because it is contained there) then it should be closed. Alternatively make this ticket depend on #20047 which will result in an trivial merge commit (adding no new code).



---

archive/issue_comments_272106.json:
```json
{
    "body": "OK, then you can just close this ticket when you merge #20047.",
    "created_at": "2016-02-25T09:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272106",
    "user": "@jdemeyer"
}
```

OK, then you can just close this ticket when you merge #20047.



---

archive/issue_comments_272107.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2016-02-25T09:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19793#issuecomment-272107",
    "user": "@vbraun"
}
```

Resolution: duplicate
