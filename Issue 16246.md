# Issue 16246: New Build/Packaging System

archive/issues_016246.json:
```json
{
    "body": "Our current build/packaging system is at the limits of what one can do just with a Makefile and shell scripts. This ticket aims to implement a new system\n* Git-aware: use SHA1 hashes instead of timestamps for dependency calculations\n* Unified machine-readable package configuration using YAML\n* Dependency handling also for optional packages\n* Distinction between different types of dependencies: build time, runtime hard/soft, testing.\n* Modular, allowing for easy experimentation with per-package backends\n* written in pure Python without any dependencies\n* doctested for Python 2.6, 2.7, 3.3, and 3.4.\n\nThe entire package configuration will be in a file `SAGE_ROOT/build/pkgs/<name>/package.yaml`, for example\n\n```\nname:\n    matplotlib\n\ncategory:\n    standard\n\nsource:\n    version:  \n        1.3.1\n    tarball:\n        name:     matplotlib-{source.version}.tar.gz\n        sha1:     f340378c43c4c3f6219ef9fd84af4ebbe18f8feb\n\nbuilder:\n    type:            SpkgInstallScript\n    install_script:  spkg-install\n\ndepends:\n    build:\n        - pkgconf\n        - setuptools\n    hard:\n        - python\n        - numpy\n        - freetype\n        - libpng\n        - gdmodule\n        - dateutil\n        - pyparsing\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16483\n\n",
    "created_at": "2014-06-15T20:37:45Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "New Build/Packaging System",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16246",
    "user": "vbraun"
}
```
Our current build/packaging system is at the limits of what one can do just with a Makefile and shell scripts. This ticket aims to implement a new system
* Git-aware: use SHA1 hashes instead of timestamps for dependency calculations
* Unified machine-readable package configuration using YAML
* Dependency handling also for optional packages
* Distinction between different types of dependencies: build time, runtime hard/soft, testing.
* Modular, allowing for easy experimentation with per-package backends
* written in pure Python without any dependencies
* doctested for Python 2.6, 2.7, 3.3, and 3.4.

The entire package configuration will be in a file `SAGE_ROOT/build/pkgs/<name>/package.yaml`, for example

```
name:
    matplotlib

category:
    standard

source:
    version:  
        1.3.1
    tarball:
        name:     matplotlib-{source.version}.tar.gz
        sha1:     f340378c43c4c3f6219ef9fd84af4ebbe18f8feb

builder:
    type:            SpkgInstallScript
    install_script:  spkg-install

depends:
    build:
        - pkgconf
        - setuptools
    hard:
        - python
        - numpy
        - freetype
        - libpng
        - gdmodule
        - dateutil
        - pyparsing
```



Issue created by migration from https://trac.sagemath.org/ticket/16483





---

archive/issue_comments_212495.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-16T00:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212495",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212496.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-16T14:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212496",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212497.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-16T15:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212497",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212498.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-16T22:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212498",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212499.json:
```json
{
    "body": "outdated, should close",
    "created_at": "2021-09-07T08:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212499",
    "user": "mkoeppe"
}
```

outdated, should close



---

archive/issue_comments_212500.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-07T08:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212500",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_212501.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-18T11:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212501",
    "user": "mjo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_212502.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-09-18T17:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-212502",
    "user": "mkoeppe"
}
```

Resolution: invalid
