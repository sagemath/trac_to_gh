# Issue 21759: Factorization in iterated extensions of finite fields

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2016-11-30 04:23:49

CC:  jpflori

Keywords: factorization, finite field

At the moment there is no factorization implemented in iterated extensions of finite fields:

```
sage: K = GF(2)
sage: R.<x> = K[]
sage: L.<x> = K.extension(x^2 + x + 1)
sage: R.<y> = L[]
sage: M.<y> = L.extension(y^2 + y + x)
sage: R.<T> = M[]
sage: (T^2 + T + x).factor()
```

The reason is that `M` in the above example is just a quotient of a polynomial ring over `L`.
Here, we implement isomorphisms (for this special case) to a simple extensions of a prime field over which factorization is implemented. We also implement univariate factorization for polynomial quotient rings if an isomorphism to a field which supports such factorization is known.


---

Comment by git created at 2016-11-30 07:37:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2016-11-30 07:45:41

Changing status from new to needs_review.


---

Comment by git created at 2016-11-30 18:34:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2016-11-30 18:41:55

I added some `__make_element_class__` around the `SetMorphism`. They make no difference because `SetMorphism` is an extension type, but morally they should be there (if it were not an extension type) so that the result inherits the right methods from the category.


---

Comment by git created at 2016-11-30 18:54:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-01-24 20:59:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2017-01-31 10:45:23

I'll have a closer look soon but right now this looks like a good addition.
The only thing that I find disturbing is the method name `_isomorphic_ring`.
Maybe it's not descriptive enough?


---

Comment by jpflori created at 2017-01-31 10:49:05

You've got this simple model stuff for function fields.


---

Comment by git created at 2017-04-18 09:31:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-05-27 05:30:46

Jens Bauch reported that the factorization does not work here:

```
K = GF(3)
R.<x> = K[]
L.<x> = K.extension(x^2 + x + 1)
R.<y> = L[]
M.<y> = L.extension(y^2 + y + x)
R.<T> = M[]
(T^2 + T + x).factor()
```



---

Comment by saraedum created at 2017-05-27 05:30:46

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2017-06-06 03:33:31

Changing keywords from "factorization, finite field" to "factorization, finite field, sd86.5".


---

Comment by git created at 2017-06-06 03:41:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-06-06 03:42:15

New commits:
----
New commits:


---

Comment by erousseau created at 2017-06-09 00:12:05

If the fix is OK, then I think it is ready for positive review.

Edouard
----
New commits:


---

Comment by erousseau created at 2017-06-09 00:12:05

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-06-09 07:24:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-09 22:15:01


```
$ sage -t --long --warn-long 68.9 src/sage/rings/polynomial/polynomial_quotient_ring.py  # 4 doctests failed
Running doctests with ID 2017-06-10-00-08-57-0afdacb4.
Git branch: develop
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --long --warn-long 68.9 src/sage/rings/polynomial/polynomial_quotient_ring.py
**********************************************************************
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 267, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic
Failed example:
    isinstance(Q.an_element(),Q.element_class)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 269, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic
Failed example:
    [s for s in dir(Q.category().element_class) if not s.startswith('_')]
Expected:
    ['cartesian_product', 'is_idempotent', 'is_one', 'is_unit', 'lift', 'powers']
Got:
    ['cartesian_product',
     'euclidean_degree',
     'factor',
     'gcd',
     'is_idempotent',
     'is_one',
     'is_unit',
     'lcm',
     'lift',
     'powers',
     'quo_rem',
     'xgcd']
**********************************************************************
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 281, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic
Failed example:
    first_class == Q.__class__
Expected:
    False
Got:
    True
**********************************************************************
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 834, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic.is_field
Failed example:
    F2.is_field()
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError
Got:
    False
**********************************************************************
2 items had failures:
   3 of  29 in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic
   1 of  13 in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_generic.is_field
    [410 tests, 4 failures, 2.37 s]
----------------------------------------------------------------------
sage -t --long --warn-long 68.9 src/sage/rings/polynomial/polynomial_quotient_ring.py  # 4 doctests failed
----------------------------------------------------------------------
Total time for all tests: 2.5 seconds
    cpu time: 2.2 seconds
    cumulative wall time: 2.4 seconds
```



---

Comment by vbraun created at 2017-06-09 22:15:01

Changing status from positive_review to needs_work.


---

Comment by saraedum created at 2017-06-12 01:20:22

Changing status from needs_work to needs_review.


---

Comment by jpflori created at 2017-06-22 09:53:16

New commits:


---

Comment by roed created at 2017-07-17 17:45:39

Changing keywords from "factorization, finite field, sd86.5" to "factorization, finite field, sd86.5, sd87".


---

Comment by aly.deines created at 2017-07-18 20:41:34

Should the following example work with this branch?  It does not for me.  I get a not implemented error.

All examples in ticket have fields with cardinality a power of 2.

Replying to [comment:14 saraedum]:
> Jens Bauch reported that the factorization does not work here:
> {{{
> K = GF(3)
> R.<x> = K[]
> L.<x> = K.extension(x^2 + x + 1)
> R.<y> = L[]
> M.<y> = L.extension(y^2 + y + x)
> R.<T> = M[]
> (T^2 + T + x).factor()
> }}}


---

Comment by saraedum created at 2017-07-19 01:20:40

Replying to [comment:28 aly.deines]:
> Should the following example work with this branch?  It does not for me.  I get a not implemented error.
> 
> All examples in ticket have fields with cardinality a power of 2.
> 
> Replying to [comment:14 saraedum]:
> > Jens Bauch reported that the factorization does not work here:
> > {{{
> > K = GF(3)
> > R.<x> = K[]
> > L.<x> = K.extension(x^2 + x + 1)
> > R.<y> = L[]
> > M.<y> = L.extension(y^2 + y + x)
> > R.<T> = M[]
> > (T^2 + T + x).factor()
> > }}}
That's expected. L is not a field in this example.


---

Comment by git created at 2017-07-20 18:13:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aly.deines created at 2017-07-21 16:05:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-07-26 22:13:34

Resolution: fixed
