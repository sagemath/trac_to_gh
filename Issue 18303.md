# Issue 18303: Make DirichletGroup a new-style parent

Issue created by migration from https://trac.sagemath.org/ticket/18540

Original creator: pbruin

Original creation time: 2015-05-28 21:57:08

Keywords: Dirichlet group

The purpose of this ticket is to upgrade `DirichletGroup` from an old-style `ParentWithMultiplicativeAbelianGens` to a proper `Parent`.

At the same time, we place `DirichletGroup` in the category of Abelian groups.


---

Comment by pbruin created at 2015-05-28 22:09:47

Changing status from new to needs_review.


---

Comment by pbruin created at 2015-05-29 05:42:19

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-05-29 12:38:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-05-29 12:39:02

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-05-30 22:04:26

A couple of comments:

- Is `Groups().Commutative()` the best category? The `list` function seems like they should be in finite groups and that they are is finitely generated. I would say the category should be `Groups().Commutative().Finite().FinitelyGenerated()` (or at least a join with `EnumeratedSets`).

- While I doubt it was used, the `__cmp__` did put a total ordering on the parents which I think we should keep by implementing a `__lt__` (and using ``@`total_ordering`).

Looks good otherwise.


---

Comment by git created at 2015-06-01 12:35:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-06-01 12:40:05

Replying to [comment:5 tscrim]:
> A couple of comments:
> 
> - Is `Groups().Commutative()` the best category? The `list` function seems like they should be in finite groups and that they are is finitely generated. I would say the category should be `Groups().Commutative().Finite().FinitelyGenerated()` (or at least a join with `EnumeratedSets`).
Done, but only if we know that the group of _n_-th roots of unity in the base ring is finite.  This is currently still the case for all Dirichlet groups that we can construct, but in the future we may admit base rings where this is not the case (the profinite completion of *Z*, for example).
> - While I doubt it was used, the `__cmp__` did put a total ordering on the parents which I think we should keep by implementing a `__lt__` (and using ``@`total_ordering`).
I don't like this very much.  First, the previous implementation actually does not make sense since it depends on a total ordering of all rings.  Second, I cannot imagine why one would like to totally order all Dirichlet groups over all rings.


---

Comment by jdemeyer created at 2015-06-22 09:42:42

Changing type from task to enhancement.


---

Comment by jdemeyer created at 2015-06-22 09:42:42

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-06-22 09:42:42

Changing component from modular forms to number theory.


---

Comment by jdemeyer created at 2015-06-22 09:42:42

1. In the docstring of `DirichletGroup_class`, could you replace

```
Group of Dirichlet characters modulo `N` over a ring `R`.
```

by

```
Group of Dirichlet characters modulo `N` with values in a ring `R`.
```

(or something similar)

2. In the check

```
if isinstance(x, (int, rings.Integer)) and x == 1:
```

I think it is better to remove `isinstance(x, (int, rings.Integer))` and allow any kind of `1` (but then you will probably need to add a `try`/`except` in case that `x == 1` fails).


---

Comment by jdemeyer created at 2015-06-22 09:56:31

I have no further comments. If you make the above changes and doctests still pass, you can set this to positive_review.


---

Comment by jdemeyer created at 2015-06-22 12:01:38

Additional remark: it would be good to fix these `pyflakes` warnings:

```
$ pyflakes src/sage/modular/dirichlet.py
src/sage/modular/dirichlet.py:550: 'latex' imported but unused
src/sage/modular/dirichlet.py:800: local variable 'R' is assigned to but never used
src/sage/modular/dirichlet.py:1691: local variable 'R' is assigned to but never used
src/sage/modular/dirichlet.py:2312: local variable 'n' is assigned to but never used
src/sage/modular/dirichlet.py:2314: local variable 'p' is assigned to but never used
src/sage/modular/dirichlet.py:2376: local variable 'one' is assigned to but never used
src/sage/modular/dirichlet.py:2377: local variable 'zeta' is assigned to but never used
```



---

Comment by git created at 2015-06-22 15:15:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-06-22 15:16:19

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-06-22 22:25:15

Resolution: fixed
