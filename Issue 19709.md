# Issue 19709: Asymptotic Ring: cannot construct 2^n when coefficient ring is SR

Issue created by migration from https://trac.sagemath.org/ticket/19946

Original creator: cheuberg

Original creation time: 2016-01-23 05:18:04

CC:  dkrenn behackl

The following is unexpected:

```
sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
sage: 2^n
Traceback (most recent call last):
...
ArithmeticError: Cannot construct 2^n in Growth Group QQ^n * n^QQ
> *previous* TypeError: unsupported operand parent(s) for '*':
'Growth Group QQ^n * n^QQ' and 'Growth Group SR^n'
```

The only work-around I found until now is

```
sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
2^n
```



---

Comment by dkrenn created at 2016-01-25 18:53:06

Replying to [ticket:19946 cheuberg]:
> The only work-around I found until now is
> {{{
> sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
> 2^n
> }}}

The workaround

```
sage: n.rpow(2)
2^n
```

works. However, for some reason (I still have to track this down) the parent changes to

```
sage: n.rpow(1/2).parent()
Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```



---

Comment by dkrenn created at 2016-01-26 07:53:24

Changing status from new to needs_review.


---

Comment by dkrenn created at 2016-01-26 07:53:24

I've fixed the original problem. However, there is the following:

```
            sage: T = TermMonoid('exact', GrowthGroup('QQ^n * n^QQ'), SR)
            sage: n = T('n')
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        Above, we get ``QQ^n * n^SR`` since
        ::

            sage: (n^SR(1)).parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        and that is because of

            sage: (QQ(2)^SR(1)).parent(), (QQ(1)*SR(1)).parent()
            (Rational Field, Symbolic Ring)
```

For me this is fine; although it is not nice. What do you think?
----
New commits:


---

Comment by cheuberg created at 2016-01-26 15:48:07

Reviewed your changes, main bug is fixed; two reviewer commits added; but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.
----
New commits:


---

Comment by dkrenn created at 2016-01-26 16:30:01

Replying to [comment:6 cheuberg]:
> two reviewer commits added;

Cross-reviewed.

> but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion.

Rewritten.

> But that would be another ticket.

Ok.

I've merged #19961 and made a link from there to this new explaination.

----
New commits:


---

Comment by dkrenn created at 2016-01-26 16:38:33

Replying to [comment:6 cheuberg]:
> For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.

Follow-up is #19965.


---

Comment by cheuberg created at 2016-01-26 16:59:34

Changing status from needs_review to positive_review.


---

Comment by cheuberg created at 2016-01-26 16:59:34

LGTM, thank you.


---

Comment by cheuberg created at 2016-01-26 17:01:11

had forgotten to push the fix for one typo.
----
New commits:


---

Comment by vbraun created at 2016-01-28 20:09:07

Resolution: fixed


---

Comment by jdemeyer created at 2018-01-08 10:03:53

This ticket has added a few doctests of the form

```
            sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```

With #19945, the last result will change to

```
            Asymptotic Ring <SR^n * n^SR> over Symbolic Ring
```

I think that this change makes sense, since a coercion of `QQ` and `SR` should end up in `SR`. If you object, please comment at #19945.
