# Issue 14360: BinaryTree().graph() falsely claims that the graph has 0 vertices

archive/issues_014360.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  chapoton sage-combinat vivianepons hivert\n\nKeywords: binary tree, tree\n\nThis also breaks the show() function of this trivial binary tree.\n\nPatch coming in a couple minutes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14564\n\n",
    "created_at": "2013-05-11T02:19:31Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "BinaryTree().graph() falsely claims that the graph has 0 vertices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14360",
    "user": "darij"
}
```
Assignee: tbd

CC:  chapoton sage-combinat vivianepons hivert

Keywords: binary tree, tree

This also breaks the show() function of this trivial binary tree.

Patch coming in a couple minutes.

Issue created by migration from https://trac.sagemath.org/ticket/14564





---

archive/issue_comments_181355.json:
```json
{
    "body": "Attachment [trac_14564-trivial-binary-tree.patch](tarball://root/attachments/some-uuid/ticket14564/trac_14564-trivial-binary-tree.patch) by darij created at 2013-05-11 02:22:57\n\nFixes graph() function. This automatically fixes show(). I have not checked all the other functions, though...",
    "created_at": "2013-05-11T02:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181355",
    "user": "darij"
}
```

Attachment [trac_14564-trivial-binary-tree.patch](tarball://root/attachments/some-uuid/ticket14564/trac_14564-trivial-binary-tree.patch) by darij created at 2013-05-11 02:22:57

Fixes graph() function. This automatically fixes show(). I have not checked all the other functions, though...



---

archive/issue_comments_181356.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2013-05-11T02:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181356",
    "user": "darij"
}
```

Changing priority from major to minor.



---

archive/issue_comments_181357.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2013-05-11T02:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181357",
    "user": "darij"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_181358.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-05-11T02:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181358",
    "user": "darij"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_181359.json:
```json
{
    "body": "Hellooooooooooooo !\n\nYou change the associated graph of an empty binary tree to a non-empty graph, but what about these things ?\n\n\n```\nsage: t1 = BinaryTree()\nsage: t1\n.\nsage: t1.graph().vertices()\n[0]\nsage: list(t1)\n[]\nsage: list(t1.paths())\n[]\nsage: t1.depth()\n0\n```\n\n\nNathann",
    "created_at": "2013-05-13T12:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181359",
    "user": "ncohen"
}
```

Hellooooooooooooo !

You change the associated graph of an empty binary tree to a non-empty graph, but what about these things ?


```
sage: t1 = BinaryTree()
sage: t1
.
sage: t1.graph().vertices()
[0]
sage: list(t1)
[]
sage: list(t1.paths())
[]
sage: t1.depth()
0
```


Nathann



---

archive/issue_comments_181360.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-05-13T12:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181360",
    "user": "ncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_181361.json:
```json
{
    "body": "Hi Nathannnnnn! Thanks for looking in the file. ``list``, ``graph().vertices()`` and ``depth()`` seem to be correct (``list`` is not supposed to be the list of all vertices, as far as I understand), or am I missing something? I don't really like the ``paths()`` answer (isn't there a 0-length path from the root to itself?), but that answer appears precisely that way in the docstring:\n\n\n```\n      sage: list(BinaryTree().paths())\n      []\n```\n\n\nso I suspect the authors (whom I'm adding to cc now) must have had something in mind.",
    "created_at": "2013-05-14T00:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181361",
    "user": "darij"
}
```

Hi Nathannnnnn! Thanks for looking in the file. ``list``, ``graph().vertices()`` and ``depth()`` seem to be correct (``list`` is not supposed to be the list of all vertices, as far as I understand), or am I missing something? I don't really like the ``paths()`` answer (isn't there a 0-length path from the root to itself?), but that answer appears precisely that way in the docstring:


```
      sage: list(BinaryTree().paths())
      []
```


so I suspect the authors (whom I'm adding to cc now) must have had something in mind.



---

archive/issue_comments_181362.json:
```json
{
    "body": "Hellooooooooooo !!!\n\n> so I suspect the authors (whom I'm adding to cc now) must have had something in mind.\n\nI do not use these classes, and I do not really understand what they had in mind indeed. But what I believe is that changing the graph function to return a graph one 1 vertex instead of 0 does not match what they had in mind when they wrote it either, so I think that it makes more sense to keep the graph as it was before, and fix the plot problem in a different way.\n\nJust my opinion, of course, and I really do not use those classes. So if you think that it is better to change the output of this graph() function I will let somebody who understands all this better than I do review that patch !\n\nHave fuuuuuuuuuuuuuuuuuuuuuunnn ! \n\nNathann",
    "created_at": "2013-05-14T10:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181362",
    "user": "ncohen"
}
```

Hellooooooooooo !!!

> so I suspect the authors (whom I'm adding to cc now) must have had something in mind.

I do not use these classes, and I do not really understand what they had in mind indeed. But what I believe is that changing the graph function to return a graph one 1 vertex instead of 0 does not match what they had in mind when they wrote it either, so I think that it makes more sense to keep the graph as it was before, and fix the plot problem in a different way.

Just my opinion, of course, and I really do not use those classes. So if you think that it is better to change the output of this graph() function I will let somebody who understands all this better than I do review that patch !

Have fuuuuuuuuuuuuuuuuuuuuuunnn ! 

Nathann



---

archive/issue_comments_181363.json:
```json
{
    "body": "Changing keywords from \"binary tree, tree\" to \"binary trees, trees\".",
    "created_at": "2013-08-27T19:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181363",
    "user": "chapoton"
}
```

Changing keywords from "binary tree, tree" to "binary trees, trees".



---

archive/issue_comments_181364.json:
```json
{
    "body": "I think one could separate two methods:\n\n* one called `graph`, which gives the empty graph for BinaryTree() and satisfy t.graph().num_verts() == len(list(t)) (the vertices have valency at most 2)\n\n* another one called `completed_graph`, which adds the leaves as new vertices, and builds a tree where every vertex has valency either 2 or 0.  Then for BinaryTree(), one would have just one vertex.\n\nTo be done..",
    "created_at": "2013-09-19T16:04:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181364",
    "user": "chapoton"
}
```

I think one could separate two methods:

* one called `graph`, which gives the empty graph for BinaryTree() and satisfy t.graph().num_verts() == len(list(t)) (the vertices have valency at most 2)

* another one called `completed_graph`, which adds the leaves as new vertices, and builds a tree where every vertex has valency either 2 or 0.  Then for BinaryTree(), one would have just one vertex.

To be done..



---

archive/issue_comments_181365.json:
```json
{
    "body": "There is now a similar problem with the new method `to_undirected_graph` (since #14784):\n\n```\nsage: bt=BinaryTree()\nsage: bt.to_undirected_graph()\nGraph on 1 vertex\n```\n\nIt should return the empty graph. The problem come from\n\n```\nsage: bt.as_ordered_tree()\no\n```\n\nwhich should raise an exception.",
    "created_at": "2013-09-20T11:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181365",
    "user": "chapoton"
}
```

There is now a similar problem with the new method `to_undirected_graph` (since #14784):

```
sage: bt=BinaryTree()
sage: bt.to_undirected_graph()
Graph on 1 vertex
```

It should return the empty graph. The problem come from

```
sage: bt.as_ordered_tree()
o
```

which should raise an exception.



---

archive/issue_comments_181366.json:
```json
{
    "body": "Patch functionality moved over to #14498.\n\n`as_ordered_tree` now raises an exception on empty tree.\\\\\n`to_undirected_graph` on empty tree gives the empty graph.\\\\\nInstead of renaming the currently existing `graph` method as `completed_graph`, I added a `reduced_graph` method. (My fix for the `graph` method is also in.) I did not implement anything similar for `to_undirected_graph`, because that was already done (modulo the bug I fixed) using an optional keyword variable.\n\nI did not do anything about `list` and `paths` since these methods seem to be in a different file.\n\nAnyone look at my #14498 patch and tell me if I'm on the right track?",
    "created_at": "2013-10-03T06:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181366",
    "user": "darij"
}
```

Patch functionality moved over to #14498.

`as_ordered_tree` now raises an exception on empty tree.\\
`to_undirected_graph` on empty tree gives the empty graph.\\
Instead of renaming the currently existing `graph` method as `completed_graph`, I added a `reduced_graph` method. (My fix for the `graph` method is also in.) I did not implement anything similar for `to_undirected_graph`, because that was already done (modulo the bug I fixed) using an optional keyword variable.

I did not do anything about `list` and `paths` since these methods seem to be in a different file.

Anyone look at my #14498 patch and tell me if I'm on the right track?



---

archive/issue_comments_181367.json:
```json
{
    "body": "Hello Darij,\n\nyes, what you do seems correct.\n\nInstead of having two methods `graph` and `reduced_graph`, I would rather have a keyword `with_leaves` added to the method `graph`.\n\nI have discussed this matter with Viviane recently, and she had suggestions on how to do that, and even code, but she is probably very busy at the moment.\n\nCheers,\n\nFrederic",
    "created_at": "2013-10-03T18:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181367",
    "user": "chapoton"
}
```

Hello Darij,

yes, what you do seems correct.

Instead of having two methods `graph` and `reduced_graph`, I would rather have a keyword `with_leaves` added to the method `graph`.

I have discussed this matter with Viviane recently, and she had suggestions on how to do that, and even code, but she is probably very busy at the moment.

Cheers,

Frederic



---

archive/issue_comments_181368.json:
```json
{
    "body": "Hi Frederic,\n\nthanks for the comments.\n\nHaving a keyword for `graph` seems more reasonable indeed, but there is a problem with this. If I set the default option to ignore leaves, then it changes the semantics of the method (currently it doesn't ignore leaves). If I set the default option to use leaves, then it is the opposite of the default option in `to_undirected_graph`. So I would be either planting a backwards compatibility landmine or a false analogy landmine. Which is better?\n\nOr, wait. Should I deprecate `graph` and introduce a `to_graph` method instead (for better analogy with `to_undirected_graph`)?\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-10-03T19:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181368",
    "user": "darij"
}
```

Hi Frederic,

thanks for the comments.

Having a keyword for `graph` seems more reasonable indeed, but there is a problem with this. If I set the default option to ignore leaves, then it changes the semantics of the method (currently it doesn't ignore leaves). If I set the default option to use leaves, then it is the opposite of the default option in `to_undirected_graph`. So I would be either planting a backwards compatibility landmine or a false analogy landmine. Which is better?

Or, wait. Should I deprecate `graph` and introduce a `to_graph` method instead (for better analogy with `to_undirected_graph`)?

Best regards,\\
Darij



---

archive/issue_comments_181369.json:
```json
{
    "body": "Hello,\n\nI would vote for keeping the current behaviour as default behaviour. If this is documented, the lack of coherence with another distinct method is not a problem i.m.h.o.\n\nF.",
    "created_at": "2013-10-04T07:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181369",
    "user": "chapoton"
}
```

Hello,

I would vote for keeping the current behaviour as default behaviour. If this is documented, the lack of coherence with another distinct method is not a problem i.m.h.o.

F.



---

archive/issue_comments_181370.json:
```json
{
    "body": "Hi,\n\nI've uploaded an improved version on the #14498 ticket (twice -- sorry for that). If you can greenlight my changes, I'll continue reviewing #14498.\n\nAs far as I understand now, `list` and `paths()` work fine already, so there is nothing to fix about them.\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-10-04T14:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181370",
    "user": "darij"
}
```

Hi,

I've uploaded an improved version on the #14498 ticket (twice -- sorry for that). If you can greenlight my changes, I'll continue reviewing #14498.

As far as I understand now, `list` and `paths()` work fine already, so there is nothing to fix about them.

Best regards,\\
Darij



---

archive/issue_comments_181371.json:
```json
{
    "body": "Yes, looks good, you have my green light.\n\nIn the `is_full` method, I have found that the sentence\n\n```\nA full binary tree is a tree in which every node either has two \nchild nodes or has two child leaves. \n```\n\nis not quite correct. It should say that every node which is not a leaf has two children.",
    "created_at": "2013-10-04T14:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181371",
    "user": "chapoton"
}
```

Yes, looks good, you have my green light.

In the `is_full` method, I have found that the sentence

```
A full binary tree is a tree in which every node either has two 
child nodes or has two child leaves. 
```

is not quite correct. It should say that every node which is not a leaf has two children.



---

archive/issue_comments_181372.json:
```json
{
    "body": "I've been following what seems to be the more common notation in the sourcecode, and understanding \"node\" to mean \"interior node\", i. e., \"non-leaf vertex\". Should I change this or better document this?\n\nAlso, this is not really relevant to #14564, but since we're discussing in this ticket already: The q-hook length formula in #14498 still uses a q from the SymbolicRing. Should I change it to take any arbitrary input as q, defaulting to a polynomial variable over ZZ?",
    "created_at": "2013-10-04T17:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181372",
    "user": "darij"
}
```

I've been following what seems to be the more common notation in the sourcecode, and understanding "node" to mean "interior node", i. e., "non-leaf vertex". Should I change this or better document this?

Also, this is not really relevant to #14564, but since we're discussing in this ticket already: The q-hook length formula in #14498 still uses a q from the SymbolicRing. Should I change it to take any arbitrary input as q, defaulting to a polynomial variable over ZZ?



---

archive/issue_comments_181373.json:
```json
{
    "body": "My comment was just remarking that a node can also have a child node and a child leaf.\n\nYes, please remove any occurence of symbolic ring. I.m.h.o., Symbolic ring is the source of all evil, if I dare say so.",
    "created_at": "2013-10-04T18:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181373",
    "user": "chapoton"
}
```

My comment was just remarking that a node can also have a child node and a child leaf.

Yes, please remove any occurence of symbolic ring. I.m.h.o., Symbolic ring is the source of all evil, if I dare say so.



---

archive/issue_comments_181374.json:
```json
{
    "body": "I completely agree with you on the symbolic ring. But I don't understand the \"every node which is not a leaf has two children\" thing: isn't that true for ANY binary tree in the sense of binary_tree.py? If not, I will have to fix this too:\n\n```\n \t53\t    Binary trees contain nodes and leaves, where each node has two \n \t54\t    children while each leaf has no children. The number of leaves \n \t55\t    always equals the number of nodes plus 1.\n```\n\nEither way, what is a full binary tree then?",
    "created_at": "2013-10-04T21:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181374",
    "user": "darij"
}
```

I completely agree with you on the symbolic ring. But I don't understand the "every node which is not a leaf has two children" thing: isn't that true for ANY binary tree in the sense of binary_tree.py? If not, I will have to fix this too:

```
 	53	    Binary trees contain nodes and leaves, where each node has two 
 	54	    children while each leaf has no children. The number of leaves 
 	55	    always equals the number of nodes plus 1.
```

Either way, what is a full binary tree then?



---

archive/issue_comments_181375.json:
```json
{
    "body": "Ok, I was wrong and you were right, about the definition of `is_full`. It is correct as it is now, no need for a correction.",
    "created_at": "2013-10-14T12:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181375",
    "user": "chapoton"
}
```

Ok, I was wrong and you were right, about the definition of `is_full`. It is correct as it is now, no need for a correction.



---

archive/issue_comments_181376.json:
```json
{
    "body": "Maybe one can close this one as invalid, now that #14498 is closed ?",
    "created_at": "2014-02-12T08:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181376",
    "user": "chapoton"
}
```

Maybe one can close this one as invalid, now that #14498 is closed ?



---

archive/issue_comments_181377.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2014-02-12T12:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181377",
    "user": "darij"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_181378.json:
```json
{
    "body": "I agree.\n\nPlease make this invalid/duplicate.",
    "created_at": "2014-02-12T12:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181378",
    "user": "darij"
}
```

I agree.

Please make this invalid/duplicate.



---

archive/issue_comments_181379.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2014-02-19T18:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14360",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14360#issuecomment-181379",
    "user": "vbraun"
}
```

Resolution: duplicate
