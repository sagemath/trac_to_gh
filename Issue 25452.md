# Issue 25452: Update q_analogs.q_jordan

Issue created by migration from Trac.

Original creator: mathzeta2

Original creation time: 2018-06-28 14:40:08

CC:  â€‹tscrim jdemeyer

Keywords: days94, q-analogs

Small updates to q_jordan:

1. Add default for `q`, like the other `q`-functions.
1. Better handling of parents.
1. Allow the `q=1` case.
1. Better documentation.

On the way, an update for the multinomial function was needed.

For future reference, it might be possible to implement ``q_jordan`` using some closed-form expression, but that is for another ticket.


---

Comment by mathzeta2 created at 2018-06-28 15:02:06

I have not touched the `q_stirling_number2` function added in #25235, even though I used the develop branch.


---

Comment by mathzeta2 created at 2018-06-28 16:04:07

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-06-30 11:50:27

Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.


---

Comment by jdemeyer created at 2018-06-30 11:52:06

Why did you remove `q_stirling_number2`?


---

Comment by jdemeyer created at 2018-06-30 11:52:06

Changing status from needs_review to needs_info.


---

Comment by jdemeyer created at 2018-06-30 11:56:41

Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...


---

Comment by mathzeta2 created at 2018-07-01 22:10:14

Replying to [comment:6 jdemeyer]:
> Allowing general iterables is also dangerous because some Elements are iterable. Imagine for example that we extend this to allowing polynomials...
For `multinomial` I would still like to use at least a list, a tuple, a Partition or a Composition as input. One example is calculating the number of elements of a given cycle type in the symmetric group, and it can come up as any of those objects.

Replying to [comment:5 jdemeyer]:
> Why did you remove `q_stirling_number2`?

We might need a git expert to explain how/why `q_stirling_number2` was removed. What is the best option to add it back without a new commit? I even fix it a bit in #25715.


---

Comment by mathzeta2 created at 2018-07-02 07:43:24

Replying to [comment:4 jdemeyer]:
> Can't we deprecate the list/iterable input? I don't see the point of that, given that you can just do `multinomial(*L)` instead of `multinomial(L)`.

This probably should be done in a new ticket. One point of deprecating the variable amount of arguments version is that it is less consistent with some parts of Sage. For example, Partition and Composition get an iterable, as does Python's builtins such as list, set and tuple.


---

Comment by mathzeta2 created at 2018-07-02 14:35:52

Changing status from needs_info to needs_review.


---

Comment by mathzeta2 created at 2018-07-02 14:35:52

New commits:


---

Comment by tscrim created at 2018-07-05 23:52:18

There is not a point of wrapping `tp` as a `Partition` in the recursion part as the cache converts it over (you should actually do `_Partitions(t)` instead of `Partition(t)` because the former is faster), and then you unwrap it with `list`.

Otherwise LGTM.


---

Comment by mathzeta2 created at 2018-07-06 02:00:25

`_Partitions` is a tiny bit faster indeed. Thanks.

I also thought that the extra call to `Partition` is redundant, but the recursive call to `q_jordan` is to the undecorated function. Maybe a new helper function `_cached_q_jordan` can help?

(A solution for another day is an iterative implementation, as done in `q_subgroups_of_abelian_group`.)


---

Comment by git created at 2018-07-17 15:48:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mathzeta2 created at 2018-07-17 16:06:55

Now things are better, and use `_Partitions`, also for `q_subgroups_of_abelian_group`.

The `cached_function` decorator use the `key` argument only for comparisons in the cache, and that is why I was puzzled when checking for the empty partition, as opposed to a list composed of all zeros. The empty partition have zero length and it is `False` as a boolean:


```sage
sage: Partition([]) == Partition([0]) == Partition([0, 0])
True
```


But this is not true for lists like `[0]`, of course.


---

Comment by mathzeta2 created at 2018-08-03 06:07:05

Replying to [comment:12 tscrim]:
> Otherwise LGTM.

I wanted to set the ticket to positive review myself, but I would appreciate a look at the last commit for a final OK.


---

Comment by tscrim created at 2018-08-03 06:31:05

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-08-03 06:31:05

Sorry, I lost track of this. Your changes are good. Thanks.


---

Comment by vbraun created at 2018-08-05 08:17:59

Resolution: fixed
