# Issue 34570: Add Construction of Hadamard matrices up to order 664

archive/issues_034570.json:
```json
{
    "body": "CC:  @dimpase\n\nWith #34690, all the Hadamard matrices of order <=288 have been added. The next task is to implement matrices of order up to 664 (668 is the first order for which no construction is known). This will require implementing https://core.ac.uk/download/pdf/82189436.pdf, as well as adding some more data for the constructions that are already present.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34807\n\n",
    "created_at": "2022-11-29T09:30:29Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add Construction of Hadamard matrices up to order 664",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34570",
    "user": "@MatteoCati"
}
```
CC:  @dimpase

With #34690, all the Hadamard matrices of order <=288 have been added. The next task is to implement matrices of order up to 664 (668 is the first order for which no construction is known). This will require implementing https://core.ac.uk/download/pdf/82189436.pdf, as well as adding some more data for the constructions that are already present.

Issue created by migration from https://trac.sagemath.org/ticket/34807





---

archive/issue_comments_489013.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489013",
    "user": "@MatteoCati"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_489014.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489014",
    "user": "@MatteoCati"
}
```

Last 10 new commits:



---

archive/issue_comments_489015.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-08T18:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489015",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489016.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-08T19:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489016",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489017.json:
```json
{
    "body": "Wow! That's impressive! Could you say a bit what's in that almost 3000 lines you add here?",
    "created_at": "2022-12-08T22:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489017",
    "user": "@dimpase"
}
```

Wow! That's impressive! Could you say a bit what's in that almost 3000 lines you add here?



---

archive/issue_comments_489018.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-09T09:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489018",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489019.json:
```json
{
    "body": "- I've implemented Spence construction in `hadamard_matrix.py`. This uses the supplementary difference sets created by `supplementary_difference_set` in `difference_faimilies.py`. In the same file, the relative difference sets used by Spence to construct supplementary difference sets are created by the function `relative_difference_set`.\n- In `t_sequences.py`, I've added some new T-sequences. These are constructed from base sequences using the function `T_sequences_construction_from_base_sequences` (this function was already present, but was being used only for the case when p=1). Also, base sequences are constructed from Turyn type sequences using the (new) function `base_sequences_construction` (I've also added the function `is_base_sequences_tuple`, to check that the construction is correct). Turyn type sequences are stored directly in `turyn_type_sequences_smallcases`.\n- Lastly, I've added in `difference_family.py` the function `skew_supplementary_difference_set` which creates skew SDS (as described by  Djokovic in https://ajc.maths.uq.edu.au/pdf/10/ocr-ajc-v10-p259.pdf), which are used by `GS_skew_hadamard_smallcases` in `hadamard_matrix.py` to  create new skew Hadamard matrices.\n\nAlso, note that the older commits (up until bd025a2e87389b9b7f5573049ad62cdd087e2bf0) are coming from ticket #34690.",
    "created_at": "2022-12-09T09:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489019",
    "user": "@MatteoCati"
}
```

- I've implemented Spence construction in `hadamard_matrix.py`. This uses the supplementary difference sets created by `supplementary_difference_set` in `difference_faimilies.py`. In the same file, the relative difference sets used by Spence to construct supplementary difference sets are created by the function `relative_difference_set`.
- In `t_sequences.py`, I've added some new T-sequences. These are constructed from base sequences using the function `T_sequences_construction_from_base_sequences` (this function was already present, but was being used only for the case when p=1). Also, base sequences are constructed from Turyn type sequences using the (new) function `base_sequences_construction` (I've also added the function `is_base_sequences_tuple`, to check that the construction is correct). Turyn type sequences are stored directly in `turyn_type_sequences_smallcases`.
- Lastly, I've added in `difference_family.py` the function `skew_supplementary_difference_set` which creates skew SDS (as described by  Djokovic in https://ajc.maths.uq.edu.au/pdf/10/ocr-ajc-v10-p259.pdf), which are used by `GS_skew_hadamard_smallcases` in `hadamard_matrix.py` to  create new skew Hadamard matrices.

Also, note that the older commits (up until bd025a2e87389b9b7f5573049ad62cdd087e2bf0) are coming from ticket #34690.



---

archive/issue_comments_489020.json:
```json
{
    "body": "Does this mean that we also have new (for Sage) orders for skew Hadamard matrices?",
    "created_at": "2022-12-09T21:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489020",
    "user": "@dimpase"
}
```

Does this mean that we also have new (for Sage) orders for skew Hadamard matrices?



---

archive/issue_comments_489021.json:
```json
{
    "body": "Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.",
    "created_at": "2022-12-10T08:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489021",
    "user": "@MatteoCati"
}
```

Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.



---

archive/issue_comments_489022.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-12-11T16:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489022",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_489023.json:
```json
{
    "body": "Rebased over latest beta.",
    "created_at": "2022-12-11T16:32:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489023",
    "user": "@MatteoCati"
}
```

Rebased over latest beta.



---

archive/issue_comments_489024.json:
```json
{
    "body": "Replying to [comment:8 Matteo Cati]:\n> Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.\nnice. \n\nHow about bringing Sage up to date w.r.t. skew Hadamard matrices too?\nI actually don't know what the 1st unknown order is in this case (something that's probably mentioned in the literature, I didn't try too hard to find this),\nbut I noticed that Sage does not know about orders 76, 100, and 116, whereas examples are known, see e.g.\n\nhttps://mathscinet.ams.org/mathscinet-getitem?mr=2416980",
    "created_at": "2022-12-13T14:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489024",
    "user": "@dimpase"
}
```

Replying to [comment:8 Matteo Cati]:
> Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.
nice. 

How about bringing Sage up to date w.r.t. skew Hadamard matrices too?
I actually don't know what the 1st unknown order is in this case (something that's probably mentioned in the literature, I didn't try too hard to find this),
but I noticed that Sage does not know about orders 76, 100, and 116, whereas examples are known, see e.g.

https://mathscinet.ams.org/mathscinet-getitem?mr=2416980



---

archive/issue_comments_489025.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-12-13T14:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489025",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_489026.json:
```json
{
    "body": "Replying to [comment:11 Dima Pasechnik]:\n> How about bringing Sage up to date w.r.t. skew Hadamard matrices too?\n\nOkay, I will open a new ticket (#34848).",
    "created_at": "2022-12-14T12:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34570#issuecomment-489026",
    "user": "@MatteoCati"
}
```

Replying to [comment:11 Dima Pasechnik]:
> How about bringing Sage up to date w.r.t. skew Hadamard matrices too?

Okay, I will open a new ticket (#34848).
