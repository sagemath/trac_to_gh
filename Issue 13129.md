# Issue 13129: Implement linear time algorithm to detect path intersection

Issue created by migration from Trac.

Original creator: lucaspastor

Original creation time: 2012-07-26 22:32:01

Assignee: lucaspastor

CC:  slabbe

Path intersection can be detected in a fast way using the algorithm described
in [BKP2011]. The algorithm is based on radix trees.

[BKP2011] S. Brlek, M. Koskas, X. Proven√ßal. A linear time and space
algorithm for detecting path intersection in `Z^d`, Theorical Computer
Science 412 (2011) 4841-4850:[http://dx.doi.org/10.1016/j.tcs.2011.04.019](http://dx.doi.org/10.1016/j.tcs.2011.04.019)



---

Comment by slabbe created at 2012-07-27 02:25:37

The fact that -1 % 2 returns -1 in sage library .pyx file is explained here :

https://groups.google.com/forum/?fromgroups#!topic/sage-devel/GMfCUATUquQ


---

Attachment

The implementation's sage patch.


---

Comment by slabbe created at 2012-08-30 16:01:58

As of now, the node structure is:


```
#Node structure
cdef struct Node:
    int node_number
    int node_id
    Node* parent
    Node** children
    Node** neighbors
    int* coords
    int visited
```


I believe it could be simplified. For example, I believe `node_id` is unused by the important 4 functions. Also `node_number` and `visited` are used by distinct functions. So, they could be merged into one `int data` which could do both job.

Moreover, I thought the coords were not necessary inside the node as we can find them from the data structure. Hence, a simplified node structure could be :


```
#Node structure
cdef struct Node:
    Node* parent
    Node** children
    Node** neighbors
    int data
```


What do you think?
