# Issue 32395: computing elliptic-curve isomorphisms in characteristic 2 sometimes fails

Issue created by migration from https://trac.sagemath.org/ticket/32632

Original creator: lorenz

Original creation time: 2021-10-05 14:31:22

CC:  cremona defeo slelievre

Sage fails to compute isomorphisms between elliptic curves in characteristic 2 in some cases:


```sage
sage: GF(2^8).inject_variables()
Defining z8
sage: E = EllipticCurve([z8,z8,z8,z8,z8])
sage: E.automorphisms()
# ...
ValueError: second argument is not an isomorphism from first argument to third argument
```


The reason appears to be that the formula for the special case `char=2`, `j≠0` in the `isomorphisms()` function defined in `sage/schemes/elliptic_curves/weierstrass_morphism` is lacking a division by one of the Weierstraß `a`‑coefficients. This makes the function return wrong isomorphisms, which is subsequently detected when the corresponding `WeierstrassIsomorphism` object is constructed.



---

Comment by lorenz created at 2021-10-05 14:35:32

New commits:


---

Comment by lorenz created at 2021-10-05 14:35:32

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-10-05 15:32:21

if green bot, then positive review


---

Comment by chapoton created at 2021-10-05 17:58:49

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2021-10-05 19:46:22

Amazing - I think it was about 2007 or 2008 when I implemented this so I apologise if I slipped up even though it has taken 14 years for the bug to get noticed.  I will take a look at the code tomorrow.


---

Comment by vbraun created at 2021-10-24 18:38:53

Resolution: fixed
