# Issue 33588: Use pytest-parallel or pytest-xdist to run pytest in parallel

Issue created by migration from https://trac.sagemath.org/ticket/33825

Original creator: mkoeppe

Original creation time: 2022-05-09 17:33:42

CC:  @tobiasdiez

(from #33546#comment:13 - #33546#comment:20)

Use https://pypi.org/project/pytest-parallel/ (`--workers`) or https://github.com/pytest-dev/pytest-xdist to run pytest in parallel.


---

Comment by @tobiasdiez created at 2022-05-14 09:53:04

New commits:


---

Comment by @tobiasdiez created at 2022-05-14 09:53:04

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-05-14 10:17:19

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2022-05-14 10:17:19

lgtm


---

Comment by @tobiasdiez created at 2022-05-14 10:20:47

That was quick, thanks!


---

Comment by mkoeppe created at 2022-05-14 15:39:33

Changing status from positive_review to needs_work.


---

Comment by mkoeppe created at 2022-05-14 15:39:33

All packages that appear as requirements for which we have an entry in build/pkgs/ should be listed in `dependencies`. This is to avoid races

```
[pytest_xdist] Requirement already satisfied: pytest>=6.2.0 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (7.1.2)
[pytest_xdist] Requirement already satisfied: pluggy<2.0,>=0.12 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (1.0.0)
[pytest_xdist] Requirement already satisfied: py>=1.8.2 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (1.10.0)
[pytest_xdist] Requirement already satisfied: iniconfig in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (1.1.1)
[pytest_xdist] Requirement already satisfied: attrs>=19.2.0 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (21.2.0)
[pytest_xdist] Requirement already satisfied: tomli>=1.0.0 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (1.2.1)
[pytest_xdist] Requirement already satisfied: packaging in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (21.3)
[pytest_xdist] Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages (from packaging->pytest>=6.2.0->pytest-xdist->-r /Users/mkoeppe/s/sage/sage-rebasing/build/pkgs/pytest_xdist/requirements.txt (line 1)) (3.0.6)
```



---

Comment by git created at 2022-05-14 18:44:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-05-14 18:45:39

Changing status from needs_work to positive_review.


---

Comment by mkoeppe created at 2022-05-14 18:46:33

Follow-up: #33851


---

Comment by @tobiasdiez created at 2022-05-14 20:18:09

Thanks for adding the deps.


---

Comment by vbraun created at 2022-05-22 16:31:47

Resolution: fixed
