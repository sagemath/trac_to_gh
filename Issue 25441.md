# Issue 25441: MutablePoset: map randomly fails for many None-returns

Issue created by migration from Trac.

Original creator: behackl

Original creation time: 2018-06-27 19:57:00

CC:  dkrenn cheuberg

The function `MutablePoset.map` is a bit unrobust when many of the shell elements are mapped to `None` simultaneously. This situation occurs, for example, when calling


```
sage: asymptotic_expansions.InverseFunctionAnalysis('n', phi=lambda u: 1/(1-u), precision=10)
```


As a result, this call randomly (depending on the order in which elements are deleted from the `MutablePoset` in the background) fails with a `KeyError`.


---

Comment by behackl created at 2018-06-27 20:15:25

Changing status from new to needs_review.


---

Comment by behackl created at 2018-06-27 20:15:25

New commits:


---

Comment by dkrenn created at 2018-07-23 10:56:32

LGTM


---

Comment by dkrenn created at 2018-07-23 10:56:32

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-05 08:18:01

Resolution: fixed
