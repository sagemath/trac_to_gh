# Issue 11879: LLL algorithm not available for matrices over QQ or RR

Issue created by migration from Trac.

Original creator: dkrenn

Original creation time: 2011-11-17 18:14:21

Assignee: jason, was

CC:  fschulze

Keywords: LLL, rationals, reals, QQ, RR

Matrices over `QQ` or `RR` do not have an method `LLL(...)` like matrices over `ZZ`.


---

Comment by mhansen created at 2011-11-17 20:42:41

You mean for matrices over `QQ` and `RR` whose entries happen to be integers?


---

Comment by dkrenn created at 2011-11-17 21:38:07

Replying to [comment:1 mhansen]:

> You mean for matrices over `QQ` and `RR` whose entries happen to be integers?

No. A strategy could be the following: For matrices over `QQ` you can multiply by the least common multiple of all denominators to get a matrix over `ZZ`, then apply LLL, and then scale back. For matrices over the reals (which are of finite precision), do also some scaling to get an integer-matrix.


---

Comment by johanbosman created at 2011-12-11 11:37:24

It would definitely be good to have this!  For QQ, the proposed strategy obviously works.  For RR, it probably needs some thought what sort of scaling to do here.  For instance, if the matrix has very large as well as very small entries.


---

Comment by fschulze created at 2011-12-21 10:05:46

We asked Andy Novocin about the case of matrices over `RR`. If one wants to use LLL for rational number reconstruction and has lots of decimal digits he proposed the algorithm in [http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf](http://www.cs.uwaterloo.ca/~astorjoh/issac11ratrecon.pdf)


---

Attachment

For RR there is no perfect way to do this; the inexact nature of floating point arithmetic can make things extremely unpleasant.

Andy suggested the following.   Scale and round the input matrix so that the largest entry has about 300 (or so?) bits.  Then augment it with the identity matrix and perform LLL on the augmented matrix.  The augmented part then contains the basis transformation that has to be performed.  Perform this transformation on the input matrix and repeat the procedure until things do not improve anymore (e.g. when the largest entry doesn't decrease anymore).

This sounds good as a general idea, but may fail big time in specific cases, for instance if the input L is an orthogonal sum L1 + L2 with L1 generated by very small vectors and L2 consisting of very large vectors.


---

Comment by johanbosman created at 2011-12-23 21:53:21

Oops, wrong ticket.


---

Comment by vdelecroix created at 2015-03-21 17:03:02

transform the patch into a git branch (and remove trailing whitespaces)
----
New commits:


---

Comment by vdelecroix created at 2015-03-22 10:57:05

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-03-22 10:57:05

Changing keywords from "LLL, rationals, reals, QQ, RR" to "LLL, rationals, QQ".


---

Comment by cremona created at 2015-03-22 17:55:42

Under review.


---

Comment by cremona created at 2015-03-22 19:02:41

Looks good to me, I tried lots of random tests and they work fine.


---

Comment by cremona created at 2015-03-22 19:02:41

Changing status from needs_review to positive_review.


---

Comment by drazioti created at 2015-03-24 14:29:22

I use this patch for a long time. I had no problem. I am wondering if a similar patch 
works for BKZ.


---

Comment by vbraun created at 2015-04-14 19:44:23

Resolution: fixed
