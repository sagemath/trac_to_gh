# Issue 23703: implement proper black-box discrete logarithm for AdditiveAbelianGroupWrapper

Issue created by migration from https://trac.sagemath.org/ticket/23940

Original creator: lorenz

Original creation time: 2017-09-29 12:43:50

Keywords: abstract abelian group generalized discrete logarithm

This takes care of the

    TODO: Implement proper black-box discrete logarithm (using baby-step giant-step).

in the `AdditiveAbelianGroupWrapper` class.

The proposed implementation first reduces to the case of p-groups using the Chinese remainder theorem. To solve the problem in p-groups, a basic version of an algorithm by Sutherland ([https://arxiv.org/abs/0809.3413](https://arxiv.org/abs/0809.3413)) is used.

Compared to the previous (brute force) implementation, the new code yields huge speedups: For instance, the example


```python
F.<t> = GF(431**2)
E = EllipticCurve(j=316*t+116)
A = E.abelian_group()
print(A._discrete_log(E.random_point()))
```


takes over two minutes on my machine using sage 8.0, but with the new code it finishes in less than 100 milliseconds on average.


---

Comment by lorenz created at 2017-09-29 12:50:34

Changing status from new to needs_review.


---

Comment by git created at 2017-09-29 13:37:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2017-12-04 10:27:20

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2017-12-04 10:27:20

Changing keywords from "abstract abelian group generalized discrete logarithm" to "abelian group, discrete logarithm".


---

Comment by vdelecroix created at 2017-12-04 10:27:20

It looks like a great improvement to the Sage library!

Sadly your commits do not apply on the latest beta. You have to rebase your changes on the top of 8.1.rc4.

Concerning the code

1. In

```
+    def _discrete_log_pgroup(self, p, aa, b):
+        from sage.arith.misc import valuation
+        from sage.functions.other import ceil, sqrt
+        from itertools import product as iproduct
+        r"""
```

  The 3 import statements have to go *after* the docstring.

2. You need a linebreak after `EXAMPLES::`

3. You should provide benchmarks that show that you are not making worse the simple cases.


---

Comment by vdelecroix created at 2017-12-04 10:32:21

Sorry, 1. is fixed in your commit `923edc1`


---

Comment by git created at 2020-06-30 12:58:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2020-06-30 13:01:04

Thanks for the feedback and sorry for taking almost three years to continue this.

I've rebased the patch onto the current `develop` branch.

Regarding benchmarks, here's an example on my laptop for a "simple case" (a cyclic group of prime order):

* Current `develop`:
  {{{
  sage: G = AdditiveAbelianGroup([31337])
  sage: A = AdditiveAbelianGroupWrapper(G.0.parent(), G.gens(), [g.order() for g in G.gens()])
  sage: %timeit A._discrete_log(randrange(31337)*G.0)
  1 loop, best of 5: 3.24 s per loop
  }}}

* Commit `d43a1088db07f42554fe090e2a485c2e1695c779`:
  {{{
  sage: G = AdditiveAbelianGroup([31337])
  sage: A = AdditiveAbelianGroupWrapper(G.0.parent(), G.gens(), [g.order() for g in G.gens()])
  sage: %timeit A._discrete_log(randrange(31337)*G.0)
  10 loops, best of 5: 26.2 ms per loop
  }}}

The speedup is extremely significant. This is because the old implementation used na√Øve brute force (linear complexity) whereas the new algorithm reduces to baby-step giant-step (square-root complexity) in the cyclic prime-order case. This case is in fact the hardest for the new algorithm and the speedup should be even bigger on more "decomposable" group structures.


---

Comment by lorenz created at 2020-06-30 13:06:08

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-03-15 22:07:04

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by git created at 2021-04-28 07:48:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2021-04-28 07:49:26

I made some small fixes to make the plugin happy.  Positive review if tests pass.


---

Comment by roed created at 2021-04-28 21:26:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-05-27 20:30:30

Resolution: fixed


---

Comment by vdelecroix created at 2022-01-05 15:57:01

follow up #33121
