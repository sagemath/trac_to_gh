# Issue 20922: Cached generator matrices and parity check matrices should be immutable

archive/issues_020922.json:
```json
{
    "body": "CC:  dlucas\n\nKeywords: linear code, beginner\n\nIn all linear code classes, constructed generator matrices and parity check matrices are cached for efficiency. However, they are often not immutable, leading to incorrect behaviour if the user inadvertently changes them.\n\n\n```\nsage: C = codes.GeneralizedReedSolomonCode(GF(7).list(), 3)\nsage: M = C.generator_matrix()\nsage: M[0,0] = 0\nsage: M.row(0) in C\nFalse\n```\n\n\nAll such cached matrices should be made immutable by `G.set_immutable(True)`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21159\n\n",
    "created_at": "2016-08-03T14:04:53Z",
    "labels": [
        "component: please change",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Cached generator matrices and parity check matrices should be immutable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20922",
    "user": "https://github.com/johanrosenkilde"
}
```
CC:  dlucas

Keywords: linear code, beginner

In all linear code classes, constructed generator matrices and parity check matrices are cached for efficiency. However, they are often not immutable, leading to incorrect behaviour if the user inadvertently changes them.


```
sage: C = codes.GeneralizedReedSolomonCode(GF(7).list(), 3)
sage: M = C.generator_matrix()
sage: M[0,0] = 0
sage: M.row(0) in C
False
```


All such cached matrices should be made immutable by `G.set_immutable(True)`.

Issue created by migration from https://trac.sagemath.org/ticket/21159





---

archive/issue_comments_288932.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to coding theory.",
    "created_at": "2017-02-07T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288932",
    "user": "https://github.com/ClementPernet"
}
```

Changing component from PLEASE CHANGE to coding theory.



---

archive/issue_comments_288933.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-07T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288933",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_288934.json:
```json
{
    "body": "I processed all code classes with the following update:\n* add some ``@`cached_method` decorator when it was missing to a `generator_matrix` or a `parity_check` method\n* systematically set immutable these cached matrices\nBranch attached ready for review.",
    "created_at": "2017-02-07T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288934",
    "user": "https://github.com/ClementPernet"
}
```

I processed all code classes with the following update:
* add some ``@`cached_method` decorator when it was missing to a `generator_matrix` or a `parity_check` method
* systematically set immutable these cached matrices
Branch attached ready for review.



---

archive/issue_comments_288935.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-07T16:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288935",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_288936.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T16:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_288937.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-07T16:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288937",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_288938.json:
```json
{
    "body": "Tests pass and doc builds, I agree with your changes, setting to positive review.\n\nDavid",
    "created_at": "2017-02-07T16:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288938",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Tests pass and doc builds, I agree with your changes, setting to positive review.

David



---

archive/issue_comments_288939.json:
```json
{
    "body": "Changing keywords from \"linear code, beginner\" to \"linear code, beginner, rd3\".",
    "created_at": "2017-02-07T16:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288939",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing keywords from "linear code, beginner" to "linear code, beginner, rd3".



---

archive/issue_comments_288940.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T16:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288940",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_288941.json:
```json
{
    "body": "Well, reopenig this ticket to include parity check codes (#21328) in it.\nWaiting for review...\n\nDavid\n----\nNew commits:",
    "created_at": "2017-02-07T16:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288941",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Well, reopenig this ticket to include parity check codes (#21328) in it.
Waiting for review...

David
----
New commits:



---

archive/issue_comments_288942.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-02-07T16:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288942",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_288943.json:
```json
{
    "body": "Positive review to the merge and last commit by dlucas.",
    "created_at": "2017-02-07T16:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288943",
    "user": "https://github.com/ClementPernet"
}
```

Positive review to the merge and last commit by dlucas.



---

archive/issue_comments_288944.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T16:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288944",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_019844.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-02-14T18:58:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20922#event-19844"
}
```



---

archive/issue_comments_288945.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-14T18:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-288945",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
