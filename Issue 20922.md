# Issue 20922: Cached generator matrices and parity check matrices should be immutable

Issue created by migration from https://trac.sagemath.org/ticket/21159

Original creator: jsrn

Original creation time: 2016-08-03 14:04:53

CC:  dlucas

Keywords: linear code, beginner

In all linear code classes, constructed generator matrices and parity check matrices are cached for efficiency. However, they are often not immutable, leading to incorrect behaviour if the user inadvertently changes them.


```
sage: C = codes.GeneralizedReedSolomonCode(GF(7).list(), 3)
sage: M = C.generator_matrix()
sage: M[0,0] = 0
sage: M.row(0) in C
False
```


All such cached matrices should be made immutable by `G.set_immutable(True)`.


---

Comment by cpernet created at 2017-02-07 16:02:14

Changing component from PLEASE CHANGE to coding theory.


---

Comment by cpernet created at 2017-02-07 16:02:14

Changing status from new to needs_review.


---

Comment by cpernet created at 2017-02-07 16:02:14

I processed all code classes with the following update:
 * add some ``@`cached_method` decorator when it was missing to a `generator_matrix` or a `parity_check` method
 * systematically set immutable these cached matrices
Branch attached ready for review.


---

Comment by cpernet created at 2017-02-07 16:07:45

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-02-07 16:14:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cpernet created at 2017-02-07 16:14:38

Changing status from needs_work to needs_review.


---

Comment by dlucas created at 2017-02-07 16:30:55

Tests pass and doc builds, I agree with your changes, setting to positive review.

David


---

Comment by dlucas created at 2017-02-07 16:30:55

Changing keywords from "linear code, beginner" to "linear code, beginner, rd3".


---

Comment by dlucas created at 2017-02-07 16:30:55

Changing status from needs_review to positive_review.


---

Comment by dlucas created at 2017-02-07 16:49:15

Well, reopenig this ticket to include parity check codes (#21328) in it.
Waiting for review...

David
----
New commits:


---

Comment by dlucas created at 2017-02-07 16:49:15

Changing status from positive_review to needs_review.


---

Comment by cpernet created at 2017-02-07 16:55:55

Positive review to the merge and last commit by dlucas.


---

Comment by cpernet created at 2017-02-07 16:55:55

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-14 18:58:57

Resolution: fixed
