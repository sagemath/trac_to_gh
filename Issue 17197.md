# Issue 17197: Preparser for symbolic functions ignores syntax errors

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2014-12-02 23:02:14

CC:  jakobkroeker

This should be a syntax error:

```
sage: f(x) = 1 ) + ( cos(x)
```


But the preparser turns this into

```
sage: print preparse(*f(x) = 1 ) + ( cos(x)*)
__tmp__=var("x"); f = symbolic_expression(Integer(1) ) + ( cos(x)).function(x)
```



---

Comment by vbraun created at 2014-12-03 08:32:57

Ultimately, this shows why you shouldn't implement input transformations with regular expressions. Sure it works, but you can only get so far. The preparser knows nothing about grammar, so how can it find out about misbalanced parens. We could try to kludge that on top (check that the paren level never goes negative going from left to right) but that would just be a bandaid, too. 

The right fix (TM) is to either implement a full-blown Python+Sage parser  (lex/bison/ply/antlr/...) or hook into the built-in Python parser.


---

Comment by jdemeyer created at 2014-12-03 12:25:23

I think a good start would be to use [https://docs.python.org/2/library/tokenize.html](https://docs.python.org/2/library/tokenize.html)


---

Comment by jakobkroeker created at 2017-03-04 02:13:08

Issue is still open. Not sure if this one should get a stopgap
