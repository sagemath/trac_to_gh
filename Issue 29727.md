# Issue 29727: Make libs doctests ready for random seeds

Issue created by migration from https://trac.sagemath.org/ticket/29964

Original creator: @kliem

Original creation time: 2020-06-24 20:11:27

CC:  @davewittemorris

This ticket makes

```
sage -t --long --random-seed=n src/sage/libs/
```

pass for different values n than just 0.


---

Comment by @kliem created at 2020-06-24 20:12:53

At least the following will need to be fixed:


```
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/flint/nmod_poly_linkage.pxi  # 28 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_GF2E.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_mat_GF2.pyx  # 29 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_mat_GF2E.pyx  # 3 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_mat_ZZ.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_ZZ_p.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/ntl/ntl_ZZ.pyx  # 3 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/libs/singular/function.pyx  # 1 doctest failed
```



---

Comment by @kliem created at 2021-01-24 09:34:57

The NTL function `randomBits` is documented incorrectly. Of course it returns a random number with `n` random bits which corresponds to a random number in  `[0, 2^n)` and not `2^(n-1)` as claimed.


---

Comment by @kliem created at 2021-01-24 11:41:20

New commits:


---

Comment by @kliem created at 2021-01-24 11:41:20

Changing status from new to needs_review.


---

Comment by @kliem created at 2021-01-25 09:14:22


```
list(mult for factor, mult in decomp) <= list(range(2, 2 + len(decomp)))
```


This does not test for a sublist. I will implement such a quick test in #29969.


---

Comment by @kliem created at 2021-01-25 09:14:22

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-01-25 10:09:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-01-25 10:09:11

Changing status from needs_work to needs_review.


---

Comment by mmezzarobba created at 2021-01-26 09:46:06

I think I would have kept the examples in `gauss()` (and flagged it as random), and maybe removed the test that the matrix is not reduced (no real point IMO). But that's not big deal: please feel free to set the ticket to positive_review on my behalf either after changing that or if you disagree.


---

Comment by git created at 2021-01-29 07:05:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-01-29 07:06:29

Ok, I added again one of the examples of `gauss` for illustration.

The test that the matrix is not reduced really tests that the remaining rows are all zero, which tests that the functions has worked correctly, I guess.


---

Comment by @kliem created at 2021-01-29 07:06:39

Thank you.


---

Comment by @kliem created at 2021-01-29 07:06:39

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-02-20 10:46:28

Resolution: fixed
