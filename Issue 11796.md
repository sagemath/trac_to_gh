# Issue 11796: bug in documentation of random_matrix

Issue created by migration from Trac.

Original creator: AlexGhitza

Original creation time: 2011-10-31 07:31:37

Assignee: jason, was

CC:  kcrisman wstein

Keywords: random matrix

The very first example in the docstring for `random_matrix` says


```
Random integer matrices.  With no arguments, the majority of the
entries are -1 and 1, never zero, and rarely "large."
    
          sage: random_matrix(ZZ, 5, 5)
          [ -8   2   0   0   1]
          [ -1   2   1 -95  -1]
          [ -2 -12   0   0   1]
          [ -1   1  -1  -2  -1]
          [  4  -4  -6   5   0]
```


Hang on!  What are those five zeroes doing in there?


---

Comment by jdemeyer created at 2011-11-03 16:14:43

Milestone sage-4.7.3 deleted


---

Comment by khalasz created at 2012-06-14 21:33:18

The problem seems not to be that the given matrix contains 0s, but rather that the text above says it shouldn't contain 0s, as this command will many times give a matrix that indeed contains 0 entries. So, which should be fixed? The actual code or the wrong documentation? Is it that big of a deal to have a random matrix with 0 entries?


---

Comment by JoalHeagney created at 2012-10-01 03:38:59

I think this is due to the default value of the density= keyword being changed from 1.0.


```
A = random_matrix(ZZ,5); A

```


```
[  2  -1   1  11   1]
[  0   1   1   1   1]
[  0   0   3   4   1]
[ 25   1   1   0 -27]
[ -2   1  -1   4  -2]

```


```
A = random_matrix(ZZ,5,density=1.0); A

```


```
[  2 -15 -23  -1  -4]
[  1  -3  -1   6  -1]
[  5   2  -2  -1  -1]
[ -1   2  -1   2   1]
[  1  -1  -2  -2   1]
```

If we're going to have a density keyword, then the documentation should at least state that you can create a matrix with no zero entries by setting density=1.0.

I've also created a ticket #13555 arguing for more doctesting of random functions.


---

Comment by JoalHeagney created at 2012-10-01 04:15:13

Oh god, the documentation/behaviour isn't even consistent with x= and y= keywords.


```
A = random_matrix(ZZ,5,x=4,y=10); A

[7 5 7 6 4]
[8 8 7 5 4]
[8 4 7 9 9]
[4 6 7 4 6]
[9 6 9 6 6]

```

So this gives us behaviour that agrees with the documentation, but seems to use density=1.0.


---

Comment by kcrisman created at 2014-11-07 15:55:53

Just ran across this again.  So clearly at odds with what is stated - yet another example:

```
Also, the default is to not create zero entries,
        unless the ``density`` keyword is set to something strictly less
        than one.
```

What is going on?

```
    if algorithm == 'randomize':
        density = kwds.pop('density', None)
        # zero matrix is immutable, copy is mutable
        A = copy(parent.zero_matrix())
        if density is None:
            A.randomize(density=float(1), nonzero=False, *args, **kwds)
        else:
            A.randomize(density=density, nonzero=True, *args, **kwds)
        return A
```

Okay, so this is the default.  But oops - if `density is None` (default) then `nonzero=False`!!!  So putting density in the right place is then frustrated by using the wrong nonzero value.  And why is the other one `True`?

I would argue this is a bug, not bad documentation.


---

Comment by rbeezer created at 2015-08-24 23:13:11

Changing keywords from "random matrix" to "random matrix documentation".


---

Comment by rbeezer created at 2015-08-24 23:13:11

Changing status from new to needs_review.


---

Comment by rbeezer created at 2015-08-24 23:13:11

This contains only changes to the documentation, so that it matches the code.  I've tried to clarify the documentation of the matrix `.randomize()` method so the action of the `density` and `nonzero` keywords are clearer.  Hopefully their use in the `random_matrix()` constructor will then be clearer as well.
----
New commits:


---

Comment by jmantysalo created at 2015-10-28 18:39:14

I can check this.


---

Comment by jmantysalo created at 2015-10-29 08:37:36

LGTM.


---

Comment by jmantysalo created at 2015-10-29 08:37:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-10-29 16:35:02

Resolution: fixed
