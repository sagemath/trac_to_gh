# Issue 2880: [With revised patch] Special code for elliptic curve cardinality for j=0 and j=1728

archive/issues_002880.json:
```json
{
    "body": "When the new code for point counting on elliptic curves over arbitrary finite fields was implemented, I left handling the special cases j=0 and j=1728 for a rainy day.  These cases were handled in not too bad a way, but as there are special formulas for these cases it was always going to be a good idea to implement them.\n\nNot having any reference which does everything needed here (especially for the really exceptional cases where the characteristic is 2 or 3 and j=0=1728) I worked it all out from scratch, and here is the result.\n\nThere are copious comments and doctests.  I will write up the full justification in due course.  In the meantime I hope we can merge this patch (based on 3.0.alpha1) quite soon!\n\n**Assignee:** @williamstein\n\n**Keywords:** elliptic curves\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/2880\n\n",
    "closed_at": "2008-04-13T16:03:31Z",
    "created_at": "2008-04-11T20:07:20Z",
    "labels": [
        "component: algebraic geometry",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.0",
    "title": "[With revised patch] Special code for elliptic curve cardinality for j=0 and j=1728",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2880",
    "user": "https://github.com/JohnCremona"
}
```
When the new code for point counting on elliptic curves over arbitrary finite fields was implemented, I left handling the special cases j=0 and j=1728 for a rainy day.  These cases were handled in not too bad a way, but as there are special formulas for these cases it was always going to be a good idea to implement them.

Not having any reference which does everything needed here (especially for the really exceptional cases where the characteristic is 2 or 3 and j=0=1728) I worked it all out from scratch, and here is the result.

There are copious comments and doctests.  I will write up the full justification in due course.  In the meantime I hope we can merge this patch (based on 3.0.alpha1) quite soon!

**Assignee:** @williamstein

**Keywords:** elliptic curves

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/2880





---

archive/attachments_002734.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "9384.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2880/9384.patch",
    "created_at": "2008-04-11T20:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_022305.json:
```json
{
    "body": "",
    "created_at": "2008-04-11T20:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22305",
    "user": "https://github.com/JohnCremona"
}
```





---

archive/issue_events_008471.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "rename": {
        "from": "Special code for elliptic curve cardinality for j=0 and j=1728",
        "to": "[With patch] Special code for elliptic curve cardinality for j=0 and j=1728"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2880#event-8471"
}
```



---

archive/issue_comments_022306.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2008-04-11T20:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22306",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_022307.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"elliptic curves\".",
    "created_at": "2008-04-11T20:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22307",
    "user": "https://github.com/JohnCremona"
}
```

**Changing keywords** from "" to "elliptic curves".



---

archive/attachments_002735.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "9467.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2880/9467.patch",
    "created_at": "2008-04-11T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_022308.json:
```json
{
    "body": "replaces previous patch; applies to 3.0.alpha3",
    "created_at": "2008-04-11T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22308",
    "user": "https://github.com/JohnCremona"
}
```

replaces previous patch; applies to 3.0.alpha3



---

archive/issue_comments_022309.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe original patch was based on 3.0.alpha1 and did not apply to alpha3.  The new one does apply ok to alpha3.",
    "created_at": "2008-04-11T21:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22309",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:2'></a>
The original patch was based on 3.0.alpha1 and did not apply to alpha3.  The new one does apply ok to alpha3.



---

archive/issue_events_008472.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "rename": {
        "from": "[With patch] Special code for elliptic curve cardinality for j=0 and j=1728",
        "to": "[With revised patch] Special code for elliptic curve cardinality for j=0 and j=1728"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2880#event-8472"
}
```



---

archive/issue_comments_022310.json:
```json
{
    "body": "**Changing status** from needs_review to needs_review.",
    "created_at": "2008-04-11T21:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22310",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_review to needs_review.



---

archive/issue_events_008473.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-11T22:49:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "milestone": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2880#event-8473"
}
```



---

archive/attachments_002736.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "9468.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2880/9468.patch",
    "created_at": "2008-04-12T19:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_022311.json:
```json
{
    "body": "Apply after preceding main patch",
    "created_at": "2008-04-12T19:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22311",
    "user": "https://github.com/JohnCremona"
}
```

Apply after preceding main patch



---

archive/issue_comments_022312.json:
```json
{
    "body": "<a id='comment:4'></a>\nTwo small changes to be applied after the main patch:\n\n* In abelian_group() when j=0 or 1728 call cardinality() first, now that it is very fast, as that speeds up the group computation\n\n* In abelian_group(), a small adjustment to speed up the linear_relation() finding for the second generator.",
    "created_at": "2008-04-12T19:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22312",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>
Two small changes to be applied after the main patch:

* In abelian_group() when j=0 or 1728 call cardinality() first, now that it is very fast, as that speeds up the group computation

* In abelian_group(), a small adjustment to speed up the linear_relation() finding for the second generator.



---

archive/issue_comments_022313.json:
```json
{
    "body": "<a id='comment:5'></a>\nPatches look good.",
    "created_at": "2008-04-13T15:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22313",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:5'></a>
Patches look good.



---

archive/issue_comments_022314.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2008-04-13T15:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22314",
    "user": "https://github.com/aghitza"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_008474.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-13T16:03:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2880#event-8474"
}
```



---

archive/issue_comments_022315.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2008-04-13T16:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22315",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_comments_022316.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged 9467.patch and 9468.patch in Sage 3.0.alpha5",
    "created_at": "2008-04-13T16:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22316",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Merged 9467.patch and 9468.patch in Sage 3.0.alpha5



---

archive/issue_comments_022317.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [AlexGhitza](#comment%3A5):\n> Patches look good.\n\nThanks!  and sorry for the factor_integer() problem which these caused.  John",
    "created_at": "2008-04-14T13:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2880#issuecomment-22317",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
Replying to [AlexGhitza](#comment%3A5):
> Patches look good.

Thanks!  and sorry for the factor_integer() problem which these caused.  John
