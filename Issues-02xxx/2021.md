# Issue 2021: Only start one maxima instance

archive/issues_002021.json:
```json
{
    "body": "\n```\nsage: a = matrix(SR, 2, [1,2,3,4])\nsage: a.eigenspaces()\nTraceback (most recent call last):\n...\nTypeError: 'SymbolicArithmetic' object is not iterable\nsage: a.eigenvalues()\n[]\n```\n\n**Assignee:** @williamstein\n\nIssue created by migration from https://trac.sagemath.org/ticket/2021\n\n",
    "closed_at": "2008-02-02T03:11:19Z",
    "created_at": "2008-02-01T03:29:51Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-2.10.1",
    "title": "Only start one maxima instance",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/2021",
    "user": "https://github.com/williamstein"
}
```

```
sage: a = matrix(SR, 2, [1,2,3,4])
sage: a.eigenspaces()
Traceback (most recent call last):
...
TypeError: 'SymbolicArithmetic' object is not iterable
sage: a.eigenvalues()
[]
```

**Assignee:** @williamstein

Issue created by migration from https://trac.sagemath.org/ticket/2021





---

archive/issue_comments_010117.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe problems go on:\n\n```\nsage: a.eigenvalues(SR)\nTraceback (most recent call last):\n...\nNotImplementedError\nsage: a.eigenvalues(CC)\nTraceback (most recent call last):\n...\nTypeError: len() of unsized object\nsage: a.eigenvalues?\nDocstring: [nothing]\n```",
    "created_at": "2008-02-01T03:32:56Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10117",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>
The problems go on:

```
sage: a.eigenvalues(SR)
Traceback (most recent call last):
...
NotImplementedError
sage: a.eigenvalues(CC)
Traceback (most recent call last):
...
TypeError: len() of unsized object
sage: a.eigenvalues?
Docstring: [nothing]
```



---

archive/issue_comments_010118.json:
```json
{
    "body": "<a id='comment:2'></a>\nSomething *very* weird is going on here.  Here is something that I think is causing the problem with a.eigenvalues above:\n\n```\nsage: from sage.calculus.calculus import SymbolicVariable\nsage: tmp=SymbolicVariable('tmp_var')\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(tmp).expand().solve(tmp)\n[]\nsage: (tmp^2+2*tmp).solve(tmp)\n[]\nsage: tmp=SymbolicVariable('tmp_var')\nsage: (tmp^2+2*tmp).solve(tmp)\n[tmp_var == -2, tmp_var == 0]\nsage:\nExiting SAGE (CPU time 0m0.13s, Wall time 0m46.43s).\nExiting spawned Maxima process.\nExiting spawned Maxima process.\n```\n\nThe suspicious thing is the *two* maxima processes that are exiting when I exit sage.",
    "created_at": "2008-02-01T15:29:55Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10118",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>
Something *very* weird is going on here.  Here is something that I think is causing the problem with a.eigenvalues above:

```
sage: from sage.calculus.calculus import SymbolicVariable
sage: tmp=SymbolicVariable('tmp_var')
sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(tmp).expand().solve(tmp)
[]
sage: (tmp^2+2*tmp).solve(tmp)
[]
sage: tmp=SymbolicVariable('tmp_var')
sage: (tmp^2+2*tmp).solve(tmp)
[tmp_var == -2, tmp_var == 0]
sage:
Exiting SAGE (CPU time 0m0.13s, Wall time 0m46.43s).
Exiting spawned Maxima process.
Exiting spawned Maxima process.
```

The suspicious thing is the *two* maxima processes that are exiting when I exit sage.



---

archive/issue_comments_010119.json:
```json
{
    "body": "<a id='comment:3'></a>\nMore data below.  When calling a.charpoly(y).expand().solve(y) first, things are messed up.  When calling it after solving an equation with y, things work fine\n\n```\nsage: from sage.calculus.calculus import SymbolicVariable\nsage: y=SymbolicVariable('y')\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: # First solve an equation, then solve a.charpoly\nsage: (y+1).solve(y)\n[y == -1]\nsage: a.charpoly(y).expand().solve(y)\n[y == (5 - sqrt(33))/2, y == (sqrt(33) + 5)/2]\nsage: y=SymbolicVariable('y')\nsage: # Now solve a.charpoly, then solve an equation\nsage: a.charpoly(y).expand().solve(y)\n[]\nsage: (y+1).solve(y)\n[]\n```",
    "created_at": "2008-02-01T15:42:27Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10119",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
More data below.  When calling a.charpoly(y).expand().solve(y) first, things are messed up.  When calling it after solving an equation with y, things work fine

```
sage: from sage.calculus.calculus import SymbolicVariable
sage: y=SymbolicVariable('y')
sage: a=matrix(SR,[[1,2],[3,4]])
sage: # First solve an equation, then solve a.charpoly
sage: (y+1).solve(y)
[y == -1]
sage: a.charpoly(y).expand().solve(y)
[y == (5 - sqrt(33))/2, y == (sqrt(33) + 5)/2]
sage: y=SymbolicVariable('y')
sage: # Now solve a.charpoly, then solve an equation
sage: a.charpoly(y).expand().solve(y)
[]
sage: (y+1).solve(y)
[]
```



---

archive/issue_comments_010120.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis is a complete shot in the dark, but does the problem have to do with asking one maxima instance a question that only makes sense to the other maxima instance?  In which instance is the symbolic variable kept and in which instance is the matrix kept?",
    "created_at": "2008-02-01T15:48:16Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10120",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:4'></a>
This is a complete shot in the dark, but does the problem have to do with asking one maxima instance a question that only makes sense to the other maxima instance?  In which instance is the symbolic variable kept and in which instance is the matrix kept?



---

archive/issue_comments_010121.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe key part here seems to be that \nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(x).solve(x)\n[]\nwhile\nsage: x._maxima_()\nx\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(x).solve(x)\n[x == (5 - sqrt(33))/2, x == (sqrt(33) + 5)/2]\n\nIn fact, we may manually reproduce this behavior by \nsage: x._maxima_(maxima)sage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(x).solve(x)\n[]\n\nIt follows the likely cause is then not importing maxima from calculus somewhere and using instead the global maxima for a calculation involving charpoly.",
    "created_at": "2008-02-01T18:26:52Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10121",
    "user": "https://github.com/garyfurnish"
}
```

<a id='comment:5'></a>
The key part here seems to be that 
sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(x).solve(x)
[]
while
sage: x._maxima_()
x
sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(x).solve(x)
[x == (5 - sqrt(33))/2, x == (sqrt(33) + 5)/2]

In fact, we may manually reproduce this behavior by 
sage: x._maxima_(maxima)sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(x).solve(x)
[]

It follows the likely cause is then not importing maxima from calculus somewhere and using instead the global maxima for a calculation involving charpoly.



---

archive/issue_comments_010122.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe key part here seems to be that \n\n```\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(x).solve(x) []\n```\nwhile \n\n```\nsage: x._maxima_() \nx \nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: a.charpoly(x).solve(x) \n[x == (5 - sqrt(33))/2, x == (sqrt(33) + 5)/2]\n```\n\nIn fact, we may manually reproduce this behavior by\n\n```\nsage: x._maxima_(maxima)\nx\nsage: a=matrix(SR,[[1,2],[3,4]]) \nsage: a.charpoly(x).solve(x) []\n```\n\nIt follows the likely cause is then not importing maxima from calculus somewhere and using instead the global maxima for a calculation involving charpoly.  Sorry about the double post but this at least is readable.",
    "created_at": "2008-02-01T18:29:49Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10122",
    "user": "https://github.com/garyfurnish"
}
```

<a id='comment:6'></a>
The key part here seems to be that 

```
sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(x).solve(x) []
```
while 

```
sage: x._maxima_() 
x 
sage: a=matrix(SR,[[1,2],[3,4]])
sage: a.charpoly(x).solve(x) 
[x == (5 - sqrt(33))/2, x == (sqrt(33) + 5)/2]
```

In fact, we may manually reproduce this behavior by

```
sage: x._maxima_(maxima)
x
sage: a=matrix(SR,[[1,2],[3,4]]) 
sage: a.charpoly(x).solve(x) []
```

It follows the likely cause is then not importing maxima from calculus somewhere and using instead the global maxima for a calculation involving charpoly.  Sorry about the double post but this at least is readable.



---

archive/issue_comments_010123.json:
```json
{
    "body": "<a id='comment:7'></a>\nchanging the import in matrix_symbolic_dense from from\n\n```\nfrom sage.interfaces.maxima import maxima\n```\nto \n\n```\nfrom sage.calculus.calculus import maxima\n```\nappears to fix the problem.  However, it appears that this issue is unrelated to the original eigenspaces issue.",
    "created_at": "2008-02-01T18:57:30Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10123",
    "user": "https://github.com/garyfurnish"
}
```

<a id='comment:7'></a>
changing the import in matrix_symbolic_dense from from

```
from sage.interfaces.maxima import maxima
```
to 

```
from sage.calculus.calculus import maxima
```
appears to fix the problem.  However, it appears that this issue is unrelated to the original eigenspaces issue.



---

archive/attachments_001661.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "symbolic-matrix-maxima.patch",
    "asset_url": "tarball://root/attachments/ticket2021/symbolic-matrix-maxima.patch",
    "created_at": "2008-02-01T19:09:46Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket2021/symbolic-matrix-maxima.patch",
    "user": "https://github.com/jasongrout"
}
```



---

archive/issue_comments_010124.json:
```json
{
    "body": "<a id='comment:8'></a>\nAttachment [symbolic-matrix-maxima.patch](https://github.com/sagemath/sage/files/ticket2021/symbolic-matrix-maxima.patch) by @jasongrout created at 2008-02-01 19:09:46\n\nThanks to gfurnish's brilliance, we found a sticky maxima issue corrected in the first patch (with an added doctest to make sure something like that doesn't happen again!)",
    "created_at": "2008-02-01T19:09:46Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10124",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>
Attachment [symbolic-matrix-maxima.patch](https://github.com/sagemath/sage/files/ticket2021/symbolic-matrix-maxima.patch) by @jasongrout created at 2008-02-01 19:09:46

Thanks to gfurnish's brilliance, we found a sticky maxima issue corrected in the first patch (with an added doctest to make sure something like that doesn't happen again!)



---

archive/issue_comments_010125.json:
```json
{
    "body": "<a id='comment:9'></a>\nIllustrating the eigenspaces issue:\n\n```\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: b=matrix(QQ,[[1,2],[3,4]])\nsage: [i for i in a.fcp()]\n---------------------------------------------------------------------------\n<type 'exceptions.TypeError'>             Traceback (most recent call last)\n\n/home/grout/sage/devel/sage-main/sage/matrix/<ipython console> in <module>()\n\n<type 'exceptions.TypeError'>: 'SymbolicArithmetic' object is not iterable\nsage: [i for i in b.fcp()]\n[(x^2 - 5*x - 2, 1)]\n```",
    "created_at": "2008-02-01T19:20:12Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10125",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:9'></a>
Illustrating the eigenspaces issue:

```
sage: a=matrix(SR,[[1,2],[3,4]])
sage: b=matrix(QQ,[[1,2],[3,4]])
sage: [i for i in a.fcp()]
---------------------------------------------------------------------------
<type 'exceptions.TypeError'>             Traceback (most recent call last)

/home/grout/sage/devel/sage-main/sage/matrix/<ipython console> in <module>()

<type 'exceptions.TypeError'>: 'SymbolicArithmetic' object is not iterable
sage: [i for i in b.fcp()]
[(x^2 - 5*x - 2, 1)]
```



---

archive/issue_comments_010126.json:
```json
{
    "body": "<a id='comment:10'></a>\nAnd another note:\n\n```\nsage: a=matrix(SR,[[1,2],[3,4]])\nsage: [i for i in a.fcp().factor_list()]\n[(x^2 - 5*x - 2, 1)]\n```\n\nSo apparently we need to somehow call factor_list() when we have a symbolic matrix or we need to change SymbolicArithmetic to iterate through factor_list() when we ask for an iterator.",
    "created_at": "2008-02-01T19:24:34Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10126",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:10'></a>
And another note:

```
sage: a=matrix(SR,[[1,2],[3,4]])
sage: [i for i in a.fcp().factor_list()]
[(x^2 - 5*x - 2, 1)]
```

So apparently we need to somehow call factor_list() when we have a symbolic matrix or we need to change SymbolicArithmetic to iterate through factor_list() when we ask for an iterator.



---

archive/issue_comments_010127.json:
```json
{
    "body": "<a id='comment:11'></a>\n[positive review] for symbolic-matrix-maxima.patch.  This is a serious bug fix that should be included ASAP.",
    "created_at": "2008-02-01T22:52:19Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10127",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:11'></a>
[positive review] for symbolic-matrix-maxima.patch.  This is a serious bug fix that should be included ASAP.



---

archive/issue_events_009649.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2008-02-01T22:57:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2021#event-9649"
}
```



---

archive/issue_comments_010128.json:
```json
{
    "body": "<a id='comment:12'></a>\ndon't close this issue yet, though.  A second patch should be coming along to fix the eigenspaces issue.",
    "created_at": "2008-02-01T22:57:12Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10128",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:12'></a>
don't close this issue yet, though.  A second patch should be coming along to fix the eigenspaces issue.



---

archive/issue_comments_010129.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jason](#comment%3A12):\n> don't close this issue yet, though.  A second patch should be coming along to fix the eigenspaces issue.\n\n\nJason, please open another ticket for that issue.\n\nCheers,\n\nMichael",
    "created_at": "2008-02-02T03:08:29Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10129",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:13'></a>
Replying to [jason](#comment%3A12):
> don't close this issue yet, though.  A second patch should be coming along to fix the eigenspaces issue.


Jason, please open another ticket for that issue.

Cheers,

Michael



---

archive/issue_events_009650.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-02T03:11:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "rename": {
        "from": "SR eigenvalues and eigenvectors returns nonsense in both cases in the simplest example",
        "to": "Only start one maxima instance"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2021#event-9650"
}
```



---

archive/issue_events_009651.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-02T03:11:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2021#event-9651"
}
```



---

archive/issue_events_009652.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-02T03:11:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2021#event-9652"
}
```



---

archive/issue_comments_010130.json:
```json
{
    "body": "<a id='comment:14'></a>\nMerged in Sage 2.10.1.rc5",
    "created_at": "2008-02-02T03:11:19Z",
    "issue": "https://github.com/sagemath/sage/issues/2021",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2021#issuecomment-10130",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:14'></a>
Merged in Sage 2.10.1.rc5
