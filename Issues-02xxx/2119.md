# Issue 2119: matlab matrix conversion issue

archive/issues_002119.json:
```json
{
    "body": "Reported by Kate:\n\n```\na0 = matlab('eye(50)')\nsage: a1 = matrix(ZZ,a0)\n---------------------------------------------------------------------------\n<type 'exceptions.TypeError'>             Traceback (most recent call last)\n\n/home/mabshoff/<ipython console> in <module>()\n\n/home/was/s/local/lib/python2.5/site-packages/sage/matrix/constructor.py in matrix(arg0, arg1, arg2, arg3, sparse)\n    287     \n    288     if hasattr(arg1, '_matrix_'):\n--> 289         return arg1._matrix_(arg0)\n    290 \n    291     if arg0 is None:\n\n/home/was/s/local/lib/python2.5/site-packages/sage/interfaces/matlab.py in _matrix_(self, R)\n    283         M = MatrixSpace(R, nrows, ncols)\n    284         v = sum([[x for x in w.split()] for w in v], [])\n--> 285         return M(v)\n    286 \n    287     def set(self, i, j, x):\n\n/home/was/s/local/lib/python2.5/site-packages/sage/matrix/matrix_space.py in __call__(self, entries, coerce, copy, rows)\n    352             return self(entries.matrix(), copy=False)\n    353 \n--> 354         return self.matrix(entries, copy=copy, coerce=coerce, rows=rows)\n    355 \n    356     def change_ring(self, R):\n\n/home/was/s/local/lib/python2.5/site-packages/sage/matrix/matrix_space.py in matrix(self, x, coerce, copy, rows)\n    965                 x = new_x\n    966             \n--> 967         return self.__matrix_class(self, entries=x, copy=copy, coerce=coerce) \n    968      \n    969     def matrix_space(self, nrows=None, ncols=None, sparse=False):\n\n/home/mabshoff/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense.__init__()\n\n<type 'exceptions.TypeError'>: entries has the wrong length\n```\n\nCheers,\n\nMichael\n\nAssignee: @mwhansen\n\nKeywords: matlab conversion\n\nResolution: fixed\n\nAuthor: Mike Hansen\n\nReviewer: Ross Kyprianou\n\nMerged: sage-4.5.2.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/2119\n\n",
    "closed_at": "2010-07-22T07:28:53Z",
    "created_at": "2008-02-08T19:45:40Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.2",
    "title": "matlab matrix conversion issue",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2119",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```
Reported by Kate:

```
a0 = matlab('eye(50)')
sage: a1 = matrix(ZZ,a0)
---------------------------------------------------------------------------
<type 'exceptions.TypeError'>             Traceback (most recent call last)

/home/mabshoff/<ipython console> in <module>()

/home/was/s/local/lib/python2.5/site-packages/sage/matrix/constructor.py in matrix(arg0, arg1, arg2, arg3, sparse)
    287     
    288     if hasattr(arg1, '_matrix_'):
--> 289         return arg1._matrix_(arg0)
    290 
    291     if arg0 is None:

/home/was/s/local/lib/python2.5/site-packages/sage/interfaces/matlab.py in _matrix_(self, R)
    283         M = MatrixSpace(R, nrows, ncols)
    284         v = sum([[x for x in w.split()] for w in v], [])
--> 285         return M(v)
    286 
    287     def set(self, i, j, x):

/home/was/s/local/lib/python2.5/site-packages/sage/matrix/matrix_space.py in __call__(self, entries, coerce, copy, rows)
    352             return self(entries.matrix(), copy=False)
    353 
--> 354         return self.matrix(entries, copy=copy, coerce=coerce, rows=rows)
    355 
    356     def change_ring(self, R):

/home/was/s/local/lib/python2.5/site-packages/sage/matrix/matrix_space.py in matrix(self, x, coerce, copy, rows)
    965                 x = new_x
    966             
--> 967         return self.__matrix_class(self, entries=x, copy=copy, coerce=coerce) 
    968      
    969     def matrix_space(self, nrows=None, ncols=None, sparse=False):

/home/mabshoff/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense.__init__()

<type 'exceptions.TypeError'>: entries has the wrong length
```

Cheers,

Michael

Assignee: @mwhansen

Keywords: matlab conversion

Resolution: fixed

Author: Mike Hansen

Reviewer: Ross Kyprianou

Merged: sage-4.5.2.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/2119





---

archive/issue_comments_014990.json:
```json
{
    "body": "<a id='comment:1'></a>Moreover there is also the following issue reported in the same thread:\n\n```\na00 = str(mathlab('mat2str(eye(50))'))\na01 = a00.replace(' ',',').replace(';','],[')\na02 = '[' + a01 = ']'\na03 = eval(a02)\na1 = matrix(zz,a03)\na2 = matlab.sage2matlab_matrix_string(a1)\na3 = 'm1 = ' + a2\nmatlab.eval(a3)     # crashes\n# Q: caused by \"maxread=100\" and/or \"eval_using_file_cutoff=100\"\n# in devel/sage-main/build/sage/interfaces/matlab.py ?\n```\n\nCheers,\n\nMichael",
    "created_at": "2008-02-08T20:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14990",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:1'></a>Moreover there is also the following issue reported in the same thread:

```
a00 = str(mathlab('mat2str(eye(50))'))
a01 = a00.replace(' ',',').replace(';','],[')
a02 = '[' + a01 = ']'
a03 = eval(a02)
a1 = matrix(zz,a03)
a2 = matlab.sage2matlab_matrix_string(a1)
a3 = 'm1 = ' + a2
matlab.eval(a3)     # crashes
# Q: caused by "maxread=100" and/or "eval_using_file_cutoff=100"
# in devel/sage-main/build/sage/interfaces/matlab.py ?
```

Cheers,

Michael



---

archive/issue_comments_014991.json:
```json
{
    "body": "Changing assignee from cwitty to @mwhansen.",
    "created_at": "2008-09-04T00:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14991",
    "user": "https://github.com/mwhansen"
}
```

Changing assignee from cwitty to @mwhansen.



---

archive/issue_comments_014992.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2008-09-04T00:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14992",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to assigned.



---

archive/issue_comments_014993.json:
```json
{
    "body": "<a id='comment:2'></a>The original bug is caused by things like 'Columns', '27', 'through', '39' appearing in the entries.",
    "created_at": "2008-09-04T00:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14993",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:2'></a>The original bug is caused by things like 'Columns', '27', 'through', '39' appearing in the entries.



---

archive/issue_comments_014994.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2010-01-17T05:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14994",
    "user": "https://github.com/mwhansen"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_014995.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-01-17T05:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14995",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_014996.json:
```json
{
    "body": "<a id='comment:4'></a>Tried this on 2 platforms. First example is fixed by the patch i.e.\n\n```\nb0 = matlab('eye(50)')\nb1 = matrix(ZZ,b0)\n``` \nbut the second example (note that 3 minor typos have been removed) is still broken but shouldnt be (i.e. the displaying/printing of variable a3 shows that a3 is a valid matlab expression). Is the reference to the \\x07 character mean \"BELL\" (a 'ding' made by PCs)? Note that if the following code uses eye(5) it works but with eye(6) it crashes with that x07 error.\n\n```\nsage: a00 = str(matlab('mat2str(eye(6))'))\nsage: a01 = a00.replace(' ',',').replace(';','],[')\nsage: a02 = '[' + a01 + ']'\nsage: a03 = eval(a02)\nsage: a1 = matrix(ZZ,a03)\nsage: a2 = matlab.sage2matlab_matrix_string(a1)\nsage: a3 = 'm1 = ' + a2\nsage: matlab.eval(a3)    \n'\\x07??? source(\"/home/rossk/.sage//temp/sage.math.washington.edu/31533//interface//tmp31533\");\\n           |\\nError: The input character is not valid in MATLAB statements or expressions.\\n'\nsage: a3\n'm1 = [1, 0, 0, 0, 0, 0; 0, 1, 0, 0, 0, 0; 0, 0, 1, 0, 0, 0; 0, 0, 0, 1, 0, 0; 0, 0, 0, 0, 1, 0; 0, 0, 0, 0, 0, 1]'\n```",
    "created_at": "2010-02-12T15:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14996",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

<a id='comment:4'></a>Tried this on 2 platforms. First example is fixed by the patch i.e.

```
b0 = matlab('eye(50)')
b1 = matrix(ZZ,b0)
``` 
but the second example (note that 3 minor typos have been removed) is still broken but shouldnt be (i.e. the displaying/printing of variable a3 shows that a3 is a valid matlab expression). Is the reference to the \x07 character mean "BELL" (a 'ding' made by PCs)? Note that if the following code uses eye(5) it works but with eye(6) it crashes with that x07 error.

```
sage: a00 = str(matlab('mat2str(eye(6))'))
sage: a01 = a00.replace(' ',',').replace(';','],[')
sage: a02 = '[' + a01 + ']'
sage: a03 = eval(a02)
sage: a1 = matrix(ZZ,a03)
sage: a2 = matlab.sage2matlab_matrix_string(a1)
sage: a3 = 'm1 = ' + a2
sage: matlab.eval(a3)    
'\x07??? source("/home/rossk/.sage//temp/sage.math.washington.edu/31533//interface//tmp31533");\n           |\nError: The input character is not valid in MATLAB statements or expressions.\n'
sage: a3
'm1 = [1, 0, 0, 0, 0, 0; 0, 1, 0, 0, 0, 0; 0, 0, 1, 0, 0, 0; 0, 0, 0, 1, 0, 0; 0, 0, 0, 0, 1, 0; 0, 0, 0, 0, 0, 1]'
```



---

archive/issue_comments_014997.json:
```json
{
    "body": "Changing keywords from \"\" to \"matlab conversion\".",
    "created_at": "2010-02-12T15:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14997",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

Changing keywords from "" to "matlab conversion".



---

archive/issue_comments_014998.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ross Kyprianou\"",
    "created_at": "2010-02-12T15:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14998",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

Changing reviewer from "" to "Ross Kyprianou"



---

archive/issue_comments_014999.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-02-12T15:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-14999",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_015000.json:
```json
{
    "body": "Changing author from \"\" to \"Mike Hansen\"",
    "created_at": "2010-02-12T15:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15000",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

Changing author from "" to "Mike Hansen"



---

archive/issue_comments_015001.json:
```json
{
    "body": "Attachment [trac_2119.patch](tarball://root/attachments/some-uuid/ticket2119/trac_2119.patch) by @mwhansen created at 2010-07-11 00:44:28",
    "created_at": "2010-07-11T00:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15001",
    "user": "https://github.com/mwhansen"
}
```

Attachment [trac_2119.patch](tarball://root/attachments/some-uuid/ticket2119/trac_2119.patch) by @mwhansen created at 2010-07-11 00:44:28



---

archive/issue_comments_015002.json:
```json
{
    "body": "<a id='comment:5'></a>I've posted a new patch which fixes the issue above.",
    "created_at": "2010-07-11T00:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15002",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:5'></a>I've posted a new patch which fixes the issue above.



---

archive/issue_comments_015003.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-07-11T00:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15003",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_015004.json:
```json
{
    "body": "<a id='comment:6'></a>Mike\n\nLooks good. The patch fixes the \\x07 issue and the matrices that crashed because they ran over multiple pages (if anything else is discovered with the matlab interface, it should go into a new ticket). Positive review.",
    "created_at": "2010-07-13T02:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15004",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

<a id='comment:6'></a>Mike

Looks good. The patch fixes the \x07 issue and the matrices that crashed because they ran over multiple pages (if anything else is discovered with the matlab interface, it should go into a new ticket). Positive review.



---

archive/issue_comments_015005.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-07-13T02:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15005",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_015006.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-07-22T07:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15006",
    "user": "https://github.com/dandrake"
}
```

Resolution: fixed



---

archive/issue_comments_015007.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.5.2.alpha1\"",
    "created_at": "2010-07-22T07:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15007",
    "user": "https://github.com/dandrake"
}
```

Changing merged from "" to "sage-4.5.2.alpha1"



---

archive/issue_events_005080.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-22T07:28:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2119#event-5080"
}
```



---

archive/issue_comments_015008.json:
```json
{
    "body": "<a id='comment:8'></a>Please see #9608 for docbuild warnings that may stem from this ticket.",
    "created_at": "2010-07-27T07:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2119#issuecomment-15008",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>Please see #9608 for docbuild warnings that may stem from this ticket.
