# Issue 2333: [very positive review] hg_sage.apply('http://trac.sagemath.org/.../ticket/2245/sage-2245.patch') should be made to work

archive/issues_002333.json:
```json
{
    "body": "\n```\n\n\nOn Wed, Feb 27, 2008 at 8:32 AM, Simon King <king@mathematik.uni-jena.de> wrote:\n> \n>  Dear team,\n>  \n>  i started to work with Mercurial and tried to understand\n>  http://modular.math.washington.edu/sage/doc/html/prog/node72.html\n>  \n>  I changed to a new branch, i.e.\n>  > sage -clone myrep\n>  > sage -b myrep\n>  \n>  Meanwhile i also learned (more or less) how to create a patch.\n>  \n>  But what shall i do in order to apply a patch downloaded from that\n>  trac system?\n>  I tried\n>  sage:  hg_sage.import_patch('../work/SingularElementCopy.patch')\n>  \n>  However, this was aborted with the comment \"no diffs found\".\n>  \n>  What does that mean? How can one apply a patch?\n>  \n>  Suggestion: The \"Quick Mercurial tutorial for Sage\" could also say a\n>  few words about the trac system.\n\nTo apply a patch from trac, e.g., the one here:\n     http://trac.sagemath.org/sage_trac/ticket/2245\ndo this:\n\n 1. Click on the patch.\n 2. Go to the bottom of the screen and copy and paste the url for \"Original format\",\ne.g., right click and say \"copy\".\n 3. Paste the result into hg_sage.apply(...), e.g.,\nsage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch?format=raw')\n\n--\n\nIt would also be nice if hg_sage were smart enough to automatically detect the\nnon-raw url (that you click on in step 1 above) and automatically get the raw file\ninstead.  E.g., this could be made to work\n\nsage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch')\n\nThis would be easy to implement -- if ever the input to apply contains\n   http://[anything]attachment/ticket/2245/[anything]\nand doesn't end in ?format=raw, just append it.   That would make it easy to \ncompletely skip the step where you have to find the raw format link.\n\nSince this is so trivial to implement I've made it a trac ticket:\n  \n\n```\n\n**Assignee:** @williamstein\n\nIssue created by migration from https://trac.sagemath.org/ticket/2333\n\n",
    "closed_at": "2008-03-03T12:31:22Z",
    "created_at": "2008-02-27T17:53:10Z",
    "labels": [
        "component: user interface",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-2.10.3",
    "title": "[very positive review] hg_sage.apply('http://trac.sagemath.org/.../ticket/2245/sage-2245.patch') should be made to work",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2333",
    "user": "https://github.com/williamstein"
}
```

```


On Wed, Feb 27, 2008 at 8:32 AM, Simon King <king@mathematik.uni-jena.de> wrote:
> 
>  Dear team,
>  
>  i started to work with Mercurial and tried to understand
>  http://modular.math.washington.edu/sage/doc/html/prog/node72.html
>  
>  I changed to a new branch, i.e.
>  > sage -clone myrep
>  > sage -b myrep
>  
>  Meanwhile i also learned (more or less) how to create a patch.
>  
>  But what shall i do in order to apply a patch downloaded from that
>  trac system?
>  I tried
>  sage:  hg_sage.import_patch('../work/SingularElementCopy.patch')
>  
>  However, this was aborted with the comment "no diffs found".
>  
>  What does that mean? How can one apply a patch?
>  
>  Suggestion: The "Quick Mercurial tutorial for Sage" could also say a
>  few words about the trac system.

To apply a patch from trac, e.g., the one here:
     http://trac.sagemath.org/sage_trac/ticket/2245
do this:

 1. Click on the patch.
 2. Go to the bottom of the screen and copy and paste the url for "Original format",
e.g., right click and say "copy".
 3. Paste the result into hg_sage.apply(...), e.g.,
sage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch?format=raw')

--

It would also be nice if hg_sage were smart enough to automatically detect the
non-raw url (that you click on in step 1 above) and automatically get the raw file
instead.  E.g., this could be made to work

sage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch')

This would be easy to implement -- if ever the input to apply contains
   http://[anything]attachment/ticket/2245/[anything]
and doesn't end in ?format=raw, just append it.   That would make it easy to 
completely skip the step where you have to find the raw format link.

Since this is so trivial to implement I've made it a trac ticket:
  

```

**Assignee:** @williamstein

Issue created by migration from https://trac.sagemath.org/ticket/2333





---

archive/issue_events_006946.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "rename": {
        "from": "[easy to implement] hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch') should be made to work",
        "to": "hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch') should be made to work"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2333#event-6946"
}
```



---

archive/issue_comments_014725.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2008-02-28T00:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14725",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_014726.json:
```json
{
    "body": "<a id='comment:2'></a>\nI can't get it to work:\n\n```\nsage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2333/2333.patch')\nAttempting to load remote file: http://trac.sagemath.org/sage_trac/attachment/ticket/2333/2333.patch\nLoading: [.]\ncd \"/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage\" && hg status\ncd \"/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage\" && hg status\ncd \"/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage\" && hg import   \"/home/mabshoff/.sage/temp/sage/2132/tmp_1.patch\"\napplying /home/mabshoff/.sage/temp/sage/2132/tmp_1.patch\nabort: no diffs found\nsage:\nExiting SAGE (CPU time 0m0.15s, Wall time 0m56.24s).\n```\n\nCheers,\n\nMichael",
    "created_at": "2008-02-28T01:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14726",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
I can't get it to work:

```
sage: hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2333/2333.patch')
Attempting to load remote file: http://trac.sagemath.org/sage_trac/attachment/ticket/2333/2333.patch
Loading: [.]
cd "/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage" && hg status
cd "/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage" && hg status
cd "/scratch/mabshoff/release-cycle/sage-2.10.3.rc0/devel/sage" && hg import   "/home/mabshoff/.sage/temp/sage/2132/tmp_1.patch"
applying /home/mabshoff/.sage/temp/sage/2132/tmp_1.patch
abort: no diffs found
sage:
Exiting SAGE (CPU time 0m0.15s, Wall time 0m56.24s).
```

Cheers,

Michael



---

archive/attachments_002064.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2333.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2333/2333.patch",
    "created_at": "2008-02-28T01:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_014727.json:
```json
{
    "body": "",
    "created_at": "2008-02-28T01:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14727",
    "user": "https://github.com/mwhansen"
}
```





---

archive/attachments_002065.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2333-2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2333/2333-2.patch",
    "created_at": "2008-02-28T08:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_014728.json:
```json
{
    "body": "",
    "created_at": "2008-02-28T08:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14728",
    "user": "https://github.com/mwhansen"
}
```





---

archive/attachments_002066.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2333-3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket2333/2333-3.patch",
    "created_at": "2008-02-28T08:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_014729.json:
```json
{
    "body": "<a id='comment:3'></a>\nAll three patches should be applied in order.",
    "created_at": "2008-02-28T08:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14729",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:3'></a>
All three patches should be applied in order.



---

archive/issue_events_006947.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "rename": {
        "from": "hg_sage.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/2245/sage-2245.patch') should be made to work",
        "to": "hg_sage.apply('http://trac.sagemath.org/.../ticket/2245/sage-2245.patch') should be made to work"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2333#event-6947"
}
```



---

archive/issue_comments_014730.json:
```json
{
    "body": "**Changing status** from needs_review to needs_review.",
    "created_at": "2008-03-02T20:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14730",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_review to needs_review.



---

archive/issue_comments_014731.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe subject screws with the wrapping of the ticket view, so change it :)\n\nCheers,\n\nMichael",
    "created_at": "2008-03-02T20:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14731",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
The subject screws with the wrapping of the ticket view, so change it :)

Cheers,

Michael



---

archive/issue_events_006948.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "rename": {
        "from": "hg_sage.apply('http://trac.sagemath.org/.../ticket/2245/sage-2245.patch') should be made to work",
        "to": "[very positive review] hg_sage.apply('http://trac.sagemath.org/.../ticket/2245/sage-2245.patch') should be made to work"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2333#event-6948"
}
```



---

archive/issue_comments_014732.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged all three patches in Sage 2.10.3.rc1",
    "created_at": "2008-03-03T12:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2333#issuecomment-14732",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Merged all three patches in Sage 2.10.3.rc1



---

archive/issue_events_006949.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-03-03T12:31:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2333#event-6949"
}
```
