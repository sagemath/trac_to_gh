# Issue 2064: foo?? doesn't know about cpdef from the command line

archive/issues_002064.json:
```json
{
    "assignees": [
        "https://github.com/ncalexan"
    ],
    "body": "If you cpdef a function foo, and do foo?? from the command line, it displays both foo and the next function after it.\n\nCC:  @jhpalmieri @robertwb\n\nComponent: **documentation**\n\nAuthor: **Mitesh Patel**\n\nReviewer: **David Roe**\n\nMerged: **sage-4.3.3.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/2064_\n\n",
    "closed_at": "2010-02-17T20:39:46Z",
    "created_at": "2008-02-05T21:38:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20documentation",
        "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "foo?? doesn't know about cpdef from the command line",
    "type": "issue",
    "updated_at": "2010-02-17T20:39:46Z",
    "url": "https://github.com/sagemath/sage/issues/2064",
    "user": "https://github.com/craigcitro"
}
```
If you cpdef a function foo, and do foo?? from the command line, it displays both foo and the next function after it.

CC:  @jhpalmieri @robertwb

Component: **documentation**

Author: **Mitesh Patel**

Reviewer: **David Roe**

Merged: **sage-4.3.3.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/2064_





---

archive/issue_events_020828.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "milestone_number": null,
    "milestone_title": "sage-4.3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20828"
}
```



---

archive/issue_events_020829.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20829"
}
```



---

archive/issue_events_020830.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
    "label_color": "fff9e5",
    "label_name": "p: 5 \u2013 trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20830"
}
```



---

archive/issue_events_020831.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20831"
}
```



---

archive/issue_events_020832.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "subject": "https://github.com/craigcitro",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20832"
}
```



---

archive/issue_events_020833.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2008-02-16T17:28:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20833"
}
```



---

archive/issue_events_020834.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20834"
}
```



---

archive/issue_events_020835.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20835"
}
```



---

archive/issue_comments_009836.json:
```json
{
    "body": "Recognize Cython tokens in source-code introspection.  **sage** repository.",
    "created_at": "2010-02-02T04:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9836",
    "user": "https://github.com/qed777"
}
```

Recognize Cython tokens in source-code introspection.  **sage** repository.



---

archive/issue_comments_009837.json:
```json
{
    "body": "Author: **Mitesh Patel**",
    "created_at": "2010-02-02T04:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9837",
    "user": "https://github.com/qed777"
}
```

Author: **Mitesh Patel**



---

archive/issue_events_020836.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20836"
}
```



---

archive/issue_events_020837.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20837"
}
```



---

archive/issue_events_020838.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20838"
}
```



---

archive/issue_comments_009838.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[trac_2064-sage_cpdef_inspect.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.patch.gz)**\n\nI've attached a patch uses a modified `inspect.BlockFinder` to recognize the `cdef` and `cpdef` tokens.  This appears to work for me, but I'm not a Cython expert.\n\nCurrently, the notebook has its own `sagenb.misc.sageinspect` and this has diverged in several places from `sage.misc.sageinspect`.  If the approach here is OK, I'll open a separate ticket to reconcile the files and fixes this problem in the notebook.",
    "created_at": "2010-02-02T04:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9838",
    "user": "https://github.com/qed777"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[trac_2064-sage_cpdef_inspect.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.patch.gz)**

I've attached a patch uses a modified `inspect.BlockFinder` to recognize the `cdef` and `cpdef` tokens.  This appears to work for me, but I'm not a Cython expert.

Currently, the notebook has its own `sagenb.misc.sageinspect` and this has diverged in several places from `sage.misc.sageinspect`.  If the approach here is OK, I'll open a separate ticket to reconcile the files and fixes this problem in the notebook.



---

archive/issue_events_020839.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-06T03:01:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20839"
}
```



---

archive/issue_comments_009839.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis seems to fix the problem for me (I tried `sage.rings.integer.Integer._act_on??` before and after the patch), but I'm not a Cython expert either.  Robert: can you look at it or suggest some else?",
    "created_at": "2010-02-07T19:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9839",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

This seems to fix the problem for me (I tried `sage.rings.integer.Integer._act_on??` before and after the patch), but I'm not a Cython expert either.  Robert: can you look at it or suggest some else?



---

archive/issue_comments_009840.json:
```json
{
    "body": "Reviewer: **roed**",
    "created_at": "2010-02-09T20:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9840",
    "user": "https://github.com/roed314"
}
```

Reviewer: **roed**



---

archive/issue_events_020840.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-09T20:02:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20840"
}
```



---

archive/issue_events_020841.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-09T20:02:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20841"
}
```



---

archive/issue_comments_009841.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI looked at the Python inspect module, and this seems like a sane modification.  It works for all of us.  \n\nMy main suggestion would be to remove \"cdef\" from the list of keywords you're looking for.  Since this is introspection, you can't ever see cdef'd functions, and I'm slightly worried that there's some use case where the other uses of that keyword in Cython could trip you up.\n\nOther than that, I'm happy to give it a positive review.",
    "created_at": "2010-02-09T20:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9841",
    "user": "https://github.com/roed314"
}
```

<div id="comment:7" align="right">comment:7</div>

I looked at the Python inspect module, and this seems like a sane modification.  It works for all of us.  

My main suggestion would be to remove "cdef" from the list of keywords you're looking for.  Since this is introspection, you can't ever see cdef'd functions, and I'm slightly worried that there's some use case where the other uses of that keyword in Cython could trip you up.

Other than that, I'm happy to give it a positive review.



---

archive/issue_comments_009842.json:
```json
{
    "body": "Removes \"cdef\" from keyword list.  Apply only this patch.",
    "created_at": "2010-02-16T21:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9842",
    "user": "https://github.com/qed777"
}
```

Removes "cdef" from keyword list.  Apply only this patch.



---

archive/issue_comments_009843.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_2064-sage_cpdef_inspect.2.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz)**\n\nV2 adds only \"cpdef\" to the token search (or search for tokens).",
    "created_at": "2010-02-16T21:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9843",
    "user": "https://github.com/qed777"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_2064-sage_cpdef_inspect.2.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz)**

V2 adds only "cpdef" to the token search (or search for tokens).



---

archive/issue_events_020842.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-16T21:23:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20842"
}
```



---

archive/issue_events_020843.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-16T21:23:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20843"
}
```



---

archive/issue_comments_009844.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYep.  Looks fine to me now.",
    "created_at": "2010-02-16T21:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9844",
    "user": "https://github.com/roed314"
}
```

<div id="comment:9" align="right">comment:9</div>

Yep.  Looks fine to me now.



---

archive/issue_comments_009845.json:
```json
{
    "body": "Changed reviewer from **roed** to **David Roe**",
    "created_at": "2010-02-16T21:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9845",
    "user": "https://github.com/roed314"
}
```

Changed reviewer from **roed** to **David Roe**



---

archive/issue_events_020844.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-16T21:31:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20844"
}
```



---

archive/issue_events_020845.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-16T21:31:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20845"
}
```



---

archive/issue_events_020846.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-17T20:39:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20846"
}
```



---

archive/issue_events_020847.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-17T20:39:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-20847"
}
```



---

archive/issue_comments_009846.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nMerged [trac_2064-sage_cpdef_inspect.2.patch](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz).",
    "created_at": "2010-02-17T20:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9846",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:10" align="right">comment:10</div>

Merged [trac_2064-sage_cpdef_inspect.2.patch](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz).



---

archive/issue_comments_009847.json:
```json
{
    "body": "Merged: **sage-4.3.3.alpha1**",
    "created_at": "2010-02-17T20:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-9847",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **sage-4.3.3.alpha1**
