# Issue 2064: foo?? doesn't know about cpdef from the command line

archive/issues_002064.json:
```json
{
    "assignees": [],
    "body": "If you cpdef a function foo, and do foo?? from the command line, it displays both foo and the next function after it.\n\n**Assignee:** @ncalexan\n\n**CC:**  @jhpalmieri @robertwb\n\n**Author:** Mitesh Patel\n\n**Reviewer:** David Roe\n\n**Merged:** sage-4.3.3.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/2064\n\n",
    "closed_at": "2010-02-17T20:39:46Z",
    "created_at": "2008-02-05T21:38:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20documentation",
        "https://github.com/sagemath/sage/labels/trivial",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "foo?? doesn't know about cpdef from the command line",
    "type": "issue",
    "updated_at": "2010-02-17T20:39:46Z",
    "url": "https://github.com/sagemath/sage/issues/2064",
    "user": "https://github.com/craigcitro"
}
```
If you cpdef a function foo, and do foo?? from the command line, it displays both foo and the next function after it.

**Assignee:** @ncalexan

**CC:**  @jhpalmieri @robertwb

**Author:** Mitesh Patel

**Reviewer:** David Roe

**Merged:** sage-4.3.3.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/2064





---

archive/issue_events_016526.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "milestone_number": null,
    "milestone_title": "sage-4.3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16526"
}
```



---

archive/issue_events_016527.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "08517b",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16527"
}
```



---

archive/issue_events_016528.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/trivial",
    "label_color": "ff0000",
    "label_name": "trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16528"
}
```



---

archive/issue_events_016529.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2008-02-05T21:38:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16529"
}
```



---

archive/issue_events_016530.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2008-02-16T17:28:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "08517b",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16530"
}
```



---

archive/issue_events_016531.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2008-02-16T17:28:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20misc",
    "label_color": "08517b",
    "label_name": "component: misc",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16531"
}
```



---

archive/issue_events_016532.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16532"
}
```



---

archive/issue_events_016533.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16533"
}
```



---

archive/issue_comments_010387.json:
```json
{
    "body": "Recognize Cython tokens in source-code introspection.  **sage** repository.",
    "created_at": "2010-02-02T04:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10387",
    "user": "https://github.com/qed777"
}
```

Recognize Cython tokens in source-code introspection.  **sage** repository.



---

archive/issue_comments_010388.json:
```json
{
    "body": "**Author:** Mitesh Patel",
    "created_at": "2010-02-02T04:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10388",
    "user": "https://github.com/qed777"
}
```

**Author:** Mitesh Patel



---

archive/issue_events_016534.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16534"
}
```



---

archive/issue_events_016535.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16535"
}
```



---

archive/issue_events_016536.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-02T04:57:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16536"
}
```



---

archive/issue_comments_010389.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\n**Attachment:** [trac_2064-sage_cpdef_inspect.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.patch.gz)\n\nI've attached a patch uses a modified `inspect.BlockFinder` to recognize the `cdef` and `cpdef` tokens.  This appears to work for me, but I'm not a Cython expert.\n\nCurrently, the notebook has its own `sagenb.misc.sageinspect` and this has diverged in several places from `sage.misc.sageinspect`.  If the approach here is OK, I'll open a separate ticket to reconcile the files and fixes this problem in the notebook.",
    "created_at": "2010-02-02T04:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10389",
    "user": "https://github.com/qed777"
}
```

<a id='comment:3'>**Comment 3:**</a>
**Attachment:** [trac_2064-sage_cpdef_inspect.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.patch.gz)

I've attached a patch uses a modified `inspect.BlockFinder` to recognize the `cdef` and `cpdef` tokens.  This appears to work for me, but I'm not a Cython expert.

Currently, the notebook has its own `sagenb.misc.sageinspect` and this has diverged in several places from `sage.misc.sageinspect`.  If the approach here is OK, I'll open a separate ticket to reconcile the files and fixes this problem in the notebook.



---

archive/issue_events_016537.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-06T03:01:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20misc",
    "label_color": "08517b",
    "label_name": "component: misc",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16537"
}
```



---

archive/issue_events_016538.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-06T03:01:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20documentation",
    "label_color": "08517b",
    "label_name": "component: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16538"
}
```



---

archive/issue_comments_010390.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nThis seems to fix the problem for me (I tried `sage.rings.integer.Integer._act_on??` before and after the patch), but I'm not a Cython expert either.  Robert: can you look at it or suggest some else?",
    "created_at": "2010-02-07T19:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10390",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>**Comment 6:**</a>
This seems to fix the problem for me (I tried `sage.rings.integer.Integer._act_on??` before and after the patch), but I'm not a Cython expert either.  Robert: can you look at it or suggest some else?



---

archive/issue_comments_010391.json:
```json
{
    "body": "**Reviewer:** roed",
    "created_at": "2010-02-09T20:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10391",
    "user": "https://github.com/roed314"
}
```

**Reviewer:** roed



---

archive/issue_events_016539.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-09T20:02:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16539"
}
```



---

archive/issue_events_016540.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-09T20:02:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16540"
}
```



---

archive/issue_comments_010392.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI looked at the Python inspect module, and this seems like a sane modification.  It works for all of us.  \n\nMy main suggestion would be to remove \"cdef\" from the list of keywords you're looking for.  Since this is introspection, you can't ever see cdef'd functions, and I'm slightly worried that there's some use case where the other uses of that keyword in Cython could trip you up.\n\nOther than that, I'm happy to give it a positive review.",
    "created_at": "2010-02-09T20:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10392",
    "user": "https://github.com/roed314"
}
```

<a id='comment:7'>**Comment 7:**</a>
I looked at the Python inspect module, and this seems like a sane modification.  It works for all of us.  

My main suggestion would be to remove "cdef" from the list of keywords you're looking for.  Since this is introspection, you can't ever see cdef'd functions, and I'm slightly worried that there's some use case where the other uses of that keyword in Cython could trip you up.

Other than that, I'm happy to give it a positive review.



---

archive/issue_comments_010393.json:
```json
{
    "body": "Removes \"cdef\" from keyword list.  Apply only this patch.",
    "created_at": "2010-02-16T21:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10393",
    "user": "https://github.com/qed777"
}
```

Removes "cdef" from keyword list.  Apply only this patch.



---

archive/issue_comments_010394.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\n**Attachment:** [trac_2064-sage_cpdef_inspect.2.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz)\n\nV2 adds only \"cpdef\" to the token search (or search for tokens).",
    "created_at": "2010-02-16T21:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10394",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'>**Comment 8:**</a>
**Attachment:** [trac_2064-sage_cpdef_inspect.2.patch.gz](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz)

V2 adds only "cpdef" to the token search (or search for tokens).



---

archive/issue_events_016541.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-16T21:23:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16541"
}
```



---

archive/issue_events_016542.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-02-16T21:23:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16542"
}
```



---

archive/issue_comments_010395.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nYep.  Looks fine to me now.",
    "created_at": "2010-02-16T21:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10395",
    "user": "https://github.com/roed314"
}
```

<a id='comment:9'>**Comment 9:**</a>
Yep.  Looks fine to me now.



---

archive/issue_comments_010396.json:
```json
{
    "body": "**Changing reviewer** from \"roed\" to \"David Roe\".",
    "created_at": "2010-02-16T21:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10396",
    "user": "https://github.com/roed314"
}
```

**Changing reviewer** from "roed" to "David Roe".



---

archive/issue_events_016543.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-16T21:31:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16543"
}
```



---

archive/issue_events_016544.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-16T21:31:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16544"
}
```



---

archive/issue_events_016545.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-17T20:39:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16545"
}
```



---

archive/issue_events_016546.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-17T20:39:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2064#event-16546"
}
```



---

archive/issue_comments_010397.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nMerged [trac_2064-sage_cpdef_inspect.2.patch](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz).",
    "created_at": "2010-02-17T20:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10397",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<a id='comment:10'>**Comment 10:**</a>
Merged [trac_2064-sage_cpdef_inspect.2.patch](https://github.com/sagemath/sage/files/ticket2064/trac_2064-sage_cpdef_inspect.2.patch.gz).



---

archive/issue_comments_010398.json:
```json
{
    "body": "**Merged:** sage-4.3.3.alpha1",
    "created_at": "2010-02-17T20:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2064",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2064#issuecomment-10398",
    "user": "https://github.com/sagetrac-mvngu"
}
```

**Merged:** sage-4.3.3.alpha1
