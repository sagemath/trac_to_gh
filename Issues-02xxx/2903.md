# Issue 2903: [with spkg + patch, positive review] make NTL error messages propagate to RuntimeError messages

archive/issues_002903.json:
```json
{
    "body": "The spkg and patch achieve the following:\n\n* add a mechanism to NTL for setting a callback, so that when NTL calls its `Error()` function, the callback is called instead of printing an error message to stderr and abort()-ing\n\n* use this mechanism in Sage to propagate NTL's error messages back to a `RuntimeError` with a message. This means that instead of crashing to the command line, the user lands back at the sage prompt.\n\nIt would be nice if the NTL modifications were accepted upstream.\n\nObviously this solution is suboptimal, since it will very likely cause memory leaks. But memory leaks are better than crashing to the command line (well, that's debatable I suppose....). But the only way to fix this would be a major rewrite of lots of NTL to implement saner error propagation.\n\n\n**Assignee:** cwitty\n\nIssue created by migration from https://trac.sagemath.org/ticket/2903\n\n",
    "closed_at": "2008-04-17T20:06:50Z",
    "created_at": "2008-04-13T02:55:37Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.0",
    "title": "[with spkg + patch, positive review] make NTL error messages propagate to RuntimeError messages",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/2903",
    "user": "https://trac.sagemath.org/admin/accounts/users/dmharvey"
}
```
The spkg and patch achieve the following:

* add a mechanism to NTL for setting a callback, so that when NTL calls its `Error()` function, the callback is called instead of printing an error message to stderr and abort()-ing

* use this mechanism in Sage to propagate NTL's error messages back to a `RuntimeError` with a message. This means that instead of crashing to the command line, the user lands back at the sage prompt.

It would be nice if the NTL modifications were accepted upstream.

Obviously this solution is suboptimal, since it will very likely cause memory leaks. But memory leaks are better than crashing to the command line (well, that's debatable I suppose....). But the only way to fix this would be a major rewrite of lots of NTL to implement saner error propagation.


**Assignee:** cwitty

Issue created by migration from https://trac.sagemath.org/ticket/2903





---

archive/issue_comments_015948.json:
```json
{
    "body": "<a id='comment:1'></a>\nspkg was too big, trac didn't like it.\n\nHere it is instead:\n\nhttp://sage.math.washington.edu/home/dmharvey/ntl-5.4.2.p1.spkg",
    "created_at": "2008-04-13T02:58:59Z",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2903#issuecomment-15948",
    "user": "https://trac.sagemath.org/admin/accounts/users/dmharvey"
}
```

<a id='comment:1'></a>
spkg was too big, trac didn't like it.

Here it is instead:

http://sage.math.washington.edu/home/dmharvey/ntl-5.4.2.p1.spkg



---

archive/issue_events_015242.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-13T03:03:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "milestone": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2903#event-15242"
}
```



---

archive/attachments_002762.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "ntl-error.patch",
    "asset_url": "tarball://root/attachments/ticket2903/ntl-error.patch",
    "created_at": "2008-04-13T03:03:36Z",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket2903/ntl-error.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```



---

archive/issue_comments_015949.json:
```json
{
    "body": "<a id='comment:2'></a>\nAttachment [ntl-error.patch](https://github.com/sagemath/sage/files/ticket2903/ntl-error.patch) by mabshoff created at 2008-04-13 03:03:36",
    "created_at": "2008-04-13T03:03:36Z",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2903#issuecomment-15949",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
Attachment [ntl-error.patch](https://github.com/sagemath/sage/files/ticket2903/ntl-error.patch) by mabshoff created at 2008-04-13 03:03:36



---

archive/issue_events_015243.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-17T19:49:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "rename": {
        "from": "[with spkg + patch, needs review] make NTL error messages propagate to RuntimeError messages",
        "to": "[with spkg + patch, positive review] make NTL error messages propagate to RuntimeError messages"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2903#event-15243"
}
```



---

archive/issue_comments_015950.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe spkg as well as the patch looks good to me. I added patches of the changed files to the patches directory, so that external packages have an easier time updating the source.\n\nPositive review.\n\nCheers,\n\nMichael",
    "created_at": "2008-04-17T19:49:23Z",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2903#issuecomment-15950",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:3'></a>
The spkg as well as the patch looks good to me. I added patches of the changed files to the patches directory, so that external packages have an easier time updating the source.

Positive review.

Cheers,

Michael



---

archive/issue_events_015244.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-17T20:06:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2903#event-15244"
}
```



---

archive/issue_comments_015951.json:
```json
{
    "body": "<a id='comment:4'></a>\nMerged in Sage 3.0.alpha6",
    "created_at": "2008-04-17T20:06:50Z",
    "issue": "https://github.com/sagemath/sage/issues/2903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2903#issuecomment-15951",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
Merged in Sage 3.0.alpha6
