# Issue 2859: [with patch, positive review] arrow3d((0,0,0), (0,0,-1)) plots an *upward* pointing arrow

archive/issues_002859.json:
```json
{
    "body": "Try the following:\n\n```\nplot(vector((0,0,-1)))\n```\n\nThe resulting vector points up, but should point down.\n\nAssignee: @williamstein\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/2859\n\n",
    "closed_at": "2008-04-09T10:01:04Z",
    "created_at": "2008-04-08T21:10:09Z",
    "labels": [
        "component: graphics",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.0",
    "title": "[with patch, positive review] arrow3d((0,0,0), (0,0,-1)) plots an *upward* pointing arrow",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2859",
    "user": "https://github.com/jasongrout"
}
```
Try the following:

```
plot(vector((0,0,-1)))
```

The resulting vector points up, but should point down.

Assignee: @williamstein

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/2859





---

archive/issue_comments_019574.json:
```json
{
    "body": "<a id='comment:1'></a>The problem is in arrow3d:\n\n```\nsage: arrow3d((0,0,0), (0,0,-1))\n*points up*\n```",
    "created_at": "2008-04-08T21:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19574",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>The problem is in arrow3d:

```
sage: arrow3d((0,0,0), (0,0,-1))
*points up*
```



---

archive/issue_comments_019575.json:
```json
{
    "body": "<a id='comment:2'></a>All right, this was because we were taking the cross product with (0,0,1) and using that to decide whether or not to rotate the vector, ignoring the case that we point in the opposite direction (but still have a cross product of zero).\n\nPatch will be attached.  I'm marking this a blocker since it gives a *wrong* result and William said that wrong results should be marked as blockers.",
    "created_at": "2008-04-08T22:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19575",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>All right, this was because we were taking the cross product with (0,0,1) and using that to decide whether or not to rotate the vector, ignoring the case that we point in the opposite direction (but still have a cross product of zero).

Patch will be attached.  I'm marking this a blocker since it gives a *wrong* result and William said that wrong results should be marked as blockers.



---

archive/issue_comments_019576.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2008-04-08T22:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19576",
    "user": "https://github.com/jasongrout"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_019577.json:
```json
{
    "body": "<a id='comment:5'></a>Jason,\n\nhow does this ticket related to #1777? [also opened by you]\n\nCheers,\n\nMichael",
    "created_at": "2008-04-09T01:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19577",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>Jason,

how does this ticket related to #1777? [also opened by you]

Cheers,

Michael



---

archive/issue_comments_019578.json:
```json
{
    "body": "<a id='comment:6'></a>It doesn't relate.  \n\nIn this ticket, the arrow is actually wrong (the assumption in the code is that \"parallel to (0,0,1)\" == \"pointing in the same direction as (0,0,1)\", which is just wrong.\n\nThe issue in #1777 is a cosmetic issue related to the menus in JMOL.",
    "created_at": "2008-04-09T01:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19578",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>It doesn't relate.  

In this ticket, the arrow is actually wrong (the assumption in the code is that "parallel to (0,0,1)" == "pointing in the same direction as (0,0,1)", which is just wrong.

The issue in #1777 is a cosmetic issue related to the menus in JMOL.



---

archive/issue_comments_019579.json:
```json
{
    "body": "<a id='comment:7'></a>The patch works as advertised and the code looks good to me. Positive review for the code, and I'll give it full positive review once you sort out this minor complaint about the doctest: instead of \"A downward pointing arrow should have a transformation scaling the points to their negatives\" do you mean to say something like \"a downward-pointing arrow *corresponds* to a transformation *which reverses the z-coordinates* of points\"?\n\nMostly I'm confused because when you give me a vector in R<sup>3</sup> and ask me what linear transformation of R<sup>3</sup> to itself that it's describing, I naturally think of reflection across the perpendicular plane. The vector (0,0,-1) doesn't say \"take (x,y,z) to (-x,-y,-z)\" to me...but maybe this is just me, and perhaps it's more an issue with `get_transformation` than with `arrow3d`.\n\nAt any rate, if you're a bit more clear in that description, you'll be good to go.",
    "created_at": "2008-04-09T07:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19579",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:7'></a>The patch works as advertised and the code looks good to me. Positive review for the code, and I'll give it full positive review once you sort out this minor complaint about the doctest: instead of "A downward pointing arrow should have a transformation scaling the points to their negatives" do you mean to say something like "a downward-pointing arrow *corresponds* to a transformation *which reverses the z-coordinates* of points"?

Mostly I'm confused because when you give me a vector in R<sup>3</sup> and ask me what linear transformation of R<sup>3</sup> to itself that it's describing, I naturally think of reflection across the perpendicular plane. The vector (0,0,-1) doesn't say "take (x,y,z) to (-x,-y,-z)" to me...but maybe this is just me, and perhaps it's more an issue with `get_transformation` than with `arrow3d`.

At any rate, if you're a bit more clear in that description, you'll be good to go.



---

archive/issue_comments_019580.json:
```json
{
    "body": "<a id='comment:8'></a>Arrows are always constructed pointing up in the z direction from the origin, and then rotated/translated into place.  This works for every arrow direction except the -z direction.  I take care of the issue by testing to see if the arrow should point in the -z direction, and if it should, just scaling the constructed arrow by -1 (i.e., every point is sent to its negative).  The scaled arrow then points downwards.  The doctest just tests that the scale of -1 is applied to the arrow.  I'm not sure how to make it clearer.",
    "created_at": "2008-04-09T08:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19580",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>Arrows are always constructed pointing up in the z direction from the origin, and then rotated/translated into place.  This works for every arrow direction except the -z direction.  I take care of the issue by testing to see if the arrow should point in the -z direction, and if it should, just scaling the constructed arrow by -1 (i.e., every point is sent to its negative).  The scaled arrow then points downwards.  The doctest just tests that the scale of -1 is applied to the arrow.  I'm not sure how to make it clearer.



---

archive/issue_comments_019581.json:
```json
{
    "body": "<a id='comment:9'></a>Attachment [trac-2859-arrow3d.patch](tarball://root/attachments/some-uuid/ticket2859/trac-2859-arrow3d.patch) by @jasongrout created at 2008-04-09 08:53:34\n\nI put up a new patch with the above explanation above the doctest.",
    "created_at": "2008-04-09T08:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19581",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:9'></a>Attachment [trac-2859-arrow3d.patch](tarball://root/attachments/some-uuid/ticket2859/trac-2859-arrow3d.patch) by @jasongrout created at 2008-04-09 08:53:34

I put up a new patch with the above explanation above the doctest.



---

archive/issue_comments_019582.json:
```json
{
    "body": "<a id='comment:10'></a>Looks good to me. I like the added explanation. Positive review.\n\nCheers,\n\nMichael",
    "created_at": "2008-04-09T09:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19582",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:10'></a>Looks good to me. I like the added explanation. Positive review.

Cheers,

Michael



---

archive/issue_comments_019583.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2008-04-09T10:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19583",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_006546.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-09T10:01:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2859#event-6546"
}
```



---

archive/issue_comments_019584.json:
```json
{
    "body": "<a id='comment:11'></a>Merged in Sage 3.0.alpha3",
    "created_at": "2008-04-09T10:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2859#issuecomment-19584",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:11'></a>Merged in Sage 3.0.alpha3
