# Issue 2223: [with patch, positive review, needs rebase] sage-2.10.2.alpha1 -- bessel_J -- precision errors

archive/issues_002223.json:
```json
{
    "body": "On OSX \n\n```\nsage -t  devel/sage-main/sage/functions/special.py          **********************************************************************\nFile \"special.py\", line 506:\n    sage: bessel_J(3,10,\"scipy\")\nExpected:\n    0.0583793793052... - 1.65905485529...e-17*I\nGot:\n    0.0583793793052000 - 2.93425242844000e-17*I\n**********************************************************************\n1 items had failures:\n```\n\nThoughts:\n\nIt's likely a theorem that bessel_J is always real\nfor integer first argument?  If so, let's just return\nthe real part and be done with these weird imaginary\npart issues:\n\n```\nsage: bessel_J(3,10,\"scipy\")\n0.0583793793052000 - 2.93425242844000e-17*I\nsage: bessel_J(4,10,\"scipy\")\n9.69299109301000e-17*I - 0.219602686102000\nsage: bessel_J(5,10,\"scipy\")\n1.11203257018000e-16*I - 0.234061528187000\nsage: bessel_J(10,10,\"scipy\")\n0.207486106633000 - 1.17732704470000e-16*I\nsage: bessel_J(10,20,\"scipy\")\n0.186482558024000 - 2.10019326787000e-16*I\n```\n\nAssignee: somebody\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/2223\n\n",
    "closed_at": "2008-02-22T01:06:16Z",
    "created_at": "2008-02-20T06:54:22Z",
    "labels": [
        "component: basic arithmetic",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-2.10.2",
    "title": "[with patch, positive review, needs rebase] sage-2.10.2.alpha1 -- bessel_J -- precision errors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2223",
    "user": "https://github.com/williamstein"
}
```
On OSX 

```
sage -t  devel/sage-main/sage/functions/special.py          **********************************************************************
File "special.py", line 506:
    sage: bessel_J(3,10,"scipy")
Expected:
    0.0583793793052... - 1.65905485529...e-17*I
Got:
    0.0583793793052000 - 2.93425242844000e-17*I
**********************************************************************
1 items had failures:
```

Thoughts:

It's likely a theorem that bessel_J is always real
for integer first argument?  If so, let's just return
the real part and be done with these weird imaginary
part issues:

```
sage: bessel_J(3,10,"scipy")
0.0583793793052000 - 2.93425242844000e-17*I
sage: bessel_J(4,10,"scipy")
9.69299109301000e-17*I - 0.219602686102000
sage: bessel_J(5,10,"scipy")
1.11203257018000e-16*I - 0.234061528187000
sage: bessel_J(10,10,"scipy")
0.207486106633000 - 1.17732704470000e-16*I
sage: bessel_J(10,20,"scipy")
0.186482558024000 - 2.10019326787000e-16*I
```

Assignee: somebody

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/2223





---

archive/issue_comments_014697.json:
```json
{
    "body": "<a id='comment:1'></a>I assumed (stupdly) that ...e-(large) would be parsed as 0. I can replace all terms with\ne-(large) by 0.000... if that seems reasonable.",
    "created_at": "2008-02-20T11:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14697",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:1'></a>I assumed (stupdly) that ...e-(large) would be parsed as 0. I can replace all terms with
e-(large) by 0.000... if that seems reasonable.



---

archive/issue_comments_014698.json:
```json
{
    "body": "<a id='comment:2'></a>More precisely: I can replace all terms with e-(large)*I by \n(a) \"0.000...*I\" (to indicate that the user might get a small number returned from scipy) or \n(b) \"0.0*I\" or \n(c) nothing (as William stated), \nwhichever seems more reasonable.",
    "created_at": "2008-02-20T11:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14698",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:2'></a>More precisely: I can replace all terms with e-(large)*I by 
(a) "0.000...*I" (to indicate that the user might get a small number returned from scipy) or 
(b) "0.0*I" or 
(c) nothing (as William stated), 
whichever seems more reasonable.



---

archive/issue_comments_014699.json:
```json
{
    "body": "Attachment [8632.patch](tarball://root/attachments/some-uuid/ticket2223/8632.patch) by @wdjoyner created at 2008-02-20 23:58:29",
    "created_at": "2008-02-20T23:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14699",
    "user": "https://github.com/wdjoyner"
}
```

Attachment [8632.patch](tarball://root/attachments/some-uuid/ticket2223/8632.patch) by @wdjoyner created at 2008-02-20 23:58:29



---

archive/issue_comments_014700.json:
```json
{
    "body": "<a id='comment:3'></a>The attached patch fixes the problem referred to above. It replaces *e-(large)*I by nothing in the docstring. Paases sage -t. sage -testall has lots of failures, but none seem related to this patch.",
    "created_at": "2008-02-21T00:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14700",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:3'></a>The attached patch fixes the problem referred to above. It replaces *e-(large)*I by nothing in the docstring. Paases sage -t. sage -testall has lots of failures, but none seem related to this patch.



---

archive/issue_comments_014701.json:
```json
{
    "body": "<a id='comment:4'></a>David, the patch you posted only removes one space. You probably need to export at least one commit prior to that.\n\nCheers,\n\nMichael",
    "created_at": "2008-02-21T00:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14701",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>David, the patch you posted only removes one space. You probably need to export at least one commit prior to that.

Cheers,

Michael



---

archive/issue_comments_014702.json:
```json
{
    "body": "<a id='comment:5'></a>Sorry. I don't know what I did wrong. I thin this new patch is better.",
    "created_at": "2008-02-21T01:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14702",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:5'></a>Sorry. I don't know what I did wrong. I thin this new patch is better.



---

archive/issue_comments_014703.json:
```json
{
    "body": "<a id='comment:6'></a>Attachment [8631.patch](tarball://root/attachments/some-uuid/ticket2223/8631.patch) by mabshoff created at 2008-02-21 19:35:51\n\nWilliam's pat",
    "created_at": "2008-02-21T19:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14703",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>Attachment [8631.patch](tarball://root/attachments/some-uuid/ticket2223/8631.patch) by mabshoff created at 2008-02-21 19:35:51

William's pat



---

archive/issue_comments_014704.json:
```json
{
    "body": "<a id='comment:8'></a>As is the patch doesn't apply:\n\n```\nsage$ patch -p1 --dry-run < trac_2223.patch\npatching file sage/functions/special.py\nHunk #1 FAILED at 5.\nHunk #2 succeeded at 500 (offset 7 lines).\nHunk #3 FAILED at 514.\nHunk #4 succeeded at 537 with fuzz 2 (offset 10 lines).\n2 out of 4 hunks FAILED -- saving rejects to file sage/functions/special.py.rej\n```\nI guess the only important hunk is the third one, so I will probably merge that one manually.\n\nCheers,\n\nMichael",
    "created_at": "2008-02-22T01:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14704",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:8'></a>As is the patch doesn't apply:

```
sage$ patch -p1 --dry-run < trac_2223.patch
patching file sage/functions/special.py
Hunk #1 FAILED at 5.
Hunk #2 succeeded at 500 (offset 7 lines).
Hunk #3 FAILED at 514.
Hunk #4 succeeded at 537 with fuzz 2 (offset 10 lines).
2 out of 4 hunks FAILED -- saving rejects to file sage/functions/special.py.rej
```
I guess the only important hunk is the third one, so I will probably merge that one manually.

Cheers,

Michael



---

archive/issue_events_005304.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-22T01:06:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2223#event-5304"
}
```



---

archive/issue_comments_014705.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2008-02-22T01:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14705",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_comments_014706.json:
```json
{
    "body": "<a id='comment:9'></a>Merged hunk 3 manually in Sage 2.10.2.rc0",
    "created_at": "2008-02-22T01:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2223#issuecomment-14706",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:9'></a>Merged hunk 3 manually in Sage 2.10.2.rc0
