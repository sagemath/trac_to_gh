# Issue 2516: generalized hypergeometric functions should be implemented

archive/issues_002516.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-cwitty"
    ],
    "body": "Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.\n\n\nCC:  @burcin @sagetrac-fstan @kcrisman @sagetrac-ktkohl @benjaminfjones @sagetrac-dsm @eviatarbach @mezzarobba\n\nKeywords: **hypergeometric, special**\n\nBranch: **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**\n\nReviewer: **Ralf Stephan, Nils Bruin, Volker Braun**\n\nAuthor: **Fredrik Johansson, Eviatar Bach, Ralf Stephan**\n\nComponent: **symbolics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/2516_\n\n",
    "closed_at": "2014-07-08T18:51:55Z",
    "created_at": "2008-03-14T09:55:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "generalized hypergeometric functions should be implemented",
    "type": "issue",
    "updated_at": "2017-06-07T13:27:45Z",
    "url": "https://github.com/sagemath/sage/issues/2516",
    "user": "https://github.com/dandrake"
}
```
Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.


CC:  @burcin @sagetrac-fstan @kcrisman @sagetrac-ktkohl @benjaminfjones @sagetrac-dsm @eviatarbach @mezzarobba

Keywords: **hypergeometric, special**

Branch: **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**

Reviewer: **Ralf Stephan, Nils Bruin, Volker Braun**

Author: **Fredrik Johansson, Eviatar Bach, Ralf Stephan**

Component: **symbolics**

_Issue created by migration from https://trac.sagemath.org/ticket/2516_





---

archive/issue_events_026116.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2008-03-14T09:55:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26116"
}
```



---

archive/issue_events_026117.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2008-03-14T09:55:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26117"
}
```



---

archive/issue_events_026118.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2008-03-14T09:55:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26118"
}
```



---

archive/issue_events_026119.json:
```json
{
    "actor": "https://github.com/sagetrac-cwitty",
    "created_at": "2008-03-14T09:55:34Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "subject": "https://github.com/dandrake",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26119"
}
```



---

archive/issue_comments_012793.json:
```json
{
    "body": "Attachment: **[hyper.patch.gz](https://github.com/sagemath/sage/files/ticket2516/hyper.patch.gz)**\n\ntentative implementation of generalized hypergeometric functions",
    "created_at": "2010-07-26T03:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12793",
    "user": "https://github.com/fredrik-johansson"
}
```

Attachment: **[hyper.patch.gz](https://github.com/sagemath/sage/files/ticket2516/hyper.patch.gz)**

tentative implementation of generalized hypergeometric functions



---

archive/issue_comments_012794.json:
```json
{
    "body": "Author: **fredrik.johansson**",
    "created_at": "2010-07-26T03:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12794",
    "user": "https://github.com/fredrik-johansson"
}
```

Author: **fredrik.johansson**



---

archive/issue_events_026120.json:
```json
{
    "actor": "https://github.com/fredrik-johansson",
    "created_at": "2010-07-26T03:35:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26120"
}
```



---

archive/issue_comments_012795.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI've attached essentially the code I wrote during with Sage Days 24 with some additions. Features include:\n\n* Representation of PFQs as symbolic functions (with automatic simplification) and in always-unevaluated form\n\n* Numerical evaluation (wrapping mpmath)\n\n* Evaluation in terms of elementary functions in some simple cases\n\nImportant missing features include:\n\n* Rewriting symbolic sums as PFQs\n\n* Evaluation in terms of polygamma functions\n\n* Various transformations permitting closed-form evaluation in special cases\n\nThe patch includes symbolic versions of Bessel functions, which can be expanded as PFQs. This obviously needs to be merged with the existing Bessel function classes.\n\nThe main remaining issue is to handle multivariate symbolic functions properly (the current approach in Function_PFQ is something of a hack). Also, in the present patch, there are two PFQ classes. This is partially due to limitations/awkwardness of the symbolic function class, but regardless of whether necessary, it may be desirable to have a separate \"backend\" representation for hypergeometric functions that doesn't need to be concerned with automatic evaluation, numerical conversions, etc. I'm not sure what's the best way to organize it all.",
    "created_at": "2010-07-26T03:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12795",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:1" align="right">comment:1</div>

I've attached essentially the code I wrote during with Sage Days 24 with some additions. Features include:

* Representation of PFQs as symbolic functions (with automatic simplification) and in always-unevaluated form

* Numerical evaluation (wrapping mpmath)

* Evaluation in terms of elementary functions in some simple cases

Important missing features include:

* Rewriting symbolic sums as PFQs

* Evaluation in terms of polygamma functions

* Various transformations permitting closed-form evaluation in special cases

The patch includes symbolic versions of Bessel functions, which can be expanded as PFQs. This obviously needs to be merged with the existing Bessel function classes.

The main remaining issue is to handle multivariate symbolic functions properly (the current approach in Function_PFQ is something of a hack). Also, in the present patch, there are two PFQ classes. This is partially due to limitations/awkwardness of the symbolic function class, but regardless of whether necessary, it may be desirable to have a separate "backend" representation for hypergeometric functions that doesn't need to be concerned with automatic evaluation, numerical conversions, etc. I'm not sure what's the best way to organize it all.



---

archive/issue_comments_012796.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSee also #9908, which is at least related (we need to translate Maxima hg functions).\n\nAlso, I think that we already have a lot of Bessel functions implemented, though they are not yet symbolic.",
    "created_at": "2011-02-17T01:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12796",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:3" align="right">comment:3</div>

See also #9908, which is at least related (we need to translate Maxima hg functions).

Also, I think that we already have a lot of Bessel functions implemented, though they are not yet symbolic.



---

archive/issue_comments_012797.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nChanging component.  But this is a really nice start, hopefully can be combined with some of the currently existing bessel stuff etc.",
    "created_at": "2012-05-26T19:14:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12797",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:5" align="right">comment:5</div>

Changing component.  But this is a really nice start, hopefully can be combined with some of the currently existing bessel stuff etc.



---

archive/issue_events_026121.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-05-26T19:14:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26121"
}
```



---

archive/issue_comments_012798.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOkay, I'm going to see what can be done to get this merged.",
    "created_at": "2012-05-26T19:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12798",
    "user": "https://github.com/sagetrac-dsm"
}
```

<div id="comment:7" align="right">comment:7</div>

Okay, I'm going to see what can be done to get this merged.



---

archive/issue_comments_012799.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHaving played around with this some, I think it'll be pretty straightforward to get in.. *after* we have Burcin's ticket allowing numerical_approx to take more general kwargs.  If it weren't for the need to maintain backward compatibility with the algorithm kwarg for the old bessel functions, life would be easier.\n\nI have a half-functional wrapper which monkeypatches things to sort of get them to work, but once that patch gets in it becomes much simpler.  So I think this should stay in a holding pattern until we get that one in.",
    "created_at": "2012-05-26T22:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12799",
    "user": "https://github.com/sagetrac-dsm"
}
```

<div id="comment:8" align="right">comment:8</div>

Having played around with this some, I think it'll be pretty straightforward to get in.. *after* we have Burcin's ticket allowing numerical_approx to take more general kwargs.  If it weren't for the need to maintain backward compatibility with the algorithm kwarg for the old bessel functions, life would be easier.

I have a half-functional wrapper which monkeypatches things to sort of get them to work, but once that patch gets in it becomes much simpler.  So I think this should stay in a holding pattern until we get that one in.



---

archive/issue_comments_012800.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n> If it weren't for the need to maintain backward compatibility with the algorithm kwarg for the old bessel functions, life would be easier.\n\nSince #4102 is nearly finished, and has at least sort of dealt with this issue, perhaps one can just ignore that part of the Bessel issue.  Instead, one could just add the `_expand_hyper` methods to the stuff there.  I do like the idea here and it would be a shame for it to bit rot further...",
    "created_at": "2013-04-25T02:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12800",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:9" align="right">comment:9</div>

> If it weren't for the need to maintain backward compatibility with the algorithm kwarg for the old bessel functions, life would be easier.

Since #4102 is nearly finished, and has at least sort of dealt with this issue, perhaps one can just ignore that part of the Bessel issue.  Instead, one could just add the `_expand_hyper` methods to the stuff there.  I do like the idea here and it would be a shame for it to bit rot further...



---

archive/issue_comments_012801.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere is an initial version of an updated patch. It needs some work because it's failing a few tests, but I just wanted to post for comments.",
    "created_at": "2013-07-05T11:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12801",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:12" align="right">comment:12</div>

Here is an initial version of an updated patch. It needs some work because it's failing a few tests, but I just wanted to post for comments.



---

archive/issue_comments_012802.json:
```json
{
    "body": "Attachment: **[hyper3.patch.gz](https://github.com/sagemath/sage/files/ticket2516/hyper3.patch.gz)**",
    "created_at": "2013-07-05T11:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12802",
    "user": "https://github.com/eviatarbach"
}
```

Attachment: **[hyper3.patch.gz](https://github.com/sagemath/sage/files/ticket2516/hyper3.patch.gz)**



---

archive/issue_comments_012803.json:
```json
{
    "body": "Dependencies: **14780 9556 14802**",
    "created_at": "2013-07-05T18:42:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12803",
    "user": "https://github.com/eviatarbach"
}
```

Dependencies: **14780 9556 14802**



---

archive/issue_comments_012804.json:
```json
{
    "body": "Changed dependencies from **14780 9556 14802** to **#14780 #9556 #14802**",
    "created_at": "2013-07-05T18:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12804",
    "user": "https://github.com/eviatarbach"
}
```

Changed dependencies from **14780 9556 14802** to **#14780 #9556 #14802**



---

archive/issue_comments_012805.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nTwo of the failing doctests are caused by #14858.",
    "created_at": "2013-07-05T20:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12805",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:15" align="right">comment:15</div>

Two of the failing doctests are caused by #14858.



---

archive/issue_comments_012806.json:
```json
{
    "body": "Changed dependencies from **#14780 #9556 #14802** to **#14858 #14780 #9556 #14802**",
    "created_at": "2013-07-09T18:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12806",
    "user": "https://github.com/eviatarbach"
}
```

Changed dependencies from **#14780 #9556 #14802** to **#14858 #14780 #9556 #14802**



---

archive/issue_events_026122.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-07-14T02:48:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26122"
}
```



---

archive/issue_events_026123.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-07-14T02:48:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26123"
}
```



---

archive/issue_comments_012807.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nPlotting is now working fine (with the approach from #14801, thanks Volker!), except for getting deprecation warnings about using unnamed function parameters, which I have not been able to debug. Does anyone know how to fix this?\n\nAnother strange doctest failure is the one in `_fast_callable_`; when I run it from interactive mode I get `{CommutativeRings.element_class}(v_0)`, but the doctest returns `{Fields.element_class}(v_0)`. Why is that?\n\nOther than that the patch should be ready for review.",
    "created_at": "2013-07-14T02:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12807",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:17" align="right">comment:17</div>

Plotting is now working fine (with the approach from #14801, thanks Volker!), except for getting deprecation warnings about using unnamed function parameters, which I have not been able to debug. Does anyone know how to fix this?

Another strange doctest failure is the one in `_fast_callable_`; when I run it from interactive mode I get `{CommutativeRings.element_class}(v_0)`, but the doctest returns `{Fields.element_class}(v_0)`. Why is that?

Other than that the patch should be ready for review.



---

archive/issue_comments_012808.json:
```json
{
    "body": "Attachment: **[trac_2516.patch.gz](https://github.com/sagemath/sage/files/ticket2516/trac_2516.patch.gz)**",
    "created_at": "2013-07-14T02:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12808",
    "user": "https://github.com/eviatarbach"
}
```

Attachment: **[trac_2516.patch.gz](https://github.com/sagemath/sage/files/ticket2516/trac_2516.patch.gz)**



---

archive/issue_comments_012809.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.\n+\n+For reviewers:\n+\n+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516.patch`.\n``````\n",
    "created_at": "2013-07-14T02:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12809",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.
+
+For reviewers:
+
+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516.patch`.
``````




---

archive/issue_comments_012810.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n For reviewers:\n \n-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516.patch`.\n+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516_2.patch`.\n``````\n",
    "created_at": "2013-07-15T03:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12810",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 For reviewers:
 
-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516.patch`.
+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516_2.patch`.
``````




---

archive/issue_comments_012811.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nNew patch fixes a circular import issue which caused a problem with numerical evaluation; see #13028.",
    "created_at": "2013-07-15T03:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12811",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:19" align="right">comment:19</div>

New patch fixes a circular import issue which caused a problem with numerical evaluation; see #13028.



---

archive/issue_comments_012812.json:
```json
{
    "body": "Attachment: **[trac_2516_2.patch.gz](https://github.com/sagemath/sage/files/ticket2516/trac_2516_2.patch.gz)**",
    "created_at": "2013-07-15T03:08:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12812",
    "user": "https://github.com/eviatarbach"
}
```

Attachment: **[trac_2516_2.patch.gz](https://github.com/sagemath/sage/files/ticket2516/trac_2516_2.patch.gz)**



---

archive/issue_comments_012813.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n For reviewers:\n \n-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516_2.patch`.\n+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.\n``````\n",
    "created_at": "2013-07-24T22:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12813",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 For reviewers:
 
-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), and then `trac_2516_2.patch`.
+Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.
``````




---

archive/issue_comments_012814.json:
```json
{
    "body": "Changed keywords from none to **hypergeometric**",
    "created_at": "2014-03-06T17:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12814",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from none to **hypergeometric**



---

archive/issue_comments_012815.json:
```json
{
    "body": "Branch: **[u/rws/generalized_hypergeometric_functions_should_be_implemented](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/generalized_hypergeometric_functions_should_be_implemented)**",
    "created_at": "2014-04-10T12:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12815",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/generalized_hypergeometric_functions_should_be_implemented](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/generalized_hypergeometric_functions_should_be_implemented)**



---

archive/issue_comments_012816.json:
```json
{
    "body": "Changed author from **fredrik.johansson** to **Fredrik Johansson, Burcin Erocal, Ralf Stephan**",
    "created_at": "2014-04-10T12:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12816",
    "user": "https://github.com/rwst"
}
```

Changed author from **fredrik.johansson** to **Fredrik Johansson, Burcin Erocal, Ralf Stephan**



---

archive/issue_comments_012817.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nRebased on 6.2.beta7. The branch includes the (already merged) #14802. I fixed some but not all doctests.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b96659d6743e17ca15b84ea1ac79e466ce8bcb5\"><code>7b96659</code></a></td><td><code>14802</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/978f3138c31a430b2626e92e1fb1881ce23685ca\"><code>978f313</code></a></td><td><code>Trac 2516: generalized hypergeometric functions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e\"><code>9553ba9</code></a></td><td><code>Trac 2516: fix some doctests, typos</code></td></tr></table>\n",
    "created_at": "2014-04-10T12:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12817",
    "user": "https://github.com/rwst"
}
```

<div id="comment:23" align="right">comment:23</div>

Rebased on 6.2.beta7. The branch includes the (already merged) #14802. I fixed some but not all doctests.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b96659d6743e17ca15b84ea1ac79e466ce8bcb5"><code>7b96659</code></a></td><td><code>14802</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/978f3138c31a430b2626e92e1fb1881ce23685ca"><code>978f313</code></a></td><td><code>Trac 2516: generalized hypergeometric functions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e"><code>9553ba9</code></a></td><td><code>Trac 2516: fix some doctests, typos</code></td></tr></table>




---

archive/issue_events_026124.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26124"
}
```



---

archive/issue_events_026125.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26125"
}
```



---

archive/issue_events_026126.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26126"
}
```



---

archive/issue_events_026127.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26127"
}
```



---

archive/issue_comments_012818.json:
```json
{
    "body": "Commit: **[`9553ba9`](https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e)**",
    "created_at": "2014-04-10T12:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12818",
    "user": "https://github.com/rwst"
}
```

Commit: **[`9553ba9`](https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e)**



---

archive/issue_events_026128.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26128"
}
```



---

archive/issue_events_026129.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-10T12:54:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26129"
}
```



---

archive/issue_comments_012819.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThree of the remaining doctest errors come from:\n\n```\nsage: f=fast_callable(hypergeometric([x], [], 2),domain=CDF,expect_one_var=True)\nsage: f(8)\n/home/ralf/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py:2834: DeprecationWarning: Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\nSee http://trac.sagemath.org/5930 for details.\n  exec code_obj in self.user_global_ns, self.user_ns\n1.0\nsage: f(x=8)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-499d03e2f57c> in <module>()\n----> 1 f(x=Integer(8))\n\nTypeError: __call__() got an unexpected keyword argument 'x'\n```\nThe deprecation warning is triggered in `plot()` and `complex_plot()` with hypergeometric argument. I'm unsure where exactly the problem is. At the least `fast_callable()` should behave consistently when given a named parameter, and if there is a problem in `hypergeometric`, `fast_callable()` should give the right warning. So, maybe a separate ticket for this is necessary.",
    "created_at": "2014-04-11T08:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12819",
    "user": "https://github.com/rwst"
}
```

<div id="comment:25" align="right">comment:25</div>

Three of the remaining doctest errors come from:

```
sage: f=fast_callable(hypergeometric([x], [], 2),domain=CDF,expect_one_var=True)
sage: f(8)
/home/ralf/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py:2834: DeprecationWarning: Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)
See http://trac.sagemath.org/5930 for details.
  exec code_obj in self.user_global_ns, self.user_ns
1.0
sage: f(x=8)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-499d03e2f57c> in <module>()
----> 1 f(x=Integer(8))

TypeError: __call__() got an unexpected keyword argument 'x'
```
The deprecation warning is triggered in `plot()` and `complex_plot()` with hypergeometric argument. I'm unsure where exactly the problem is. At the least `fast_callable()` should behave consistently when given a named parameter, and if there is a problem in `hypergeometric`, `fast_callable()` should give the right warning. So, maybe a separate ticket for this is necessary.



---

archive/issue_comments_012820.json:
```json
{
    "body": "Reviewer: **Ralf Stephan**",
    "created_at": "2014-04-11T09:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12820",
    "user": "https://github.com/eviatarbach"
}
```

Reviewer: **Ralf Stephan**



---

archive/issue_comments_012821.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThanks for working on this!\n\nI believe you set the incorrect authors though.",
    "created_at": "2014-04-11T09:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12821",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:26" align="right">comment:26</div>

Thanks for working on this!

I believe you set the incorrect authors though.



---

archive/issue_comments_012822.json:
```json
{
    "body": "Changed author from **Fredrik Johansson, Burcin Erocal, Ralf Stephan** to **Fredrik Johansson, Eviatar Bach, Ralf Stephan**",
    "created_at": "2014-04-11T09:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12822",
    "user": "https://github.com/eviatarbach"
}
```

Changed author from **Fredrik Johansson, Burcin Erocal, Ralf Stephan** to **Fredrik Johansson, Eviatar Bach, Ralf Stephan**



---

archive/issue_comments_012823.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI got the plotting problem before too, see comment 17. It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.",
    "created_at": "2014-04-11T09:08:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12823",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:27" align="right">comment:27</div>

I got the plotting problem before too, see comment 17. It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.



---

archive/issue_comments_012824.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@eviatarbach](#comment:26):\n> I believe you set the incorrect authors though.\n\nOops, sorry.\n> I got the plotting problem before too, see comment 17. It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.\n\n`exp_integral_e()` is a `BuiltinFunction` too, and needs two parameters but\n\n```\nsage: f=fast_callable(exp_integral_e(x,1),domain=CDF,expect_one_var=True)\nsage: f(8)\n0.0452114820619\nsage: f=fast_callable(hypergeometric([x], [], y),domain=CDF,vars=[x,y])\nsage: f(8,9)\n5.96046447754e-08\nsage: f=fast_callable(hypergeometric([x], [], 2),domain=CDF,vars=[x])\nsage: f(8)\n1.0\n```\nso I changed \n\n```\n        f = fast_callable(f, domain=CDF, expect_one_var=TRUE)\n```\nto\n\n```\n        f = fast_callable(f, domain=CDF, vars=[x])\n```\nin `complex_plot()`. Now the one var case works but not the two etc. So it seems the handling of `expect_one_var` in `fast_callable()` is wrong, as I already said.",
    "created_at": "2014-04-11T09:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12824",
    "user": "https://github.com/rwst"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@eviatarbach](#comment:26):
> I believe you set the incorrect authors though.

Oops, sorry.
> I got the plotting problem before too, see comment 17. It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.

`exp_integral_e()` is a `BuiltinFunction` too, and needs two parameters but

```
sage: f=fast_callable(exp_integral_e(x,1),domain=CDF,expect_one_var=True)
sage: f(8)
0.0452114820619
sage: f=fast_callable(hypergeometric([x], [], y),domain=CDF,vars=[x,y])
sage: f(8,9)
5.96046447754e-08
sage: f=fast_callable(hypergeometric([x], [], 2),domain=CDF,vars=[x])
sage: f(8)
1.0
```
so I changed 

```
        f = fast_callable(f, domain=CDF, expect_one_var=TRUE)
```
to

```
        f = fast_callable(f, domain=CDF, vars=[x])
```
in `complex_plot()`. Now the one var case works but not the two etc. So it seems the handling of `expect_one_var` in `fast_callable()` is wrong, as I already said.



---

archive/issue_comments_012825.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nForget all what I wrote. The deprecation warning is only printed once per session, which makes my conclusions arbitrary.",
    "created_at": "2014-04-11T14:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12825",
    "user": "https://github.com/rwst"
}
```

<div id="comment:29" align="right">comment:29</div>

Forget all what I wrote. The deprecation warning is only printed once per session, which makes my conclusions arbitrary.



---

archive/issue_comments_012826.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@eviatarbach](#comment:17):\n> It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.\n\nWhat's certain is that `Wrapper_cdf.__call__()` gets the same arguments as with other working examples but that `SR._call_element_()` gets called where the deprecation warning happens while with `exp_integral_e(x,1)` its `_eval_()` is called directly.\n> Another strange doctest failure is the one in `_fast_callable_`; when I run it from interactive mode I get `{CommutativeRings.element_class}(v_0)`, but the doctest returns `{Fields.element_class}(v_0)`. Why is that?\n\nInterestingly if use `h=exp_integral_e(x,1)` in the same doctest, I get\n\n```\nsage: h._fast_callable_(etb)\n{exp_integral_e}(v_0, 1)\n```\nSo why is it not `hypergeometric(None, None, v_0)` or similar in the doctest?",
    "created_at": "2014-04-12T09:15:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12826",
    "user": "https://github.com/rwst"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@eviatarbach](#comment:17):
> It's something in the `fast_callable` implementation if I recall correctly, but I couldn't figure out how to fix it at the time.

What's certain is that `Wrapper_cdf.__call__()` gets the same arguments as with other working examples but that `SR._call_element_()` gets called where the deprecation warning happens while with `exp_integral_e(x,1)` its `_eval_()` is called directly.
> Another strange doctest failure is the one in `_fast_callable_`; when I run it from interactive mode I get `{CommutativeRings.element_class}(v_0)`, but the doctest returns `{Fields.element_class}(v_0)`. Why is that?

Interestingly if use `h=exp_integral_e(x,1)` in the same doctest, I get

```
sage: h._fast_callable_(etb)
{exp_integral_e}(v_0, 1)
```
So why is it not `hypergeometric(None, None, v_0)` or similar in the doctest?



---

archive/issue_comments_012827.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299\"><code>5a415fb</code></a></td><td><code>Trac 2516: further doctest fixes</code></td></tr></table>\n",
    "created_at": "2014-04-12T15:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12827",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299"><code>5a415fb</code></a></td><td><code>Trac 2516: further doctest fixes</code></td></tr></table>




---

archive/issue_comments_012828.json:
```json
{
    "body": "Changed commit from **[`9553ba9`](https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e)** to **[`5a415fb`](https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299)**",
    "created_at": "2014-04-12T15:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12828",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9553ba9`](https://github.com/sagemath/sagetrac-mirror/commit/9553ba95b5a901428f1b191bb92232038b68c50e)** to **[`5a415fb`](https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299)**



---

archive/issue_comments_012829.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThis fixes all except the one in `_fast_callable_` and two others I haven't looked closely at. Specifically, I resolved the deprecation warning by excluding dynamic classes from this warning.",
    "created_at": "2014-04-12T15:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12829",
    "user": "https://github.com/rwst"
}
```

<div id="comment:32" align="right">comment:32</div>

This fixes all except the one in `_fast_callable_` and two others I haven't looked closely at. Specifically, I resolved the deprecation warning by excluding dynamic classes from this warning.



---

archive/issue_comments_012830.json:
```json
{
    "body": "Changed commit from **[`5a415fb`](https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299)** to **[`ebe4c6a`](https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4)**",
    "created_at": "2014-04-13T14:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12830",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5a415fb`](https://github.com/sagemath/sagetrac-mirror/commit/5a415fb8ced74dbb579f3e18fff0e2605778e299)** to **[`ebe4c6a`](https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4)**



---

archive/issue_comments_012831.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4\"><code>ebe4c6a</code></a></td><td><code>2516: fix doctests</code></td></tr></table>\n",
    "created_at": "2014-04-13T14:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12831",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4"><code>ebe4c6a</code></a></td><td><code>2516: fix doctests</code></td></tr></table>




---

archive/issue_comments_012832.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nFixed all doctests. Please review. I had to exclude the hypergeometric function from random symbolic tests as that code blindly applies real numbers as parameters, and I didn't want to add `try: ... except ValueError: pass` there.",
    "created_at": "2014-04-13T14:45:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12832",
    "user": "https://github.com/rwst"
}
```

<div id="comment:34" align="right">comment:34</div>

Fixed all doctests. Please review. I had to exclude the hypergeometric function from random symbolic tests as that code blindly applies real numbers as parameters, and I didn't want to add `try: ... except ValueError: pass` there.



---

archive/issue_events_026130.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-13T14:45:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26130"
}
```



---

archive/issue_events_026131.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-04-13T14:45:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26131"
}
```



---

archive/issue_comments_012833.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nExcellent work! I wasn't able to checkout the branch here for testing, but I noticed one thing for the maxima_lib interfacing:\n- You are installing an extra rule in `mqapply_to_sage`, which I assume is correct. This rule registered in the special_max_to_sage dictionary: Great! that's what you're supposed to do\n- However, for conversion back, there should be a corresponding entry in special_sage_to_max as well, and you're not adding that. You'd have to test, but from the rule in the other direction, I'd guess it should be something like:\n\n```\nsage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]\n```\nwhere\n\n```\nlisp_length=EclObject('length')\n```\n\nIf you don't put this rule in place, you'll find that things like \"limit\", \"integral\" and \"sum\" (which use `sr_to_max`) will probably not work correctly with hypergeometric function. (in fact, I'm not so sure maxima has much support for them anyway, but at least we should make sure that the functions can survive a round-trip)\n\nAnother bit: the addition to `sr_to_max`\n\n```\n+ elif op == tuple:\n+     return maxima(expr.operands()).ecl()\n```\nshould read\n\n```\n+ elif op == tuple:\n+     return EclObject( ([mlist],(sr_to_max(op) for op in expr.operands())) )\n```\nif a \"symbolic tuple\" should indeed be translated into a maxima list.\n\n(the branch attached to this ticket currently doesn't build to a usable executable for me. I'm having some libntl conflict)",
    "created_at": "2014-04-13T19:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12833",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:35" align="right">comment:35</div>

Excellent work! I wasn't able to checkout the branch here for testing, but I noticed one thing for the maxima_lib interfacing:
- You are installing an extra rule in `mqapply_to_sage`, which I assume is correct. This rule registered in the special_max_to_sage dictionary: Great! that's what you're supposed to do
- However, for conversion back, there should be a corresponding entry in special_sage_to_max as well, and you're not adding that. You'd have to test, but from the rule in the other direction, I'd guess it should be something like:

```
sage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]
```
where

```
lisp_length=EclObject('length')
```

If you don't put this rule in place, you'll find that things like "limit", "integral" and "sum" (which use `sr_to_max`) will probably not work correctly with hypergeometric function. (in fact, I'm not so sure maxima has much support for them anyway, but at least we should make sure that the functions can survive a round-trip)

Another bit: the addition to `sr_to_max`

```
+ elif op == tuple:
+     return maxima(expr.operands()).ecl()
```
should read

```
+ elif op == tuple:
+     return EclObject( ([mlist],(sr_to_max(op) for op in expr.operands())) )
```
if a "symbolic tuple" should indeed be translated into a maxima list.

(the branch attached to this ticket currently doesn't build to a usable executable for me. I'm having some libntl conflict)



---

archive/issue_comments_012834.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nI found this suspicious (it's in the implementation of the `_fast_callable_` method\n\n```\n+ self.__name__ = self.__repr__() # was clobbered by category mechanics\n+ return etb.call(self, *map(etb.var, etb._vars))\n```\nOne shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code! Is it clear what code depends on the `__name__` being identical to `__repr__`? Can we solve this issue (cheaply) during `__init__`, or perhaps avoid the clobbering altogether?",
    "created_at": "2014-04-14T02:10:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12834",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:36" align="right">comment:36</div>

I found this suspicious (it's in the implementation of the `_fast_callable_` method

```
+ self.__name__ = self.__repr__() # was clobbered by category mechanics
+ return etb.call(self, *map(etb.var, etb._vars))
```
One shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code! Is it clear what code depends on the `__name__` being identical to `__repr__`? Can we solve this issue (cheaply) during `__init__`, or perhaps avoid the clobbering altogether?



---

archive/issue_comments_012835.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@nbruin](#comment:36):\n> One shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code!\n\nDo you have a reference for that?\n> Is it clear what code depends on the `__name__` being identical to `__repr__`?\n\nIt fixes the issue mentioned above where the doctest gets different output than interactive Sage. The first doctest in `_fast_callable_`.\n> Can we solve this issue (cheaply) during `__init__`.\n\nNope it happens after `__init__`\n> or perhaps avoid the clobbering altogether?\n\nIt is a consequence of `hypergeometric` being a SE with tuples as parameter. In the`Expression` constructor the class gets changed using `dynamic_class()` and this appears to be responsible.\n\nOverall, all long tests pass and I see no reason to hold this old ticket any longer.",
    "created_at": "2014-04-14T03:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12835",
    "user": "https://github.com/rwst"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@nbruin](#comment:36):
> One shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code!

Do you have a reference for that?
> Is it clear what code depends on the `__name__` being identical to `__repr__`?

It fixes the issue mentioned above where the doctest gets different output than interactive Sage. The first doctest in `_fast_callable_`.
> Can we solve this issue (cheaply) during `__init__`.

Nope it happens after `__init__`
> or perhaps avoid the clobbering altogether?

It is a consequence of `hypergeometric` being a SE with tuples as parameter. In the`Expression` constructor the class gets changed using `dynamic_class()` and this appears to be responsible.

Overall, all long tests pass and I see no reason to hold this old ticket any longer.



---

archive/issue_comments_012836.json:
```json
{
    "body": "Changed dependencies from **#14858 #14780 #9556 #14802** to none",
    "created_at": "2014-04-14T03:57:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12836",
    "user": "https://github.com/nbruin"
}
```

Changed dependencies from **#14858 #14780 #9556 #14802** to none



---

archive/issue_comments_012837.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@rwst](#comment:37):\n> Replying to [@nbruin](#comment:36):\n> > One shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code!\n\n> Do you have a reference for that?\n\nWell, you can look it up. Python uses `__name__` for any \"named\" object (e.g., defined by a `def` or a `class` or modules). These things aren't supposed to change (they are used for introspection). The fact that it does (and that that matters!) points to either a flaw in the category system or in the way it is used here.\n\n> It is a consequence of `hypergeometric` being a SE with tuples as parameter. In the`Expression` constructor the class gets changed using `dynamic_class()` and this appears to be responsible.\n\n> Overall, all long tests pass and I see no reason to hold this old ticket any longer.\n\nThe issues around `sr_to_max` should be fixed (and that's straightforward).",
    "created_at": "2014-04-14T05:34:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12837",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@rwst](#comment:37):
> Replying to [@nbruin](#comment:36):
> > One shouldn't touch the `__name__` attribute, and certainly not during arbitrary executing code!

> Do you have a reference for that?

Well, you can look it up. Python uses `__name__` for any "named" object (e.g., defined by a `def` or a `class` or modules). These things aren't supposed to change (they are used for introspection). The fact that it does (and that that matters!) points to either a flaw in the category system or in the way it is used here.

> It is a consequence of `hypergeometric` being a SE with tuples as parameter. In the`Expression` constructor the class gets changed using `dynamic_class()` and this appears to be responsible.

> Overall, all long tests pass and I see no reason to hold this old ticket any longer.

The issues around `sr_to_max` should be fixed (and that's straightforward).



---

archive/issue_comments_012838.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nOK, the problem is in `ext.fast_callable.function_name`, which gets called by `sage.ext.fast_callable.ExpressionCall.__repr__`. with as argument the \"function\" component of the ExpressionCall. The problem is: an expression doesn't have a `__name__`. So you end up finding a `__name__` somewhere higher in the inheritance. You just end up putting an extraneous attribute on the expression. To illustrate the nasty side-effect:\n\n```\nsage: h =  hypergeometric([],[],x)\nsage: h.__name__\n'CommutativeRings.element_class'\nsage: from sage.ext.fast_callable import ExpressionTreeBuilder\nsage: etb = ExpressionTreeBuilder(vars=['x'])\nsage: _ = h._fast_callable_(etb)\nsage: h.__name__\n'hypergeometric((), (), x)'\n```\nAs you see, `_fast_callable_` now has a side-effect on `h`! \n\nA better solution would be to adapt the routine `ext.fast_callable.function_name` (or the way it gets used). It's clear you're now feeding it things it wasn't designed for.",
    "created_at": "2014-04-14T06:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12838",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:40" align="right">comment:40</div>

OK, the problem is in `ext.fast_callable.function_name`, which gets called by `sage.ext.fast_callable.ExpressionCall.__repr__`. with as argument the "function" component of the ExpressionCall. The problem is: an expression doesn't have a `__name__`. So you end up finding a `__name__` somewhere higher in the inheritance. You just end up putting an extraneous attribute on the expression. To illustrate the nasty side-effect:

```
sage: h =  hypergeometric([],[],x)
sage: h.__name__
'CommutativeRings.element_class'
sage: from sage.ext.fast_callable import ExpressionTreeBuilder
sage: etb = ExpressionTreeBuilder(vars=['x'])
sage: _ = h._fast_callable_(etb)
sage: h.__name__
'hypergeometric((), (), x)'
```
As you see, `_fast_callable_` now has a side-effect on `h`! 

A better solution would be to adapt the routine `ext.fast_callable.function_name` (or the way it gets used). It's clear you're now feeding it things it wasn't designed for.



---

archive/issue_comments_012839.json:
```json
{
    "body": "Changed branch from **[u/rws/generalized_hypergeometric_functions_should_be_implemented](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/generalized_hypergeometric_functions_should_be_implemented)** to **[u/nbruin/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/ticket/2516)**",
    "created_at": "2014-04-14T06:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12839",
    "user": "https://github.com/nbruin"
}
```

Changed branch from **[u/rws/generalized_hypergeometric_functions_should_be_implemented](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/generalized_hypergeometric_functions_should_be_implemented)** to **[u/nbruin/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/ticket/2516)**



---

archive/issue_comments_012840.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThis should at least solve the maxima_lib translation problems.",
    "created_at": "2014-04-14T06:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12840",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:41" align="right">comment:41</div>

This should at least solve the maxima_lib translation problems.



---

archive/issue_comments_012841.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@nbruin](#comment:40):\n> A better solution would be to adapt the routine `ext.fast_callable.function_name` (or the way it gets used). It's clear you're now feeding it things it wasn't designed for.\n\nYes but how to distinguish such a 'dynamical' expression from `Expression`? The type displayed (`sage.functions.hypergeometric.Expression_with_dynamic_methods`) cannot be tested for directly. To do it right it should not be hypergeometric-specific either.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd\"><code>bc1d66e</code></a></td><td><code>trac 2516: fix maxima_lib to properly translate hypergeometric</code></td></tr></table>\n",
    "created_at": "2014-04-14T08:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12841",
    "user": "https://github.com/rwst"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@nbruin](#comment:40):
> A better solution would be to adapt the routine `ext.fast_callable.function_name` (or the way it gets used). It's clear you're now feeding it things it wasn't designed for.

Yes but how to distinguish such a 'dynamical' expression from `Expression`? The type displayed (`sage.functions.hypergeometric.Expression_with_dynamic_methods`) cannot be tested for directly. To do it right it should not be hypergeometric-specific either.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd"><code>bc1d66e</code></a></td><td><code>trac 2516: fix maxima_lib to properly translate hypergeometric</code></td></tr></table>




---

archive/issue_comments_012842.json:
```json
{
    "body": "Changed commit from **[`ebe4c6a`](https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4)** to **[`bc1d66e`](https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd)**",
    "created_at": "2014-04-14T08:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12842",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[`ebe4c6a`](https://github.com/sagemath/sagetrac-mirror/commit/ebe4c6a12c88cf6fdf0e7eb7b43bcfe05dcab8a4)** to **[`bc1d66e`](https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd)**



---

archive/issue_comments_012843.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nWhat about\n\n```\n+ if isinstance(fn, Expression) and str(type(fn)).find('Expression_with_dynamic_methods') >= 0:\n+     return \"{%r}\" % fn\n```\nAlternatively this seems to work too:\n\n```\n+ if isinstance(type(h),sage.structure.dynamic_class.DynamicMetaclass)\n+     return \"{%r}\" % fn\n```\nWouldn't one of these be safe enough?",
    "created_at": "2014-04-14T08:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12843",
    "user": "https://github.com/rwst"
}
```

<div id="comment:43" align="right">comment:43</div>

What about

```
+ if isinstance(fn, Expression) and str(type(fn)).find('Expression_with_dynamic_methods') >= 0:
+     return "{%r}" % fn
```
Alternatively this seems to work too:

```
+ if isinstance(type(h),sage.structure.dynamic_class.DynamicMetaclass)
+     return "{%r}" % fn
```
Wouldn't one of these be safe enough?



---

archive/issue_comments_012844.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@rwst](#comment:43):\n> Alternatively this seems to work too:\n> \n> ```\n> + if isinstance(type(h),sage.structure.dynamic_class.DynamicMetaclass)\n> +     return \"{%r}\" % fn\n> ```\n> Wouldn't one of these be safe enough?\n\nI think the distinction should be easier to make. I don't think `__name__` is reasonable on any expression. Compare:\n\n```\nsage: h = hypergeometric([], [], x)\nsage: s = sin(x)\nsage: from sage.ext.fast_callable import ExpressionTreeBuilder\nsage: etb = ExpressionTreeBuilder(vars=['x'])\nsage: v = h._fast_callable_(etb)\nsage: w = s._fast_callable_(etb)\nsage: type(v.function())\n<class 'sage.functions.hypergeometric.Expression_with_dynamic_methods'>\nsage: type(w.function())\n<class 'sage.functions.trig.Function_sin'>\n```\nAs you can see, with more traditional functions, there's a rather more dedicated object in the function slot, for which the `__name__` can be expected to be quite descriptive. For an expression, the `__name__` attribute, if there's something there at all (and that there is seems a side-effect of the dynamic classes. Normally, `__name__` doesn't descend to class instances), can't really be descriptive. Looking at how to tell them apart:\n\n```\nsage: type(v.function()).mro()\n[sage.functions.hypergeometric.Expression_with_dynamic_methods,\n sage.symbolic.expression.Expression,\n sage.structure.element.CommutativeRingElement,\n sage.structure.element.RingElement,\n sage.structure.element.ModuleElement,\n sage.structure.element.Element,\n sage.structure.sage_object.SageObject,\n object]\nsage: type(w.function()).mro()\n[sage.functions.trig.Function_sin,\n sage.symbolic.function.GinacFunction,\n sage.symbolic.function.BuiltinFunction,\n sage.symbolic.function.Function,\n sage.structure.sage_object.SageObject,\n object]\n```\nSo my guess is that you only need `isinstance(type(h), sage.symbolic.expression.Expression)`, no need to check for substrings. On the other hand, your `sage.structure.dynamic_class.DynamicMetaclass` seems to work too, even though that class doesn't show up in the mro!\n\nI think we're running into a break-down of ducktyping here: the code as written previously assumed that if a `__name__` attribute is present, then it's meaningful. This is apparently not true for some dynamic classes and makes me think that maybe this `__name__` attribute shouldn't be provided (wherever that happens).",
    "created_at": "2014-04-14T15:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12844",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@rwst](#comment:43):
> Alternatively this seems to work too:
> 
> ```
> + if isinstance(type(h),sage.structure.dynamic_class.DynamicMetaclass)
> +     return "{%r}" % fn
> ```
> Wouldn't one of these be safe enough?

I think the distinction should be easier to make. I don't think `__name__` is reasonable on any expression. Compare:

```
sage: h = hypergeometric([], [], x)
sage: s = sin(x)
sage: from sage.ext.fast_callable import ExpressionTreeBuilder
sage: etb = ExpressionTreeBuilder(vars=['x'])
sage: v = h._fast_callable_(etb)
sage: w = s._fast_callable_(etb)
sage: type(v.function())
<class 'sage.functions.hypergeometric.Expression_with_dynamic_methods'>
sage: type(w.function())
<class 'sage.functions.trig.Function_sin'>
```
As you can see, with more traditional functions, there's a rather more dedicated object in the function slot, for which the `__name__` can be expected to be quite descriptive. For an expression, the `__name__` attribute, if there's something there at all (and that there is seems a side-effect of the dynamic classes. Normally, `__name__` doesn't descend to class instances), can't really be descriptive. Looking at how to tell them apart:

```
sage: type(v.function()).mro()
[sage.functions.hypergeometric.Expression_with_dynamic_methods,
 sage.symbolic.expression.Expression,
 sage.structure.element.CommutativeRingElement,
 sage.structure.element.RingElement,
 sage.structure.element.ModuleElement,
 sage.structure.element.Element,
 sage.structure.sage_object.SageObject,
 object]
sage: type(w.function()).mro()
[sage.functions.trig.Function_sin,
 sage.symbolic.function.GinacFunction,
 sage.symbolic.function.BuiltinFunction,
 sage.symbolic.function.Function,
 sage.structure.sage_object.SageObject,
 object]
```
So my guess is that you only need `isinstance(type(h), sage.symbolic.expression.Expression)`, no need to check for substrings. On the other hand, your `sage.structure.dynamic_class.DynamicMetaclass` seems to work too, even though that class doesn't show up in the mro!

I think we're running into a break-down of ducktyping here: the code as written previously assumed that if a `__name__` attribute is present, then it's meaningful. This is apparently not true for some dynamic classes and makes me think that maybe this `__name__` attribute shouldn't be provided (wherever that happens).



---

archive/issue_comments_012845.json:
```json
{
    "body": "Changed commit from **[`bc1d66e`](https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd)** to **[`dfcc9b0`](https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910)**",
    "created_at": "2014-04-15T01:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12845",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bc1d66e`](https://github.com/sagemath/sagetrac-mirror/commit/bc1d66efab841c4670bc9e07f6b5c0e4a580e0dd)** to **[`dfcc9b0`](https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910)**



---

archive/issue_comments_012846.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910\"><code>dfcc9b0</code></a></td><td><code>fix \"SR tuple\" to \"maxima list\" conversion</code></td></tr></table>\n",
    "created_at": "2014-04-15T01:31:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12846",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910"><code>dfcc9b0</code></a></td><td><code>fix "SR tuple" to "maxima list" conversion</code></td></tr></table>




---

archive/issue_comments_012847.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nPlease rebase/merge.",
    "created_at": "2014-04-15T06:22:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12847",
    "user": "https://github.com/rwst"
}
```

<div id="comment:46" align="right">comment:46</div>

Please rebase/merge.



---

archive/issue_comments_012848.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2\"><code>b514b8b</code></a></td><td><code>Merge branch 'develop' into ticket/2516</code></td></tr></table>\n",
    "created_at": "2014-04-15T15:22:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12848",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2"><code>b514b8b</code></a></td><td><code>Merge branch 'develop' into ticket/2516</code></td></tr></table>




---

archive/issue_comments_012849.json:
```json
{
    "body": "Changed commit from **[`dfcc9b0`](https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910)** to **[`b514b8b`](https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2)**",
    "created_at": "2014-04-15T15:22:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12849",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dfcc9b0`](https://github.com/sagemath/sagetrac-mirror/commit/dfcc9b05c5ba39e8b24ebb135c265d1814ff3910)** to **[`b514b8b`](https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2)**



---

archive/issue_comments_012850.json:
```json
{
    "body": "Changed branch from **[u/nbruin/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/ticket/2516)** to **[u/rws/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/2516)**",
    "created_at": "2014-04-16T14:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12850",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/nbruin/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/ticket/2516)** to **[u/rws/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/2516)**



---

archive/issue_comments_012851.json:
```json
{
    "body": "Changed commit from **[`b514b8b`](https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2)** to **[`0dbbacd`](https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525)**",
    "created_at": "2014-04-16T15:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12851",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[`b514b8b`](https://github.com/sagemath/sagetrac-mirror/commit/b514b8bdc5ab36feef0ba516d9053743e1d9b4c2)** to **[`0dbbacd`](https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525)**



---

archive/issue_comments_012852.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nRebased on 6.2.beta8. I also included the test for `Expression` in `fast_callable`.\n\nReplying to [@nbruin](#comment:35):\n> - You are installing an extra rule in `mqapply_to_sage`, which I assume is correct. This rule registered in the special_max_to_sage dictionary: Great! that's what you're supposed to do\n> - However, for conversion back, there should be a corresponding entry in special_sage_to_max as well, and you're not adding that. You'd have to test, but from the rule in the other direction, I'd guess it should be something like:\n> \n> ```\n> sage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]\n> ```\n> where\n> \n> ```\n> lisp_length=EclObject('length')\n> ```\n> \n> If you don't put this rule in place, you'll find that things like \"limit\", \"integral\" and \"sum\" (which use `sr_to_max`) will probably not work correctly with hypergeometric function. (in fact, I'm not so sure maxima has much support for them anyway, but at least we should make sure that the functions can survive a round-trip)\n\nI'm afraid offhand I have no idea what this is about. Will try.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b4ed75db309567fae5c8115c8423cfde01b611b\"><code>4b4ed75</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525\"><code>0dbbacd</code></a></td><td><code>2516: fix last doctests</code></td></tr></table>\n",
    "created_at": "2014-04-16T15:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12852",
    "user": "https://github.com/rwst"
}
```

<div id="comment:49" align="right">comment:49</div>

Rebased on 6.2.beta8. I also included the test for `Expression` in `fast_callable`.

Replying to [@nbruin](#comment:35):
> - You are installing an extra rule in `mqapply_to_sage`, which I assume is correct. This rule registered in the special_max_to_sage dictionary: Great! that's what you're supposed to do
> - However, for conversion back, there should be a corresponding entry in special_sage_to_max as well, and you're not adding that. You'd have to test, but from the rule in the other direction, I'd guess it should be something like:
> 
> ```
> sage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]
> ```
> where
> 
> ```
> lisp_length=EclObject('length')
> ```
> 
> If you don't put this rule in place, you'll find that things like "limit", "integral" and "sum" (which use `sr_to_max`) will probably not work correctly with hypergeometric function. (in fact, I'm not so sure maxima has much support for them anyway, but at least we should make sure that the functions can survive a round-trip)

I'm afraid offhand I have no idea what this is about. Will try.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b4ed75db309567fae5c8115c8423cfde01b611b"><code>4b4ed75</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525"><code>0dbbacd</code></a></td><td><code>2516: fix last doctests</code></td></tr></table>




---

archive/issue_comments_012853.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@nbruin](#comment:35):\n> \n> ```\n> sage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]\n> ```\n\nIt's already included, as far as I can see.\n\nAre there any issues left?",
    "created_at": "2014-04-17T13:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12853",
    "user": "https://github.com/rwst"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@nbruin](#comment:35):
> 
> ```
> sage.functions.hypergeometric.hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A)-1,lisp_length(B)-1],A,B,X]
> ```

It's already included, as far as I can see.

Are there any issues left?



---

archive/issue_comments_012854.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@rwst](#comment:50):\n> It's already included, as far as I can see.\n\nYep, I figured out later how to get your branch to compile, so I provided the change\n\n> Are there any issues left?\n\nIt should be safe to delete the line\n`self.__name__ = self.__repr__()`\nnow.\n\nI haven't looked into much of the details of this; I mainly checked to see that translation to/from maxima_lib was done properly (and I think it is now).",
    "created_at": "2014-04-17T15:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12854",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@rwst](#comment:50):
> It's already included, as far as I can see.

Yep, I figured out later how to get your branch to compile, so I provided the change

> Are there any issues left?

It should be safe to delete the line
`self.__name__ = self.__repr__()`
now.

I haven't looked into much of the details of this; I mainly checked to see that translation to/from maxima_lib was done properly (and I think it is now).



---

archive/issue_comments_012855.json:
```json
{
    "body": "Changed commit from **[`0dbbacd`](https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525)** to **[`0f5a4ff`](https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b)**",
    "created_at": "2014-04-18T17:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12855",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0dbbacd`](https://github.com/sagemath/sagetrac-mirror/commit/0dbbacd5af23a111706b660ec997c3b302a33525)** to **[`0f5a4ff`](https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b)**



---

archive/issue_comments_012856.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/934d057d76651b1662a661cadb7ac4e10d9d477c\"><code>934d057</code></a></td><td><code>2516: remove hack</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b\"><code>0f5a4ff</code></a></td><td><code>2516: fix doctest</code></td></tr></table>\n",
    "created_at": "2014-04-18T17:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12856",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/934d057d76651b1662a661cadb7ac4e10d9d477c"><code>934d057</code></a></td><td><code>2516: remove hack</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b"><code>0f5a4ff</code></a></td><td><code>2516: fix doctest</code></td></tr></table>




---

archive/issue_comments_012857.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@nbruin](#comment:51):\n> It should be safe to delete the line\n> `self.__name__ = self.__repr__()`\n> now.\n\nThanks. I also noticed that only the check for `DynamicMetaclass` will make all resp. doctests pass.\n> I haven't looked into much of the details of this; I mainly checked to see that translation to/from maxima_lib was done properly (and I think it is now).\n\nPlease add your name as reviewer anyway. If you cannot give positive I will then ask in sage-devel.",
    "created_at": "2014-04-18T17:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12857",
    "user": "https://github.com/rwst"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@nbruin](#comment:51):
> It should be safe to delete the line
> `self.__name__ = self.__repr__()`
> now.

Thanks. I also noticed that only the check for `DynamicMetaclass` will make all resp. doctests pass.
> I haven't looked into much of the details of this; I mainly checked to see that translation to/from maxima_lib was done properly (and I think it is now).

Please add your name as reviewer anyway. If you cannot give positive I will then ask in sage-devel.



---

archive/issue_comments_012858.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI can't vouch for the mathematical correctness here, but the translation to/from maxima seems sound.",
    "created_at": "2014-04-24T18:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12858",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:54" align="right">comment:54</div>

I can't vouch for the mathematical correctness here, but the translation to/from maxima seems sound.



---

archive/issue_comments_012859.json:
```json
{
    "body": "Changed reviewer from **Ralf Stephan** to **Ralf Stephan, Nils Bruin**",
    "created_at": "2014-04-24T18:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12859",
    "user": "https://github.com/nbruin"
}
```

Changed reviewer from **Ralf Stephan** to **Ralf Stephan, Nils Bruin**



---

archive/issue_events_026132.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26132"
}
```



---

archive/issue_events_026133.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26133"
}
```



---

archive/issue_events_026134.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-05-10T06:27:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26134"
}
```



---

archive/issue_events_026135.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-05-10T06:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26135"
}
```



---

archive/issue_comments_012860.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nSome of the new functions needs to be doctested",
    "created_at": "2014-05-10T06:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12860",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:56" align="right">comment:56</div>

Some of the new functions needs to be doctested



---

archive/issue_comments_012861.json:
```json
{
    "body": "Work Issues: **coverage, doctest**",
    "created_at": "2014-05-10T06:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12861",
    "user": "https://github.com/fchapoton"
}
```

Work Issues: **coverage, doctest**



---

archive/issue_comments_012862.json:
```json
{
    "body": "Changed commit from **[`0f5a4ff`](https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b)** to **[`9c6749d`](https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649)**",
    "created_at": "2014-05-10T08:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12862",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0f5a4ff`](https://github.com/sagemath/sagetrac-mirror/commit/0f5a4ff613ba4ae4cd29b73f6f16d61725d19f6b)** to **[`9c6749d`](https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649)**



---

archive/issue_comments_012863.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeb273e297626c0671dde6a3da5a81382f9ad328\"><code>eeb273e</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62f7faa687173e52af6f7d4d618b7c5b88c0a50e\"><code>62f7faa</code></a></td><td><code>Merge branch 'master' into t/2516/ticket/2516</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649\"><code>9c6749d</code></a></td><td><code>doctest coverage</code></td></tr></table>\n",
    "created_at": "2014-05-10T08:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12863",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeb273e297626c0671dde6a3da5a81382f9ad328"><code>eeb273e</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62f7faa687173e52af6f7d4d618b7c5b88c0a50e"><code>62f7faa</code></a></td><td><code>Merge branch 'master' into t/2516/ticket/2516</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649"><code>9c6749d</code></a></td><td><code>doctest coverage</code></td></tr></table>




---

archive/issue_events_026136.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-10T08:51:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26136"
}
```



---

archive/issue_events_026137.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-10T08:51:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26137"
}
```



---

archive/issue_comments_012864.json:
```json
{
    "body": "Changed commit from **[`9c6749d`](https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649)** to **[`051edff`](https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd)**",
    "created_at": "2014-05-11T07:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12864",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9c6749d`](https://github.com/sagemath/sagetrac-mirror/commit/9c6749db3c97ebf62556702cf8d942c8a0f07649)** to **[`051edff`](https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd)**



---

archive/issue_comments_012865.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd\"><code>051edff</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr></table>\n",
    "created_at": "2014-05-11T07:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12865",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd"><code>051edff</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr></table>




---

archive/issue_comments_012866.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90\"><code>f96a1df</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103\"><code>1757232</code></a></td><td><code>2516: lazy_import the module</code></td></tr></table>\n",
    "created_at": "2014-06-21T12:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12866",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90"><code>f96a1df</code></a></td><td><code>Merge branch 'develop' into t/2516/ticket/2516</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103"><code>1757232</code></a></td><td><code>2516: lazy_import the module</code></td></tr></table>




---

archive/issue_comments_012867.json:
```json
{
    "body": "Changed commit from **[`051edff`](https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd)** to **[`1757232`](https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103)**",
    "created_at": "2014-06-21T12:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12867",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`051edff`](https://github.com/sagemath/sagetrac-mirror/commit/051edff9d24a9ca43c897112fc08dd6e0d322ebd)** to **[`1757232`](https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103)**



---

archive/issue_comments_012868.json:
```json
{
    "body": "Changed keywords from **hypergeometric** to **hypergeometric, special**",
    "created_at": "2014-06-21T12:35:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12868",
    "user": "https://github.com/rwst"
}
```

Changed keywords from **hypergeometric** to **hypergeometric, special**



---

archive/issue_comments_012869.json:
```json
{
    "body": "Changed work issues from **coverage, doctest** to none",
    "created_at": "2014-06-21T12:35:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12869",
    "user": "https://github.com/rwst"
}
```

Changed work issues from **coverage, doctest** to none



---

archive/issue_comments_012870.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThe lazy import in the last commit causes this:\n\n```\n[calculus ] loading cross citations...\n[calculus ] /home/ralf/sage/src/doc/en/reference/calculus/sage/calculus/calculus.rst:11: WARNING: error while formatting signature for sage.calculus.calculus.symbolic_expression_from_maxima_string: 'module' object has no attribute 'hypergeometric'\n[categorie] reading sources... [ 76%] sage/categories/modules_with_basis\nError building the documentation.\nTraceback (most recent call last):\n  File \"/home/ralf/sage/src/doc/common/builder.py\", line 1490, in <module>\n    getattr(get_builder(name), type)()\n  File \"/home/ralf/sage/src/doc/common/builder.py\", line 291, in _wrapper\n    getattr(get_builder(document), 'inventory')(*args, **kwds)\n  File \"/home/ralf/sage/src/doc/common/builder.py\", line 502, in _wrapper\n    x.get(99999)\n  File \"/home/ralf/sage/local/lib/python/multiprocessing/pool.py\", line 558, in get\n    raise self._value\nOSError: [calculus ] /home/ralf/sage/src/doc/en/reference/calculus/sage/calculus/calculus.rst:11: WARNING: error while formatting signature for sage.calculus.calculus.symbolic_expression_from_maxima_string: 'module' object has no attribute 'hypergeometric'\n```\nI have no idea why. There appears to be no circular import. It can also be triggered with\n\n```\nsage: from sage.calculus.calculus import symbolic_expression_from_maxima_string\nsage: symbolic_expression_from_maxima_string('hypergeometric')\n```\nbut that specific instance goes away when I import non-lazily at function level. Local import does not resolve the docbuild error.\n\nSo, back as global non-lazy import into `functions/all.py`?",
    "created_at": "2014-06-22T15:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12870",
    "user": "https://github.com/rwst"
}
```

<div id="comment:62" align="right">comment:62</div>

The lazy import in the last commit causes this:

```
[calculus ] loading cross citations...
[calculus ] /home/ralf/sage/src/doc/en/reference/calculus/sage/calculus/calculus.rst:11: WARNING: error while formatting signature for sage.calculus.calculus.symbolic_expression_from_maxima_string: 'module' object has no attribute 'hypergeometric'
[categorie] reading sources... [ 76%] sage/categories/modules_with_basis
Error building the documentation.
Traceback (most recent call last):
  File "/home/ralf/sage/src/doc/common/builder.py", line 1490, in <module>
    getattr(get_builder(name), type)()
  File "/home/ralf/sage/src/doc/common/builder.py", line 291, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/home/ralf/sage/src/doc/common/builder.py", line 502, in _wrapper
    x.get(99999)
  File "/home/ralf/sage/local/lib/python/multiprocessing/pool.py", line 558, in get
    raise self._value
OSError: [calculus ] /home/ralf/sage/src/doc/en/reference/calculus/sage/calculus/calculus.rst:11: WARNING: error while formatting signature for sage.calculus.calculus.symbolic_expression_from_maxima_string: 'module' object has no attribute 'hypergeometric'
```
I have no idea why. There appears to be no circular import. It can also be triggered with

```
sage: from sage.calculus.calculus import symbolic_expression_from_maxima_string
sage: symbolic_expression_from_maxima_string('hypergeometric')
```
but that specific instance goes away when I import non-lazily at function level. Local import does not resolve the docbuild error.

So, back as global non-lazy import into `functions/all.py`?



---

archive/issue_comments_012871.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nLooks like there are circular imports in `maxima_lib`. But is it the cause?",
    "created_at": "2014-06-22T16:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12871",
    "user": "https://github.com/rwst"
}
```

<div id="comment:63" align="right">comment:63</div>

Looks like there are circular imports in `maxima_lib`. But is it the cause?



---

archive/issue_comments_012872.json:
```json
{
    "body": "Changed commit from **[`1757232`](https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103)** to **[`d36389d`](https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb)**",
    "created_at": "2014-06-23T16:16:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12872",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1757232`](https://github.com/sagemath/sagetrac-mirror/commit/17572324c63584343661ec964fc635351f7b7103)** to **[`d36389d`](https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb)**



---

archive/issue_comments_012873.json:
```json
{
    "body": "<div id=\"comment:64\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3bc86c0855155e2755f9174f95f8dd578827d92\"><code>a3bc86c</code></a></td><td><code>16520: fix whole file imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb\"><code>d36389d</code></a></td><td><code>Merge branch 'u/rws/circular_import_in_maxima_lib_py' of trac.sagemath.org:sage into t/2516/ticket/2516</code></td></tr></table>\n",
    "created_at": "2014-06-23T16:16:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12873",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:64"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3bc86c0855155e2755f9174f95f8dd578827d92"><code>a3bc86c</code></a></td><td><code>16520: fix whole file imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb"><code>d36389d</code></a></td><td><code>Merge branch 'u/rws/circular_import_in_maxima_lib_py' of trac.sagemath.org:sage into t/2516/ticket/2516</code></td></tr></table>




---

archive/issue_events_026138.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-06-23T16:18:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26138"
}
```



---

archive/issue_events_026139.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-06-23T16:18:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26139"
}
```



---

archive/issue_comments_012874.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nNow that the lazy import no longer causes a docbuild error a doctest fail appears:\n\n```\nsage -t --long src/sage/functions/hypergeometric.py  # 1 doctest failed\n```",
    "created_at": "2014-06-23T16:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12874",
    "user": "https://github.com/rwst"
}
```

<div id="comment:65" align="right">comment:65</div>

Now that the lazy import no longer causes a docbuild error a doctest fail appears:

```
sage -t --long src/sage/functions/hypergeometric.py  # 1 doctest failed
```



---

archive/issue_comments_012875.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI noticed this:\n\n```\n+lazy_import(\"sage.functions.hypergeometric\", \"hypergeometric\")\n...\n special_sage_to_max={\n+ hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A.cdr()),lisp_length(B.cdr())],A,B,X]\n}\n```\nThis can't do what I think it is meant to do. Either the reference to \"hypergeometric\" as a dictionary key leads to resolving the lazy import (this is the most likely, because we'll need `hypergeometric.__hash__()` to set the dict entry), in which case there's no point in doing a lazy import, or some lazy proxy makes it into the dictionary as a key, which is then out of reach of the lazy import resolver to substitute with the real thing, leaving the proxy (and its slowdown) in place indefinitely.\n\nI suspect that just importing `hypergeometric` normally will lead to acceptable performance.",
    "created_at": "2014-06-23T23:10:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12875",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:66" align="right">comment:66</div>

I noticed this:

```
+lazy_import("sage.functions.hypergeometric", "hypergeometric")
...
 special_sage_to_max={
+ hypergeometric : lambda A, B, X : [[mqapply],[[max_hyper, max_array],lisp_length(A.cdr()),lisp_length(B.cdr())],A,B,X]
}
```
This can't do what I think it is meant to do. Either the reference to "hypergeometric" as a dictionary key leads to resolving the lazy import (this is the most likely, because we'll need `hypergeometric.__hash__()` to set the dict entry), in which case there's no point in doing a lazy import, or some lazy proxy makes it into the dictionary as a key, which is then out of reach of the lazy import resolver to substitute with the real thing, leaving the proxy (and its slowdown) in place indefinitely.

I suspect that just importing `hypergeometric` normally will lead to acceptable performance.



---

archive/issue_comments_012876.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nReset to before lazy import. Reviewers will just have to ignore the `PluginFailed` from patchbot.\n\nI'll grab the occasion and announce that I will not run after every upgrade merge fail from now, but simply upload a patch that reviewers/other authors should apply at merge conflict. If that patch goes stale as well, too bad.",
    "created_at": "2014-06-24T08:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12876",
    "user": "https://github.com/rwst"
}
```

<div id="comment:67" align="right">comment:67</div>

Reset to before lazy import. Reviewers will just have to ignore the `PluginFailed` from patchbot.

I'll grab the occasion and announce that I will not run after every upgrade merge fail from now, but simply upload a patch that reviewers/other authors should apply at merge conflict. If that patch goes stale as well, too bad.



---

archive/issue_events_026140.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-06-24T08:54:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26140"
}
```



---

archive/issue_events_026141.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-06-24T08:54:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26141"
}
```



---

archive/issue_comments_012877.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.\n \n-For reviewers:\n+For reviewers (no longer relevant):\n \n Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.\n``````\n",
    "created_at": "2014-06-24T08:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12877",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.
 
-For reviewers:
+For reviewers (no longer relevant):
 
 Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.
``````




---

archive/issue_comments_012878.json:
```json
{
    "body": "Changed branch from **[u/rws/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/2516)** to **[public/hypergeometric](https://github.com/sagemath/sagetrac-mirror/tree/public/hypergeometric)**",
    "created_at": "2014-06-24T08:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12878",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/ticket/2516](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/ticket/2516)** to **[public/hypergeometric](https://github.com/sagemath/sagetrac-mirror/tree/public/hypergeometric)**



---

archive/issue_comments_012879.json:
```json
{
    "body": "Changed commit from **[`d36389d`](https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb)** to **[`f96a1df`](https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90)**",
    "created_at": "2014-06-24T08:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12879",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[`d36389d`](https://github.com/sagemath/sagetrac-mirror/commit/d36389d37cefe44cf9e5e957f5ed1829645463fb)** to **[`f96a1df`](https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90)**



---

archive/issue_comments_012880.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nNow that the lazy import experiment was abandoned, is there anything amiss?",
    "created_at": "2014-06-29T14:05:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12880",
    "user": "https://github.com/rwst"
}
```

<div id="comment:68" align="right">comment:68</div>

Now that the lazy import experiment was abandoned, is there anything amiss?



---

archive/issue_comments_012881.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,2 @@\n Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.\n \n-For reviewers (no longer relevant):\n-\n-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.\n``````\n",
    "created_at": "2014-07-08T03:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12881",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,2 @@
 Sage should have support for [generalized hypergeometric functions](http://mathworld.wolfram.com/GeneralizedHypergeometricFunction.html). They are an important class of special functions. They show up everywhere from differential equations to binomial coefficient identities.
 
-For reviewers (no longer relevant):
-
-Apply [#14858](https://github.com/sagemath/sage/files/ticket14858/trac14858.patch.gz), [#14780](https://github.com/sagemath/sage/files/ticket14780/trac_14780-embed_tuples_in_SR.patch.gz), [#9556](https://github.com/sagemath/sage/files/ticket9556/trac_9556-dynamic_class_everywhere.patch.gz), [#14802](https://github.com/sagemath/sage/files/ticket14802/trac_14802-dynamic_attribute_args.patch.gz), and then `trac_2516_2.patch`.
``````




---

archive/issue_comments_012882.json:
```json
{
    "body": "Changed reviewer from **Ralf Stephan, Nils Bruin** to **Ralf Stephan, Nils Bruin, Volker Braun**",
    "created_at": "2014-07-08T03:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12882",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Ralf Stephan, Nils Bruin** to **Ralf Stephan, Nils Bruin, Volker Braun**



---

archive/issue_comments_012883.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nLooks good to me but merge conflict with #16007. Either merge that branch in or wait until the next beta.",
    "created_at": "2014-07-08T13:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12883",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:70" align="right">comment:70</div>

Looks good to me but merge conflict with #16007. Either merge that branch in or wait until the next beta.



---

archive/issue_comments_012884.json:
```json
{
    "body": "<div id=\"comment:71\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65107d4bac54adbceb615c7bdb0af6f4ca30d93c\"><code>65107d4</code></a></td><td><code>Merge branch 'develop' into t/8734/ticket/8734-1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e0738355f228ea068bea927f3025dcccb955b1c\"><code>4e07383</code></a></td><td><code>6882: add rules for e, i, I</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5a53435bde170e774c4e1dafba8f333a9653330\"><code>e5a5343</code></a></td><td><code>6882: do word search/replace for symtable keys</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c1b0eb5d6ff4b2b95487440c27c9879edb0131e\"><code>4c1b0eb</code></a></td><td><code>6882: correction to previous commit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/518de3e62533cd209997107f903192f1a31d118c\"><code>518de3e</code></a></td><td><code>6882: add symable rules for e,i,I; fix maxima_var; add doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a6696b714e638461cf4f77adbb65ecf413a2e4e\"><code>7a6696b</code></a></td><td><code>Merge branch 'u/rws/bugs_in_conversion_of_variable_names_from_maxima_to_sage' of trac.sagemath.org:sage into t/8734/ticket/8734-1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8df107e76527d83a87456520395ab85dbc44050\"><code>a8df107</code></a></td><td><code>Merge branch 't/8734/ticket/8734-1' into t/16007/ticket/16007</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e66d160791d3cbe44b6c0325328c0366db5585f\"><code>9e66d16</code></a></td><td><code>Merge commit 'a8df107e76527d83a87456520395ab85dbc44050' of trac.sagemath.org:sage into t/2516/public/hypergeometric</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ac822411ed8e045bda92c9c3de694a284fce28e\"><code>5ac8224</code></a></td><td><code>2516: fix doctests affected by 16007 merge</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965\"><code>b2f8dc5</code></a></td><td><code>2516: this 16007-related doctest fail seems to be uncovered only by 2516, so fix it here</code></td></tr></table>\n",
    "created_at": "2014-07-08T14:35:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12884",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:71"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65107d4bac54adbceb615c7bdb0af6f4ca30d93c"><code>65107d4</code></a></td><td><code>Merge branch 'develop' into t/8734/ticket/8734-1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e0738355f228ea068bea927f3025dcccb955b1c"><code>4e07383</code></a></td><td><code>6882: add rules for e, i, I</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5a53435bde170e774c4e1dafba8f333a9653330"><code>e5a5343</code></a></td><td><code>6882: do word search/replace for symtable keys</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c1b0eb5d6ff4b2b95487440c27c9879edb0131e"><code>4c1b0eb</code></a></td><td><code>6882: correction to previous commit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/518de3e62533cd209997107f903192f1a31d118c"><code>518de3e</code></a></td><td><code>6882: add symable rules for e,i,I; fix maxima_var; add doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a6696b714e638461cf4f77adbb65ecf413a2e4e"><code>7a6696b</code></a></td><td><code>Merge branch 'u/rws/bugs_in_conversion_of_variable_names_from_maxima_to_sage' of trac.sagemath.org:sage into t/8734/ticket/8734-1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8df107e76527d83a87456520395ab85dbc44050"><code>a8df107</code></a></td><td><code>Merge branch 't/8734/ticket/8734-1' into t/16007/ticket/16007</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e66d160791d3cbe44b6c0325328c0366db5585f"><code>9e66d16</code></a></td><td><code>Merge commit 'a8df107e76527d83a87456520395ab85dbc44050' of trac.sagemath.org:sage into t/2516/public/hypergeometric</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ac822411ed8e045bda92c9c3de694a284fce28e"><code>5ac8224</code></a></td><td><code>2516: fix doctests affected by 16007 merge</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965"><code>b2f8dc5</code></a></td><td><code>2516: this 16007-related doctest fail seems to be uncovered only by 2516, so fix it here</code></td></tr></table>




---

archive/issue_comments_012885.json:
```json
{
    "body": "Changed commit from **[`f96a1df`](https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90)** to **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**",
    "created_at": "2014-07-08T14:35:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12885",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f96a1df`](https://github.com/sagemath/sagetrac-mirror/commit/f96a1df816f3201822dbde0553b68b48403a0f90)** to **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**



---

archive/issue_comments_012886.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nThanks to all other authors and reviewers.",
    "created_at": "2014-07-08T14:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12886",
    "user": "https://github.com/rwst"
}
```

<div id="comment:72" align="right">comment:72</div>

Thanks to all other authors and reviewers.



---

archive/issue_comments_012887.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\n> Thanks to all other authors and reviewers.\n\nThanks for sticking with it to make this a reality!\n\nDoes this fix either of the two remaining examples at #9908 (see [here](https://github.com/sagemath/sage/issues/9908#comment:11))?  No worries about putting them here, but if so then we can mark that as an easy-to-fix ticket.",
    "created_at": "2014-07-08T15:22:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12887",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:73" align="right">comment:73</div>

> Thanks to all other authors and reviewers.

Thanks for sticking with it to make this a reality!

Does this fix either of the two remaining examples at #9908 (see [here](https://github.com/sagemath/sage/issues/9908#comment:11))?  No worries about putting them here, but if so then we can mark that as an easy-to-fix ticket.



---

archive/issue_comments_012888.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@kcrisman](#comment:73):\n> Does this fix either of the two remaining examples at #9908 (see [here](https://github.com/sagemath/sage/issues/9908#comment:11))?  No worries about putting them here, but if so then we can mark that as an easy-to-fix ticket.\n\nAnswered there.",
    "created_at": "2014-07-08T15:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12888",
    "user": "https://github.com/rwst"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@kcrisman](#comment:73):
> Does this fix either of the two remaining examples at #9908 (see [here](https://github.com/sagemath/sage/issues/9908#comment:11))?  No worries about putting them here, but if so then we can mark that as an easy-to-fix ticket.

Answered there.



---

archive/issue_comments_012889.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nI understand Volker's final remark as 'conditionally positive', and now the condition is fulfilled.",
    "created_at": "2014-07-08T17:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12889",
    "user": "https://github.com/rwst"
}
```

<div id="comment:75" align="right">comment:75</div>

I understand Volker's final remark as 'conditionally positive', and now the condition is fulfilled.



---

archive/issue_events_026142.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T17:35:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26142"
}
```



---

archive/issue_events_026143.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T17:35:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26143"
}
```



---

archive/issue_events_026144.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-08T18:51:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26144"
}
```



---

archive/issue_events_026145.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1c8e0bdc59ce7fc30b80ce582572fd2a8ee82ded",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-07-08T18:51:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2516#event-26145"
}
```



---

archive/issue_comments_012890.json:
```json
{
    "body": "Changed branch from **[public/hypergeometric](https://github.com/sagemath/sagetrac-mirror/tree/public/hypergeometric)** to **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**",
    "created_at": "2014-07-08T18:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12890",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/hypergeometric](https://github.com/sagemath/sagetrac-mirror/tree/public/hypergeometric)** to **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)**



---

archive/issue_comments_012891.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nSee #16752 for a followup with some code/doc tweaks.",
    "created_at": "2014-08-02T23:26:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12891",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:77" align="right">comment:77</div>

See #16752 for a followup with some code/doc tweaks.



---

archive/issue_comments_012892.json:
```json
{
    "body": "Changed commit from **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)** to none",
    "created_at": "2014-08-02T23:26:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12892",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[`b2f8dc5`](https://github.com/sagemath/sagetrac-mirror/commit/b2f8dc5a1c82312271f2e2361b142358a66d0965)** to none



---

archive/issue_comments_012893.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nDoes anybody remember why this `inspect.ismethod` condition was added here to the deprecation from #5930? I mean, either something is deprecated or not. It shouldn't depend on some very subtle condition like the type of the `_fast_callable_` attribute.\n\n```python\n            import inspect\n            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):\n                # only warn if _the_element is not dynamic\n                from sage.misc.superseded import deprecation\n                deprecation(5930, \"Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\")\n```",
    "created_at": "2017-06-07T12:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12893",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:78" align="right">comment:78</div>

Does anybody remember why this `inspect.ismethod` condition was added here to the deprecation from #5930? I mean, either something is deprecated or not. It shouldn't depend on some very subtle condition like the type of the `_fast_callable_` attribute.

```python
            import inspect
            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):
                # only warn if _the_element is not dynamic
                from sage.misc.superseded import deprecation
                deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
```



---

archive/issue_comments_012894.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nFollow-up at #23159.",
    "created_at": "2017-06-07T13:27:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2516#issuecomment-12894",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:79" align="right">comment:79</div>

Follow-up at #23159.
