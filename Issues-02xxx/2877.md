# Issue 2877: security risk -- restrict the input of eval in CC constructor

archive/issues_002877.json:
```json
{
    "body": "There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n\nIt is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n\n```\nsage: CC(\"os.getpid()\")\n10324.0000000000\nsage: CC(\"os.mkdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.rmdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.exec(...)\")\n```\n\nIn this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n\nAssignee: cwitty\n\nCC:  @tscrim @slel @kliem @kwankyu\n\nBranch/Commit: 57e8e9bc41c8e41eca5cad8879e67ba49089a4f0\n\nReviewer: Travis Scrimshaw, Kwankyu Lee\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/2877\n\n",
    "closed_at": "2021-10-28T22:40:01Z",
    "created_at": "2008-04-11T11:39:56Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "security risk -- restrict the input of eval in CC constructor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2877",
    "user": "https://github.com/robertwb"
}
```
There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 

It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 

```
sage: CC("os.getpid()")
10324.0000000000
sage: CC("os.mkdir('a')")
NaN - NaN*I
sage: CC("os.rmdir('a')")
NaN - NaN*I
sage: CC("os.exec(...)")
```

In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.

Assignee: cwitty

CC:  @tscrim @slel @kliem @kwankyu

Branch/Commit: 57e8e9bc41c8e41eca5cad8879e67ba49089a4f0

Reviewer: Travis Scrimshaw, Kwankyu Lee

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/2877





---

archive/issue_comments_020699.json:
```json
{
    "body": "<a id='comment:1'></a>\nSee #2347 which is related.",
    "created_at": "2008-04-11T11:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20699",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:1'></a>
See #2347 which is related.



---

archive/issue_events_010157.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-04-11T19:33:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10157"
}
```



---

archive/issue_events_010158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10158"
}
```



---

archive/issue_events_010159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10159"
}
```



---

archive/issue_events_010160.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10160"
}
```



---

archive/issue_events_010161.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10161"
}
```



---

archive/issue_events_010162.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10162"
}
```



---

archive/issue_events_010163.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10163"
}
```



---

archive/issue_events_010164.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10164"
}
```



---

archive/issue_events_010165.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10165"
}
```



---

archive/issue_comments_020700.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-02T09:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20700",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_020701.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2014-09-02T09:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20701",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_events_010166.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10166"
}
```



---

archive/issue_events_010167.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10167"
}
```



---

archive/issue_comments_020702.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2014-09-02T09:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20702",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_020703.json:
```json
{
    "body": "<a id='comment:8'></a>\nSage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!",
    "created_at": "2014-09-02T09:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20703",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Sage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!



---

archive/issue_comments_020704.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-02T09:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20704",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_020705.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2014-09-09T14:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20705",
    "user": "https://github.com/vbraun"
}
```

Resolution: invalid



---

archive/issue_events_010168.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:52:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10168"
}
```



---

archive/issue_comments_020706.json:
```json
{
    "body": "<a id='comment:11'></a>\nA strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )\n\nIf you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.",
    "created_at": "2019-07-05T16:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20706",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
A strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )

If you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.



---

archive/issue_comments_020707.json:
```json
{
    "body": "Resolution changed from invalid to ",
    "created_at": "2019-07-05T16:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20707",
    "user": "https://github.com/embray"
}
```

Resolution changed from invalid to 



---

archive/issue_comments_020708.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2019-07-05T16:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20708",
    "user": "https://github.com/embray"
}
```

Changing status from closed to new.



---

archive/issue_events_010169.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10169"
}
```



---

archive/issue_events_010170.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10170"
}
```



---

archive/issue_events_010171.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10171"
}
```



---

archive/issue_comments_020709.json:
```json
{
    "body": "<a id='comment:12'></a>\nA simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n\nThe reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.",
    "created_at": "2019-07-06T12:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20709",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/

The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.



---

archive/issue_comments_020710.json:
```json
{
    "body": "<a id='comment:13'></a>\nI fully agree with Erik.\n\nThe following does not work (as expected)\n\n```\nsage: ZZ('2**3 + 3*g - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3 + 3*g - 2' to an integer\nsage: RR('2**2 + 3*5 - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3+5*I-2' to a real number\n```\nSupporting the following with `CC` is a nonsense\n\n```\nsage: CC('2**2 + 3*5 - 2')\n17.0000000000000\nsage: CC('erf(2)')\n0.995322265018953\n```\nWe don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.",
    "created_at": "2019-07-11T19:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20710",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>
I fully agree with Erik.

The following does not work (as expected)

```
sage: ZZ('2**3 + 3*g - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3 + 3*g - 2' to an integer
sage: RR('2**2 + 3*5 - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3+5*I-2' to a real number
```
Supporting the following with `CC` is a nonsense

```
sage: CC('2**2 + 3*5 - 2')
17.0000000000000
sage: CC('erf(2)')
0.995322265018953
```
We don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.



---

archive/issue_comments_020711.json:
```json
{
    "body": "<a id='comment:14'></a>\nAnd to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket \"fix element constructor of CC\".",
    "created_at": "2019-07-11T19:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20711",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
And to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket "fix element constructor of CC".



---

archive/issue_comments_020712.json:
```json
{
    "body": "<a id='comment:15'></a>\nIt's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.",
    "created_at": "2019-07-12T08:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20712",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
It's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.



---

archive/issue_comments_020713.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [vbraun](#comment%3A12):\n> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n> \n> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.\n\n\n+1",
    "created_at": "2019-07-12T08:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20713",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
Replying to [vbraun](#comment%3A12):
> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/
> 
> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.


+1



---

archive/issue_events_010172.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10172"
}
```



---

archive/issue_events_010173.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10173"
}
```



---

archive/issue_comments_020714.json:
```json
{
    "body": "<a id='comment:17'></a>\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20714",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Ticket retargeted after milestone closed



---

archive/issue_comments_020715.json:
```json
{
    "body": "<a id='comment:18'></a>\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20715",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_010174.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10174"
}
```



---

archive/issue_events_010175.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10175"
}
```



---

archive/issue_events_010176.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10176"
}
```



---

archive/issue_events_010177.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10177"
}
```



---

archive/issue_comments_020716.json:
```json
{
    "body": "<a id='comment:20'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20716",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_010178.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10178"
}
```



---

archive/issue_events_010179.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10179"
}
```



---

archive/issue_events_010180.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10180"
}
```



---

archive/issue_events_010181.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10181"
}
```



---

archive/issue_comments_020717.json:
```json
{
    "body": "Changing commit from \"\" to \"1e89c2acb8b9fdccfa475dd45d33007cd1cd6923\"",
    "created_at": "2021-10-19T15:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20717",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "1e89c2acb8b9fdccfa475dd45d33007cd1cd6923"



---

archive/issue_comments_020718.json:
```json
{
    "body": "<a id='comment:22'></a>\nhere is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now\n\n---\nNew commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)|`simple-minded check for string input of CC`|",
    "created_at": "2021-10-19T15:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20718",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>
here is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now

---
New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)|`simple-minded check for string input of CC`|



---

archive/issue_comments_020719.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/2877\"",
    "created_at": "2021-10-19T15:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20719",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/2877"



---

archive/issue_comments_020720.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-19T15:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20720",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_020721.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2021-10-19T15:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20721",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_020722.json:
```json
{
    "body": "Changing commit from \"1e89c2acb8b9fdccfa475dd45d33007cd1cd6923\" to \"57d20f14f55b063e9b4b9456827d5030be7b31aa\"",
    "created_at": "2021-10-19T18:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1e89c2acb8b9fdccfa475dd45d33007cd1cd6923" to "57d20f14f55b063e9b4b9456827d5030be7b31aa"



---

archive/issue_comments_020723.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)|`simple-minded check for string input of CC`|",
    "created_at": "2021-10-19T18:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20723",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)|`simple-minded check for string input of CC`|



---

archive/issue_comments_020724.json:
```json
{
    "body": "Changing reviewer from \"Jeroen Demeyer\" to \"\"",
    "created_at": "2021-10-20T07:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20724",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "Jeroen Demeyer" to ""



---

archive/issue_comments_020725.json:
```json
{
    "body": "Changing commit from \"57d20f14f55b063e9b4b9456827d5030be7b31aa\" to \"53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9\"",
    "created_at": "2021-10-20T07:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20725",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "57d20f14f55b063e9b4b9456827d5030be7b31aa" to "53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9"



---

archive/issue_comments_020726.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[e59be13](https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec)|`Merge branch 'u/chapoton/2877' in 9.5.b4`|\n|[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)|`fix some CC bad string input`|",
    "created_at": "2021-10-20T07:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[e59be13](https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec)|`Merge branch 'u/chapoton/2877' in 9.5.b4`|
|[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)|`fix some CC bad string input`|



---

archive/issue_comments_020727.json:
```json
{
    "body": "<a id='comment:26'></a>\nbot is morally green, so please review",
    "created_at": "2021-10-20T11:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20727",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'></a>
bot is morally green, so please review



---

archive/issue_comments_020728.json:
```json
{
    "body": "<a id='comment:27'></a>\nDo we also want to allow `j` to match Python's convention for complex numbers:\n\n```sage\nsage: complex('1+2j')\n(1+2j)\nsage: complex('1+2i')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-2-a2113f9c148b> in <module>\n----> 1 complex('1+2i')\n\nValueError: complex() arg is a malformed string\n```",
    "created_at": "2021-10-20T23:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20728",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>
Do we also want to allow `j` to match Python's convention for complex numbers:

```sage
sage: complex('1+2j')
(1+2j)
sage: complex('1+2i')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-a2113f9c148b> in <module>
----> 1 complex('1+2i')

ValueError: complex() arg is a malformed string
```



---

archive/issue_comments_020729.json:
```json
{
    "body": "Changing commit from \"53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9\" to \"77031e8a39e6470b0eb3981f69f61f27a2d7ef5c\"",
    "created_at": "2021-10-21T07:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20729",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9" to "77031e8a39e6470b0eb3981f69f61f27a2d7ef5c"



---

archive/issue_comments_020730.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)|`simple-minded check for string input of CC`|",
    "created_at": "2021-10-21T07:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20730",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)|`simple-minded check for string input of CC`|



---

archive/issue_comments_020731.json:
```json
{
    "body": "<a id='comment:29'></a>\nok, done (and squashed the commits)",
    "created_at": "2021-10-21T07:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20731",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'></a>
ok, done (and squashed the commits)



---

archive/issue_comments_020732.json:
```json
{
    "body": "<a id='comment:30'></a>\nbut this will break the doctest in singular.pyx... (sigh)",
    "created_at": "2021-10-21T07:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20732",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'></a>
but this will break the doctest in singular.pyx... (sigh)



---

archive/issue_comments_020733.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)|`simple-minded check for string input of CC`|",
    "created_at": "2021-10-21T07:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20733",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)|`simple-minded check for string input of CC`|



---

archive/issue_comments_020734.json:
```json
{
    "body": "Changing commit from \"77031e8a39e6470b0eb3981f69f61f27a2d7ef5c\" to \"feab03f2ae95b6f4452bbc3211e6a84ad56aad68\"",
    "created_at": "2021-10-21T07:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "77031e8a39e6470b0eb3981f69f61f27a2d7ef5c" to "feab03f2ae95b6f4452bbc3211e6a84ad56aad68"



---

archive/issue_comments_020735.json:
```json
{
    "body": "<a id='comment:32'></a>\nbot is morally green now",
    "created_at": "2021-10-21T11:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20735",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'></a>
bot is morally green now



---

archive/issue_comments_020736.json:
```json
{
    "body": "<a id='comment:33'></a>\nSorry for late comment, but how about this?\n\n```diff\n--- a/src/sage/rings/complex_mpfr.pyx\n+++ b/src/sage/rings/complex_mpfr.pyx\n@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n             sage: CC('hello')\n             Traceback (most recent call last):\n             ...\n-            ValueError: given string (hello) is not a complex number\n+            ValueError: given string 'hello' is not a complex number\n         \"\"\"\n         if not isinstance(x, (RealNumber, tuple)):\n             if isinstance(x, ComplexDoubleElement):\n@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n                 x = x.replace('E', 'e')\n                 allowed = '+-.*0123456789Ie'\n                 if not all(letter in allowed for letter in x):\n-                    raise ValueError(f'given string ({x}) is not a complex number')\n+                    raise ValueError(f'given string {x!r} is not a complex number')\n                 # This should rather use a proper parser to validate input.\n                 # TODO: this is probably not the best and most\n                 # efficient way to do this.  -- Martin Albrecht\n```\n\nand `does not express a complex number`.",
    "created_at": "2021-10-22T04:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20736",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:33'></a>
Sorry for late comment, but how about this?

```diff
--- a/src/sage/rings/complex_mpfr.pyx
+++ b/src/sage/rings/complex_mpfr.pyx
@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
             sage: CC('hello')
             Traceback (most recent call last):
             ...
-            ValueError: given string (hello) is not a complex number
+            ValueError: given string 'hello' is not a complex number
         """
         if not isinstance(x, (RealNumber, tuple)):
             if isinstance(x, ComplexDoubleElement):
@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
                 x = x.replace('E', 'e')
                 allowed = '+-.*0123456789Ie'
                 if not all(letter in allowed for letter in x):
-                    raise ValueError(f'given string ({x}) is not a complex number')
+                    raise ValueError(f'given string {x!r} is not a complex number')
                 # This should rather use a proper parser to validate input.
                 # TODO: this is probably not the best and most
                 # efficient way to do this.  -- Martin Albrecht
```

and `does not express a complex number`.



---

archive/issue_comments_020737.json:
```json
{
    "body": "<a id='comment:34'></a>\nThank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.",
    "created_at": "2021-10-22T05:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20737",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>
Thank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.



---

archive/issue_comments_020738.json:
```json
{
    "body": "Changing commit from \"feab03f2ae95b6f4452bbc3211e6a84ad56aad68\" to \"45039da5348873d5363020f0cde9e5996e4b3de7\"",
    "created_at": "2021-10-22T06:39:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "feab03f2ae95b6f4452bbc3211e6a84ad56aad68" to "45039da5348873d5363020f0cde9e5996e4b3de7"



---

archive/issue_comments_020739.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|\n|[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)|`some details`|",
    "created_at": "2021-10-22T06:39:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20739",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)|`some details`|



---

archive/issue_comments_020740.json:
```json
{
    "body": "<a id='comment:36'></a>\nok, done.\n\nWARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').",
    "created_at": "2021-10-22T06:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20740",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'></a>
ok, done.

WARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').



---

archive/issue_comments_020741.json:
```json
{
    "body": "Changing commit from \"45039da5348873d5363020f0cde9e5996e4b3de7\" to \"57e8e9bc41c8e41eca5cad8879e67ba49089a4f0\"",
    "created_at": "2021-10-24T07:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20741",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "45039da5348873d5363020f0cde9e5996e4b3de7" to "57e8e9bc41c8e41eca5cad8879e67ba49089a4f0"



---

archive/issue_comments_020742.json:
```json
{
    "body": "<a id='comment:37'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)|`simple-minded check for string input of CC`|",
    "created_at": "2021-10-24T07:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20742",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)|`simple-minded check for string input of CC`|



---

archive/issue_comments_020743.json:
```json
{
    "body": "<a id='comment:38'></a>\nI fixed the failing doctest",
    "created_at": "2021-10-24T07:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20743",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:38'></a>
I fixed the failing doctest



---

archive/issue_comments_020744.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-24T23:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20744",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_020745.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw, Kwankyu Lee\"",
    "created_at": "2021-10-24T23:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20745",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw, Kwankyu Lee"



---

archive/issue_comments_020746.json:
```json
{
    "body": "<a id='comment:39'></a>\nGreat, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.",
    "created_at": "2021-10-24T23:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20746",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'></a>
Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.



---

archive/issue_comments_020747.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [tscrim](#comment%3A39):\n> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.\n\n\nI fully agree. Thanks.",
    "created_at": "2021-10-25T06:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20747",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:40'></a>
Replying to [tscrim](#comment%3A39):
> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.


I fully agree. Thanks.



---

archive/issue_comments_020748.json:
```json
{
    "body": "<a id='comment:41'></a>\nUpdate ticket summary and description\nto better describe the changes made here?\n\n(Or just contract \"should be able to be able to\"\nif the rest is still fine?)",
    "created_at": "2021-10-25T09:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20748",
    "user": "https://github.com/slel"
}
```

<a id='comment:41'></a>
Update ticket summary and description
to better describe the changes made here?

(Or just contract "should be able to be able to"
if the rest is still fine?)



---

archive/issue_events_010182.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "rename": {
        "from": "security risk -- several constructors use eval to parse input",
        "to": "security risk -- restrict the input of eval in CC constructor"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10182"
}
```



---

archive/issue_comments_020749.json:
```json
{
    "body": "<a id='comment:42'></a>\nvoil\u00e0, voil\u00e0.",
    "created_at": "2021-10-25T12:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20749",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'></a>
voilà, voilà.



---

archive/issue_comments_020750.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n \n-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n \n ```\n sage: CC(\"os.getpid()\")\n@@ -11,3 +11,5 @@\n NaN - NaN*I\n sage: CC(\"os.exec(...)\")\n ```\n+\n+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n``````\n",
    "created_at": "2021-10-25T12:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20750",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 
 
-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
 
 ```
 sage: CC("os.getpid()")
@@ -11,3 +11,5 @@
 NaN - NaN*I
 sage: CC("os.exec(...)")
 ```
+
+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.
``````




---

archive/issue_comments_020751.json:
```json
{
    "body": "<a id='comment:43'></a>\nMerci.",
    "created_at": "2021-10-25T12:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20751",
    "user": "https://github.com/slel"
}
```

<a id='comment:43'></a>
Merci.



---

archive/issue_comments_020752.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-28T22:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20752",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_010183.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-28T22:40:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2877#event-10183"
}
```



---

archive/issue_comments_020753.json:
```json
{
    "body": "Changing branch from \"u/chapoton/2877\" to \"57e8e9bc41c8e41eca5cad8879e67ba49089a4f0\"",
    "created_at": "2021-10-28T22:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2877#issuecomment-20753",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/2877" to "57e8e9bc41c8e41eca5cad8879e67ba49089a4f0"
