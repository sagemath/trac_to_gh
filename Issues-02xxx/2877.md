# Issue 2877: security risk -- restrict the input of eval in CC constructor

archive/issues_002877.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-cwitty"
    ],
    "body": "There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n\nIt is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n\n```\nsage: CC(\"os.getpid()\")\n10324.0000000000\nsage: CC(\"os.mkdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.rmdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.exec(...)\")\n```\n\nIn this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n\nCC:  @tscrim @slel @kliem @kwankyu\n\nBranch/Commit: **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**\n\nReviewer: **Travis Scrimshaw, Kwankyu Lee**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/2877_\n\n",
    "closed_at": "2021-10-28T22:40:01Z",
    "created_at": "2008-04-11T11:39:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "security risk -- restrict the input of eval in CC constructor",
    "type": "issue",
    "updated_at": "2021-10-28T22:40:01Z",
    "url": "https://github.com/sagemath/sage/issues/2877",
    "user": "https://github.com/robertwb"
}
```
There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 

It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 

```
sage: CC("os.getpid()")
10324.0000000000
sage: CC("os.mkdir('a')")
NaN - NaN*I
sage: CC("os.rmdir('a')")
NaN - NaN*I
sage: CC("os.exec(...)")
```

In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.

CC:  @tscrim @slel @kliem @kwankyu

Branch/Commit: **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**

Reviewer: **Travis Scrimshaw, Kwankyu Lee**

Author: **Frédéric Chapoton**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/2877_





---

archive/issue_events_030481.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2008-04-11T11:39:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30481"
}
```



---

archive/issue_events_030482.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2008-04-11T11:39:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30482"
}
```



---

archive/issue_events_030483.json:
```json
{
    "actor": "https://github.com/sagetrac-cwitty",
    "created_at": "2008-04-11T11:39:56Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "subject": "https://github.com/robertwb",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30483"
}
```



---

archive/issue_comments_014990.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSee #2347 which is related.",
    "created_at": "2008-04-11T11:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14990",
    "user": "https://github.com/robertwb"
}
```

<div id="comment:1" align="right">comment:1</div>

See #2347 which is related.



---

archive/issue_events_030484.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-04-11T19:33:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30484"
}
```



---

archive/issue_events_030485.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30485"
}
```



---

archive/issue_events_030486.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30486"
}
```



---

archive/issue_events_030487.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30487"
}
```



---

archive/issue_events_030488.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30488"
}
```



---

archive/issue_events_030489.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30489"
}
```



---

archive/issue_events_030490.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30490"
}
```



---

archive/issue_events_030491.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30491"
}
```



---

archive/issue_events_030492.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30492"
}
```



---

archive/issue_events_030493.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30493"
}
```



---

archive/issue_events_030494.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30494"
}
```



---

archive/issue_events_030495.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30495"
}
```



---

archive/issue_events_030496.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30496"
}
```



---

archive/issue_events_030497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30497"
}
```



---

archive/issue_events_030498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30498"
}
```



---

archive/issue_comments_014991.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-09-02T09:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14991",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_014992.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!",
    "created_at": "2014-09-02T09:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14992",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Sage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!



---

archive/issue_events_030499.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30499"
}
```



---

archive/issue_events_030500.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30500"
}
```



---

archive/issue_events_030501.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:52:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30501"
}
```



---

archive/issue_events_030502.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:52:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30502"
}
```



---

archive/issue_comments_014993.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nA strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )\n\nIf you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.",
    "created_at": "2019-07-05T16:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14993",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

A strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )

If you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.



---

archive/issue_events_030503.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30503"
}
```



---

archive/issue_events_030504.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30504"
}
```



---

archive/issue_comments_014994.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nA simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n\nThe reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.",
    "created_at": "2019-07-06T12:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14994",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">comment:12</div>

A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/

The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.



---

archive/issue_comments_014995.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI fully agree with Erik.\n\nThe following does not work (as expected)\n\n```\nsage: ZZ('2**3 + 3*g - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3 + 3*g - 2' to an integer\nsage: RR('2**2 + 3*5 - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3+5*I-2' to a real number\n```\nSupporting the following with `CC` is a nonsense\n\n```\nsage: CC('2**2 + 3*5 - 2')\n17.0000000000000\nsage: CC('erf(2)')\n0.995322265018953\n```\nWe don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.",
    "created_at": "2019-07-11T19:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14995",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

I fully agree with Erik.

The following does not work (as expected)

```
sage: ZZ('2**3 + 3*g - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3 + 3*g - 2' to an integer
sage: RR('2**2 + 3*5 - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3+5*I-2' to a real number
```
Supporting the following with `CC` is a nonsense

```
sage: CC('2**2 + 3*5 - 2')
17.0000000000000
sage: CC('erf(2)')
0.995322265018953
```
We don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.



---

archive/issue_comments_014996.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAnd to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket \"fix element constructor of CC\".",
    "created_at": "2019-07-11T19:57:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14996",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

And to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket "fix element constructor of CC".



---

archive/issue_comments_014997.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.",
    "created_at": "2019-07-12T08:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14997",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

It's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.



---

archive/issue_comments_014998.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@vbraun](#comment:12):\n> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n> \n> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.\n\n+1",
    "created_at": "2019-07-12T08:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14998",
    "user": "https://github.com/embray"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@vbraun](#comment:12):
> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/
> 
> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.

+1



---

archive/issue_events_030505.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30505"
}
```



---

archive/issue_events_030506.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30506"
}
```



---

archive/issue_comments_014999.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-14999",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

Ticket retargeted after milestone closed



---

archive/issue_comments_015000.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15000",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_030507.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30507"
}
```



---

archive/issue_events_030508.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30508"
}
```



---

archive/issue_events_030509.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30509"
}
```



---

archive/issue_events_030510.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30510"
}
```



---

archive/issue_comments_015001.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15001",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_030511.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30511"
}
```



---

archive/issue_events_030512.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30512"
}
```



---

archive/issue_events_030513.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30513"
}
```



---

archive/issue_events_030514.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30514"
}
```



---

archive/issue_comments_015002.json:
```json
{
    "body": "Commit: **[`1e89c2a`](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15002",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`1e89c2a`](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)**



---

archive/issue_comments_015003.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nhere is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923\"><code>1e89c2a</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15003",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

here is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923"><code>1e89c2a</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015004.json:
```json
{
    "body": "Branch: **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15004",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)**



---

archive/issue_events_030515.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-19T15:03:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30515"
}
```



---

archive/issue_comments_015005.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15005",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_comments_015006.json:
```json
{
    "body": "Changed commit from **[`1e89c2a`](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)** to **[`57d20f1`](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)**",
    "created_at": "2021-10-19T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15006",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1e89c2a`](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)** to **[`57d20f1`](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)**



---

archive/issue_comments_015007.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa\"><code>57d20f1</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-19T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15007",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa"><code>57d20f1</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015008.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to none",
    "created_at": "2021-10-20T07:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15008",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Jeroen Demeyer** to none



---

archive/issue_comments_015009.json:
```json
{
    "body": "Changed commit from **[`57d20f1`](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)** to **[`53f6c2a`](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)**",
    "created_at": "2021-10-20T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15009",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`57d20f1`](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)** to **[`53f6c2a`](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)**



---

archive/issue_comments_015010.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec\"><code>e59be13</code></a></td><td><code>Merge branch 'u/chapoton/2877' in 9.5.b4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9\"><code>53f6c2a</code></a></td><td><code>fix some CC bad string input</code></td></tr></table>\n",
    "created_at": "2021-10-20T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15010",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec"><code>e59be13</code></a></td><td><code>Merge branch 'u/chapoton/2877' in 9.5.b4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9"><code>53f6c2a</code></a></td><td><code>fix some CC bad string input</code></td></tr></table>




---

archive/issue_comments_015011.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nbot is morally green, so please review",
    "created_at": "2021-10-20T11:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15011",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:26" align="right">comment:26</div>

bot is morally green, so please review



---

archive/issue_comments_015012.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nDo we also want to allow `j` to match Python's convention for complex numbers:\n\n```sage\nsage: complex('1+2j')\n(1+2j)\nsage: complex('1+2i')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-2-a2113f9c148b> in <module>\n----> 1 complex('1+2i')\n\nValueError: complex() arg is a malformed string\n```",
    "created_at": "2021-10-20T23:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15012",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

Do we also want to allow `j` to match Python's convention for complex numbers:

```sage
sage: complex('1+2j')
(1+2j)
sage: complex('1+2i')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-a2113f9c148b> in <module>
----> 1 complex('1+2i')

ValueError: complex() arg is a malformed string
```



---

archive/issue_comments_015013.json:
```json
{
    "body": "Changed commit from **[`53f6c2a`](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)** to **[`77031e8`](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)**",
    "created_at": "2021-10-21T07:00:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15013",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`53f6c2a`](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)** to **[`77031e8`](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)**



---

archive/issue_comments_015014.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c\"><code>77031e8</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-21T07:00:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15014",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c"><code>77031e8</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015015.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nok, done (and squashed the commits)",
    "created_at": "2021-10-21T07:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15015",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:29" align="right">comment:29</div>

ok, done (and squashed the commits)



---

archive/issue_comments_015016.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nbut this will break the doctest in singular.pyx... (sigh)",
    "created_at": "2021-10-21T07:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15016",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:30" align="right">comment:30</div>

but this will break the doctest in singular.pyx... (sigh)



---

archive/issue_comments_015017.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68\"><code>feab03f</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-21T07:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15017",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68"><code>feab03f</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015018.json:
```json
{
    "body": "Changed commit from **[`77031e8`](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)** to **[`feab03f`](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)**",
    "created_at": "2021-10-21T07:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15018",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`77031e8`](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)** to **[`feab03f`](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)**



---

archive/issue_comments_015019.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nbot is morally green now",
    "created_at": "2021-10-21T11:50:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15019",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:32" align="right">comment:32</div>

bot is morally green now



---

archive/issue_comments_015020.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nSorry for late comment, but how about this?\n\n```diff\n--- a/src/sage/rings/complex_mpfr.pyx\n+++ b/src/sage/rings/complex_mpfr.pyx\n@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n             sage: CC('hello')\n             Traceback (most recent call last):\n             ...\n-            ValueError: given string (hello) is not a complex number\n+            ValueError: given string 'hello' is not a complex number\n         \"\"\"\n         if not isinstance(x, (RealNumber, tuple)):\n             if isinstance(x, ComplexDoubleElement):\n@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n                 x = x.replace('E', 'e')\n                 allowed = '+-.*0123456789Ie'\n                 if not all(letter in allowed for letter in x):\n-                    raise ValueError(f'given string ({x}) is not a complex number')\n+                    raise ValueError(f'given string {x!r} is not a complex number')\n                 # This should rather use a proper parser to validate input.\n                 # TODO: this is probably not the best and most\n                 # efficient way to do this.  -- Martin Albrecht\n```\n\nand `does not express a complex number`.",
    "created_at": "2021-10-22T04:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15020",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:33" align="right">comment:33</div>

Sorry for late comment, but how about this?

```diff
--- a/src/sage/rings/complex_mpfr.pyx
+++ b/src/sage/rings/complex_mpfr.pyx
@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
             sage: CC('hello')
             Traceback (most recent call last):
             ...
-            ValueError: given string (hello) is not a complex number
+            ValueError: given string 'hello' is not a complex number
         """
         if not isinstance(x, (RealNumber, tuple)):
             if isinstance(x, ComplexDoubleElement):
@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
                 x = x.replace('E', 'e')
                 allowed = '+-.*0123456789Ie'
                 if not all(letter in allowed for letter in x):
-                    raise ValueError(f'given string ({x}) is not a complex number')
+                    raise ValueError(f'given string {x!r} is not a complex number')
                 # This should rather use a proper parser to validate input.
                 # TODO: this is probably not the best and most
                 # efficient way to do this.  -- Martin Albrecht
```

and `does not express a complex number`.



---

archive/issue_comments_015021.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.",
    "created_at": "2021-10-22T05:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15021",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:34" align="right">comment:34</div>

Thank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.



---

archive/issue_comments_015022.json:
```json
{
    "body": "Changed commit from **[`feab03f`](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)** to **[`45039da`](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)**",
    "created_at": "2021-10-22T06:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15022",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`feab03f`](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)** to **[`45039da`](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)**



---

archive/issue_comments_015023.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7\"><code>45039da</code></a></td><td><code>some details</code></td></tr></table>\n",
    "created_at": "2021-10-22T06:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15023",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7"><code>45039da</code></a></td><td><code>some details</code></td></tr></table>




---

archive/issue_comments_015024.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nok, done.\n\nWARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').",
    "created_at": "2021-10-22T06:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15024",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:36" align="right">comment:36</div>

ok, done.

WARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').



---

archive/issue_comments_015025.json:
```json
{
    "body": "Changed commit from **[`45039da`](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)** to **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**",
    "created_at": "2021-10-24T07:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15025",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`45039da`](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)** to **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**



---

archive/issue_comments_015026.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0\"><code>57e8e9b</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-24T07:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15026",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0"><code>57e8e9b</code></a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015027.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI fixed the failing doctest",
    "created_at": "2021-10-24T07:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15027",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:38" align="right">comment:38</div>

I fixed the failing doctest



---

archive/issue_events_030516.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-24T23:42:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30516"
}
```



---

archive/issue_events_030517.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-24T23:42:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30517"
}
```



---

archive/issue_comments_015028.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Kwankyu Lee**",
    "created_at": "2021-10-24T23:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15028",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw, Kwankyu Lee**



---

archive/issue_comments_015029.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nGreat, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.",
    "created_at": "2021-10-24T23:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15029",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.



---

archive/issue_comments_015030.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@tscrim](#comment:39):\n> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.\n\nI fully agree. Thanks.",
    "created_at": "2021-10-25T06:11:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15030",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@tscrim](#comment:39):
> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.

I fully agree. Thanks.



---

archive/issue_comments_015031.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nUpdate ticket summary and description\nto better describe the changes made here?\n\n(Or just contract \"should be able to be able to\"\nif the rest is still fine?)",
    "created_at": "2021-10-25T09:59:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15031",
    "user": "https://github.com/slel"
}
```

<div id="comment:41" align="right">comment:41</div>

Update ticket summary and description
to better describe the changes made here?

(Or just contract "should be able to be able to"
if the rest is still fine?)



---

archive/issue_events_030518.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-25T12:05:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "title_is": "security risk -- restrict the input of eval in CC constructor",
    "title_was": "security risk -- several constructors use eval to parse input",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30518"
}
```



---

archive/issue_comments_015032.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nvoil\u00e0, voil\u00e0.",
    "created_at": "2021-10-25T12:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15032",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:42" align="right">comment:42</div>

voilà, voilà.



---

archive/issue_comments_015033.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n \n-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n \n ```\n sage: CC(\"os.getpid()\")\n@@ -11,3 +11,5 @@\n NaN - NaN*I\n sage: CC(\"os.exec(...)\")\n ```\n+\n+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n``````\n",
    "created_at": "2021-10-25T12:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15033",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 
 
-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
 
 ```
 sage: CC("os.getpid()")
@@ -11,3 +11,5 @@
 NaN - NaN*I
 sage: CC("os.exec(...)")
 ```
+
+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.
``````




---

archive/issue_comments_015034.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nMerci.",
    "created_at": "2021-10-25T12:23:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15034",
    "user": "https://github.com/slel"
}
```

<div id="comment:43" align="right">comment:43</div>

Merci.



---

archive/issue_events_030519.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-28T22:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30519"
}
```



---

archive/issue_events_030520.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "7dd78eff361f41195b54ec19fa139ddb5ff8d026",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-28T22:40:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-30520"
}
```



---

archive/issue_comments_015035.json:
```json
{
    "body": "Changed branch from **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)** to **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**",
    "created_at": "2021-10-28T22:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15035",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)** to **[`57e8e9b`](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**
