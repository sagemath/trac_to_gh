# Issue 2877: security risk -- restrict the input of eval in CC constructor

archive/issues_002877.json:
```json
{
    "assignees": [],
    "body": "There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n\nIt is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n\n```\nsage: CC(\"os.getpid()\")\n10324.0000000000\nsage: CC(\"os.mkdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.rmdir('a')\")\nNaN - NaN*I\nsage: CC(\"os.exec(...)\")\n```\n\nIn this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n\nAssignee: **cwitty**\n\nCC:  @tscrim @slel @kliem @kwankyu\n\nBranch/Commit: **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**\n\nReviewer: **Travis Scrimshaw, Kwankyu Lee**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/2877_\n\n",
    "closed_at": "2021-10-28T22:40:01Z",
    "created_at": "2008-04-11T11:39:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "security risk -- restrict the input of eval in CC constructor",
    "type": "issue",
    "updated_at": "2021-10-28T22:40:01Z",
    "url": "https://github.com/sagemath/sage/issues/2877",
    "user": "https://github.com/robertwb"
}
```
There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 

It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 

```
sage: CC("os.getpid()")
10324.0000000000
sage: CC("os.mkdir('a')")
NaN - NaN*I
sage: CC("os.rmdir('a')")
NaN - NaN*I
sage: CC("os.exec(...)")
```

In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.

Assignee: **cwitty**

CC:  @tscrim @slel @kliem @kwankyu

Branch/Commit: **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**

Reviewer: **Travis Scrimshaw, Kwankyu Lee**

Author: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/2877_





---

archive/issue_events_026897.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2008-04-11T11:39:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26897"
}
```



---

archive/issue_events_026898.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2008-04-11T11:39:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26898"
}
```



---

archive/issue_comments_015728.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nSee #2347 which is related.",
    "created_at": "2008-04-11T11:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15728",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:1'>Comment 1:</a>
See #2347 which is related.



---

archive/issue_events_026899.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-04-11T19:33:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-3.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26899"
}
```



---

archive/issue_events_026900.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26900"
}
```



---

archive/issue_events_026901.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-01-23T02:46:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26901"
}
```



---

archive/issue_events_026902.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26902"
}
```



---

archive/issue_events_026903.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26903"
}
```



---

archive/issue_events_026904.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26904"
}
```



---

archive/issue_events_026905.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26905"
}
```



---

archive/issue_events_026906.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26906"
}
```



---

archive/issue_events_026907.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26907"
}
```



---

archive/issue_events_026908.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26908"
}
```



---

archive/issue_events_026909.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26909"
}
```



---

archive/issue_events_026910.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26910"
}
```



---

archive/issue_events_026911.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26911"
}
```



---

archive/issue_events_026912.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26912"
}
```



---

archive/issue_events_026913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26913"
}
```



---

archive/issue_comments_015729.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-09-02T09:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15729",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_015730.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nSage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!",
    "created_at": "2014-09-02T09:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15730",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'>Comment 8:</a>
Sage is not a secure program and nobody ever claimed it was. Sanitise your input before sending it to Sage!



---

archive/issue_events_026914.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26914"
}
```



---

archive/issue_events_026915.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-02T09:00:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26915"
}
```



---

archive/issue_events_026916.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:52:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26916"
}
```



---

archive/issue_events_026917.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:52:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26917"
}
```



---

archive/issue_comments_015731.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nA strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )\n\nIf you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.",
    "created_at": "2019-07-05T16:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15731",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'>Comment 11:</a>
A strange response coming from Jeroen.  The use of `sage_eval` to convert arbitrary string inputs to elements of different fields is, I think, obviously bad on so many levels, and badly mishandled in several cases (e.g. some of them will catch `NameError`s, but not `SyntaxError`s; some will just work, but in weird ways, if you pass some arbitrary string; some are just broken as in https://ask.sagemath.org/question/47068/possible-bug-in-cc-needs-confirmation )

If you want to convert string representations of some elements of a field to actual elements of that field there should be proper parsing, not just arbitrary evals.



---

archive/issue_events_026918.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26918"
}
```



---

archive/issue_events_026919.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-05T16:41:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26919"
}
```



---

archive/issue_comments_015732.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nA simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n\nThe reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.",
    "created_at": "2019-07-06T12:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15732",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'>Comment 12:</a>
A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/

The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.



---

archive/issue_comments_015733.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI fully agree with Erik.\n\nThe following does not work (as expected)\n\n```\nsage: ZZ('2**3 + 3*g - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3 + 3*g - 2' to an integer\nsage: RR('2**2 + 3*5 - 2')\nTraceback (most recent call last):\n...\nTypeError: unable to convert '2**3+5*I-2' to a real number\n```\nSupporting the following with `CC` is a nonsense\n\n```\nsage: CC('2**2 + 3*5 - 2')\n17.0000000000000\nsage: CC('erf(2)')\n0.995322265018953\n```\nWe don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.",
    "created_at": "2019-07-11T19:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15733",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'>Comment 13:</a>
I fully agree with Erik.

The following does not work (as expected)

```
sage: ZZ('2**3 + 3*g - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3 + 3*g - 2' to an integer
sage: RR('2**2 + 3*5 - 2')
Traceback (most recent call last):
...
TypeError: unable to convert '2**3+5*I-2' to a real number
```
Supporting the following with `CC` is a nonsense

```
sage: CC('2**2 + 3*5 - 2')
17.0000000000000
sage: CC('erf(2)')
0.995322265018953
```
We don't want the element constructor to evaluate a string in hope that it gives a complex number. There should be a clear definition of what is the input format. And the constructor should just stick to specifications. The element constructor of CC is trying to do much more than what it is supposed to.



---

archive/issue_comments_015734.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nAnd to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket \"fix element constructor of CC\".",
    "created_at": "2019-07-11T19:57:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15734",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'>Comment 14:</a>
And to my mind the main problem is **not** the security risk (I agree with Jeroen on that point). I would advice to open another ticket "fix element constructor of CC".



---

archive/issue_comments_015735.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nIt's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.",
    "created_at": "2019-07-12T08:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15735",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'>Comment 15:</a>
It's not just CC.  It's all of them.  It's really flaky to allow a general eval to construct instances of some particular type.  Instead, it should really just parse constant-valued expressions for whatever that type is, at the most.  That can either involve custom parsing code, or as Volker suggested a custom AST parser.



---

archive/issue_comments_015736.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@vbraun](#comment%3A12):\n> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/\n> \n> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.\n\n+1",
    "created_at": "2019-07-12T08:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15736",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@vbraun](#comment%3A12):
> A simpler fix would be to use a limited eval, e.g. https://newville.github.io/asteval/
> 
> The reason for the eval in CC is of course that you want to allow expressions like `2+3*I` that exceed python's `literal_eval` capabilities.

+1



---

archive/issue_events_026920.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26920"
}
```



---

archive/issue_events_026921.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26921"
}
```



---

archive/issue_comments_015737.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15737",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'>Comment 17:</a>
Ticket retargeted after milestone closed



---

archive/issue_comments_015738.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15738",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>Comment 18:</a>
Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_026922.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26922"
}
```



---

archive/issue_events_026923.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26923"
}
```



---

archive/issue_events_026924.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26924"
}
```



---

archive/issue_events_026925.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26925"
}
```



---

archive/issue_comments_015739.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15739",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'>Comment 20:</a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_026926.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26926"
}
```



---

archive/issue_events_026927.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26927"
}
```



---

archive/issue_events_026928.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26928"
}
```



---

archive/issue_events_026929.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26929"
}
```



---

archive/issue_comments_015740.json:
```json
{
    "body": "Commit: **[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15740",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)**



---

archive/issue_comments_015741.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nhere is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923\">1e89c2a</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15741",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'>Comment 22:</a>
here is a simple-minded patch. Unless somebody proposes something better, I think it makes sense to merge that now

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923">1e89c2a</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015742.json:
```json
{
    "body": "Branch: **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15742",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)**



---

archive/issue_events_026930.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-19T15:03:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26930"
}
```



---

archive/issue_comments_015743.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2021-10-19T15:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15743",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_comments_015744.json:
```json
{
    "body": "Changed commit from **[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)** to **[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)**",
    "created_at": "2021-10-19T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15744",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1e89c2a](https://github.com/sagemath/sagetrac-mirror/commit/1e89c2acb8b9fdccfa475dd45d33007cd1cd6923)** to **[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)**



---

archive/issue_comments_015745.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa\">57d20f1</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-19T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15745",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa">57d20f1</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015746.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to none",
    "created_at": "2021-10-20T07:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15746",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Jeroen Demeyer** to none



---

archive/issue_comments_015747.json:
```json
{
    "body": "Changed commit from **[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)** to **[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)**",
    "created_at": "2021-10-20T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15747",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[57d20f1](https://github.com/sagemath/sagetrac-mirror/commit/57d20f14f55b063e9b4b9456827d5030be7b31aa)** to **[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)**



---

archive/issue_comments_015748.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec\">e59be13</a></td><td><code>Merge branch 'u/chapoton/2877' in 9.5.b4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9\">53f6c2a</a></td><td><code>fix some CC bad string input</code></td></tr></table>\n",
    "created_at": "2021-10-20T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15748",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e59be135e297376d469ad6c5f16d7dffce39d4ec">e59be13</a></td><td><code>Merge branch 'u/chapoton/2877' in 9.5.b4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9">53f6c2a</a></td><td><code>fix some CC bad string input</code></td></tr></table>




---

archive/issue_comments_015749.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nbot is morally green, so please review",
    "created_at": "2021-10-20T11:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15749",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'>Comment 26:</a>
bot is morally green, so please review



---

archive/issue_comments_015750.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nDo we also want to allow `j` to match Python's convention for complex numbers:\n\n```sage\nsage: complex('1+2j')\n(1+2j)\nsage: complex('1+2i')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-2-a2113f9c148b> in <module>\n----> 1 complex('1+2i')\n\nValueError: complex() arg is a malformed string\n```",
    "created_at": "2021-10-20T23:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15750",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'>Comment 27:</a>
Do we also want to allow `j` to match Python's convention for complex numbers:

```sage
sage: complex('1+2j')
(1+2j)
sage: complex('1+2i')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-a2113f9c148b> in <module>
----> 1 complex('1+2i')

ValueError: complex() arg is a malformed string
```



---

archive/issue_comments_015751.json:
```json
{
    "body": "Changed commit from **[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)** to **[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)**",
    "created_at": "2021-10-21T07:00:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15751",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[53f6c2a](https://github.com/sagemath/sagetrac-mirror/commit/53f6c2a3e36b4c9e8f9d60a9027f9dfdef1f21c9)** to **[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)**



---

archive/issue_comments_015752.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c\">77031e8</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-21T07:00:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15752",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c">77031e8</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015753.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nok, done (and squashed the commits)",
    "created_at": "2021-10-21T07:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15753",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'>Comment 29:</a>
ok, done (and squashed the commits)



---

archive/issue_comments_015754.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nbut this will break the doctest in singular.pyx... (sigh)",
    "created_at": "2021-10-21T07:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15754",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'>Comment 30:</a>
but this will break the doctest in singular.pyx... (sigh)



---

archive/issue_comments_015755.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68\">feab03f</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-21T07:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15755",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68">feab03f</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015756.json:
```json
{
    "body": "Changed commit from **[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)** to **[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)**",
    "created_at": "2021-10-21T07:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15756",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[77031e8](https://github.com/sagemath/sagetrac-mirror/commit/77031e8a39e6470b0eb3981f69f61f27a2d7ef5c)** to **[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)**



---

archive/issue_comments_015757.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nbot is morally green now",
    "created_at": "2021-10-21T11:50:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15757",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'>Comment 32:</a>
bot is morally green now



---

archive/issue_comments_015758.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nSorry for late comment, but how about this?\n\n```diff\n--- a/src/sage/rings/complex_mpfr.pyx\n+++ b/src/sage/rings/complex_mpfr.pyx\n@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n             sage: CC('hello')\n             Traceback (most recent call last):\n             ...\n-            ValueError: given string (hello) is not a complex number\n+            ValueError: given string 'hello' is not a complex number\n         \"\"\"\n         if not isinstance(x, (RealNumber, tuple)):\n             if isinstance(x, ComplexDoubleElement):\n@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):\n                 x = x.replace('E', 'e')\n                 allowed = '+-.*0123456789Ie'\n                 if not all(letter in allowed for letter in x):\n-                    raise ValueError(f'given string ({x}) is not a complex number')\n+                    raise ValueError(f'given string {x!r} is not a complex number')\n                 # This should rather use a proper parser to validate input.\n                 # TODO: this is probably not the best and most\n                 # efficient way to do this.  -- Martin Albrecht\n```\n\nand `does not express a complex number`.",
    "created_at": "2021-10-22T04:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15758",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:33'>Comment 33:</a>
Sorry for late comment, but how about this?

```diff
--- a/src/sage/rings/complex_mpfr.pyx
+++ b/src/sage/rings/complex_mpfr.pyx
@@ -504,7 +504,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
             sage: CC('hello')
             Traceback (most recent call last):
             ...
-            ValueError: given string (hello) is not a complex number
+            ValueError: given string 'hello' is not a complex number
         """
         if not isinstance(x, (RealNumber, tuple)):
             if isinstance(x, ComplexDoubleElement):
@@ -516,7 +516,7 @@ class ComplexField_class(sage.rings.abc.ComplexField):
                 x = x.replace('E', 'e')
                 allowed = '+-.*0123456789Ie'
                 if not all(letter in allowed for letter in x):
-                    raise ValueError(f'given string ({x}) is not a complex number')
+                    raise ValueError(f'given string {x!r} is not a complex number')
                 # This should rather use a proper parser to validate input.
                 # TODO: this is probably not the best and most
                 # efficient way to do this.  -- Martin Albrecht
```

and `does not express a complex number`.



---

archive/issue_comments_015759.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nThank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.",
    "created_at": "2021-10-22T05:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15759",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'>Comment 34:</a>
Thank you. I am also wondering a bit if we want to document that `CC` also supports `j` as a valid string input. Although I don't hold a strong opinion on this.



---

archive/issue_comments_015760.json:
```json
{
    "body": "Changed commit from **[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)** to **[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)**",
    "created_at": "2021-10-22T06:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15760",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[feab03f](https://github.com/sagemath/sagetrac-mirror/commit/feab03f2ae95b6f4452bbc3211e6a84ad56aad68)** to **[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)**



---

archive/issue_comments_015761.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7\">45039da</a></td><td><code>some details</code></td></tr></table>\n",
    "created_at": "2021-10-22T06:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15761",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>Comment 35:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7">45039da</a></td><td><code>some details</code></td></tr></table>




---

archive/issue_comments_015762.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nok, done.\n\nWARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').",
    "created_at": "2021-10-22T06:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15762",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'>Comment 36:</a>
ok, done.

WARNING: note that CC('1.0+2.0*j') works, but not CC('1.0+2.0j').



---

archive/issue_comments_015763.json:
```json
{
    "body": "Changed commit from **[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)** to **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**",
    "created_at": "2021-10-24T07:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15763",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[45039da](https://github.com/sagemath/sagetrac-mirror/commit/45039da5348873d5363020f0cde9e5996e4b3de7)** to **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**



---

archive/issue_comments_015764.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0\">57e8e9b</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>\n",
    "created_at": "2021-10-24T07:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15764",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>Comment 37:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0">57e8e9b</a></td><td><code>simple-minded check for string input of CC</code></td></tr></table>




---

archive/issue_comments_015765.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nI fixed the failing doctest",
    "created_at": "2021-10-24T07:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15765",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:38'>Comment 38:</a>
I fixed the failing doctest



---

archive/issue_events_026931.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-24T23:42:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26931"
}
```



---

archive/issue_events_026932.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-24T23:42:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26932"
}
```



---

archive/issue_comments_015766.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Kwankyu Lee**",
    "created_at": "2021-10-24T23:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15766",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw, Kwankyu Lee**



---

archive/issue_comments_015767.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nGreat, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.",
    "created_at": "2021-10-24T23:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15767",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'>Comment 39:</a>
Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.



---

archive/issue_comments_015768.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nReplying to [@tscrim](#comment%3A39):\n> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.\n\nI fully agree. Thanks.",
    "created_at": "2021-10-25T06:11:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15768",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:40'>Comment 40:</a>
Replying to [@tscrim](#comment%3A39):
> Great, thank you. LGTM. Kwankyu, if you do not agree, feel free to revert the positive review.

I fully agree. Thanks.



---

archive/issue_comments_015769.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nUpdate ticket summary and description\nto better describe the changes made here?\n\n(Or just contract \"should be able to be able to\"\nif the rest is still fine?)",
    "created_at": "2021-10-25T09:59:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15769",
    "user": "https://github.com/slel"
}
```

<a id='comment:41'>Comment 41:</a>
Update ticket summary and description
to better describe the changes made here?

(Or just contract "should be able to be able to"
if the rest is still fine?)



---

archive/issue_events_026933.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-25T12:05:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "title_is": "security risk -- restrict the input of eval in CC constructor",
    "title_was": "security risk -- several constructors use eval to parse input",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26933"
}
```



---

archive/issue_comments_015770.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nvoil\u00e0, voil\u00e0.",
    "created_at": "2021-10-25T12:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15770",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'>Comment 42:</a>
voilà, voilà.



---

archive/issue_comments_015771.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. \n \n-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary \n \n ```\n sage: CC(\"os.getpid()\")\n@@ -11,3 +11,5 @@\n NaN - NaN*I\n sage: CC(\"os.exec(...)\")\n ```\n+\n+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.\n``````\n",
    "created_at": "2021-10-25T12:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15771",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 There are valid uses for eval() and sage_eval(), it makes it much easier to parse output from  interfaces for example. 
 
-It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
+It is difficult (if not impossible) to completely sanitize arbitrary input, but one should be able to (say) write a backend that takes specific data, calls on Sage to process it, and then returns the result. For example, I might want a webpage that uses Sage to compute Julia sets, and takes as input a complex number. That the following work is scary 
 
 ```
 sage: CC("os.getpid()")
@@ -11,3 +11,5 @@
 NaN - NaN*I
 sage: CC("os.exec(...)")
 ```
+
+In this ticket, one introduces restrictions on the text input to CC that prevent most of these terrible examples.
``````




---

archive/issue_comments_015772.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nMerci.",
    "created_at": "2021-10-25T12:23:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15772",
    "user": "https://github.com/slel"
}
```

<a id='comment:43'>Comment 43:</a>
Merci.



---

archive/issue_events_026934.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-28T22:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26934"
}
```



---

archive/issue_events_026935.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "7dd78eff361f41195b54ec19fa139ddb5ff8d026",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-28T22:40:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/2877#event-26935"
}
```



---

archive/issue_comments_015773.json:
```json
{
    "body": "Changed branch from **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)** to **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**",
    "created_at": "2021-10-28T22:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/2877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/2877#issuecomment-15773",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/2877](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/2877)** to **[57e8e9b](https://github.com/sagemath/sagetrac-mirror/commit/57e8e9bc41c8e41eca5cad8879e67ba49089a4f0)**
