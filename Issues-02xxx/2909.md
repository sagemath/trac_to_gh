# Issue 2909: notebook -- implement a way of parsing script tags in output as they appear (but none that already appeared)

archive/issues_002909.json:
```json
{
    "body": "The canonical example to get to work is the following (submitted by Jason Grout):\n\n```\nfor i in range(5):\n    print html('<script>alert(%s)</script>'%i)\n    sleep(1)\n```\n\nwould pop up a dialog box about every second.\n\n\nThis feature was requested by `gerhard <ge01705@yahoo.de>`.\n\n**Assignee:** boothby\n\n**CC:**  @qed777\n\nIssue created by migration from https://trac.sagemath.org/ticket/2909\n\n",
    "closed_at": "2020-03-29T02:03:43Z",
    "created_at": "2008-04-13T18:04:03Z",
    "labels": [
        "component: notebook",
        "enhancement",
        "invalid"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "notebook -- implement a way of parsing script tags in output as they appear (but none that already appeared)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/2909",
    "user": "https://github.com/williamstein"
}
```
The canonical example to get to work is the following (submitted by Jason Grout):

```
for i in range(5):
    print html('<script>alert(%s)</script>'%i)
    sleep(1)
```

would pop up a dialog box about every second.


This feature was requested by `gerhard <ge01705@yahoo.de>`.

**Assignee:** boothby

**CC:**  @qed777

Issue created by migration from https://trac.sagemath.org/ticket/2909





---

archive/issue_comments_016296.json:
```json
{
    "body": "<a id='comment:1'></a>\nI don't know the details of the notebook source code, but one possible way to run javascript code out of javascript is writing it dynamically into the source, because it get's evaluated. The hack: unescape escaped characters!\n\n```\n<html>\n<head>\n<script type=\"text/javascript\">\nfunction run() {\n   eval(cmd);\n}\n</script>\n</head>\n<body>\n\n<script type=\"text/javascript\">\ncmd = 'alert(\"I am an alert\")';\n</script>\n\n<script type=\"text/javascript\">\ndocument.write(unescape(\"%3Cscript type='text/javascript'%3E\" + \"run('\" + cmd + \"');\" + \"%3C/script%3E\"));\n</script>\n\n</body>\n</html>\n```\n\nthe generated source code, after running everything, relevant part:\n\n```\n<script type=\"text/javascript\">\ndocument.write(unescape(\"%3Cscript type='text/javascript'%3E\" + \"run('\" + cmd + \"');\" + \"%3C/script%3E\"));\n</script><script type=\"text/javascript\">run('alert(\"I am an alert\")');</script>\n```",
    "created_at": "2008-04-14T08:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2909#issuecomment-16296",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:1'></a>
I don't know the details of the notebook source code, but one possible way to run javascript code out of javascript is writing it dynamically into the source, because it get's evaluated. The hack: unescape escaped characters!

```
<html>
<head>
<script type="text/javascript">
function run() {
   eval(cmd);
}
</script>
</head>
<body>

<script type="text/javascript">
cmd = 'alert("I am an alert")';
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript type='text/javascript'%3E" + "run('" + cmd + "');" + "%3C/script%3E"));
</script>

</body>
</html>
```

the generated source code, after running everything, relevant part:

```
<script type="text/javascript">
document.write(unescape("%3Cscript type='text/javascript'%3E" + "run('" + cmd + "');" + "%3C/script%3E"));
</script><script type="text/javascript">run('alert("I am an alert")');</script>
```



---

archive/issue_comments_016297.json:
```json
{
    "body": "<a id='comment:2'></a>\nok, i'm confused, maybe my last comment is helpful for something else - just tested the cannonical exmaple, and it works for me.",
    "created_at": "2008-04-14T09:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2909#issuecomment-16297",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:2'></a>
ok, i'm confused, maybe my last comment is helpful for something else - just tested the cannonical exmaple, and it works for me.



---

archive/issue_events_015648.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-17T00:13:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15648"
}
```



---

archive/issue_events_015649.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-17T00:13:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15649"
}
```



---

archive/issue_comments_016298.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2010-01-17T00:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2909#issuecomment-16298",
    "user": "https://github.com/TimDumol"
}
```

**Upstream:** N/A



---

archive/issue_events_015650.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15650"
}
```



---

archive/issue_events_015651.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15651"
}
```



---

archive/issue_events_015652.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15652"
}
```



---

archive/issue_events_015653.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15653"
}
```



---

archive/issue_events_015654.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15654"
}
```



---

archive/issue_events_015655.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15655"
}
```



---

archive/issue_events_015656.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15656"
}
```



---

archive/issue_events_015657.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15657"
}
```



---

archive/issue_comments_016299.json:
```json
{
    "body": "<a id='comment:9'></a>\n> ok, i'm confused, maybe my last comment is helpful for something else - just tested the cannonical exmaple, and it works for me.\n\n\nAh, but *does* it?  For me, it first prints out the (empty) lines every second, and only then all the alerts come up (in order) at once.",
    "created_at": "2014-09-18T02:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2909#issuecomment-16299",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
> ok, i'm confused, maybe my last comment is helpful for something else - just tested the cannonical exmaple, and it works for me.


Ah, but *does* it?  For me, it first prints out the (empty) lines every second, and only then all the alerts come up (in order) at once.



---

archive/issue_events_015658.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/boothby",
    "created_at": "2020-03-29T02:03:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15658"
}
```



---

archive/issue_comments_016300.json:
```json
{
    "body": "<a id='comment:10'></a>\nClosing deprecated notebook tickets",
    "created_at": "2020-03-29T02:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/2909#issuecomment-16300",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:10'></a>
Closing deprecated notebook tickets



---

archive/issue_events_015659.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/boothby",
    "created_at": "2020-03-29T02:03:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/2909",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/2909#event-15659"
}
```
