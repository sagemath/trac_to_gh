# Issue 13033: make LP return bounds on variables

archive/issues_013033.json:
```json
{
    "body": "Assignee: ncohen\n\nCC:  ppurka\n\nCurrently there is no way to find the lower and the upper bounds on the variables of an LP. However, this (often crucial!) information is readily available from the backend. Hence the patch attached.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13205\n\n",
    "created_at": "2012-07-05T12:55:49Z",
    "labels": [
        "linear programming",
        "major",
        "enhancement"
    ],
    "title": "make LP return bounds on variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13033",
    "user": "dimpase"
}
```
Assignee: ncohen

CC:  ppurka

Currently there is no way to find the lower and the upper bounds on the variables of an LP. However, this (often crucial!) information is readily available from the backend. Hence the patch attached.

Issue created by migration from https://trac.sagemath.org/ticket/13205





---

archive/issue_comments_157713.json:
```json
{
    "body": "Do you have something different from http://goo.gl/HEUdk in mind ?",
    "created_at": "2012-07-05T13:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157713",
    "user": "ncohen"
}
```

Do you have something different from http://goo.gl/HEUdk in mind ?



---

archive/issue_comments_157714.json:
```json
{
    "body": "make (I)LP return bounds on variables",
    "created_at": "2012-07-05T13:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157714",
    "user": "dimpase"
}
```

make (I)LP return bounds on variables



---

archive/issue_comments_157715.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-05T13:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157715",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_157716.json:
```json
{
    "body": "Attachment [trac_13205_LP_return_bounds_on_variables.patch](tarball://root/attachments/some-uuid/ticket13205/trac_13205_LP_return_bounds_on_variables.patch) by dimpase created at 2012-07-05 13:10:50\n\nReplying to [comment:1 ncohen]:\n> Do you have something different from http://goo.gl/HEUdk in mind ?\n\nI don't want to access variables via dictionaries, as this is flaky.\nE.g. think of that extra variables Gurobi adds on the fly, one can't put hands on them at all.",
    "created_at": "2012-07-05T13:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157716",
    "user": "dimpase"
}
```

Attachment [trac_13205_LP_return_bounds_on_variables.patch](tarball://root/attachments/some-uuid/ticket13205/trac_13205_LP_return_bounds_on_variables.patch) by dimpase created at 2012-07-05 13:10:50

Replying to [comment:1 ncohen]:
> Do you have something different from http://goo.gl/HEUdk in mind ?

I don't want to access variables via dictionaries, as this is flaky.
E.g. think of that extra variables Gurobi adds on the fly, one can't put hands on them at all.



---

archive/issue_comments_157717.json:
```json
{
    "body": "Yep, but then we would have two ways to do the same thing, with methods that take different arguments. What about changing get_min and get_max so that they accept integers instead ?\n\nAll that would need to be added is a type check : if the given value is a MIPVariable type then the old code (one line) is used, and otherwise the backend function is called.\n\nActually, the only line that this function contains is \n\n```\nreturn self._backend.variable_lower_bound(self._variables[v])\n```\n\nThat is : first take the integer corresponding to the variable, then return the value. More or less what you want to do too `:-P`\n\nNathann",
    "created_at": "2012-07-05T13:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157717",
    "user": "ncohen"
}
```

Yep, but then we would have two ways to do the same thing, with methods that take different arguments. What about changing get_min and get_max so that they accept integers instead ?

All that would need to be added is a type check : if the given value is a MIPVariable type then the old code (one line) is used, and otherwise the backend function is called.

Actually, the only line that this function contains is 

```
return self._backend.variable_lower_bound(self._variables[v])
```

That is : first take the integer corresponding to the variable, then return the value. More or less what you want to do too `:-P`

Nathann



---

archive/issue_comments_157718.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> Yep, but then we would have two ways to do the same thing, with methods that take different arguments. What about changing get_min and get_max so that they accept integers instead ?\n\n\nBut then one would also want to have this for `set_max()` and `set_min()`, for interface consistency ?",
    "created_at": "2012-07-05T13:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157718",
    "user": "dimpase"
}
```

Replying to [comment:5 ncohen]:
> Yep, but then we would have two ways to do the same thing, with methods that take different arguments. What about changing get_min and get_max so that they accept integers instead ?


But then one would also want to have this for `set_max()` and `set_min()`, for interface consistency ?



---

archive/issue_comments_157719.json:
```json
{
    "body": "Yeah, I guess. Or we can also merge everything into a variable_min and variable_max functions with which you can also set values. What do you think is best ?",
    "created_at": "2012-07-05T13:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157719",
    "user": "ncohen"
}
```

Yeah, I guess. Or we can also merge everything into a variable_min and variable_max functions with which you can also set values. What do you think is best ?



---

archive/issue_comments_157720.json:
```json
{
    "body": "Replying to [comment:7 ncohen]:\n> Yeah, I guess. Or we can also merge everything into a variable_min and variable_max functions with which you can also set values. What do you think is best ?\n\nI pondered this question deeply :\u2013) No, it's bad enough that `p.get_max(v[9999999])` will always create `v[9999999]` if it does not exist, instead of throwing `ValueError`, while `p.get_max(9999999)` will throw `ValueError`.\n\nI'd really prefer this two-tier approach, when user-defined variables and solver variables are kept apart interface-wise.\n\nBy the way, it also looks strange that `v` doesn't even know its (I)LP. Or can it be in several LPs at the same time?",
    "created_at": "2012-07-05T14:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157720",
    "user": "dimpase"
}
```

Replying to [comment:7 ncohen]:
> Yeah, I guess. Or we can also merge everything into a variable_min and variable_max functions with which you can also set values. What do you think is best ?

I pondered this question deeply :–) No, it's bad enough that `p.get_max(v[9999999])` will always create `v[9999999]` if it does not exist, instead of throwing `ValueError`, while `p.get_max(9999999)` will throw `ValueError`.

I'd really prefer this two-tier approach, when user-defined variables and solver variables are kept apart interface-wise.

By the way, it also looks strange that `v` doesn't even know its (I)LP. Or can it be in several LPs at the same time?



---

archive/issue_comments_157721.json:
```json
{
    "body": "> I pondered this question deeply :\u2013) No, it's bad enough that `p.get_max(v[9999999])` will always create `v[9999999]` if it does not exist, instead of throwing `ValueError`, while `p.get_max(9999999)` will throw `ValueError`.\n\nI know it's ugly, but consider all the LP that only work this way. Honestly, having to declare the variables first would really be a huge mess.\n\n> I'd really prefer this two-tier approach, when user-defined variables and solver variables are kept apart interface-wise.\n\nYeah, but then again it would mean that we need to have two copies of each command, according to how the data is given...\n\nActually, do you really need to work with MixedIntegerLinearProgam ? It looks like all you want is to access the backend's methods directly, and this you can do if you just deal with GenericBackend.\nWhat about just working with this, and adding to it what you miss from MixedIntegerLinearProgram ?\n\n> By the way, it also looks strange that `v` doesn't even know its (I)LP. Or can it be in several LPs at the same time?\n\nWell, you can mess up with two instances of MixedIntegerLinearProgram so badly that they would have common variables, and this would work, but that would just be for the show `:-D`\n\nSome time ago I think the variables knew about their LP, but because the LP also knew about the variables it produced a cyclic reference, and Python had to be forced to deallocate the two elements -- I think we removed that not so long ago, while dealing with Cliquer's many memory leaks. Which are fixed in a patch, btw `:-)`\n\nNathann",
    "created_at": "2012-07-05T14:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157721",
    "user": "ncohen"
}
```

> I pondered this question deeply :–) No, it's bad enough that `p.get_max(v[9999999])` will always create `v[9999999]` if it does not exist, instead of throwing `ValueError`, while `p.get_max(9999999)` will throw `ValueError`.

I know it's ugly, but consider all the LP that only work this way. Honestly, having to declare the variables first would really be a huge mess.

> I'd really prefer this two-tier approach, when user-defined variables and solver variables are kept apart interface-wise.

Yeah, but then again it would mean that we need to have two copies of each command, according to how the data is given...

Actually, do you really need to work with MixedIntegerLinearProgam ? It looks like all you want is to access the backend's methods directly, and this you can do if you just deal with GenericBackend.
What about just working with this, and adding to it what you miss from MixedIntegerLinearProgram ?

> By the way, it also looks strange that `v` doesn't even know its (I)LP. Or can it be in several LPs at the same time?

Well, you can mess up with two instances of MixedIntegerLinearProgram so badly that they would have common variables, and this would work, but that would just be for the show `:-D`

Some time ago I think the variables knew about their LP, but because the LP also knew about the variables it produced a cyclic reference, and Python had to be forced to deallocate the two elements -- I think we removed that not so long ago, while dealing with Cliquer's many memory leaks. Which are fixed in a patch, btw `:-)`

Nathann



---

archive/issue_comments_157722.json:
```json
{
    "body": "Replying to [comment:9 ncohen]:\n> Actually, do you really need to work with `MixedIntegerLinearProgam` ? It looks like all you want is to access the backend's methods directly, and this you can do if you just deal with `GenericBackend`.\n> What about just working with this, and adding to it what you miss from `MixedIntegerLinearProgram` ?\n\nOK, I can move this function into `GenericBackend`.\nWould this work for you?\n\n> \n> Some time ago I think the variables knew about their LP, but because the LP also knew about the variables it produced a cyclic reference, and Python had to be forced to deallocate the two elements -- I think we removed that not so long ago, while dealing with Cliquer's many memory leaks. Which are fixed in a patch, btw `:-)`\n\nhmm, I thought that one just cannot have `__del__` in these classes, and then they would be garbage-collected just fine...",
    "created_at": "2012-07-05T16:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157722",
    "user": "dimpase"
}
```

Replying to [comment:9 ncohen]:
> Actually, do you really need to work with `MixedIntegerLinearProgam` ? It looks like all you want is to access the backend's methods directly, and this you can do if you just deal with `GenericBackend`.
> What about just working with this, and adding to it what you miss from `MixedIntegerLinearProgram` ?

OK, I can move this function into `GenericBackend`.
Would this work for you?

> 
> Some time ago I think the variables knew about their LP, but because the LP also knew about the variables it produced a cyclic reference, and Python had to be forced to deallocate the two elements -- I think we removed that not so long ago, while dealing with Cliquer's many memory leaks. Which are fixed in a patch, btw `:-)`

hmm, I thought that one just cannot have `__del__` in these classes, and then they would be garbage-collected just fine...



---

archive/issue_comments_157723.json:
```json
{
    "body": "> OK, I can move this function into `GenericBackend`.\n> Would this work for you?\n\nWell, that's the point : the GenericBackend class already has such methods that let you read/set variables bounds from their ID. And of course at this level everything is done through ID.\n\n> hmm, I thought that one just cannot have `__del__` in these classes, and then they would be garbage-collected just fine...\n\nYep, they were garbage-collected but you had to wait for the garbage collector to be called, which is not all the time. A user complained of memory leaks when solving many many many LP in a loop (solving a LP for all graphs on n vertices), and this was one source of problems. When youi remove cyclic dependencies the objects are deallocated without any call to the garbage collector, and in his case it made a difference.",
    "created_at": "2012-07-05T16:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157723",
    "user": "ncohen"
}
```

> OK, I can move this function into `GenericBackend`.
> Would this work for you?

Well, that's the point : the GenericBackend class already has such methods that let you read/set variables bounds from their ID. And of course at this level everything is done through ID.

> hmm, I thought that one just cannot have `__del__` in these classes, and then they would be garbage-collected just fine...

Yep, they were garbage-collected but you had to wait for the garbage collector to be called, which is not all the time. A user complained of memory leaks when solving many many many LP in a loop (solving a LP for all graphs on n vertices), and this was one source of problems. When youi remove cyclic dependencies the objects are deallocated without any call to the garbage collector, and in his case it made a difference.



---

archive/issue_comments_157724.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-07-05T17:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157724",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_157725.json:
```json
{
    "body": "> UPDATE: OK, I was convinced by Nathann that this is not needed.\n\nDo you mean to say that this ticket is not needed? If so, this should be closed.",
    "created_at": "2012-07-12T19:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157725",
    "user": "ppurka"
}
```

> UPDATE: OK, I was convinced by Nathann that this is not needed.

Do you mean to say that this ticket is not needed? If so, this should be closed.



---

archive/issue_comments_157726.json:
```json
{
    "body": "Please give it a positive review, and we'll mark it as won't fix or some such...",
    "created_at": "2012-07-13T00:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157726",
    "user": "dimpase"
}
```

Please give it a positive review, and we'll mark it as won't fix or some such...



---

archive/issue_comments_157727.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-13T00:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157727",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_157728.json:
```json
{
    "body": "Sorry, I must have missed this last message.",
    "created_at": "2012-07-15T10:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157728",
    "user": "ppurka"
}
```

Sorry, I must have missed this last message.



---

archive/issue_comments_157729.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-07-15T10:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157729",
    "user": "ppurka"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_157730.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2012-07-16T11:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157730",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_157731.json:
```json
{
    "body": "Please clarify: does something need to be merged or not (if not: set the milestone to sage-duplicate/invalid/wontfix).",
    "created_at": "2012-07-16T11:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157731",
    "user": "jdemeyer"
}
```

Please clarify: does something need to be merged or not (if not: set the milestone to sage-duplicate/invalid/wontfix).



---

archive/issue_comments_157732.json:
```json
{
    "body": "Replying to [comment:16 jdemeyer]:\n> Please clarify: does something need to be merged or not (if not: set the milestone to sage-duplicate/invalid/wontfix).\n\nOK, I was not sure how to do this.",
    "created_at": "2012-07-16T12:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157732",
    "user": "dimpase"
}
```

Replying to [comment:16 jdemeyer]:
> Please clarify: does something need to be merged or not (if not: set the milestone to sage-duplicate/invalid/wontfix).

OK, I was not sure how to do this.



---

archive/issue_comments_157733.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-07-16T12:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157733",
    "user": "dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_157734.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-07-16T12:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157734",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_157735.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2012-07-17T08:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13033",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13033#issuecomment-157735",
    "user": "jdemeyer"
}
```

Resolution: wontfix
