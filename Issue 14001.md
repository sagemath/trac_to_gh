# Issue 14001: polybori doctests involve randomness

Issue created by migration from https://trac.sagemath.org/ticket/14205

Original creator: tkluck

Original creation time: 2013-02-28 16:43:39

Assignee: AlexGhitza

CC:  alexanderdreyer

As discusses in #13767, there is some doctests for the `random_set` function in polybori that have inherent random results. Because of that, they might break if the implementation of random functions changes, such as what happened in that ticket.

This is a rare occasion, but still it might be worthwhile to change these kind of doctests to only check for documented behavior. 

For example, the doctests could check that `result = random_set(monomial, n)` should obey `len(result) == n` and `result.diff(monomial.divisors()).empty()`. (suggested by Alexander Dreyer)

Or we could test against theorems (such as: One has random data, but the test is using an identity that must hold for any data). (suggested by Simon King) 


---

Comment by vbraun created at 2013-02-28 18:23:14

I'd rather have the output of boost.Random doctested so we know when the implementation changes. We also test all other RNGs to verify that the sequence that they produce is actually the same, that is, we set the seed correctly.


---

Comment by AlexanderDreyer created at 2013-03-01 09:21:09

Replying to [comment:1 vbraun]:
> I'd rather have the output of boost.Random doctested so we know when the implementation changes. We also test all other RNGs to verify that the sequence that they produce is actually the same, that is, we set the seed correctly.
Well, I understood from the discussion here, that the test should not depend on the random generator:
https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/uSEWZrE-T_8

Also, sage-on-gentoo and sage-on-debian may use different versions of boost than the original Sage.

An alternative could be that we *additionally* add (and document) the generic tests and keep the explicit ones. This would simplify the bug hunt next time.


---

Comment by vbraun created at 2013-03-01 10:30:37

Changing status from new to needs_review.


---

Comment by vbraun created at 2013-03-01 10:30:37

Doctesting the random sequence (see `sage.misc.randstate`) and doctesting the correctness of the output are two different things. And ideally we'd have both, though its better to have randstate-dependent tests than none at all.


---

Comment by AlexanderDreyer created at 2013-03-01 10:36:43

Changing status from needs_review to needs_info.


---

Comment by AlexanderDreyer created at 2013-03-01 10:36:43

So you would just keep it, like it was in #13767?


---

Comment by vbraun created at 2013-03-01 17:36:50

Correct me if I'm wrong, but the failing doctests were pretty much directly tests of the random number generator. If thats the case then I'd keep them since they test the rng seeding.
