# Issue 23675: parent() is slow for non-Elements

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-09-21 12:14:47

CC:  tscrim

The current implementation of the global function `parent()` is:

```
cpdef inline parent(x):
    if isinstance(x, Element):
        return (<Element>x)._parent
    # Fast check for "number" types, including int and float
    if PyNumber_Check(x):
        return type(x)
    try:
        p = x.parent
    except AttributeError:
        return type(x)
    else:
        return p()
```

It turns out that the non-`Element` case is sufficiently slow to cause an important slow-down, as observed in #23905.


---

Comment by jdemeyer created at 2017-09-21 13:05:53

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-09-21 13:05:53

New commits:


---

Comment by tscrim created at 2017-09-21 17:42:01

In some of those cases, there are probably better names than `parent` but were initially chosen to have compatibility of sorts with Sage's framework. Anyways, I doubt it would cause a problem in any private code.


---

Comment by tscrim created at 2017-09-21 17:42:01

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2017-09-21 18:52:54

Note: I put this ticket in the milestone sage-pending to wait a few days to see how the discussion on sage-devel turns out.


---

Comment by tscrim created at 2017-10-05 15:19:35

I think we can set this back to be merged into Sage.


---

Comment by vbraun created at 2017-10-15 09:22:51

Resolution: fixed
