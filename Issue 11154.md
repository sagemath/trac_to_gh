# Issue 11154: make ATLAS respect CC environment variable

archive/issues_011154.json:
```json
{
    "body": "Assignee: tbd\n\nATLAS does not respect the CC environment variable.\n\nSee Ticket #2999\n\nIssue created by migration from https://trac.sagemath.org/ticket/11326\n\n",
    "created_at": "2011-05-11T15:40:45Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "title": "make ATLAS respect CC environment variable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11154",
    "user": "mariah"
}
```
Assignee: tbd

ATLAS does not respect the CC environment variable.

See Ticket #2999

Issue created by migration from https://trac.sagemath.org/ticket/11326





---

archive/issue_comments_122253.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-11T15:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122253",
    "user": "mariah"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_122254.json:
```json
{
    "body": "Attachment [atlas-3.8.3.p16-p17.diff](tarball://root/attachments/some-uuid/ticket11326/atlas-3.8.3.p16-p17.diff) by mariah created at 2011-05-11 15:59:09\n\nDiff for the atlas spkg, for reviewing only.",
    "created_at": "2011-05-11T15:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122254",
    "user": "mariah"
}
```

Attachment [atlas-3.8.3.p16-p17.diff](tarball://root/attachments/some-uuid/ticket11326/atlas-3.8.3.p16-p17.diff) by mariah created at 2011-05-11 15:59:09

Diff for the atlas spkg, for reviewing only.



---

archive/issue_comments_122255.json:
```json
{
    "body": "Can we implement that on top of #10226? I can make the necessary changes. \n\nAlso, it seems like we could avoid modifying the upstream configure script if we just pass `--cc=$CC` to the configure script. Is there a reason why you didn't follow this less invasive route?",
    "created_at": "2011-05-11T16:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122255",
    "user": "vbraun"
}
```

Can we implement that on top of #10226? I can make the necessary changes. 

Also, it seems like we could avoid modifying the upstream configure script if we just pass `--cc=$CC` to the configure script. Is there a reason why you didn't follow this less invasive route?



---

archive/issue_comments_122256.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-05-11T16:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122256",
    "user": "vbraun"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_122257.json:
```json
{
    "body": "I've made a new spkg\n\nhttp://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg\n\nthat should respect `$CC`. It passes `--cc=$CC -C xc $CC -C gc $CC -C ic $CC -C dm $CC -C sm $SS -C dk $CC -C sk $CC` to the ATLAS configure script and afterwards fixes up `GOODGCC` in `Make.inc`. Note that ATLAS sets `GOODGCC = gcc $CC` if `$CC` does not start with `gcc`.\n\nI'm currently compiling it, but since `Make.inc` is generated correctly I'm fairly positive that this should work.",
    "created_at": "2011-05-11T17:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122257",
    "user": "vbraun"
}
```

I've made a new spkg

http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg

that should respect `$CC`. It passes `--cc=$CC -C xc $CC -C gc $CC -C ic $CC -C dm $CC -C sm $SS -C dk $CC -C sk $CC` to the ATLAS configure script and afterwards fixes up `GOODGCC` in `Make.inc`. Note that ATLAS sets `GOODGCC = gcc $CC` if `$CC` does not start with `gcc`.

I'm currently compiling it, but since `Make.inc` is generated correctly I'm fairly positive that this should work.



---

archive/issue_comments_122258.json:
```json
{
    "body": "This fails during linking because `GOODGCC` needs to include `-Fpic` on many platforms.",
    "created_at": "2011-05-11T17:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122258",
    "user": "vbraun"
}
```

This fails during linking because `GOODGCC` needs to include `-Fpic` on many platforms.



---

archive/issue_comments_122259.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-05-11T19:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122259",
    "user": "vbraun"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_122260.json:
```json
{
    "body": "The new version works now. To test it I created a symlink /bin/false -> gcc and set `$CC` to the correct gcc, and it compiled fine. \n\nhttp://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg",
    "created_at": "2011-05-11T19:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122260",
    "user": "vbraun"
}
```

The new version works now. To test it I created a symlink /bin/false -> gcc and set `$CC` to the correct gcc, and it compiled fine. 

http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg



---

archive/issue_comments_122261.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-11T20:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122261",
    "user": "mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_122262.json:
```json
{
    "body": "atlas-3.8.3.p18.spkg successfully builds using $CC.  Positive review.",
    "created_at": "2011-05-11T20:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122262",
    "user": "mariah"
}
```

atlas-3.8.3.p18.spkg successfully builds using $CC.  Positive review.



---

archive/issue_comments_122263.json:
```json
{
    "body": "Postponing this because of #10226.",
    "created_at": "2011-05-12T12:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122263",
    "user": "jdemeyer"
}
```

Postponing this because of #10226.



---

archive/issue_comments_122264.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-07-27T13:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122264",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_122265.json:
```json
{
    "body": "This needs to be rebased to the ATLAS spkg from #10226.",
    "created_at": "2011-07-27T13:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122265",
    "user": "jdemeyer"
}
```

This needs to be rebased to the ATLAS spkg from #10226.



---

archive/issue_comments_122266.json:
```json
{
    "body": "This has been merged into #10226 a long time ago, but apparently we forgot to close this ticket.",
    "created_at": "2012-02-26T19:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122266",
    "user": "vbraun"
}
```

This has been merged into #10226 a long time ago, but apparently we forgot to close this ticket.



---

archive/issue_comments_122267.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-02-26T19:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122267",
    "user": "vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_122268.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2012-03-02T13:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11154",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11154#issuecomment-122268",
    "user": "jdemeyer"
}
```

Resolution: duplicate
