# Issue 11154: make ATLAS respect CC environment variable

Issue created by migration from https://trac.sagemath.org/ticket/11326

Original creator: mariah

Original creation time: 2011-05-11 15:40:45

Assignee: tbd

ATLAS does not respect the CC environment variable.

See Ticket #2999


---

Comment by mariah created at 2011-05-11 15:57:42

Changing status from new to needs_review.


---

Attachment

Diff for the atlas spkg, for reviewing only.


---

Comment by vbraun created at 2011-05-11 16:24:38

Can we implement that on top of #10226? I can make the necessary changes. 

Also, it seems like we could avoid modifying the upstream configure script if we just pass `--cc=$CC` to the configure script. Is there a reason why you didn't follow this less invasive route?


---

Comment by vbraun created at 2011-05-11 16:24:38

Changing status from needs_review to needs_info.


---

Comment by vbraun created at 2011-05-11 17:09:40

I've made a new spkg

http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg

that should respect `$CC`. It passes `--cc=$CC -C xc $CC -C gc $CC -C ic $CC -C dm $CC -C sm $SS -C dk $CC -C sk $CC` to the ATLAS configure script and afterwards fixes up `GOODGCC` in `Make.inc`. Note that ATLAS sets `GOODGCC = gcc $CC` if `$CC` does not start with `gcc`.

I'm currently compiling it, but since `Make.inc` is generated correctly I'm fairly positive that this should work.


---

Comment by vbraun created at 2011-05-11 17:16:06

This fails during linking because `GOODGCC` needs to include `-Fpic` on many platforms.


---

Comment by vbraun created at 2011-05-11 19:33:11

Changing status from needs_info to needs_review.


---

Comment by vbraun created at 2011-05-11 19:33:11

The new version works now. To test it I created a symlink /bin/false -> gcc and set `$CC` to the correct gcc, and it compiled fine. 

http://www.stp.dias.ie/~vbraun/Sage/spkg/atlas-3.8.3.p18.spkg


---

Comment by mariah created at 2011-05-11 20:49:51

Changing status from needs_review to positive_review.


---

Comment by mariah created at 2011-05-11 20:49:51

atlas-3.8.3.p18.spkg successfully builds using $CC.  Positive review.


---

Comment by jdemeyer created at 2011-05-12 12:59:33

Postponing this because of #10226.


---

Comment by jdemeyer created at 2011-07-27 13:42:49

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2011-07-27 13:42:49

This needs to be rebased to the ATLAS spkg from #10226.


---

Comment by vbraun created at 2012-02-26 19:43:08

This has been merged into #10226 a long time ago, but apparently we forgot to close this ticket.


---

Comment by vbraun created at 2012-02-26 19:43:08

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2012-03-02 13:56:27

Resolution: duplicate
