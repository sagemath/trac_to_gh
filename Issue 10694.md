# Issue 10694: normalized laplacian throws an error if the graph has an isolated vertex

Issue created by migration from https://trac.sagemath.org/ticket/10757

Original creator: jason

Original creation time: 2011-02-08 17:48:53

Assignee: jason, ncohen, rlm

Keywords: beginner

See the definition of normalized laplacian here:

http://mathworld.wolfram.com/LaplacianMatrix.html

or here:

http://en.wikipedia.org/wiki/Laplacian_matrix

Basically, this function ignores the part of the definition that says that an isolated vertex should have an all-zero row and column.

Also, coding things up straight from the definition might make the function faster anyway (rather than multiplying matrices).  If we do need to multiply matrices, I think it would be sufficient to make $D^{1/2}$ have a 1 if the corresponding row represented an isolated vertex.


---

Comment by jason created at 2011-02-08 17:52:12

In fact, I think an easy way to fix this (though maybe not the most efficient) is to just change {{1/sqrt(D[i,i])}} in the problematic line to {{1/sqrt(D[i,i]) if D[i,i]>0 else 1}}


---

Comment by jason created at 2011-02-08 17:52:36

In fact, I think an easy way to fix this (though maybe not the most efficient) is to just change `1/sqrt(D[i,i])` in the problematic line to `1/sqrt(D[i,i]) if D[i,i]>0 else 1`


---

Comment by jason created at 2011-02-08 17:53:43

The docs would also need to be changed to mention what happens if we have an isolated vertex.


---

Comment by ncarter created at 2012-01-09 19:37:54

Changing status from new to needs_review.


---

Comment by ncarter created at 2012-01-09 19:37:54

The above patch implements the suggested fix, and the corresponding documentation changes.
Testing indicates that the original poster's bug goes away when this patch is applied.


---

Comment by ncarter created at 2012-01-09 19:39:19

Changing keywords from "beginner" to "beginner sd35.5".


---

Comment by jason created at 2012-01-09 19:48:27

The documentation is slightly unclear about what matrix is "the matrix" in the exceptional case.  I just mentioned this to Nathan and he's updating the docs.


---

Attachment


---

Comment by ncarter created at 2012-01-09 19:50:06

Previous attachment update just tweaked documentation as per Jason Grout's suggestion.


---

Comment by jason created at 2012-01-09 19:51:02

The code looks good to me.  If someone downloads it and verifies that it works, then positive review from me.


---

Comment by kcrisman created at 2012-01-10 15:43:59

This needs a test for the original problem.


---

Comment by kcrisman created at 2012-01-10 15:43:59

Changing status from needs_review to needs_work.


---

Comment by ncarter created at 2012-01-10 16:09:07

Changing status from needs_work to needs_review.


---

Comment by ncarter created at 2012-01-10 16:09:07

Added doctest, as per Karl-Dieter's correction.


---

Comment by ncarter created at 2012-01-10 16:10:54

Changing status from needs_review to needs_work.


---

Comment by ncarter created at 2012-01-10 16:10:54

Oh, fiddlesticks...that was a mistaken upload.  Will fix in a moment...


---

Comment by ncarter created at 2012-01-10 16:14:06

adding a doctest this time


---

Comment by ncarter created at 2012-01-10 16:14:39

Changing status from needs_work to needs_review.


---

Attachment

OK give that a try.


---

Comment by kcrisman created at 2012-01-10 16:43:12

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2012-01-10 16:43:12

Looks good.    Could have made it a "TEST" instead of putting it in examples, but clearly that's not important.  Positive review.


---

Comment by kcrisman created at 2012-01-10 16:43:41

Apply [attachment:trac-10757-laplacian-div-by-0-with-doctest.patch].


---

Comment by jdemeyer created at 2012-01-15 21:56:37

Resolution: fixed
