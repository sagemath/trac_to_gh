# Issue 22530: py3: some care for division

Issue created by migration from https://trac.sagemath.org/ticket/22767

Original creator: chapoton

Original creation time: 2017-04-06 12:55:41

CC:  tscrim jmantysalo aapitzsch jdemeyer

correct some of the remaining failures when division uses python3 behaviour

part of #15995


---

Comment by chapoton created at 2017-04-06 12:56:33

New commits:


---

Comment by chapoton created at 2017-04-06 12:56:33

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-04-06 15:23:46

Changing status from needs_review to needs_info.


---

Comment by jdemeyer created at 2017-04-06 15:23:46

Why change `int` to `Integer` in various places? I don't think that is the right way to fix things.


---

Comment by chapoton created at 2017-04-06 16:50:52

To which of the 3 changed file do you refer ?

I must admit that I have made so that it works, but not tried to understand why.


---

Comment by chapoton created at 2017-04-06 17:40:51

`@`tscrim: "src/sage/combinat/crystals/virtual_crystal.py" also needs care:

Try adding `from __future__ import division` there, you will get 4 failures.


---

Comment by tscrim created at 2017-04-06 21:38:13

I know the rigged configuration code, so I made the necessary change there. I also fixed the issues in `virtual_crystals.py`. I have no idea for the other two.
----
New commits:


---

Comment by chapoton created at 2017-04-07 06:35:07

may we also undo this change in rigged configurations ?

```diff
-        cc = 0
-        rigging_sum = 0
+        cc = ZZ.zero()
+        rigging_sum = ZZ.zero()
```



---

Comment by tscrim created at 2017-04-07 07:21:24

These are good to have as `cc` is eventually exposed to the user, and I think could remain an `int` in certain situations.


---

Comment by chapoton created at 2017-04-07 07:46:14

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2017-04-07 07:46:14

ok, then setting back to needs review


---

Comment by chapoton created at 2017-04-07 07:47:42

need to do something in the elliptic file


---

Comment by chapoton created at 2017-04-07 07:47:42

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-04-07 12:24:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-04-07 12:24:41

New commits:
----
New commits:


---

Comment by chapoton created at 2017-04-07 12:24:41

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2017-04-07 15:02:35

Perhaps this is bikeshedding, but I don't understand why this change

```diff
-                    r /= v.ramification_index() * v.residue_class_degree()
+                    r = r / (v.ramification_index() * v.residue_class_degree())
```

You don't need to change it back, but it just feels like it is slightly more complicated code to me.


---

Comment by chapoton created at 2017-04-07 15:06:33

Well, yes, you are right. I was in doubt to what kind of division is performed by `/=`.


---

Comment by tscrim created at 2017-04-07 15:18:56

If the patchbot comes back green, then you can set a positive review.


---

Comment by chapoton created at 2017-04-11 12:00:55

ok,one bot was green


---

Comment by chapoton created at 2017-04-11 12:00:55

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-04-12 20:12:58

Resolution: fixed


---

Comment by embray created at 2018-02-23 13:35:17

Changing keywords from "" to "division".
