# Issue 19994: Blacklist GCC 4.8.x

Issue created by migration from https://trac.sagemath.org/ticket/20231

Original creator: jdemeyer

Original creation time: 2016-03-18 11:09:38

While working on #20226, I got hit by a similar problem as #14460. Since that bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.


---

Comment by jdemeyer created at 2016-03-18 17:38:26

New commits:


---

Comment by jdemeyer created at 2016-03-18 17:38:26

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-03-18 20:47:35

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-03-18 20:47:35

looks good to me


---

Comment by vbraun created at 2016-03-23 12:46:40

Resolution: fixed


---

Comment by embray created at 2016-04-20 14:27:23

Was this announced in sage-devel?  After rebasing branch I was working in on the current develop sage suddenly wants to compile gcc because of this.  gcc 4.8 is the default version on Ubuntu 14.04 which is the current LTS (not counting 16.04 which hasn't quite yet been released).

It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.  As a compromise, perhaps issue a loud warning when the workaround is used as it may affect performance, for anyone who cares.  It would only need to be enabled for those modules that need it.


---

Comment by jdemeyer created at 2016-04-20 14:42:28

Replying to [comment:6 embray]:
> Was this announced in sage-devel?
No.

> It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.

There is no simple workaround. The `-fno-tree-dominator-opts` workaround happens to fix one particular instance of the problem, not the problem in general. In particular, `-fno-tree-dominator-opts` does not fix the similar issue from #20226. I was too lazy to investigate yet another workaround for #20226.


---

Comment by embray created at 2016-04-21 07:24:14

Don't you think dropping support for an entire series of compiler versions that is still relatively commonly in use, without a deprecation process and without warning is a bit of a problem?

I'm sure there's a workaround in the other case too.


---

Comment by embray created at 2016-04-21 07:26:41

For that matter even if it `-fno-tree-dominator-opts` were the workaround it doesn't need to be applied to the whole module. It could be applied at the function level too.  If there's some optimization that's producing incorrect code around `setjmp` that's not surprising but I'm sure we could see what it's doing and disable that.


---

Comment by jdemeyer created at 2016-05-11 19:31:29

Reverting in #20594.
