# Issue 11371: Hashing algebraic numbers takes far too long

Issue created by migration from https://trac.sagemath.org/ticket/11543

Original creator: rbeezer

Original creation time: 2011-06-25 06:12:47

Assignee: AlexGhitza

Hashing algebraic numbers can take a very long time.  I've traced this to line 2421 of  sage/rings/qqbar.py  which can be re-created by the following code.


```
sage: A=matrix(QQ, 4, 4, [1, 2, -2, 2, 1, 0, -1, -1, 0, -1, 1, 1, -1, 2, 1/2, 0])
sage: e = A.eigenvalues()[3]
sage: K = (A-e).kernel()
sage: P = K.basis_matrix()
sage: x = P.list()[3]

sage: from sage.rings.qqbar import ANExtensionElement, AlgebraicGenerator, ANRoot, AAPoly
sage: QQbar_I_nf = QuadraticField(-1, 'I', embedding=CC.gen())
sage: QQbar_I_generator = AlgebraicGenerator(QQbar_I_nf, ANRoot(AAPoly.gen()**2 + 1, CIF(0, 1)))
sage: QQbar_hash_offset = AlgebraicNumber(ANExtensionElement(QQbar_I_generator, ~ZZ(123456789) + QQbar_I_nf.gen()/ZZ(987654321)))

sage: time h = hash((x + QQbar_hash_offset).interval_exact(CIF))

Time: CPU 58.31 s, Wall: 58.48 s
```



---

Comment by @mjungmath created at 2021-01-20 09:57:06

I cannot reproduce that behavior with Sage 9.2 (Windows):


```
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 1.14 ms
```


Seems to be solved.


---

Comment by @DaveWitteMorris created at 2021-01-23 03:27:36

I agree. I see no problem with 9.2 on `CoCalc` or 9.3b6 on MacOS 10.15.7. Let's close this old ticket as "works for me".


---

Comment by @DaveWitteMorris created at 2021-01-23 03:27:36

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2021-01-23 03:27:36

Changing priority from major to minor.


---

Comment by vdelecroix created at 2021-01-23 16:11:09

Resolution: invalid
