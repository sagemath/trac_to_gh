# Issue 20679: Optional linking Pynac with libgiac on Debian needs unrelated libraries

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2016-07-01 07:28:14

Apparently on Debian / Ubuntu a libgiac dependency may not be installed with the giac install and is somehow needed when installing Pynac in Sage (which optionally has giac installed).

To prevent unwanted linking and to reduce confusion `--with-giac=no` should be set in the Pynac spkg.


---

Comment by rws created at 2016-07-01 07:34:24

New commits:


---

Comment by rws created at 2016-07-01 07:34:24

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-07-01 07:42:19

Hi Ralf,

Could you put a link to upstream report?


---

Comment by rws created at 2016-07-01 07:47:03

I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.


---

Comment by vbraun created at 2016-07-01 07:50:41

lgtm, please set to positive review after filling the author name in


---

Comment by git created at 2016-07-01 08:05:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2016-07-01 08:10:02

Unfortunately this will only work as is on systems without giac. With giac, the optional test is done which (if not linked with pynac as was removed with the first commit) will trigger a Pynac bug.

So the optional doctest must be removed as well. Still positive?


---

Comment by vbraun created at 2016-07-01 08:28:36

You can mark it as `# known bug`


---

Comment by git created at 2016-07-01 08:36:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2016-07-01 08:37:59

That works, thanks.


---

Comment by rws created at 2016-07-01 08:37:59

Changing status from needs_review to positive_review.


---

Comment by leif created at 2016-07-01 09:00:35

Replying to [comment:5 rws]:
> I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.

Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to _link to it_ on Linux -- as opposed to _building giac_, you listed giac's _build dependencies_ in the thread -- explicitly list also libao-dev.)


---

Comment by rws created at 2016-07-01 09:18:45

Replying to [comment:13 leif]:
> Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to _link to it_ on Linux -- as opposed to _building giac_, you listed giac's _build dependencies_ in the thread -- explicitly list also libao-dev.)

As you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished. If `-lao` is needed by Sage then already then, isn't it?


---

Comment by leif created at 2016-07-01 09:31:59

Replying to [comment:14 rws]:
> Replying to [comment:13 leif]:
> > Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to _link to it_ on Linux -- as opposed to _building giac_, you listed giac's _build dependencies_ in the thread -- explicitly list also libao-dev.)
> 
> As you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished.

Yep, (vanilla) giac's configure instructions do not mention libao either.  But if building pynac _may_ fail on !Debian/Ubuntu (hardly anyone uses these distros, I know), pynac's configure should catch that case (either by disabling giac, or giving an appropriate error message).

I'd say solve it upstream if you find the time, and we can eventually revert the changes here with one of the next releases of pynac.

Or we could make Sage's giac package a standard one.

\\

> If `-lao` is needed by Sage then already then, isn't it?

Can't parse that... 8-)


---

Comment by vbraun created at 2016-07-02 08:49:07

Resolution: fixed
