# Issue 24253: Revert #22120

Issue created by migration from https://trac.sagemath.org/ticket/24490

Original creator: jdemeyer

Original creation time: 2018-01-08 11:24:46

CC:  cheuberg dkrenn

Powering a `QQbar` number by a `QQbar` number makes no sense mathematically. It goes against the philosophy of the coercion model. `QQbar` should only support powering by `QQ`.

This ticket is meant to revert #22120 which allows `QQbar(1)^QQbar(anything)`.


---

Comment by git created at 2018-01-08 11:45:22

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-01-08 11:58:47

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-01-08 14:10:23

And what about

```
sage: 2^(1/2)
sqrt(2)
```

Should integers/rationals only be powered by respectively positive integers/relative integers?


---

Comment by jdemeyer created at 2018-01-08 14:15:17

Replying to [comment:7 vdelecroix]:
> And what about
> {{{
> sage: 2^(1/2)
> sqrt(2)
> }}}
> Should integers/rationals only be powered by respectively positive integers/relative integers?

That is not relevant to this ticket. There are many issues with powering for specific parents, but we should not mix up unrelated things. In any case, if you want to change `2^(1/2)`, that will certainly require a discussion on sage-devel.


---

Comment by vdelecroix created at 2018-01-08 14:30:04

You *can* define `a^b` for `a` nonzero complex and `b` complex to be `exp(b log(a))` where `log(a)` is the principal determination of the logarithm. This is very natural _and_ it breaks the coercion model in the very same way as `ZZ^QQ` from comment:7 does. Don't you think that the discussion about powering and coercion should be going on with a global viewpoint on sage-devel?


---

Comment by jdemeyer created at 2018-01-08 14:32:16

Replying to [comment:9 vdelecroix]:
> it breaks the coercion model in the very same way as `ZZ^QQ` from comment:7 does.

The fact that X is broken should never be used as an excuse to break Y too.


---

Comment by jdemeyer created at 2018-01-08 14:37:54

Replying to [comment:9 vdelecroix]:
> You *can* define `a^b` for `a` nonzero complex and `b` complex to be `exp(b log(a))` where `log(a)` is the principal determination of the logarithm. This is very natural

It does indeed make mathematical sense for all subrings of `CC`. However, if you do that, the answer should lie in `SR` and not in `QQbar`. However, I don't think it would be very useful since `SR` doesn't really understand elements of `QQbar`:

```
sage: a = QQbar(1); b = QQbar(2).sqrt(); exp(b * log(a))
e^(1.414213562373095?*log(1))
```



---

Comment by jdemeyer created at 2018-01-08 14:42:38

From a pragmatic point of view, the main issue is that defining `QQbar(1) ^ x` (and only that) is pointless. I cannot think of any natural scenario where `QQbar ^ QQbar` powering would come up where the base is always `QQbar(1)`. This is shown by the fact that the only doctests which break are the ones specifically added by #22120. That ticket also gives no motivation at all for why `QQbar(1) ^ x` should be allowed.


---

Comment by jdemeyer created at 2018-01-08 14:44:54

Note: as an alternative to this ticket, I could live with allowing `QQbar × QQbar → SR` powering in general. But I'm not convinced that this would be useful.


---

Comment by vdelecroix created at 2018-01-08 15:05:46

It would also make sense with `QQbar x QQbar → CLF`... but that is broken (somehow another story #24492).


---

Comment by cheuberg created at 2018-01-08 20:42:48

IIRC, the change in #22120 was motivated by the necessity of performing the operation in the asymptotic ring documented in that doctest there.

So if you want to revert this operation in QQbar, a deprecation is required IMHO and the asymptotic ring must be fixed to have the special case of a coefficient 1 such that the doctest there still works.

Some code accompanying a paper relying on that behaviour will be broken otherwise.


---

Comment by jdemeyer created at 2018-01-09 09:35:33

Allright, let's fix this by implementing `QQbar × QQbar → SR` powering in general, which is at least a sensible thing to do (as opposed to only allowing powers of `1`).


---

Comment by jdemeyer created at 2018-01-09 09:35:33

Resolution: duplicate


---

Comment by jdemeyer created at 2018-01-09 10:43:47

Changing status from closed to new.


---

Comment by jdemeyer created at 2018-01-09 10:43:47

Resolution changed from duplicate to 


---

Comment by jdemeyer created at 2018-01-09 10:43:47

Hmm, both powering to `SR` and `CLF` have issues, it's not as easy as I thought. So I'm just going to stay away from this.

But I'll leave this ticket open because I still think that there is an issue to be fixed here.
