# Issue 34222: sage command for arm64 SageMath expects x86_64 version of libncurses

Issue created by migration from https://trac.sagemath.org/ticket/34459

Original creator: @murrayE

Original creation time: 2022-08-30 17:24:29

Under macOS 12.5.1 on an M1 Mac, I've installed from SageMath-9.6-1.4.2_arm64.dmg. When I run the sage command in Terminal (or in effect do the same thing by launching SageMath-9-6.app and selecting the option for command line), I get error:

dyld[16273]: Library not loaded: '/opt/local/lib/libncurses.6.dylib'
  Referenced from: '/usr/local/bin/bash'
  Reason: tried: '/opt/local/lib/libncurses.6.dylib' (mach-o file, but is an incompatible architecture (have (arm64), need (x86_64))), '/usr/local/lib/libncurses.6.dylib' (no such file), '/usr/lib/libncurses.6.dylib' (no such file)
/usr/local/bin/sage: line 20: 16273 Abort trap: 6           /usr/bin/env - PATH="$PATH" $MIN_ENV "$SYMLINK"/venv/bin/sage "$`@`"

The libncurses.6.dylib referenced was installed with the MacPorts and is allegedly "universal".


---

Comment by mkoeppe created at 2022-08-30 18:08:04

What is in `/usr/local` on this machine and where does it come from?


---

Comment by @murrayE created at 2022-08-30 19:34:47

In `/usr/local` there is no `libncurses.*`

(In `/usr/local/lib/fpc` -- from Free Pascal Compiler -- there are a couple dozen `ncurses` modules, but no `libncurses.*`.)

I presume that, because of my `PATH` settings, sage searches `/opt/local/lib`, `/usr/local/lib`, and `/usr/lib` for libncurses.


---

Comment by mkoeppe created at 2022-08-30 19:43:35

The message above complains about `/usr/local/bin/bash`. I recommend to move this (or actually the whole /usr/local) away.


---

Comment by mkoeppe created at 2022-09-03 15:38:29

Changing status from new to needs_review.
