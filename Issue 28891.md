# Issue 28891: pass the installation prefix of libffi  to ECL

Issue created by migration from https://trac.sagemath.org/ticket/29128

Original creator: dimpase

Original creation time: 2020-01-31 22:42:24

CC:  mkoeppe isuruf embray fbissey charpent mmezzarobba

at present ECL installation takes the headers of libffi from whereever it can, and first of all from "standard" locations. Thus an imcompatible libffi headers (and version 3.3 introduced an apparent incompatibility)  installed system-wide break building of ECL even though `--without-system-ecl` is given.

This was reported to happen on Debian testing.

ECL's configure has an option `--with-libffi-prefix=path` which hopefully does the job (untested); if so, this would at least allow
the build to succeed in such a configuration.

Another task is to test for the incompatible libffi (well, we can just test the version not to be above 3.2.x for some x).


---

Comment by dimpase created at 2020-02-03 17:12:16

In upstream ECL it's addressed in https://gitlab.com/embeddable-common-lisp/ecl/issues/302

So we hopefully can backport this to out 16.1.2, and support all versions of libffi, old and current.


---

Comment by dimpase created at 2020-02-03 18:26:18

the ECL's option appears not be working, anyway, on #21811 there is a better solution.
We'll fix the issue on #21811


---

Comment by dimpase created at 2020-02-03 18:26:18

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-02-08 21:48:43

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-02-08 21:48:43

Since #21811 is a better solution and positively reviewed, I agree with closing this.


---

Comment by chapoton created at 2020-02-09 19:15:23

Resolution: duplicate
