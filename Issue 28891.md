# Issue 28891: pass the installation prefix of libffi  to ECL

archive/issues_028891.json:
```json
{
    "body": "CC:  @mkoeppe @isuruf @embray @kiwifb @EmmanuelCharpentier @mezzarobba\n\nat present ECL installation takes the headers of libffi from whereever it can, and first of all from \"standard\" locations. Thus an imcompatible libffi headers (and version 3.3 introduced an apparent incompatibility)  installed system-wide break building of ECL even though `--without-system-ecl` is given.\n\nThis was reported to happen on Debian testing.\n\nECL's configure has an option `--with-libffi-prefix=path` which hopefully does the job (untested); if so, this would at least allow\nthe build to succeed in such a configuration.\n\nAnother task is to test for the incompatible libffi (well, we can just test the version not to be above 3.2.x for some x).\n\nIssue created by migration from https://trac.sagemath.org/ticket/29128\n\n",
    "created_at": "2020-01-31T22:42:24Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "pass the installation prefix of libffi  to ECL",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28891",
    "user": "https://github.com/dimpase"
}
```
CC:  @mkoeppe @isuruf @embray @kiwifb @EmmanuelCharpentier @mezzarobba

at present ECL installation takes the headers of libffi from whereever it can, and first of all from "standard" locations. Thus an imcompatible libffi headers (and version 3.3 introduced an apparent incompatibility)  installed system-wide break building of ECL even though `--without-system-ecl` is given.

This was reported to happen on Debian testing.

ECL's configure has an option `--with-libffi-prefix=path` which hopefully does the job (untested); if so, this would at least allow
the build to succeed in such a configuration.

Another task is to test for the incompatible libffi (well, we can just test the version not to be above 3.2.x for some x).

Issue created by migration from https://trac.sagemath.org/ticket/29128





---

archive/issue_comments_408558.json:
```json
{
    "body": "In upstream ECL it's addressed in https://gitlab.com/embeddable-common-lisp/ecl/issues/302\n\nSo we hopefully can backport this to out 16.1.2, and support all versions of libffi, old and current.",
    "created_at": "2020-02-03T17:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408558",
    "user": "https://github.com/dimpase"
}
```

In upstream ECL it's addressed in https://gitlab.com/embeddable-common-lisp/ecl/issues/302

So we hopefully can backport this to out 16.1.2, and support all versions of libffi, old and current.



---

archive/issue_comments_408559.json:
```json
{
    "body": "the ECL's option appears not be working, anyway, on #21811 there is a better solution.\nWe'll fix the issue on #21811",
    "created_at": "2020-02-03T18:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408559",
    "user": "https://github.com/dimpase"
}
```

the ECL's option appears not be working, anyway, on #21811 there is a better solution.
We'll fix the issue on #21811



---

archive/issue_events_073878.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-02-03T18:26:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28891#event-73878"
}
```



---

archive/issue_comments_408560.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-03T18:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408560",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_408561.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-08T21:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408561",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_408562.json:
```json
{
    "body": "Since #21811 is a better solution and positively reviewed, I agree with closing this.",
    "created_at": "2020-02-08T21:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408562",
    "user": "https://github.com/tscrim"
}
```

Since #21811 is a better solution and positively reviewed, I agree with closing this.



---

archive/issue_comments_408563.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2020-02-09T19:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28891#issuecomment-408563",
    "user": "https://github.com/fchapoton"
}
```

Resolution: duplicate



---

archive/issue_events_073879.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-09T19:15:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28891",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28891#event-73879"
}
```
