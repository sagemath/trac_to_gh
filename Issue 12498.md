# Issue 12498: Store lazy import caches in .sage/cache/ rather than in .sage

Issue created by migration from https://trac.sagemath.org/ticket/12670

Original creator: jhpalmieri

Original creation time: 2012-03-14 20:55:35

Assignee: jason

After building and running many versions of Sage, my `.sage` directory is littered with files with names like

```
_Applications_sage_builds_sage-5.0.beta7-gcc_devel_sage-main-lazy_import_cache.pickle
```

We should instead store these in a subdirectory of `.sage`. The attached patch makes this change.



---

Comment by jhpalmieri created at 2012-03-14 20:56:03

(Sage library)


---

Attachment


---

Comment by jhpalmieri created at 2012-03-14 20:56:10

Changing status from new to needs_review.


---

Comment by hivert created at 2012-03-15 11:35:08

Hi John,

I noticed the same for me. Thanks for tacking care of that. By the way, in my `.sage` the mentioned file are all only 6 bytes long which seems to be rather small for a cache. Is it normal ? Is the cache actually working ?

Florent


---

Comment by jhpalmieri created at 2012-03-15 15:09:18

Hi Florent,

My files are only 6 bytes long, too. I don't know anything about the actual code involved in the caches, so I don't know if they're working. (I think they may be the first step toward something more significant, but I'm not sure.)  In any case, it's certainly ridiculous to have files with ugly names over 80 characters long, especially if they only contain 6 bytes, stored in a semi-public place.


---

Comment by hivert created at 2012-03-16 08:15:45

> My files are only 6 bytes long, too. I don't know anything about the actual code involved in the caches, so I don't know if they're working. (I think they may be the first step toward something more significant, but I'm not sure.)  In any case, it's certainly ridiculous to have files with ugly names over 80 characters long, especially if they only contain 6 bytes, stored in a semi-public place.

Sure ! I'm reviewing your code and ask for those file on sage-devel. Right no I think it is ready to go I just want to wait the results of the tests.

Florent


---

Comment by nbruin created at 2012-03-16 16:41:21

The only calls to `save_cache_file` I've been able to find are in `sage/all.py` (this file is apparently skipped by `search_src`) and in the doctest of `save_cache_file`. This cache only seems to be involved with `get_star_imports` and that only gets used in `sage.misc.lazy_import` if there is a "*" in the input. So indeed, this cache is never used as far as I can see.


---

Comment by hivert created at 2012-03-17 09:40:47

Changing status from needs_review to positive_review.


---

Comment by hivert created at 2012-03-17 09:40:47

The test passes and the code looks good so I'm ok to set the positive review. However, something else has to be done: either to expand the cases where the cache is used or simply to remove it at all. In the mean time I feel that the patch here should enter sage.


---

Comment by jdemeyer created at 2012-03-23 15:23:21

Resolution: fixed
