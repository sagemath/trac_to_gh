# Issue 12117: pass algorithm argument to custom numeric evalution methods

archive/issues_012117.json:
```json
{
    "body": "Assignee: @burcin\n\nCC:  @benjaminfjones dsm @kcrisman @kini @eviatarbach @vbraun\n\nKeywords: pynac\n\nCustom numeric evaluation functions defined in the `_evalf_()` method of symbolic functions accept only the parent of the result as an argument. We should expand this to allow passing an `argument` parameter as well.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12289\n\n",
    "created_at": "2012-01-10T06:38:35Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "pass algorithm argument to custom numeric evalution methods",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12117",
    "user": "https://github.com/burcin"
}
```
Assignee: @burcin

CC:  @benjaminfjones dsm @kcrisman @kini @eviatarbach @vbraun

Keywords: pynac

Custom numeric evaluation functions defined in the `_evalf_()` method of symbolic functions accept only the parent of the result as an argument. We should expand this to allow passing an `argument` parameter as well.

Issue created by migration from https://trac.sagemath.org/ticket/12289





---

archive/issue_comments_140232.json:
```json
{
    "body": "Attachment [trac_12289-evalf_dictionary.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary.patch) by @burcin created at 2012-01-10 07:41:06",
    "created_at": "2012-01-10T07:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140232",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_12289-evalf_dictionary.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary.patch) by @burcin created at 2012-01-10 07:41:06



---

archive/issue_comments_140233.json:
```json
{
    "body": "Attachment [trac_12289-example.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-example.patch) by @burcin created at 2012-01-10 08:00:12",
    "created_at": "2012-01-10T08:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140233",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_12289-example.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-example.patch) by @burcin created at 2012-01-10 08:00:12



---

archive/issue_comments_140234.json:
```json
{
    "body": "The `evalf_dict` branch of Pynac [available here](https://bitbucket.org/burcin/pynac-wip/), with the attached patches applied to the Sage library, allows this:\n\n\n```\nsage: cot(1/2).n(algorithm='foo')\n11.0000000000000\nsage: cot(1/2).n()\n1.83048772171245\n```\n\n\nThe docstrings for `_convert()` etc. methods of symbolic expressions need to be updated to reflect these changes.",
    "created_at": "2012-01-10T08:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140234",
    "user": "https://github.com/burcin"
}
```

The `evalf_dict` branch of Pynac [available here](https://bitbucket.org/burcin/pynac-wip/), with the attached patches applied to the Sage library, allows this:


```
sage: cot(1/2).n(algorithm='foo')
11.0000000000000
sage: cot(1/2).n()
1.83048772171245
```


The docstrings for `_convert()` etc. methods of symbolic expressions need to be updated to reflect these changes.



---

archive/issue_comments_140235.json:
```json
{
    "body": "I'm doing some testing of these patches along with rebasing #1173. Thanks Burcin!",
    "created_at": "2012-01-10T15:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140235",
    "user": "https://github.com/benjaminfjones"
}
```

I'm doing some testing of these patches along with rebasing #1173. Thanks Burcin!



---

archive/issue_comments_140236.json:
```json
{
    "body": "Changing keywords from \"pynac\" to \"pynac sd35.5\".",
    "created_at": "2012-01-10T15:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140236",
    "user": "https://github.com/benjaminfjones"
}
```

Changing keywords from "pynac" to "pynac sd35.5".



---

archive/issue_comments_140237.json:
```json
{
    "body": "Changing keywords from \"pynac sd35.5\" to \"pynac sd35.5 sd40.5\".",
    "created_at": "2012-05-25T02:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140237",
    "user": "https://github.com/benjaminfjones"
}
```

Changing keywords from "pynac sd35.5" to "pynac sd35.5 sd40.5".



---

archive/issue_comments_140238.json:
```json
{
    "body": "I'm trying to rebase the patch [This is the Trac macro *attachment:trac_12289-evalf_dictionary.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary.patch-macro) to sage-5.0, but I'm running into a problem with the type of `py_funcs.py_float`. In the patch py_float has type `object (*)(object, object)` but in sage-5.0, it has type `object (*)(object, PyObject *)` I guess because of a pynac change in the meantime. \n\nTo be more specific, with this type def for `py_float`:\n\n\n```\ncdef public object py_float(object n, object kwds) except +:\n```\n\n\nI rebuild sage and get:\n\n\n```\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n    py_funcs.py_is_prime = &py_is_prime\n\n    py_funcs.py_integer_from_long = &py_integer_from_long\n    py_funcs.py_integer_from_python_obj = &py_integer_from_python_obj\n    \n    py_funcs.py_float = &py_float\n                       ^\n------------------------------------------------------------\n\nsage/symbolic/pynac.pyx:2040:24: Cannot assign type 'object (*)(object, object)' to 'object (*)(object, PyObject *)'\n```\n\n\nAny suggestions (burcin?)",
    "created_at": "2012-05-26T00:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140238",
    "user": "https://github.com/benjaminfjones"
}
```

I'm trying to rebase the patch [This is the Trac macro *attachment:trac_12289-evalf_dictionary.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary.patch-macro) to sage-5.0, but I'm running into a problem with the type of `py_funcs.py_float`. In the patch py_float has type `object (*)(object, object)` but in sage-5.0, it has type `object (*)(object, PyObject *)` I guess because of a pynac change in the meantime. 

To be more specific, with this type def for `py_float`:


```
cdef public object py_float(object n, object kwds) except +:
```


I rebuild sage and get:


```

Error compiling Cython file:
------------------------------------------------------------
...
    py_funcs.py_is_prime = &py_is_prime

    py_funcs.py_integer_from_long = &py_integer_from_long
    py_funcs.py_integer_from_python_obj = &py_integer_from_python_obj
    
    py_funcs.py_float = &py_float
                       ^
------------------------------------------------------------

sage/symbolic/pynac.pyx:2040:24: Cannot assign type 'object (*)(object, object)' to 'object (*)(object, PyObject *)'
```


Any suggestions (burcin?)



---

archive/issue_comments_140239.json:
```json
{
    "body": "Attachment [trac_12289-evalf_dictionary_rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary_rebase.patch) by @benjaminfjones created at 2012-05-28 02:22:16\n\nrebase to sage-5.0 + pynac-0.2.4 spkg",
    "created_at": "2012-05-28T02:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140239",
    "user": "https://github.com/benjaminfjones"
}
```

Attachment [trac_12289-evalf_dictionary_rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary_rebase.patch) by @benjaminfjones created at 2012-05-28 02:22:16

rebase to sage-5.0 + pynac-0.2.4 spkg



---

archive/issue_comments_140240.json:
```json
{
    "body": "Attachment [trac_12289_py_float_fix.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289_py_float_fix.patch) by @benjaminfjones created at 2012-05-28 02:22:45\n\nfix py_float delcaration",
    "created_at": "2012-05-28T02:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140240",
    "user": "https://github.com/benjaminfjones"
}
```

Attachment [trac_12289_py_float_fix.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289_py_float_fix.patch) by @benjaminfjones created at 2012-05-28 02:22:45

fix py_float delcaration



---

archive/issue_comments_140241.json:
```json
{
    "body": "I've been working on this ticket today at sd40.5. I've got burcin's changes working in sage-5.0 with a caveat. Here's how to get the example in comment:1 working in sage-5.0:\n\n1. install the __patched__ pynac-0.2.4.p1 spkg at http://sage.math.washington.edu/home/bjones/pynac-0.2.4.p1.spkg. this spkg is the pynac-0.2.4 spkg from #12950 which has been patched to include the changes from burcin's `pynac-wip` branch of pynac mentioned above.\n\n2. apply all patches at #12950, here is a shell script to help that (run from `$SAGE_ROOT/devel/sage`): http://sage.math.washington.edu/home/bjones/trac_12950_apply.sh\n\n3. apply the patches to `$SAGE_ROOT/devel/sage`\n   * [This is the Trac macro *attachment:trac_12289-evalf_dictionary_rebase.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary_rebase.patch-macro)\n   * [This is the Trac macro *attachment:trac_12289-add_algorithm_arg.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-add_algorithm_arg.patch-macro)\n   * [This is the Trac macro *attachment:trac_12289-example.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-example.patch-macro)\n   * [This is the Trac macro *attachment:trac_12289_py_float_fix.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289_py_float_fix.patch-macro) (fixes the problem I had in comment:4)\n\n4. `sage -b`",
    "created_at": "2012-05-28T02:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140241",
    "user": "https://github.com/benjaminfjones"
}
```

I've been working on this ticket today at sd40.5. I've got burcin's changes working in sage-5.0 with a caveat. Here's how to get the example in comment:1 working in sage-5.0:

1. install the __patched__ pynac-0.2.4.p1 spkg at http://sage.math.washington.edu/home/bjones/pynac-0.2.4.p1.spkg. this spkg is the pynac-0.2.4 spkg from #12950 which has been patched to include the changes from burcin's `pynac-wip` branch of pynac mentioned above.

2. apply all patches at #12950, here is a shell script to help that (run from `$SAGE_ROOT/devel/sage`): http://sage.math.washington.edu/home/bjones/trac_12950_apply.sh

3. apply the patches to `$SAGE_ROOT/devel/sage`
   * [This is the Trac macro *attachment:trac_12289-evalf_dictionary_rebase.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary_rebase.patch-macro)
   * [This is the Trac macro *attachment:trac_12289-add_algorithm_arg.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-add_algorithm_arg.patch-macro)
   * [This is the Trac macro *attachment:trac_12289-example.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-example.patch-macro)
   * [This is the Trac macro *attachment:trac_12289_py_float_fix.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289_py_float_fix.patch-macro) (fixes the problem I had in comment:4)

4. `sage -b`



---

archive/issue_comments_140242.json:
```json
{
    "body": "Patchbot, though, should only apply trac_12289-evalf_dictionary_rebase.patch, trac_12289-add_algorithm_arg.patch, and trac_12289_py_float_fix.patch",
    "created_at": "2012-05-28T04:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140242",
    "user": "https://github.com/kcrisman"
}
```

Patchbot, though, should only apply trac_12289-evalf_dictionary_rebase.patch, trac_12289-add_algorithm_arg.patch, and trac_12289_py_float_fix.patch



---

archive/issue_comments_140243.json:
```json
{
    "body": "So that we don't forget to fix it later:\n\n\n\n```\n\nsage: erf(1).n(algorithm='foo')\n0.842700792949715\nsage: erf(0)\n0\nsage: parent(erf(0))\nInteger Ring\nsage: erf(0).n(algorithm='foo')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/devel/sage-hack2/sage/<ipython console> in <module>()\n\n/Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4988)()\n\nTypeError: numerical_approx() got an unexpected keyword argument 'algorithm'\n```\n",
    "created_at": "2012-05-28T18:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140243",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

So that we don't forget to fix it later:



```

sage: erf(1).n(algorithm='foo')
0.842700792949715
sage: erf(0)
0
sage: parent(erf(0))
Integer Ring
sage: erf(0).n(algorithm='foo')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/devel/sage-hack2/sage/<ipython console> in <module>()

/Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4988)()

TypeError: numerical_approx() got an unexpected keyword argument 'algorithm'
```




---

archive/issue_comments_140244.json:
```json
{
    "body": ">  1. install the __patched__ pynac-0.2.4.p1 spkg at http://sage.math.washington.edu/home/bjones/pynac-0.2.4.p1.spkg. this spkg is the pynac-0.2.4 spkg from #12950 which has been patched to include the changes from burcin's `pynac-wip` branch of pynac mentioned above.\nIs this stuff in the current Pynac 0.2.6?\n>  2. apply all patches at #12950, here is a shell script to help that (run from `$SAGE_ROOT/devel/sage`): http://sage.math.washington.edu/home/bjones/trac_12950_apply.sh\nCan now be skipped, presumably.\n>  3. apply the patches to `$SAGE_ROOT/devel/sage`\n>   * [This is the Trac macro *attachment:trac_12289-evalf_dictionary_rebase.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary_rebase.patch-macro)\n>   * [This is the Trac macro *attachment:trac_12289-add_algorithm_arg.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-add_algorithm_arg.patch-macro)\n>   * [This is the Trac macro *attachment:trac_12289-example.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-example.patch-macro)\n>   * [This is the Trac macro *attachment:trac_12289_py_float_fix.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289_py_float_fix.patch-macro) (fixes the problem I had in comment:4)\n> \n> 4. `sage -b`",
    "created_at": "2013-04-25T02:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140244",
    "user": "https://github.com/kcrisman"
}
```

>  1. install the __patched__ pynac-0.2.4.p1 spkg at http://sage.math.washington.edu/home/bjones/pynac-0.2.4.p1.spkg. this spkg is the pynac-0.2.4 spkg from #12950 which has been patched to include the changes from burcin's `pynac-wip` branch of pynac mentioned above.
Is this stuff in the current Pynac 0.2.6?
>  2. apply all patches at #12950, here is a shell script to help that (run from `$SAGE_ROOT/devel/sage`): http://sage.math.washington.edu/home/bjones/trac_12950_apply.sh
Can now be skipped, presumably.
>  3. apply the patches to `$SAGE_ROOT/devel/sage`
>   * [This is the Trac macro *attachment:trac_12289-evalf_dictionary_rebase.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-evalf_dictionary_rebase.patch-macro)
>   * [This is the Trac macro *attachment:trac_12289-add_algorithm_arg.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-add_algorithm_arg.patch-macro)
>   * [This is the Trac macro *attachment:trac_12289-example.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289-example.patch-macro)
>   * [This is the Trac macro *attachment:trac_12289_py_float_fix.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_12289_py_float_fix.patch-macro) (fixes the problem I had in comment:4)
> 
> 4. `sage -b`



---

archive/issue_comments_140245.json:
```json
{
    "body": "Some of these patches have bitrotted slightly.  Updates coming up.",
    "created_at": "2013-06-19T00:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140245",
    "user": "https://github.com/kcrisman"
}
```

Some of these patches have bitrotted slightly.  Updates coming up.



---

archive/issue_comments_140246.json:
```json
{
    "body": "Regarding Doug's comment on \n\n```\nerf(0).n(algorithm='foo')\n```\n\nIs this something we want to fix here?  I'm not sure whether this is behavior that is supported with this patch, though perhaps it should be.  I think that so far this is *only* putting in infrastructure, right?  I don't see any doctests here, for instance.",
    "created_at": "2013-06-19T01:03:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140246",
    "user": "https://github.com/kcrisman"
}
```

Regarding Doug's comment on 

```
erf(0).n(algorithm='foo')
```

Is this something we want to fix here?  I'm not sure whether this is behavior that is supported with this patch, though perhaps it should be.  I think that so far this is *only* putting in infrastructure, right?  I don't see any doctests here, for instance.



---

archive/issue_comments_140247.json:
```json
{
    "body": "Attachment [trac_12289-py_float-fix-rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-py_float-fix-rebase.patch) by @kcrisman created at 2013-06-19 01:04:59",
    "created_at": "2013-06-19T01:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140247",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_12289-py_float-fix-rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-py_float-fix-rebase.patch) by @kcrisman created at 2013-06-19 01:04:59



---

archive/issue_comments_140248.json:
```json
{
    "body": "Attachment [trac_12289-add_algorithm-rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-add_algorithm-rebase.patch) by @kcrisman created at 2013-06-19 01:06:58",
    "created_at": "2013-06-19T01:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140248",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_12289-add_algorithm-rebase.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-add_algorithm-rebase.patch) by @kcrisman created at 2013-06-19 01:06:58



---

archive/issue_comments_140249.json:
```json
{
    "body": "Patchbot, apply trac_12289-evalf_dictionary_rebase.patch , trac_12289-add_algorithm-rebase.patch , and trac_12289-py_float-fix-rebase.patch",
    "created_at": "2013-06-19T01:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140249",
    "user": "https://github.com/kcrisman"
}
```

Patchbot, apply trac_12289-evalf_dictionary_rebase.patch , trac_12289-add_algorithm-rebase.patch , and trac_12289-py_float-fix-rebase.patch



---

archive/issue_comments_140250.json:
```json
{
    "body": "I think that we definitely need at least one example of how to do this if we aren't going to have any other documentation here.",
    "created_at": "2013-06-19T01:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140250",
    "user": "https://github.com/kcrisman"
}
```

I think that we definitely need at least one example of how to do this if we aren't going to have any other documentation here.



---

archive/issue_comments_140251.json:
```json
{
    "body": "We need to fix this.\n\n```\n----------------------------------------------------------------------\nsage -t sage/symbolic/expression.pyx  # 3 doctests failed\nsage -t sage/functions/other.py  # Killed due to segmentation fault\nsage -t sage/functions/exp_integral.py  # 25 doctests failed\nsage -t sage/functions/log.py  # 4 doctests failed\nsage -t sage/symbolic/pynac.pyx  # 2 doctests failed\nsage -t sage/symbolic/function.pyx  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nBut it does work!",
    "created_at": "2013-06-19T02:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140251",
    "user": "https://github.com/kcrisman"
}
```

We need to fix this.

```
----------------------------------------------------------------------
sage -t sage/symbolic/expression.pyx  # 3 doctests failed
sage -t sage/functions/other.py  # Killed due to segmentation fault
sage -t sage/functions/exp_integral.py  # 25 doctests failed
sage -t sage/functions/log.py  # 4 doctests failed
sage -t sage/symbolic/pynac.pyx  # 2 doctests failed
sage -t sage/symbolic/function.pyx  # 1 doctest failed
----------------------------------------------------------------------
```

But it does work!



---

archive/issue_comments_140252.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-19T02:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140252",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_140253.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-19T02:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140253",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_140254.json:
```json
{
    "body": "Changing keywords from \"pynac sd35.5 sd40.5\" to \"pynac sd35.5 sd40.5 sd48\".",
    "created_at": "2013-06-19T02:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140254",
    "user": "https://github.com/eviatarbach"
}
```

Changing keywords from "pynac sd35.5 sd40.5" to "pynac sd35.5 sd40.5 sd48".



---

archive/issue_comments_140255.json:
```json
{
    "body": "Okay, Burcin figured out what he forgot here :) and most of the rest should be easily fixable.",
    "created_at": "2013-06-19T02:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140255",
    "user": "https://github.com/kcrisman"
}
```

Okay, Burcin figured out what he forgot here :) and most of the rest should be easily fixable.



---

archive/issue_comments_140256.json:
```json
{
    "body": "Okay, everything fixed except a segfault on beta which is exactly the same one which [this](http://trac.sagemath.org/sage_trac/attachment/ticket/9130/trac_9130-py_float_segfault.take2.patch) fixed.  Burcin says that this needs to be handled properly and so \n\n```\n\nstatic ex beta_evalf(const ex & x, const ex & y, PyObject* parent)\n{\n        if (is_exactly_a<numeric>(x) && is_exactly_a<numeric>(y)) {\n                try {\n                        return exp(lgamma(ex_to<numeric>(x))+lgamma(ex_to<numeric>(y))-lgamma(ex_to<numeric>(x+y)));\n                } catch (const dunno &e) { }\n        }\n\n        return beta(x,y).hold();\n}\n```\n\nin ginac/inifcns_gamma.cpp needs to be worked on in addition to other stuff.",
    "created_at": "2013-06-19T03:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140256",
    "user": "https://github.com/kcrisman"
}
```

Okay, everything fixed except a segfault on beta which is exactly the same one which [this](http://trac.sagemath.org/sage_trac/attachment/ticket/9130/trac_9130-py_float_segfault.take2.patch) fixed.  Burcin says that this needs to be handled properly and so 

```

static ex beta_evalf(const ex & x, const ex & y, PyObject* parent)
{
        if (is_exactly_a<numeric>(x) && is_exactly_a<numeric>(y)) {
                try {
                        return exp(lgamma(ex_to<numeric>(x))+lgamma(ex_to<numeric>(y))-lgamma(ex_to<numeric>(x+y)));
                } catch (const dunno &e) { }
        }

        return beta(x,y).hold();
}
```

in ginac/inifcns_gamma.cpp needs to be worked on in addition to other stuff.



---

archive/issue_comments_140257.json:
```json
{
    "body": "Attachment [trac_12289-more-alg.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-more-alg.patch) by @kcrisman created at 2013-06-19 03:11:23",
    "created_at": "2013-06-19T03:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140257",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_12289-more-alg.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-more-alg.patch) by @kcrisman created at 2013-06-19 03:11:23



---

archive/issue_comments_140258.json:
```json
{
    "body": "Patchbot, apply trac_12289-evalf_dictionary_rebase.patch , trac_12289-add_algorithm-rebase.patch, trac_12289-py_float-fix-rebase.patch, and trac_12289-more-alg.patch",
    "created_at": "2013-06-19T03:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140258",
    "user": "https://github.com/kcrisman"
}
```

Patchbot, apply trac_12289-evalf_dictionary_rebase.patch , trac_12289-add_algorithm-rebase.patch, trac_12289-py_float-fix-rebase.patch, and trac_12289-more-alg.patch



---

archive/issue_comments_140259.json:
```json
{
    "body": "Attachment [trac_12289-evalf_dictionary_rebase.take2.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary_rebase.take2.patch) by @burcin created at 2013-06-19 20:11:59",
    "created_at": "2013-06-19T20:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140259",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_12289-evalf_dictionary_rebase.take2.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-evalf_dictionary_rebase.take2.patch) by @burcin created at 2013-06-19 20:11:59



---

archive/issue_comments_140260.json:
```json
{
    "body": "Attachment [trac_12289-last_touches.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-last_touches.patch) by @burcin created at 2013-06-19 20:18:27\n\nNew patches up. All doctests pass in `sage/{symbolics,calculus}/`.",
    "created_at": "2013-06-19T20:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140260",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_12289-last_touches.patch](tarball://root/attachments/some-uuid/ticket12289/trac_12289-last_touches.patch) by @burcin created at 2013-06-19 20:18:27

New patches up. All doctests pass in `sage/{symbolics,calculus}/`.



---

archive/issue_comments_140261.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-19T20:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140261",
    "user": "https://github.com/burcin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_140262.json:
```json
{
    "body": "> So that we don't forget to fix it later:\n> {{{\n> sage: erf(1).n(algorithm='foo')\n> 0.842700792949715\n> sage: erf(0)\n> 0\n> sage: parent(erf(0))\n> Integer Ring\n> sage: erf(0).n(algorithm='foo')\n> ---------------------------------------------------------------------------\n> TypeError                                 Traceback (most recent call last)\n> \n> /Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/devel/sage-hack2/sage/<ipython console> in <module>()\n> \n> /Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4988)()\n> \n> TypeError: numerical_approx() got an unexpected keyword argument 'algorithm'\n> }}}\nThis is now #14778.  Shouldn't impact this being merged.\n\nBy which to say, this passes all tests.  The most recent fixes are fine.  Burcin, what would need to be reviewed still?",
    "created_at": "2013-06-19T20:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140262",
    "user": "https://github.com/kcrisman"
}
```

> So that we don't forget to fix it later:
> {{{
> sage: erf(1).n(algorithm='foo')
> 0.842700792949715
> sage: erf(0)
> 0
> sage: parent(erf(0))
> Integer Ring
> sage: erf(0).n(algorithm='foo')
> ---------------------------------------------------------------------------
> TypeError                                 Traceback (most recent call last)
> 
> /Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/devel/sage-hack2/sage/<ipython console> in <module>()
> 
> /Users/mcneil/sagedev/sage-5.1.beta0b/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4988)()
> 
> TypeError: numerical_approx() got an unexpected keyword argument 'algorithm'
> }}}
This is now #14778.  Shouldn't impact this being merged.

By which to say, this passes all tests.  The most recent fixes are fine.  Burcin, what would need to be reviewed still?



---

archive/issue_comments_140263.json:
```json
{
    "body": "This (or possibly a closely related patch) fails a doctest, actually.  Sorry if this isn't the precise ticket.\n\n```\nsage -t sage/misc/sagedoc.py\n**********************************************************************\nFile \"sage/misc/sagedoc.py\", line 22, in sage.misc.sagedoc\nFailed example:\n    for line in open(docfilename):\n          if \"#sage.symbolic.expression.Expression.N\" in line:\n              print line\nExpected:\n    <tt class=\"descname\">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em><big>)</big>...\nGot:\n    <tt class=\"descname\">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em>, <em>algorithm=None</em><big>)</big><a class=\"headerlink\" href=\"#sage.symbolic.expression.Expression.N\" title=\"Permalink to this definition\">\u00b6</a></dt>\n    <BLANKLINE>\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.misc.sagedoc\n    [73 tests, 1 failure, 9.81 s]\n```\n\n\nPatchbot, apply trac_12289-evalf_dictionary_rebase.take2.patch ,\ntrac_12289-add_algorithm-rebase.patch ,\ntrac_12289-more-alg.patch \ntrac_12289-last_touches.patch",
    "created_at": "2013-07-03T17:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140263",
    "user": "https://github.com/kcrisman"
}
```

This (or possibly a closely related patch) fails a doctest, actually.  Sorry if this isn't the precise ticket.

```
sage -t sage/misc/sagedoc.py
**********************************************************************
File "sage/misc/sagedoc.py", line 22, in sage.misc.sagedoc
Failed example:
    for line in open(docfilename):
          if "#sage.symbolic.expression.Expression.N" in line:
              print line
Expected:
    <tt class="descname">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em><big>)</big>...
Got:
    <tt class="descname">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em>, <em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.symbolic.expression.Expression.N" title="Permalink to this definition">¶</a></dt>
    <BLANKLINE>
**********************************************************************
1 item had failures:
   1 of   3 in sage.misc.sagedoc
    [73 tests, 1 failure, 9.81 s]
```


Patchbot, apply trac_12289-evalf_dictionary_rebase.take2.patch ,
trac_12289-add_algorithm-rebase.patch ,
trac_12289-more-alg.patch 
trac_12289-last_touches.patch



---

archive/issue_comments_140264.json:
```json
{
    "body": "Replying to [comment:25 kcrisman]:\n> This (or possibly a closely related patch) fails a doctest, actually.  Sorry if this isn't the precise ticket.\n> {{{\n> sage -t sage/misc/sagedoc.py\n> **********************************************************************\n> File \"sage/misc/sagedoc.py\", line 22, in sage.misc.sagedoc\n> Failed example:\n>     for line in open(docfilename):\n>           if \"#sage.symbolic.expression.Expression.N\" in line:\n>               print line\n> Expected:\n>     <tt class=\"descname\">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em><big>)</big>...\n> Got:\n>     <tt class=\"descname\">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em>, <em>algorithm=None</em><big>)</big><a class=\"headerlink\" href=\"#sage.symbolic.expression.Expression.N\" title=\"Permalink to this definition\">\u00b6</a></dt>\n>     <BLANKLINE>\n> }}}\n\nYeah, I'm pretty sure this would do it, because of\n\n```\ndef _numerical_approx(self, prec=None, digits=None, algorithm=None): \n```\n\nin the symbolic expression file.",
    "created_at": "2013-09-23T17:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140264",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:25 kcrisman]:
> This (or possibly a closely related patch) fails a doctest, actually.  Sorry if this isn't the precise ticket.
> {{{
> sage -t sage/misc/sagedoc.py
> **********************************************************************
> File "sage/misc/sagedoc.py", line 22, in sage.misc.sagedoc
> Failed example:
>     for line in open(docfilename):
>           if "#sage.symbolic.expression.Expression.N" in line:
>               print line
> Expected:
>     <tt class="descname">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em><big>)</big>...
> Got:
>     <tt class="descname">N</tt><big>(</big><em>prec=None</em>, <em>digits=None</em>, <em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.symbolic.expression.Expression.N" title="Permalink to this definition">¶</a></dt>
>     <BLANKLINE>
> }}}

Yeah, I'm pretty sure this would do it, because of

```
def _numerical_approx(self, prec=None, digits=None, algorithm=None): 
```

in the symbolic expression file.



---

archive/issue_comments_140265.json:
```json
{
    "body": "for the **patchbots**:\n\napply trac_12289-evalf_dictionary_rebase.take2.patch trac_12289-add_algorithm-rebase.patch trac_12289-more-alg.patch trac_12289-last_touches.patch",
    "created_at": "2013-11-15T10:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140265",
    "user": "https://github.com/fchapoton"
}
```

for the **patchbots**:

apply trac_12289-evalf_dictionary_rebase.take2.patch trac_12289-add_algorithm-rebase.patch trac_12289-more-alg.patch trac_12289-last_touches.patch



---

archive/issue_comments_140266.json:
```json
{
    "body": "This ticket depends on an SPKG update. The patchbot cannot handle those ATM.\n\nIIRC, the pynac update is complete and waiting for review. See #15198 for details.",
    "created_at": "2013-11-15T10:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140266",
    "user": "https://github.com/burcin"
}
```

This ticket depends on an SPKG update. The patchbot cannot handle those ATM.

IIRC, the pynac update is complete and waiting for review. See #15198 for details.



---

archive/issue_comments_140267.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-02-20T11:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140267",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

New commits:



---

archive/issue_comments_140268.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-20T11:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140268",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_140269.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-20T11:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140269",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_140270.json:
```json
{
    "body": "I just rebased the old patches and fixed an additional missing new keyword.\nI'm happy with the changes.\nThere is still the blankline issue of comment:29.",
    "created_at": "2014-02-20T13:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140270",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I just rebased the old patches and fixed an additional missing new keyword.
I'm happy with the changes.
There is still the blankline issue of comment:29.



---

archive/issue_comments_140271.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-20T14:12:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_140272.json:
```json
{
    "body": "In fact the doctest was expected to change... so needs review for the two basic changes I made.\nWhat was done before was already reviewed and I'm happy in case it was not.\n----\nNew commits:",
    "created_at": "2014-02-20T14:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140272",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

In fact the doctest was expected to change... so needs review for the two basic changes I made.
What was done before was already reviewed and I'm happy in case it was not.
----
New commits:



---

archive/issue_comments_140273.json:
```json
{
    "body": "I can't do actual testing now (or any time soon, I've really fallen off the development radar screen) but these minor changes in the last two commits are completely fine as long as the doc change fixes the problem.  Hopefully we'll actually start implementing some of these algorithms now...",
    "created_at": "2014-02-28T15:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140273",
    "user": "https://github.com/kcrisman"
}
```

I can't do actual testing now (or any time soon, I've really fallen off the development radar screen) but these minor changes in the last two commits are completely fine as long as the doc change fixes the problem.  Hopefully we'll actually start implementing some of these algorithms now...



---

archive/issue_comments_140274.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-02-28T15:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140274",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_140275.json:
```json
{
    "body": "Testing will be done automatically by the patchbots, so I'll take your comment as positive review.",
    "created_at": "2014-02-28T15:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140275",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Testing will be done automatically by the patchbots, so I'll take your comment as positive review.



---

archive/issue_comments_140276.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-04T16:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140276",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_140277.json:
```json
{
    "body": "Is there any particular reason that this was done for `_evalf_` and not also plain `_eval_`?",
    "created_at": "2014-12-19T21:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140277",
    "user": "https://github.com/jdemeyer"
}
```

Is there any particular reason that this was done for `_evalf_` and not also plain `_eval_`?



---

archive/issue_comments_140278.json:
```json
{
    "body": "Similarly: shouldn't `__call__` support an `algorithm` argument such that one could do\n\n```\nsage: f(0.12345, algorithm=\"foobar\")\n```\n",
    "created_at": "2014-12-19T21:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12117",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12117#issuecomment-140278",
    "user": "https://github.com/jdemeyer"
}
```

Similarly: shouldn't `__call__` support an `algorithm` argument such that one could do

```
sage: f(0.12345, algorithm="foobar")
```

