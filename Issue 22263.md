# Issue 22263: Add .is_combinatorially_isomorphic() method to polyhedra

Issue created by migration from https://trac.sagemath.org/ticket/22500

Original creator: jipilab

Original creation time: 2017-03-02 18:34:23

CC:  moritz mkoeppe vdelecroix tmonteil chapoton

Keywords: polytope, geometry, days84

Two polyhedra are combinatorially isomorphic if their face lattices are isomorphic as posets.

Ideally, the test for combinatorial isomorphism would test some invariants before using the face lattice of the polyhedra.


---

Comment by moritz created at 2017-03-06 01:12:07

pushed first version, which handles bounded polyhedra
----
New commits:


---

Comment by git created at 2017-03-06 11:36:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2017-03-06 11:36:57

Hi Moritz,

Here are some corrections:

 - the input should be something like:


```
    INPUT:
    - ``other`` - a polyhedron object
    - ``algorithm`` (default=`bipartite_graph`) - specifies the algorithm to use. The other possible value is `face_lattice`.
```


 - The paragraph starting with `Checking that a` should be unindented (and next block also)
 - `intersected its...` should be `intersected with its reflection through the origin.`
 - `isomorpic to ` -> `isomorphic to the`
 - several other missing words.
 - start with a simple example, perhaps move the less informative ones to a section TESTS::
 - pep 8 conventions (spacing ` = `, etc.)
 - f-vector -> `f`-vector .  (add `r` before the docstring)
 - make the `AssertionError` messages consistent with the input names, to help the user.
 - separated the `AssertionError` about the compactness of `self` and `other``
 - Add a comment about the prior check on the number of vertices and facets (did you make some tests to see whether this improves the speed on some examples?) It would be nice to have it here.
----
New commits:
----
New commits:


---

Comment by moritz created at 2017-03-06 13:32:57

Two explanations for speed:

To see, that the check before building the bipartite graph is necessary, we do some timing.
When we don't check the number of vertices facets, we get:


```
sage: C=polytopes.hypercube(14)
sage: D = polytopes.hypercube(15)
sage: time C.is_combinatorially_isomorphic(D)
CPU times: user 5.4 s, sys: 80 ms, total: 5.48 s
Wall time: 5.43 s
False
```


otherwise:


```
sage: C=polytopes.hypercube(14)
Dsage: D=polytopes.hypercube(15)
sage: time C.is_combinatorially_isomorphic(D)
CPU times: user 20 ms, sys: 32 ms, total: 52 ms
Wall time: 38.6 ms
False
```


The following tests shows, that the  `bipartite_graph` is much faster then `face_lattice` algorithm. For the 7-cube it is more than 1000 times faster on my machine


```
sage: time C.is_combinatorially_isomorphic(C, algo='face_lattice')
CPU times: user 28.5 s, sys: 64 ms, total: 28.6 s
Wall time: 28.6 s
True
sage: time C.is_combinatorially_isomorphic(C, algo='bipartite_graph')
CPU times: user 24 ms, sys: 0 ns, total: 24 ms
Wall time: 23.6 ms
True
```

}}}


---

Comment by git created at 2017-03-06 13:34:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by moritz created at 2017-03-06 13:35:51

Thanks for the remarks, JP! 
I have implemented all of them..


---

Comment by git created at 2017-03-06 16:55:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by moritz created at 2017-03-06 16:56:03

added a reference


---

Comment by moritz created at 2017-03-06 16:56:03

Changing status from new to needs_review.


---

Comment by jipilab created at 2017-03-06 18:41:13

Changing status from needs_review to needs_work.


---

Comment by jipilab created at 2017-03-06 18:41:13

There are still some things to correct:

 - `algo` to `algorithm`: it is better to have a complete keyword.
 - sixgon -> hexagon
 - `intersected its...` should be `intersected with its reflection through the origin.`
 - `isomorpic to ` -> `isomorphic to the`
 - but different combinatorial type**s**

The reference did not seem to work, but maybe that may be because my doc is broken. The rest of the doc seems to be okay.


---

Comment by git created at 2017-03-06 18:57:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by moritz created at 2017-03-06 18:57:54

Merci JP, hopefully I got everything this time.


---

Comment by moritz created at 2017-03-06 18:57:54

Changing status from needs_work to needs_review.


---

Comment by git created at 2017-03-07 11:17:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2017-03-07 11:21:43

Changing status from needs_review to positive_review.


---

Comment by jipilab created at 2017-03-07 11:21:43

Hi Moritz,

Thanks for correcting the typos. The last change should not change the result of the last bot check. The ticket now looks good to go.


---

Comment by vbraun created at 2017-03-10 23:13:11

Resolution: fixed
