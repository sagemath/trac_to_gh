# Issue 12719: Invite for contributing a doctest, if a user reads an untested function or method

Issue created by migration from https://trac.sagemath.org/ticket/12891

Original creator: SimonKing

Original creation time: 2012-04-30 15:45:33

Assignee: was

CC:  drkirkby

Keywords: documentation untested

On [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/aa60c0616ecdd1b6), Johan Gr√∂nqvist suggested to add a message when a function is called that has no doctest. The problem is that that would massively affect the performance.

I suggested a modification of that idea: When the user reads the documentation of an untested function (or method) either in the notebook or the command line interface, s/he should be invited to contribute a test, such as

```
sage: def my_function(a,b):
....:     """
....:     some docs, but no test
....:     """
....:     return a+b
....: 
sage: my_function?
Type:		function
Base Class:	<type 'function'>
String Form:	<function my_function at 0x7309938>
Namespace:	Interactive
Loaded File:	/mnt/local/king/SAGE/stable/sage-5.0.beta13/devel/sage-main/<ipython console>
Source File:	/mnt/local/king/SAGE/stable/sage-5.0.beta13/devel/sage-main/<ipython console>
Definition:	my_function(a, b)
Docstring:
       ####
       # my_function appears to be untested.
       # The Sage community would appreciate if someone (e.g., you)
       # added a test to the documentation.
       ####
       some docs, but no test
```


Reading the documentation is certainly not critical for performance. I thought it could be implemented in sage/misc/sagedoc.py or sage/misc/sageinspect.py. Unfortunately, this only holds for the ipython interface of Sage. The notebook seems to use stuff in sagenb/misc/support.py and sagenb/misc/sageinspect.py (which is an * _outdated_ copy* of sage/misc/sageinspect.py!).


---

Comment by drkirkby created at 2012-04-30 20:48:55

I'm guessing this will be a sort of meta-ticket, where you open another ticket for an undocumented function, and provide a link here. Hopefully then writing the doctest on the other ticket. Is that what you had in mind? 

Dave


---

Comment by SimonKing created at 2012-04-30 20:56:40

Changing type from PLEASE CHANGE to enhancement.


---

Comment by SimonKing created at 2012-04-30 20:56:40

Replying to [comment:3 drkirkby]:
> I'm guessing this will be a sort of meta-ticket, where you open another ticket for an undocumented function, and provide a link here. Hopefully then writing the doctest on the other ticket. Is that what you had in mind? 

Not at all. As the ticket description says: The aim is to change the behaviour of `obj?` in Notebook and ipython interface (I am afraid both needs to be done) so that people trying to read the documentation of obj are encouraged to contribute a doctest (of course only if such doctest is missing).

In other words, this is not a (meta-)ticket about doctests but a ticket about a potential approach to get people to start contributing to sage by writing doctests (this is why I chose the component "user interface", not "doctest").


---

Comment by jhpalmieri created at 2012-04-30 21:10:09

By the way, would it make sense to eliminate the Sage version of sageinspect.py, and just use the version from sagenb all the time? Since sagenb is part of Sage, we would always have access to this file, but it still allows sagenb to be a standalone project. (This requires updating the version of sageinspect.py currently in sagenb, of course.)


---

Comment by SimonKing created at 2012-04-30 21:39:14

Replying to [comment:5 jhpalmieri]:
> By the way, would it make sense to eliminate the Sage version of sageinspect.py, and just use the version from sagenb all the time? Since sagenb is part of Sage, we would always have access to this file, but it still allows sagenb to be a standalone project. (This requires updating the version of sageinspect.py currently in sagenb, of course.)

From my perspective, it does not make sense that _any_ version of sageinspect is in sagenb, if the sage notebook wants to pretend to be standalone.

sageinspect is supposed to know how to find sources _in the `SAGE_ROOT/devel/sage/` repository_, but I don't think that the notebook should try to find files in `SAGE_ROOT/devel/sage/` if it is used in a project that has nothing to do with Sage.

Off topic:
A better solution for the notebook as a standalone project would be to create a hook for the relevant functionality: The relevant functions are supposed to return the doc of a given object or to find the source of a given object or to determine the arguments of a function.

In other words, there should be a module sagenb.inspect containing placeholder functions such as get_doc and get_sourcelines (perhaps defaulting to Python's inspect.getdoc and inspect.getsourcelines), and the notebook should entirely rely on these functions. Now, if one wants to use the standalone notebook for Sage, then one has to do

```
sagenb.inspect.getdoc = sage.misc.sageinspect.sage_getdoc
sagenb.inspect.getsourcelines = sage.misc.sageinspect.sage_getsourcelines
sagenb.inspect.getargspec = sage.misc.sageinspect.sage_getargspec
...
```

and if one wants to use the notebook in, say, mathematica, then one has to use other definitions (assigning sagenb.inspect.getsourcelines to a function that raises a `NotImplementedError` or so...),

The advantage for the topic of this ticket would be that we only needed to change one location, not two. The advantage for me would be: I am not a notebook user, and I don't really want to learn github for something that I don't use.


---

Comment by SimonKing created at 2012-05-03 07:15:41

Question: Should the encouraging message only be shown when a user interactively reads the documentation (by `obj?` in the notebook resp. in command line version), or should it also appear in the reference manual?


---

Comment by knsam created at 2013-02-18 22:29:42

Changing status from new to needs_info.


---

Comment by knsam created at 2013-02-18 22:29:42

That I am changing the status to needs_info, let me just say that, we should be able to add this "Please contribute doctests" only in the interactive version. It would be very annoying to have this message in files where every function lacks doctests and the reference manual tells people "Please contribute doctests". 

~KnS
