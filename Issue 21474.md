# Issue 21474: Fix regresion introduced by #21670

Issue created by migration from https://trac.sagemath.org/ticket/21711

Original creator: etn40ff

Original creation time: 2016-10-15 20:47:05

CC:  vbraun tscrim

Keywords: %attach #21670

#21670, while fixing `%attach` crashes sage if, for any reason, `select.select()` is
interrupted once a file has been attached. This happens for example when resizing windows.

Here is how to reproduce the bug. In a new xterm run


```
$ echo "a = 1" > /tmp/test.py
$ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.4.rc2, Release Date: 2016-10-15                 │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage:
```


Now resize the xterm, everything works as it is supposed to.
Now attach /tmp/test.py and again resize the window:

```
sage: %attach /tmp/prova.py
sage:

**********************************************************************

Oops, Sage crashed. We do our best to make it stable, but...
```



---

Comment by etn40ff created at 2016-10-15 20:51:55

New commits:


---

Comment by git created at 2016-10-15 20:53:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-10-15 21:43:59

lgtm, thanks!


---

Comment by tscrim created at 2016-10-15 22:24:23

*cough*ticket is still new*cough*


---

Comment by etn40ff created at 2016-10-15 22:27:55

Changing status from new to needs_review.


---

Comment by vbraun created at 2016-10-15 22:32:53

Author name...


---

Comment by etn40ff created at 2016-10-15 22:38:11

Sorry for the long list of omissions: it is quite late over here.


---

Comment by tscrim created at 2016-10-15 22:45:18

As Volker said, thanks!


---

Comment by tscrim created at 2016-10-15 22:45:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-10-21 07:04:47

Resolution: fixed
