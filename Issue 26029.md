# Issue 26029: @interact is broken

archive/issues_026029.json:
```json
{
    "body": "CC:  embray\n\nKeywords: jupyter interact\n\nJupyter output with version 8.4.beta4 on Python3 :\n\n\n```\n@interact(x=True, y=1.0)\ndef g(x, y):\n    return (x, y)\n----------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-6-72d2e695a5da> in <module>()\n----> 1 @interact(x=True, y=RealNumber('1.0'))\n      2 def g(x, y):\n      3     return (x, y)\n\n.../local/lib/python3.6/site-packages/ipywidgets/widgets/interaction.py in __call__(self, _InteractFactory__interact_f, **kwargs)\n    521         #    def f(*args, **kwargs):\n    522         #        ...\n--> 523         w = self.widget(f)\n    524         try:\n    525             f.widget = w\n\n.../local/lib/python3.6/site-packages/ipywidgets/widgets/interaction.py in widget(self, f)\n    437             The function to which the interactive widgets are tied.\n    438         \"\"\"\n--> 439         return self.cls(f, self.opts, **self.kwargs)\n    440 \n    441     def __call__(self, __interact_f=None, **kwargs):\n\n.../local/lib/python3.6/site-packages/sage/repl/ipython_kernel/interact.py in __init__(*args, **kwds)\n     89         # Check for auto_update in signature\n     90         sig = signature(f)\n---> 91         params = copy(sig.parameters)\n     92         try:\n     93             p_auto_update = params.pop(\"auto_update\")\n\n.../local/lib/python3.6/copy.py in copy(x)\n     94         reductor = getattr(x, \"__reduce_ex__\", None)\n     95         if reductor:\n---> 96             rv = reductor(4)\n     97         else:\n     98             reductor = getattr(x, \"__reduce__\", None)\n\nTypeError: can't pickle mappingproxy objects\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26266\n\n",
    "created_at": "2018-09-13T08:01:42Z",
    "labels": [
        "python3",
        "major",
        "bug"
    ],
    "title": "@interact is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26029",
    "user": "zerline"
}
```
CC:  embray

Keywords: jupyter interact

Jupyter output with version 8.4.beta4 on Python3 :


```
@interact(x=True, y=1.0)
def g(x, y):
    return (x, y)
----------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-6-72d2e695a5da> in <module>()
----> 1 @interact(x=True, y=RealNumber('1.0'))
      2 def g(x, y):
      3     return (x, y)

.../local/lib/python3.6/site-packages/ipywidgets/widgets/interaction.py in __call__(self, _InteractFactory__interact_f, **kwargs)
    521         #    def f(*args, **kwargs):
    522         #        ...
--> 523         w = self.widget(f)
    524         try:
    525             f.widget = w

.../local/lib/python3.6/site-packages/ipywidgets/widgets/interaction.py in widget(self, f)
    437             The function to which the interactive widgets are tied.
    438         """
--> 439         return self.cls(f, self.opts, **self.kwargs)
    440 
    441     def __call__(self, __interact_f=None, **kwargs):

.../local/lib/python3.6/site-packages/sage/repl/ipython_kernel/interact.py in __init__(*args, **kwds)
     89         # Check for auto_update in signature
     90         sig = signature(f)
---> 91         params = copy(sig.parameters)
     92         try:
     93             p_auto_update = params.pop("auto_update")

.../local/lib/python3.6/copy.py in copy(x)
     94         reductor = getattr(x, "__reduce_ex__", None)
     95         if reductor:
---> 96             rv = reductor(4)
     97         else:
     98             reductor = getattr(x, "__reduce__", None)

TypeError: can't pickle mappingproxy objects
```



Issue created by migration from https://trac.sagemath.org/ticket/26266





---

archive/issue_comments_367159.json:
```json
{
    "body": "Turns out I already have this fixed in my Python 3 branch; I just never pushed the fixes.",
    "created_at": "2018-09-13T10:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367159",
    "user": "embray"
}
```

Turns out I already have this fixed in my Python 3 branch; I just never pushed the fixes.



---

archive/issue_comments_367160.json:
```json
{
    "body": "Set assignee to embray.",
    "created_at": "2018-09-13T10:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367160",
    "user": "embray"
}
```

Set assignee to embray.



---

archive/issue_comments_367161.json:
```json
{
    "body": "FWIW this is the patch I used\n\n\n```diff\ndiff --git a/src/sage/repl/ipython_kernel/interact.py b/src/sage/repl/ipython_kernel/interact.py\nindex 9372426..d49af6f 100644\n--- a/src/sage/repl/ipython_kernel/interact.py\n+++ b/src/sage/repl/ipython_kernel/interact.py\n@@ -35,8 +35,7 @@ EXAMPLES::\n\n from ipywidgets.widgets import SelectionSlider, ValueWidget, ToggleButtons\n from ipywidgets.widgets.interaction import interactive, signature\n-from copy import copy\n-from collections import Iterable, Iterator\n+from collections import Iterable, Iterator, OrderedDict\n from .widgets import EvalText, SageColorPicker\n from sage.structure.element import parent\n from sage.symbolic.ring import SR\n@@ -88,7 +87,7 @@ class sage_interactive(interactive):\n\n         # Check for auto_update in signature\n         sig = signature(f)\n-        params = copy(sig.parameters)\n+        params = OrderedDict(sig.parameters)\n         try:\n             p_auto_update = params.pop(\"auto_update\")\n         except KeyError:\n\n```\n\n\nI will make a branch in a bit unless you want to do it first.",
    "created_at": "2018-09-13T10:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367161",
    "user": "embray"
}
```

FWIW this is the patch I used


```diff
diff --git a/src/sage/repl/ipython_kernel/interact.py b/src/sage/repl/ipython_kernel/interact.py
index 9372426..d49af6f 100644
--- a/src/sage/repl/ipython_kernel/interact.py
+++ b/src/sage/repl/ipython_kernel/interact.py
@@ -35,8 +35,7 @@ EXAMPLES::

 from ipywidgets.widgets import SelectionSlider, ValueWidget, ToggleButtons
 from ipywidgets.widgets.interaction import interactive, signature
-from copy import copy
-from collections import Iterable, Iterator
+from collections import Iterable, Iterator, OrderedDict
 from .widgets import EvalText, SageColorPicker
 from sage.structure.element import parent
 from sage.symbolic.ring import SR
@@ -88,7 +87,7 @@ class sage_interactive(interactive):

         # Check for auto_update in signature
         sig = signature(f)
-        params = copy(sig.parameters)
+        params = OrderedDict(sig.parameters)
         try:
             p_auto_update = params.pop("auto_update")
         except KeyError:

```


I will make a branch in a bit unless you want to do it first.



---

archive/issue_comments_367162.json:
```json
{
    "body": "Thanks! Ok then. No hurry!",
    "created_at": "2018-09-13T10:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367162",
    "user": "zerline"
}
```

Thanks! Ok then. No hurry!



---

archive/issue_comments_367163.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-19T08:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367163",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_367164.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-19T08:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367164",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_367165.json:
```json
{
    "body": "bot is morally green, please review",
    "created_at": "2018-09-19T19:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367165",
    "user": "chapoton"
}
```

bot is morally green, please review



---

archive/issue_comments_367166.json:
```json
{
    "body": "It would be best if zerline could confirm the fix.",
    "created_at": "2018-09-20T11:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367166",
    "user": "embray"
}
```

It would be best if zerline could confirm the fix.



---

archive/issue_comments_367167.json:
```json
{
    "body": "`@`zerline, please have a look",
    "created_at": "2018-10-02T09:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367167",
    "user": "chapoton"
}
```

`@`zerline, please have a look



---

archive/issue_comments_367168.json:
```json
{
    "body": "Replying to [comment:10 chapoton]:\n> `@`zerline, please have a look\n\nyou're right `@`chapoton, I'll check this asap",
    "created_at": "2018-10-04T14:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367168",
    "user": "zerline"
}
```

Replying to [comment:10 chapoton]:
> `@`zerline, please have a look

you're right `@`chapoton, I'll check this asap



---

archive/issue_comments_367169.json:
```json
{
    "body": "Yes, the fix works :)",
    "created_at": "2018-10-05T14:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367169",
    "user": "zerline"
}
```

Yes, the fix works :)



---

archive/issue_comments_367170.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-07T13:07:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367170",
    "user": "zerline"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_367171.json:
```json
{
    "body": "please add reviewer fullname",
    "created_at": "2018-10-11T07:23:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367171",
    "user": "chapoton"
}
```

please add reviewer fullname



---

archive/issue_comments_367172.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-20T11:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367172",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_367173.json:
```json
{
    "body": "This should be re-targeted for 8.5.",
    "created_at": "2018-10-28T14:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26029#issuecomment-367173",
    "user": "embray"
}
```

This should be re-targeted for 8.5.
