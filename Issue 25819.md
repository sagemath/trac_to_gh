# Issue 25819: py3: care for .iteritems

Issue created by migration from https://trac.sagemath.org/ticket/26056

Original creator: chapoton

Original creation time: 2018-08-13 09:54:15

CC:  embray tscrim




---

Comment by chapoton created at 2018-08-13 09:54:41

New commits:


---

Comment by chapoton created at 2018-08-13 09:54:41

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-08-14 01:32:48

For `free_module_element.pyx`, the `e` is assumed to be a `dict`. So I can get a little bit of a speedup too:

```
sage: from sage.modules.free_module_element import FreeModuleElement_generic_sparse
sage: def S(R,n):
....:     return FreeModule(R, n, sparse=True)
....:
sage: %timeit FreeModuleElement_generic_sparse(S(RR,5), {0:-1, 2:2/3, 3:pi, 4:oo})
The slowest run took 15.53 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 16.4 µs per loop
```

vs before

```
sage: %timeit FreeModuleElement_generic_sparse(S(RR,5), {0:-1, 2:2/3, 3:pi, 4:oo})
The slowest run took 14.90 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 16.8 µs per loop
```

At the very least, it yields cleaner Cython code.

If my changes are good, then positive review.
----
New commits:


---

Comment by chapoton created at 2018-08-14 06:40:15

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-08-14 06:40:15

ok, thanks. I have made one more commit that just fixes a wrong syntax inside one `raise TypeError`.

I allow myself to set to positive.
----
New commits:


---

Comment by vbraun created at 2018-08-17 21:18:22

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2018-08-17 21:18:22

Merge conflict


---

Comment by git created at 2018-08-27 18:11:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-08-27 18:14:52

Travis, I have doubts about the line

```
+        cdef dict entries_dict, e
```

as it seems that e has been renamed entries ?

EDIT: it's ok, in fact


---

Comment by chapoton created at 2018-08-27 18:14:52

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-08-27 18:16:21

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-08-27 18:16:21

the rebase was trivial, I am setting back to positive


---

Comment by vbraun created at 2018-08-30 22:24:39

Resolution: fixed
