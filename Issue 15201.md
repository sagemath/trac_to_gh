# Issue 15201: Fix elias_upper_bound

Issue created by migration from https://trac.sagemath.org/ticket/15438

Original creator: pmueller

Original creation time: 2013-11-19 16:01:14

CC:  dimpase wdj

The code for the function elias_upper_bound contains an error.


---

Comment by pmueller created at 2013-11-19 16:02:04

fix of elias_upper_bound


---

Attachment


---

Comment by pmueller created at 2013-11-19 17:25:25

Set assignee to pmueller.


---

Comment by pmueller created at 2013-11-19 17:26:36

Changing status from new to needs_review.


---

Comment by pmueller created at 2013-11-19 19:59:08

I just see that there are more problems in the file code_bounds.py. For instance, something like `codesize_upper_bound(10,1,2)` raises an error because it looks for the minimum of the various bounds, but some of them (plotkin, elias) are not defined for these parameters. I think if `elias/plotkin_upper_bound(n, q, d)` isn't defined, it should return a trivial bound like `q^n` instead of an error.

Furthermore, is `RR(fact)==RR(int(fact))` the right way to check if the rational number `fact` is an integer?

While these things, like the original mistake in the `elias_upper_bound`, are easy to fix, I'm a little concerned with the order of arguments. Is there any reason to have for instance `hamming_upper_bound(n, q, d)`, but `q` and `d` switched in `delsarte_bound_hamming_space(n, d, q)` and `codesize_upper_bound(n, d, q)`?

In my opinion that's a perfect and unnecessary source for producing errors. However, making things consistent would break compatibility, so maybe the only way out is to keep the present functions, and use new names for those with consistent argument orders.


---

Comment by ppurka created at 2013-12-15 07:15:07

Replying to [comment:3 pmueller]:
> I just see that there are more problems in the file code_bounds.py. For instance, something like `codesize_upper_bound(10,1,2)` raises an error because it looks for the minimum of the various bounds, but some of them (plotkin, elias) are not defined for these parameters. I think if `elias/plotkin_upper_bound(n, q, d)` isn't defined, it should return a trivial bound like `q^n` instead of an error.

I think it should raise a `ValueError` instead. A trivial bound would give the incorrect impression that the bound is well defined for those parameters.

> Furthermore, is `RR(fact)==RR(int(fact))` the right way to check if the rational number `fact` is an integer?

I agree that that is a really bad way to check for an integer. It should be `isinstance(fact, (ZZ, int, long))`.

> While these things, like the original mistake in the `elias_upper_bound`, are easy to fix, I'm a little concerned with the order of arguments. Is there any reason to have for instance `hamming_upper_bound(n, q, d)`, but `q` and `d` switched in `delsarte_bound_hamming_space(n, d, q)` and `codesize_upper_bound(n, d, q)`?
> 
> In my opinion that's a perfect and unnecessary source for producing errors. However, making things consistent would break compatibility, so maybe the only way out is to keep the present functions, and use new names for those with consistent argument orders.

I think the order of those commands should be fixed once and for all. And a `warning` printed for a year (that is the usual period for deprecation, but we can't deprecate anything here).


---

Comment by pmueller created at 2013-12-15 12:49:27

Replying to [comment:4 ppurka]:
> Replying to [comment:3 pmueller]:
> > I just see that there are more problems in the file code_bounds.py. For instance, something like `codesize_upper_bound(10,1,2)` raises an error because it looks for the minimum of the various bounds, but some of them (plotkin, elias) are not defined for these parameters. I think if `elias/plotkin_upper_bound(n, q, d)` isn't defined, it should return a trivial bound like `q^n` instead of an error.
> 
> I think it should raise a `ValueError` instead. A trivial bound would give the incorrect impression that the bound is well defined for those parameters.
I prefer a true but trivial bound instead, so that one does not have to care about an allowed choice of parameters.
> 
> > While these things, like the original mistake in the `elias_upper_bound`, are easy to fix, I'm a little concerned with the order of arguments. Is there any reason to have for instance `hamming_upper_bound(n, q, d)`, but `q` and `d` switched in `delsarte_bound_hamming_space(n, d, q)` and `codesize_upper_bound(n, d, q)`?
> > 
> > In my opinion that's a perfect and unnecessary source for producing errors. However, making things consistent would break compatibility, so maybe the only way out is to keep the present functions, and use new names for those with consistent argument orders.
> 
> I think the order of those commands should be fixed once and for all. And a `warning` printed for a year (that is the usual period for deprecation, but we can't deprecate anything here).
I strongly disagree! If we change the order of arguments without changing the function names, then code which was correct will become incorrect in future versions of Sage. I just see another problem: In elias_bound_asymp(delta, q) we *first* have d (via delta) and then q, while in elias_upper_bound(n, q, d) it is the other way around. So maybe we drop the redundant *upper* in the function names, and replace elias/plotkin/etc_upper_bound(n, q, d) by elias/plotkin/etc_bound(n, d, q). Then the naming is consistent with the asymptotic and the delsarte functions.


---

Comment by ppurka created at 2013-12-15 14:23:48

Replying to [comment:7 pmueller]:
> I prefer a true but trivial bound instead, so that one does not have to care about an allowed choice of parameters.

For `codesize_upper_bound`, I think it would be fine to return a trivial bound that should be valid in all ranges of the minimum distance. But not for the specific bounds such as `elias` or `plotkin` - those are really _undefined_ for certain ranges of parameters.

In fact, the Elias bound should be valid till `d <= (q-1)/q * n`. The Plotkin should then take over from there since it needs `d > (q-1)/q * n`. So, there shouldn't be any range for which the trivial bound `q^n` is required. If it is being required, then the bounds need to be fixed.

> > I think the order of those commands should be fixed once and for all. And a `warning` printed for a year (that is the usual period for deprecation, but we can't deprecate anything here).
> I strongly disagree! If we change the order of arguments without changing the function names, then code which was correct will become incorrect in future versions of Sage. I just see another problem: In elias_bound_asymp(delta, q) we *first* have d (via delta) and then q, while in elias_upper_bound(n, q, d) it is the other way around. So maybe we drop the redundant *upper* in the function names, and replace elias/plotkin/etc_upper_bound(n, q, d) by elias/plotkin/etc_bound(n, d, q). Then the naming is consistent with the asymptotic and the delsarte functions.

Well, one way is to keep the current commands and put some warnings. Your suggestion however seems good. We can name some new functions and deprecate the old functions. The old functions can be removed after the deprecation period is over.


---

Comment by ppurka created at 2014-05-24 15:12:03

Changing status from needs_review to positive_review.


---

Comment by ppurka created at 2014-05-24 15:12:03

Sorry, completely forgot about this ticket. This looks good to me. The changes to function names and input arguments can be followed up in #16393
----
New commits:


---

Comment by vbraun created at 2014-05-25 17:31:47

Resolution: fixed


---

Comment by ppurka created at 2014-07-13 11:57:57

Darn. How do I undo this commit? I should have been working on #16393 but was mistakenly working on this ticket instead.
----
New commits:


---

Comment by ppurka created at 2014-07-13 12:09:32

Ok. I did a hard reset to 906a3c.
