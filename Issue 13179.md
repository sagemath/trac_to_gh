# Issue 13179: Cannot import sage.libs.lcalc.lcalc_Lfunction

archive/issues_013179.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  kcrisman dimpase\n\nKeywords: cygwin spkg lcalc\n\nCygchecking the package shows that it looks for an inexistent libLfunction.so.\nIndeed, this file is moved to libLfunction.dll on Cygwin to let Sage build.\nBut at runtime, it is the original .so file which is looked for (surely some DT_SONAME equivalent).\nLetting libLfunction.so in place and symlinking it from libLfunction.dll seems more functional.\n\nA better solution would to tell lcalc to build directly a .dll file on Cygwin (and .dylib on Mac OS X, etc.).\n\nIssue created by migration from https://trac.sagemath.org/ticket/13351\n\n",
    "created_at": "2012-08-08T20:00:58Z",
    "labels": [
        "porting: Cygwin",
        "major",
        "bug"
    ],
    "title": "Cannot import sage.libs.lcalc.lcalc_Lfunction",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13179",
    "user": "jpflori"
}
```
Assignee: tbd

CC:  kcrisman dimpase

Keywords: cygwin spkg lcalc

Cygchecking the package shows that it looks for an inexistent libLfunction.so.
Indeed, this file is moved to libLfunction.dll on Cygwin to let Sage build.
But at runtime, it is the original .so file which is looked for (surely some DT_SONAME equivalent).
Letting libLfunction.so in place and symlinking it from libLfunction.dll seems more functional.

A better solution would to tell lcalc to build directly a .dll file on Cygwin (and .dylib on Mac OS X, etc.).

Issue created by migration from https://trac.sagemath.org/ticket/13351





---

archive/issue_comments_160830.json:
```json
{
    "body": "Update lcalc spkg, modifying lot of the Makefile (that we already modify and which is not that nice) available at\nhttp://perso.telecom-paristech.fr/~flori/sage/lcalc-1.23.p11.spkg\n\nThis will also need a Sage library patch.",
    "created_at": "2012-08-08T21:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160830",
    "user": "jpflori"
}
```

Update lcalc spkg, modifying lot of the Makefile (that we already modify and which is not that nice) available at
http://perso.telecom-paristech.fr/~flori/sage/lcalc-1.23.p11.spkg

This will also need a Sage library patch.



---

archive/issue_comments_160831.json:
```json
{
    "body": "Attachment\n\nSpkg diff, for review only.",
    "created_at": "2012-08-08T21:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160831",
    "user": "jpflori"
}
```

Attachment

Spkg diff, for review only.



---

archive/issue_comments_160832.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-08-08T21:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160832",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_160833.json:
```json
{
    "body": "Does this fix #9165?",
    "created_at": "2013-01-15T15:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160833",
    "user": "kcrisman"
}
```

Does this fix #9165?



---

archive/issue_comments_160834.json:
```json
{
    "body": "No idea :) give it a try.",
    "created_at": "2013-01-15T15:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160834",
    "user": "jpflori"
}
```

No idea :) give it a try.



---

archive/issue_comments_160835.json:
```json
{
    "body": "I think its the last ticket needed to correctly build Sage and get a working version except for a few doctests.\nIt would be great to have it for 5.8, nobody wants to have a look?",
    "created_at": "2013-02-27T22:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160835",
    "user": "jpflori"
}
```

I think its the last ticket needed to correctly build Sage and get a working version except for a few doctests.
It would be great to have it for 5.8, nobody wants to have a look?



---

archive/issue_comments_160836.json:
```json
{
    "body": "I'm sorry, Jean-Pierre - I agree, but I simply have had no time at work to deal with my XP box (esp. since the 32-bit issue apparently is preventing proper rebasing, as discussed somewhere).  I hope to try again over spring break in a couple weeks.",
    "created_at": "2013-02-28T01:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160836",
    "user": "kcrisman"
}
```

I'm sorry, Jean-Pierre - I agree, but I simply have had no time at work to deal with my XP box (esp. since the 32-bit issue apparently is preventing proper rebasing, as discussed somewhere).  I hope to try again over spring break in a couple weeks.



---

archive/issue_comments_160837.json:
```json
{
    "body": "Replying to [comment:7 jpflori]:\n> I think its the last ticket needed to correctly build Sage and get a working version except for a few doctests.\n> It would be great to have it for 5.8, nobody wants to have a look?\nI'm away at a conference, and don't have access to a WIndows machine, until Sunday. And then I'll have jetlag :-)\nSo it has to wait for few days, sorry.",
    "created_at": "2013-02-28T05:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160837",
    "user": "dimpase"
}
```

Replying to [comment:7 jpflori]:
> I think its the last ticket needed to correctly build Sage and get a working version except for a few doctests.
> It would be great to have it for 5.8, nobody wants to have a look?
I'm away at a conference, and don't have access to a WIndows machine, until Sunday. And then I'll have jetlag :-)
So it has to wait for few days, sorry.



---

archive/issue_comments_160838.json:
```json
{
    "body": "No hurry, it's just that its been rottijg around for some monthes, so Id like to get it ressurected :)",
    "created_at": "2013-02-28T07:51:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160838",
    "user": "jpflori"
}
```

No hurry, it's just that its been rottijg around for some monthes, so Id like to get it ressurected :)



---

archive/issue_comments_160839.json:
```json
{
    "body": "I still get import problems:\n\n```\n$ ./sage -t -long devel/sage/sage/libs/lcalc/\nsage -t -long \"devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx\"\n**********************************************************************\nFile \"/usr/local/src/sage/sage-5.7.beta2/devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx\", l 55:\n    sage: from sage.libs.lcalc.lcalc_Lfunction import *\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py\", line 1231, in run__test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/sagedoctest.py\", line 38, in run_oexample\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py\", line 1172, in run__example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[2]>\", line 1, in <module>\n        from sage.libs.lcalc.lcalc_Lfunction import *###line 55:\n    sage: from sage.libs.lcalc.lcalc_Lfunction import *\n    ImportError: No such file or directory\n\netc etc etc\n```\n\nindeed:\n\n```\nsage: import sage.libs.lcalc.lcalc_Lfunction\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-a629fe51f139> in <module>()\n----> 1 import sage.libs.lcalc.lcalc_Lfunction\n\nImportError: No such file or directory\nsage:\n```\n\nnote that \n\n```\nsage: import sage.libs.lcalc\n```\n\nworks.",
    "created_at": "2013-03-04T07:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160839",
    "user": "dimpase"
}
```

I still get import problems:

```
$ ./sage -t -long devel/sage/sage/libs/lcalc/
sage -t -long "devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx"
**********************************************************************
File "/usr/local/src/sage/sage-5.7.beta2/devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx", l 55:
    sage: from sage.libs.lcalc.lcalc_Lfunction import *
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py", line 1231, in run__test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.7.beta2/local/bin/sagedoctest.py", line 38, in run_oexample
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py", line 1172, in run__example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[2]>", line 1, in <module>
        from sage.libs.lcalc.lcalc_Lfunction import *###line 55:
    sage: from sage.libs.lcalc.lcalc_Lfunction import *
    ImportError: No such file or directory

etc etc etc
```

indeed:

```
sage: import sage.libs.lcalc.lcalc_Lfunction
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-a629fe51f139> in <module>()
----> 1 import sage.libs.lcalc.lcalc_Lfunction

ImportError: No such file or directory
sage:
```

note that 

```
sage: import sage.libs.lcalc
```

works.



---

archive/issue_comments_160840.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-04T07:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160840",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_160841.json:
```json
{
    "body": "Replying to [comment:11 dimpase]:\n> I still get import problems:\n> {{{\n> $ ./sage -t -long devel/sage/sage/libs/lcalc/\n> sage -t -long \"devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx\"\n> **********************************************************************\n> File \"/usr/local/src/sage/sage-5.7.beta2/devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx\", l 55:\n>     sage: from sage.libs.lcalc.lcalc_Lfunction import *\n> Exception raised:\n>     Traceback (most recent call last):\n>       File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py\", line 1231, in run__test\n>         self.run_one_example(test, example, filename, compileflags)\n>       File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/sagedoctest.py\", line 38, in run_oexample\n>         OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n>       File \"/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py\", line 1172, in run__example\n>         compileflags, 1) in test.globs\n>       File \"<doctest __main__.example_1[2]>\", line 1, in <module>\n>         from sage.libs.lcalc.lcalc_Lfunction import *###line 55:\n>     sage: from sage.libs.lcalc.lcalc_Lfunction import *\n>     ImportError: No such file or directory\n> \n> etc etc etc\n> }}}\n> indeed:\n> {{{\n> sage: import sage.libs.lcalc.lcalc_Lfunction\n> ---------------------------------------------------------------------------\n> ImportError                               Traceback (most recent call last)\n> <ipython-input-1-a629fe51f139> in <module>()\n> ----> 1 import sage.libs.lcalc.lcalc_Lfunction\n> \n> ImportError: No such file or directory\n> sage:\n> }}}\nDid you install the patch to the Sage library and rebuilt it as well?\n> note that \n> {{{\n> sage: import sage.libs.lcalc\n> }}}\n> works.\nThat's expected, this file is not touched and does not depend on the spkg.",
    "created_at": "2013-03-04T08:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160841",
    "user": "jpflori"
}
```

Replying to [comment:11 dimpase]:
> I still get import problems:
> {{{
> $ ./sage -t -long devel/sage/sage/libs/lcalc/
> sage -t -long "devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx"
> **********************************************************************
> File "/usr/local/src/sage/sage-5.7.beta2/devel/sage/sage/libs/lcalc/lcalc_Lfunction.pyx", l 55:
>     sage: from sage.libs.lcalc.lcalc_Lfunction import *
> Exception raised:
>     Traceback (most recent call last):
>       File "/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py", line 1231, in run__test
>         self.run_one_example(test, example, filename, compileflags)
>       File "/usr/local/src/sage/sage-5.7.beta2/local/bin/sagedoctest.py", line 38, in run_oexample
>         OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
>       File "/usr/local/src/sage/sage-5.7.beta2/local/bin/ncadoctest.py", line 1172, in run__example
>         compileflags, 1) in test.globs
>       File "<doctest __main__.example_1[2]>", line 1, in <module>
>         from sage.libs.lcalc.lcalc_Lfunction import *###line 55:
>     sage: from sage.libs.lcalc.lcalc_Lfunction import *
>     ImportError: No such file or directory
> 
> etc etc etc
> }}}
> indeed:
> {{{
> sage: import sage.libs.lcalc.lcalc_Lfunction
> ---------------------------------------------------------------------------
> ImportError                               Traceback (most recent call last)
> <ipython-input-1-a629fe51f139> in <module>()
> ----> 1 import sage.libs.lcalc.lcalc_Lfunction
> 
> ImportError: No such file or directory
> sage:
> }}}
Did you install the patch to the Sage library and rebuilt it as well?
> note that 
> {{{
> sage: import sage.libs.lcalc
> }}}
> works.
That's expected, this file is not touched and does not depend on the spkg.



---

archive/issue_comments_160842.json:
```json
{
    "body": "yes, I certainly applied trac_13351.patch and ran sage -b. (on 5.7.beta2, but I guess it should not matter).",
    "created_at": "2013-03-04T08:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160842",
    "user": "dimpase"
}
```

yes, I certainly applied trac_13351.patch and ran sage -b. (on 5.7.beta2, but I guess it should not matter).



---

archive/issue_comments_160843.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-03-04T08:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160843",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_160844.json:
```json
{
    "body": "Replying to [comment:14 dimpase]:\n> yes, I certainly applied trac_13351.patch and ran sage -b. (on 5.7.beta2, but I guess it should not matter).\n\nwhat happened is that the Python extension didn't get rebuilt, as the patch didn't touch the corresponding pyx file! So I touched this file, and now everything works. Positive review.",
    "created_at": "2013-03-04T08:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160844",
    "user": "dimpase"
}
```

Replying to [comment:14 dimpase]:
> yes, I certainly applied trac_13351.patch and ran sage -b. (on 5.7.beta2, but I guess it should not matter).

what happened is that the Python extension didn't get rebuilt, as the patch didn't touch the corresponding pyx file! So I touched this file, and now everything works. Positive review.



---

archive/issue_comments_160845.json:
```json
{
    "body": "It works on XP too!",
    "created_at": "2013-03-08T12:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160845",
    "user": "kcrisman"
}
```

It works on XP too!



---

archive/issue_comments_160846.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-13T11:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13179#issuecomment-160846",
    "user": "jdemeyer"
}
```

Resolution: fixed
