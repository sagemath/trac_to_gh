# Issue 16796: Conversion of strings into function fields

Issue created by migration from Trac.

Original creator: SimonKing

Original creation time: 2014-09-24 12:36:26




---

Comment by SimonKing created at 2014-09-24 12:43:25

New commits:


---

Comment by SimonKing created at 2014-09-24 12:43:25

Changing status from new to needs_review.


---

Comment by SimonKing created at 2014-09-24 12:43:25

Changing component from PLEASE CHANGE to algebra.


---

Comment by SimonKing created at 2014-09-24 12:44:48

Changing type from PLEASE CHANGE to defect.


---

Comment by SimonKing created at 2014-09-24 15:30:03

The patchbot reports some numerical noise that is (I think) clearly not caused by the commit of this ticket. And on my laptop, all tests pass.


---

Comment by bhutz created at 2014-09-30 20:49:40

Would you expect something like the following to work:


```
K.<t>=FunctionField(QQ)
R.<x>=PolynomialRing(QQ)
M.<z> = K.extension(x^7-x-t);
M('z')
```


It is giving the same str error that was seen before.


---

Comment by bhutz created at 2014-10-22 16:42:50

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2014-10-22 16:42:50

setting this to 'needs-work' so that it gets noticed.


---

Comment by SimonKing created at 2014-10-22 18:07:23

Replying to [comment:6 bhutz]:
> setting this to 'needs-work' so that it gets noticed.

Why do you think 'needs work' will be more visible? Just on the contrary, a potential reviewer will _not_ look at this ticket if it wrongly says 'needs work'.


---

Comment by SimonKing created at 2014-10-22 18:07:23

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2014-10-22 18:26:59

err..I am the reviewer, I'm trying to get the attention of the author to respond to the question from 3 weeks ago. a 'needs-work' seems more likely to get the attention of the author.


---

Comment by SimonKing created at 2014-10-22 18:38:46

Changing status from needs_review to needs_work.


---

Comment by SimonKing created at 2014-10-22 18:38:46

Replying to [comment:8 bhutz]:
> err..I am the reviewer, I'm trying to get the attention of the author to respond to the question from 3 weeks ago. a 'needs-work' seems more likely to get the attention of the author.

Oops. It was "needs review", so, I thought it was indeed "needs review". But if it doesn't fix the problem, then "needs work" is appropriate...


---

Comment by SimonKing created at 2014-10-29 07:44:38

Here is what the element constructor does:

```
        if x.parent() is self._ring:
            return FunctionFieldElement_polymod(self, x)
        if isinstance(x, FunctionFieldElement):
            return FunctionFieldElement_polymod(self, self._ring(x.element()))
        return FunctionFieldElement_polymod(self, self._ring(x))
```

That's rather silly, since the last line does exactly what the first two lines do, if `x.parent() is self._ring` (then, `self._ring(x)` is supposed to return `x` unaltered). I'll try if removing the first two lines does the job.


---

Comment by SimonKing created at 2014-10-29 07:48:45

Surprisingly, it does not do the job.

Or not surprisingly. After all, the element constructor is only able to coerce things that live in `self._ring`, but it is not able to deal with string representations of what it adds to `self._ring`.


---

Comment by SimonKing created at 2014-10-29 10:58:14

I think a straight forward way out is to use the correct variable name for internal representation.

With the commits that I am now testing, one would get

```
sage: K.<t> = FunctionField(QQ)
sage: R.<x> = QQ[]
sage: M.<z> = K.extension(x^7-x-t)
sage: M(x)   # I guess this is important for backwards compatibility
z
sage: M('z')
z
sage: M('x')
Traceback (most recent call last):
...
TypeError: unable to convert string
```

But before pushing, I need to run tests...


---

Comment by git created at 2014-10-29 13:26:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by SimonKing created at 2014-10-29 13:27:13

Changing status from needs_work to needs_review.


---

Comment by SimonKing created at 2014-10-29 13:27:13

Please test if the new commit fixes the remaining issues.


---

Comment by bhutz created at 2014-10-30 16:33:38

Yes that seems like a reasonable solution here and the remaining issues are fixed.


---

Comment by bhutz created at 2014-10-30 16:33:38

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-15 16:22:31

Resolution: fixed
