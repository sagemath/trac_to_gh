# Issue 32357: Refine growing letters

Issue created by migration from https://trac.sagemath.org/ticket/32594

Original creator: vdelecroix

Original creation time: 2021-09-30 10:19:47

CC:  jlepsova slabbe

The aim is to refine `WordMorphism.growing_letters` to differentiate the various possible behaviors of `|sigma^n(letter)|`. This growth is always of the form `alpha^n n^beta` (where `alpha` is a Perron number and `beta` an integer). Without doing any linear algebra we could differentiate
- mortal (= ultimately empty or `alpha=0`)
- polynomial (`alpha=1`)
- exponential (`alpha > 1`)
The output of the method will a 3-tuple of lists `(mortal, polynomial, exponential)` where
- `mortal` : list of mortal letters
- `polynomial`: a list of lists where `polynomial[i]` is the list of letters with growth `n^i`.
- `exponential`: list of at least exponentionally growing letters

The implementation can be done iteratively by "cleaning" the morphism
- use the already existing `immortal_letters` to detect mortal letters and remove them
- now run an iteration to detect cycles of letters and clean the morphism by removing letters belonging to cycles (each run give polynomially growing letters of higher and higher degrees)
- once there is no cycle anymore, the remaining letters are exponentially growing


---

Comment by slabbe created at 2021-10-07 12:03:10

We did this this morning during the Sage Thursday's in Bordeaux.
----
New commits:


---

Comment by slabbe created at 2021-10-07 12:03:10

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2021-10-07 20:43:13

Tu fais du sage en dehors des sage thursdays maintenant :)


---

Comment by vdelecroix created at 2021-10-07 20:52:11

The "(mortal, polynomial, exponential)" would better be inside ````.

I don't understand the nested loop. Could you explain in the documentation or in comment how and why it works?


---

Comment by slabbe created at 2021-10-08 16:47:33

Changing status from needs_review to needs_work.


---

Comment by slabbe created at 2021-10-08 16:47:33

ok


---

Comment by slabbe created at 2021-10-08 16:48:23

Replying to [comment:2 vdelecroix]:
> Tu fais du sage en dehors des sage thursdays maintenant :)

C'était fait pendant, mais il y a eu une panne d'internet vers 11h45, donc j'ai fait le git push après déjeuner:)


---

Comment by git created at 2021-11-18 11:04:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by slabbe created at 2021-11-18 11:04:25

Changing status from needs_work to needs_review.


---

Comment by git created at 2021-11-18 11:13:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2021-11-18 11:13:26

Added few more comments. Now need review.


---

Comment by git created at 2021-11-18 11:15:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-11-18 11:19:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2021-11-18 11:19:35

And few more sorry. Now I stop. Needs review!


---

Comment by vdelecroix created at 2021-11-20 13:44:51

New commits:


---

Comment by vdelecroix created at 2021-11-20 13:45:40

I added a commit on top of yours. I did some modifications in the code in order to avoid building many dictionaries. Actually, the whole code is pure linear algebra and could be moved to matrices.


---

Comment by vdelecroix created at 2021-11-20 13:45:50

If you are ok you can set to positive review.


---

Comment by slabbe created at 2021-11-25 15:07:31

There is only one issue to be fixed:

```
src/sage/combinat/words/morphism.py:3283:38: E701 multiple statements on one line (colon)
```

After that fixed, I am fine with positive review.


---

Comment by git created at 2021-11-26 11:26:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2021-11-30 21:14:22

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-12-19 11:47:46

Resolution: fixed
