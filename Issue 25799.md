# Issue 25799: Lie algebra morphism defined by values on a Lie generating subset

archive/issues_025799.json:
```json
{
    "body": "CC:  tscrim\n\nKeywords: Lie algebras, morphisms\n\nImplementation of a method to define a Lie algebra morphism by giving the images on any Lie-generating subset which need not be the entire basis.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26036\n\n",
    "created_at": "2018-08-09T16:41:35Z",
    "labels": [
        "algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Lie algebra morphism defined by values on a Lie generating subset",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25799",
    "user": "@ehaka"
}
```
CC:  tscrim

Keywords: Lie algebras, morphisms

Implementation of a method to define a Lie algebra morphism by giving the images on any Lie-generating subset which need not be the entire basis.

Issue created by migration from https://trac.sagemath.org/ticket/26036





---

archive/issue_comments_364198.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-09T16:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364198",
    "user": "@ehaka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_364199.json:
```json
{
    "body": "Thank you for implementing this! I will have some minor tweaks, but mostly it looks like a good first step. However, we should make this into an actual `Morphism` subclass (so we can define, e.g., compositions and coercions) and we should add a hook to a finite-dimensional Lie algebra so that it is exposed to the users. It probably a good idea to subclass `LieAlgebraHomomorphism_im_gens` for this. I can do this too if you would want or on a followup.",
    "created_at": "2018-08-09T22:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364199",
    "user": "tscrim"
}
```

Thank you for implementing this! I will have some minor tweaks, but mostly it looks like a good first step. However, we should make this into an actual `Morphism` subclass (so we can define, e.g., compositions and coercions) and we should add a hook to a finite-dimensional Lie algebra so that it is exposed to the users. It probably a good idea to subclass `LieAlgebraHomomorphism_im_gens` for this. I can do this too if you would want or on a followup.



---

archive/issue_comments_364200.json:
```json
{
    "body": "Thanks for the comment, I am still figuring out the morphism framework, so this is very helpful information. By a hook I take it you mean adding a method named for example `lie_algebra_morphism` in `sage.categories.lie_algebras.LieAlgebras.FiniteDimensional`? I will add this and change `LieAlgebraMorphism_from_generators` to a subclass of `LieAlgebraHomomorphism_im_gens` as you suggested.\n\nOn another note, I noticed that the test suites skip `_test_elements`. Would it be valid to append\n\n```python\nif not issubclass(self.__class__, parent._abstract_element_class):\n    self.__class__ = parent.__make_element_class__(self.__class__)\n```\n\nat the end of initialization as in `sage.modules.with_basis.morphism.ModuleMorphism.__init__` to make the morphisms proper subclasses of the parent Hom-space, or would this cause some problems?",
    "created_at": "2018-08-10T03:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364200",
    "user": "@ehaka"
}
```

Thanks for the comment, I am still figuring out the morphism framework, so this is very helpful information. By a hook I take it you mean adding a method named for example `lie_algebra_morphism` in `sage.categories.lie_algebras.LieAlgebras.FiniteDimensional`? I will add this and change `LieAlgebraMorphism_from_generators` to a subclass of `LieAlgebraHomomorphism_im_gens` as you suggested.

On another note, I noticed that the test suites skip `_test_elements`. Would it be valid to append

```python
if not issubclass(self.__class__, parent._abstract_element_class):
    self.__class__ = parent.__make_element_class__(self.__class__)
```

at the end of initialization as in `sage.modules.with_basis.morphism.ModuleMorphism.__init__` to make the morphisms proper subclasses of the parent Hom-space, or would this cause some problems?



---

archive/issue_comments_364201.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-10T05:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364201",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364202.json:
```json
{
    "body": "I converted the function to a subclass and added the hook into `sage.categories.lie_algebras.LieAlgebras.FiniteDimensional.ParentMethods`. However, the test suite for `_test_pickling` of the new class fails since the class is creating a parent `LieAlgebraHomset`, which does not have unique behavior. I opened a new ticket #26039 about this, since it seems to be an issue unrelated to the new code.",
    "created_at": "2018-08-10T05:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364202",
    "user": "@ehaka"
}
```

I converted the function to a subclass and added the hook into `sage.categories.lie_algebras.LieAlgebras.FiniteDimensional.ParentMethods`. However, the test suite for `_test_pickling` of the new class fails since the class is creating a parent `LieAlgebraHomset`, which does not have unique behavior. I opened a new ticket #26039 about this, since it seems to be an issue unrelated to the new code.



---

archive/issue_comments_364203.json:
```json
{
    "body": "Thank you for making it into a class. I am planning to change the hook (yes, you interpreted correctly) to just `morphism` since we already know it is a Lie algebra. :)\n\nAs I mentioned on #26039, you should be using `Hom` to create the parent, not directly constructing `LieAlgebraHomset` (I know that is a stupid pitfall, but there are [annoying] reasons for it). I will be doing some reviewer modifications now, including fixing that. (Also, the morphism framework probably could use some larger scale refactoring now that we have been adding more types of morphisms, but that is my opinion and a large-scale project.)\n\nIn regards to your question about setting the `__class__`, that might work, but I would be very worried that will cause problems when the homset does not have an explicit `Element` set (because it can have many different types of elements).",
    "created_at": "2018-08-10T06:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364203",
    "user": "tscrim"
}
```

Thank you for making it into a class. I am planning to change the hook (yes, you interpreted correctly) to just `morphism` since we already know it is a Lie algebra. :)

As I mentioned on #26039, you should be using `Hom` to create the parent, not directly constructing `LieAlgebraHomset` (I know that is a stupid pitfall, but there are [annoying] reasons for it). I will be doing some reviewer modifications now, including fixing that. (Also, the morphism framework probably could use some larger scale refactoring now that we have been adding more types of morphisms, but that is my opinion and a large-scale project.)

In regards to your question about setting the `__class__`, that might work, but I would be very worried that will cause problems when the homset does not have an explicit `Element` set (because it can have many different types of elements).



---

archive/issue_comments_364204.json:
```json
{
    "body": "Okay, this fixes the pickling issue(s), as well as gives a better interface. Now you can also use the morphism on you Lie algebra elements. If my changes are good, then you can set a positive review.\n----\nNew commits:",
    "created_at": "2018-08-10T10:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364204",
    "user": "tscrim"
}
```

Okay, this fixes the pickling issue(s), as well as gives a better interface. Now you can also use the morphism on you Lie algebra elements. If my changes are good, then you can set a positive review.
----
New commits:



---

archive/issue_comments_364205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-10T13:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364205",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364206.json:
```json
{
    "body": "Looks good to me. I fixed the doctest in `finite_dimensional_lie_algebras_with_basis` to use the correct method name and the punctuation change in the error message.",
    "created_at": "2018-08-10T13:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364206",
    "user": "@ehaka"
}
```

Looks good to me. I fixed the doctest in `finite_dimensional_lie_algebras_with_basis` to use the correct method name and the punctuation change in the error message.



---

archive/issue_comments_364207.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-10T13:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364207",
    "user": "@ehaka"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_364208.json:
```json
{
    "body": "Whoops, forgot to test that file too. Thank you!",
    "created_at": "2018-08-10T22:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364208",
    "user": "tscrim"
}
```

Whoops, forgot to test that file too. Thank you!



---

archive/issue_comments_364209.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-01T09:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25799#issuecomment-364209",
    "user": "vbraun"
}
```

Resolution: fixed
