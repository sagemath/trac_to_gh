# Issue 10989: Limit case bug for conjugate_position in words

archive/issues_010989.json:
```json
{
    "body": "Assignee: slabbe\n\nCC:  abmasse\n\nAs pointed out by Alessandro De Luca on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/b6477d86e57b5e44), there is a bug in the `conjugate_position` method for finite words:\n\n\n```\nsage: w = Word([0,0,1,0,2,1])\nsage: [w.conjugate(i).conjugate_position(w) for i in range(6)]\n[0, 1, 2, 3, 4, None]\n```\n\n\nAllessandro also said:\n\n```\nThis bug has consequences on other functions in the combinatorics on\nwords package: for instance, you get\n\nsage: Word('abaa').is_conjugate_with(Word('aaba'))\nTrue\n\nsage: Word('aaba').is_conjugate_with(Word('abaa'))\nFalse \n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/11128\n\n",
    "created_at": "2011-04-05T12:16:06Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "title": "Limit case bug for conjugate_position in words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10989",
    "user": "slabbe"
}
```
Assignee: slabbe

CC:  abmasse

As pointed out by Alessandro De Luca on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/b6477d86e57b5e44), there is a bug in the `conjugate_position` method for finite words:


```
sage: w = Word([0,0,1,0,2,1])
sage: [w.conjugate(i).conjugate_position(w) for i in range(6)]
[0, 1, 2, 3, 4, None]
```


Allessandro also said:

```
This bug has consequences on other functions in the combinatorics on
words package: for instance, you get

sage: Word('abaa').is_conjugate_with(Word('aaba'))
True

sage: Word('aaba').is_conjugate_with(Word('abaa'))
False 
```



Issue created by migration from https://trac.sagemath.org/ticket/11128





---

archive/issue_comments_119185.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-05T12:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119185",
    "user": "slabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_119186.json:
```json
{
    "body": "Attachment [trac_11128_word_conjugacy-sl.patch](tarball://root/attachments/some-uuid/ticket11128/trac_11128_word_conjugacy-sl.patch) by slabbe created at 2011-04-05 12:32:54",
    "created_at": "2011-04-05T12:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119186",
    "user": "slabbe"
}
```

Attachment [trac_11128_word_conjugacy-sl.patch](tarball://root/attachments/some-uuid/ticket11128/trac_11128_word_conjugacy-sl.patch) by slabbe created at 2011-04-05 12:32:54



---

archive/issue_comments_119187.json:
```json
{
    "body": "Attachment [trac_11128-minor_docfix-abm.patch](tarball://root/attachments/some-uuid/ticket11128/trac_11128-minor_docfix-abm.patch) by abmasse created at 2011-04-05 16:10:14\n\nApply on top of the preceding patch",
    "created_at": "2011-04-05T16:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119187",
    "user": "abmasse"
}
```

Attachment [trac_11128-minor_docfix-abm.patch](tarball://root/attachments/some-uuid/ticket11128/trac_11128-minor_docfix-abm.patch) by abmasse created at 2011-04-05 16:10:14

Apply on top of the preceding patch



---

archive/issue_comments_119188.json:
```json
{
    "body": "Hi, S\u00e9bastien !\n\nI took a look at your patch and everything seems fine. All tests passed when the patch is applied on top of sage-4.6.2. However, there is a small error displayed by Sphinx when building the documentation. I fixed it in my review patch.\n\nTo me, this is a positive review as soon as S\u00e9bastien approves my first one-character patch!\n\nAlexandre",
    "created_at": "2011-04-05T16:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119188",
    "user": "abmasse"
}
```

Hi, Sébastien !

I took a look at your patch and everything seems fine. All tests passed when the patch is applied on top of sage-4.6.2. However, there is a small error displayed by Sphinx when building the documentation. I fixed it in my review patch.

To me, this is a positive review as soon as Sébastien approves my first one-character patch!

Alexandre



---

archive/issue_comments_119189.json:
```json
{
    "body": "Here is one example of speed improvement :\n\n\n```\nsage: w = Word([0..20])\nsage: z = Word([7..20] + [0..6])\n```\n\n\nBEFORE:\n\n\n```\nsage: %timeit w.is_conjugate_with(z)\n125 loops, best of 3: 2.2 ms per loop\n```\n\n\nAFTER:\n\n\n```\nsage: %timeit w.is_conjugate_with(z)\n625 loops, best of 3: 99 \u00b5s per loop\nsage: 2.2 / 0.099\n22.2222222222222\n```\n",
    "created_at": "2011-04-05T20:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119189",
    "user": "slabbe"
}
```

Here is one example of speed improvement :


```
sage: w = Word([0..20])
sage: z = Word([7..20] + [0..6])
```


BEFORE:


```
sage: %timeit w.is_conjugate_with(z)
125 loops, best of 3: 2.2 ms per loop
```


AFTER:


```
sage: %timeit w.is_conjugate_with(z)
625 loops, best of 3: 99 µs per loop
sage: 2.2 / 0.099
22.2222222222222
```




---

archive/issue_comments_119190.json:
```json
{
    "body": "Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch.\n\nS\u00e9bastien",
    "created_at": "2011-04-05T21:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119190",
    "user": "slabbe"
}
```

Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch.

Sébastien



---

archive/issue_comments_119191.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-05T21:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119191",
    "user": "slabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_119192.json:
```json
{
    "body": "Thanks again! I managed to apply your patches and rebuild Sage, it works perfectly.\n\n  Alessandro\n\nReplying to [comment:5 slabbe]:\n\n> Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch. S\u00e9bastien",
    "created_at": "2011-04-08T15:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119192",
    "user": "adeluca"
}
```

Thanks again! I managed to apply your patches and rebuild Sage, it works perfectly.

  Alessandro

Replying to [comment:5 slabbe]:

> Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch. Sébastien



---

archive/issue_comments_119193.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-13T15:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10989",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10989#issuecomment-119193",
    "user": "jdemeyer"
}
```

Resolution: fixed
