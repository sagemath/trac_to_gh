# Issue 10989: Limit case bug for conjugate_position in words

Issue created by migration from https://trac.sagemath.org/ticket/11128

Original creator: slabbe

Original creation time: 2011-04-05 12:16:06

Assignee: slabbe

CC:  abmasse

As pointed out by Alessandro De Luca on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/b6477d86e57b5e44), there is a bug in the `conjugate_position` method for finite words:


```
sage: w = Word([0,0,1,0,2,1])
sage: [w.conjugate(i).conjugate_position(w) for i in range(6)]
[0, 1, 2, 3, 4, None]
```


Allessandro also said:

```
This bug has consequences on other functions in the combinatorics on
words package: for instance, you get

sage: Word('abaa').is_conjugate_with(Word('aaba'))
True

sage: Word('aaba').is_conjugate_with(Word('abaa'))
False 
```




---

Comment by slabbe created at 2011-04-05 12:32:54

Changing status from new to needs_review.


---

Attachment


---

Attachment

Apply on top of the preceding patch


---

Comment by abmasse created at 2011-04-05 16:12:49

Hi, Sébastien !

I took a look at your patch and everything seems fine. All tests passed when the patch is applied on top of sage-4.6.2. However, there is a small error displayed by Sphinx when building the documentation. I fixed it in my review patch.

To me, this is a positive review as soon as Sébastien approves my first one-character patch!

Alexandre


---

Comment by slabbe created at 2011-04-05 20:58:30

Here is one example of speed improvement :


```
sage: w = Word([0..20])
sage: z = Word([7..20] + [0..6])
```


BEFORE:


```
sage: %timeit w.is_conjugate_with(z)
125 loops, best of 3: 2.2 ms per loop
```


AFTER:


```
sage: %timeit w.is_conjugate_with(z)
625 loops, best of 3: 99 µs per loop
sage: 2.2 / 0.099
22.2222222222222
```



---

Comment by slabbe created at 2011-04-05 21:38:07

Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch.

Sébastien


---

Comment by slabbe created at 2011-04-05 21:38:07

Changing status from needs_review to positive_review.


---

Comment by adeluca created at 2011-04-08 15:05:35

Thanks again! I managed to apply your patches and rebuild Sage, it works perfectly.

  Alessandro

Replying to [comment:5 slabbe]:

> Thanks for the review and the doc fix. I checked, and I get no warning now during the documentation build after applying your patch. Sébastien


---

Comment by jdemeyer created at 2011-04-13 15:18:05

Resolution: fixed
