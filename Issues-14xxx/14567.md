# Issue 14567: Refactor continued fractions

archive/issues_014363.json:
```json
{
    "body": "Continued fractions (in sage.rings.contfrac) do not do what we expect:\n\n1. categories are not properly initialized nor used.\n2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n3. it only deals with rational numbers\n4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n5. there is no bridge with quadratic numbers (see also #11345)\n6. there is no bridge with words (sage.combinat.words)\n7. continued fractions are not included in the documentation\n\nThe patch proposed here develop some general design for dealing with continued fractions and solve all issues above.\n\nWith the patch applied we can do\n\n```\nsage: (117/253).continued_fraction()\n[0; 2, 6, 6, 3]\n\nsage: K.<sqrt2> = QuadraticField(2)\nsage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\nsage: cff.period()\n(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)\nsage: cff.preperiod()\n(0, 1)\nsage: cff.value()\n1/3*sqrt2 + 1/4\nsage: cff.n(digits=50)\n0.72140452079103168293389624140323269285655729179232\n\nsage: cf_pi = continued_fraction(pi)\n[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\nsage: cf_pi.quotient(1500)\n1\n\nsage: cf_fib = continued_fraction(words.FibonacciWord([1,2]))\nsage: cf_fib\n[1; 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2...]\nsage: cf_fib.n(digits=42)\n1.38795458796714233691931385987318547787815\n```\nIn particular we solve the question in #11345.\n\nAssignee: @videlec\n\nCC:  tmonteil @seblabbe fougeroc\n\nKeywords: continued fractions, numerical approximation\n\nReviewer: Ralf Stephan, Thierry Monteil\n\nAuthor: Vincent Delecroix\n\nBranch: ec4a4baa149a9b9e74dc32d25745b81059af2e6b\n\nDependencies: #13213, #13256, #14563\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14567\n\n",
    "closed_at": "2015-01-29T22:41:54Z",
    "created_at": "2013-05-11T15:09:00Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Refactor continued fractions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14567",
    "user": "https://github.com/videlec"
}
```
Continued fractions (in sage.rings.contfrac) do not do what we expect:

1. categories are not properly initialized nor used.
2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
3. it only deals with rational numbers
4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
5. there is no bridge with quadratic numbers (see also #11345)
6. there is no bridge with words (sage.combinat.words)
7. continued fractions are not included in the documentation

The patch proposed here develop some general design for dealing with continued fractions and solve all issues above.

With the patch applied we can do

```
sage: (117/253).continued_fraction()
[0; 2, 6, 6, 3]

sage: K.<sqrt2> = QuadraticField(2)
sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
sage: cff.period()
(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)
sage: cff.preperiod()
(0, 1)
sage: cff.value()
1/3*sqrt2 + 1/4
sage: cff.n(digits=50)
0.72140452079103168293389624140323269285655729179232

sage: cf_pi = continued_fraction(pi)
[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
sage: cf_pi.quotient(1500)
1

sage: cf_fib = continued_fraction(words.FibonacciWord([1,2]))
sage: cf_fib
[1; 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2...]
sage: cf_fib.n(digits=42)
1.38795458796714233691931385987318547787815
```
In particular we solve the question in #11345.

Assignee: @videlec

CC:  tmonteil @seblabbe fougeroc

Keywords: continued fractions, numerical approximation

Reviewer: Ralf Stephan, Thierry Monteil

Author: Vincent Delecroix

Branch: ec4a4baa149a9b9e74dc32d25745b81059af2e6b

Dependencies: #13213, #13256, #14563

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14567





---

archive/issue_comments_193365.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,14 +1,12 @@\n-Continued fractions (in sage.rings.contfrac) does not what we expect:\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n * it only deals with rational numbers\n * there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n * there is no bridge with words (sage.combinat.words)\n+* there is no bridge with quadratic numbers (see also #11345)\n \n Moreover, categories are not properly initialized nor used.\n \n-The patch proposed here improves the current version.\n-\n-Related tickets:\n-* #11345\n+The patch proposed here improves the current version by addressing the four issues above.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-11T15:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193365",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,14 +1,12 @@
-Continued fractions (in sage.rings.contfrac) does not what we expect:
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 * it only deals with rational numbers
 * there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
 * there is no bridge with words (sage.combinat.words)
+* there is no bridge with quadratic numbers (see also #11345)
 
 Moreover, categories are not properly initialized nor used.
 
-The patch proposed here improves the current version.
-
-Related tickets:
-* #11345
+The patch proposed here improves the current version by addressing the four issues above.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193366.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,21 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+0. categories are not properly initialized nor used.\n+1. it only deals with rational numbers\n+2. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+4. there is no bridge with quadratic numbers (see also #11345)\n+3. there is no bridge with words (sage.combinat.words)\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 0, 1 and 4 (and I hope 2); see the discussion below.\n+\n+```\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-12T18:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193366",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,21 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+0. categories are not properly initialized nor used.
+1. it only deals with rational numbers
+2. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+4. there is no bridge with quadratic numbers (see also #11345)
+3. there is no bridge with words (sage.combinat.words)
+
+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 0, 1 and 4 (and I hope 2); see the discussion below.
+
+```
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.value()
+1/3*sqrt2 + 1/4
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193367.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-05-12T18:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193367",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_193368.json:
```json
{
    "body": "<a id='comment:2'></a>The ticket is not yet finished but the review may start (all test pass on my computer... waiting for patchbot). Here are some questions I am not sure how to deal about.\n* How to cleanly implement numerical approximations of continued fractions (see the current (stupid) implementation of `_mpfr_` in sage.rings.continued_fraction_element`) ?\n* What method name do we choose for conversion to continued fractions ? (ZZ has `_integer_`, QQ has `_rational_` and RR has `_mpfr_`, ...). For now it is simply `continued_fraction` as the user may prefer `my_number.continued_fraction()` to `CFF(my_number)`.\n* The link with words is not yet done and perhaps should be delayed to another ticket as the patch is yet 2500 lines long.\n* some of the stuff about continued fractions in `sage.rings.arith` should move to `sage.rings.continued_fraction_field` (I think I do prefer `sage.rings.continued_fractions` to `sage.rings.continued_fraction_field`...).\n* I did not check what are the Pari's fonctionnalities that may be used here",
    "created_at": "2013-05-12T18:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193368",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>The ticket is not yet finished but the review may start (all test pass on my computer... waiting for patchbot). Here are some questions I am not sure how to deal about.
* How to cleanly implement numerical approximations of continued fractions (see the current (stupid) implementation of `_mpfr_` in sage.rings.continued_fraction_element`) ?
* What method name do we choose for conversion to continued fractions ? (ZZ has `_integer_`, QQ has `_rational_` and RR has `_mpfr_`, ...). For now it is simply `continued_fraction` as the user may prefer `my_number.continued_fraction()` to `CFF(my_number)`.
* The link with words is not yet done and perhaps should be delayed to another ticket as the patch is yet 2500 lines long.
* some of the stuff about continued fractions in `sage.rings.arith` should move to `sage.rings.continued_fraction_field` (I think I do prefer `sage.rings.continued_fractions` to `sage.rings.continued_fraction_field`...).
* I did not check what are the Pari's fonctionnalities that may be used here



---

archive/issue_comments_193369.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,21 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. it only deals with rational numbers\n+3. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+4. there is no bridge with quadratic numbers (see also #11345)\n+5. there is no bridge with words (sage.combinat.words)\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 1, 2 and 5 (and I hope 3); see the discussion below.\n+\n+```\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-12T18:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193369",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,21 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. it only deals with rational numbers
+3. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+4. there is no bridge with quadratic numbers (see also #11345)
+5. there is no bridge with words (sage.combinat.words)
+
+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 1, 2 and 5 (and I hope 3); see the discussion below.
+
+```
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.value()
+1/3*sqrt2 + 1/4
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193370.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n+3. it only deals with rational numbers\n+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+5. there is no bridge with quadratic numbers (see also #11345)\n+6. there is no bridge with words (sage.combinat.words)\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 1, 2, 3 and 5 (and I hope 4); see the discussion below.\n+\n+With the patch applied we can do\n+\n+```\n+sage: (117/253).continued_fraction()\n+[0; 2, 6, 6, 3]\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-12T18:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193370",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
+3. it only deals with rational numbers
+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+5. there is no bridge with quadratic numbers (see also #11345)
+6. there is no bridge with words (sage.combinat.words)
+
+The patch proposed here develop some general design for dealing with continued fractions and solves the issues 1, 2, 3 and 5 (and I hope 4); see the discussion below.
+
+With the patch applied we can do
+
+```
+sage: (117/253).continued_fraction()
+[0; 2, 6, 6, 3]
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.value()
+1/3*sqrt2 + 1/4
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193371.json:
```json
{
    "body": "<a id='comment:5'></a>The last patch still does not implement a proper function to compute numerical approximations. It would be interesting to add one...",
    "created_at": "2013-05-18T12:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193371",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>The last patch still does not implement a proper function to compute numerical approximations. It would be interesting to add one...



---

archive/issue_comments_193372.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,36 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n+3. it only deals with rational numbers\n+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+5. there is no bridge with quadratic numbers (see also #11345)\n+6. there is no bridge with words (sage.combinat.words)\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 4 and 6; see the discussion below.\n+\n+With the patch applied we can do\n+\n+```\n+sage: (117/253).continued_fraction()\n+[0; 2, 6, 6, 3]\n+\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.period()\n+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)\n+sage: cff.preperiod()\n+(0, 1)\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+\n+sage: cf_pi = continued_fraction(pi)\n+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\n+sage: cf_pi.quotient(1500)\n+1\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-18T12:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193372",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,36 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
+3. it only deals with rational numbers
+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+5. there is no bridge with quadratic numbers (see also #11345)
+6. there is no bridge with words (sage.combinat.words)
+
+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 4 and 6; see the discussion below.
+
+With the patch applied we can do
+
+```
+sage: (117/253).continued_fraction()
+[0; 2, 6, 6, 3]
+
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.period()
+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)
+sage: cff.preperiod()
+(0, 1)
+sage: cff.value()
+1/3*sqrt2 + 1/4
+
+sage: cf_pi = continued_fraction(pi)
+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
+sage: cf_pi.quotient(1500)
+1
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193373.json:
```json
{
    "body": "<a id='comment:7'></a>The patch modifies the output of continued_fraction and hence some tests in `sage.books.book_stein_ent`. We have to be careful with changes that concern examples from a book. See the related discussion on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/5bb7d4cf3075934e#)",
    "created_at": "2013-05-18T13:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193373",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>The patch modifies the output of continued_fraction and hence some tests in `sage.books.book_stein_ent`. We have to be careful with changes that concern examples from a book. See the related discussion on [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/5bb7d4cf3075934e#)



---

archive/issue_comments_193374.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,39 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n+3. it only deals with rational numbers\n+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+5. there is no bridge with quadratic numbers (see also #11345)\n+6. there is no bridge with words (sage.combinat.words)\n+7. continued fractions are not included in the documentation\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 6.\n+\n+With the patch applied we can do\n+\n+```\n+sage: (117/253).continued_fraction()\n+[0; 2, 6, 6, 3]\n+\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.period()\n+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)\n+sage: cff.preperiod()\n+(0, 1)\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+sage: cff.n(digits=50)\n+0.72140452079103168293389624140323269285655729179232\n+\n+sage: cf_pi = continued_fraction(pi)\n+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\n+sage: cf_pi.quotient(1500)\n+1\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-05-19T17:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193374",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,39 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
+3. it only deals with rational numbers
+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+5. there is no bridge with quadratic numbers (see also #11345)
+6. there is no bridge with words (sage.combinat.words)
+7. continued fractions are not included in the documentation
+
+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 6.
+
+With the patch applied we can do
+
+```
+sage: (117/253).continued_fraction()
+[0; 2, 6, 6, 3]
+
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.period()
+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)
+sage: cff.preperiod()
+(0, 1)
+sage: cff.value()
+1/3*sqrt2 + 1/4
+sage: cff.n(digits=50)
+0.72140452079103168293389624140323269285655729179232
+
+sage: cf_pi = continued_fraction(pi)
+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
+sage: cf_pi.quotient(1500)
+1
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193375.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-05-24T11:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193375",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193376.json:
```json
{
    "body": "<a id='comment:9'></a>instead of\n\n```\ndoctest:2057: UserWarning\n```\nyou should use\n\n```\ndoctest:...: UserWarning\n```\nbecause the numbers can change\n\nThere are some other doctests failing due to the change of output string, please correct them",
    "created_at": "2013-05-24T11:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193376",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>instead of

```
doctest:2057: UserWarning
```
you should use

```
doctest:...: UserWarning
```
because the numbers can change

There are some other doctests failing due to the change of output string, please correct them



---

archive/issue_comments_193377.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 chapoton]:\n> instead of\n> \n> ```\n> doctest:2057: UserWarning\n> ```\n> you should use\n> \n> ```\n> doctest:...: UserWarning\n> ```\n> because the numbers can change\n\n\nMany thanks for that suggestion (it actually happens for me several times).\n\n> There are some other doctests failing due to the change of output string, please correct them\n\n\nThe ticket is updated.",
    "created_at": "2013-05-25T10:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193377",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>Replying to [comment:9 chapoton]:
> instead of
> 
> ```
> doctest:2057: UserWarning
> ```
> you should use
> 
> ```
> doctest:...: UserWarning
> ```
> because the numbers can change


Many thanks for that suggestion (it actually happens for me several times).

> There are some other doctests failing due to the change of output string, please correct them


The ticket is updated.



---

archive/issue_comments_193378.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-05-25T10:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193378",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193379.json:
```json
{
    "body": "<a id='comment:12'></a>A doctest still fails.",
    "created_at": "2013-05-25T11:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193379",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>A doctest still fails.



---

archive/issue_comments_193380.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-05-25T11:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193380",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193381.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-05-25T11:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193381",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193382.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,43 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n+3. it only deals with rational numbers\n+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+5. there is no bridge with quadratic numbers (see also #11345)\n+6. there is no bridge with words (sage.combinat.words)\n+7. continued fractions are not included in the documentation\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 6.\n+\n+With the patch applied we can do\n+\n+```\n+sage: (117/253).continued_fraction()\n+[0; 2, 6, 6, 3]\n+\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.period()\n+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)\n+sage: cff.preperiod()\n+(0, 1)\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+sage: cff.n(digits=50)\n+0.72140452079103168293389624140323269285655729179232\n+\n+sage: cf_pi = continued_fraction(pi)\n+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\n+sage: cf_pi.quotient(1500)\n+1\n+```\n+In particular we solve the question in #11345.\n+\n+Apply:\n+* [attachment:trac_14567-continued_fractions.patch]\n+* [attachment:trac_14567_addon1-fc.patch]\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2013-06-03T19:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193382",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,43 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
+3. it only deals with rational numbers
+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+5. there is no bridge with quadratic numbers (see also #11345)
+6. there is no bridge with words (sage.combinat.words)
+7. continued fractions are not included in the documentation
+
+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above except 6.
+
+With the patch applied we can do
+
+```
+sage: (117/253).continued_fraction()
+[0; 2, 6, 6, 3]
+
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.period()
+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)
+sage: cff.preperiod()
+(0, 1)
+sage: cff.value()
+1/3*sqrt2 + 1/4
+sage: cff.n(digits=50)
+0.72140452079103168293389624140323269285655729179232
+
+sage: cf_pi = continued_fraction(pi)
+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
+sage: cf_pi.quotient(1500)
+1
+```
+In particular we solve the question in #11345.
+
+Apply:
+* [attachment:trac_14567-continued_fractions.patch]
+* [attachment:trac_14567_addon1-fc.patch]
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193383.json:
```json
{
    "body": "<a id='comment:14'></a>I have added a small clean-up patch (problems found with pyflakes):\n\n* removed unused import \n* removed unused variables\n* corrected one wrong variable",
    "created_at": "2013-06-03T19:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193383",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>I have added a small clean-up patch (problems found with pyflakes):

* removed unused import 
* removed unused variables
* corrected one wrong variable



---

archive/issue_comments_193384.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 chapoton]:\n> I have added a small clean-up patch (problems found with pyflakes):\n> \n> * removed unused import \n> * removed unused variables\n> * corrected one wrong variable\n\n\nThanks. I am now confident that the patch is perfect!",
    "created_at": "2013-06-03T19:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193384",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Replying to [comment:14 chapoton]:
> I have added a small clean-up patch (problems found with pyflakes):
> 
> * removed unused import 
> * removed unused variables
> * corrected one wrong variable


Thanks. I am now confident that the patch is perfect!



---

archive/issue_comments_193385.json:
```json
{
    "body": "<a id='comment:16'></a>Attachment [trac_14567_addon1-fc.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567_addon1-fc.patch) by @seblabbe created at 2013-07-03 13:36:26",
    "created_at": "2013-07-03T13:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193385",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:16'></a>Attachment [trac_14567_addon1-fc.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567_addon1-fc.patch) by @seblabbe created at 2013-07-03 13:36:26



---

archive/issue_events_041491.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41491"
}
```



---

archive/issue_comments_193386.json:
```json
{
    "body": "<a id='comment:18'></a>What is the status of this patch? I need it for a server that I am running for others. It applies cleanly to only sage-5.9 and sage-5.10. :(\n\nCan you rebase it to 5.12 or 5.13? The size of the hunk that fails (in `continued_fractions.py`) is too large, and so I do not want to mess up in modifying the code.",
    "created_at": "2013-12-16T09:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193386",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:18'></a>What is the status of this patch? I need it for a server that I am running for others. It applies cleanly to only sage-5.9 and sage-5.10. :(

Can you rebase it to 5.12 or 5.13? The size of the hunk that fails (in `continued_fractions.py`) is too large, and so I do not want to mess up in modifying the code.



---

archive/issue_comments_193387.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 ppurka]:\n> What is the status of this patch? I need it for a server that I am running for others. It applies cleanly to only sage-5.9 and sage-5.10. :(\n> \n> Can you rebase it to 5.12 or 5.13? The size of the hunk that fails (in `continued_fractions.py`) is too large, and so I do not want to mess up in modifying the code.\n\n\nHi. I am waiting for the review. I know that Thierry has many remarks (we already discussed some in private) but I can do a rebase in order that it applies on 5.13 tomorrow during the Sage day in Paris. Do you need a patch or git branch is fine for you ?",
    "created_at": "2013-12-16T21:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193387",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>Replying to [comment:18 ppurka]:
> What is the status of this patch? I need it for a server that I am running for others. It applies cleanly to only sage-5.9 and sage-5.10. :(
> 
> Can you rebase it to 5.12 or 5.13? The size of the hunk that fails (in `continued_fractions.py`) is too large, and so I do not want to mess up in modifying the code.


Hi. I am waiting for the review. I know that Thierry has many remarks (we already discussed some in private) but I can do a rebase in order that it applies on 5.13 tomorrow during the Sage day in Paris. Do you need a patch or git branch is fine for you ?



---

archive/issue_comments_193388.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 vdelecroix]:\n> Hi. I am waiting for the review. I know that Thierry has many remarks (we already discussed some in private) but I can do a rebase in order that it applies on 5.13 tomorrow during the Sage day in Paris. Do you need a patch or git branch is fine for you ?\n\n\nThanks! Either patch or git branch is fine with me. I can recreate a patch from the git branch, if needed.",
    "created_at": "2013-12-16T22:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193388",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:20'></a>Replying to [comment:19 vdelecroix]:
> Hi. I am waiting for the review. I know that Thierry has many remarks (we already discussed some in private) but I can do a rebase in order that it applies on 5.13 tomorrow during the Sage day in Paris. Do you need a patch or git branch is fine for you ?


Thanks! Either patch or git branch is fine with me. I can recreate a patch from the git branch, if needed.



---

archive/issue_comments_193389.json:
```json
{
    "body": "<a id='comment:21'></a>Attachment [trac_14567-continued_fractions.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567-continued_fractions.patch) by @videlec created at 2013-12-17 14:00:57\n\nI uploaded a patch which applies on 5.12.rc0. I will now create a branch.",
    "created_at": "2013-12-17T14:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193389",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>Attachment [trac_14567-continued_fractions.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567-continued_fractions.patch) by @videlec created at 2013-12-17 14:00:57

I uploaded a patch which applies on 5.12.rc0. I will now create a branch.



---

archive/issue_comments_193390.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:21 vdelecroix]:\n> I uploaded a patch which applies on 5.12.rc0. I will now create a branch.\n\nThanks! Strangely, it applies to 5.13.beta3, but not to 6.0 (git branch).",
    "created_at": "2013-12-18T13:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193390",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:22'></a>Replying to [comment:21 vdelecroix]:
> I uploaded a patch which applies on 5.12.rc0. I will now create a branch.

Thanks! Strangely, it applies to 5.13.beta3, but not to 6.0 (git branch).



---

archive/issue_events_041492.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41492"
}
```



---

archive/issue_events_041493.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41493"
}
```



---

archive/issue_comments_193391.json:
```json
{
    "body": "<a id='comment:24'></a>You have to use `patch` with the `-l` option, then it succeeds. I can open a git branch if this doesn't work for you.",
    "created_at": "2014-02-12T09:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193391",
    "user": "https://github.com/rwst"
}
```

<a id='comment:24'></a>You have to use `patch` with the `-l` option, then it succeeds. I can open a git branch if this doesn't work for you.



---

archive/issue_comments_193392.json:
```json
{
    "body": "<a id='comment:26'></a>Rebased on 6.2.beta2, tests fine. The docs do not build, however, because of a dangling ref in database_sloane.\n\n---\nNew commits:",
    "created_at": "2014-02-19T16:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193392",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>Rebased on 6.2.beta2, tests fine. The docs do not build, however, because of a dangling ref in database_sloane.

---
New commits:



---

archive/issue_comments_193393.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-19T17:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193394.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-02-20T09:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193394",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_193395.json:
```json
{
    "body": "<a id='comment:28'></a>I like the result a lot with its modular structure. One even can create a CFF given the preperiod and the periodic part, they need to be at least pairs however. But this should not hold back this ticket, because there is an easy workaround.",
    "created_at": "2014-02-20T09:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193395",
    "user": "https://github.com/rwst"
}
```

<a id='comment:28'></a>I like the result a lot with its modular structure. One even can create a CFF given the preperiod and the periodic part, they need to be at least pairs however. But this should not hold back this ticket, because there is an easy workaround.



---

archive/issue_comments_193396.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-02-20T17:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193396",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_193397.json:
```json
{
    "body": "<a id='comment:29'></a>Ralf, commit 7e0af96 is the wrong way to do fix it (take a look at the compiled documentation). Instead you should have removed the second colon from the `EXAMPLES::`. In other words, it should be formatted like this:\n\n```\nEXAMPLES:\n\nSome docstring talking about the example::\n\n    sage: 2 + 2\n    4\n\nSome more docstrings::\n\n    sage: 4 - 2\n    2\n```\n\nThierry (or Vincent), did you have any comments about the current state of the branch?",
    "created_at": "2014-02-20T17:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193397",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'></a>Ralf, commit 7e0af96 is the wrong way to do fix it (take a look at the compiled documentation). Instead you should have removed the second colon from the `EXAMPLES::`. In other words, it should be formatted like this:

```
EXAMPLES:

Some docstring talking about the example::

    sage: 2 + 2
    4

Some more docstrings::

    sage: 4 - 2
    2
```

Thierry (or Vincent), did you have any comments about the current state of the branch?



---

archive/issue_comments_193398.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-21T08:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193399.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-02-21T08:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193399",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193400.json:
```json
{
    "body": "<a id='comment:32'></a>Hi, sorry for not talking on this before. I started to review this patch a few months ago but did not finished. There are a lot of issues with CFF. I did not switch to the new layout now, so, if the code did not change too much, my comments should be still valid, I will post a few of them this week end. Again, sorry for the delay.",
    "created_at": "2014-02-21T17:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193400",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:32'></a>Hi, sorry for not talking on this before. I started to review this patch a few months ago but did not finished. There are a lot of issues with CFF. I did not switch to the new layout now, so, if the code did not change too much, my comments should be still valid, I will post a few of them this week end. Again, sorry for the delay.



---

archive/issue_comments_193401.json:
```json
{
    "body": "Attachment [trac_14567_rewiew-tm.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567_rewiew-tm.patch) by tmonteil created at 2014-03-02 19:50:33",
    "created_at": "2014-03-02T19:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193401",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Attachment [trac_14567_rewiew-tm.patch](tarball://root/attachments/some-uuid/ticket14567/trac_14567_rewiew-tm.patch) by tmonteil created at 2014-03-02 19:50:33



---

archive/issue_comments_193402.json:
```json
{
    "body": "<a id='comment:33'></a>This review is not polished, but i provide it as is, so that we can discuss. I also uploaded a (beginning of a) patch containing minor modifications, even if this corresponds to the old workflow.\n\n---\n\n`CFF` is not fully autonomous and behaves like an overlay over other Sage\nfields, thus sacrificing reliability over expressivity.\n\n```\nsage: a = CFF(0.1)\nsage: a.value()\n1/10\n```\nvs\n\n```\nsage: a = CFF(0.1+sqrt(2))\nsage: a.value()\nsqrt(2) + 0.100000000000000\n```\n\nHence the mess:\n\n```\nsage: a = CFF(0.1+sqrt(2))       \nsage: b = CFF(0.1) + CFF(sqrt(2))\nsage: a == b\nTrue\n```\nbut\n\n```\nsage: a\n[1; 1, 1, 17, 11, 3, 1, 8, 2, 1, 2, 2, 281, 1, 10, 3, 2, 3, 21, 5, ...]\nsage: b\n[1; (1, 1, 17, 11, 3, 1, 8, 2, 1, 2, 2, 282, 2, 2, 1, 2, 8, 1, 3, 11, 17, 1, 1, 2, 3, 5, 2, 10, 1, 5, 1, 69, 1, 5, 1, 10, 2, 5, 3, 2)*]\n```\n\n\nI have not much problems with this overlay design as long as it is clearly\nstated and consistent.\n\nNote that this behaviour is not uniform, since `CFF(a).value()` is sometimes not\nequal to `a`, but this is not clear when.\n\n```\n- << Return the value of \"self\" (the number from which it was built). >>\n\n- << Return the value of \"self\" as a quadratic number (with square free\n  discriminant). >>\n```\n\nThis is not the role of `CFF` to canonicalize Sage real numbers, though one\ncould imagine such a class/function `GoodRealField`.\n\n```\nsage: CFF(sqrt(2))\n[1; (2)*]\nsage: CFF(sqrt(2)).value()\nsqrt2\n\nsage: CFF(0.1)\n[0; 10]\nsage: CFF(0.1).value()\n1/10\n\nsage: CFF(pi)\n[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\nsage: CFF(pi).value()\npi\n\nsage: (2^(1/3)).parent()           \nSymbolic Ring\nsage: CFF(2^(1/3)).value().parent()\nAlgebraic Real Field\n```\n\n\nAnother consequence of the overlay structure is that the inverse of a\ncontinued fraction is not as expected (the inverse should only shift the\nsequence of partial quotients):\n\n```\nsage: a = CFF(pi+0.1) ; a\n[3; 4, 7, 5, 2, 3, 2, 1, 1, 1, 4, 1, 4, 33, 4, 2, 6, 10, 3, 1, ...]\nsage: ~a\n[0; 3, 4, 7, 5, 2, 3, 2, 1, 1, 1, 4, 1, 4, 33, 4, 4, 1, 1, 1, ...]\n```\n\n\nI do understand that this may be a transitional behaviour. But how to tell\nthat to sage users ?\n\nI see two ways:\n\n- be always an \"overlay field\"\n- restrict the code to words (cf your issue 6) you really handle (rationals\n  and quadratic irrationals, corresponding to finite and ultimately periodic\n  words) ?\n \nPerhaps a solution is to have two very distinct classes (with conversions) ?\n\n---\n\nAnother issue is:\n\n```\nsage: CFF.is_exact()\nTrue\n```\n\nI disagree with that statement, since there are approximate elements in CFF,\nfor example `CFF(pi+0.1)`.\n\n\n---\n\n\nProblems with `SR`:\n\n```\nsage: sqrt(2) == QQbar(sqrt(2))          \nTrue\n\nsage: CFF(sqrt(2)) == CFF(QQbar(sqrt(2)))\nWait for a long time...\n\nsage: CFF(sqrt(2)).value().parent()\nNumber Field in sqrt2 with defining polynomial x^2 - 2\n\nsage: CFF(sqrt(2)).value() == CFF(QQbar(sqrt(2))).value()\nFalse\n```\n\n\nTransitivity of equality:\n\n```\nsage: bool(CFF(sqrt(2)).value() == sqrt(2))\nTrue\n\nsage: bool(sqrt(2)) == sqrt(QQbar(2)) \nTrue\n\nsage: CFF(sqrt(2)).value() == sqrt(QQbar(2))\nFalse\n```\n\n\n\n---\n\nin `_element_constructor_()`\n\n```\n - ``nterms`` -- integer (optional)\n\n??? is that an old remaining thing ?\n\n - ``check`` -- boolean (optional) -- whether or not we check the\n\n\"the\" what ?\n```\n\n---\n\nWhen you test whether an element of `SR` is a real number, you use `RIF(x)`.\nWhy not using `x.is_real()` (and make this method more reliable if needed) ?\n\n---\n\nAnother problem:\n\n```\nsage: a = RDF(0.1)\nsage: CFF(a)\n[0]\n```\n\nThe reason is :\n\n```\nsage: (1/RIF(RDF(0.1))).unique_floor()\nValueError: interval does not have a unique floor\n```\n\n---\n\n\nIn the doc: \"It is quite remarkable that\".\n\nAdd : \"- any real number admits a unique continued fraction expansion\"\n\n---\n\n\"It is also possible to create a continued fraction from a list of digits::\"\n\nI would propose : \"from a list of numbers corresponding to its partial\nquotients.\"\n \n\n\"For quadratic numbers, the syntax is quite similar and the digits are\nrepresented as a pair of tuples, the preperiod and the period::\"\n\nAgain, \"digits\" vs \"partial quotients\"\n\n---\n\nAnother problem: \n\n```\nsage: cf = CFF([(1,2,3),(1,2,4)]); cf.value()         \n-1/86*sqrt229 + 139/86\n\nsage: sqrt229\n....\nNameError: name 'sqrt229' is not defined\n```\n\n\n`CFF` outputs an element of a quadratic field that can not be used\nfurthermore.  Of course, one can get it back with `cf.parent().gen()`. Perhaps\ninject those variables ?\n\n---\n\n\"two_last_convergents\" -> \"last_two_convergents\"\n\n---\n\n`_pn` and `_qn` looks good for internal variables, but i would suggest to\nreplace `pn()` and `qn()` methods by `numerator()` and `denominator()` to stay\nconsistent with rationals.\n\n---\n\nIn the `_mpfr_` method: \"It is guaranteed that the result is exact\"\n\nFloating point number are not exact, perhaps \"accurate\" is a better word ?",
    "created_at": "2014-03-02T19:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193402",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:33'></a>This review is not polished, but i provide it as is, so that we can discuss. I also uploaded a (beginning of a) patch containing minor modifications, even if this corresponds to the old workflow.

---

`CFF` is not fully autonomous and behaves like an overlay over other Sage
fields, thus sacrificing reliability over expressivity.

```
sage: a = CFF(0.1)
sage: a.value()
1/10
```
vs

```
sage: a = CFF(0.1+sqrt(2))
sage: a.value()
sqrt(2) + 0.100000000000000
```

Hence the mess:

```
sage: a = CFF(0.1+sqrt(2))       
sage: b = CFF(0.1) + CFF(sqrt(2))
sage: a == b
True
```
but

```
sage: a
[1; 1, 1, 17, 11, 3, 1, 8, 2, 1, 2, 2, 281, 1, 10, 3, 2, 3, 21, 5, ...]
sage: b
[1; (1, 1, 17, 11, 3, 1, 8, 2, 1, 2, 2, 282, 2, 2, 1, 2, 8, 1, 3, 11, 17, 1, 1, 2, 3, 5, 2, 10, 1, 5, 1, 69, 1, 5, 1, 10, 2, 5, 3, 2)*]
```


I have not much problems with this overlay design as long as it is clearly
stated and consistent.

Note that this behaviour is not uniform, since `CFF(a).value()` is sometimes not
equal to `a`, but this is not clear when.

```
- << Return the value of "self" (the number from which it was built). >>

- << Return the value of "self" as a quadratic number (with square free
  discriminant). >>
```

This is not the role of `CFF` to canonicalize Sage real numbers, though one
could imagine such a class/function `GoodRealField`.

```
sage: CFF(sqrt(2))
[1; (2)*]
sage: CFF(sqrt(2)).value()
sqrt2

sage: CFF(0.1)
[0; 10]
sage: CFF(0.1).value()
1/10

sage: CFF(pi)
[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
sage: CFF(pi).value()
pi

sage: (2^(1/3)).parent()           
Symbolic Ring
sage: CFF(2^(1/3)).value().parent()
Algebraic Real Field
```


Another consequence of the overlay structure is that the inverse of a
continued fraction is not as expected (the inverse should only shift the
sequence of partial quotients):

```
sage: a = CFF(pi+0.1) ; a
[3; 4, 7, 5, 2, 3, 2, 1, 1, 1, 4, 1, 4, 33, 4, 2, 6, 10, 3, 1, ...]
sage: ~a
[0; 3, 4, 7, 5, 2, 3, 2, 1, 1, 1, 4, 1, 4, 33, 4, 4, 1, 1, 1, ...]
```


I do understand that this may be a transitional behaviour. But how to tell
that to sage users ?

I see two ways:

- be always an "overlay field"
- restrict the code to words (cf your issue 6) you really handle (rationals
  and quadratic irrationals, corresponding to finite and ultimately periodic
  words) ?
 
Perhaps a solution is to have two very distinct classes (with conversions) ?

---

Another issue is:

```
sage: CFF.is_exact()
True
```

I disagree with that statement, since there are approximate elements in CFF,
for example `CFF(pi+0.1)`.


---


Problems with `SR`:

```
sage: sqrt(2) == QQbar(sqrt(2))          
True

sage: CFF(sqrt(2)) == CFF(QQbar(sqrt(2)))
Wait for a long time...

sage: CFF(sqrt(2)).value().parent()
Number Field in sqrt2 with defining polynomial x^2 - 2

sage: CFF(sqrt(2)).value() == CFF(QQbar(sqrt(2))).value()
False
```


Transitivity of equality:

```
sage: bool(CFF(sqrt(2)).value() == sqrt(2))
True

sage: bool(sqrt(2)) == sqrt(QQbar(2)) 
True

sage: CFF(sqrt(2)).value() == sqrt(QQbar(2))
False
```



---

in `_element_constructor_()`

```
 - ``nterms`` -- integer (optional)

??? is that an old remaining thing ?

 - ``check`` -- boolean (optional) -- whether or not we check the

"the" what ?
```

---

When you test whether an element of `SR` is a real number, you use `RIF(x)`.
Why not using `x.is_real()` (and make this method more reliable if needed) ?

---

Another problem:

```
sage: a = RDF(0.1)
sage: CFF(a)
[0]
```

The reason is :

```
sage: (1/RIF(RDF(0.1))).unique_floor()
ValueError: interval does not have a unique floor
```

---


In the doc: "It is quite remarkable that".

Add : "- any real number admits a unique continued fraction expansion"

---

"It is also possible to create a continued fraction from a list of digits::"

I would propose : "from a list of numbers corresponding to its partial
quotients."
 

"For quadratic numbers, the syntax is quite similar and the digits are
represented as a pair of tuples, the preperiod and the period::"

Again, "digits" vs "partial quotients"

---

Another problem: 

```
sage: cf = CFF([(1,2,3),(1,2,4)]); cf.value()         
-1/86*sqrt229 + 139/86

sage: sqrt229
....
NameError: name 'sqrt229' is not defined
```


`CFF` outputs an element of a quadratic field that can not be used
furthermore.  Of course, one can get it back with `cf.parent().gen()`. Perhaps
inject those variables ?

---

"two_last_convergents" -> "last_two_convergents"

---

`_pn` and `_qn` looks good for internal variables, but i would suggest to
replace `pn()` and `qn()` methods by `numerator()` and `denominator()` to stay
consistent with rationals.

---

In the `_mpfr_` method: "It is guaranteed that the result is exact"

Floating point number are not exact, perhaps "accurate" is a better word ?



---

archive/issue_comments_193403.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-03-03T07:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193403",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193404.json:
```json
{
    "body": "<a id='comment:35'></a>Tiny modifications\n* merged in beta.5\n* resolve some import in sage.rings.all\n\n---\nNew commits:",
    "created_at": "2014-03-26T12:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193404",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>Tiny modifications
* merged in beta.5
* resolve some import in sage.rings.all

---
New commits:



---

archive/issue_comments_193405.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-03T17:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193406.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:33 tmonteil]:\n> `CFF` is not fully autonomous and behaves like an overlay over other Sage\n> fields, thus sacrificing reliability over expressivity.\n\n\nagreed. There is no transformation on input now. Most problem disappear. The only trouble might be with floating point as I decided to first convert the input into a rational. Note however that\n\n```\nsage: RR.random_element() in QQ\nTrue\n```\n\n> I have not much problems with this overlay design as long as it is clearly\n> stated and consistent.\n\n\nIt is !\n\n> Another issue is:\n\n>\n> {{{\n> sage: CFF.is_exact()\n> True\n> }}}\n\n>\n> I disagree with that statement, since there are approximate elements in CFF,\n> for example `CFF(pi+0.1)`.\n\n\nI do not want to make CFF inexact. The trouble comes from the unstability of CFF... If you want a friendly CFF you either have to rebuild the symbolic ring or do with it.\n\n> in `_element_constructor_()`\n\n>\n> {{{\n> - ``nterms`` -- integer (optional)\n\n>\n> ??? is that an old remaining thing ?\n\n>\n>  - ``check`` -- boolean (optional) -- whether or not we check the\n \n>\n> \"the\" what ?\n> }}}\n\n\nThis is now removed\n\n> When you test whether an element of `SR` is a real number, you use `RIF(x)`.\n> Why not using `x.is_real()` (and make this method more reliable if needed) ?\n\n\nyou can not believe in `is_real` but I used it.\n\n> Another problem:\n\n>\n> {{{\n> sage: a = RDF(0.1)\n> sage: CFF(a)\n> [0]\n> }}}\n\n>\n> The reason is :\n\n>\n> {{{\n> sage: (1/RIF(RDF(0.1))).unique_floor()\n> ValueError: interval does not have a unique floor\n> }}}\n\n\nIt is now correct.\n\n```\nsage: continued_fraction(0.1)\n[0; 10]\n```\n\n> In the doc: \"It is quite remarkable that\".\n\n>\n> Add : \"- any real number admits a unique continued fraction expansion\"\n\n\ndone\n\n> [...]\n\n>\n> I would propose : \"from a list of numbers corresponding to its partial\n> quotients.\"\n\n\nAll occurrences of digits are removed and replaced by partial quotients.\n\n> Another problem:\n\n>\n> {{{\n> sage: cf = CFF([(1,2,3),(1,2,4)]); cf.value()\n> -1/86*sqrt229 + 139/86\n\n>\n> sage: sqrt229\n> ....\n> NameError: name 'sqrt229' is not defined\n> }}}\n\n\nI agree. It is quite hard to make it works. I only documented how to do\nthat in the method `value`.\n\n\n> \"two_last_convergents\" -> \"last_two_convergents\"\n\n\ndone\n\n> `_pn` and `_qn` looks good for internal variables, but i would suggest to\n> replace `pn()` and `qn()` methods by `numerator()` and `denominator()` to stay\n> consistent with rationals.\n\n\ndone\n\n> In the `_mpfr_` method: \"It is guaranteed that the result is exact\"\n\n>\n> Floating point number are not exact, perhaps \"accurate\" is a better word ?\n\n\ndone",
    "created_at": "2014-04-03T17:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193406",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>Replying to [comment:33 tmonteil]:
> `CFF` is not fully autonomous and behaves like an overlay over other Sage
> fields, thus sacrificing reliability over expressivity.


agreed. There is no transformation on input now. Most problem disappear. The only trouble might be with floating point as I decided to first convert the input into a rational. Note however that

```
sage: RR.random_element() in QQ
True
```

> I have not much problems with this overlay design as long as it is clearly
> stated and consistent.


It is !

> Another issue is:

>
> {{{
> sage: CFF.is_exact()
> True
> }}}

>
> I disagree with that statement, since there are approximate elements in CFF,
> for example `CFF(pi+0.1)`.


I do not want to make CFF inexact. The trouble comes from the unstability of CFF... If you want a friendly CFF you either have to rebuild the symbolic ring or do with it.

> in `_element_constructor_()`

>
> {{{
> - ``nterms`` -- integer (optional)

>
> ??? is that an old remaining thing ?

>
>  - ``check`` -- boolean (optional) -- whether or not we check the
 
>
> "the" what ?
> }}}


This is now removed

> When you test whether an element of `SR` is a real number, you use `RIF(x)`.
> Why not using `x.is_real()` (and make this method more reliable if needed) ?


you can not believe in `is_real` but I used it.

> Another problem:

>
> {{{
> sage: a = RDF(0.1)
> sage: CFF(a)
> [0]
> }}}

>
> The reason is :

>
> {{{
> sage: (1/RIF(RDF(0.1))).unique_floor()
> ValueError: interval does not have a unique floor
> }}}


It is now correct.

```
sage: continued_fraction(0.1)
[0; 10]
```

> In the doc: "It is quite remarkable that".

>
> Add : "- any real number admits a unique continued fraction expansion"


done

> [...]

>
> I would propose : "from a list of numbers corresponding to its partial
> quotients."


All occurrences of digits are removed and replaced by partial quotients.

> Another problem:

>
> {{{
> sage: cf = CFF([(1,2,3),(1,2,4)]); cf.value()
> -1/86*sqrt229 + 139/86

>
> sage: sqrt229
> ....
> NameError: name 'sqrt229' is not defined
> }}}


I agree. It is quite hard to make it works. I only documented how to do
that in the method `value`.


> "two_last_convergents" -> "last_two_convergents"


done

> `_pn` and `_qn` looks good for internal variables, but i would suggest to
> replace `pn()` and `qn()` methods by `numerator()` and `denominator()` to stay
> consistent with rationals.


done

> In the `_mpfr_` method: "It is guaranteed that the result is exact"

>
> Floating point number are not exact, perhaps "accurate" is a better word ?


done



---

archive/issue_comments_193407.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-03T17:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193407",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193408.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-18T12:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193408",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193409.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-22T08:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193409",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193410.json:
```json
{
    "body": "<a id='comment:40'></a>Hello,\n\nI am still working on this.\n\nFirstly, it is easy to implement a class for continued fractions given by an infinite expansion... so I propose to include it in that ticket.\n\nSecondly, I have a big open question: what should be the parent (if any) of a continued fraction? As Thierry M. already mentioned, the `CFF` class does not fit very well.\n\nVincent",
    "created_at": "2014-04-22T08:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193410",
    "user": "https://github.com/videlec"
}
```

<a id='comment:40'></a>Hello,

I am still working on this.

Firstly, it is easy to implement a class for continued fractions given by an infinite expansion... so I propose to include it in that ticket.

Secondly, I have a big open question: what should be the parent (if any) of a continued fraction? As Thierry M. already mentioned, the `CFF` class does not fit very well.

Vincent



---

archive/issue_comments_193411.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-27T12:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193412.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-27T12:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193412",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193413.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,45 @@\n+Continued fractions (in sage.rings.contfrac) do not do what we expect:\n \n+1. categories are not properly initialized nor used.\n+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)\n+3. it only deals with rational numbers\n+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)\n+5. there is no bridge with quadratic numbers (see also #11345)\n+6. there is no bridge with words (sage.combinat.words)\n+7. continued fractions are not included in the documentation\n+\n+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above.\n+\n+With the patch applied we can do\n+\n+```\n+sage: (117/253).continued_fraction()\n+[0; 2, 6, 6, 3]\n+\n+sage: K.<sqrt2> = QuadraticField(2)\n+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff\n+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]\n+sage: cff.period()\n+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)\n+sage: cff.preperiod()\n+(0, 1)\n+sage: cff.value()\n+1/3*sqrt2 + 1/4\n+sage: cff.n(digits=50)\n+0.72140452079103168293389624140323269285655729179232\n+\n+sage: cf_pi = continued_fraction(pi)\n+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]\n+sage: cf_pi.quotient(1500)\n+1\n+\n+sage: cf_fib = continued_fraction(words.FibonacciWord([1,2]))\n+sage: cf_fib\n+[1; 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2...]\n+sage: cf_fib.n(digits=42)\n+1.38795458796714233691931385987318547787815\n+```\n+In particular we solve the question in #11345.\n \n Author: vdelecroix\n \n```\n",
    "created_at": "2014-04-27T12:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193413",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,45 @@
+Continued fractions (in sage.rings.contfrac) do not do what we expect:
 
+1. categories are not properly initialized nor used.
+2. all arithmetic operations go back and forth with the underlying rational (there are much more direct solutions for taking the negative, inverse and to compare two continued fractions)
+3. it only deals with rational numbers
+4. there is no dedicated method for numerical approximations (which is one of the first aim of continued fractions)
+5. there is no bridge with quadratic numbers (see also #11345)
+6. there is no bridge with words (sage.combinat.words)
+7. continued fractions are not included in the documentation
+
+The patch proposed here develop some general design for dealing with continued fractions and solve all issues above.
+
+With the patch applied we can do
+
+```
+sage: (117/253).continued_fraction()
+[0; 2, 6, 6, 3]
+
+sage: K.<sqrt2> = QuadraticField(2)
+sage: cff = (sqrt2/3 + 1/4).continued_fraction(); cff
+[0; 1, (2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)*]
+sage: cff.period()
+(2, 1, 1, 2, 3, 2, 1, 1, 2, 5, 1, 1, 14, 1, 1, 5)
+sage: cff.preperiod()
+(0, 1)
+sage: cff.value()
+1/3*sqrt2 + 1/4
+sage: cff.n(digits=50)
+0.72140452079103168293389624140323269285655729179232
+
+sage: cf_pi = continued_fraction(pi)
+[3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, 2, 2, 2, ...]
+sage: cf_pi.quotient(1500)
+1
+
+sage: cf_fib = continued_fraction(words.FibonacciWord([1,2]))
+sage: cf_fib
+[1; 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2...]
+sage: cf_fib.n(digits=42)
+1.38795458796714233691931385987318547787815
+```
+In particular we solve the question in #11345.
 
 Author: vdelecroix
 
```




---

archive/issue_comments_193414.json:
```json
{
    "body": "<a id='comment:42'></a>Non fast forward commit (I have just one commit from 6.2.rc0 now).\n\nThis new implementation is cleaner and needs review !\n\nI guess we might deprecate `CFF` in an other ticket (but I will not do it).",
    "created_at": "2014-04-27T12:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193414",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>Non fast forward commit (I have just one commit from 6.2.rc0 now).

This new implementation is cleaner and needs review !

I guess we might deprecate `CFF` in an other ticket (but I will not do it).



---

archive/issue_comments_193415.json:
```json
{
    "body": "<a id='comment:43'></a>For the record it is necessary to\n\n```\nsage -b\nmake doc-clean\nmake doc\n```\nto build the documentation. `sage -docbuild` will not suffice (fails).",
    "created_at": "2014-05-02T08:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193415",
    "user": "https://github.com/rwst"
}
```

<a id='comment:43'></a>For the record it is necessary to

```
sage -b
make doc-clean
make doc
```
to build the documentation. `sage -docbuild` will not suffice (fails).



---

archive/issue_events_041494.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41494"
}
```



---

archive/issue_events_041495.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41495"
}
```



---

archive/issue_comments_193416.json:
```json
{
    "body": "<a id='comment:45'></a>patchbot:\n\n```\nsage -t --long src/sage/combinat/words/finite_word.py  # 1 doctest failed\nsage -t --long src/sage/combinat/words/word_generators.py  # 23 doctests failed\nsage -t --long src/doc/en/prep/Calculus.rst  # Timed out\nsage -t --long src/sage/rings/rational.pyx  # 2 doctests failed\n```",
    "created_at": "2014-05-14T13:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193416",
    "user": "https://github.com/rwst"
}
```

<a id='comment:45'></a>patchbot:

```
sage -t --long src/sage/combinat/words/finite_word.py  # 1 doctest failed
sage -t --long src/sage/combinat/words/word_generators.py  # 23 doctests failed
sage -t --long src/doc/en/prep/Calculus.rst  # Timed out
sage -t --long src/sage/rings/rational.pyx  # 2 doctests failed
```



---

archive/issue_comments_193417.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-14T13:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193417",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193418.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-14T14:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193418",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193419.json:
```json
{
    "body": "<a id='comment:47'></a>Thanks (a bug in plot and a bug in words).\n\nNow the tests pass.\n\nVincent",
    "created_at": "2014-05-14T14:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193419",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>Thanks (a bug in plot and a bug in words).

Now the tests pass.

Vincent



---

archive/issue_comments_193420.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-14T14:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193420",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193421.json:
```json
{
    "body": "<a id='comment:48'></a>you need to use the new doc continuation style `...:` (see patchbot report)",
    "created_at": "2014-06-25T07:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193421",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:48'></a>you need to use the new doc continuation style `...:` (see patchbot report)



---

archive/issue_comments_193422.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-25T07:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193422",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_193423.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-25T19:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193423",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_193424.json:
```json
{
    "body": "<a id='comment:49'></a>new branch, where I have taken care of the doctests continuation. Bot should turn green.\n\n---\nNew commits:",
    "created_at": "2014-06-25T19:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193424",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:49'></a>new branch, where I have taken care of the doctests continuation. Bot should turn green.

---
New commits:



---

archive/issue_comments_193425.json:
```json
{
    "body": "<a id='comment:50'></a>Thanks!\n\nPS Note: there is no need to do a merge as in your commit 7da398e. The option I use to pull a branch from track is\n\n```\ngit fetch trac the-branch-I-need\ngit checkout -b a-good-name FETCH_HEAD\n```",
    "created_at": "2014-06-25T19:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193425",
    "user": "https://github.com/videlec"
}
```

<a id='comment:50'></a>Thanks!

PS Note: there is no need to do a merge as in your commit 7da398e. The option I use to pull a branch from track is

```
git fetch trac the-branch-I-need
git checkout -b a-good-name FETCH_HEAD
```



---

archive/issue_events_041496.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41496"
}
```



---

archive/issue_events_041497.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41497"
}
```



---

archive/issue_comments_193426.json:
```json
{
    "body": "<a id='comment:52'></a>What remains to be done here to give positive review?",
    "created_at": "2014-12-18T04:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193426",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:52'></a>What remains to be done here to give positive review?



---

archive/issue_comments_193427.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-18T07:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193427",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_193428.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-12-18T07:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193428",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_193429.json:
```json
{
    "body": "<a id='comment:54'></a>Branch passes `make ptestlong`. I added an early example of `continued_fraction_list` to the docs for convenience. I think the issue with exactifying reals should be addressed with a `GoodRealField` as mentioned in comment:33, anyway a different ticket, as are extensions to symbolic expressions.",
    "created_at": "2014-12-18T07:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193429",
    "user": "https://github.com/rwst"
}
```

<a id='comment:54'></a>Branch passes `make ptestlong`. I added an early example of `continued_fraction_list` to the docs for convenience. I think the issue with exactifying reals should be addressed with a `GoodRealField` as mentioned in comment:33, anyway a different ticket, as are extensions to symbolic expressions.



---

archive/issue_comments_193430.json:
```json
{
    "body": "<a id='comment:55'></a>Thanks.\n\nThere are changes that affect two of William's books. I sent him an e-mail (cc'ed in sage-devel): [see this thread](https://groups.google.com/forum/#!topic/sage-devel/nInBoCD6Bcc).\n\nVincent",
    "created_at": "2014-12-18T08:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193430",
    "user": "https://github.com/videlec"
}
```

<a id='comment:55'></a>Thanks.

There are changes that affect two of William's books. I sent him an e-mail (cc'ed in sage-devel): [see this thread](https://groups.google.com/forum/#!topic/sage-devel/nInBoCD6Bcc).

Vincent



---

archive/issue_events_041498.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-01-13T05:03:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41498"
}
```



---

archive/issue_events_041499.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-01-13T05:03:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41499"
}
```



---

archive/issue_comments_193431.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2015-01-15T08:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_193432.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-01-15T08:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_193433.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-15T08:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193433",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_193434.json:
```json
{
    "body": "<a id='comment:59'></a>Ralf,\n\nthe one line you add to the file was wrong. I just replace it.\n\nI guess we should close the ticket has nobody answered on the sage-devel thread since a month now.\n\nVincent",
    "created_at": "2015-01-15T08:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193434",
    "user": "https://github.com/videlec"
}
```

<a id='comment:59'></a>Ralf,

the one line you add to the file was wrong. I just replace it.

I guess we should close the ticket has nobody answered on the sage-devel thread since a month now.

Vincent



---

archive/issue_comments_193435.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 vdelecroix]:\n> the one line you add to the file was wrong. I just replace it.\n\nOh well, thanks.",
    "created_at": "2015-01-15T08:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193435",
    "user": "https://github.com/rwst"
}
```

<a id='comment:60'></a>Replying to [comment:59 vdelecroix]:
> the one line you add to the file was wrong. I just replace it.

Oh well, thanks.



---

archive/issue_comments_193436.json:
```json
{
    "body": "<a id='comment:61'></a>Note: merge cleanly on sage-6.5.beta6 and tests pass in `sage/rings`, `sage/modular` and `sage/tests`!",
    "created_at": "2015-01-25T17:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193436",
    "user": "https://github.com/videlec"
}
```

<a id='comment:61'></a>Note: merge cleanly on sage-6.5.beta6 and tests pass in `sage/rings`, `sage/modular` and `sage/tests`!



---

archive/issue_comments_193437.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-29T22:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193437",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_041500.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-29T22:41:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14567#event-41500"
}
```



---

archive/issue_comments_193438.json:
```json
{
    "body": "<a id='comment:63'></a>Hey, I just hit an annoying case...\n\n```\nsage: continued_fraction_list(1.575709393346379)\nError in lines 1-1\nTraceback (most recent call last):\n...\nValueError: does not know how to compute the continued fraction of 1.57570939334638\n```\n\nHowever,\n\n```\nsage: continued_fraction_list(0 + 1.575709393346379)\n[1, 1, 1, 2, 1, 4, 18, 1, 5, 2, 22909319]\n```\n\nThe problem is that RealLiteral and continued fractions no longer work together...",
    "created_at": "2015-07-14T00:15:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193438",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:63'></a>Hey, I just hit an annoying case...

```
sage: continued_fraction_list(1.575709393346379)
Error in lines 1-1
Traceback (most recent call last):
...
ValueError: does not know how to compute the continued fraction of 1.57570939334638
```

However,

```
sage: continued_fraction_list(0 + 1.575709393346379)
[1, 1, 1, 2, 1, 4, 18, 1, 5, 2, 22909319]
```

The problem is that RealLiteral and continued fractions no longer work together...



---

archive/issue_comments_193439.json:
```json
{
    "body": "<a id='comment:64'></a>Indeed... did you open a ticket?",
    "created_at": "2015-07-14T08:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193439",
    "user": "https://github.com/videlec"
}
```

<a id='comment:64'></a>Indeed... did you open a ticket?



---

archive/issue_comments_193440.json:
```json
{
    "body": "<a id='comment:65'></a>Replying to [comment:64 vdelecroix]:\n> Indeed... did you open a ticket?\n\n\nNo, can you?",
    "created_at": "2015-07-14T14:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193440",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:65'></a>Replying to [comment:64 vdelecroix]:
> Indeed... did you open a ticket?


No, can you?



---

archive/issue_comments_193441.json:
```json
{
    "body": "<a id='comment:66'></a>> > Indeed... did you open a ticket?\n  \n> \n> No, can you?\n\nPing - I don't quite know what the issue is but hopefully a ticket can be opened.",
    "created_at": "2015-09-14T01:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193441",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:66'></a>> > Indeed... did you open a ticket?
  
> 
> No, can you?

Ping - I don't quite know what the issue is but hopefully a ticket can be opened.



---

archive/issue_comments_193442.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:66 kcrisman]:\n> > > Indeed... did you open a ticket?\n  \n> > \n> > No, can you?\n\n> Ping - I don't quite know what the issue is but hopefully a ticket can be opened.\n\nWas continued fractions of real literals. Solved in #18901. I apologize to have not mentioned it here.",
    "created_at": "2015-09-14T02:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193442",
    "user": "https://github.com/videlec"
}
```

<a id='comment:67'></a>Replying to [comment:66 kcrisman]:
> > > Indeed... did you open a ticket?
  
> > 
> > No, can you?

> Ping - I don't quite know what the issue is but hopefully a ticket can be opened.

Was continued fractions of real literals. Solved in #18901. I apologize to have not mentioned it here.



---

archive/issue_comments_193443.json:
```json
{
    "body": "<a id='comment:68'></a>See #20012 for **really** deprecating `CFF` (`ContinuedFractionField`).",
    "created_at": "2016-02-05T11:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14567#issuecomment-193443",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>See #20012 for **really** deprecating `CFF` (`ContinuedFractionField`).
