# Issue 14825: Iterators for p-adic expansions, polynomial representations of padic elements

archive/issues_014621.json:
```json
{
    "body": "This method makes a few additions/changes to p-adics.\n\n* If `K` is an extension of `Z_p` whose generator is `a`, we add a method `polynomial` which takes as input an element `x` in `K` and outputs a polynomial `P` with coefficients in `Z_p` such that `P(a) = x`.\n\n```\nsage: K.<a> = Qq(5^3)\nsage: a.polynomial()\n(1 + O(5^20))*x + (O(5^20))\n```\n* Rename the `list()` method to `expansion()` and have it return a custom iterable instead of a list\n* Rename the `teichmuller_list()` method to `teichmuller_expansion()` and have it return a custom iterable instead of a list\n* Add an optional argument `n` to `expansion()` and `teichmuller_expansion()`, providing a single digit in the p-adic expansion.\n* Fix inconsistencies in `teichmuller_expansion()` for different precision types\n* Deprecate `padded_list` since this functionality is available either from `expansion` or from `Integer.digits` using the `padto` keyword.\n* Copy sections of inclusions `ZZ->Zp` when they\u2019re used within the coercion system\n\nThere are followup tickets at #23827, #26406.\n\nAssignee: @roed314\n\nCC:  @saraedum\n\nKeywords: sd87, days88, polynomial representation\n\nWork_Issues: plugin error\n\nReviewer: Julian R\u00fcth, David Roe\n\nAuthor: Xavier Caruso, David Roe, Julian R\u00fcth\n\nBranch: 04a1579131d64cdc63ecf1babcba2350dec6497c\n\nDependencies: #20310\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14825\n\n",
    "closed_at": "2017-09-24T13:13:37Z",
    "created_at": "2013-06-26T10:42:23Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Iterators for p-adic expansions, polynomial representations of padic elements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14825",
    "user": "https://github.com/xcaruso"
}
```
This method makes a few additions/changes to p-adics.

* If `K` is an extension of `Z_p` whose generator is `a`, we add a method `polynomial` which takes as input an element `x` in `K` and outputs a polynomial `P` with coefficients in `Z_p` such that `P(a) = x`.

```
sage: K.<a> = Qq(5^3)
sage: a.polynomial()
(1 + O(5^20))*x + (O(5^20))
```
* Rename the `list()` method to `expansion()` and have it return a custom iterable instead of a list
* Rename the `teichmuller_list()` method to `teichmuller_expansion()` and have it return a custom iterable instead of a list
* Add an optional argument `n` to `expansion()` and `teichmuller_expansion()`, providing a single digit in the p-adic expansion.
* Fix inconsistencies in `teichmuller_expansion()` for different precision types
* Deprecate `padded_list` since this functionality is available either from `expansion` or from `Integer.digits` using the `padto` keyword.
* Copy sections of inclusions `ZZ->Zp` when they’re used within the coercion system

There are followup tickets at #23827, #26406.

Assignee: @roed314

CC:  @saraedum

Keywords: sd87, days88, polynomial representation

Work_Issues: plugin error

Reviewer: Julian Rüth, David Roe

Author: Xavier Caruso, David Roe, Julian Rüth

Branch: 04a1579131d64cdc63ecf1babcba2350dec6497c

Dependencies: #20310

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14825





---

archive/issue_comments_185713.json:
```json
{
    "body": "Attachment [trac_14825_polynomial_representation_padics.patch](tarball://root/attachments/some-uuid/ticket14825/trac_14825_polynomial_representation_padics.patch) by @xcaruso created at 2013-06-26 10:43:45",
    "created_at": "2013-06-26T10:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185713",
    "user": "https://github.com/xcaruso"
}
```

Attachment [trac_14825_polynomial_representation_padics.patch](tarball://root/attachments/some-uuid/ticket14825/trac_14825_polynomial_representation_padics.patch) by @xcaruso created at 2013-06-26 10:43:45



---

archive/issue_comments_185714.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-26T10:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185714",
    "user": "https://github.com/xcaruso"
}
```

Changing status from new to needs_review.



---

archive/issue_events_042561.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42561"
}
```



---

archive/issue_events_042562.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42562"
}
```



---

archive/issue_events_042563.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42563"
}
```



---

archive/issue_comments_185715.json:
```json
{
    "body": "<a id='comment:4'></a>Patch does not merge. Please rebase.",
    "created_at": "2014-05-12T13:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185715",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>Patch does not merge. Please rebase.



---

archive/issue_comments_185716.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-12T13:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185716",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_042564.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42564"
}
```



---

archive/issue_events_042565.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42565"
}
```



---

archive/issue_comments_185717.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-16T10:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185717",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185718.json:
```json
{
    "body": "<a id='comment:8'></a>I got a little carried away with some other changes.  In particular, I renamed and deprecated list and teichmuller list.  There are still two failing doctests, but I'm going to be offline for a week or so and wanted to push my changes.",
    "created_at": "2017-06-16T10:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185718",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>I got a little carried away with some other changes.  In particular, I renamed and deprecated list and teichmuller list.  There are still two failing doctests, but I'm going to be offline for a week or so and wanted to push my changes.



---

archive/issue_comments_185719.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-29T02:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185720.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-29T16:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185721.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-30T03:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185722.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-30T04:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185723.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-30T04:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185723",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185724.json:
```json
{
    "body": "<a id='comment:14'></a>By the way, I ran all tests and they pass.",
    "created_at": "2017-06-30T04:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185724",
    "user": "https://github.com/roed314"
}
```

<a id='comment:14'></a>By the way, I ran all tests and they pass.



---

archive/issue_comments_185725.json:
```json
{
    "body": "<a id='comment:16'></a>David, feel free to set this to positive review. My only question would be whether `polynomial` should be added to `API.pxi`?\n\n---\nNew commits:",
    "created_at": "2017-07-02T03:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185725",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:16'></a>David, feel free to set this to positive review. My only question would be whether `polynomial` should be added to `API.pxi`?

---
New commits:



---

archive/issue_comments_185726.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-02T03:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185726",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185727.json:
```json
{
    "body": "<a id='comment:17'></a>Misunderstood something about polynomial. Never mind.",
    "created_at": "2017-07-02T03:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185727",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:17'></a>Misunderstood something about polynomial. Never mind.



---

archive/issue_comments_185728.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-07-21T01:51:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185728",
    "user": "https://github.com/roed314"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_185729.json:
```json
{
    "body": "<a id='comment:19'></a>New commits:",
    "created_at": "2017-07-21T01:51:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185729",
    "user": "https://github.com/roed314"
}
```

<a id='comment:19'></a>New commits:



---

archive/issue_comments_185730.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-21T03:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185730",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185731.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-22T05:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185731",
    "user": "https://github.com/xcaruso"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_185732.json:
```json
{
    "body": "<a id='comment:21'></a>\n```\n    sage: K.<a> = Qq(7^3,4)\n    sage: b = (a+1)/7\n    sage: b.polynomial()\n    sig_error() without sig_on()\n    <BOUM>\n```",
    "created_at": "2017-07-22T05:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185732",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:21'></a>
```
    sage: K.<a> = Qq(7^3,4)
    sage: b = (a+1)/7
    sage: b.polynomial()
    sig_error() without sig_on()
    <BOUM>
```



---

archive/issue_comments_185733.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-02T21:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185733",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185734.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-03T00:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185735.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-03T00:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185735",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185736.json:
```json
{
    "body": "<a id='comment:24'></a>I fixed the segfault, and tests pass.",
    "created_at": "2017-08-03T00:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185736",
    "user": "https://github.com/roed314"
}
```

<a id='comment:24'></a>I fixed the segfault, and tests pass.



---

archive/issue_comments_185737.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-08-03T01:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_185738.json:
```json
{
    "body": "<a id='comment:26'></a>Adding a dependency for merging purposes.",
    "created_at": "2017-08-03T01:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185738",
    "user": "https://github.com/roed314"
}
```

<a id='comment:26'></a>Adding a dependency for merging purposes.



---

archive/issue_comments_185739.json:
```json
{
    "body": "Diff against 20310",
    "created_at": "2017-08-03T02:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185739",
    "user": "https://github.com/roed314"
}
```

Diff against 20310



---

archive/issue_comments_185740.json:
```json
{
    "body": "<a id='comment:27'></a>Attachment [14825_over_20310.diff](tarball://root/attachments/some-uuid/ticket14825/14825_over_20310.diff) by @roed314 created at 2017-08-03 02:05:07\n\nFor ease of reviewing, I've attached a diff against #20310.",
    "created_at": "2017-08-03T02:05:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185740",
    "user": "https://github.com/roed314"
}
```

<a id='comment:27'></a>Attachment [14825_over_20310.diff](tarball://root/attachments/some-uuid/ticket14825/14825_over_20310.diff) by @roed314 created at 2017-08-03 02:05:07

For ease of reviewing, I've attached a diff against #20310.



---

archive/issue_comments_185741.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-08-04T12:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185741",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_185742.json:
```json
{
    "body": "<a id='comment:29'></a>Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:\n\n```\nsage: K=Qp(2)\nsage: K(2).expansion()\n[1]\nsage: K(2).expansion(n=0)\n0 # should return 1?\nsage: K(2).expansion(n=1)\n1 # sould return 0?\n```\nThat's at least how I understand the expansion() docstring. Is the current behaviour intended?",
    "created_at": "2017-08-04T12:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185742",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:29'></a>Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:

```
sage: K=Qp(2)
sage: K(2).expansion()
[1]
sage: K(2).expansion(n=0)
0 # should return 1?
sage: K(2).expansion(n=1)
1 # sould return 0?
```
That's at least how I understand the expansion() docstring. Is the current behaviour intended?



---

archive/issue_comments_185743.json:
```json
{
    "body": "<a id='comment:30'></a>Here is something that the unit test found that seems to be a bug:\n\n```\nsage: ZpCA(2)(2).expansion(lift_mode='teichmuller')\n[1 + O(2^19)]\nsage: ZpFM(2)(2).expansion(lift_mode='teichmuller')\n[1 + O(2^20)]\n```",
    "created_at": "2017-08-04T12:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185743",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:30'></a>Here is something that the unit test found that seems to be a bug:

```
sage: ZpCA(2)(2).expansion(lift_mode='teichmuller')
[1 + O(2^19)]
sage: ZpFM(2)(2).expansion(lift_mode='teichmuller')
[1 + O(2^20)]
```



---

archive/issue_comments_185744.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:30 saraedum]:\n> Here is something that the unit test found that seems to be a bug:\n> \n> ```\n> sage: ZpCA(2)(2).expansion(lift_mode='teichmuller')\n> [1 + O(2^19)]\n> sage: ZpFM(2)(2).expansion(lift_mode='teichmuller')\n> [1 + O(2^20)]\n> ```\n\n\nWhy is this a bug?\n\n---\nNew commits:",
    "created_at": "2017-08-05T08:23:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185744",
    "user": "https://github.com/roed314"
}
```

<a id='comment:34'></a>Replying to [comment:30 saraedum]:
> Here is something that the unit test found that seems to be a bug:
> 
> ```
> sage: ZpCA(2)(2).expansion(lift_mode='teichmuller')
> [1 + O(2^19)]
> sage: ZpFM(2)(2).expansion(lift_mode='teichmuller')
> [1 + O(2^20)]
> ```


Why is this a bug?

---
New commits:



---

archive/issue_comments_185745.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:29 saraedum]:\n> Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:\n> \n> ```\n> sage: K=Qp(2)\n> sage: K(2).expansion()\n> [1]\n> sage: K(2).expansion(n=0)\n> 0 # should return 1?\n> sage: K(2).expansion(n=1)\n> 1 # should return 0?\n> ```\n> That's at least how I understand the expansion() docstring. Is the current behaviour intended?\n\n\nYeah, this is intended.  When you pass in a value for `n` it gives you the coefficient of p<sup>n</sup>, rather than the `n`th term in the list.  I've updated the test (but haven't pushed yet).",
    "created_at": "2017-08-05T08:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185745",
    "user": "https://github.com/roed314"
}
```

<a id='comment:35'></a>Replying to [comment:29 saraedum]:
> Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:
> 
> ```
> sage: K=Qp(2)
> sage: K(2).expansion()
> [1]
> sage: K(2).expansion(n=0)
> 0 # should return 1?
> sage: K(2).expansion(n=1)
> 1 # should return 0?
> ```
> That's at least how I understand the expansion() docstring. Is the current behaviour intended?


Yeah, this is intended.  When you pass in a value for `n` it gives you the coefficient of p<sup>n</sup>, rather than the `n`th term in the list.  I've updated the test (but haven't pushed yet).



---

archive/issue_comments_185746.json:
```json
{
    "body": "<a id='comment:36'></a>So, your test causes `padic_expansion_generic.py` to time out, since it's running with precision cap 10000.  One way to improve the situation might be to change expansion to return an iterator (and then change `_test_expansion` to top out at testing at most 40 terms or something).  This ticket might be a good time to do this, since we're already deprecating list; it's not hard to change the behavior of `expansion` at the same time (which we're in fact doing by adding the `n` keyword).\n\nWhat do you think?",
    "created_at": "2017-08-05T08:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185746",
    "user": "https://github.com/roed314"
}
```

<a id='comment:36'></a>So, your test causes `padic_expansion_generic.py` to time out, since it's running with precision cap 10000.  One way to improve the situation might be to change expansion to return an iterator (and then change `_test_expansion` to top out at testing at most 40 terms or something).  This ticket might be a good time to do this, since we're already deprecating list; it's not hard to change the behavior of `expansion` at the same time (which we're in fact doing by adding the `n` keyword).

What do you think?



---

archive/issue_comments_185747.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:35 roed]:\n> Replying to [comment:29 saraedum]:\n> > Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:\n> > \n> > ```\n> > sage: K=Qp(2)\n> > sage: K(2).expansion()\n> > [1]\n> > sage: K(2).expansion(n=0)\n> > 0 # should return 1?\n> > sage: K(2).expansion(n=1)\n> > 1 # should return 0?\n> > ```\n> > That's at least how I understand the expansion() docstring. Is the current behaviour intended?\n\n> \n> Yeah, this is intended.  When you pass in a value for `n` it gives you the coefficient of p<sup>n</sup>, rather than the `n`th term in the list.  I've updated the test (but haven't pushed yet).\nOk. Then the documentation should be more explicit. I thought it's just a shortcut to get the n-th element in the list.\n\n---\nNew commits:",
    "created_at": "2017-08-05T12:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185747",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:38'></a>Replying to [comment:35 roed]:
> Replying to [comment:29 saraedum]:
> > Ok. Looks good. I fixed a few very minor documentation issues. I also wrote a unit test for expansion and it fails for some instances. This is likely only a error in the documentation:
> > 
> > ```
> > sage: K=Qp(2)
> > sage: K(2).expansion()
> > [1]
> > sage: K(2).expansion(n=0)
> > 0 # should return 1?
> > sage: K(2).expansion(n=1)
> > 1 # should return 0?
> > ```
> > That's at least how I understand the expansion() docstring. Is the current behaviour intended?

> 
> Yeah, this is intended.  When you pass in a value for `n` it gives you the coefficient of p<sup>n</sup>, rather than the `n`th term in the list.  I've updated the test (but haven't pushed yet).
Ok. Then the documentation should be more explicit. I thought it's just a shortcut to get the n-th element in the list.

---
New commits:



---

archive/issue_comments_185748.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:36 roed]:\n> So, your test causes `padic_expansion_generic.py` to time out, since it's running with precision cap 10000.  One way to improve the situation might be to change expansion to return an iterator (and then change `_test_expansion` to top out at testing at most 40 terms or something).  This ticket might be a good time to do this, since we're already deprecating list; it's not hard to change the behavior of `expansion` at the same time (which we're in fact doing by adding the `n` keyword).\n> \n> What do you think?\n\nSounds good.",
    "created_at": "2017-08-05T12:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185748",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:39'></a>Replying to [comment:36 roed]:
> So, your test causes `padic_expansion_generic.py` to time out, since it's running with precision cap 10000.  One way to improve the situation might be to change expansion to return an iterator (and then change `_test_expansion` to top out at testing at most 40 terms or something).  This ticket might be a good time to do this, since we're already deprecating list; it's not hard to change the behavior of `expansion` at the same time (which we're in fact doing by adding the `n` keyword).
> 
> What do you think?

Sounds good.



---

archive/issue_comments_185749.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:34 roed]:\n> Replying to [comment:30 saraedum]:\n> > Here is something that the unit test found that seems to be a bug:\n> > \n> > ```\n> > sage: ZpCA(2)(2).expansion(lift_mode='teichmuller')\n> > [1 + O(2^19)]\n> > sage: ZpFM(2)(2).expansion(lift_mode='teichmuller')\n> > [1 + O(2^20)]\n> > ```\n\n> \n> Why is this a bug?\n\nThe docstring says that (since this is not a field) summing these with powers of pi should return the original element, i.e., `(1 + O(2<sup>19))*2</sup>0 == 2`.",
    "created_at": "2017-08-05T12:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185749",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:40'></a>Replying to [comment:34 roed]:
> Replying to [comment:30 saraedum]:
> > Here is something that the unit test found that seems to be a bug:
> > 
> > ```
> > sage: ZpCA(2)(2).expansion(lift_mode='teichmuller')
> > [1 + O(2^19)]
> > sage: ZpFM(2)(2).expansion(lift_mode='teichmuller')
> > [1 + O(2^20)]
> > ```

> 
> Why is this a bug?

The docstring says that (since this is not a field) summing these with powers of pi should return the original element, i.e., `(1 + O(2<sup>19))*2</sup>0 == 2`.



---

archive/issue_comments_185750.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-21T03:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185750",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185751.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2017-08-25T19:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185751",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_185752.json:
```json
{
    "body": "Changing keywords from \"polynomial representation\" to \"sd87, days88, polynomial representation\".",
    "created_at": "2017-08-25T19:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185752",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "polynomial representation" to "sd87, days88, polynomial representation".



---

archive/issue_comments_185753.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-06T16:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185753",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185754.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-08T23:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185754",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185755.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-09T03:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185755",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185756.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-09T03:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185757.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-09T03:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185757",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185758.json:
```json
{
    "body": "<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-09T04:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185758",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185759.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-10T14:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185759",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_185760.json:
```json
{
    "body": "<a id='comment:52'></a>This looks very good. Is there a follow up ticket to implement the new `__getitem__`?",
    "created_at": "2017-09-10T14:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185760",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:52'></a>This looks very good. Is there a follow up ticket to implement the new `__getitem__`?



---

archive/issue_comments_185761.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-11T07:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185762.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:52 saraedum]:\n> This looks very good. Is there a follow up ticket to implement the new `__getitem__`?\n\n\nFollowup is now #23827",
    "created_at": "2017-09-11T07:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185762",
    "user": "https://github.com/roed314"
}
```

<a id='comment:54'></a>Replying to [comment:52 saraedum]:
> This looks very good. Is there a follow up ticket to implement the new `__getitem__`?


Followup is now #23827



---

archive/issue_comments_185763.json:
```json
{
    "body": "<a id='comment:55'></a>Patchbot complains about `.. SEEALSO::`, but I'm confused: this is the correct syntax described both in the developer guide and the [patchbot source code](https://github.com/sagemath/sage-patchbot/blob/master/sage_patchbot/plugins.py)!  Am I missing something?\n\nThe doctest errors are the normal glpk issues, which aren't due to this ticket.",
    "created_at": "2017-09-11T17:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185763",
    "user": "https://github.com/roed314"
}
```

<a id='comment:55'></a>Patchbot complains about `.. SEEALSO::`, but I'm confused: this is the correct syntax described both in the developer guide and the [patchbot source code](https://github.com/sagemath/sage-patchbot/blob/master/sage_patchbot/plugins.py)!  Am I missing something?

The doctest errors are the normal glpk issues, which aren't due to this ticket.



---

archive/issue_comments_185764.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-11T17:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185764",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185765.json:
```json
{
    "body": "<a id='comment:58'></a>New commits:",
    "created_at": "2017-09-20T15:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185765",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:58'></a>New commits:



---

archive/issue_comments_185766.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-20T16:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185766",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185767.json:
```json
{
    "body": "<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-20T18:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_185768.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-22T19:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185768",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185769.json:
```json
{
    "body": "<a id='comment:62'></a>I'm happy with Julian's changes, and the patchbot is green.  Positive review!\n\n---\nNew commits:",
    "created_at": "2017-09-22T19:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185769",
    "user": "https://github.com/roed314"
}
```

<a id='comment:62'></a>I'm happy with Julian's changes, and the patchbot is green.  Positive review!

---
New commits:



---

archive/issue_events_042566.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-24T13:13:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14825#event-42566"
}
```



---

archive/issue_comments_185770.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-24T13:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14825",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14825#issuecomment-185770",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
