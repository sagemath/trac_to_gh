# Issue 14382: Fix LaTeXing of strings

archive/issues_014178.json:
```json
{
    "body": "#11498 made \"ASCII-art\" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.\n\nApply [attachment:trac_14382-texttt.patch].\n\n**Assignee:** @williamstein\n\n**CC:**  @JohnCremona @dandrake @jhpalmieri\n\n**Keywords:** latex\n\n**Reviewer:** John Palmieri\n\n**Author:** Andrey Novoseltsev\n\n**Merged:** sage-5.12.beta3\n\nIssue created by migration from https://trac.sagemath.org/ticket/14382\n\n",
    "closed_at": "2013-08-20T12:55:54Z",
    "created_at": "2013-03-29T15:38:28Z",
    "labels": [
        "component: user interface",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Fix LaTeXing of strings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14382",
    "user": "https://github.com/novoselt"
}
```
#11498 made "ASCII-art" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.

Apply [attachment:trac_14382-texttt.patch].

**Assignee:** @williamstein

**CC:**  @JohnCremona @dandrake @jhpalmieri

**Keywords:** latex

**Reviewer:** John Palmieri

**Author:** Andrey Novoseltsev

**Merged:** sage-5.12.beta3

Issue created by migration from https://trac.sagemath.org/ticket/14382





---

archive/issue_comments_213527.json:
```json
{
    "body": "**Author:** Andrey Novoseltsev",
    "created_at": "2013-03-29T17:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213527",
    "user": "https://github.com/novoselt"
}
```

**Author:** Andrey Novoseltsev



---

archive/issue_comments_213528.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"latex\".",
    "created_at": "2013-03-29T17:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213528",
    "user": "https://github.com/novoselt"
}
```

**Changing keywords** from "" to "latex".



---

archive/issue_comments_213529.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-03-29T17:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213529",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_213530.json:
```json
{
    "body": "<a id='comment:4'></a>\nYou might want to have a look at #13624; it replaces \\verb back to \\text to help dot2tex. Not really your business, but maybe it would make sense to use \\text in the easy cases, with no \\phantom's? This is quite more readable!\n\nCheers,\n                            Nicolas",
    "created_at": "2013-04-02T02:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213530",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>
You might want to have a look at #13624; it replaces \verb back to \text to help dot2tex. Not really your business, but maybe it would make sense to use \text in the easy cases, with no \phantom's? This is quite more readable!

Cheers,
                            Nicolas



---

archive/issue_comments_213531.json:
```json
{
    "body": "<a id='comment:5'></a>\nI don't think `\\phantom{x}` is likely to cause troubles, and I didn't figure out a better way to insert a \"monotype width space\" compatible with MathJax we use. The method in question here is fallback to when classes do not produce latex code at all, and in this case using verb is the best we can do to preserve formatting: keep line breaks and vertical alignment in case it is important. In particular cases like #13624 there has to be proper latex treatment of strings. The general case has to be uniform, I think, not like in #14256.",
    "created_at": "2013-04-02T02:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213531",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>
I don't think `\phantom{x}` is likely to cause troubles, and I didn't figure out a better way to insert a "monotype width space" compatible with MathJax we use. The method in question here is fallback to when classes do not produce latex code at all, and in this case using verb is the best we can do to preserve formatting: keep line breaks and vertical alignment in case it is important. In particular cases like #13624 there has to be proper latex treatment of strings. The general case has to be uniform, I think, not like in #14256.



---

archive/issue_comments_213532.json:
```json
{
    "body": "<a id='comment:6'></a>\nCan you provide examples that this is supposed to fix? Running SageTeX on a file containing\n\n```\n\\[\n\\sage{RubiksCube()}\n\\]\n```\ndoesn't work either before or after the patch.",
    "created_at": "2013-04-02T21:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213532",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
Can you provide examples that this is supposed to fix? Running SageTeX on a file containing

```
\[
\sage{RubiksCube()}
\]
```
doesn't work either before or after the patch.



---

archive/issue_comments_213533.json:
```json
{
    "body": "<a id='comment:7'></a>\nBy the way, line 337 should say `MathJax`, not `jsMath`.",
    "created_at": "2013-04-02T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213533",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
By the way, line 337 should say `MathJax`, not `jsMath`.



---

archive/issue_comments_213534.json:
```json
{
    "body": "<a id='comment:8'></a>\nHere's a LaTeX file:\n\n```\n\\documentclass{article}\n\\usepackage{sagetex}\n\\begin{document}\n\nLet's try this:\n\\[\n\\sage{\"1 2\"}\n\\]\nDoesn't work.\n\n\\end{document}\n```\nRunning latex on this, then sagetex, then latex, I get this error:\n\n```\n! Missing } inserted.\n<inserted text> \n                }\nl.7 \\sage{\"1 2\"}\n                \n? \n```",
    "created_at": "2013-04-02T21:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213534",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Here's a LaTeX file:

```
\documentclass{article}
\usepackage{sagetex}
\begin{document}

Let's try this:
\[
\sage{"1 2"}
\]
Doesn't work.

\end{document}
```
Running latex on this, then sagetex, then latex, I get this error:

```
! Missing } inserted.
<inserted text> 
                }
l.7 \sage{"1 2"}
                
? 
```



---

archive/issue_comments_213535.json:
```json
{
    "body": "<a id='comment:9'></a>\nAs long as you have verbatim things, this won't work in TeX documents. The `\\sage` macro relies on pulling in the output via a label, and verbatim things don't work well when pushed around with labels and references. (They are \"fragile\".)\n\nI mentioned this on another ticket, but one problem we have is that we use the LaTeX output for two different environments: for consumption by MathJax, and by regular LaTeX. Those environments are really pretty different.",
    "created_at": "2013-04-02T22:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213535",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:9'></a>
As long as you have verbatim things, this won't work in TeX documents. The `\sage` macro relies on pulling in the output via a label, and verbatim things don't work well when pushed around with labels and references. (They are "fragile".)

I mentioned this on another ticket, but one problem we have is that we use the LaTeX output for two different environments: for consumption by MathJax, and by regular LaTeX. Those environments are really pretty different.



---

archive/issue_comments_213536.json:
```json
{
    "body": "<a id='comment:10'></a>\nOK, my bad, it still does not work with SageTeX, althoug the generated code is at least valid in LaTeX for copy-pasting, while putting verb inside of phantom is not.\n\nAfter playing some more, I see that MathJax that we have does support `\\tt`, so I'll try to use that instead of verb.",
    "created_at": "2013-04-03T02:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213536",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:10'></a>
OK, my bad, it still does not work with SageTeX, althoug the generated code is at least valid in LaTeX for copy-pasting, while putting verb inside of phantom is not.

After playing some more, I see that MathJax that we have does support `\tt`, so I'll try to use that instead of verb.



---

archive/issue_comments_213537.json:
```json
{
    "body": "<a id='comment:11'></a>\nI don't think that `\\tt` will handle spaces correctly, but maybe I'm wrong.\n\nOne option we could consider: use `EMBEDDED_MODE` to detect whether we're using the notebook. Or we could produce output that SageTeX can handle but not MathJax, and then post-process it if using MathJax, converting the relevant string, maybe in the `eval` method for `MathJax`. We used to do this with `jsMath`, if I recall correctly.",
    "created_at": "2013-04-03T02:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213537",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
I don't think that `\tt` will handle spaces correctly, but maybe I'm wrong.

One option we could consider: use `EMBEDDED_MODE` to detect whether we're using the notebook. Or we could produce output that SageTeX can handle but not MathJax, and then post-process it if using MathJax, converting the relevant string, maybe in the `eval` method for `MathJax`. We used to do this with `jsMath`, if I recall correctly.



---

archive/issue_comments_213538.json:
```json
{
    "body": "<a id='comment:12'></a>\nActually one of the reasons for using verb was that strings may contain all kinds of special characters and it is tricky to display them all properly. So I think that for MathJax we still are better off using verb, but perhaps in non-embedded mode something else can be done, although special characters still have to be allowed.\n\nA combination of tt and phantom in array can produce proper spacing, it seems, but somehow special characters have different width when escaped, e.g. #",
    "created_at": "2013-04-03T02:47:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213538",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:12'></a>
Actually one of the reasons for using verb was that strings may contain all kinds of special characters and it is tricky to display them all properly. So I think that for MathJax we still are better off using verb, but perhaps in non-embedded mode something else can be done, although special characters still have to be allowed.

A combination of tt and phantom in array can produce proper spacing, it seems, but somehow special characters have different width when escaped, e.g. #



---

archive/issue_comments_213539.json:
```json
{
    "body": "**Work_Issues:** try text/tt",
    "created_at": "2013-04-03T02:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213539",
    "user": "https://github.com/novoselt"
}
```

**Work_Issues:** try text/tt



---

archive/issue_comments_213540.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-04-03T02:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213540",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_213541.json:
```json
{
    "body": "<a id='comment:13'></a>\nAhhh, it seems that `\\text{\\tt ...}` works quite well, I guess with `\\tt` in math mode escaping was switching to a different font. Will try to make another patch this week.",
    "created_at": "2013-04-03T02:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213541",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:13'></a>
Ahhh, it seems that `\text{\tt ...}` works quite well, I guess with `\tt` in math mode escaping was switching to a different font. Will try to make another patch this week.



---

archive/issue_comments_213542.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jhpalmieri](#comment%3A11):\n> One option we could consider: use `EMBEDDED_MODE` to detect whether we're using the notebook.\n\n\nI did not really think about it, but even in EMBEDDED_MODE one may want to produce latex code for something else than mathjax. So maybe that's not super robust.",
    "created_at": "2013-04-03T03:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213542",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>
Replying to [jhpalmieri](#comment%3A11):
> One option we could consider: use `EMBEDDED_MODE` to detect whether we're using the notebook.


I did not really think about it, but even in EMBEDDED_MODE one may want to produce latex code for something else than mathjax. So maybe that's not super robust.



---

archive/issue_comments_213543.json:
```json
{
    "body": "<a id='comment:15'></a>\nOK, how about this one: old-style verb in EMBEDDED_MODE and text-tt wrapping otherwise. `RubiksCube()` looks perfect when rendered through SageTeX! (I didn't change documentation/doctests yet.)\n\nNote that both ways generate valid LaTeX code, although verb one does not work in command arguments and text-tt does not work in MathJax... Nevertheless I think it is the way to go - particular cases where this treatment is insufficient should provide adequate handling of LaTeX generation themselves.",
    "created_at": "2013-04-04T04:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213543",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:15'></a>
OK, how about this one: old-style verb in EMBEDDED_MODE and text-tt wrapping otherwise. `RubiksCube()` looks perfect when rendered through SageTeX! (I didn't change documentation/doctests yet.)

Note that both ways generate valid LaTeX code, although verb one does not work in command arguments and text-tt does not work in MathJax... Nevertheless I think it is the way to go - particular cases where this treatment is insufficient should provide adequate handling of LaTeX generation themselves.



---

archive/issue_comments_213544.json:
```json
{
    "body": "<a id='comment:16'></a>\nI think Nicolas's point has some merit. Could we instead have text-tt wrapping in general, and then in the MathJax eval method, do a regular expression search-and-replace to change `\\text{\\tt{...}}` into `\\verb|...|`, or something like that?",
    "created_at": "2013-04-04T05:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213544",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
I think Nicolas's point has some merit. Could we instead have text-tt wrapping in general, and then in the MathJax eval method, do a regular expression search-and-replace to change `\text{\tt{...}}` into `\verb|...|`, or something like that?



---

archive/issue_comments_213545.json:
```json
{
    "body": "<a id='comment:17'></a>\nNew version uses text-tt and switches to verb in MathJax. I don't think that regular expressions can be used, since it is necessary to balance braces. There was a code in free modules removing the old verb wrappers - I switched it to using string representation in this case. If this is not what is desired, then I think no fiddling has to be done here at all, since without verb there are no issues with command arguments.",
    "created_at": "2013-04-17T19:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213545",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:17'></a>
New version uses text-tt and switches to verb in MathJax. I don't think that regular expressions can be used, since it is necessary to balance braces. There was a code in free modules removing the old verb wrappers - I switched it to using string representation in this case. If this is not what is desired, then I think no fiddling has to be done here at all, since without verb there are no issues with command arguments.



---

archive/issue_comments_213546.json:
```json
{
    "body": "**Changing work_issues** from \"try text/tt\" to \"\".",
    "created_at": "2013-04-17T19:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213546",
    "user": "https://github.com/novoselt"
}
```

**Changing work_issues** from "try text/tt" to "".



---

archive/issue_comments_213547.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-04-17T19:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213547",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_213548.json:
```json
{
    "body": "<a id='comment:18'></a>\nAlso, since verb is now used for MathJax only, I left `\\phantom{\\verb` which I complained about originally - it is not a valid LaTeX still, but it does give better look in MathJax - `RubiksCube()` looks now perfectly both in the notebook and via SageTeX.",
    "created_at": "2013-04-17T19:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213548",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:18'></a>
Also, since verb is now used for MathJax only, I left `\phantom{\verb` which I complained about originally - it is not a valid LaTeX still, but it does give better look in MathJax - `RubiksCube()` looks now perfectly both in the notebook and via SageTeX.



---

archive/attachments_019407.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14382_doctests.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14382/trac_14382_doctests.2.patch",
    "created_at": "2013-05-16T19:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_213549.json:
```json
{
    "body": "",
    "created_at": "2013-05-16T19:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213549",
    "user": "https://github.com/novoselt"
}
```





---

archive/issue_comments_213550.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n #11498 made \"ASCII-art\" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.\n+\n+**Apply** [attachment:trac_14382_fix_latex_of_strings.patch] and [attachment:trac_14382_doctests.patch]\n+\n+\n``````\n",
    "created_at": "2013-05-16T19:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213550",
    "user": "https://github.com/novoselt"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 #11498 made "ASCII-art" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.
+
+**Apply** [attachment:trac_14382_fix_latex_of_strings.patch] and [attachment:trac_14382_doctests.patch]
+
+
``````




---

archive/attachments_019408.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14382_doctests.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14382/trac_14382_doctests.patch",
    "created_at": "2013-05-16T19:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_213551.json:
```json
{
    "body": "<a id='comment:19'></a>\nFixed the doctest in tutorials which I missed before (by the way, the patchbot caught the problem in the English version only, not German).",
    "created_at": "2013-05-16T19:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213551",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:19'></a>
Fixed the doctest in tutorials which I missed before (by the way, the patchbot caught the problem in the English version only, not German).



---

archive/issue_comments_213552.json:
```json
{
    "body": "<a id='comment:20'></a>\nApply trac_14382_fix_latex_of_strings.patch  trac_14382_doctests.patch",
    "created_at": "2013-05-16T20:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213552",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:20'></a>
Apply trac_14382_fix_latex_of_strings.patch  trac_14382_doctests.patch



---

archive/issue_comments_213553.json:
```json
{
    "body": "<a id='comment:21'></a>\nThings can be simplified after switching to MathJax 2.2:\n* https://github.com/mathjax/MathJax/issues/380\n* https://github.com/mathjax/MathJax/issues/381",
    "created_at": "2013-05-17T20:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213553",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:21'></a>
Things can be simplified after switching to MathJax 2.2:
* https://github.com/mathjax/MathJax/issues/380
* https://github.com/mathjax/MathJax/issues/381



---

archive/issue_comments_213554.json:
```json
{
    "body": "<a id='comment:22'></a>\nSpaces in verb are handled correctly with 2.2 in SVG mode, but are still quite off in HTML-CSS, so I think that patches here are still the way to go!",
    "created_at": "2013-06-17T23:52:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213554",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:22'></a>
Spaces in verb are handled correctly with 2.2 in SVG mode, but are still quite off in HTML-CSS, so I think that patches here are still the way to go!



---

archive/issue_comments_213555.json:
```json
{
    "body": "<a id='comment:23'></a>\nWith this patch, running `view(RubiksCube())` from the command line produces output in which the numbers are lined up, but the horizontal lines are too short: LaTeX is turning each pair of dashes `--` into an \"en-dash\". If you want to use this approach, maybe you need to use `{-}{-}` instead of `--`.\n\nFrom the notebook, I don't see anything useful, but that may be specific to this machine. I'll try it on another machine eventually.\n\nFrom SageTeX, it works, but it requires the package `amsmath` because of the `\\text{...}` command. I'm not sure that's ideal.",
    "created_at": "2013-06-21T21:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213555",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
With this patch, running `view(RubiksCube())` from the command line produces output in which the numbers are lined up, but the horizontal lines are too short: LaTeX is turning each pair of dashes `--` into an "en-dash". If you want to use this approach, maybe you need to use `{-}{-}` instead of `--`.

From the notebook, I don't see anything useful, but that may be specific to this machine. I'll try it on another machine eventually.

From SageTeX, it works, but it requires the package `amsmath` because of the `\text{...}` command. I'm not sure that's ideal.



---

archive/issue_comments_213556.json:
```json
{
    "body": "**Work_Issues:** dashes and commanline view",
    "created_at": "2013-06-21T21:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213556",
    "user": "https://github.com/novoselt"
}
```

**Work_Issues:** dashes and commanline view



---

archive/issue_comments_213557.json:
```json
{
    "body": "<a id='comment:24'></a>\nInteresting, was working fine for me except for the command-line which I didn't think about. Will keep working.",
    "created_at": "2013-06-21T21:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213557",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:24'></a>
Interesting, was working fine for me except for the command-line which I didn't think about. Will keep working.



---

archive/issue_comments_213558.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-06-21T21:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213558",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_213559.json:
```json
{
    "body": "<a id='comment:25'></a>\nDoes anyone recall any reason to use `\\text{\\tt }` rather than `\\texttt{ }`? The latter should be eventually supported by MathJax (i.e. they plan to do it) while the former is a more general problem of not supporting nested font switches or something like that. Directly from LaTeX it seems to be identical.\n\nI am also puzzled by combining of dashes - it does not happen for hand-written code or via SageTeX, why does it happen for `view`???",
    "created_at": "2013-06-21T22:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213559",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:25'></a>
Does anyone recall any reason to use `\text{\tt }` rather than `\texttt{ }`? The latter should be eventually supported by MathJax (i.e. they plan to do it) while the former is a more general problem of not supporting nested font switches or something like that. Directly from LaTeX it seems to be identical.

I am also puzzled by combining of dashes - it does not happen for hand-written code or via SageTeX, why does it happen for `view`???



---

archive/issue_comments_213560.json:
```json
{
    "body": "<a id='comment:26'></a>\nProbably use `\\mathtt` instead of `\\texttt`, since LaTeX output in Sage should be in math mode. Otherwise, I don't know why use `\\text{\\tt }` instead of `\\mathtt`. I don't understand the dash issue, either.",
    "created_at": "2013-06-21T22:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213560",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
Probably use `\mathtt` instead of `\texttt`, since LaTeX output in Sage should be in math mode. Otherwise, I don't know why use `\text{\tt }` instead of `\mathtt`. I don't understand the dash issue, either.



---

archive/issue_comments_213561.json:
```json
{
    "body": "<a id='comment:27'></a>\n`\\mathtt` is not a monospaced font. I can't see the difference between `\\text{\\tt }` and `\\texttt{ }`, but the latter works without amsmath. On the other hand, without amsmath it does not scale properly, so amsmath is still desirable. I don't really see the problem with it - hard to imagine that someone will use Sage for typesetting math and yet object to loading a standard math package.",
    "created_at": "2013-06-21T22:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213561",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:27'></a>
`\mathtt` is not a monospaced font. I can't see the difference between `\text{\tt }` and `\texttt{ }`, but the latter works without amsmath. On the other hand, without amsmath it does not scale properly, so amsmath is still desirable. I don't really see the problem with it - hard to imagine that someone will use Sage for typesetting math and yet object to loading a standard math package.



---

archive/issue_comments_213562.json:
```json
{
    "body": "<a id='comment:28'></a>\nYou shouldn't use `\\texttt{...}` within math mode. It might work, but if so, it's taking advantage of a bug.",
    "created_at": "2013-06-21T22:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213562",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
You shouldn't use `\texttt{...}` within math mode. It might work, but if so, it's taking advantage of a bug.



---

archive/issue_comments_213563.json:
```json
{
    "body": "<a id='comment:29'></a>\nOK, then it seems to me that missing dashes for the command line are the only issue!",
    "created_at": "2013-06-21T22:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213563",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:29'></a>
OK, then it seems to me that missing dashes for the command line are the only issue!



---

archive/issue_comments_213564.json:
```json
{
    "body": "Use text-tt",
    "created_at": "2013-06-21T23:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213564",
    "user": "https://github.com/novoselt"
}
```

Use text-tt



---

archive/issue_comments_213565.json:
```json
{
    "body": "**Changing work_issues** from \"dashes and commanline view\" to \"\".",
    "created_at": "2013-06-21T23:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213565",
    "user": "https://github.com/novoselt"
}
```

**Changing work_issues** from "dashes and commanline view" to "".



---

archive/attachments_019409.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14382_fix_latex_of_strings.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14382/trac_14382_fix_latex_of_strings.patch",
    "created_at": "2013-06-21T23:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_213566.json:
```json
{
    "body": "<a id='comment:30'></a>\nDidn't run tests yet, but they should not be affected by this change, hopefully.",
    "created_at": "2013-06-21T23:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213566",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:30'></a>
Didn't run tests yet, but they should not be affected by this change, hopefully.



---

archive/issue_comments_213567.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-06-21T23:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213567",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_213568.json:
```json
{
    "body": "<a id='comment:31'></a>\nAll tests pass both for me and the patchbot.\n\nJohn, what exactly was \"From the notebook, I don't see anything useful\"? Was it indeed something with a single machine or some generic issue? I've had these patches on for a while and didn't experience any problems under Windows and Linux.",
    "created_at": "2013-06-30T19:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213568",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:31'></a>
All tests pass both for me and the patchbot.

John, what exactly was "From the notebook, I don't see anything useful"? Was it indeed something with a single machine or some generic issue? I've had these patches on for a while and didn't experience any problems under Windows and Linux.



---

archive/issue_comments_213569.json:
```json
{
    "body": "use \\text{\\texttt{...}}",
    "created_at": "2013-07-26T04:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213569",
    "user": "https://github.com/jhpalmieri"
}
```

use \text{\texttt{...}}



---

archive/attachments_019410.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14382-texttt.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14382/trac_14382-texttt.patch",
    "created_at": "2013-07-26T04:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_213570.json:
```json
{
    "body": "for review only: diff between previous patches and texttt patch",
    "created_at": "2013-07-26T04:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213570",
    "user": "https://github.com/jhpalmieri"
}
```

for review only: diff between previous patches and texttt patch



---

archive/attachments_019411.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14382-delta.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14382/trac_14382-delta.patch",
    "created_at": "2013-07-26T04:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_213571.json:
```json
{
    "body": "<a id='comment:32'></a>\nLooks okay except that `\\tt` [is an obsolete command](http://www.ctan.org/tex-archive/info/l2tabu/), and `\\texttt` should be used instead. I've attached a new patch which does this, along with a `delta` patch which shows the difference between my patch and your two patches. All tests pass for me and the output looks the same as with `\\tt`.",
    "created_at": "2013-07-26T04:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213571",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>
Looks okay except that `\tt` [is an obsolete command](http://www.ctan.org/tex-archive/info/l2tabu/), and `\texttt` should be used instead. I've attached a new patch which does this, along with a `delta` patch which shows the difference between my patch and your two patches. All tests pass for me and the output looks the same as with `\tt`.



---

archive/issue_comments_213572.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,3 @@\n #11498 made \"ASCII-art\" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.\n \n-**Apply** [attachment:trac_14382_fix_latex_of_strings.patch] and [attachment:trac_14382_doctests.patch]\n-\n-\n+Apply [attachment:trac_14382-texttt.patch].\n``````\n",
    "created_at": "2013-07-26T04:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213572",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,3 @@
 #11498 made "ASCII-art" strings look reasonably well when displayed via LaTeX methods. One of the changes was damaged in #9774, resulting in invalid LaTeX code that works in MathJax, but not in SageTeX. Let's fix it again.
 
-**Apply** [attachment:trac_14382_fix_latex_of_strings.patch] and [attachment:trac_14382_doctests.patch]
-
-
+Apply [attachment:trac_14382-texttt.patch].
``````




---

archive/issue_comments_213573.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2013-07-26T06:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213573",
    "user": "https://github.com/novoselt"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_213574.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-07-26T06:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213574",
    "user": "https://github.com/novoselt"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_213575.json:
```json
{
    "body": "<a id='comment:33'></a>\nWow, I thought LaTeX is once and for all and only new things can appear without obsolescence! Will keep it in mind for the future, changes are fine with me!",
    "created_at": "2013-07-26T06:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213575",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:33'></a>
Wow, I thought LaTeX is once and for all and only new things can appear without obsolescence! Will keep it in mind for the future, changes are fine with me!



---

archive/issue_events_047330.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-29T11:07:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14382#event-47330"
}
```



---

archive/issue_comments_213576.json:
```json
{
    "body": "<a id='comment:35'></a>\nApply trac_14382-texttt.patch\u200b",
    "created_at": "2013-08-19T18:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213576",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:35'></a>
Apply trac_14382-texttt.patch​



---

archive/issue_comments_213577.json:
```json
{
    "body": "**Merged:** sage-5.12.beta3",
    "created_at": "2013-08-20T12:55:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14382#issuecomment-213577",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.12.beta3



---

archive/issue_events_047331.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-20T12:55:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14382",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14382#event-47331"
}
```
