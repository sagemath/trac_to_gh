# Issue 14706: Upgrade R to version 3.0.2

archive/issues_014502.json:
```json
{
    "body": "Assignee: @jdemeyer\n\nCC:  snark\n\nKeywords: r-project spkg\n\n**New spkg**: [http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.2.p0.spkg](http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.2.p0.spkg)\n\n### r-3.0.2.p0 (Jean-Pierre Flori, 30 October 2013)\n* #14706: update to 3.0.2.\n* Remove sqrtl.patch which is now upstream.\n* Move old install on OS X.\n* Fix visibility of symbols in built-in libintl.\n\n### r-3.0.1.p1 (Jean-Pierre Flori, 10 June 2013)\n* #14706: Use --disable-long-double on Cygwin rather than patching.\n* Add sqrtl.patch from upstream to make --disable-long-double work.\n\n### r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013)\n* #14706: Drop-in replacement of upstream sources.\n\n---\n\n**Apply:** [attachment:trac_14706-version.patch]\n\nIssue created by migration from https://trac.sagemath.org/ticket/14706\n\n",
    "closed_at": "2013-11-24T09:22:54Z",
    "created_at": "2013-06-08T19:19:55Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "Upgrade R to version 3.0.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14706",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
Assignee: @jdemeyer

CC:  snark

Keywords: r-project spkg

**New spkg**: [http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.2.p0.spkg](http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.2.p0.spkg)

### r-3.0.2.p0 (Jean-Pierre Flori, 30 October 2013)
* #14706: update to 3.0.2.
* Remove sqrtl.patch which is now upstream.
* Move old install on OS X.
* Fix visibility of symbols in built-in libintl.

### r-3.0.1.p1 (Jean-Pierre Flori, 10 June 2013)
* #14706: Use --disable-long-double on Cygwin rather than patching.
* Add sqrtl.patch from upstream to make --disable-long-double work.

### r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013)
* #14706: Drop-in replacement of upstream sources.

---

**Apply:** [attachment:trac_14706-version.patch]

Issue created by migration from https://trac.sagemath.org/ticket/14706





---

archive/issue_comments_183376.json:
```json
{
    "body": "For the record:  Removing `-L$SAGE_LOCAL/lib` from `LDFLAGS` (#13443) recently broke building R on CentOS, cf. [http://trac.sagemath.org/sage_trac/ticket/13443#comment:12](http://trac.sagemath.org/sage_trac/ticket/13443#comment:12) and sage-devel.",
    "created_at": "2013-06-08T19:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183376",
    "user": "https://github.com/nexttime"
}
```

For the record:  Removing `-L$SAGE_LOCAL/lib` from `LDFLAGS` (#13443) recently broke building R on CentOS, cf. [http://trac.sagemath.org/sage_trac/ticket/13443#comment:12](http://trac.sagemath.org/sage_trac/ticket/13443#comment:12) and sage-devel.



---

archive/issue_comments_183377.json:
```json
{
    "body": "Changing keywords from \"r-project\" to \"r-project spkg\".",
    "created_at": "2013-06-08T19:51:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183377",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "r-project" to "r-project spkg".



---

archive/issue_comments_183378.json:
```json
{
    "body": "Replying to [ticket:14706 charpent]:\n> This ticket is a place where I plan to send new updates to the R version used in Sage (R is, in principle, updated every six months). So I intend to open, close, reopen... as long as newer versions **do not entail any substantial modification** beyond dropping new R source in place and fixing the expected version numbers in the r.py doctest. Any further problems should be reported in **specific** tickets. As a new R version arrives (and Real Life (TM) allowing), I'll start from the last accepted patch for this spkg...\n> \n> This is routine work (i. e. even I can do it:-), but using an up-to-date R interpreter is a *sine qua no*n for reporting problems to R core, so it probably has to be done for Sage users to get answers from R core.\n\nI honestly don't understand anything of this ticket description. What is this ticket about???",
    "created_at": "2013-06-08T19:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183378",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:14706 charpent]:
> This ticket is a place where I plan to send new updates to the R version used in Sage (R is, in principle, updated every six months). So I intend to open, close, reopen... as long as newer versions **do not entail any substantial modification** beyond dropping new R source in place and fixing the expected version numbers in the r.py doctest. Any further problems should be reported in **specific** tickets. As a new R version arrives (and Real Life (TM) allowing), I'll start from the last accepted patch for this spkg...
> 
> This is routine work (i. e. even I can do it:-), but using an up-to-date R interpreter is a *sine qua no*n for reporting problems to R core, so it probably has to be done for Sage users to get answers from R core.

I honestly don't understand anything of this ticket description. What is this ticket about???



---

archive/issue_comments_183379.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> I honestly don't understand anything of this ticket description. What is this ticket about???\n\n\nAtm upgrading R to 3.0.1 it seems...",
    "created_at": "2013-06-08T20:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183379",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:3 jdemeyer]:
> I honestly don't understand anything of this ticket description. What is this ticket about???


Atm upgrading R to 3.0.1 it seems...



---

archive/issue_comments_183380.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-08T20:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183380",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_183381.json:
```json
{
    "body": "* **Status**\u00a0changed from\u00a0*new*\u00a0to\u00a0*needs_review*\n\n1) New spkg : available on Google drive (https://docs.google.com/file/d/0B1gfn4_V_wm3clctVFFhUnlINVU/edit?usp=sharing)\n\n2) What this ticket is about :\n\na) Having an up-to-date R is a sine qua non to get answers from R Core.\n\nb) R in Sage is rarely up to date (more talented Sage developers work on more important issues).\n\nc) Therefore, R-in-Sage users have trouble communicating with R Core\n\nd) I am able to create \"drop-in replacements\" of the R spkg, thus giving R-in-Sage users an up-to-date R, thus allowing them to get answers from R Core...\n\ne) Since this is routine work that few people seem to tackle, and since it is in my limited ability range, I'll try to do it after R upstream upgrades.\n\nIs that clearer ?",
    "created_at": "2013-06-08T20:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183381",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

* **Status** changed from *new* to *needs_review*

1) New spkg : available on Google drive (https://docs.google.com/file/d/0B1gfn4_V_wm3clctVFFhUnlINVU/edit?usp=sharing)

2) What this ticket is about :

a) Having an up-to-date R is a sine qua non to get answers from R Core.

b) R in Sage is rarely up to date (more talented Sage developers work on more important issues).

c) Therefore, R-in-Sage users have trouble communicating with R Core

d) I am able to create "drop-in replacements" of the R spkg, thus giving R-in-Sage users an up-to-date R, thus allowing them to get answers from R Core...

e) Since this is routine work that few people seem to tackle, and since it is in my limited ability range, I'll try to do it after R upstream upgrades.

Is that clearer ?



---

archive/issue_comments_183382.json:
```json
{
    "body": "Replying to [comment:5 charpent]:\n> Is that clearer ?\n\nWhy not just say \"Upgrade R to version 3.0.1\" like leif said?\n\nFor the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...\n\nAlso: fill in your real name as Author.",
    "created_at": "2013-06-08T20:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183382",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 charpent]:
> Is that clearer ?

Why not just say "Upgrade R to version 3.0.1" like leif said?

For the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...

Also: fill in your real name as Author.



---

archive/issue_comments_183383.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-06-08T20:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183383",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_183384.json:
```json
{
    "body": "Replying to [comment:8 jdemeyer]:\n> For the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...\n\n\nThere's btw. [http://spkg-upload.googlecode.com](http://spkg-upload.googlecode.com)...",
    "created_at": "2013-06-08T20:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183384",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:8 jdemeyer]:
> For the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...


There's btw. [http://spkg-upload.googlecode.com](http://spkg-upload.googlecode.com)...



---

archive/issue_comments_183385.json:
```json
{
    "body": "... and feel free to add yourself to the [list of developers on the Sage wiki](http://trac.sagemath.org/sage_trac/wiki#AccountNamesMappedtoRealNames).",
    "created_at": "2013-06-08T20:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183385",
    "user": "https://github.com/nexttime"
}
```

... and feel free to add yourself to the [list of developers on the Sage wiki](http://trac.sagemath.org/sage_trac/wiki#AccountNamesMappedtoRealNames).



---

archive/issue_comments_183386.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-06-09T08:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183386",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_183387.json:
```json
{
    "body": "Replying to [comment:8 jdemeyer]:\n\n> Replying to [comment:5 charpent]  :\n> > Is that clearer ?\n\n> Why not just say \"Upgrade R to version 3.0.1\" like leif said?\nBecause I intend to re-open/re-close it as upstream  spits out new versions... I see no point in cluttering the ticket stream with identical repeats of the same trivial point...\n> For the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...\n\nUpload in progress as I write this (I hadn't yet credentials for spkg-uploads)\n> Also: fill in your real name as Author.\n\nIf you say so...",
    "created_at": "2013-06-09T08:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183387",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:8 jdemeyer]:

> Replying to [comment:5 charpent]  :
> > Is that clearer ?

> Why not just say "Upgrade R to version 3.0.1" like leif said?
Because I intend to re-open/re-close it as upstream  spits out new versions... I see no point in cluttering the ticket stream with identical repeats of the same trivial point...
> For the spkg, I really need a URL to the spkg, not some link to some website where I have to click on something...

Upload in progress as I write this (I hadn't yet credentials for spkg-uploads)
> Also: fill in your real name as Author.

If you say so...



---

archive/issue_comments_183388.json:
```json
{
    "body": "Spkg uploaded to spkg-uploads :\n\nhttps://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=",
    "created_at": "2013-06-09T08:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183388",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Spkg uploaded to spkg-uploads :

https://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=



---

archive/issue_comments_183389.json:
```json
{
    "body": "Replying to [comment:11 charpent]:\n> Because I intend to re-open/re-close it as upstream  spits out new versions...\n\nThat's not allowed.  A closed ticket also serves as a reference for when a particular package was merged in a particular Sage version, and the comments show any issues which appeared. If different upgrades would happen on one ticket, that would be a mess.\n\nStandard practice is to create a new ticket for every upgrade. However, as long as the new package is not yet merged into Sage, you can change the ticket. Imagine that R 3.0.2 comes out today, you can change this ticket to upgrade to R 3.0.2 (since this ticket isn't merged yet).",
    "created_at": "2013-06-09T10:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183389",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 charpent]:
> Because I intend to re-open/re-close it as upstream  spits out new versions...

That's not allowed.  A closed ticket also serves as a reference for when a particular package was merged in a particular Sage version, and the comments show any issues which appeared. If different upgrades would happen on one ticket, that would be a mess.

Standard practice is to create a new ticket for every upgrade. However, as long as the new package is not yet merged into Sage, you can change the ticket. Imagine that R 3.0.2 comes out today, you can change this ticket to upgrade to R 3.0.2 (since this ticket isn't merged yet).



---

archive/issue_comments_183390.json:
```json
{
    "body": "Replying to [comment:12 charpent]:\n> Spkg uploaded to spkg-uploads :\n> \n> https://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=\n\n\nCould you please rename the file to r-3.0.1**.**p0.spkg?\n\n(IIRC, renaming isn't possible there, so that would mean: rename your local file, (re)upload it, and delete the old one there.)",
    "created_at": "2013-06-09T13:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183390",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:12 charpent]:
> Spkg uploaded to spkg-uploads :
> 
> https://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=


Could you please rename the file to r-3.0.1**.**p0.spkg?

(IIRC, renaming isn't possible there, so that would mean: rename your local file, (re)upload it, and delete the old one there.)



---

archive/issue_comments_183391.json:
```json
{
    "body": "Replying to [comment:16 leif]:\n> Replying to [comment:12 charpent]:\n> > Spkg uploaded to spkg-uploads :\n> > \n> > https://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=\n\n> \n> Could you please rename the file to r-3.0.1**.**p0.spkg?\n> \n> (IIRC, renaming isn't possible there, so that would mean: rename your local file, (re)upload it, and delete the old one there.)\n\n\nOh, forgot:\n\nYou'd of course have to repackage the spkg with the proper folder name first.",
    "created_at": "2013-06-09T15:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183391",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:16 leif]:
> Replying to [comment:12 charpent]:
> > Spkg uploaded to spkg-uploads :
> > 
> > https://code.google.com/p/spkg-upload/downloads/detail?name=r-3.0.1-p0.spkg&can=2&q=

> 
> Could you please rename the file to r-3.0.1**.**p0.spkg?
> 
> (IIRC, renaming isn't possible there, so that would mean: rename your local file, (re)upload it, and delete the old one there.)


Oh, forgot:

You'd of course have to repackage the spkg with the proper folder name first.



---

archive/issue_comments_183392.json:
```json
{
    "body": "... and change the changelog entry in `SPKG.txt` accordingly.\n\nRemove `SPKG.txt~`, and commit your changes...\n\n\n\n\nHaven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).\n\nEDIT: 27 MB that is, more than +33%",
    "created_at": "2013-06-09T15:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183392",
    "user": "https://github.com/nexttime"
}
```

... and change the changelog entry in `SPKG.txt` accordingly.

Remove `SPKG.txt~`, and commit your changes...




Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).

EDIT: 27 MB that is, more than +33%



---

archive/issue_comments_183393.json:
```json
{
    "body": "Replying to [comment:18 leif]:\n> Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).\n\n\nThere's a lot of redundant stuff in different src directories:\n\n```sh\n$ diff -qr --report r-3.0.1-p0/src/src/ r-3.0.1-p0/src/R-3.0.1/src/ | grep identical | wc -l\n1502\n```",
    "created_at": "2013-06-09T16:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183393",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:18 leif]:
> Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).


There's a lot of redundant stuff in different src directories:

```sh
$ diff -qr --report r-3.0.1-p0/src/src/ r-3.0.1-p0/src/R-3.0.1/src/ | grep identical | wc -l
1502
```



---

archive/issue_comments_183394.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-09T16:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183394",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183395.json:
```json
{
    "body": "I.e., `r-3.0.1-p0/src/R-3.0.1/src/` is a proper subset of `r-3.0.1-p0/src/src/`.",
    "created_at": "2013-06-09T16:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183395",
    "user": "https://github.com/nexttime"
}
```

I.e., `r-3.0.1-p0/src/R-3.0.1/src/` is a proper subset of `r-3.0.1-p0/src/src/`.



---

archive/issue_comments_183396.json:
```json
{
    "body": "Replying to [comment:20 leif]:\n> I.e., `r-3.0.1-p0/src/R-3.0.1/src/` is a proper subset of `r-3.0.1-p0/src/src/`.\n\n\nYep, `src/` is not vanilla:\n\n```sh\n$ diff -qr upstream/R-3.0.1/ r-3.0.1-p0/src/\nOnly in r-3.0.1-p0/src/: R-3.0.1\n```",
    "created_at": "2013-06-09T16:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183396",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:20 leif]:
> I.e., `r-3.0.1-p0/src/R-3.0.1/src/` is a proper subset of `r-3.0.1-p0/src/src/`.


Yep, `src/` is not vanilla:

```sh
$ diff -qr upstream/R-3.0.1/ r-3.0.1-p0/src/
Only in r-3.0.1-p0/src/: R-3.0.1
```



---

archive/issue_comments_183397.json:
```json
{
    "body": "Fixed, untested spkg for testing is here:\n\n[http://boxen.math.washington.edu/home/leif/Sage/spkgs/r-3.0.1.p0.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/r-3.0.1.p0.spkg)\n\n```\n27M\tr-3.0.1-p0.spkg\n22M\tr-3.0.1.p0.spkg\n```\n\n(Haven't committed the changes to `SPKG.txt`.)",
    "created_at": "2013-06-09T16:27:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183397",
    "user": "https://github.com/nexttime"
}
```

Fixed, untested spkg for testing is here:

[http://boxen.math.washington.edu/home/leif/Sage/spkgs/r-3.0.1.p0.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/r-3.0.1.p0.spkg)

```
27M	r-3.0.1-p0.spkg
22M	r-3.0.1.p0.spkg
```

(Haven't committed the changes to `SPKG.txt`.)



---

archive/issue_comments_183398.json:
```json
{
    "body": "P.S.: The `SPKG.txt` changelog entry should also contain the ticket number, which I haven't added (yet).",
    "created_at": "2013-06-09T16:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183398",
    "user": "https://github.com/nexttime"
}
```

P.S.: The `SPKG.txt` changelog entry should also contain the ticket number, which I haven't added (yet).



---

archive/issue_comments_183399.json:
```json
{
    "body": "Replying to [comment:18 leif]:\n> ... and change the changelog entry in `SPKG.txt` accordingly.\n> \n> Remove `SPKG.txt~`, and commit your changes...\n\n\nWups ! Done (and uploaded)... I oversaw the relevant part of the developer's guide (had to upload Mercurial : this can't be done from Sage AFAICT).\n\n> Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).\n> \n> EDIT: 27 MB that is, more than +33%\n\n\nNo explanation : R-3.0.1 is  a tag larger than R-2.15.2 but by about 2 MB. Your guess is about as good as mine...",
    "created_at": "2013-06-09T16:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183399",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:18 leif]:
> ... and change the changelog entry in `SPKG.txt` accordingly.
> 
> Remove `SPKG.txt~`, and commit your changes...


Wups ! Done (and uploaded)... I oversaw the relevant part of the developer's guide (had to upload Mercurial : this can't be done from Sage AFAICT).

> Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).
> 
> EDIT: 27 MB that is, more than +33%


No explanation : R-3.0.1 is  a tag larger than R-2.15.2 but by about 2 MB. Your guess is about as good as mine...



---

archive/issue_comments_183400.json:
```json
{
    "body": "Replying to [comment:19 leif]: comments 19 to 23\n\nLeif, you're too fast for me ! your changes might hve been overwrittent by mine, or vice-versa...\n\n> Replying to [comment:18 leif]:\n> > Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).\n\n> \n> There's a lot of redundant stuff in different src directories:\n> \n> ```\n> #!sh\n> $ diff -qr --report r-3.0.1-p0/src/src/ r-3.0.1-p0/src/R-3.0.1/src/ | grep identical | wc -l\n> 1502\n> ```\n\n\nI must have had a thinko (mental typo)...\n\nOK : shall I go back to this file, or will you take over ? We can't both try to do the same...",
    "created_at": "2013-06-09T16:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183400",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:19 leif]: comments 19 to 23

Leif, you're too fast for me ! your changes might hve been overwrittent by mine, or vice-versa...

> Replying to [comment:18 leif]:
> > Haven't yet investigated why, but the new spkg is also **much** larger than the previous one (27 MB vs. 20 MB).

> 
> There's a lot of redundant stuff in different src directories:
> 
> ```
> #!sh
> $ diff -qr --report r-3.0.1-p0/src/src/ r-3.0.1-p0/src/R-3.0.1/src/ | grep identical | wc -l
> 1502
> ```


I must have had a thinko (mental typo)...

OK : shall I go back to this file, or will you take over ? We can't both try to do the same...



---

archive/issue_comments_183401.json:
```json
{
    "body": "Replying to [comment:25 charpent]:\n> OK : shall I go back to this file, or will you take over ? We can't both try to do the same...\n\n\nWell, did you make any further changes besides\n\n```diff\ndiff --git a/SPKG.txt b/SPKG.txt\n--- a/SPKG.txt\n+++ b/SPKG.txt\n@@ -45,6 +45,9 @@\n \n == Changelog ==\n \n+=== r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013) ===\n+ * Drop-in replacement of upstream sources.\n+\n === r-2.15.2.p2 (John H. Palmieri, 17 March 2013) ===\n  * #9668: fix hardcoding of paths in R by defining R_SHARE_DIR,\n    R_INCLUDE_DIR, and R_DOC_DIR relative to R_HOME_DIR, or rather, by\n```\n(and removing the temporary editor file, restoring vanilla upstream in `src/`)?\n\nI can add the ticket number to the changelog and commit the changes, then we have a clean spkg ready for review / testing.",
    "created_at": "2013-06-09T16:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183401",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:25 charpent]:
> OK : shall I go back to this file, or will you take over ? We can't both try to do the same...


Well, did you make any further changes besides

```diff
diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -45,6 +45,9 @@
 
 == Changelog ==
 
+=== r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013) ===
+ * Drop-in replacement of upstream sources.
+
 === r-2.15.2.p2 (John H. Palmieri, 17 March 2013) ===
  * #9668: fix hardcoding of paths in R by defining R_SHARE_DIR,
    R_INCLUDE_DIR, and R_DOC_DIR relative to R_HOME_DIR, or rather, by
```
(and removing the temporary editor file, restoring vanilla upstream in `src/`)?

I can add the ticket number to the changelog and commit the changes, then we have a clean spkg ready for review / testing.



---

archive/issue_comments_183402.json:
```json
{
    "body": "Replying to [comment:26 leif]:\n> I can add the ticket number to the changelog and commit the changes, then we have a clean spkg ready for review / testing.\n\n\nOk, did so.\n\n```\nchangeset:   63:4e5b35a04f0f\ntag:         tip\nuser:        Leif Leonhardy <not.really@online.de>\ndate:        Sun Jun 09 10:08:09 2013 -0700\nfiles:       .hgtags\ndescription:\nAdded tag r-3.0.1.p0 for changeset 1965338a1840\n\n\nchangeset:   62:1965338a1840\ntag:         r-3.0.1.p0\nuser:        Emmanuel Charpentier <emm.charpentier@free.fr>\ndate:        Sun Jun 09 10:07:32 2013 -0700\nfiles:       SPKG.txt\ndescription:\n#14706 (r-3.0.1.p0): Upgrade to new upstream version 3.0.1\n\n### r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013)\n * #14706: Drop-in replacement of upstream sources.\n\n\nchangeset:   61:a9186d48ab63\nuser:        Jeroen Demeyer <jdemeyer@cage.ugent.be>\ndate:        Thu Apr 25 13:00:29 2013 +0000\nfiles:       .hgtags\ndescription:\nAdded tag r-2.15.2.p2 for changeset 485622df5b13\n```",
    "created_at": "2013-06-09T17:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183402",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:26 leif]:
> I can add the ticket number to the changelog and commit the changes, then we have a clean spkg ready for review / testing.


Ok, did so.

```
changeset:   63:4e5b35a04f0f
tag:         tip
user:        Leif Leonhardy <not.really@online.de>
date:        Sun Jun 09 10:08:09 2013 -0700
files:       .hgtags
description:
Added tag r-3.0.1.p0 for changeset 1965338a1840


changeset:   62:1965338a1840
tag:         r-3.0.1.p0
user:        Emmanuel Charpentier <emm.charpentier@free.fr>
date:        Sun Jun 09 10:07:32 2013 -0700
files:       SPKG.txt
description:
#14706 (r-3.0.1.p0): Upgrade to new upstream version 3.0.1

### r-3.0.1.p0 (Emmanuel Charpentier, 8 June 2013)
 * #14706: Drop-in replacement of upstream sources.


changeset:   61:a9186d48ab63
user:        Jeroen Demeyer <jdemeyer@cage.ugent.be>
date:        Thu Apr 25 13:00:29 2013 +0000
files:       .hgtags
description:
Added tag r-2.15.2.p2 for changeset 485622df5b13
```



---

archive/issue_comments_183403.json:
```json
{
    "body": "Diff between the previous spkg and the 3.0.1.p0.  For reference / review only.",
    "created_at": "2013-06-09T17:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183403",
    "user": "https://github.com/nexttime"
}
```

Diff between the previous spkg and the 3.0.1.p0.  For reference / review only.



---

archive/issue_comments_183404.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-09T17:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183404",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183405.json:
```json
{
    "body": "Attachment [r-2.15.2.p2-3.0.1.p0.diff](tarball://root/attachments/some-uuid/ticket14706/r-2.15.2.p2-3.0.1.p0.diff) by @nexttime created at 2013-06-09 17:20:41",
    "created_at": "2013-06-09T17:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183405",
    "user": "https://github.com/nexttime"
}
```

Attachment [r-2.15.2.p2-3.0.1.p0.diff](tarball://root/attachments/some-uuid/ticket14706/r-2.15.2.p2-3.0.1.p0.diff) by @nexttime created at 2013-06-09 17:20:41



---

archive/issue_comments_183406.json:
```json
{
    "body": "Hmmm, trac apparently doesn't like `#` in attachment filenames very much; it's IMHO a bad idea to use such anyway.",
    "created_at": "2013-06-09T17:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183406",
    "user": "https://github.com/nexttime"
}
```

Hmmm, trac apparently doesn't like `#` in attachment filenames very much; it's IMHO a bad idea to use such anyway.



---

archive/issue_comments_183407.json:
```json
{
    "body": "P.P.S.:\n\nWe should IMHO still address the readline / `LDFLAGS` issue (unless R meanwhile supports `--with-readline=<prefix>`);  that should be done in a `.p1` based on the `.p0`.",
    "created_at": "2013-06-09T17:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183407",
    "user": "https://github.com/nexttime"
}
```

P.P.S.:

We should IMHO still address the readline / `LDFLAGS` issue (unless R meanwhile supports `--with-readline=<prefix>`);  that should be done in a `.p1` based on the `.p0`.



---

archive/issue_comments_183408.json:
```json
{
    "body": "Replying to [comment:33 leif]:\n> P.P.S.:\n> \n> We should IMHO still address the readline / `LDFLAGS` issue (unless R meanwhile supports `--with-readline=<prefix>`);  that should be done in a `.p1` based on the `.p0`.\n\n\nHmmm... I do not know CentOS, but it sounds more like a CentOS configuration problem. Diferent assumptions about pre-loaded libraries ? I'm afraid that my knowledge of the relevant documents is a bit insufficient for this hunt... \n\nPS : I'll delete my (incorrect) spkg from spkg-uploads now.",
    "created_at": "2013-06-09T18:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183408",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:33 leif]:
> P.P.S.:
> 
> We should IMHO still address the readline / `LDFLAGS` issue (unless R meanwhile supports `--with-readline=<prefix>`);  that should be done in a `.p1` based on the `.p0`.


Hmmm... I do not know CentOS, but it sounds more like a CentOS configuration problem. Diferent assumptions about pre-loaded libraries ? I'm afraid that my knowledge of the relevant documents is a bit insufficient for this hunt... 

PS : I'll delete my (incorrect) spkg from spkg-uploads now.



---

archive/issue_comments_183409.json:
```json
{
    "body": "Replying to [comment:33 leif]:\n> ... unless R meanwhile supports `--with-readline=<prefix>`\n\n\nIt doesn't:\n\n```sh\n## Readline.\n\n# Check whether --with-readline was given.\nif test \"${with_readline+set}\" = set; then :\n  withval=$with_readline; if test \"${withval}\" = no; then\n  use_readline=no\nelse\n  use_readline=yes\nfi\n\nelse\n  use_readline=yes\nfi\n```",
    "created_at": "2013-06-09T18:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183409",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:33 leif]:
> ... unless R meanwhile supports `--with-readline=<prefix>`


It doesn't:

```sh
## Readline.

# Check whether --with-readline was given.
if test "${with_readline+set}" = set; then :
  withval=$with_readline; if test "${withval}" = no; then
  use_readline=no
else
  use_readline=yes
fi

else
  use_readline=yes
fi
```



---

archive/issue_comments_183410.json:
```json
{
    "body": "Replying to [comment:33 leif]:\n> We should IMHO still address the readline / `LDFLAGS` issue\n\n\nSee [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.",
    "created_at": "2013-06-09T19:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183410",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:33 leif]:
> We should IMHO still address the readline / `LDFLAGS` issue


See [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.



---

archive/issue_comments_183411.json:
```json
{
    "body": "New spkg builds for me (and passes its test suite with some \"noise\") on Linux x86_64, GCC 4.8.0, Sage 5.10.rc1.\n\nDoctests in `sage/interfaces/r.py` also pass with the attached patch.",
    "created_at": "2013-06-09T19:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183411",
    "user": "https://github.com/nexttime"
}
```

New spkg builds for me (and passes its test suite with some "noise") on Linux x86_64, GCC 4.8.0, Sage 5.10.rc1.

Doctests in `sage/interfaces/r.py` also pass with the attached patch.



---

archive/issue_comments_183412.json:
```json
{
    "body": "Replying to [comment:36 leif]:\n> Replying to [comment:33 leif]:\n> > We should IMHO still address the readline / `LDFLAGS` issue\n\n> \n> See [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.\n\n\nOk, this is IMHO rather unrelated to R, or more precisely, a general problem, caused by **ap**pending `$SAGE_LOCAL/lib` to `LIBRARY_PATH` instead of prepending, so I'll open a separate ticket for that.",
    "created_at": "2013-06-09T20:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183412",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:36 leif]:
> Replying to [comment:33 leif]:
> > We should IMHO still address the readline / `LDFLAGS` issue

> 
> See [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.


Ok, this is IMHO rather unrelated to R, or more precisely, a general problem, caused by **ap**pending `$SAGE_LOCAL/lib` to `LIBRARY_PATH` instead of prepending, so I'll open a separate ticket for that.



---

archive/issue_comments_183413.json:
```json
{
    "body": "Replying to [comment:38 leif]:\n> Replying to [comment:36 leif]:\n> > Replying to [comment:33 leif]:\n> > > We should IMHO still address the readline / `LDFLAGS` issue\n\n> > \n> > See [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.\n\n> \n> Ok, this is IMHO rather unrelated to R, or more precisely, a general problem, caused by **ap**pending `$SAGE_LOCAL/lib` to `LIBRARY_PATH` instead of prepending.\n\n\nOr maybe not (just).  Dropping `-L${SAGE_LOCAL}/lib` and abusing `LIBRARY_PATH` simply doesn't work, since GCC may add system folders to the library search path **before** those specified in `LIBRARY_PATH`.\n\nIt's rather luck that the error so far showed up on CentOS only; others appear to have either no or compatible readline versions installed system-wide.",
    "created_at": "2013-06-09T20:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183413",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:38 leif]:
> Replying to [comment:36 leif]:
> > Replying to [comment:33 leif]:
> > > We should IMHO still address the readline / `LDFLAGS` issue

> > 
> > See [http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1](http://groups.google.com/group/sage-devel/browse_thread/thread/5803a1cc05fe8a6e/e927d932b5d650e1#e927d932b5d650e1) ff. for the CentOS error report.

> 
> Ok, this is IMHO rather unrelated to R, or more precisely, a general problem, caused by **ap**pending `$SAGE_LOCAL/lib` to `LIBRARY_PATH` instead of prepending.


Or maybe not (just).  Dropping `-L${SAGE_LOCAL}/lib` and abusing `LIBRARY_PATH` simply doesn't work, since GCC may add system folders to the library search path **before** those specified in `LIBRARY_PATH`.

It's rather luck that the error so far showed up on CentOS only; others appear to have either no or compatible readline versions installed system-wide.



---

archive/issue_comments_183414.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-10T08:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183414",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183415.json:
```json
{
    "body": "I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.",
    "created_at": "2013-06-10T08:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183415",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.



---

archive/issue_comments_183416.json:
```json
{
    "body": "Replying to [comment:40 jpflori]:\n> I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.\n\n\nCan you create a `.p1` and test that on Cygwin?\n\n(Interestingly, the patches still apply, modulo offsets for the patch to `configure`, which IMHO aren't worth fixing, since that just bloats Mercurial history).\n\nAnd if so, also change `--with-readline=...` to `--with-readline=yes`, with a remark that only yes/no is supported.\n\n[P.S.: Just noticed the Cygwin patch is indeed very unlikely to no longer apply... B) ]",
    "created_at": "2013-06-10T13:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183416",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:40 jpflori]:
> I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.


Can you create a `.p1` and test that on Cygwin?

(Interestingly, the patches still apply, modulo offsets for the patch to `configure`, which IMHO aren't worth fixing, since that just bloats Mercurial history).

And if so, also change `--with-readline=...` to `--with-readline=yes`, with a remark that only yes/no is supported.

[P.S.: Just noticed the Cygwin patch is indeed very unlikely to no longer apply... B) ]



---

archive/issue_comments_183417.json:
```json
{
    "body": "Replying to [comment:41 leif]:\n> Replying to [comment:40 jpflori]:\n> > I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.\n\n> \n> Can you create a `.p1` and test that on Cygwin?\n\n\n(I mean I could do that as well, but that doesn't make *much* sense, since I cannot test it.)",
    "created_at": "2013-06-10T13:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183417",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:41 leif]:
> Replying to [comment:40 jpflori]:
> > I think there is now a --disable-long-double option to pass to configure which should be used on Cygwin rather than our patch which at some point will surely miss some parts of R code.

> 
> Can you create a `.p1` and test that on Cygwin?


(I mean I could do that as well, but that doesn't make *much* sense, since I cannot test it.)



---

archive/issue_comments_183418.json:
```json
{
    "body": "P.P.S.:  Are `long double` functions a general problem on Cygwin?  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...",
    "created_at": "2013-06-10T13:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183418",
    "user": "https://github.com/nexttime"
}
```

P.P.S.:  Are `long double` functions a general problem on Cygwin?  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...



---

archive/issue_comments_183419.json:
```json
{
    "body": "Replying to [comment:43 leif]:\n> P.P.S.:  Are `long double` functions a general problem on Cygwin?\n\nYes, Cygwin libm has no long double functions.\n>  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...\n\nThat's the point, we want to disable all uses of long double in R, I cannot say that the only place it is currently used in 3.0.1 is with this logl() call, nor if that will be the case in future version of R.\nSo using --disable-long-double is safer.\nOr we should reenable Cephes on Cygwin to provide long double functions but I cannot say if that will be easy or not.",
    "created_at": "2013-06-10T15:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183419",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:43 leif]:
> P.P.S.:  Are `long double` functions a general problem on Cygwin?

Yes, Cygwin libm has no long double functions.
>  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...

That's the point, we want to disable all uses of long double in R, I cannot say that the only place it is currently used in 3.0.1 is with this logl() call, nor if that will be the case in future version of R.
So using --disable-long-double is safer.
Or we should reenable Cephes on Cygwin to provide long double functions but I cannot say if that will be easy or not.



---

archive/issue_comments_183420.json:
```json
{
    "body": "Replying to [comment:44 jpflori]:\n> Replying to [comment:43 leif]:\n> >  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...\n\n> That's the point, we want to disable all uses of long double in R\n\nThat was my question (whether doing so was intended; the basic operations on long doubles are provided by GCC / libgcc) ... ;-)\n\n\n\n\nAre you going to create a new spkg?",
    "created_at": "2013-06-10T16:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183420",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:44 jpflori]:
> Replying to [comment:43 leif]:
> >  For R, we currently just rename `logl()`, so using `--disable-long-double` may have other impacts I don't know...

> That's the point, we want to disable all uses of long double in R

That was my question (whether doing so was intended; the basic operations on long doubles are provided by GCC / libgcc) ... ;-)




Are you going to create a new spkg?



---

archive/issue_comments_183421.json:
```json
{
    "body": "I'll try tonight.",
    "created_at": "2013-06-10T16:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183421",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'll try tonight.



---

archive/issue_comments_183422.json:
```json
{
    "body": "Spkg at:\n* http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.1.p1.spkg\nbut it doesn't build because it seems an sqrtl function is still used.",
    "created_at": "2013-06-10T21:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183422",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Spkg at:
* http://boxen.math.washington.edu/home/jpflori/spkg/r-3.0.1.p1.spkg
but it doesn't build because it seems an sqrtl function is still used.



---

archive/issue_comments_183423.json:
```json
{
    "body": "New spkg currently uploading with a new patch to fix --disable-long-double.",
    "created_at": "2013-06-10T22:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183423",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

New spkg currently uploading with a new patch to fix --disable-long-double.



---

archive/issue_comments_183424.json:
```json
{
    "body": "The patch does not work, I'll try to fix it tomorrow.",
    "created_at": "2013-06-10T22:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183424",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

The patch does not work, I'll try to fix it tomorrow.



---

archive/issue_comments_183425.json:
```json
{
    "body": "According to http://developer.r-project.org/R_svnlog_2013, there is:\n\n```\nr62832 | ripley | 2013-05-29 11:26:12 -0400 (Wed, 29 May 2013) | 1 line\nChanged paths:\n   M /trunk/src/library/stats/src/cov.c\n\navoid sqrtl (PR#15326)\n```\nJust have to find a way to get the commit without mirroring the R svn.",
    "created_at": "2013-06-11T08:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183425",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

According to http://developer.r-project.org/R_svnlog_2013, there is:

```
r62832 | ripley | 2013-05-29 11:26:12 -0400 (Wed, 29 May 2013) | 1 line
Changed paths:
   M /trunk/src/library/stats/src/cov.c

avoid sqrtl (PR#15326)
```
Just have to find a way to get the commit without mirroring the R svn.



---

archive/issue_comments_183426.json:
```json
{
    "body": "Upstream bug report here:\nhttps://bugs.r-project.org/bugzilla3/show_bug.cgi?id=15326",
    "created_at": "2013-06-11T08:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183426",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Upstream bug report here:
https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=15326



---

archive/issue_comments_183427.json:
```json
{
    "body": "Ok, new spkg with upstream fix.\nNo Cygwin install on my hand right now, I'll test it tonight, but it really seems ok.\n\nNot sure the license info is correct.",
    "created_at": "2013-06-11T09:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183427",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Ok, new spkg with upstream fix.
No Cygwin install on my hand right now, I'll test it tonight, but it really seems ok.

Not sure the license info is correct.



---

archive/issue_comments_183428.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-11T09:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183428",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183429.json:
```json
{
    "body": "Attachment [14706_R_3.0.1.patch](tarball://root/attachments/some-uuid/ticket14706/14706_R_3.0.1.patch) by @jdemeyer created at 2013-06-11 11:13:14",
    "created_at": "2013-06-11T11:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183429",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14706_R_3.0.1.patch](tarball://root/attachments/some-uuid/ticket14706/14706_R_3.0.1.patch) by @jdemeyer created at 2013-06-11 11:13:14



---

archive/issue_comments_183430.json:
```json
{
    "body": "Attachment [r-3.0.1.p1.diff](tarball://root/attachments/some-uuid/ticket14706/r-3.0.1.p1.diff) by @jdemeyer created at 2013-06-11 11:16:37\n\nSpkg diff, for review only.",
    "created_at": "2013-06-11T11:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183430",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [r-3.0.1.p1.diff](tarball://root/attachments/some-uuid/ticket14706/r-3.0.1.p1.diff) by @jdemeyer created at 2013-06-11 11:16:37

Spkg diff, for review only.



---

archive/issue_comments_183431.json:
```json
{
    "body": "Committed spkg changes.",
    "created_at": "2013-06-11T11:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183431",
    "user": "https://github.com/jdemeyer"
}
```

Committed spkg changes.



---

archive/issue_comments_183432.json:
```json
{
    "body": "Thanks, I have some trouble correctly running hg addremove...",
    "created_at": "2013-06-11T12:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183432",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Thanks, I have some trouble correctly running hg addremove...



---

archive/issue_comments_183433.json:
```json
{
    "body": "Just want to approve of the long double fix, I think that is the right thing for now.  I'm excited that this might get in.",
    "created_at": "2013-06-11T15:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183433",
    "user": "https://github.com/kcrisman"
}
```

Just want to approve of the long double fix, I think that is the right thing for now.  I'm excited that this might get in.



---

archive/issue_comments_183434.json:
```json
{
    "body": "Okay, let's go for it.",
    "created_at": "2013-06-11T15:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183434",
    "user": "https://github.com/jdemeyer"
}
```

Okay, let's go for it.



---

archive/issue_comments_183435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-06-11T15:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183435",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_183436.json:
```json
{
    "body": "Note: that doesn't mean I *tested* it (on Cygwin or anywhere else), just that *if* JP et al. did test it, then I can confirm that this is the 'right' way to deal with this in our Cygwin experience.",
    "created_at": "2013-06-11T15:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183436",
    "user": "https://github.com/kcrisman"
}
```

Note: that doesn't mean I *tested* it (on Cygwin or anywhere else), just that *if* JP et al. did test it, then I can confirm that this is the 'right' way to deal with this in our Cygwin experience.



---

archive/issue_comments_183437.json:
```json
{
    "body": "Replying to [comment:52 jpflori]:\n> Not sure the license info is correct.\n\n\nAFAICS, R is (meanwhile) GNU GPLv2 **or** GPLv3 (but not v2+; some parts are LGPL'ed).\n\n(I don't see any related change to `SPKG.txt`, which stated \"GPL 2 (2.15.2 release)\".)",
    "created_at": "2013-06-11T16:05:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183437",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:52 jpflori]:
> Not sure the license info is correct.


AFAICS, R is (meanwhile) GNU GPLv2 **or** GPLv3 (but not v2+; some parts are LGPL'ed).

(I don't see any related change to `SPKG.txt`, which stated "GPL 2 (2.15.2 release)".)



---

archive/issue_comments_183438.json:
```json
{
    "body": "Replying to [comment:59 leif]:\n> Replying to [comment:52 jpflori]:\n> > Not sure the license info is correct.\n\n> \n> AFAICS, R is (meanwhile) GNU GPLv2 **or** GPLv3 (but not v2+; some parts are LGPL'ed).\n\n\n```\nCHANGES IN R VERSION 2.13.1:\n\n  ...\n\n  LICENCE:\n\n    o No parts of R are now licensed solely under GPL-2.  The licences\n      for packages rpart and survival have been changed, which means\n      that the licence terms for R as distributed are GPL-2 | GPL-3.\n\n```\n(from `NEWS`)",
    "created_at": "2013-06-11T16:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183438",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:59 leif]:
> Replying to [comment:52 jpflori]:
> > Not sure the license info is correct.

> 
> AFAICS, R is (meanwhile) GNU GPLv2 **or** GPLv3 (but not v2+; some parts are LGPL'ed).


```
CHANGES IN R VERSION 2.13.1:

  ...

  LICENCE:

    o No parts of R are now licensed solely under GPL-2.  The licences
      for packages rpart and survival have been changed, which means
      that the licence terms for R as distributed are GPL-2 | GPL-3.

```
(from `NEWS`)



---

archive/issue_comments_183439.json:
```json
{
    "body": "I can confirm it now compiles on Cygwin (32 bits).",
    "created_at": "2013-06-11T21:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183439",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I can confirm it now compiles on Cygwin (32 bits).



---

archive/issue_comments_183440.json:
```json
{
    "body": "OK, made this change to the spkg:\n\n```diff\njdemeyer@boxen:~/spkg/r-3.0.1.p1$ hg diff\ndiff --git a/SPKG.txt b/SPKG.txt\n--- a/SPKG.txt\n+++ b/SPKG.txt\n@@ -11,7 +11,7 @@\n (taken from http://www.r-project.org/)\n \n == License ==\n- * GPL 2 (2.15.2 release)\n+ * GPL v2 or GPL v3\n \n == SPKG Maintainers ==\n \n```",
    "created_at": "2013-06-12T07:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183440",
    "user": "https://github.com/jdemeyer"
}
```

OK, made this change to the spkg:

```diff
jdemeyer@boxen:~/spkg/r-3.0.1.p1$ hg diff
diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -11,7 +11,7 @@
 (taken from http://www.r-project.org/)
 
 == License ==
- * GPL 2 (2.15.2 release)
+ * GPL v2 or GPL v3
 
 == SPKG Maintainers ==
 
```



---

archive/issue_comments_183441.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-15T12:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183441",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_042114.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-15T12:21:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14706#event-42114"
}
```



---

archive/issue_comments_183442.json:
```json
{
    "body": "There are some problems with upgrading on OS X:\n\n```\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c text.c -o text.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c init.c -o init.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c Rmd5.c -o Rmd5.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c md5.c -o md5.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c signals.c -o signals.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c install.c -o install.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c getfmts.c -o getfmts.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c http.c -o http.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c gramLatex.c -o gramLatex.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c gramRd.c -o gramRd.o\ngcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -o tools.so text.o init.o Rmd5.o md5.o signals.o install.o getfmts.o http.o gramLatex.o gramRd.o -L../../../../lib -lR -dylib_file libRblas.dylib:../../../../lib/libRblas.dylib -Wl,-framework -Wl,CoreFoundation\nmake[8]: `Makedeps' is up to date.\nmkdir ../../../../library/tools/libs\ndyld: Library not loaded: libR.dylib\n  Referenced from: /Users/dehayebuildbot/build/sage/dehaye/dehaye_upgrade_5.4.1/build/sage-5.11.beta1/spkg/build/r-3.0.1.p1/src/bin/exec/R\n  Reason: Incompatible library version: R requires version 3.0.0 or later, but libR.dylib provides version 2.14.0\n/bin/sh: line 1: 83314 Done                    echo \"tools:::.install_package_description('.', '\"../../../library/tools\"')\"\n     83315 Trace/BPT trap: 5       | R_DEFAULT_PACKAGES=NULL ../../../bin/R --vanilla --slave > /dev/null\nmake[5]: *** [all] Error 133\nmake[4]: *** [R] Error 1\nmake[3]: *** [R] Error 1\nmake[2]: *** [R] Error 1\nError building R.\n```",
    "created_at": "2013-06-16T09:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183442",
    "user": "https://github.com/jdemeyer"
}
```

There are some problems with upgrading on OS X:

```
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c text.c -o text.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c init.c -o init.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c Rmd5.c -o Rmd5.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c md5.c -o md5.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c signals.c -o signals.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c install.c -o install.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c getfmts.c -o getfmts.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c http.c -o http.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c gramLatex.c -o gramLatex.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/main     -fPIC  -g -O2   -c gramRd.c -o gramRd.o
gcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -o tools.so text.o init.o Rmd5.o md5.o signals.o install.o getfmts.o http.o gramLatex.o gramRd.o -L../../../../lib -lR -dylib_file libRblas.dylib:../../../../lib/libRblas.dylib -Wl,-framework -Wl,CoreFoundation
make[8]: `Makedeps' is up to date.
mkdir ../../../../library/tools/libs
dyld: Library not loaded: libR.dylib
  Referenced from: /Users/dehayebuildbot/build/sage/dehaye/dehaye_upgrade_5.4.1/build/sage-5.11.beta1/spkg/build/r-3.0.1.p1/src/bin/exec/R
  Reason: Incompatible library version: R requires version 3.0.0 or later, but libR.dylib provides version 2.14.0
/bin/sh: line 1: 83314 Done                    echo "tools:::.install_package_description('.', '"../../../library/tools"')"
     83315 Trace/BPT trap: 5       | R_DEFAULT_PACKAGES=NULL ../../../bin/R --vanilla --slave > /dev/null
make[5]: *** [all] Error 133
make[4]: *** [R] Error 1
make[3]: *** [R] Error 1
make[2]: *** [R] Error 1
Error building R.
```



---

archive/issue_comments_183443.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2013-06-16T09:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183443",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_183444.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2013-06-16T09:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183444",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_042115.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-16T09:16:16Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14706#event-42115"
}
```



---

archive/issue_comments_183445.json:
```json
{
    "body": "The solution seems to be to remove `local/lib/R` before rebuilding R.",
    "created_at": "2013-06-16T09:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183445",
    "user": "https://github.com/jdemeyer"
}
```

The solution seems to be to remove `local/lib/R` before rebuilding R.



---

archive/issue_comments_183446.json:
```json
{
    "body": "Replying to [comment:65 jdemeyer]:\n> The solution seems to be to remove `local/lib/R` before rebuilding R.\n\n\nMaybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?",
    "created_at": "2013-06-16T15:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183446",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:65 jdemeyer]:
> The solution seems to be to remove `local/lib/R` before rebuilding R.


Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?



---

archive/issue_comments_183447.json:
```json
{
    "body": "Replying to [comment:66 jhpalmieri]:\n> Replying to [comment:65 jdemeyer]:\n> > The solution seems to be to remove `local/lib/R` before rebuilding R.\n\n> \n> Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?\n\n\nOr mess with `DYLD_LIBRARY_PATH`... (in `spkg-install`, during the build of R, that is)",
    "created_at": "2013-06-16T16:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183447",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:66 jhpalmieri]:
> Replying to [comment:65 jdemeyer]:
> > The solution seems to be to remove `local/lib/R` before rebuilding R.

> 
> Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?


Or mess with `DYLD_LIBRARY_PATH`... (in `spkg-install`, during the build of R, that is)



---

archive/issue_comments_183448.json:
```json
{
    "body": "Replying to [comment:67 leif]:\n> Replying to [comment:66 jhpalmieri]:\n> > Replying to [comment:65 jdemeyer]:\n> > > The solution seems to be to remove `local/lib/R` before rebuilding R.\n\n> > \n> > Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?\n\n> \n> Or mess with `DYLD_LIBRARY_PATH`... (in `spkg-install`, during the build of R, that is)\n\n\nInstead of prepending some path of the R *build tree*, perhaps better simply remove `$SAGE_LOCAL/lib/R` from `[DY]LD_LIBRARY_PATH`...",
    "created_at": "2013-06-16T16:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183448",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:67 leif]:
> Replying to [comment:66 jhpalmieri]:
> > Replying to [comment:65 jdemeyer]:
> > > The solution seems to be to remove `local/lib/R` before rebuilding R.

> > 
> > Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?

> 
> Or mess with `DYLD_LIBRARY_PATH`... (in `spkg-install`, during the build of R, that is)


Instead of prepending some path of the R *build tree*, perhaps better simply remove `$SAGE_LOCAL/lib/R` from `[DY]LD_LIBRARY_PATH`...



---

archive/issue_comments_183449.json:
```json
{
    "body": "Replying to [comment:66 jhpalmieri]:\n> Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?\n\nI would vote for the simple solution of simply removing `local/lib/R`. Why make it more complicated than that?",
    "created_at": "2013-06-16T19:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183449",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:66 jhpalmieri]:
> Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?

I would vote for the simple solution of simply removing `local/lib/R`. Why make it more complicated than that?



---

archive/issue_comments_183450.json:
```json
{
    "body": "Replying to [comment:69 jdemeyer]:\n> Replying to [comment:66 jhpalmieri]:\n> > Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?\n\n> I would vote for the simple solution of simply removing `local/lib/R`. Why make it more complicated than that?\n\nWell, temporarily renaming isn't much harder (you only have to make sure the previous state gets restored in case installation fails, and, less important, to delete the old installation in case of success).\n\nDeleting the old installation before building the new version has succeeded is ... -- bad.",
    "created_at": "2013-06-16T19:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183450",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:69 jdemeyer]:
> Replying to [comment:66 jhpalmieri]:
> > Maybe rename it instead, then rebuild R. If the build is successful, delete the old version, and if the build fails, restore the old one?

> I would vote for the simple solution of simply removing `local/lib/R`. Why make it more complicated than that?

Well, temporarily renaming isn't much harder (you only have to make sure the previous state gets restored in case installation fails, and, less important, to delete the old installation in case of success).

Deleting the old installation before building the new version has succeeded is ... -- bad.



---

archive/issue_comments_183451.json:
```json
{
    "body": "P.S.:  But I'd prefer to simply remove the old R lib dir from `[DY]LD_LIBRARY_PATH` -- it doesn't make any sense to have it there when (a new) R (version) gets built, other than potentially causing problems.",
    "created_at": "2013-06-16T19:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183451",
    "user": "https://github.com/nexttime"
}
```

P.S.:  But I'd prefer to simply remove the old R lib dir from `[DY]LD_LIBRARY_PATH` -- it doesn't make any sense to have it there when (a new) R (version) gets built, other than potentially causing problems.



---

archive/issue_comments_183452.json:
```json
{
    "body": "Replying to [comment:71 leif]:\n> P.S.:  But I'd prefer to simply remove the old R lib dir from `[DY]LD_LIBRARY_PATH` -- it doesn't make any sense to have it there when (a new) R (version) gets built, other than potentially causing problems.\n\n\nP.P.S.:  I would even guess that's an upstream bug; R at least used to mess around with `LD_LIBRARY_PATH` -- presumably also to avoid such problems (which don't happen on Linux); they probably just missed `DYLD_LIBRARY_PATH` on Darwin...",
    "created_at": "2013-06-16T19:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183452",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:71 leif]:
> P.S.:  But I'd prefer to simply remove the old R lib dir from `[DY]LD_LIBRARY_PATH` -- it doesn't make any sense to have it there when (a new) R (version) gets built, other than potentially causing problems.


P.P.S.:  I would even guess that's an upstream bug; R at least used to mess around with `LD_LIBRARY_PATH` -- presumably also to avoid such problems (which don't happen on Linux); they probably just missed `DYLD_LIBRARY_PATH` on Darwin...



---

archive/issue_comments_183453.json:
```json
{
    "body": "I'm not sure its an upstream bug after a quick look at R sources, maybe just us messing around with DYLD_LIBRARY_PATH.",
    "created_at": "2013-07-10T14:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183453",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'm not sure its an upstream bug after a quick look at R sources, maybe just us messing around with DYLD_LIBRARY_PATH.



---

archive/issue_comments_183454.json:
```json
{
    "body": "Messing around with the dynamic library mechanism does not seem to be such a great idea. \u00a0The 3.0.1.p1 patch gives (on Debian amd64 testing) an executable which is unable to install some packages using external libraries ( among them tcl/tk, curl, sqlite3 and more important, cpp libraries). I had oddles of trouble trying to install packages depending on\u00a0RcppArmadillo. Reverting to the 3.0.1.p0 patch solved this problem.\n\nI'd be sorely tempted to change the status to \"needs work\" ... if I knew how to do this.\n\nI'd like to recommend :\n\n1. to keep the (simple) fix to get the 3.0.1 sources (which, AFAIU, compile fine on Unices and Mac OS X) and leave the dynamic library gizmoes alone, and\n2. to open ***another*** ticket for the dynamic library issues, which, if I understand the history, aim to compile this cleanly on cygwin.\n\n\n\nHTH,\n\n          Emmanuel Charpentier",
    "created_at": "2013-07-15T15:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183454",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Messing around with the dynamic library mechanism does not seem to be such a great idea.  The 3.0.1.p1 patch gives (on Debian amd64 testing) an executable which is unable to install some packages using external libraries ( among them tcl/tk, curl, sqlite3 and more important, cpp libraries). I had oddles of trouble trying to install packages depending on RcppArmadillo. Reverting to the 3.0.1.p0 patch solved this problem.

I'd be sorely tempted to change the status to "needs work" ... if I knew how to do this.

I'd like to recommend :

1. to keep the (simple) fix to get the 3.0.1 sources (which, AFAIU, compile fine on Unices and Mac OS X) and leave the dynamic library gizmoes alone, and
2. to open ***another*** ticket for the dynamic library issues, which, if I understand the history, aim to compile this cleanly on cygwin.



HTH,

          Emmanuel Charpentier



---

archive/issue_comments_183455.json:
```json
{
    "body": "Replying to [comment:74 charpent]:\n> Messing around with the dynamic library mechanism does not seem to be such a great idea. \u00a0The 3.0.1.p1 patch gives (on Debian amd64 testing) an executable which is unable to install some packages using external libraries ( among them tcl/tk, curl, sqlite3 and more important, cpp libraries). I had oddles of trouble trying to install packages depending on\u00a0RcppArmadillo. Reverting to the 3.0.1.p0 patch solved this problem.\n> \n> I'd be sorely tempted to change the status to \"needs work\" ... if I knew how to do this.\n> \n> I'd like to recommend :\n> \n> 1. to keep the (simple) fix to get the 3.0.1 sources (which, AFAIU, compile fine on Unices and Mac OS X) and leave the dynamic library gizmoes alone, and\n> 2. to open ***another*** ticket for the dynamic library issues, which, if I understand the history, aim to compile this cleanly on cygwin.\n> \n> \n> \n> HTH,\n> \n>           Emmanuel Charpentier\n\nThat's really strange.\n\nThe difference between the p0 and the p1 has nothing to do with *LD_LIBRARY_PATH.\nIt merely triggers an upstream compilation option on Cygwin only.\nNot on any other OS (unless uname on that os contains CYGWIN which would be strange outside of Cygwin).\nJust have a look at [attachment:r-3.0.1.p1.diff]...\n\nNor has the diff between the p0 and the previous 2.* R version.\n\nThe *LD_LIBRARY_PATH comes from $SAGE_ROOT/spkg/bin/sage-env (or $SAGE_LOCAL, too lazy to check) or R itself, not from the spkg scripts.\nIf you're not convinced, just grep them.",
    "created_at": "2013-07-15T16:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183455",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:74 charpent]:
> Messing around with the dynamic library mechanism does not seem to be such a great idea.  The 3.0.1.p1 patch gives (on Debian amd64 testing) an executable which is unable to install some packages using external libraries ( among them tcl/tk, curl, sqlite3 and more important, cpp libraries). I had oddles of trouble trying to install packages depending on RcppArmadillo. Reverting to the 3.0.1.p0 patch solved this problem.
> 
> I'd be sorely tempted to change the status to "needs work" ... if I knew how to do this.
> 
> I'd like to recommend :
> 
> 1. to keep the (simple) fix to get the 3.0.1 sources (which, AFAIU, compile fine on Unices and Mac OS X) and leave the dynamic library gizmoes alone, and
> 2. to open ***another*** ticket for the dynamic library issues, which, if I understand the history, aim to compile this cleanly on cygwin.
> 
> 
> 
> HTH,
> 
>           Emmanuel Charpentier

That's really strange.

The difference between the p0 and the p1 has nothing to do with *LD_LIBRARY_PATH.
It merely triggers an upstream compilation option on Cygwin only.
Not on any other OS (unless uname on that os contains CYGWIN which would be strange outside of Cygwin).
Just have a look at [attachment:r-3.0.1.p1.diff]...

Nor has the diff between the p0 and the previous 2.* R version.

The *LD_LIBRARY_PATH comes from $SAGE_ROOT/spkg/bin/sage-env (or $SAGE_LOCAL, too lazy to check) or R itself, not from the spkg scripts.
If you're not convinced, just grep them.



---

archive/issue_events_042116.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14706#event-42116"
}
```



---

archive/issue_comments_183456.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-09-06T20:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183456",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_183457.json:
```json
{
    "body": "This will (trivially only) conflict with #13686.",
    "created_at": "2013-09-06T20:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183457",
    "user": "https://github.com/kcrisman"
}
```

This will (trivially only) conflict with #13686.



---

archive/issue_comments_183458.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-09-06T20:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183458",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183459.json:
```json
{
    "body": "Currently R doesn't build on sage.math, dying with \n\n```\n../../lib/libR.so: undefined reference to `rl_sort_completion_matches'\n```\nCan we clean this ticket up? \n\nJust a few comments from cursory reading this ticket:\n\n* Delete anything that can interfere with installation at the beginning of `spkg-install` (yes one could try to catch errors, but we don't have a framework for testing that so it won't ever work)\n\n* try to mess with library paths as little as possible.\n\n* Cygwin issues can go to a different ticket.",
    "created_at": "2013-10-07T09:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183459",
    "user": "https://github.com/vbraun"
}
```

Currently R doesn't build on sage.math, dying with 

```
../../lib/libR.so: undefined reference to `rl_sort_completion_matches'
```
Can we clean this ticket up? 

Just a few comments from cursory reading this ticket:

* Delete anything that can interfere with installation at the beginning of `spkg-install` (yes one could try to catch errors, but we don't have a framework for testing that so it won't ever work)

* try to mess with library paths as little as possible.

* Cygwin issues can go to a different ticket.



---

archive/issue_comments_183460.json:
```json
{
    "body": "What was done in this ticket was really trivial.\nBasically:\n* drop in replacement of the upstram sources,\n* a trivial fix for the Cygwin fixes (basically using the now upstream provided option rather than our custon patch + add an upstream patch not in the current stable version to fix the new upstream option; this has really no reason to affect any other systems than Cygwin unless it makes your computer proner to attracting gamma rays) so I don't see any reason not to keep them in.\n\nSo if R is now broken, its surely because of some hell with *LDLIBRARY_PATH either on Sage sideor on R side itself (as R seems to be as bad as Sage as far as hacking LDLIBRARY_PATH is concerned).\n\nI agree that cleaning up the spkg-install would be a good idea as well.\n\nAlso note that R 3.0.2 was released a few days ago, so maybe the patch fixing the disable_long-double option is now included.",
    "created_at": "2013-10-07T09:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183460",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

What was done in this ticket was really trivial.
Basically:
* drop in replacement of the upstram sources,
* a trivial fix for the Cygwin fixes (basically using the now upstream provided option rather than our custon patch + add an upstream patch not in the current stable version to fix the new upstream option; this has really no reason to affect any other systems than Cygwin unless it makes your computer proner to attracting gamma rays) so I don't see any reason not to keep them in.

So if R is now broken, its surely because of some hell with *LDLIBRARY_PATH either on Sage sideor on R side itself (as R seems to be as bad as Sage as far as hacking LDLIBRARY_PATH is concerned).

I agree that cleaning up the spkg-install would be a good idea as well.

Also note that R 3.0.2 was released a few days ago, so maybe the patch fixing the disable_long-double option is now included.



---

archive/issue_comments_183461.json:
```json
{
    "body": "Just to clarify, both the R in sage-5.12.rc1 as well as the one on this ticket fail to compile on sage.math.",
    "created_at": "2013-10-07T09:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183461",
    "user": "https://github.com/vbraun"
}
```

Just to clarify, both the R in sage-5.12.rc1 as well as the one on this ticket fail to compile on sage.math.



---

archive/issue_comments_183462.json:
```json
{
    "body": "I guess the readline problem is:\n* http://lists.gnu.org/archive/html/bug-readline/2013-07/msg00017.html",
    "created_at": "2013-10-07T10:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183462",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I guess the readline problem is:
* http://lists.gnu.org/archive/html/bug-readline/2013-07/msg00017.html



---

archive/issue_comments_183463.json:
```json
{
    "body": "There is a new readline release beta:\n* http://permalink.gmane.org/gmane.comp.gnu.readline/406\nI guess its worth giving it a try...",
    "created_at": "2013-10-07T10:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183463",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

There is a new readline release beta:
* http://permalink.gmane.org/gmane.comp.gnu.readline/406
I guess its worth giving it a try...



---

archive/issue_comments_183464.json:
```json
{
    "body": "Its not a bug in readline (that would be huge and immediatly fail). The R-project guys are just confused about the readelf output on their mailinglist (hint: `--wide` won't truncate output). The issue is here:\n\n```\ngcc -std=gnu99 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre -I../../src/extra  -I../../src/extra/xz/api -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -fopenmp -fpic  -g -O2   -c Rmain.c -o Rmain.o\ngcc -std=gnu99 -Wl,--export-dynamic -fopenmp   -o R.bin Rmain.o  -L../../lib -lR -lRblas\n../../lib/libR.so: undefined reference to `rl_sort_completion_matches'\n``` \nThere is no `-lreadline`, so it shouldn't work.",
    "created_at": "2013-10-07T11:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183464",
    "user": "https://github.com/vbraun"
}
```

Its not a bug in readline (that would be huge and immediatly fail). The R-project guys are just confused about the readelf output on their mailinglist (hint: `--wide` won't truncate output). The issue is here:

```
gcc -std=gnu99 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre -I../../src/extra  -I../../src/extra/xz/api -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -fopenmp -fpic  -g -O2   -c Rmain.c -o Rmain.o
gcc -std=gnu99 -Wl,--export-dynamic -fopenmp   -o R.bin Rmain.o  -L../../lib -lR -lRblas
../../lib/libR.so: undefined reference to `rl_sort_completion_matches'
``` 
There is no `-lreadline`, so it shouldn't work.



---

archive/issue_comments_183465.json:
```json
{
    "body": "Yup, that sounds more sensible :)",
    "created_at": "2013-10-07T11:03:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183465",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Yup, that sounds more sensible :)



---

archive/issue_comments_183466.json:
```json
{
    "body": "I've updated a trivially updated spkg, could you give it a shot?\nAnd post or link the failing log?\n\nIt doesn't seem the failing line you mentioned changed.\n(Note that the line I get is slightly different, I don't get the -lRblas.)\nBefore that line at least, on my install, when libR.so is built, -lreadline is correctly passed, so maybe this changed for 3.0.2.\n\nAt this point, I changed nothing to deal with a potentially conflicting old version of R 2.x as mentioned earlier on this ticket.",
    "created_at": "2013-10-07T21:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183466",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I've updated a trivially updated spkg, could you give it a shot?
And post or link the failing log?

It doesn't seem the failing line you mentioned changed.
(Note that the line I get is slightly different, I don't get the -lRblas.)
Before that line at least, on my install, when libR.so is built, -lreadline is correctly passed, so maybe this changed for 3.0.2.

At this point, I changed nothing to deal with a potentially conflicting old version of R 2.x as mentioned earlier on this ticket.



---

archive/issue_comments_183467.json:
```json
{
    "body": "Groumpf, I just gave 5.13.beta1 (I know its not stabilized...) on sage.math and it succesfully built the shipped R 2.x spkg.\nStrange.",
    "created_at": "2013-10-07T22:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183467",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Groumpf, I just gave 5.13.beta1 (I know its not stabilized...) on sage.math and it succesfully built the shipped R 2.x spkg.
Strange.



---

archive/issue_comments_183468.json:
```json
{
    "body": "No problem with 3.0.2 spkg on sage.math for me (on top of 5.13.beta1, Sage's GCC was built)...\nStrangely I don't get the -lRblas flag.\n\nVolker: Could you post your logs?",
    "created_at": "2013-10-08T07:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183468",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

No problem with 3.0.2 spkg on sage.math for me (on top of 5.13.beta1, Sage's GCC was built)...
Strangely I don't get the -lRblas flag.

Volker: Could you post your logs?



---

archive/issue_comments_183469.json:
```json
{
    "body": "Same behavior for me on sage.math on top of 5.12.rc1 (with Sage's GCC built) with the provided 2.x spkg and the new 3.0.2 one.\nStill no -lRblas and no error.\nSo I cannot do much about Volker's problem without further info...\n\nIt would also be nice if Emmanuel could confirm the error on OS X is still there.",
    "created_at": "2013-10-08T11:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183469",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Same behavior for me on sage.math on top of 5.12.rc1 (with Sage's GCC built) with the provided 2.x spkg and the new 3.0.2 one.
Still no -lRblas and no error.
So I cannot do much about Volker's problem without further info...

It would also be nice if Emmanuel could confirm the error on OS X is still there.



---

archive/issue_comments_183470.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2013-10-08T11:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183470",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_183471.json:
```json
{
    "body": "Sorry, should have been more clear: I'm trying to compile the current git master. It still fails with 3.0.2.p0.\n\nBuild log is here: http://boxen.math.washington.edu/home/vbraun/logs/r-3.0.2.p0.log",
    "created_at": "2013-10-08T12:15:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183471",
    "user": "https://github.com/vbraun"
}
```

Sorry, should have been more clear: I'm trying to compile the current git master. It still fails with 3.0.2.p0.

Build log is here: http://boxen.math.washington.edu/home/vbraun/logs/r-3.0.2.p0.log



---

archive/issue_comments_183472.json:
```json
{
    "body": "I tried the master branch from https://github.com/sagemath/sage.git and had no problems with r-2.x and 3.x...\n\nWhich repo/branch did you use?",
    "created_at": "2013-10-08T15:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183472",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I tried the master branch from https://github.com/sagemath/sage.git and had no problems with r-2.x and 3.x...

Which repo/branch did you use?



---

archive/issue_comments_183473.json:
```json
{
    "body": "Here is a difference in the log of your and my r-3.0.2 builds\n\n```\n428,432c431,432\n< checking for dgemm_ in -L/home/jpflori/build/sage.git/local/lib -lf77blas -latlas... yes\n< checking whether double complex BLAS can be used... yes\n< checking whether the BLAS is complete... yes\n< checking for dpstrf_... no\n< checking for dpstrf_ in -L/home/jpflori/build/sage.git/local/lib -llapack -lcblas... yes\n---\n> checking for dgemm_ in -L/home/vbraun/Sage/git/local/lib -lf77blas -latlas... yes\n> checking whether double complex BLAS can be used... no\n```\nI guess this is at the root of the \"-lRblas\" you get and I don't.\nWhat version of ATLAS or BLAS did you use?\nNot sure it will then lead us to the readline problem.",
    "created_at": "2013-10-08T21:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183473",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Here is a difference in the log of your and my r-3.0.2 builds

```
428,432c431,432
< checking for dgemm_ in -L/home/jpflori/build/sage.git/local/lib -lf77blas -latlas... yes
< checking whether double complex BLAS can be used... yes
< checking whether the BLAS is complete... yes
< checking for dpstrf_... no
< checking for dpstrf_ in -L/home/jpflori/build/sage.git/local/lib -llapack -lcblas... yes
---
> checking for dgemm_ in -L/home/vbraun/Sage/git/local/lib -lf77blas -latlas... yes
> checking whether double complex BLAS can be used... no
```
I guess this is at the root of the "-lRblas" you get and I don't.
What version of ATLAS or BLAS did you use?
Not sure it will then lead us to the readline problem.



---

archive/issue_comments_183474.json:
```json
{
    "body": "Ok, it seems from your log at http://boxen.math.washington.edu/home/vbraun/Sage/git/logs/pkgs/atlas-3.10.1.p5.log that you used the system ATLAS.\nI'll do the same.",
    "created_at": "2013-10-08T21:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183474",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Ok, it seems from your log at http://boxen.math.washington.edu/home/vbraun/Sage/git/logs/pkgs/atlas-3.10.1.p5.log that you used the system ATLAS.
I'll do the same.



---

archive/issue_comments_183475.json:
```json
{
    "body": "Comparing the previously succesful libR.so (with Sage's ATLAS) and the new one (with system-wide ATLAS), the former is using:\n\n```\nlibreadline.so.6 => /home/jpflori/build/sage.git/local/lib/libreadline.so.6 (0x00007fe83965c000)\n```\nwhereas the latter is using\n\n```\nlibreadline.so.5 => /lib/libreadline.so.5 (0x00007f9a46b59000)\n```",
    "created_at": "2013-10-08T22:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183475",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Comparing the previously succesful libR.so (with Sage's ATLAS) and the new one (with system-wide ATLAS), the former is using:

```
libreadline.so.6 => /home/jpflori/build/sage.git/local/lib/libreadline.so.6 (0x00007fe83965c000)
```
whereas the latter is using

```
libreadline.so.5 => /lib/libreadline.so.5 (0x00007f9a46b59000)
```



---

archive/issue_comments_183476.json:
```json
{
    "body": "In the working case, when libR.so is built the gcc command includes:\n\n```\n-L/home/jpflori/build/sage.git/local/lib -lf77blas -latlas -lgfortran -lm -lquadmath   -lreadline  -lrt -ldl -lm\n```\nwhereas in the other case it includes:\n\n```\n-L../../lib -lRblas -lgfortran -lm -lquadmath   -lreadline  -lrt -ldl -lm\n```\nThe \"-L\" stuff is here because it is passed through --with-blas to configure, and I guess gets dropped and replace in the latter case because R does not like the systm wide ATLAS.\n\nNow what's strange is that we pass --with-readline=\"$SAGE_LOCAL\" to configure but it does not seem to care about the location we give it.",
    "created_at": "2013-10-08T22:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183476",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

In the working case, when libR.so is built the gcc command includes:

```
-L/home/jpflori/build/sage.git/local/lib -lf77blas -latlas -lgfortran -lm -lquadmath   -lreadline  -lrt -ldl -lm
```
whereas in the other case it includes:

```
-L../../lib -lRblas -lgfortran -lm -lquadmath   -lreadline  -lrt -ldl -lm
```
The "-L" stuff is here because it is passed through --with-blas to configure, and I guess gets dropped and replace in the latter case because R does not like the systm wide ATLAS.

Now what's strange is that we pass --with-readline="$SAGE_LOCAL" to configure but it does not seem to care about the location we give it.



---

archive/issue_comments_183477.json:
```json
{
    "body": "Indeed, R configure does not give a * about what we give to --with-readline (unless its no).\n\nSo we should explicitely pass $SAGE_LOCAL through LDFLAGS I guess.",
    "created_at": "2013-10-08T22:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183477",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Indeed, R configure does not give a * about what we give to --with-readline (unless its no).

So we should explicitely pass $SAGE_LOCAL through LDFLAGS I guess.



---

archive/issue_comments_183478.json:
```json
{
    "body": "It seems enough indeed.",
    "created_at": "2013-10-08T23:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183478",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

It seems enough indeed.



---

archive/issue_comments_183479.json:
```json
{
    "body": "As far as OS X is concerned, could some of you check if reverting http://trac.sagemath.org/attachment/ticket/1939/Sage-2.10.1.rc0-fix-rpy-import-on-OSX.patch helps in some way?",
    "created_at": "2013-10-09T22:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183479",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

As far as OS X is concerned, could some of you check if reverting http://trac.sagemath.org/attachment/ticket/1939/Sage-2.10.1.rc0-fix-rpy-import-on-OSX.patch helps in some way?



---

archive/issue_comments_183480.json:
```json
{
    "body": "I guess this is only a problem on OS X because of\n\n```\nR_LD_LIBRARY_PATH_save=${R_LD_LIBRARY_PATH}\nR_LD_LIBRARY_PATH=\ncase \"${host_os}\" in\n  darwin*)\n    ## Darwin provides a full path in the ID of each library such \n    ## that the linker can add library's path to the binary at link time.\n    ## This allows the dyld to find libraries even without xx_LIBRARY_PATH.\n    ## No paths should be added to R_LD_LIBRARY_PATH (which in turn\n    ## changes DYLD_LIBRARY_PATH), because they override the system\n    ## look-up sequence. Such automatic override has proven to break things\n    ## like system frameworks (e.g. ImageIO or OpenGL framework).\n    ;;\n  *)\n    for arg in ${LDFLAGS}; do\n      case \"${arg}\" in\n        -L*)\n\t  lib=`echo ${arg} | sed \"s/^-L//\"`\n\t  R_SH_VAR_ADD(R_LD_LIBRARY_PATH, [${lib}], [${PATH_SEPARATOR}])\n\t  ;;\n      esac\n    done\n    ;;\nesac\n```\nand this could be fishy as well because it look somehow contradictory with the above\n\n```\ncase \"${host_os}\" in\n  darwin*)\n    ## In order to allow the R build to be relocatable, we strip paths\n    ## from all shlibs and rely on DYLD_LIBRARY_PATH. Unfortunately\n    ## Darwin linker ignores it at build-time and doesn't use -L to\n    ## resolve dylib dependencies, so libRblas will not be found unless\n    ## we tell ld where it lives. I don't know of any more elegant solution :/\n    if test \"x${use_blas_shlib}\" = xyes; then\n      LIBR=\"${LIBR} -dylib_file libRblas.dylib:\\$(R_HOME)/lib\\$(R_ARCH)/libRblas.dylib\"\n    fi\n  ;;\nesac\nAC_SUBST(LIBR)\n```\nin configure.ac.",
    "created_at": "2013-10-09T22:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183480",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I guess this is only a problem on OS X because of

```
R_LD_LIBRARY_PATH_save=${R_LD_LIBRARY_PATH}
R_LD_LIBRARY_PATH=
case "${host_os}" in
  darwin*)
    ## Darwin provides a full path in the ID of each library such 
    ## that the linker can add library's path to the binary at link time.
    ## This allows the dyld to find libraries even without xx_LIBRARY_PATH.
    ## No paths should be added to R_LD_LIBRARY_PATH (which in turn
    ## changes DYLD_LIBRARY_PATH), because they override the system
    ## look-up sequence. Such automatic override has proven to break things
    ## like system frameworks (e.g. ImageIO or OpenGL framework).
    ;;
  *)
    for arg in ${LDFLAGS}; do
      case "${arg}" in
        -L*)
	  lib=`echo ${arg} | sed "s/^-L//"`
	  R_SH_VAR_ADD(R_LD_LIBRARY_PATH, [${lib}], [${PATH_SEPARATOR}])
	  ;;
      esac
    done
    ;;
esac
```
and this could be fishy as well because it look somehow contradictory with the above

```
case "${host_os}" in
  darwin*)
    ## In order to allow the R build to be relocatable, we strip paths
    ## from all shlibs and rely on DYLD_LIBRARY_PATH. Unfortunately
    ## Darwin linker ignores it at build-time and doesn't use -L to
    ## resolve dylib dependencies, so libRblas will not be found unless
    ## we tell ld where it lives. I don't know of any more elegant solution :/
    if test "x${use_blas_shlib}" = xyes; then
      LIBR="${LIBR} -dylib_file libRblas.dylib:\$(R_HOME)/lib\$(R_ARCH)/libRblas.dylib"
    fi
  ;;
esac
AC_SUBST(LIBR)
```
in configure.ac.



---

archive/issue_comments_183481.json:
```json
{
    "body": "I guess the real problem on OS X is that as shown above, R does not modify DYLD_LIBRARY_PATH, but rather DYLD_FALLBACK_LIBRARY_PATH through etc/ldpaths in R.sh, whereas Sage modifies directly DYLD_LIBRARY_PATH.\nSee\n\n```\n## We already added -L's from LDFLAGS (except on Darwin): \n## seem to be doing it again\nfor arg in ${LDFLAGS} ${FLIBS} ${BLAS_LIBS} ${LAPACK_LIBS} ${X_LIBS} \\\n           ${TCLTK_LIBS}; do\n  case \"${arg}\" in\n    -L*)\n      lib=`echo ${arg} | sed \"s/^-L//\"`\n      r_want_lib=true\n      ## don't add anything for Darwin\n      case \"${host_os}\" in darwin*) r_want_lib=false ;; esac\n      ## Do not add non-existent directories.\n      test -d \"${lib}\" || r_want_lib=false\n      if test x\"${r_want_lib}\" = xtrue; then\n        ## Canonicalize (/usr/lib/gcc-lib/i486-linux/3.3.4/../../..).\n        lib=`cd \"${lib}\" && ${GETWD}`\n        ## Do not add something twice, or default paths.\n        r_save_IFS=\"${IFS}\"; IFS=\"${PATH_SEPARATOR}\"\n        for dir in ${R_LD_LIBRARY_PATH}${IFS}${r_ld_library_defaults}; do\n          if test x\"${dir}\" = x\"${lib}\"; then\n            r_want_lib=false\n            break\n          fi\n        done\n        IFS=\"${r_save_IFS}\"\n        if test x\"${r_want_lib}\" = xtrue; then\n          R_SH_VAR_ADD(R_LD_LIBRARY_PATH, [${lib}], [${PATH_SEPARATOR}])\n        fi\n      fi\n      ;;\n  esac\ndone\nfi\n```\nat the end of configure.ac.\n\nSo when R is not installed, at installation time, when R is run, no libR.dylib is found in DYLD_LIBRARY_PATH, but it is in the FALLBACK variant.\nBut when R is already installed, then libR.dylib is found in DYLD_LIBRARY_PATH and that's potentially a wrong version...",
    "created_at": "2013-10-10T00:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183481",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I guess the real problem on OS X is that as shown above, R does not modify DYLD_LIBRARY_PATH, but rather DYLD_FALLBACK_LIBRARY_PATH through etc/ldpaths in R.sh, whereas Sage modifies directly DYLD_LIBRARY_PATH.
See

```
## We already added -L's from LDFLAGS (except on Darwin): 
## seem to be doing it again
for arg in ${LDFLAGS} ${FLIBS} ${BLAS_LIBS} ${LAPACK_LIBS} ${X_LIBS} \
           ${TCLTK_LIBS}; do
  case "${arg}" in
    -L*)
      lib=`echo ${arg} | sed "s/^-L//"`
      r_want_lib=true
      ## don't add anything for Darwin
      case "${host_os}" in darwin*) r_want_lib=false ;; esac
      ## Do not add non-existent directories.
      test -d "${lib}" || r_want_lib=false
      if test x"${r_want_lib}" = xtrue; then
        ## Canonicalize (/usr/lib/gcc-lib/i486-linux/3.3.4/../../..).
        lib=`cd "${lib}" && ${GETWD}`
        ## Do not add something twice, or default paths.
        r_save_IFS="${IFS}"; IFS="${PATH_SEPARATOR}"
        for dir in ${R_LD_LIBRARY_PATH}${IFS}${r_ld_library_defaults}; do
          if test x"${dir}" = x"${lib}"; then
            r_want_lib=false
            break
          fi
        done
        IFS="${r_save_IFS}"
        if test x"${r_want_lib}" = xtrue; then
          R_SH_VAR_ADD(R_LD_LIBRARY_PATH, [${lib}], [${PATH_SEPARATOR}])
        fi
      fi
      ;;
  esac
done
fi
```
at the end of configure.ac.

So when R is not installed, at installation time, when R is run, no libR.dylib is found in DYLD_LIBRARY_PATH, but it is in the FALLBACK variant.
But when R is already installed, then libR.dylib is found in DYLD_LIBRARY_PATH and that's potentially a wrong version...



---

archive/issue_comments_183482.json:
```json
{
    "body": "Updated spkg to deal with the OS X issue.\nUse spkg at same address.\n\nApply:\n* [attachment:trac_14706-version.patch]",
    "created_at": "2013-10-30T16:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183482",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Updated spkg to deal with the OS X issue.
Use spkg at same address.

Apply:
* [attachment:trac_14706-version.patch]



---

archive/issue_comments_183483.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-10-30T16:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183483",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_183484.json:
```json
{
    "body": "Note I've only tested this on Ubuntu, no access to OS X (now and later as well).",
    "created_at": "2013-10-30T16:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183484",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Note I've only tested this on Ubuntu, no access to OS X (now and later as well).



---

archive/issue_comments_183485.json:
```json
{
    "body": "This builds and all tests pass on OS X 10.8.5 (Mountain Lion).",
    "created_at": "2013-10-30T18:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183485",
    "user": "https://github.com/jhpalmieri"
}
```

This builds and all tests pass on OS X 10.8.5 (Mountain Lion).



---

archive/issue_comments_183486.json:
```json
{
    "body": "(This failed to build on OS X 10.9 (Mavericks), but the current R spkg fails, too. So this should not be an obstacle to a positive review for this ticket.)",
    "created_at": "2013-10-30T23:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183486",
    "user": "https://github.com/jhpalmieri"
}
```

(This failed to build on OS X 10.9 (Mavericks), but the current R spkg fails, too. So this should not be an obstacle to a positive review for this ticket.)



---

archive/issue_comments_183487.json:
```json
{
    "body": "I guess you actually tried to update from R 2.x to R 3.x and not a build from scratch with the spkg replaced?\n\nSo you might give a positive review as the OS X issue was the only thing which made this go from positive_review back to needs_work?",
    "created_at": "2013-11-07T13:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183487",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I guess you actually tried to update from R 2.x to R 3.x and not a build from scratch with the spkg replaced?

So you might give a positive review as the OS X issue was the only thing which made this go from positive_review back to needs_work?



---

archive/issue_comments_183488.json:
```json
{
    "body": "I don't remember what I did before, probably upgraded an existing installation. Earlier today I started with a new Sage tarball, put in the new R spkg and applied the patch. All tests passed again.",
    "created_at": "2013-11-07T19:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183488",
    "user": "https://github.com/jhpalmieri"
}
```

I don't remember what I did before, probably upgraded an existing installation. Earlier today I started with a new Sage tarball, put in the new R spkg and applied the patch. All tests passed again.



---

archive/issue_comments_183489.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-11-07T19:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183489",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_183490.json:
```json
{
    "body": "Just now I successfully took an existing Sage build and updated just the R spkg. That went well, and all tests passed. I found it a little odd that the rpy spkg wasn't rebuilt (it tried to install it and exited, saying `Package rpy2-2.0.8.p0 is already installed`). I hope that the rpy spkg just relies on information like where R has been installed, not specific version information.",
    "created_at": "2013-11-07T21:20:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183490",
    "user": "https://github.com/jhpalmieri"
}
```

Just now I successfully took an existing Sage build and updated just the R spkg. That went well, and all tests passed. I found it a little odd that the rpy spkg wasn't rebuilt (it tried to install it and exited, saying `Package rpy2-2.0.8.p0 is already installed`). I hope that the rpy spkg just relies on information like where R has been installed, not specific version information.



---

archive/issue_comments_183491.json:
```json
{
    "body": "Replying to [comment:108 jhpalmieri]:\n> Just now I successfully took an existing Sage build and updated just the R spkg. That went well, and all tests passed. I found it a little odd that the rpy spkg wasn't rebuilt (it tried to install it and exited, saying `Package rpy2-2.0.8.p0 is already installed`). I would definitely say this is not an issue with the R spkg, but with Sage build system.",
    "created_at": "2013-11-07T22:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183491",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:108 jhpalmieri]:
> Just now I successfully took an existing Sage build and updated just the R spkg. That went well, and all tests passed. I found it a little odd that the rpy spkg wasn't rebuilt (it tried to install it and exited, saying `Package rpy2-2.0.8.p0 is already installed`). I would definitely say this is not an issue with the R spkg, but with Sage build system.



---

archive/issue_comments_183492.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-11-12T07:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183492",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_183493.json:
```json
{
    "body": "This fails to install on Solaris SPARC:\n\n```\nLoading required package: Matrix\nError in dyn.load(file, DLLpath = DLLpath, ...) : \n  unable to load shared object '/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix/libs/Matrix.so':\n  ld.so.1: R: fatal: relocation error: file /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix/libs/Matrix.so: symbol libintl_dngettext: referenced symbol not found\nError : require(Matrix) is not TRUE\nERROR: installing package indices failed\n* removing '/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix'\nmake[5]: *** [Matrix.ts] Error 1\n```\n\nFull log: [http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/361/steps/shell_5/logs/r](http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/361/steps/shell_5/logs/r)",
    "created_at": "2013-11-12T07:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183493",
    "user": "https://github.com/jdemeyer"
}
```

This fails to install on Solaris SPARC:

```
Loading required package: Matrix
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix/libs/Matrix.so':
  ld.so.1: R: fatal: relocation error: file /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix/libs/Matrix.so: symbol libintl_dngettext: referenced symbol not found
Error : require(Matrix) is not TRUE
ERROR: installing package indices failed
* removing '/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.13.beta3/spkg/build/r-3.0.2.p0/src/library/Matrix'
make[5]: *** [Matrix.ts] Error 1
```

Full log: [http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/361/steps/shell_5/logs/r](http://build.sagemath.org/sage/builders/Skynet%20mark%20%28SunOS%205.10-32%29/builds/361/steps/shell_5/logs/r)



---

archive/issue_comments_183494.json:
```json
{
    "body": "Looks like what's reported here:\n* http://osol.wikidot.com/logentry:software\nAnother madness of Solaris shipping a bunch of different versions of the same libs.",
    "created_at": "2013-11-12T10:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183494",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Looks like what's reported here:
* http://osol.wikidot.com/logentry:software
Another madness of Solaris shipping a bunch of different versions of the same libs.



---

archive/issue_comments_183495.json:
```json
{
    "body": "Attachment [r-3.0.2.p0.diff](tarball://root/attachments/some-uuid/ticket14706/r-3.0.2.p0.diff) by jpflori created at 2013-11-12 16:28:35\n\nSpkg diff, for review only.",
    "created_at": "2013-11-12T16:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183495",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [r-3.0.2.p0.diff](tarball://root/attachments/some-uuid/ticket14706/r-3.0.2.p0.diff) by jpflori created at 2013-11-12 16:28:35

Spkg diff, for review only.



---

archive/issue_comments_183496.json:
```json
{
    "body": "Hopefully, I fixed the problem.\nThe Matrix module wants to use the gettext dngettext function.\nOn usual system this is provided by the system libc or the system libintl.\nOn Solaris the system libintl does not provide it so R decides to build its own libintl (in src/extra/intl) but with symbols hidden by default (-fvisibility-hidden) and only publicize a few of them, but not dngettext.\nSo I treated that last function as the few others one already visible.\n\nspkg at same address.\ndiff updated.",
    "created_at": "2013-11-12T16:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183496",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Hopefully, I fixed the problem.
The Matrix module wants to use the gettext dngettext function.
On usual system this is provided by the system libc or the system libintl.
On Solaris the system libintl does not provide it so R decides to build its own libintl (in src/extra/intl) but with symbols hidden by default (-fvisibility-hidden) and only publicize a few of them, but not dngettext.
So I treated that last function as the few others one already visible.

spkg at same address.
diff updated.



---

archive/issue_comments_183497.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-11-12T16:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183497",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183498.json:
```json
{
    "body": "* Non-standard location readline problem reported as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15556\n* Solaris gettext problem as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15555",
    "created_at": "2013-11-12T20:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183498",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

* Non-standard location readline problem reported as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15556
* Solaris gettext problem as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15555



---

archive/issue_comments_183499.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-11-14T11:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183499",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183500.json:
```json
{
    "body": "Nitpick about the library patch: the second `r.version()` should be `r_version()`. By the way, I wouldn't mind deprecating `r_version()` since I really don't see the point. It would be consistent with the deprecation of `gap_version()`.",
    "created_at": "2013-11-14T11:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183500",
    "user": "https://github.com/jdemeyer"
}
```

Nitpick about the library patch: the second `r.version()` should be `r_version()`. By the way, I wouldn't mind deprecating `r_version()` since I really don't see the point. It would be consistent with the deprecation of `gap_version()`.



---

archive/issue_comments_183501.json:
```json
{
    "body": "Attachment [trac_14706-version.patch](tarball://root/attachments/some-uuid/ticket14706/trac_14706-version.patch) by jpflori created at 2013-11-14 14:09:29\n\nPatch updated.\n\nSure, I have nothing agains deprecating r_version which seems not so useful.\nBut I won't have time to do it right now and this is not really the scope of this ticket, so two good reasons to do that in a follow-up ticket.",
    "created_at": "2013-11-14T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183501",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [trac_14706-version.patch](tarball://root/attachments/some-uuid/ticket14706/trac_14706-version.patch) by jpflori created at 2013-11-14 14:09:29

Patch updated.

Sure, I have nothing agains deprecating r_version which seems not so useful.
But I won't have time to do it right now and this is not really the scope of this ticket, so two good reasons to do that in a follow-up ticket.



---

archive/issue_comments_183502.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-11-14T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183502",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183503.json:
```json
{
    "body": "See the discussion at #13686 as well (and perhaps elsewhere?) on the R version function issue.",
    "created_at": "2013-11-14T14:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183503",
    "user": "https://github.com/kcrisman"
}
```

See the discussion at #13686 as well (and perhaps elsewhere?) on the R version function issue.



---

archive/issue_comments_183504.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-11-14T15:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183504",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_042117.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-24T09:22:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14706#event-42117"
}
```



---

archive/issue_comments_183505.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-11-24T09:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183505",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_183506.json:
```json
{
    "body": "Shouldn't `r-3.0.2` be available from http://www.sagemath.org/packages/upstream/r/r-3.0.2.tar so that the build system of the git master branch can download it automatically?",
    "created_at": "2013-11-27T10:11:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183506",
    "user": "https://github.com/mezzarobba"
}
```

Shouldn't `r-3.0.2` be available from http://www.sagemath.org/packages/upstream/r/r-3.0.2.tar so that the build system of the git master branch can download it automatically?



---

archive/issue_comments_183507.json:
```json
{
    "body": "I've no idea who is in charge of maintaining packages/upstream, nor if it's automatically updated when Mercurial releases are merged into the git repo, nor how we should upload future tarballs when we're in git-only mode (in particular note that some tarball are not upstream one's, maybe all dependencies should now have spkg-src which automate the creation of the tarballs --- vanilla or not).",
    "created_at": "2013-11-27T10:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183507",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I've no idea who is in charge of maintaining packages/upstream, nor if it's automatically updated when Mercurial releases are merged into the git repo, nor how we should upload future tarballs when we're in git-only mode (in particular note that some tarball are not upstream one's, maybe all dependencies should now have spkg-src which automate the creation of the tarballs --- vanilla or not).



---

archive/issue_comments_183508.json:
```json
{
    "body": "Ok, thanks for your reply. I also added a comment on the issue at http://trac.sagemath.org/ticket/14480#comment:51, so hopefully someone who knows where to find the right version can upload it!",
    "created_at": "2013-11-27T10:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183508",
    "user": "https://github.com/mezzarobba"
}
```

Ok, thanks for your reply. I also added a comment on the issue at http://trac.sagemath.org/ticket/14480#comment:51, so hopefully someone who knows where to find the right version can upload it!



---

archive/issue_comments_183509.json:
```json
{
    "body": "I've posted on sage-git where it might receive more attention:\n* https://groups.google.com/d/msg/sage-git/wyM7OSZcw2E/gbVNVq0KaKIJ",
    "created_at": "2013-11-27T10:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183509",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I've posted on sage-git where it might receive more attention:
* https://groups.google.com/d/msg/sage-git/wyM7OSZcw2E/gbVNVq0KaKIJ



---

archive/issue_comments_183510.json:
```json
{
    "body": "Replying to [comment:113 jpflori]:\n> * Non-standard location readline problem reported as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15556\n \nUpstream answered: you're the first one to report that in 15 years, unless you provide a patch we don't care.\n> * Solaris gettext problem as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15555\n \nThis has been fixed in R trunk.",
    "created_at": "2013-12-25T16:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183510",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:113 jpflori]:
> * Non-standard location readline problem reported as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15556
 
Upstream answered: you're the first one to report that in 15 years, unless you provide a patch we don't care.
> * Solaris gettext problem as https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15555
 
This has been fixed in R trunk.



---

archive/issue_comments_183511.json:
```json
{
    "body": "Attachment [arm-r-3.0.2.p0.log](tarball://root/attachments/some-uuid/ticket14706/arm-r-3.0.2.p0.log) by @dimpase created at 2014-01-17 13:25:15\n\nlog on an ARM system",
    "created_at": "2014-01-17T13:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183511",
    "user": "https://github.com/dimpase"
}
```

Attachment [arm-r-3.0.2.p0.log](tarball://root/attachments/some-uuid/ticket14706/arm-r-3.0.2.p0.log) by @dimpase created at 2014-01-17 13:25:15

log on an ARM system



---

archive/issue_comments_183512.json:
```json
{
    "body": "I am trying to build Sage 6.0 on a ARM system I just got access to, and it fails with a strange error. See the corr. attachment for the full log.\n\n```\nbegin installing recommended package lattice\n* installing *source* package 'lattice' ...\n** package 'lattice' successfully unpacked and MD5 sums checked\n** libs\nmake[6]: Entering directory `/tmp/Rtmpu7TiBm/R.INSTALL74b515accca6/lattice/src'\ngcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src\n/include -DNDEBUG      -fpic  -g -O2   -c init.c -o init.o\ngcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src\n/include -DNDEBUG      -fpic  -g -O2   -c threeDplot.c -o threeDplot.o\ngcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o latticeSHLIB_EXT \ninit.o threeDplot.o SHLIB_LIBADD -L/home/dimpase/sage/sage/local/var/tmp/sage/bu\nild/r-3.0.2.p0/src/lib -lR\ngcc: error: SHLIB_LIBADD: No such file or directory\nmake[6]: *** [latticeSHLIB_EXT] Error 1\nmake[6]: Leaving directory `/tmp/Rtmpu7TiBm/R.INSTALL74b515accca6/lattice/src'\nERROR: compilation failed for package 'lattice'\n* removing '/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/library/lattice'\nmake[5]: *** [lattice.ts] Error 1\n```",
    "created_at": "2014-01-17T13:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183512",
    "user": "https://github.com/dimpase"
}
```

I am trying to build Sage 6.0 on a ARM system I just got access to, and it fails with a strange error. See the corr. attachment for the full log.

```
begin installing recommended package lattice
* installing *source* package 'lattice' ...
** package 'lattice' successfully unpacked and MD5 sums checked
** libs
make[6]: Entering directory `/tmp/Rtmpu7TiBm/R.INSTALL74b515accca6/lattice/src'
gcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src
/include -DNDEBUG      -fpic  -g -O2   -c init.c -o init.o
gcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src
/include -DNDEBUG      -fpic  -g -O2   -c threeDplot.c -o threeDplot.o
gcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o latticeSHLIB_EXT 
init.o threeDplot.o SHLIB_LIBADD -L/home/dimpase/sage/sage/local/var/tmp/sage/bu
ild/r-3.0.2.p0/src/lib -lR
gcc: error: SHLIB_LIBADD: No such file or directory
make[6]: *** [latticeSHLIB_EXT] Error 1
make[6]: Leaving directory `/tmp/Rtmpu7TiBm/R.INSTALL74b515accca6/lattice/src'
ERROR: compilation failed for package 'lattice'
* removing '/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/library/lattice'
make[5]: *** [lattice.ts] Error 1
```



---

archive/issue_comments_183513.json:
```json
{
    "body": "See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue",
    "created_at": "2014-01-17T17:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183513",
    "user": "https://github.com/vbraun"
}
```

See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue



---

archive/issue_comments_183514.json:
```json
{
    "body": "Replying to [comment:125 vbraun]:\n> See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue\n\n\nAnyone familiar with `R` building system around?\nI tried this, and got weird stuff:\n\n```\n** package 'lattice' successfully unpacked and MD5 sums checked\n** libs\nmake[6]: Entering directory `/tmp/RtmpYoKYEk/R.INSTALL57a933daa9d6/lattice/src'\ngcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/include -DNDEBUG \n     -fpic  -g -O2   -c init.c -o init.o\ngcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/include -DNDEBUG \n     -fpic  -g -O2   -c threeDplot.c -o threeDplot.o\ngcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o latticeSHLIB_EXT init.o threeDplot.\no -L/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/lib -lR\ngcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o .so init.o threeDplot.o -L/home/dim\npase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/lib -lR\nmake[6]: Leaving directory `/tmp/RtmpYoKYEk/R.INSTALL57a933daa9d6/lattice/src'\n```\nnote that linker is called twice, once with `-o latticeSHLIB_EXT`, and then with `-o .so` !? wtf...\nI can only speculate that the generation of `SHLIB_EXT` is still broken and injects unprintable chars into the string, which leads to the linking command executed twice.",
    "created_at": "2014-01-27T10:12:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183514",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:125 vbraun]:
> See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue


Anyone familiar with `R` building system around?
I tried this, and got weird stuff:

```
** package 'lattice' successfully unpacked and MD5 sums checked
** libs
make[6]: Entering directory `/tmp/RtmpYoKYEk/R.INSTALL57a933daa9d6/lattice/src'
gcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/include -DNDEBUG 
     -fpic  -g -O2   -c init.c -o init.o
gcc -std=gnu99 -I/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/include -DNDEBUG 
     -fpic  -g -O2   -c threeDplot.c -o threeDplot.o
gcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o latticeSHLIB_EXT init.o threeDplot.
o -L/home/dimpase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/lib -lR
gcc -std=gnu99 -shared -L/home/dimpase/sage/sage/local/lib/ -o .so init.o threeDplot.o -L/home/dim
pase/sage/sage/local/var/tmp/sage/build/r-3.0.2.p0/src/lib -lR
make[6]: Leaving directory `/tmp/RtmpYoKYEk/R.INSTALL57a933daa9d6/lattice/src'
```
note that linker is called twice, once with `-o latticeSHLIB_EXT`, and then with `-o .so` !? wtf...
I can only speculate that the generation of `SHLIB_EXT` is still broken and injects unprintable chars into the string, which leads to the linking command executed twice.



---

archive/issue_comments_183515.json:
```json
{
    "body": "Replying to [comment:126 dimpase]:\n> Replying to [comment:125 vbraun]:\n> > See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue\n\n> \n> Anyone familiar with `R` building system around?\n> I tried this, and got weird stuff:\n\n\nit turns out that `SHLIB_EXT` is set up in more than 1 place in `install.R`. So this workaround has to be done for all these places to work right. \n\nI've opened a new ticket with the patch. See #15762.",
    "created_at": "2014-01-29T15:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183515",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:126 dimpase]:
> Replying to [comment:125 vbraun]:
> > See http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679180 for an analysis and patch of the `SHLIB_LIBADD` issue

> 
> Anyone familiar with `R` building system around?
> I tried this, and got weird stuff:


it turns out that `SHLIB_EXT` is set up in more than 1 place in `install.R`. So this workaround has to be done for all these places to work right. 

I've opened a new ticket with the patch. See #15762.



---

archive/issue_comments_183516.json:
```json
{
    "body": "Dear co-authors,\n\nPlease have a look at Trac#16694, whoch might be germane to your work and solution.\n\nEmmanuel Charpentier",
    "created_at": "2014-07-25T20:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14706#issuecomment-183516",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Dear co-authors,

Please have a look at Trac#16694, whoch might be germane to your work and solution.

Emmanuel Charpentier
