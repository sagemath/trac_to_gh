# Issue 14346: Document/report/fix PARI patches

archive/issues_014142.json:
```json
{
    "body": "This spkg has many patches, with the following:\n\nGood:\n* get_ld.patch: author known, pure packaging\n* get_tests.patch: author known, pure packaging\n* install_doc_no_make.patch: author known, pure packaging\n* perl_path.patch: author known, pure packaging\n* cygwin_dll_a.patch: author known, pure packaging\n* GCC_PR49330.patch: author mentioned, discussed with upstream, upstream decided not to fix this\n* get_dlcflags.patch: author known, partially accepted by upstream\n* KERNELCFLAGS.patch: author known, forwarded upstream\n* trac_13902_determinant.patch: author mentioned, upstream backport\n* polred.patch: author mentioned, upstream backport\n\nBad:\n* get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n* get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n* get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n* mp.c.patch: author unknown, should be replaced by a Sage library patch.\n\nDepends on #14539\n\n**CC:**  @jdemeyer\n\n**Reviewer:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/14346\n\n",
    "closed_at": "2015-03-17T18:19:55Z",
    "created_at": "2013-03-23T09:19:17Z",
    "labels": [
        "component: packages: standard",
        "enhancement",
        "invalid"
    ],
    "title": "Document/report/fix PARI patches",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/14346",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```
This spkg has many patches, with the following:

Good:
* get_ld.patch: author known, pure packaging
* get_tests.patch: author known, pure packaging
* install_doc_no_make.patch: author known, pure packaging
* perl_path.patch: author known, pure packaging
* cygwin_dll_a.patch: author known, pure packaging
* GCC_PR49330.patch: author mentioned, discussed with upstream, upstream decided not to fix this
* get_dlcflags.patch: author known, partially accepted by upstream
* KERNELCFLAGS.patch: author known, forwarded upstream
* trac_13902_determinant.patch: author mentioned, upstream backport
* polred.patch: author mentioned, upstream backport

Bad:
* get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
* get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
* get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
* mp.c.patch: author unknown, should be replaced by a Sage library patch.

Depends on #14539

**CC:**  @jdemeyer

**Reviewer:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/14346





---

archive/issue_comments_174636.json:
```json
{
    "body": "<a id='comment:1'></a>\nDoes this apply to the PARI library, or `gp`?\n\n(Of course `gp` uses the PARI library, but *I think<sup>TM</sup>* the stand-alone `gp` wouldn't need patching for Sage.)",
    "created_at": "2013-03-23T10:53:10Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174636",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>
Does this apply to the PARI library, or `gp`?

(Of course `gp` uses the PARI library, but *I think<sup>TM</sup>* the stand-alone `gp` wouldn't need patching for Sage.)



---

archive/issue_comments_174637.json:
```json
{
    "body": "<a id='comment:2'></a>\nBoth the library and the executable come out of the same spkg anyway so I don't see how the distinction matters...",
    "created_at": "2013-03-23T16:46:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174637",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:2'></a>
Both the library and the executable come out of the same spkg anyway so I don't see how the distinction matters...



---

archive/issue_comments_174638.json:
```json
{
    "body": "<a id='comment:3'></a>\nHave to second that discusion on debian. I have actually pushed almost every single sage patch to pari in sage-on-gentoo. I think it is ok when they are patches included upstream. I hadn't looked at the particulars of polred. Which yes alter the ABI somewhat. Was the change necessary and will it be picked up upstream?",
    "created_at": "2013-03-23T22:32:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174638",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Have to second that discusion on debian. I have actually pushed almost every single sage patch to pari in sage-on-gentoo. I think it is ok when they are patches included upstream. I hadn't looked at the particulars of polred. Which yes alter the ABI somewhat. Was the change necessary and will it be picked up upstream?



---

archive/issue_comments_174639.json:
```json
{
    "body": "<a id='comment:4'></a>\nIf you read B.A.'s comment on my debian bug report, I think it's 100% sure they won't take it in the stable branch, as it breaks ABI. Now for another branch, the question is open -- but since this polred.patch is based on upstream commits, they might have better up their sleeve already!",
    "created_at": "2013-03-24T08:25:06Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174639",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:4'></a>
If you read B.A.'s comment on my debian bug report, I think it's 100% sure they won't take it in the stable branch, as it breaks ABI. Now for another branch, the question is open -- but since this polred.patch is based on upstream commits, they might have better up their sleeve already!



---

archive/issue_comments_174640.json:
```json
{
    "body": "<a id='comment:5'></a>\nIIRC PARI 2.6 release sould happen quite soon, so hopefully the commits we used are from this devel branch, see http://pari.math.u-bordeaux1.fr/timeline.html",
    "created_at": "2013-03-26T14:02:38Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174640",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:5'></a>
IIRC PARI 2.6 release sould happen quite soon, so hopefully the commits we used are from this devel branch, see http://pari.math.u-bordeaux1.fr/timeline.html



---

archive/issue_comments_174641.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.\n\nSo yes, we can hope that when sage will package pari 2.6.0, then it will stop forking pari and become compatible with something debian can package seriously.",
    "created_at": "2013-03-26T17:17:15Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174641",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:6'></a>
The commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.

So yes, we can hope that when sage will package pari 2.6.0, then it will stop forking pari and become compatible with something debian can package seriously.



---

archive/issue_comments_174642.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [Snark](#comment%3A6):\n> The commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.\n\nI thought backporting patches from later upstream versions is standard practice.",
    "created_at": "2013-04-10T10:59:49Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174642",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [Snark](#comment%3A6):
> The commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.

I thought backporting patches from later upstream versions is standard practice.



---

archive/issue_events_124395.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-10T11:02:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124395"
}
```



---

archive/issue_events_124396.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-10T11:02:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124396"
}
```



---

archive/issue_events_124397.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-10T11:02:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124397"
}
```



---

archive/issue_events_124398.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-10T11:02:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124398"
}
```



---

archive/issue_comments_174643.json:
```json
{
    "body": "Replying to [ticket:14346 Snark]:\n> The pari package is full of patches\n\nSo what? Since when is patching a package a bug?\n\n> some of which should have been proposed upstream\n\nWhich patches are you refering to?\n\n> the correct solution would be for sage to *add* what is needed to the sage library instead of patching upstream.\n\nPlease elaborate how we should add PARI patches to the Sage library.",
    "created_at": "2013-04-10T11:02:36Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174643",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:14346 Snark]:
> The pari package is full of patches

So what? Since when is patching a package a bug?

> some of which should have been proposed upstream

Which patches are you refering to?

> the correct solution would be for sage to *add* what is needed to the sage library instead of patching upstream.

Please elaborate how we should add PARI patches to the Sage library.



---

archive/issue_comments_174644.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jdemeyer](#comment%3A8):\n> Replying to [Snark](#comment%3A6):\n> > The commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.\n\n> I thought backporting patches from later upstream versions is standard practice.\n\nI'll have a shot at that one but it's probably nothing new to you. It depends on the trade off. Backporting in a distro like debian that is keeping fixed version of the software has much as possible is good.... so long as you preserve API. If the patch breaks API that means potentially all dependencies will need patching for the new API. So the trade off is between the number of dependencies you have to patch for the new API and how badly you want/need the backport. \n\nIt applies also to sage but the scale is a priori less than in a full distro. In the case of pari in particular, I don't think the list of dependencies (especially dependencies not in sage) affected by your change is very long (make that non existant until proven otherwise).\n\nDebian may have enshrined the above discussion in a precise policy but I am not a deban-er.",
    "created_at": "2013-04-10T11:13:06Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174644",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>
Replying to [jdemeyer](#comment%3A8):
> Replying to [Snark](#comment%3A6):
> > The commits used were from upstream, but the patch is **based** on those commits -- it's not just them. That means that the pari in sage is neither compatible with upstream's 2.5.3, nor with the upcoming 2.6.0.

> I thought backporting patches from later upstream versions is standard practice.

I'll have a shot at that one but it's probably nothing new to you. It depends on the trade off. Backporting in a distro like debian that is keeping fixed version of the software has much as possible is good.... so long as you preserve API. If the patch breaks API that means potentially all dependencies will need patching for the new API. So the trade off is between the number of dependencies you have to patch for the new API and how badly you want/need the backport. 

It applies also to sage but the scale is a priori less than in a full distro. In the case of pari in particular, I don't think the list of dependencies (especially dependencies not in sage) affected by your change is very long (make that non existant until proven otherwise).

Debian may have enshrined the above discussion in a precise policy but I am not a deban-er.



---

archive/issue_comments_174645.json:
```json
{
    "body": "<a id='comment:11'></a>\nBackporting is standard practice, to gain a bugfix or a new feature which is only available in a later version.\n\nThe current situation is different : some modifications are backports, and some are new code.\n\nThe backported patches have their places in the pari spkg, but the new code should be in the sage library.",
    "created_at": "2013-04-10T11:14:00Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174645",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:11'></a>
Backporting is standard practice, to gain a bugfix or a new feature which is only available in a later version.

The current situation is different : some modifications are backports, and some are new code.

The backported patches have their places in the pari spkg, but the new code should be in the sage library.



---

archive/issue_comments_174646.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [fbissey](#comment%3A10):\n> If the patch breaks API\n\nIn which sense does the polred patch \"break API\" (I probably don't understand what you mean exactly with \"breaks API\")",
    "created_at": "2013-04-10T11:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174646",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [fbissey](#comment%3A10):
> If the patch breaks API

In which sense does the polred patch "break API" (I probably don't understand what you mean exactly with "breaks API")



---

archive/issue_comments_174647.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [Snark](#comment%3A11):\n> the new code should be in the sage library.\n\nWhich code are you refering too?\n\nDetails please, this is all so vague...",
    "created_at": "2013-04-10T11:20:49Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174647",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Replying to [Snark](#comment%3A11):
> the new code should be in the sage library.

Which code are you refering too?

Details please, this is all so vague...



---

archive/issue_comments_174648.json:
```json
{
    "body": "<a id='comment:14'></a>\nOk, let's be explicit:\n1. in general there are fifteen patches in this spkg, which is way too much ;\n2. in particular polred.patch is a mix between a backport and a new development.\n\nI claim putting new developments in a package is against standard packaging practice.\n\nAnd I use the verb \"break\" because that's what will happen when sage will want to include the next pari version...",
    "created_at": "2013-04-10T14:55:24Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174648",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:14'></a>
Ok, let's be explicit:
1. in general there are fifteen patches in this spkg, which is way too much ;
2. in particular polred.patch is a mix between a backport and a new development.

I claim putting new developments in a package is against standard packaging practice.

And I use the verb "break" because that's what will happen when sage will want to include the next pari version...



---

archive/issue_comments_174649.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,4 @@\n-The pari package is full of patches, some of which should have been proposed upstream, some of which break the ABI.\n-\n-According to the discussion with the debian packager of pari (which is also upstream):\n-http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=703116\n-the correct solution would be for sage to *add* what is needed to the sage library instead of patching upstream.\n+The pari package has 15 patches, there are various problems with these:\n+1. patches ..... should have been proposed upstream but haven't been reported.\n+2. patch ..... breaks the ABI of the function ......(). It will in particular cause problems when upgrading to the next PARI version.\n+3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.\n``````\n",
    "created_at": "2013-04-10T15:22:35Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174649",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,4 @@
-The pari package is full of patches, some of which should have been proposed upstream, some of which break the ABI.
-
-According to the discussion with the debian packager of pari (which is also upstream):
-http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=703116
-the correct solution would be for sage to *add* what is needed to the sage library instead of patching upstream.
+The pari package has 15 patches, there are various problems with these:
+1. patches ..... should have been proposed upstream but haven't been reported.
+2. patch ..... breaks the ABI of the function ......(). It will in particular cause problems when upgrading to the next PARI version.
+3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.
``````




---

archive/issue_comments_174650.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [Snark](#comment%3A14):\n> Ok, let's be explicit:\n\nThat's not explicit at all, that's essentially just repeating what you already said. To make it easier for you, I changed the description and let you fill in the blanks.",
    "created_at": "2013-04-10T15:22:35Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174650",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Replying to [Snark](#comment%3A14):
> Ok, let's be explicit:

That's not explicit at all, that's essentially just repeating what you already said. To make it easier for you, I changed the description and let you fill in the blanks.



---

archive/issue_comments_174651.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n The pari package has 15 patches, there are various problems with these:\n 1. patches ..... should have been proposed upstream but haven't been reported.\n-2. patch ..... breaks the ABI of the function ......(). It will in particular cause problems when upgrading to the next PARI version.\n+2. patch ..... breaks the ABI of the function ......(). It will cause problems when upgrading to the next PARI version because ........\n 3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.\n``````\n",
    "created_at": "2013-04-10T18:04:14Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174651",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
 The pari package has 15 patches, there are various problems with these:
 1. patches ..... should have been proposed upstream but haven't been reported.
-2. patch ..... breaks the ABI of the function ......(). It will in particular cause problems when upgrading to the next PARI version.
+2. patch ..... breaks the ABI of the function ......(). It will cause problems when upgrading to the next PARI version because ........
 3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.
``````




---

archive/issue_comments_174652.json:
```json
{
    "body": "<a id='comment:17'></a>\nSo I did a bit more digging because it is a case of show me the code, I will say that after looking at it carefully I have reached a pragmatic view on this and I don't actually mind the change in question. If Julien is worried about some other code he can put it on display. So in the polred patch\n\n```\ndiff -ruN src/src/headers/paridecl.h b/src/headers/paridecl.h\n--- src/src/headers/paridecl.h\t2012-09-25 23:10:47.000000000 +0200\n+++ b/src/headers/paridecl.h\t2013-01-31 14:49:05.557525771 +0100\n@@ -889,6 +889,7 @@\n GEN     polredabs0(GEN x, long flag);\n GEN     polredabs2(GEN x);\n GEN     polredabsall(GEN x, long flun);\n+GEN     polredbest(GEN x, long flag);\n GEN     smallpolred(GEN x);\n GEN     smallpolred2(GEN x);\n GEN     tschirnhaus(GEN x);\n```\nThat's technically a change in API you are exposing more functions than in the original. That kind of change is unlikely to break anything. All the rest of the code apart from the new function is private and shouldn't be called directly, so `_it_` doesn't matter.\nA more disturbing change would have been changing the way a public function is called. If someone has been using a private function in their code and it breaks, honestly they get what they deserve.\n\nI haven't looked upstream, Julien may be worried that this extra function is not upstream or will be upstream under another name or call structure. It is the only thing that I can think could be extracted and put separately inside the sage library. And it technically could be done. BUT I haven't digged the code deep to see if it was possible without calling private functions from pari. I think I said something before about calling private functions... \n\nThere used to be some very invasive change in pari 2.3.xx where the sage spkg added some error handling mechanism. I cannot see it anymore. In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.",
    "created_at": "2013-04-10T21:54:38Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174652",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
So I did a bit more digging because it is a case of show me the code, I will say that after looking at it carefully I have reached a pragmatic view on this and I don't actually mind the change in question. If Julien is worried about some other code he can put it on display. So in the polred patch

```
diff -ruN src/src/headers/paridecl.h b/src/headers/paridecl.h
--- src/src/headers/paridecl.h	2012-09-25 23:10:47.000000000 +0200
+++ b/src/headers/paridecl.h	2013-01-31 14:49:05.557525771 +0100
@@ -889,6 +889,7 @@
 GEN     polredabs0(GEN x, long flag);
 GEN     polredabs2(GEN x);
 GEN     polredabsall(GEN x, long flun);
+GEN     polredbest(GEN x, long flag);
 GEN     smallpolred(GEN x);
 GEN     smallpolred2(GEN x);
 GEN     tschirnhaus(GEN x);
```
That's technically a change in API you are exposing more functions than in the original. That kind of change is unlikely to break anything. All the rest of the code apart from the new function is private and shouldn't be called directly, so `_it_` doesn't matter.
A more disturbing change would have been changing the way a public function is called. If someone has been using a private function in their code and it breaks, honestly they get what they deserve.

I haven't looked upstream, Julien may be worried that this extra function is not upstream or will be upstream under another name or call structure. It is the only thing that I can think could be extracted and put separately inside the sage library. And it technically could be done. BUT I haven't digged the code deep to see if it was possible without calling private functions from pari. I think I said something before about calling private functions... 

There used to be some very invasive change in pari 2.3.xx where the sage spkg added some error handling mechanism. I cannot see it anymore. In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.



---

archive/issue_comments_174653.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [fbissey](#comment%3A17):\n> That's technically a change in API you are exposing more functions than in the original.\n\nAs I tried to tell you several times, this patch is a backport from upstream PARI-2.6, the added function comes from PARI-2.6.\n\n> In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.\n\nSo we can close this ticket as invalid ;-)",
    "created_at": "2013-04-11T06:33:37Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174653",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [fbissey](#comment%3A17):
> That's technically a change in API you are exposing more functions than in the original.

As I tried to tell you several times, this patch is a backport from upstream PARI-2.6, the added function comes from PARI-2.6.

> In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.

So we can close this ticket as invalid ;-)



---

archive/issue_comments_174654.json:
```json
{
    "body": "<a id='comment:19'></a>\nI played weather van a bit on that one. I would like to see if Julien has anything more to say. If he doesn't I'll happilly review it as invalid for you",
    "created_at": "2013-04-11T07:15:11Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174654",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
I played weather van a bit on that one. I would like to see if Julien has anything more to say. If he doesn't I'll happilly review it as invalid for you



---

archive/issue_comments_174655.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n-The pari package has 15 patches, there are various problems with these:\n-1. patches ..... should have been proposed upstream but haven't been reported.\n-2. patch ..... breaks the ABI of the function ......(). It will cause problems when upgrading to the next PARI version because ........\n-3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.\n+This spkg has 15 patches, with the following :\n+1. get_ld.patch: author known, pure packaging - GOOD\n+2. get_tests.patch: author known, pure packaging - GOOD\n+3. get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+4. get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+5. get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+6. get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't - BAD\n+7. install_doc_no_make.patch: author known, pure packaging - GOOD\n+8. perl_path.patch: author known, pure packaging - GOOD\n+9. cygwin_dll_a.patch: author known, pure packaging - GOOD\n+10. KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream - HALF-GOOD\n+21. src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+32. GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+43. trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified - GOOD?\n+54. galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n+65. polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library] - BAD\n``````\n",
    "created_at": "2013-04-11T10:07:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174655",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,16 @@
-The pari package has 15 patches, there are various problems with these:
-1. patches ..... should have been proposed upstream but haven't been reported.
-2. patch ..... breaks the ABI of the function ......(). It will cause problems when upgrading to the next PARI version because ........
-3. `polred.patch` in lines ... - ... of file ...... puts new developments in a package, which should instead be moved to the Sage library.
+This spkg has 15 patches, with the following :
+1. get_ld.patch: author known, pure packaging - GOOD
+2. get_tests.patch: author known, pure packaging - GOOD
+3. get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+4. get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+5. get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+6. get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't - BAD
+7. install_doc_no_make.patch: author known, pure packaging - GOOD
+8. perl_path.patch: author known, pure packaging - GOOD
+9. cygwin_dll_a.patch: author known, pure packaging - GOOD
+10. KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream - HALF-GOOD
+21. src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+32. GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+43. trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified - GOOD?
+54. galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
+65. polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library] - BAD
``````




---

archive/issue_comments_174656.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,16 +1,23 @@\n-This spkg has 15 patches, with the following :\n-1. get_ld.patch: author known, pure packaging - GOOD\n-2. get_tests.patch: author known, pure packaging - GOOD\n-3. get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-4. get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-5. get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-6. get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't - BAD\n-7. install_doc_no_make.patch: author known, pure packaging - GOOD\n-8. perl_path.patch: author known, pure packaging - GOOD\n-9. cygwin_dll_a.patch: author known, pure packaging - GOOD\n-10. KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream - HALF-GOOD\n-21. src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-32. GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-43. trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified - GOOD?\n-54. galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD\n-65. polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library] - BAD\n+This spkg has 15 patches, with the following:\n+\n+Good:\n+* get_ld.patch: author known, pure packaging\n+* get_tests.patch: author known, pure packaging\n+* install_doc_no_make.patch: author known, pure packaging\n+* perl_path.patch: author known, pure packaging\n+* cygwin_dll_a.patch: author known, pure packaging\n+* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n+\n+Half-good:\n+* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n+\n+Bad:\n+* get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't\n+* src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library]\n+\n``````\n",
    "created_at": "2013-04-11T10:27:12Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174656",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,16 +1,23 @@
-This spkg has 15 patches, with the following :
-1. get_ld.patch: author known, pure packaging - GOOD
-2. get_tests.patch: author known, pure packaging - GOOD
-3. get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-4. get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-5. get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-6. get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't - BAD
-7. install_doc_no_make.patch: author known, pure packaging - GOOD
-8. perl_path.patch: author known, pure packaging - GOOD
-9. cygwin_dll_a.patch: author known, pure packaging - GOOD
-10. KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream - HALF-GOOD
-21. src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-32. GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-43. trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified - GOOD?
-54. galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't - BAD
-65. polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library] - BAD
+This spkg has 15 patches, with the following:
+
+Good:
+* get_ld.patch: author known, pure packaging
+* get_tests.patch: author known, pure packaging
+* install_doc_no_make.patch: author known, pure packaging
+* perl_path.patch: author known, pure packaging
+* cygwin_dll_a.patch: author known, pure packaging
+* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
+
+Half-good:
+* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
+
+Bad:
+* get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't
+* src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library]
+
``````




---

archive/issue_comments_174657.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n * perl_path.patch: author known, pure packaging\n * cygwin_dll_a.patch: author known, pure packaging\n * trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n+* polred.patch: author unknown, upstream backport\n \n Half-good:\n * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n@@ -19,5 +20,4 @@\n * src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library]\n \n``````\n",
    "created_at": "2013-04-11T10:30:44Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174657",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 * perl_path.patch: author known, pure packaging
 * cygwin_dll_a.patch: author known, pure packaging
 * trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
+* polred.patch: author unknown, upstream backport
 
 Half-good:
 * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
@@ -19,5 +20,4 @@
 * src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* polred.patch: author unknown, upstream backport + added function -- the upstream backport is ok, adding a new function isn't [that should be done in the sage library]
 
``````




---

archive/issue_comments_174658.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [Snark](#comment%3A11):\n> Backporting is standard practice, to gain a bugfix or a new feature which is only available in a later version.\n\nBy this criterion, moving `polred.patch` to GOOD.",
    "created_at": "2013-04-11T10:30:44Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174658",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [Snark](#comment%3A11):
> Backporting is standard practice, to gain a bugfix or a new feature which is only available in a later version.

By this criterion, moving `polred.patch` to GOOD.



---

archive/issue_comments_174659.json:
```json
{
    "body": "<a id='comment:23'></a>\nFYI, the cygwin_dll_a.patch is upstream, see https://github.com/sagemath/sage/issues/13333, corresponding upstream commits are mentioned there.",
    "created_at": "2013-04-11T10:32:53Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174659",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:23'></a>
FYI, the cygwin_dll_a.patch is upstream, see https://github.com/sagemath/sage/issues/13333, corresponding upstream commits are mentioned there.



---

archive/issue_comments_174660.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,8 +16,9 @@\n * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't\n * src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n \n+Needs documentation:\n+* galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.\n+* GCC_PR49330.patch: author unknown, discussed by upstream, upstream decided not to fix this.\n+* get_dlcflags.patch: author known, partially accepted by upstream.\n``````\n",
    "created_at": "2013-04-11T10:40:24Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174660",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,8 +16,9 @@
 * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* get_dlcflags.patch: author known, upstream-worthy, a comment says upstream has a partial fix but doesn't say that better patch has been forwarded, which probably means it wasn't
 * src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* GCC_PR49330.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* galoisanalysis_p4.patch: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 
+Needs documentation:
+* galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.
+* GCC_PR49330.patch: author unknown, discussed by upstream, upstream decided not to fix this.
+* get_dlcflags.patch: author known, partially accepted by upstream.
``````




---

archive/issue_comments_174661.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n+* src/kernel/gmp/mp.c: author unknown, should be replaced by a Sage library patch.\n \n Needs documentation:\n * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.\n``````\n",
    "created_at": "2013-04-11T10:47:41Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174661",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* src/kernel/gmp/mp.c: author unknown, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
+* src/kernel/gmp/mp.c: author unknown, should be replaced by a Sage library patch.
 
 Needs documentation:
 * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.
``````




---

archive/issue_comments_174662.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,5 +20,5 @@\n \n Needs documentation:\n * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.\n-* GCC_PR49330.patch: author unknown, discussed by upstream, upstream decided not to fix this.\n+* GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.\n * get_dlcflags.patch: author known, partially accepted by upstream.\n``````\n",
    "created_at": "2013-04-11T10:50:24Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174662",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,5 +20,5 @@
 
 Needs documentation:
 * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.
-* GCC_PR49330.patch: author unknown, discussed by upstream, upstream decided not to fix this.
+* GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.
 * get_dlcflags.patch: author known, partially accepted by upstream.
``````




---

archive/issue_comments_174663.json:
```json
{
    "body": "<a id='comment:26'></a>\nHonest question: why is \"patch submitted upstream but upstream ignored it\" so much better than \"patch not submitted upstream\"? Because the end result is the same.",
    "created_at": "2013-04-11T10:50:24Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174663",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Honest question: why is "patch submitted upstream but upstream ignored it" so much better than "patch not submitted upstream"? Because the end result is the same.



---

archive/issue_comments_174664.json:
```json
{
    "body": "<a id='comment:27'></a>\nScanning the gcc bugzilla entry associated with  GCC_PR49330.patch it seems like gcc dev think people are just doing stuff they shouldn't with pointer arythmetics. i.e. the source code should be fixed - not that i completely understand the discussion mind you. And I learned in that entry that you can pessimize!",
    "created_at": "2013-04-11T11:05:40Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174664",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:27'></a>
Scanning the gcc bugzilla entry associated with  GCC_PR49330.patch it seems like gcc dev think people are just doing stuff they shouldn't with pointer arythmetics. i.e. the source code should be fixed - not that i completely understand the discussion mind you. And I learned in that entry that you can pessimize!



---

archive/issue_comments_174665.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,16 +9,14 @@\n * trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n * polred.patch: author unknown, upstream backport\n \n-Half-good:\n-* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n-\n Bad:\n * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n-* src/kernel/gmp/mp.c: author unknown, should be replaced by a Sage library patch.\n+* mp.c.patch: author unknown, should be replaced by a Sage library patch.\n \n Needs documentation:\n * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.\n * GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.\n * get_dlcflags.patch: author known, partially accepted by upstream.\n+* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n``````\n",
    "created_at": "2013-04-11T11:37:21Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174665",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,16 +9,14 @@
 * trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
 * polred.patch: author unknown, upstream backport
 
-Half-good:
-* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
-
 Bad:
 * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
-* src/kernel/gmp/mp.c: author unknown, should be replaced by a Sage library patch.
+* mp.c.patch: author unknown, should be replaced by a Sage library patch.
 
 Needs documentation:
 * galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.
 * GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.
 * get_dlcflags.patch: author known, partially accepted by upstream.
+* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
``````




---

archive/issue_comments_174666.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [fbissey](#comment%3A17):\n> So I did a bit more digging because it is a case of show me the code, I will say that after looking at it carefully I have reached a pragmatic view on this and I don't actually mind the change in question. If Julien is worried about some other code he can put it on display. So in the polred patch\n> \n> ```\n> diff -ruN src/src/headers/paridecl.h b/src/headers/paridecl.h\n> --- src/src/headers/paridecl.h\t2012-09-25 23:10:47.000000000 +0200\n> +++ b/src/headers/paridecl.h\t2013-01-31 14:49:05.557525771 +0100\n> @@ -889,6 +889,7 @@\n>  GEN     polredabs0(GEN x, long flag);\n>  GEN     polredabs2(GEN x);\n>  GEN     polredabsall(GEN x, long flun);\n> +GEN     polredbest(GEN x, long flag);\n>  GEN     smallpolred(GEN x);\n>  GEN     smallpolred2(GEN x);\n>  GEN     tschirnhaus(GEN x);\n> ```\n> That's technically a change in API you are exposing more functions than in the original. That kind of change is unlikely to break anything. All the rest of the code apart from the new function is private and shouldn't be called directly, so `_it_` doesn't matter.\n> A more disturbing change would have been changing the way a public function is called. If someone has been using a private function in their code and it breaks, honestly they get what they deserve.\n> \n> I haven't looked upstream, Julien may be worried that this extra function is not upstream or will be upstream under another name or call structure. \n\nI just checked and in PARI's git at least, it's just the same:\n* http://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=blob;f=src/headers/paridecl.h;h=01e6378eac8e329e9da34ee414f2b2f19f1770f8;hb=HEAD#l1263\nbut I cannot tell you what will be in PARI 2.6.\n>It is the only thing that I can think could be extracted and put separately inside the sage library. And it technically could be done. BUT I haven't digged the code deep to see if it was possible without calling private functions from pari. I think I said something before about calling private functions... \n> \n> There used to be some very invasive change in pari 2.3.xx where the sage spkg added some error handling mechanism. I cannot see it anymore. In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.\n",
    "created_at": "2013-04-11T12:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174666",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:29'></a>
Replying to [fbissey](#comment%3A17):
> So I did a bit more digging because it is a case of show me the code, I will say that after looking at it carefully I have reached a pragmatic view on this and I don't actually mind the change in question. If Julien is worried about some other code he can put it on display. So in the polred patch
> 
> ```
> diff -ruN src/src/headers/paridecl.h b/src/headers/paridecl.h
> --- src/src/headers/paridecl.h	2012-09-25 23:10:47.000000000 +0200
> +++ b/src/headers/paridecl.h	2013-01-31 14:49:05.557525771 +0100
> @@ -889,6 +889,7 @@
>  GEN     polredabs0(GEN x, long flag);
>  GEN     polredabs2(GEN x);
>  GEN     polredabsall(GEN x, long flun);
> +GEN     polredbest(GEN x, long flag);
>  GEN     smallpolred(GEN x);
>  GEN     smallpolred2(GEN x);
>  GEN     tschirnhaus(GEN x);
> ```
> That's technically a change in API you are exposing more functions than in the original. That kind of change is unlikely to break anything. All the rest of the code apart from the new function is private and shouldn't be called directly, so `_it_` doesn't matter.
> A more disturbing change would have been changing the way a public function is called. If someone has been using a private function in their code and it breaks, honestly they get what they deserve.
> 
> I haven't looked upstream, Julien may be worried that this extra function is not upstream or will be upstream under another name or call structure. 

I just checked and in PARI's git at least, it's just the same:
* http://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=blob;f=src/headers/paridecl.h;h=01e6378eac8e329e9da34ee414f2b2f19f1770f8;hb=HEAD#l1263
but I cannot tell you what will be in PARI 2.6.
>It is the only thing that I can think could be extracted and put separately inside the sage library. And it technically could be done. BUT I haven't digged the code deep to see if it was possible without calling private functions from pari. I think I said something before about calling private functions... 
> 
> There used to be some very invasive change in pari 2.3.xx where the sage spkg added some error handling mechanism. I cannot see it anymore. In fact looking at the patchset more closely than I did for some time, it is much cleaner than it used to be.




---

archive/issue_comments_174667.json:
```json
{
    "body": "<a id='comment:30'></a>\nI checked too, and indeed polredbest looks like it's upstream, so I confirm that I was wrong and that polred.patch isn't that bad.\n\nLet me notice that patches without a properly identified author could probably go in the \"Needs documentation\" list.",
    "created_at": "2013-04-11T14:14:43Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174667",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:30'></a>
I checked too, and indeed polredbest looks like it's upstream, so I confirm that I was wrong and that polred.patch isn't that bad.

Let me notice that patches without a properly identified author could probably go in the "Needs documentation" list.



---

archive/issue_comments_174668.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,8 +6,6 @@\n * install_doc_no_make.patch: author known, pure packaging\n * perl_path.patch: author known, pure packaging\n * cygwin_dll_a.patch: author known, pure packaging\n-* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n-* polred.patch: author unknown, upstream backport\n \n Bad:\n * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n@@ -20,3 +18,6 @@\n * GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.\n * get_dlcflags.patch: author known, partially accepted by upstream.\n * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n+* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n+* polred.patch: author unknown, upstream backport\n+\n``````\n",
    "created_at": "2013-04-11T15:39:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174668",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,8 +6,6 @@
 * install_doc_no_make.patch: author known, pure packaging
 * perl_path.patch: author known, pure packaging
 * cygwin_dll_a.patch: author known, pure packaging
-* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
-* polred.patch: author unknown, upstream backport
 
 Bad:
 * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
@@ -20,3 +18,6 @@
 * GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.
 * get_dlcflags.patch: author known, partially accepted by upstream.
 * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
+* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
+* polred.patch: author unknown, upstream backport
+
``````




---

archive/issue_events_124399.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-11T15:42:25Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "rename": {
        "from": "The pari spkg is patching upstream too heavily",
        "to": "Document/report/fix PARI patches"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124399"
}
```



---

archive/issue_comments_174669.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,10 +14,10 @@\n * mp.c.patch: author unknown, should be replaced by a Sage library patch.\n \n Needs documentation:\n-* galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.\n-* GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.\n+* galoisanalysis_p4.patch: author (jdemeyer) not mentioned, add link to upstream report: http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1389\n+* GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)\n * get_dlcflags.patch: author known, partially accepted by upstream.\n * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n-* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified\n-* polred.patch: author unknown, upstream backport\n+* trac_13902_determinant.patch: author (jdemeyer) not mentioned, upstream backport\n+* polred.patch: author (jdemeyer) not mentioned, upstream backport\n \n``````\n",
    "created_at": "2013-04-11T15:49:11Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174669",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,10 +14,10 @@
 * mp.c.patch: author unknown, should be replaced by a Sage library patch.
 
 Needs documentation:
-* galoisanalysis_p4.patch: author unknown, forwarded and accepted upstream.
-* GCC_PR49330.patch: author unknown, discussed with upstream, upstream decided not to fix this.
+* galoisanalysis_p4.patch: author (jdemeyer) not mentioned, add link to upstream report: http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1389
+* GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)
 * get_dlcflags.patch: author known, partially accepted by upstream.
 * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
-* trac_13902_determinant.patch: author unknown, upstream backport, hopefully not too modified
-* polred.patch: author unknown, upstream backport
+* trac_13902_determinant.patch: author (jdemeyer) not mentioned, upstream backport
+* polred.patch: author (jdemeyer) not mentioned, upstream backport
 
``````




---

archive/issue_comments_174670.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This spkg has 15 patches, with the following:\n+This spkg has many patches, with the following:\n \n Good:\n * get_ld.patch: author known, pure packaging\n@@ -14,7 +14,6 @@\n * mp.c.patch: author unknown, should be replaced by a Sage library patch.\n \n Needs documentation:\n-* galoisanalysis_p4.patch: author (jdemeyer) not mentioned, add link to upstream report: http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1389\n * GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)\n * get_dlcflags.patch: author known, partially accepted by upstream.\n * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n``````\n",
    "created_at": "2013-05-06T15:49:54Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174670",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This spkg has 15 patches, with the following:
+This spkg has many patches, with the following:
 
 Good:
 * get_ld.patch: author known, pure packaging
@@ -14,7 +14,6 @@
 * mp.c.patch: author unknown, should be replaced by a Sage library patch.
 
 Needs documentation:
-* galoisanalysis_p4.patch: author (jdemeyer) not mentioned, add link to upstream report: http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1389
 * GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)
 * get_dlcflags.patch: author known, partially accepted by upstream.
 * KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
``````




---

archive/issue_comments_174671.json:
```json
{
    "body": "<a id='comment:34'></a>\nIn #14539, I updated the patches README. Please verify that all needed documentation has been added.\n\nI remove the mention of `galoisanalysis_p4.patch` since that patch is upstream in PARI-2.5.4 and therefore not needed anymore.",
    "created_at": "2013-05-06T15:49:54Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174671",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
In #14539, I updated the patches README. Please verify that all needed documentation has been added.

I remove the mention of `galoisanalysis_p4.patch` since that patch is upstream in PARI-2.5.4 and therefore not needed anymore.



---

archive/issue_comments_174672.json:
```json
{
    "body": "**Dependencies:** #14539",
    "created_at": "2013-05-08T10:40:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174672",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #14539



---

archive/issue_comments_174673.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,17 +6,14 @@\n * install_doc_no_make.patch: author known, pure packaging\n * perl_path.patch: author known, pure packaging\n * cygwin_dll_a.patch: author known, pure packaging\n+* GCC_PR49330.patch: author mentioned, discussed with upstream, upstream decided not to fix this\n+* get_dlcflags.patch: author known, partially accepted by upstream\n+* KERNELCFLAGS.patch: author known, forwarded upstream\n+* trac_13902_determinant.patch: author mentioned, upstream backport\n+* polred.patch: author mentioned, upstream backport\n \n Bad:\n * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't\n * mp.c.patch: author unknown, should be replaced by a Sage library patch.\n-\n-Needs documentation:\n-* GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)\n-* get_dlcflags.patch: author known, partially accepted by upstream.\n-* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream\n-* trac_13902_determinant.patch: author (jdemeyer) not mentioned, upstream backport\n-* polred.patch: author (jdemeyer) not mentioned, upstream backport\n-\n``````\n",
    "created_at": "2013-05-08T10:40:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174673",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,17 +6,14 @@
 * install_doc_no_make.patch: author known, pure packaging
 * perl_path.patch: author known, pure packaging
 * cygwin_dll_a.patch: author known, pure packaging
+* GCC_PR49330.patch: author mentioned, discussed with upstream, upstream decided not to fix this
+* get_dlcflags.patch: author known, partially accepted by upstream
+* KERNELCFLAGS.patch: author known, forwarded upstream
+* trac_13902_determinant.patch: author mentioned, upstream backport
+* polred.patch: author mentioned, upstream backport
 
 Bad:
 * get_config_options.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_fltk.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * get_X11.patch: author known, upstream-worthy, no comment says it was forwarded, which probably means it wasn't
 * mp.c.patch: author unknown, should be replaced by a Sage library patch.
-
-Needs documentation:
-* GCC_PR49330.patch: author (jdemeyer) not mentioned, discussed with upstream, upstream decided not to fix this. Should mention [http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1203/msg00000.html) and [http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1202/msg00006.html)
-* get_dlcflags.patch: author known, partially accepted by upstream.
-* KERNELCFLAGS.patch: author unknown, you have to look at a bug report to see who the author is and that it was forwarded upstream
-* trac_13902_determinant.patch: author (jdemeyer) not mentioned, upstream backport
-* polred.patch: author (jdemeyer) not mentioned, upstream backport
-
``````




---

archive/issue_comments_174674.json:
```json
{
    "body": "<a id='comment:36'></a>\nThe documentation is much better, but it looks like sage-the-distribution is going to ship with a 'polredbest' function which will not be in pari 2.5.4 ; it will hence not be compatible with what other distributions will ship. Can't this function's code go into **sage**'s codebase instead?",
    "created_at": "2013-05-10T21:34:52Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174674",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:36'></a>
The documentation is much better, but it looks like sage-the-distribution is going to ship with a 'polredbest' function which will not be in pari 2.5.4 ; it will hence not be compatible with what other distributions will ship. Can't this function's code go into **sage**'s codebase instead?



---

archive/issue_comments_174675.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [Snark](#comment%3A36):\n> Can't this function's code go into **sage**'s codebase instead?\n\nWhy should it go into Sage's codebase? Sage is probably always going to need PARI + extra patches, not just vanilla PARI. So what's the point of moving this one patch into Sage?",
    "created_at": "2013-05-11T09:08:54Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174675",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
Replying to [Snark](#comment%3A36):
> Can't this function's code go into **sage**'s codebase instead?

Why should it go into Sage's codebase? Sage is probably always going to need PARI + extra patches, not just vanilla PARI. So what's the point of moving this one patch into Sage?



---

archive/issue_comments_174676.json:
```json
{
    "body": "<a id='comment:38'></a>\nI guess the point is to ease integration of Sage into Debian (or other distributions).\nIt may be against Debian rules to change the ABI, I don't really know.",
    "created_at": "2013-05-11T10:05:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174676",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:38'></a>
I guess the point is to ease integration of Sage into Debian (or other distributions).
It may be against Debian rules to change the ABI, I don't really know.



---

archive/issue_comments_174677.json:
```json
{
    "body": "<a id='comment:39'></a>\nWell, I don't agree that we should add extra complications to Sage to please distributions. And moving pieces of PARI into the Sage library sounds like a non-trivial thing to do.",
    "created_at": "2013-05-11T10:25:56Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174677",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>
Well, I don't agree that we should add extra complications to Sage to please distributions. And moving pieces of PARI into the Sage library sounds like a non-trivial thing to do.



---

archive/issue_comments_174678.json:
```json
{
    "body": "<a id='comment:40'></a>\nYup, I agree with that, I was just trying to get Julien's point.\n\nAnyway, for Debian, I guess he'll just have to wait for PARI 2.6 which is supposedly not that far away (unless things changed since the workshop).",
    "created_at": "2013-05-11T10:28:59Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174678",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:40'></a>
Yup, I agree with that, I was just trying to get Julien's point.

Anyway, for Debian, I guess he'll just have to wait for PARI 2.6 which is supposedly not that far away (unless things changed since the workshop).



---

archive/issue_comments_174679.json:
```json
{
    "body": "<a id='comment:41'></a>\nI don't think this particular code should go in sage. As Jeroen said it wouldn't be trivial. It looks to like pari internal functions are called. If you could implement it only with public functions it would be fine to just stick it in sage - and that would be the way to go in my opinion. But I don't see that as being the case with polredbest.\n\nGentoo policy on that case is it's ok if upstream intends to include the code which is the case here I believe. But really I have more freedom than Julien here.",
    "created_at": "2013-05-11T10:35:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174679",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:41'></a>
I don't think this particular code should go in sage. As Jeroen said it wouldn't be trivial. It looks to like pari internal functions are called. If you could implement it only with public functions it would be fine to just stick it in sage - and that would be the way to go in my opinion. But I don't see that as being the case with polredbest.

Gentoo policy on that case is it's ok if upstream intends to include the code which is the case here I believe. But really I have more freedom than Julien here.



---

archive/issue_comments_174680.json:
```json
{
    "body": "<a id='comment:42'></a>\nIt is again a problem of confusion between sage-the-distribution and sage-the-software ; the current sage-the-software won't work with pari 2.5.4, because it depends on polredbest (at least).\n\nThis is a problem for debian ; see the discussion about my\n[debian bug report](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=703116).\n\nI'm not sure pari 2.6 will be a solution real soon: I just tried to make a pari 2.6 spkg from an upstream snapshot (taking the current spkg and removing the patches) :\n1. it compiled ok ;\n2. eclib compiled ;\n3. genus2reduction didn't compile (error: \u2018arither1\u2019 undeclared) ;\n4. lcalc didn't compile (error: too few arguments to function \u2018long int* ellinit(GEN, GEN, long int)');\n5. sagelib didn't compile (quite a few different problems).",
    "created_at": "2013-05-11T14:41:43Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174680",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:42'></a>
It is again a problem of confusion between sage-the-distribution and sage-the-software ; the current sage-the-software won't work with pari 2.5.4, because it depends on polredbest (at least).

This is a problem for debian ; see the discussion about my
[debian bug report](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=703116).

I'm not sure pari 2.6 will be a solution real soon: I just tried to make a pari 2.6 spkg from an upstream snapshot (taking the current spkg and removing the patches) :
1. it compiled ok ;
2. eclib compiled ;
3. genus2reduction didn't compile (error: ‘arither1’ undeclared) ;
4. lcalc didn't compile (error: too few arguments to function ‘long int* ellinit(GEN, GEN, long int)');
5. sagelib didn't compile (quite a few different problems).



---

archive/issue_comments_174681.json:
```json
{
    "body": "<a id='comment:43'></a>\nI think #15767 will fix that bug too.",
    "created_at": "2014-04-10T17:49:44Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174681",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:43'></a>
I think #15767 will fix that bug too.



---

archive/issue_comments_174682.json:
```json
{
    "body": "<a id='comment:44'></a>\nWhat should be done with this ticket now? Do you still consider it relevant?",
    "created_at": "2015-03-13T10:06:13Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174682",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
What should be done with this ticket now? Do you still consider it relevant?



---

archive/issue_comments_174683.json:
```json
{
    "body": "<a id='comment:45'></a>\nWell, things changed a lot : I vote for close.",
    "created_at": "2015-03-13T13:28:07Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174683",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:45'></a>
Well, things changed a lot : I vote for close.



---

archive/issue_events_124400.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-13T17:22:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124400"
}
```



---

archive/issue_events_124401.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-13T17:22:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124401"
}
```



---

archive/issue_comments_174684.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2015-03-13T17:22:37Z",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14346#issuecomment-174684",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_124402.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-13T17:22:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124402"
}
```



---

archive/issue_events_124403.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-13T17:22:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124403"
}
```



---

archive/issue_events_124404.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-17T18:19:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124404"
}
```



---

archive/issue_events_124405.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-17T18:19:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14346",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14346#event-124405"
}
```
