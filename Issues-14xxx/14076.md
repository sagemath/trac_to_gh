# Issue 14076: Update ChomP to latest upstream version (compilation failure)

archive/issues_013872.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nCurrently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.\n\nUpdated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg\n\nBy the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.\n\nApply to the Sage library:\n* [attachment: trac_14076_chomp_update.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)\n* [attachment: trac_14076-more-chomp-fixes.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)\n\nDepends on #14595\n\nCC:  @jhpalmieri @tscrim @haraldschilly\n\nComponent: **packages: optional**\n\nAuthor: **Volker Braun**\n\nReviewer: **John Palmieri**\n\nMerged: **sage-5.11.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14076_\n\n",
    "closed_at": "2013-07-31T12:54:40Z",
    "created_at": "2013-02-07T03:55:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.11",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update ChomP to latest upstream version (compilation failure)",
    "type": "issue",
    "updated_at": "2013-07-31T12:54:40Z",
    "url": "https://github.com/sagemath/sage/issues/14076",
    "user": "https://github.com/cnassau"
}
```
<div id="comment:0"></div>

Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.

Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg

By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.

Apply to the Sage library:
* [attachment: trac_14076_chomp_update.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)
* [attachment: trac_14076-more-chomp-fixes.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)

Depends on #14595

CC:  @jhpalmieri @tscrim @haraldschilly

Component: **packages: optional**

Author: **Volker Braun**

Reviewer: **John Palmieri**

Merged: **sage-5.11.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/14076_





---

archive/issue_events_196052.json:
```json
{
    "actor": "https://github.com/cnassau",
    "created_at": "2013-02-07T03:55:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196052"
}
```



---

archive/issue_events_196053.json:
```json
{
    "actor": "https://github.com/cnassau",
    "created_at": "2013-02-07T03:55:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196053"
}
```



---

archive/issue_events_196054.json:
```json
{
    "actor": "https://github.com/cnassau",
    "created_at": "2013-02-07T03:55:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196054"
}
```



---

archive/issue_events_196055.json:
```json
{
    "actor": "https://github.com/cnassau",
    "created_at": "2013-02-07T03:55:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196055"
}
```



---

archive/issue_comments_167310.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe required fixes seem to be included in the current version 2013-01-02 of the CHomP package, so an update should fix this issue.",
    "created_at": "2013-02-09T13:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167310",
    "user": "https://github.com/cnassau"
}
```

<div id="comment:2" align="right">comment:2</div>

The required fixes seem to be included in the current version 2013-01-02 of the CHomP package, so an update should fix this issue.



---

archive/issue_events_196056.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-29T10:18:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "title_is": "Update ChomP to latest upstream version (compilation failure)",
    "title_was": "CHomP compilation failure",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196056"
}
```



---

archive/issue_comments_167311.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2013-05-29T10:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167311",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_167312.json:
```json
{
    "body": "Dependencies: **#14595**",
    "created_at": "2013-05-29T10:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167312",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#14595**



---

archive/issue_comments_167313.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWith #14595 this leads to the following doctest failure --- which notation do we prefer for the homology groups?\n\n```\n**********************************************************************\nFile \"sage/homology/chain_complex.py\", line 708, in sage.homology.chain_complex.ChainComplex.homology\nFailed example:\n    C_k.homology(generators=true)\nExpected:\n    {0: [(Z, (1))], 1: [(C2, (1, 0, 0)), (Z, (0, 0, 1))], 2: [(0, ())]}\nGot:\n    {0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}\n**********************************************************************\n```",
    "created_at": "2013-05-29T10:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167313",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

With #14595 this leads to the following doctest failure --- which notation do we prefer for the homology groups?

```
**********************************************************************
File "sage/homology/chain_complex.py", line 708, in sage.homology.chain_complex.ChainComplex.homology
Failed example:
    C_k.homology(generators=true)
Expected:
    {0: [(Z, (1))], 1: [(C2, (1, 0, 0)), (Z, (0, 0, 1))], 2: [(0, ())]}
Got:
    {0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}
**********************************************************************
```



---

archive/issue_comments_167314.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,3 @@\n-Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed.\n+Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.\n \n-The following (trivial) changes are needed to compile:\n-\n-* change 'erase' to 'this->erase' in 'include/capd/homologicalAlgebra/ChainT.h'\n-* change 'containsPixel' to 'this->containsPixel' in 'include/capd/bitSet/CubSetT.hpp' \n+Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg\n``````\n",
    "created_at": "2013-05-29T10:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167314",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,3 @@
-Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed.
+Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.
 
-The following (trivial) changes are needed to compile:
-
-* change 'erase' to 'this->erase' in 'include/capd/homologicalAlgebra/ChainT.h'
-* change 'containsPixel' to 'this->containsPixel' in 'include/capd/bitSet/CubSetT.hpp' 
+Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg
``````




---

archive/issue_comments_167315.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAlso, this blows up in your face:\n\n```\nsage: t0 = SimplicialComplex()\nsage: t0.add_face(('a', 'b'))\nsage: t0._numeric\nTrue\n```\nNo its not!\n\n```\nsage: t0.homology()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-27-8061bc7260ca> in <module>()\n----> 1 t0.homology()\n\n/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/homology/cell_complex.pyc in homology(self, dim, **kwds)\n    521                     if 'subcomplex' in kwds:\n    522                         del kwds['subcomplex']\n--> 523                     H = homsimpl(self, subcomplex, **kwds)\n    524             # now pick off the requested dimensions\n    525             if H:\n\n/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/interfaces/chomp.pyc in homsimpl(complex, subcomplex, **kwds)\n    481     if (isinstance(complex, SimplicialComplex)\n    482         and (subcomplex is None or isinstance(subcomplex, SimplicialComplex))):\n--> 483         return CHomP()('homsimpl', complex, subcomplex=subcomplex, **kwds)\n    484     else:\n    485         raise TypeError, \"Complex and/or subcomplex are not simplicial complexes.\"\n\n/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/interfaces/chomp.pyc in __call__(self, program, complex, subcomplex, **kwds)\n    209             elif simplicial:\n    210                 m = re.search(r'\\(([^,]*),', data)\n--> 211                 v = int(m.group(1))\n    212                 subcomplex = SimplicialComplex([[v]])\n    213         else:\n\nValueError: invalid literal for int() with base 10: \"'a'\"\n```\nIts a bit of a variant of #14578: caching for mutable objects is fragile. Its difficult to get right, and even if you do you'll break it when you make changes in the future.\n\nThe right thing to do is to make cell complexes immutable, and `add_face` / `remove_face` return new cell complexes. With an `add_faces` analogue to add multiple faces in one go to avoid performance issues. Bonus: the cell complexes can then be parents for chains. Thoughts?",
    "created_at": "2013-05-29T10:44:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167315",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">comment:5</div>

Also, this blows up in your face:

```
sage: t0 = SimplicialComplex()
sage: t0.add_face(('a', 'b'))
sage: t0._numeric
True
```
No its not!

```
sage: t0.homology()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-27-8061bc7260ca> in <module>()
----> 1 t0.homology()

/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/homology/cell_complex.pyc in homology(self, dim, **kwds)
    521                     if 'subcomplex' in kwds:
    522                         del kwds['subcomplex']
--> 523                     H = homsimpl(self, subcomplex, **kwds)
    524             # now pick off the requested dimensions
    525             if H:

/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/interfaces/chomp.pyc in homsimpl(complex, subcomplex, **kwds)
    481     if (isinstance(complex, SimplicialComplex)
    482         and (subcomplex is None or isinstance(subcomplex, SimplicialComplex))):
--> 483         return CHomP()('homsimpl', complex, subcomplex=subcomplex, **kwds)
    484     else:
    485         raise TypeError, "Complex and/or subcomplex are not simplicial complexes."

/home/vbraun/opt/sage-5.10.beta5/local/lib/python2.7/site-packages/sage/interfaces/chomp.pyc in __call__(self, program, complex, subcomplex, **kwds)
    209             elif simplicial:
    210                 m = re.search(r'\(([^,]*),', data)
--> 211                 v = int(m.group(1))
    212                 subcomplex = SimplicialComplex([[v]])
    213         else:

ValueError: invalid literal for int() with base 10: "'a'"
```
Its a bit of a variant of #14578: caching for mutable objects is fragile. Its difficult to get right, and even if you do you'll break it when you make changes in the future.

The right thing to do is to make cell complexes immutable, and `add_face` / `remove_face` return new cell complexes. With an `add_faces` analogue to add multiple faces in one go to avoid performance issues. Bonus: the cell complexes can then be parents for chains. Thoughts?



---

archive/issue_comments_167316.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI certainly agree that the `add_face` method is overly complicated now. I wouldn't mind making everything immutable. Anyone else have any objections? \n\nRegarding \"With #14595 this leads to the following doctest failure --- which notation do we prefer for the homology groups?\" I have a slight preference for\n\n```\n{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}\n```\nbut I don't feel strongly about it.",
    "created_at": "2013-06-21T21:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167316",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

I certainly agree that the `add_face` method is overly complicated now. I wouldn't mind making everything immutable. Anyone else have any objections? 

Regarding "With #14595 this leads to the following doctest failure --- which notation do we prefer for the homology groups?" I have a slight preference for

```
{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}
```
but I don't feel strongly about it.



---

archive/issue_comments_167317.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nBy the way, the immutability issue was discussed [here](https://github.com/sagemath/sage/issues/12587#comment:4), where there were objections to making complexes immutable.",
    "created_at": "2013-06-21T21:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167317",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

By the way, the immutability issue was discussed [here](https://github.com/sagemath/sage/issues/12587#comment:4), where there were objections to making complexes immutable.



---

archive/issue_comments_167318.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIf we are going to do this, we should also make `remove_faces` be able to remove multiple faces as well. I will be okay with them being immutable.",
    "created_at": "2013-06-22T07:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167318",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

If we are going to do this, we should also make `remove_faces` be able to remove multiple faces as well. I will be okay with them being immutable.



---

archive/issue_comments_167319.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI have the same installation problem as originally reported with SuSE when using Sage 5.10 on OS X.   Sage ships with its own version of gcc on this platform (currently 4.7.3), so any OS X user with Sage 5.10 will experience this issue as well if they try to install Chomp.  \n\nI tried the updated Chomp package at the above link and it installed and works fine.",
    "created_at": "2013-07-07T23:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167319",
    "user": "https://github.com/NathanDunfield"
}
```

<div id="comment:9" align="right">comment:9</div>

I have the same installation problem as originally reported with SuSE when using Sage 5.10 on OS X.   Sage ships with its own version of gcc on this platform (currently 4.7.3), so any OS X user with Sage 5.10 will experience this issue as well if they try to install Chomp.  

I tried the updated Chomp package at the above link and it installed and works fine.



---

archive/issue_comments_167320.json:
```json
{
    "body": "Updated patch",
    "created_at": "2013-07-08T03:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167320",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_167321.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAttachment: **[trac_14076_chomp_update.patch.gz](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)**\n\nOk I added a patch that fixes the trivial doctest failure and un-caches the `self._numeric`. Once the simplicial complexes are unique we can easily cache the `_numeric` check, though its only linear in the number of vertices so its highly unlikely to be a performance bottleneck.\n\nReady for review...",
    "created_at": "2013-07-08T03:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167321",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

Attachment: **[trac_14076_chomp_update.patch.gz](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)**

Ok I added a patch that fixes the trivial doctest failure and un-caches the `self._numeric`. Once the simplicial complexes are unique we can easily cache the `_numeric` check, though its only linear in the number of vertices so its highly unlikely to be a performance bottleneck.

Ready for review...



---

archive/issue_events_196057.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-08T03:51:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196057"
}
```



---

archive/issue_comments_167322.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe answers given by CHomP and Sage without CHomP for the homology generators of `C_k` are different: without CHomP:\n\n```\n{0: [(Z, (1))], 1: [(C2, (1, 0, 0)), (Z, (0, 0, 1))], 2: [(0, ())]}\n```\nWith CHomP:\n\n```\n{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}\n```\nAs far as I can tell, the non-CHomP answer is correct: (1,0,0) generates a copy of `C_2`, because (2,0,0) is in the image of the differential `d_2`, while (0,0,2) is not in the image, so (0,0,1) does not generate a copy of `C_2`. I haven't yet investigated whether this is a problem in CHomP (which I doubt) or a problem in how we are translating CHomP's answers (more likely).",
    "created_at": "2013-07-08T05:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167322",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">comment:11</div>

The answers given by CHomP and Sage without CHomP for the homology generators of `C_k` are different: without CHomP:

```
{0: [(Z, (1))], 1: [(C2, (1, 0, 0)), (Z, (0, 0, 1))], 2: [(0, ())]}
```
With CHomP:

```
{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}
```
As far as I can tell, the non-CHomP answer is correct: (1,0,0) generates a copy of `C_2`, because (2,0,0) is in the image of the differential `d_2`, while (0,0,2) is not in the image, so (0,0,1) does not generate a copy of `C_2`. I haven't yet investigated whether this is a problem in CHomP (which I doubt) or a problem in how we are translating CHomP's answers (more likely).



---

archive/issue_comments_167323.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nBy the way, in order to make simplicial complexes unique, do we need to deprecate `add_face` and `remove_face` (since we need to change their functionality)? Any ideas for names for methods to replace them, which add/remove faces but return new complexes?",
    "created_at": "2013-07-08T15:52:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167323",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

By the way, in order to make simplicial complexes unique, do we need to deprecate `add_face` and `remove_face` (since we need to change their functionality)? Any ideas for names for methods to replace them, which add/remove faces but return new complexes?



---

archive/issue_comments_167324.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nMaking simplicial complexes immutable isn't something that can be done gradually, so code that relies on them being mutable will necessarily break. \n\nHaving said that, I never was very fond of the `add/remove_face`. To me, that implies that you have already a higher-dimensional cell to which you are adding a boundary cell. I would prefer `add_simplex` (for simplicial complexes) or maybe just `add_cell` (same interface for all cell complexes).\n\nI agree that components of the torsion generator are reversed, will have a look at that.",
    "created_at": "2013-07-08T16:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167324",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

Making simplicial complexes immutable isn't something that can be done gradually, so code that relies on them being mutable will necessarily break. 

Having said that, I never was very fond of the `add/remove_face`. To me, that implies that you have already a higher-dimensional cell to which you are adding a boundary cell. I would prefer `add_simplex` (for simplicial complexes) or maybe just `add_cell` (same interface for all cell complexes).

I agree that components of the torsion generator are reversed, will have a look at that.



---

archive/issue_comments_167325.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nChomP actually uses `(0,1,-1)` as `Z_2` generator and `(0,0,1)` as free generator, we are mixing up the free and torsion part:\n\n```\nsage: c.homology(verbose=True, generators=True)\nChain complex over Integer Ring\nPopen called with arguments ['homchain', '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j', '', '-g/home/vbraun/.sage/temp/laptop/5244/tmp_zVMC6I']\n\nCHomP output:\n\nHOMCHAIN, ver. 2.08, 10/07/04. Copyright (C) 1997-2013 by Pawel Pilarczyk.\nThis is free software. No warranty. Consult 'license.txt' for details.\n[Tech info: chain 24, addr 8, intgr 2.]\nReading a chain complex from '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'...\nTime used so far: 0.00 sec (0.000 min).\nThe ring of coefficients is the ring of integers.\nComputing the homology of the chain complex...\nReducing D_2: 0 + 2 reductions made. \nReducing D_1: 0 + 0 reductions made. \nH_0 = Z\nH_1 = Z_2 + Z\nWriting the homology generators of CX to '/home/vbraun/.sage/temp/laptop/5244/tmp_zVMC6I'...\nTotal time used: 0.00 sec (0.000 min).\nThank you for using this software. We appreciate your business.\n\nEnd of CHomP output\n\nGenerators:\n; This file contains the generators of the homology module\n; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.\n\n[H_0]\na1\n\n[H_1]\na2 - a3\na3\n\n[H_2]\n\n('0', 'Z')\ndimension = 0, number of factors = 1, invariants = [0]\nraw generators: ; This file contains the generators of the homology module\n; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.\n\n[H_0]\na1\n\n[H_1]\na2 - a3\na3\n\n[H_2]\n\n('1', 'Z_2 + Z')\ndimension = 1, number of factors = 2, invariants = [2, 0]\nraw generators: ; This file contains the generators of the homology module\n; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.\n\n[H_0]\na1\n\n[H_1]\na2 - a3\na3\n\n[H_2]\n\n{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}\n```",
    "created_at": "2013-07-08T16:40:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167325",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">comment:14</div>

ChomP actually uses `(0,1,-1)` as `Z_2` generator and `(0,0,1)` as free generator, we are mixing up the free and torsion part:

```
sage: c.homology(verbose=True, generators=True)
Chain complex over Integer Ring
Popen called with arguments ['homchain', '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j', '', '-g/home/vbraun/.sage/temp/laptop/5244/tmp_zVMC6I']

CHomP output:

HOMCHAIN, ver. 2.08, 10/07/04. Copyright (C) 1997-2013 by Pawel Pilarczyk.
This is free software. No warranty. Consult 'license.txt' for details.
[Tech info: chain 24, addr 8, intgr 2.]
Reading a chain complex from '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'...
Time used so far: 0.00 sec (0.000 min).
The ring of coefficients is the ring of integers.
Computing the homology of the chain complex...
Reducing D_2: 0 + 2 reductions made. 
Reducing D_1: 0 + 0 reductions made. 
H_0 = Z
H_1 = Z_2 + Z
Writing the homology generators of CX to '/home/vbraun/.sage/temp/laptop/5244/tmp_zVMC6I'...
Total time used: 0.00 sec (0.000 min).
Thank you for using this software. We appreciate your business.

End of CHomP output

Generators:
; This file contains the generators of the homology module
; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.

[H_0]
a1

[H_1]
a2 - a3
a3

[H_2]

('0', 'Z')
dimension = 0, number of factors = 1, invariants = [0]
raw generators: ; This file contains the generators of the homology module
; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.

[H_0]
a1

[H_1]
a2 - a3
a3

[H_2]

('1', 'Z_2 + Z')
dimension = 1, number of factors = 2, invariants = [2, 0]
raw generators: ; This file contains the generators of the homology module
; of the chain complex read from  the file '/home/vbraun/.sage/temp/laptop/5244/tmp_ZZ8Q1j'.

[H_0]
a1

[H_1]
a2 - a3
a3

[H_2]

{0: (Z, [(1)]), 1: (Z x C2, [(0, 1, -1), (0, 0, 1)])}
```



---

archive/issue_comments_167326.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nRight, I have a patch for this, coming up.",
    "created_at": "2013-07-08T17:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167326",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

Right, I have a patch for this, coming up.



---

archive/issue_comments_167327.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOkay, here's a patch which sorts the list of generators so it matches the sorted list of abelian group invariants. It also fixes one bug (a missing argument in a call to `suspension`), and also modifies two of your new doctests: on OS X vs. linux, `sorted(['a', 'b', 123])` yield different results (on sage.math, 123 is first; on OS X, 123 is last).",
    "created_at": "2013-07-08T17:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167327",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Okay, here's a patch which sorts the list of generators so it matches the sorted list of abelian group invariants. It also fixes one bug (a missing argument in a call to `suspension`), and also modifies two of your new doctests: on OS X vs. linux, `sorted(['a', 'b', 123])` yield different results (on sage.math, 123 is first; on OS X, 123 is last).



---

archive/issue_comments_167328.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2013-07-08T17:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167328",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_167329.json:
```json
{
    "body": "Attachment: **[trac_14076-more-chomp-fixes.patch.gz](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)**\n\napply second",
    "created_at": "2013-07-08T17:17:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167329",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_14076-more-chomp-fixes.patch.gz](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)**

apply second



---

archive/issue_comments_167330.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nBy the way, I'm happy with your patch.",
    "created_at": "2013-07-08T17:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167330",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

By the way, I'm happy with your patch.



---

archive/issue_comments_167331.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.\n \n Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg\n+\n+By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a vote on this in sage-devel over two years ago to make this change, but I think it never happened.\n+\n``````\n",
    "created_at": "2013-07-08T17:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167331",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 Currently (Sage 5.7.beta3) on `OpenSuse 12.2` with gcc version 4.7.1 20120723 the CHomP package (version chomp-20100213.p2) can't be installed. This is all fixed in the latest upstream version.
 
 Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg
+
+By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a vote on this in sage-devel over two years ago to make this change, but I think it never happened.
+
``````




---

archive/issue_comments_167332.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,4 @@\n \n Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg\n \n-By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a vote on this in sage-devel over two years ago to make this change, but I think it never happened.\n-\n+By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.\n``````\n",
    "created_at": "2013-07-08T17:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167332",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,4 @@
 
 Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg
 
-By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a vote on this in sage-devel over two years ago to make this change, but I think it never happened.
-
+By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.
``````




---

archive/issue_comments_167333.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nDoctests pass for me, looks good!",
    "created_at": "2013-07-08T17:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167333",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

Doctests pass for me, looks good!



---

archive/issue_events_196058.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-08T17:31:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196058"
}
```



---

archive/issue_events_196059.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-08T17:31:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196059"
}
```



---

archive/issue_comments_167334.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,7 @@\n Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg\n \n By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.\n+\n+Apply to the Sage library:\n+* [attachment: trac_14076_chomp_update.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)\n+* [attachment: trac_14076-more-chomp-fixes.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)\n``````\n",
    "created_at": "2013-07-08T17:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167334",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,7 @@
 Updated optional spkg: http://boxen.math.washington.edu/home/vbraun/spkg/chomp-20130518.p0.spkg
 
 By the way, this should be added to the **optional** spkgs, not the experimental ones (and the old one should be removed from the experimental list): there was a [vote on this in sage-devel](https://groups.google.com/d/msg/sage-devel/HLxXNpykXm8/ncLCEUrVaJQJ) over two years ago to make this change, but I think it never happened.
+
+Apply to the Sage library:
+* [attachment: trac_14076_chomp_update.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076_chomp_update.patch.gz)
+* [attachment: trac_14076-more-chomp-fixes.patch](https://github.com/sagemath/sage/files/ticket14076/trac_14076-more-chomp-fixes.patch.gz)
``````




---

archive/issue_comments_167335.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nspkg landed in optional on the server/mirrors and the older experimental one is gone (thx for the history lesson, at least i never got notified about this)",
    "created_at": "2013-07-08T18:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167335",
    "user": "https://github.com/haraldschilly"
}
```

<div id="comment:20" align="right">comment:20</div>

spkg landed in optional on the server/mirrors and the older experimental one is gone (thx for the history lesson, at least i never got notified about this)



---

archive/issue_comments_167336.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThanks, Harald. Just to be clear, my message was purely informational, absolutely no criticism was intended. I assumed that no one had told you before, and this upgrade to the spkg was a good time to take care of it.",
    "created_at": "2013-07-08T21:15:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167336",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

Thanks, Harald. Just to be clear, my message was purely informational, absolutely no criticism was intended. I assumed that no one had told you before, and this upgrade to the spkg was a good time to take care of it.



---

archive/issue_comments_167337.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nlanguage barrier alert. i didn't mean it that way ;-)",
    "created_at": "2013-07-08T21:17:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167337",
    "user": "https://github.com/haraldschilly"
}
```

<div id="comment:22" align="right">comment:22</div>

language barrier alert. i didn't mean it that way ;-)



---

archive/issue_comments_167338.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n(I didn't think so, but I wanted to be clear.)",
    "created_at": "2013-07-08T21:51:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167338",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

(I didn't think so, but I wanted to be clear.)



---

archive/issue_comments_167339.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThere are a few very minor issues with the spkg that I didn't catch. Follow-up ticket: #14872.",
    "created_at": "2013-07-09T17:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167339",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

There are a few very minor issues with the spkg that I didn't catch. Follow-up ticket: #14872.



---

archive/issue_events_196060.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-31T12:54:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196060"
}
```



---

archive/issue_events_196061.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-31T12:54:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14076#event-196061"
}
```



---

archive/issue_comments_167340.json:
```json
{
    "body": "Merged: **sage-5.11.rc0**",
    "created_at": "2013-07-31T12:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14076",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14076#issuecomment-167340",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.11.rc0**
