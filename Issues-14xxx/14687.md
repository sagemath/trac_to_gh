# Issue 14687: Extra readline commands not working

archive/issues_014483.json:
```json
{
    "body": "After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.\n\nApply to the scripts:\n* [attachment:trac_14687-scripts.patch]\n\nApply (to the sage library): \n* [attachment:trac_14687.patch]\n\n**Assignee:** @williamstein\n\n**CC:**  @dimpase\n\n**Reviewer:** Dmitrii Pasechnik\n\n**Author:** Kwankyu Lee\n\n**Merged:** sage-5.11.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/14687\n\n",
    "closed_at": "2013-06-10T08:42:38Z",
    "created_at": "2013-06-05T01:59:21Z",
    "labels": [
        "component: user interface",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.11",
    "title": "Extra readline commands not working",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14687",
    "user": "https://github.com/kwankyu"
}
```
After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.

Apply to the scripts:
* [attachment:trac_14687-scripts.patch]

Apply (to the sage library): 
* [attachment:trac_14687.patch]

**Assignee:** @williamstein

**CC:**  @dimpase

**Reviewer:** Dmitrii Pasechnik

**Author:** Kwankyu Lee

**Merged:** sage-5.11.beta1

Issue created by migration from https://trac.sagemath.org/ticket/14687





---

archive/attachments_019774.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14687-scripts.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14687/trac_14687-scripts.patch",
    "created_at": "2013-06-05T02:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kwankyu"
}
```



---

archive/issue_comments_220641.json:
```json
{
    "body": "To scripts repository",
    "created_at": "2013-06-05T02:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220641",
    "user": "https://github.com/kwankyu"
}
```

To scripts repository



---

archive/issue_comments_220642.json:
```json
{
    "body": "**Author:** Kwankyu Lee",
    "created_at": "2013-06-05T04:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220642",
    "user": "https://github.com/kwankyu"
}
```

**Author:** Kwankyu Lee



---

archive/issue_comments_220643.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.\n+\n+Apply to the scripts repository: trac_14687-scripts.patch\n+Apply to the sage library: trac_14687.patch\n``````\n",
    "created_at": "2013-06-05T04:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220643",
    "user": "https://github.com/kwankyu"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.
+
+Apply to the scripts repository: trac_14687-scripts.patch
+Apply to the sage library: trac_14687.patch
``````




---

archive/issue_comments_220644.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.\n \n Apply to the scripts repository: trac_14687-scripts.patch\n+\n Apply to the sage library: trac_14687.patch\n``````\n",
    "created_at": "2013-06-05T04:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220644",
    "user": "https://github.com/kwankyu"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
 After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.
 
 Apply to the scripts repository: trac_14687-scripts.patch
+
 Apply to the sage library: trac_14687.patch
``````




---

archive/issue_comments_220645.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-06-05T04:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220645",
    "user": "https://github.com/kwankyu"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_220646.json:
```json
{
    "body": "<a id='comment:5'></a>\nI am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).\n\nHitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).\n\n\n`history-search-forward-and-save` does not work at all.\n\nSame with Sage 5.10.rc0 on Linux.",
    "created_at": "2013-06-06T05:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220646",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
I am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).

Hitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).


`history-search-forward-and-save` does not work at all.

Same with Sage 5.10.rc0 on Linux.



---

archive/issue_comments_220647.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [dimpase](#comment%3A5):\n> I am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).\n> \n> Hitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).\n> \n> \n> `history-search-forward-and-save` does not work at all.\n> \n\n\nOops, I am stupid. Now I see that the instructions on enabling this have changed!\n\nWill report shortly.",
    "created_at": "2013-06-06T05:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220647",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Replying to [dimpase](#comment%3A5):
> I am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).
> 
> Hitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).
> 
> 
> `history-search-forward-and-save` does not work at all.
> 


Oops, I am stupid. Now I see that the instructions on enabling this have changed!

Will report shortly.



---

archive/issue_comments_220648.json:
```json
{
    "body": "<a id='comment:7'></a>\nPlease be more specific in your patch about `ipython_config.py`?\nCurrently you just say \n\n```\nIPython configuration file  ``ipython_config.py``\n```\n\nIs it still supposed to be in `$DOT_SAGE/ipython/` ?\n\nI do not have a file so named there. On OSX 10.6.8 system the only `.py` files are \n\n```\n$ ls -l ~/.sage/ipython/*.py\n-rw-r--r--  1 dima  staff  2361 Nov 24  2012 /Users/dima/.sage/ipython/ipy_profile_sh.py\n-rw-r--r--  1 dima  staff   836 Nov 24  2012 /Users/dima/.sage/ipython/ipy_user_conf.py\n```\n\nAnd a very similar picture on Linux.",
    "created_at": "2013-06-06T05:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220648",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Please be more specific in your patch about `ipython_config.py`?
Currently you just say 

```
IPython configuration file  ``ipython_config.py``
```

Is it still supposed to be in `$DOT_SAGE/ipython/` ?

I do not have a file so named there. On OSX 10.6.8 system the only `.py` files are 

```
$ ls -l ~/.sage/ipython/*.py
-rw-r--r--  1 dima  staff  2361 Nov 24  2012 /Users/dima/.sage/ipython/ipy_profile_sh.py
-rw-r--r--  1 dima  staff   836 Nov 24  2012 /Users/dima/.sage/ipython/ipy_user_conf.py
```

And a very similar picture on Linux.



---

archive/issue_comments_220649.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-06-06T05:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220649",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_220650.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe specific location for the IPython configuration file is\n\n```\n.sage/ipython-0.12/profile_sage/ipython_config.py\n```\nand you need to create the configuration file if it is absent. \n\nI was reluctant to be this specific about the location since it seems to me that the directory name \"ipython-0.12\" is doomed to change someday, and the exact location, I think, should be documented elsewhere.",
    "created_at": "2013-06-06T08:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220650",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:9'></a>
The specific location for the IPython configuration file is

```
.sage/ipython-0.12/profile_sage/ipython_config.py
```
and you need to create the configuration file if it is absent. 

I was reluctant to be this specific about the location since it seems to me that the directory name "ipython-0.12" is doomed to change someday, and the exact location, I think, should be documented elsewhere.



---

archive/issue_comments_220651.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [klee](#comment%3A9):\n> The specific location for the IPython configuration file is\n> \n> ```\n> .sage/ipython-0.12/profile_sage/ipython_config.py\n> ```\n> and you need to create the configuration file if it is absent. \n> \n> I was reluctant to be this specific about the location since it seems to me that the directory name \"ipython-0.12\" is doomed to change someday, and the exact location, I think, should be documented elsewhere. \n\n\nWell, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.\n\n```\n To bind these commands with keys, insert the relevant lines into the IPython config file \n ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  \nNote that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, \nin Sage 5.11, ``<version_number>`` is 0.12. For example, \n```\n \nAfter this, I'll be happy to give it positive review (it actually works just fine).\n\nFeel free to open a ticket on documenting the location of `ipython_config.py` properly.",
    "created_at": "2013-06-06T17:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220651",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Replying to [klee](#comment%3A9):
> The specific location for the IPython configuration file is
> 
> ```
> .sage/ipython-0.12/profile_sage/ipython_config.py
> ```
> and you need to create the configuration file if it is absent. 
> 
> I was reluctant to be this specific about the location since it seems to me that the directory name "ipython-0.12" is doomed to change someday, and the exact location, I think, should be documented elsewhere. 


Well, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.

```
 To bind these commands with keys, insert the relevant lines into the IPython config file 
 ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  
Note that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, 
in Sage 5.11, ``<version_number>`` is 0.12. For example, 
```
 
After this, I'll be happy to give it positive review (it actually works just fine).

Feel free to open a ticket on documenting the location of `ipython_config.py` properly.



---

archive/issue_comments_220652.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [dimpase](#comment%3A10):\n> Well, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.\n> \n> ```\n>  To bind these commands with keys, insert the relevant lines into the IPython config file \n>  ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  \n> Note that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, \n> in Sage 5.11, ``<version_number>`` is 0.12. For example, \n> ```\n\n\nThe directory name is fixed as \"ipython-0.12\". On a discussion about the name, \"ipython-0.12-or-later\" was suggested, but the final name was settled to as it is now. My opinion is that the name was ill-chosen, as it confuses users, at least you and me. :-) Anyway, currently it is officially \"ipython-0.12\".\n\nSo I will update the patch just now accepting the official location.",
    "created_at": "2013-06-07T00:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220652",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:11'></a>
Replying to [dimpase](#comment%3A10):
> Well, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.
> 
> ```
>  To bind these commands with keys, insert the relevant lines into the IPython config file 
>  ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  
> Note that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, 
> in Sage 5.11, ``<version_number>`` is 0.12. For example, 
> ```


The directory name is fixed as "ipython-0.12". On a discussion about the name, "ipython-0.12-or-later" was suggested, but the final name was settled to as it is now. My opinion is that the name was ill-chosen, as it confuses users, at least you and me. :-) Anyway, currently it is officially "ipython-0.12".

So I will update the patch just now accepting the official location.



---

archive/issue_comments_220653.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-06-07T00:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220653",
    "user": "https://github.com/kwankyu"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_220654.json:
```json
{
    "body": "To sage library",
    "created_at": "2013-06-07T01:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220654",
    "user": "https://github.com/kwankyu"
}
```

To sage library



---

archive/issue_comments_220655.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,7 @@\n After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.\n \n-Apply to the scripts repository: trac_14687-scripts.patch\n+Apply to the scripts:\n+* [attachment:trac_14687-scripts.patch]\n \n-Apply to the sage library: trac_14687.patch\n+Apply (to the sage library): \n+* [attachment:trac_14687.patch]\n``````\n",
    "created_at": "2013-06-07T06:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220655",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,7 @@
 After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.
 
-Apply to the scripts repository: trac_14687-scripts.patch
+Apply to the scripts:
+* [attachment:trac_14687-scripts.patch]
 
-Apply to the sage library: trac_14687.patch
+Apply (to the sage library): 
+* [attachment:trac_14687.patch]
``````




---

archive/issue_comments_220656.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-06-07T06:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220656",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to positive_review.



---

archive/attachments_019775.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14687.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14687/trac_14687.patch",
    "created_at": "2013-06-07T06:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_220657.json:
```json
{
    "body": "<a id='comment:13'></a>\n",
    "created_at": "2013-06-07T06:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220657",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>




---

archive/issue_comments_220658.json:
```json
{
    "body": "**Reviewer:** Dmitrii Pasechnik",
    "created_at": "2013-06-07T10:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220658",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Dmitrii Pasechnik



---

archive/issue_comments_220659.json:
```json
{
    "body": "**Merged:** sage-5.11.beta1",
    "created_at": "2013-06-10T08:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220659",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.11.beta1



---

archive/issue_events_047948.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-10T08:42:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14687#event-47948"
}
```



---

archive/issue_comments_220660.json:
```json
{
    "body": "<a id='comment:16'></a>\nit looks as if `ipython_config.py` is removed each time Sage is updated.\nThis is not good. There should be some other location for persistent settings like this one...",
    "created_at": "2013-06-17T11:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14687#issuecomment-220660",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
it looks as if `ipython_config.py` is removed each time Sage is updated.
This is not good. There should be some other location for persistent settings like this one...
