# Issue 14040: Configurable "tall list" output style

archive/issues_013836.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout"
    ],
    "body": "The displayhook pretty-prints lists/tuples of matrices in a readable way:\n\n```\nsage: m = random_matrix(GF(5),2)                                      \nsage: [ m, m^2, m^3 ]  \n[\n[1 4]  [4 2]  [3 0]\n[2 2], [1 2], [0 3]\n]\n```\nBut this is hardcoded to only apply to matrix types:\n\n```\nsage: MatrixGroup([m,m^2,m^3]).gens()\n[[1 4]\n[2 2], [4 2]\n[1 2], [3 0]\n[0 3]]\n```\nThis ticket aims to add a `_repr_option(key)` method to **parents** to be able to return meta-information on the `_repr_()` output. In particular, `_repr_option('element_ascii_art')` will return a boolean that switches between the list display hooks.\n\nI've also change the displayhook to switch to the list pretty printing if *any* entry is an ascii-art element, not just the first one. This upsets a handful of doctests, but is still quite low impact.\n\nApply\n\n* [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)\n* [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)\n* [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)\n* [attachment: trac_14040_review.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)\n\n\nDepends on #13618\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Volker Braun**\n\nMerged: **sage-5.8.beta2**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14040_\n\n",
    "closed_at": "2013-02-28T10:34:22Z",
    "created_at": "2013-01-30T12:31:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Configurable \"tall list\" output style",
    "type": "issue",
    "updated_at": "2013-02-28T10:34:22Z",
    "url": "https://github.com/sagemath/sage/issues/14040",
    "user": "https://github.com/vbraun"
}
```
The displayhook pretty-prints lists/tuples of matrices in a readable way:

```
sage: m = random_matrix(GF(5),2)                                      
sage: [ m, m^2, m^3 ]  
[
[1 4]  [4 2]  [3 0]
[2 2], [1 2], [0 3]
]
```
But this is hardcoded to only apply to matrix types:

```
sage: MatrixGroup([m,m^2,m^3]).gens()
[[1 4]
[2 2], [4 2]
[1 2], [3 0]
[0 3]]
```
This ticket aims to add a `_repr_option(key)` method to **parents** to be able to return meta-information on the `_repr_()` output. In particular, `_repr_option('element_ascii_art')` will return a boolean that switches between the list display hooks.

I've also change the displayhook to switch to the list pretty printing if *any* entry is an ascii-art element, not just the first one. This upsets a handful of doctests, but is still quite low impact.

Apply

* [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)
* [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)
* [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)
* [attachment: trac_14040_review.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)


Depends on #13618

Reviewer: **Travis Scrimshaw**

Author: **Volker Braun**

Merged: **sage-5.8.beta2**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/14040_





---

archive/issue_events_198179.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-30T12:31:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198179"
}
```



---

archive/issue_events_198180.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-30T12:31:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198180"
}
```



---

archive/issue_events_198181.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-30T12:31:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198181"
}
```



---

archive/issue_events_198182.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2013-01-30T12:31:55Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "subject": "https://github.com/vbraun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198182"
}
```



---

archive/issue_events_198183.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-30T12:32:13Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "title_is": "Configurable \"tall list\" output style",
    "title_was": "Configurable \"tall list\" output styl",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198183"
}
```



---

archive/issue_comments_166575.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI've also folded the `is_atomic_repr()` methods that some parents carried into this framework. Here is the method docstring for reference:\n\n```\n    def _repr_option(self, key):\n        \"\"\"\n        Metadata about the :meth:`_repr_` output.\n\n        INPUT:\n        \n        - ``key`` -- string. A key for different metadata informations\n          that can be inquired about.\n\n        Valid ``key`` arguments are:\n        \n        - ``'ascii_art'``: The :meth:`_repr_` output is multi-line\n          ascii art and each line must be printed starting at the same\n          column, or the meaning is lost.\n\n        - ``'element_ascii_art'``: same but for the output of the\n          elements. Used in :mod:`sage.misc.displayhook`.\n\n        - ``'element_is_atomic'``: the elements print atomically, that\n          is, parenthesis are not required when *printing* out any of\n          `x - y`, `x + y`, `x^y` and `x/y`.\n\n        OUTPUT:\n        \n        Boolean.\n\n        EXAMPLES::\n\n            sage: ZZ._repr_option('ascii_art')\n            False\n            sage: MatrixSpace(ZZ, 2)._repr_option('element_ascii_art')\n            True\n        \"\"\"\n```",
    "created_at": "2013-01-30T18:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166575",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

I've also folded the `is_atomic_repr()` methods that some parents carried into this framework. Here is the method docstring for reference:

```
    def _repr_option(self, key):
        """
        Metadata about the :meth:`_repr_` output.

        INPUT:
        
        - ``key`` -- string. A key for different metadata informations
          that can be inquired about.

        Valid ``key`` arguments are:
        
        - ``'ascii_art'``: The :meth:`_repr_` output is multi-line
          ascii art and each line must be printed starting at the same
          column, or the meaning is lost.

        - ``'element_ascii_art'``: same but for the output of the
          elements. Used in :mod:`sage.misc.displayhook`.

        - ``'element_is_atomic'``: the elements print atomically, that
          is, parenthesis are not required when *printing* out any of
          `x - y`, `x + y`, `x^y` and `x/y`.

        OUTPUT:
        
        Boolean.

        EXAMPLES::

            sage: ZZ._repr_option('ascii_art')
            False
            sage: MatrixSpace(ZZ, 2)._repr_option('element_ascii_art')
            True
        """
```



---

archive/issue_comments_166576.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,3 +18,12 @@\n [0 3]]\n ```\n This ticket aims to add a `_repr_option(key)` method to **parents** to be able to return meta-information on the `_repr_()` output. In particular, `_repr_option('element_ascii_art')` will return a boolean that switches between the list display hooks.\n+\n+I've also change the displayhook to switch to the list pretty printing if *any* entry is an ascii-art element, not just the first one. This upsets a handful of doctests, but is still quite low impact.\n+\n+Apply\n+\n+* [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)\n+* [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)\n+* [attachment: trac_14040_doctests.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctests.patch.gz)\n+\n``````\n",
    "created_at": "2013-01-30T19:56:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166576",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,3 +18,12 @@
 [0 3]]
 ```
 This ticket aims to add a `_repr_option(key)` method to **parents** to be able to return meta-information on the `_repr_()` output. In particular, `_repr_option('element_ascii_art')` will return a boolean that switches between the list display hooks.
+
+I've also change the displayhook to switch to the list pretty printing if *any* entry is an ascii-art element, not just the first one. This upsets a handful of doctests, but is still quite low impact.
+
+Apply
+
+* [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)
+* [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)
+* [attachment: trac_14040_doctests.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctests.patch.gz)
+
``````




---

archive/issue_comments_166577.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2013-01-30T19:56:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166577",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_198184.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-30T22:26:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198184"
}
```



---

archive/issue_comments_166578.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nSince you're doing some cleanup, please forgive me nitpicking but you missed `trac ticket #10467` on line 610 of `parent.pyx` and the [coding convention page](http://www.sagemath.org/doc/developer/conventions.html) prefers `.. TODO::` and `.. NOTE::` blocks.\n\nBest,\n\nTravis",
    "created_at": "2013-01-31T00:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166578",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

Since you're doing some cleanup, please forgive me nitpicking but you missed `trac ticket #10467` on line 610 of `parent.pyx` and the [coding convention page](http://www.sagemath.org/doc/developer/conventions.html) prefers `.. TODO::` and `.. NOTE::` blocks.

Best,

Travis



---

archive/issue_comments_166579.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHow badly is this going to interfere with classes that use string representations for hashing and comparison, both for time and for unexpected results? If a `_repr_option` gets changed (can they?) will element hash values suddenly change?\n\nAlso, I think there can be quite some exception raising in coercion discovery. Since error messages sometimes include operands, slowing down string conversions can possibly affect performance there too.\n\n(That's a bit of a general problem: normally you'd think that by the time you're making string representations, you don't have to worry about basic speed any more. I'm not so sure that holds in Sage)",
    "created_at": "2013-01-31T01:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166579",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:6" align="right">comment:6</div>

How badly is this going to interfere with classes that use string representations for hashing and comparison, both for time and for unexpected results? If a `_repr_option` gets changed (can they?) will element hash values suddenly change?

Also, I think there can be quite some exception raising in coercion discovery. Since error messages sometimes include operands, slowing down string conversions can possibly affect performance there too.

(That's a bit of a general problem: normally you'd think that by the time you're making string representations, you don't have to worry about basic speed any more. I'm not so sure that holds in Sage)



---

archive/issue_comments_166580.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nNils, there is nothing user-configurable here. Its about metadata, not a configuration system. The only one who should change the `_repr_option()` output is the `Parent` author. This is also why its an underscore method.\n\n\nFor the patchbot who can't get the order right: \n\napply trac_14040_housekeeping.patch trac_14040_repr_option.patch trac_14040_doctest.patch",
    "created_at": "2013-01-31T10:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166580",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

Nils, there is nothing user-configurable here. Its about metadata, not a configuration system. The only one who should change the `_repr_option()` output is the `Parent` author. This is also why its an underscore method.


For the patchbot who can't get the order right: 

apply trac_14040_housekeeping.patch trac_14040_repr_option.patch trac_14040_doctest.patch



---

archive/issue_comments_166581.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI've also fixed the docstrings in the first patch.",
    "created_at": "2013-01-31T10:06:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166581",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

I've also fixed the docstrings in the first patch.



---

archive/issue_comments_166582.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,5 +25,5 @@\n \n * [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)\n * [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)\n-* [attachment: trac_14040_doctests.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctests.patch.gz)\n+* [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)\n \n``````\n",
    "created_at": "2013-01-31T15:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166582",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,5 +25,5 @@
 
 * [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)
 * [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)
-* [attachment: trac_14040_doctests.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctests.patch.gz)
+* [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)
 
``````




---

archive/issue_comments_166583.json:
```json
{
    "body": "Attachment: **[trac_14040_housekeeping.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)**\n\nUpdated patch",
    "created_at": "2013-02-01T15:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166583",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_14040_housekeeping.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)**

Updated patch



---

archive/issue_comments_166584.json:
```json
{
    "body": "Updated patch",
    "created_at": "2013-02-01T15:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166584",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_166585.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAttachment: **[trac_14040_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)**\n\nI've rebased the patches on top of sage-5.7.beta2. Older version will likely not work fyi.",
    "created_at": "2013-02-01T15:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166585",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

Attachment: **[trac_14040_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)**

I've rebased the patches on top of sage-5.7.beta2. Older version will likely not work fyi.



---

archive/issue_comments_166586.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRebased to sage-5.7.beta4. Since this patch touches a couple of disparate places I would appreciate if somebody could review it so I don't have to spend my time rebasing it for every new beta.",
    "created_at": "2013-02-12T14:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166586",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

Rebased to sage-5.7.beta4. Since this patch touches a couple of disparate places I would appreciate if somebody could review it so I don't have to spend my time rebasing it for every new beta.



---

archive/issue_comments_166587.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHey Volker,\n\nI have a few questions/comments:\n\n- Just to make sure, these are options that belong to individual `Parent` subclasses, not a global setting, correct?\n\n- There's some strange formatting of commas, for example on line 71 of `quadratic_form__local_field_invariants.py`:\n\n```\n( \nQuadratic form in 4 variables over Rational Field with coefficients:  \n[ 1 0 0 0 ]                                                          #\n[ * 3 0 0 ]                                                          #\n[ * * 5 0 ]                                                          #\n[ * * * 7 ]                                                          ,\n<BLANKLINE>\n[1 0 0 0]\n[0 0 0 1]\n) \n```\n  I've put the pounds `#` to signify where the whitespace ends.\n\n- Could you put the None in code formatting: <code>\\`\\`None\\`\\`</code> on line 129 in `displayhook.py`.\n\nIt currently looks good to me otherwise.\n\nThank you,\n\nTravis",
    "created_at": "2013-02-19T15:43:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166587",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Hey Volker,

I have a few questions/comments:

- Just to make sure, these are options that belong to individual `Parent` subclasses, not a global setting, correct?

- There's some strange formatting of commas, for example on line 71 of `quadratic_form__local_field_invariants.py`:

```
( 
Quadratic form in 4 variables over Rational Field with coefficients:  
[ 1 0 0 0 ]                                                          #
[ * 3 0 0 ]                                                          #
[ * * 5 0 ]                                                          #
[ * * * 7 ]                                                          ,
<BLANKLINE>
[1 0 0 0]
[0 0 0 1]
) 
```
  I've put the pounds `#` to signify where the whitespace ends.

- Could you put the None in code formatting: <code>\`\`None\`\`</code> on line 129 in `displayhook.py`.

It currently looks good to me otherwise.

Thank you,

Travis



---

archive/issue_comments_166588.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThe `_repr_option()` is meant for a particular parent, though its not a good idea to change it during the parent's lifetime (parents must be immutable). So in this sense its global, too.\n\nThe strange formatting for commas is because the displayhook treats ascii art as a square block. In this case, the width is set by \"Quadratic form in 4 variables over Rational Field with coefficients:\" and the comma is placed at the bottom right corner. It would probably be nicer if the displayhook would place the comma after the last non-whitespace character in the bottom row, but thats not the aim of this ticket.",
    "created_at": "2013-02-19T15:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166588",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

The `_repr_option()` is meant for a particular parent, though its not a good idea to change it during the parent's lifetime (parents must be immutable). So in this sense its global, too.

The strange formatting for commas is because the displayhook treats ascii art as a square block. In this case, the width is set by "Quadratic form in 4 variables over Rational Field with coefficients:" and the comma is placed at the bottom right corner. It would probably be nicer if the displayhook would place the comma after the last non-whitespace character in the bottom row, but thats not the aim of this ticket.



---

archive/issue_comments_166589.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOkay.\n\nOne last thing I noticed in the housekeeping on line 273:\n\n```\n.. TODO:: \n\nEventually, category should be Sets() by default\n```\nI would like to see this as\n\n```\n.. TODO:: \n\n    Eventually, category should be :class:`Sets` by default.\n```\nIn particular, this should be indented. Once this is done, then I'll set this to positive review.\n\nThank you,\n\nTravis",
    "created_at": "2013-02-19T16:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166589",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Okay.

One last thing I noticed in the housekeeping on line 273:

```
.. TODO:: 

Eventually, category should be Sets() by default
```
I would like to see this as

```
.. TODO:: 

    Eventually, category should be :class:`Sets` by default.
```
In particular, this should be indented. Once this is done, then I'll set this to positive review.

Thank you,

Travis



---

archive/issue_comments_166590.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2013-02-24T03:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166590",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_166591.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI'm marking this ticket dependent on the \"doctests for rings\" patch since the two conflict.",
    "created_at": "2013-02-24T03:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166591",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

I'm marking this ticket dependent on the "doctests for rings" patch since the two conflict.



---

archive/issue_comments_166592.json:
```json
{
    "body": "Dependencies: **#13685**",
    "created_at": "2013-02-24T03:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166592",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#13685**



---

archive/issue_comments_166593.json:
```json
{
    "body": "Rebased patch",
    "created_at": "2013-02-24T03:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166593",
    "user": "https://github.com/vbraun"
}
```

Rebased patch



---

archive/issue_comments_166594.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[trac_14040_repr_option.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)**\n\nThe last patch addresses your issues.",
    "created_at": "2013-02-24T03:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166594",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[trac_14040_repr_option.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)**

The last patch addresses your issues.



---

archive/issue_comments_166595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,4 +26,5 @@\n * [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)\n * [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)\n * [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)\n+* [attachment: trac_14040_review.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)\n \n``````\n",
    "created_at": "2013-02-24T03:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166595",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,4 +26,5 @@
 * [attachment: trac_14040_housekeeping.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_housekeeping.patch.gz)
 * [attachment: trac_14040_repr_option.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_repr_option.patch.gz)
 * [attachment: trac_14040_doctest.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_doctest.patch.gz)
+* [attachment: trac_14040_review.patch](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)
 
``````




---

archive/issue_comments_166596.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nFor the patchbot:\n\napply trac_14040_housekeeping.patch, trac_14040_repr_option.patch, trac_14040_doctest.patch, trac_14040_review.patch",
    "created_at": "2013-02-24T03:36:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166596",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:17" align="right">comment:17</div>

For the patchbot:

apply trac_14040_housekeeping.patch, trac_14040_repr_option.patch, trac_14040_doctest.patch, trac_14040_review.patch



---

archive/issue_comments_166597.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe current patch does not apply for me (as well) on `5.7.beta3` with all the prerequisite patches.",
    "created_at": "2013-02-25T03:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166597",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

The current patch does not apply for me (as well) on `5.7.beta3` with all the prerequisite patches.



---

archive/issue_events_198185.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-02-25T03:52:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198185"
}
```



---

archive/issue_events_198186.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-02-25T03:52:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198186"
}
```



---

archive/issue_comments_166598.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nIt applies cleanly on sage-5.8.beta1. I think its pretty hopeless to try to collect all tickets since 5.7.beta3 that this would depend on.",
    "created_at": "2013-02-25T03:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166598",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

It applies cleanly on sage-5.8.beta1. I think its pretty hopeless to try to collect all tickets since 5.7.beta3 that this would depend on.



---

archive/issue_events_198187.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-02-25T03:59:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198187"
}
```



---

archive/issue_events_198188.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-02-25T03:59:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198188"
}
```



---

archive/issue_comments_166599.json:
```json
{
    "body": "Updated patch",
    "created_at": "2013-02-25T21:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166599",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_166600.json:
```json
{
    "body": "Changed dependencies from **#13685** to **#13618**",
    "created_at": "2013-02-25T21:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166600",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#13685** to **#13618**



---

archive/issue_comments_166601.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAttachment: **[trac_14040_review.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)**\n\nGot the wrong number for the \"doctests for rings\" ticket...",
    "created_at": "2013-02-25T21:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166601",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:20" align="right">comment:20</div>

Attachment: **[trac_14040_review.patch.gz](https://github.com/sagemath/sage/files/ticket14040/trac_14040_review.patch.gz)**

Got the wrong number for the "doctests for rings" ticket...



---

archive/issue_comments_166602.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThen do you want me to rebase #13685 over this ticket?",
    "created_at": "2013-02-25T21:55:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166602",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Then do you want me to rebase #13685 over this ticket?



---

archive/issue_comments_166603.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nApparently #13685 needs to be rebased anyways, this was the problem in with the patchbot. It would be nice if you can base it on this ticket, otherwise it'll depend on what Jeroen merges first.",
    "created_at": "2013-02-25T22:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166603",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">comment:22</div>

Apparently #13685 needs to be rebased anyways, this was the problem in with the patchbot. It would be nice if you can base it on this ticket, otherwise it'll depend on what Jeroen merges first.



---

archive/issue_comments_166604.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI'll be rebasing #13685 on this ticket (once `5.8.beta2` is released). Everything looks good to me now.\n\nThank you,\n\nTravis",
    "created_at": "2013-02-26T16:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166604",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">comment:23</div>

I'll be rebasing #13685 on this ticket (once `5.8.beta2` is released). Everything looks good to me now.

Thank you,

Travis



---

archive/issue_events_198189.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-02-26T16:37:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198189"
}
```



---

archive/issue_events_198190.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-02-26T16:37:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198190"
}
```



---

archive/issue_events_198191.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T10:34:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198191"
}
```



---

archive/issue_events_198192.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T10:34:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14040#event-198192"
}
```



---

archive/issue_comments_166605.json:
```json
{
    "body": "Merged: **sage-5.8.beta2**",
    "created_at": "2013-02-28T10:34:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14040#issuecomment-166605",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.8.beta2**
