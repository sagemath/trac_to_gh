# Issue 14426: Runaway/Segfaulting ECL processes

archive/issues_014222.json:
```json
{
    "body": "On some systems, when executing\n\n```\n./sage -tp --long devel/sage/sage/interfaces/lisp.py\n```\nthere are two ECL processes which do (strace log)\n\n```\nread(0, \"(setq sage0 2)\\n\", 1024)       = 15\nwrite(1, \"\\n\", 1)                       = 1\nwrite(1, \"2\", 1)                        = 1\nwrite(1, \"\\n\", 1)                       = 1\nwrite(1, \">\", 1)                        = 1\nwrite(1, \" \", 1)                        = 1\nread(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n--- SIGHUP (Hangup) @ 0 (0) ---\n--- SIGCONT (Continued) @ 0 (0) ---\nselect(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\nselect(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\nread(0, \"\", 1024)                       = 0\nwrite(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\nwrite(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\nwrite(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\nwrite(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n[...]\n```\nafter which they either segfault or keep running forever.\n\nA different way to see this problem:\n\n```\njdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\nECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\nCopyright (C) 1984 Taiichi Yuasa and Masami Hagiya\nCopyright (C) 1993 Giuseppe Attardi\nCopyright (C) 2000 Juan J. Garcia-Ripoll\nECL is free software, and you are welcome to redistribute it\nunder certain conditions; see file 'Copyright' for details.\nType :h for Help.  \nTop level.\n> /bin/bash: line 1: 11264 Done                    echo syntax error\n     11265 Segmentation fault      | ecl 2> /dev/full\n```\n\n**upstream bug**: [https://gitlab.com/embeddable-common-lisp/ecl/issues/43](https://gitlab.com/embeddable-common-lisp/ecl/issues/43)\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n\n**apply**: [attachment:14426_doctest.patch]\n\n### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)\n* #14426: write_error.patch: avoid an infinite loop when reporting\n  an error while writing to stderr.\n* Rename spkg-make to spkg-src.\n* Don't unset MAKEFLAGS (it was not clear why this was needed).\n* It seems no longer needed to disable Altivec.\n* Support ECL_CONFIGURE environment variable for options to\n  ./configure.\n\n\nAssignee: @jdemeyer\n\nCC:  @nexttime jpflori\n\nUpstream: Reported upstream. Developers acknowledge bug.\n\nReviewer: Volker Braun, John Cremona\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.9.rc0\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14426\n\n",
    "closed_at": "2013-04-12T14:50:05Z",
    "created_at": "2013-04-08T08:57:37Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Runaway/Segfaulting ECL processes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14426",
    "user": "https://github.com/jdemeyer"
}
```
On some systems, when executing

```
./sage -tp --long devel/sage/sage/interfaces/lisp.py
```
there are two ECL processes which do (strace log)

```
read(0, "(setq sage0 2)\n", 1024)       = 15
write(1, "\n", 1)                       = 1
write(1, "2", 1)                        = 1
write(1, "\n", 1)                       = 1
write(1, ">", 1)                        = 1
write(1, " ", 1)                        = 1
read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
--- SIGHUP (Hangup) @ 0 (0) ---
--- SIGCONT (Continued) @ 0 (0) ---
select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
read(0, "", 1024)                       = 0
write(2, "\n", 1)                       = -1 EIO (Input/output error)
write(2, "\n", 1)                       = -1 EIO (Input/output error)
write(2, "\n", 1)                       = -1 EIO (Input/output error)
write(2, "\n", 1)                       = -1 EIO (Input/output error)
[...]
```
after which they either segfault or keep running forever.

A different way to see this problem:

```
jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
Copyright (C) 1993 Giuseppe Attardi
Copyright (C) 2000 Juan J. Garcia-Ripoll
ECL is free software, and you are welcome to redistribute it
under certain conditions; see file 'Copyright' for details.
Type :h for Help.  
Top level.
> /bin/bash: line 1: 11264 Done                    echo syntax error
     11265 Segmentation fault      | ecl 2> /dev/full
```

**upstream bug**: [https://gitlab.com/embeddable-common-lisp/ecl/issues/43](https://gitlab.com/embeddable-common-lisp/ecl/issues/43)

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])

**apply**: [attachment:14426_doctest.patch]

### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)
* #14426: write_error.patch: avoid an infinite loop when reporting
  an error while writing to stderr.
* Rename spkg-make to spkg-src.
* Don't unset MAKEFLAGS (it was not clear why this was needed).
* It seems no longer needed to disable Altivec.
* Support ECL_CONFIGURE environment variable for options to
  ./configure.


Assignee: @jdemeyer

CC:  @nexttime jpflori

Upstream: Reported upstream. Developers acknowledge bug.

Reviewer: Volker Braun, John Cremona

Author: Jeroen Demeyer

Merged: sage-5.9.rc0

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14426





---

archive/issue_comments_190687.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,30 @@\n-Under some circumstances, after doctesting, there remain ECL processes consuming more and more memory.\n+On some systems, when executing\n \n-Assignee: @roed314\n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T10:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190687",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,30 @@
-Under some circumstances, after doctesting, there remain ECL processes consuming more and more memory.
+On some systems, when executing
 
-Assignee: @roed314
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190688.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,36 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+./sage --sh -c 'ecl < <(echo x) 2>/dev/full'\n+\\`\\`\\`\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T10:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190688",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,36 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+./sage --sh -c 'ecl < <(echo x) 2>/dev/full'
+\`\`\`
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190689.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,45 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta4$ ./sage --sh -c 'ecl < <(echo x) 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 17727 Segmentation fault      ecl < <(echo x) 2> /dev/full\n+\\`\\`\\`\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T10:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190689",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,45 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta4$ ./sage --sh -c 'ecl < <(echo x) 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 17727 Segmentation fault      ecl < <(echo x) 2> /dev/full
+\`\`\`
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190690.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,46 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T10:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190690",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,46 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190691.json:
```json
{
    "body": "Changing assignee from @roed314 to @jdemeyer.",
    "created_at": "2013-04-08T10:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190691",
    "user": "https://github.com/jdemeyer"
}
```

Changing assignee from @roed314 to @jdemeyer.



---

archive/issue_comments_190692.json:
```json
{
    "body": "Changing component from doctest framework to packages: standard.",
    "created_at": "2013-04-08T10:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190692",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from doctest framework to packages: standard.



---

archive/issue_comments_190693.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,48 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T11:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190693",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,48 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190694.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,50 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T11:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190694",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,50 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190695.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-08T11:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190695",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_190696.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,52 @@\n+On some systems, when executing\n \n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n+\n+**apply**: [attachment:14426_doctest.patch]\n \n Summary: Runaway ECL processes\n \n```\n",
    "created_at": "2013-04-08T11:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190696",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,52 @@
+On some systems, when executing
 
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
+
+**apply**: [attachment:14426_doctest.patch]
 
 Summary: Runaway ECL processes
 
```




---

archive/issue_comments_190697.json:
```json
{
    "body": "<a id='comment:8'></a>I am testing this now, on a machine which showed the problem up to now.  I expect it to work since it's the machine on which Jeroen diagnosed the problem, so anyone else who saw the problem should test it too.",
    "created_at": "2013-04-08T12:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190697",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>I am testing this now, on a machine which showed the problem up to now.  I expect it to work since it's the machine on which Jeroen diagnosed the problem, so anyone else who saw the problem should test it too.



---

archive/issue_comments_190698.json:
```json
{
    "body": "<a id='comment:10'></a>Isn't the problem also that PExpect interfaces apparently do not properly get shut down?\n\n\n\n\nThe bug / patch should be (better) documented in the spkg;  AFAICS there's not even a link to the upstream report there.",
    "created_at": "2013-04-08T19:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190698",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>Isn't the problem also that PExpect interfaces apparently do not properly get shut down?




The bug / patch should be (better) documented in the spkg;  AFAICS there's not even a link to the upstream report there.



---

archive/issue_comments_190699.json:
```json
{
    "body": "<a id='comment:11'></a>Fixes the problem for me!",
    "created_at": "2013-04-08T19:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190699",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:11'></a>Fixes the problem for me!



---

archive/issue_comments_190700.json:
```json
{
    "body": "<a id='comment:12'></a>I installed the spkg and patch and now almost no file can be doctested successfully.  For example\n\n```\n      File \"/home/jec/sage-5.9.beta4/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 80, in <module>\n        ecl_eval(\"(require 'maxima)\")\n      File \"ecl.pyx\", line 1225, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7102)\n      File \"ecl.pyx\", line 1240, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7039)\n      File \"ecl.pyx\", line 246, in sage.libs.ecl.ecl_safe_eval (sage/libs/ecl.c:2901)\n    RuntimeError: ECL says: Module error: Don't know how to REQUIRE MAXIMA.\n```",
    "created_at": "2013-04-08T19:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190700",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>I installed the spkg and patch and now almost no file can be doctested successfully.  For example

```
      File "/home/jec/sage-5.9.beta4/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 80, in <module>
        ecl_eval("(require 'maxima)")
      File "ecl.pyx", line 1225, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7102)
      File "ecl.pyx", line 1240, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7039)
      File "ecl.pyx", line 246, in sage.libs.ecl.ecl_safe_eval (sage/libs/ecl.c:2901)
    RuntimeError: ECL says: Module error: Don't know how to REQUIRE MAXIMA.
```



---

archive/issue_comments_190701.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 cremona]:\n> I installed the spkg and patch and now almost no file can be doctested successfully.  For example\n> \n> ```\n>       File \"/home/jec/sage-5.9.beta4/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 80, in <module>\n>         ecl_eval(\"(require 'maxima)\")\n>       File \"ecl.pyx\", line 1225, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7102)\n>       File \"ecl.pyx\", line 1240, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7039)\n>       File \"ecl.pyx\", line 246, in sage.libs.ecl.ecl_safe_eval (sage/libs/ecl.c:2901)\n>     RuntimeError: ECL says: Module error: Don't know how to REQUIRE MAXIMA.\n> ```\n\n\nYou of course have to rebuild the spkgs that depend on ECL as well, i.e., Maxima, and do `sage -b` afterwards.",
    "created_at": "2013-04-08T20:04:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190701",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>Replying to [comment:12 cremona]:
> I installed the spkg and patch and now almost no file can be doctested successfully.  For example
> 
> ```
>       File "/home/jec/sage-5.9.beta4/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 80, in <module>
>         ecl_eval("(require 'maxima)")
>       File "ecl.pyx", line 1225, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7102)
>       File "ecl.pyx", line 1240, in sage.libs.ecl.ecl_eval (sage/libs/ecl.c:7039)
>       File "ecl.pyx", line 246, in sage.libs.ecl.ecl_safe_eval (sage/libs/ecl.c:2901)
>     RuntimeError: ECL says: Module error: Don't know how to REQUIRE MAXIMA.
> ```


You of course have to rebuild the spkgs that depend on ECL as well, i.e., Maxima, and do `sage -b` afterwards.



---

archive/issue_comments_190702.json:
```json
{
    "body": "<a id='comment:14'></a>FWIW, I think we met that \"double-fault\" problem with `stderr` before, quite a while ago, and IIRC discussed it with upstream, so it's a bit astonishing it's still in.  (Although the circumstances were probably slightly different.)",
    "created_at": "2013-04-08T20:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190702",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>FWIW, I think we met that "double-fault" problem with `stderr` before, quite a while ago, and IIRC discussed it with upstream, so it's a bit astonishing it's still in.  (Although the circumstances were probably slightly different.)



---

archive/issue_comments_190703.json:
```json
{
    "body": "<a id='comment:15'></a>`SPKG.txt` lacks a \"Patches\" section, and the following \"Special Update/Build Instructions\" should get corrected:\n\n```\n * Note: the way we configure Sage, CXX and CXXFLAGS are unused.\n * Note: for the time being, ECL is built single threaded library as it\n   seems to interact badly with the pexpect interface and Sage's signal\n   handling when built multithreaded.\n```\n(Related to the first, printing the settings of `CXX` and `CXXFLAGS` in `spkg-install` then makes no sense.)",
    "created_at": "2013-04-08T20:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190703",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>`SPKG.txt` lacks a "Patches" section, and the following "Special Update/Build Instructions" should get corrected:

```
 * Note: the way we configure Sage, CXX and CXXFLAGS are unused.
 * Note: for the time being, ECL is built single threaded library as it
   seems to interact badly with the pexpect interface and Sage's signal
   handling when built multithreaded.
```
(Related to the first, printing the settings of `CXX` and `CXXFLAGS` in `spkg-install` then makes no sense.)



---

archive/issue_comments_190704.json:
```json
{
    "body": "<a id='comment:16'></a>As expected, for me solves the [comment:ticket:14055:36 issues with ECL and (Ubuntu's) GNU Make 3.81 and the new doctesting framework] on Ubuntu 10.04.4 LTS x86_64.  (Haven't tested on x86 yet, but I assume it will fix the specific ECL issue there as well.)\n\nStill, a working cleaner should have properly killed the processes, and it's not obvious what actually caused ECL running amok (i.e., why writing to `stderr` fails in the first place).",
    "created_at": "2013-04-08T22:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190704",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>As expected, for me solves the [comment:ticket:14055:36 issues with ECL and (Ubuntu's) GNU Make 3.81 and the new doctesting framework] on Ubuntu 10.04.4 LTS x86_64.  (Haven't tested on x86 yet, but I assume it will fix the specific ECL issue there as well.)

Still, a working cleaner should have properly killed the processes, and it's not obvious what actually caused ECL running amok (i.e., why writing to `stderr` fails in the first place).



---

archive/issue_comments_190705.json:
```json
{
    "body": "<a id='comment:17'></a>I made some further small changes to the `spkg-install` file.",
    "created_at": "2013-04-09T06:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190705",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>I made some further small changes to the `spkg-install` file.



---

archive/issue_comments_190706.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,61 @@\n+On some systems, when executing\n+\n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n+\n+**apply**: [attachment:14426_doctest.patch]\n+\n+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)\n+* #14426: write_error.patch: avoid an infinite loop when reporting\n+  an error while writing to stderr.\n+* Rename spkg-make to spkg-src.\n+* Don't unset MAKEFLAGS (it was not clear why this was needed).\n+* It seems no longer needed to disable Altivec.\n+* Support ECL_CONFIGURE environment variable for options to\n+  ./configure.\n \n \n Summary: Runaway ECL processes\n```\n",
    "created_at": "2013-04-09T06:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190706",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,61 @@
+On some systems, when executing
+
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**upstream**: [https://sourceforge.net/p/ecls/bugs/257/](https://sourceforge.net/p/ecls/bugs/257/)
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
+
+**apply**: [attachment:14426_doctest.patch]
+
+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)
+* #14426: write_error.patch: avoid an infinite loop when reporting
+  an error while writing to stderr.
+* Rename spkg-make to spkg-src.
+* Don't unset MAKEFLAGS (it was not clear why this was needed).
+* It seems no longer needed to disable Altivec.
+* Support ECL_CONFIGURE environment variable for options to
+  ./configure.
 
 
 Summary: Runaway ECL processes
```




---

archive/issue_comments_190707.json:
```json
{
    "body": "<a id='comment:18'></a>OK, it worked for me after both rebuilding maxima and also the whole Sage library (sage -ba) after applying the patch and new spkg.",
    "created_at": "2013-04-09T14:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190707",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'></a>OK, it worked for me after both rebuilding maxima and also the whole Sage library (sage -ba) after applying the patch and new spkg.



---

archive/issue_comments_190708.json:
```json
{
    "body": "<a id='comment:19'></a>Looks good to me",
    "created_at": "2013-04-09T14:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190708",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'></a>Looks good to me



---

archive/issue_comments_190709.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-09T14:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190709",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_190710.json:
```json
{
    "body": "<a id='comment:20'></a>On various, this causes ECL-related doctest failures. I have no idea why...",
    "created_at": "2013-04-10T06:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190710",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>On various, this causes ECL-related doctest failures. I have no idea why...



---

archive/issue_comments_190711.json:
```json
{
    "body": "<a id='comment:21'></a>Also: `/dev/full` doesn't exist on all systems.",
    "created_at": "2013-04-10T07:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190711",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Also: `/dev/full` doesn't exist on all systems.



---

archive/issue_comments_190712.json:
```json
{
    "body": "Attachment [ecl-12.12.1.p2.diff](tarball://root/attachments/some-uuid/ticket14426/ecl-12.12.1.p2.diff) by @jdemeyer created at 2013-04-10 07:19:45",
    "created_at": "2013-04-10T07:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190712",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [ecl-12.12.1.p2.diff](tarball://root/attachments/some-uuid/ticket14426/ecl-12.12.1.p2.diff) by @jdemeyer created at 2013-04-10 07:19:45



---

archive/issue_comments_190713.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-04-10T07:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190713",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_190714.json:
```json
{
    "body": "<a id='comment:23'></a>In particular, the doctest\n\n```\nsage: var('a,b,c') ## line 416 ##\n(a, b, c)\nsage: eqn = [a+b*c==1, b-a*c==0, a+b==5] ## line 418 ##\nsage: s = solve(eqn, a,b,c); s ## line 419 ##\n```\nin `devel/sage/doc/en/constructions/linear_algebra.rst` seems problematic for ECL.",
    "created_at": "2013-04-10T07:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190714",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>In particular, the doctest

```
sage: var('a,b,c') ## line 416 ##
(a, b, c)
sage: eqn = [a+b*c==1, b-a*c==0, a+b==5] ## line 418 ##
sage: s = solve(eqn, a,b,c); s ## line 419 ##
```
in `devel/sage/doc/en/constructions/linear_algebra.rst` seems problematic for ECL.



---

archive/issue_comments_190715.json:
```json
{
    "body": "<a id='comment:24'></a>I guess `/dev/full` is linux only.\n\nI don't get any doctest failures from `linear_algebra.rst`, for the record.",
    "created_at": "2013-04-10T09:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190715",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>I guess `/dev/full` is linux only.

I don't get any doctest failures from `linear_algebra.rst`, for the record.



---

archive/issue_comments_190716.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 vbraun]:\n> I don't get any doctest failures from `linear_algebra.rst`, for the record.\n\nWell, the error isn't reproducible. When it fails, it usually fails like\n\n```\nsage: var('a,b,c') ## line 416 ##\n(a, b, c)\nsage: eqn = [a+b*c==1, b-a*c==0, a+b==5] ## line 418 ##\nsage: s = solve(eqn, a,b,c); s ## line 419 ##\n\n;;; Unhandled lisp initialization error\n;;; Message:\nUNBOUND-VARIABLE\n;;; Arguments:\n\nInternal or unrecoverable error in:\n\nLisp initialization error.\n\n  [2: No such file or directory]\n\n;;; ECL C Backtrace\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_dump_c_backtrace+0x28) [0x7f6a15678208]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_internal_error+0x3f) [0x7f6a156631df]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x124324) [0x7f6a15663324]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_funcall+0x70) [0x7f6a15646410]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_error+0xdb) [0x7f6a1566416b]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x1254b2) [0x7f6a156644b2]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(FEwrong_type_argument+0x1e) [0x7f6a156644de]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(stream_dispatch_table+0x17) [0x7f6a15656e47]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_write_char+0x1b) [0x7f6a156576db]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x13769b) [0x7f6a1567669b]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(_ecl_write_symbol+0x156) [0x7f6a15676bf6]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_write_ugly_object+0x26) [0x7f6a15675cf6]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x12430b) [0x7f6a1566330b]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_funcall+0x70) [0x7f6a15646410]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_error+0xdb) [0x7f6a1566416b]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x125308) [0x7f6a15664308]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_interpret+0x19cd) [0x7f6a1564869d]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x10e36f) [0x7f6a1564d36f]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_eval_with_env+0x2eb) [0x7f6a1564ef2b]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_signal_simple_error+0x26d) [0x7f6a15613e6d]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(FEwrong_type_nth_arg+0x109) [0x7f6a15663d29]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(_ecl_sethash+0) [0x7f6a156901a0]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x14df58) [0x7f6a1568cf58]\n;;; /lib64/libpthread.so.0() [0x36e9e0f500]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xb621e) [0x7f6a155f521e]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbce17) [0x7f6a155fbe17]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd368) [0x7f6a155fc368]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd882) [0x7f6a155fc882]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]\n;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]\n\n**********************************************************************\n----------------------------------------------------------------------\nsage -t --long devel/sage/doc/en/constructions/linear_algebra.rst  # Killed due to abort\n----------------------------------------------------------------------\n```",
    "created_at": "2013-04-10T09:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190716",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [comment:24 vbraun]:
> I don't get any doctest failures from `linear_algebra.rst`, for the record.

Well, the error isn't reproducible. When it fails, it usually fails like

```
sage: var('a,b,c') ## line 416 ##
(a, b, c)
sage: eqn = [a+b*c==1, b-a*c==0, a+b==5] ## line 418 ##
sage: s = solve(eqn, a,b,c); s ## line 419 ##

;;; Unhandled lisp initialization error
;;; Message:
UNBOUND-VARIABLE
;;; Arguments:

Internal or unrecoverable error in:

Lisp initialization error.

  [2: No such file or directory]

;;; ECL C Backtrace
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_dump_c_backtrace+0x28) [0x7f6a15678208]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_internal_error+0x3f) [0x7f6a156631df]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x124324) [0x7f6a15663324]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_funcall+0x70) [0x7f6a15646410]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_error+0xdb) [0x7f6a1566416b]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x1254b2) [0x7f6a156644b2]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(FEwrong_type_argument+0x1e) [0x7f6a156644de]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(stream_dispatch_table+0x17) [0x7f6a15656e47]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_write_char+0x1b) [0x7f6a156576db]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x13769b) [0x7f6a1567669b]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(_ecl_write_symbol+0x156) [0x7f6a15676bf6]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_write_ugly_object+0x26) [0x7f6a15675cf6]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x12430b) [0x7f6a1566330b]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_funcall+0x70) [0x7f6a15646410]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(cl_error+0xdb) [0x7f6a1566416b]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x125308) [0x7f6a15664308]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(ecl_interpret+0x19cd) [0x7f6a1564869d]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x10e36f) [0x7f6a1564d36f]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_eval_with_env+0x2eb) [0x7f6a1564ef2b]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(si_signal_simple_error+0x26d) [0x7f6a15613e6d]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(FEwrong_type_nth_arg+0x109) [0x7f6a15663d29]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(_ecl_sethash+0) [0x7f6a156901a0]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0x14df58) [0x7f6a1568cf58]
;;; /lib64/libpthread.so.0() [0x36e9e0f500]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xb621e) [0x7f6a155f521e]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbce17) [0x7f6a155fbe17]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd368) [0x7f6a155fc368]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd882) [0x7f6a155fc882]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]
;;; /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.9.rc0/local/lib/libecl.so.12.12(+0xbd8bd) [0x7f6a155fc8bd]

**********************************************************************
----------------------------------------------------------------------
sage -t --long devel/sage/doc/en/constructions/linear_algebra.rst  # Killed due to abort
----------------------------------------------------------------------
```



---

archive/issue_comments_190717.json:
```json
{
    "body": "<a id='comment:27'></a>New version of the patch seems to work fine.",
    "created_at": "2013-04-11T09:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190717",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>New version of the patch seems to work fine.



---

archive/issue_comments_190718.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-04-11T09:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190718",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_190719.json:
```json
{
    "body": "<a id='comment:28'></a>I guess you mean the version where you check /dev/full exists?",
    "created_at": "2013-04-11T10:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190719",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:28'></a>I guess you mean the version where you check /dev/full exists?



---

archive/issue_comments_190720.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 jpflori]:\n> I guess you mean the version where you check /dev/full exists?\n\nAnd the new version of `patches/write_error.patch` inside the ECL spkg.",
    "created_at": "2013-04-11T10:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190720",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>Replying to [comment:28 jpflori]:
> I guess you mean the version where you check /dev/full exists?

And the new version of `patches/write_error.patch` inside the ECL spkg.



---

archive/issue_comments_190721.json:
```json
{
    "body": "<a id='comment:30'></a>Could you post the old version so that I can spot the differences?",
    "created_at": "2013-04-11T10:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190721",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:30'></a>Could you post the old version so that I can spot the differences?



---

archive/issue_comments_190722.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 jpflori]:\n> Could you post the old version so that I can spot the differences?\n\nI don't have the old version anymore. But that doesn't matter, could you perhaps review it as if there never was a previous version?",
    "created_at": "2013-04-11T11:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190722",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>Replying to [comment:30 jpflori]:
> Could you post the old version so that I can spot the differences?

I don't have the old version anymore. But that doesn't matter, could you perhaps review it as if there never was a previous version?



---

archive/issue_comments_190723.json:
```json
{
    "body": "<a id='comment:32'></a>As the patch is quite simple, I was wondering what was failing before and caused the random failures, but of course I can pretend this previous version did not exist.",
    "created_at": "2013-04-11T12:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190723",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:32'></a>As the patch is quite simple, I was wondering what was failing before and caused the random failures, but of course I can pretend this previous version did not exist.



---

archive/issue_comments_190724.json:
```json
{
    "body": "<a id='comment:33'></a>The previous version patched `restartable_io_error()` but that was called from different places, possibly causing the problems.",
    "created_at": "2013-04-11T12:57:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190724",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>The previous version patched `restartable_io_error()` but that was called from different places, possibly causing the problems.



---

archive/issue_comments_190725.json:
```json
{
    "body": "<a id='comment:34'></a>Looks good to me.",
    "created_at": "2013-04-12T14:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190725",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>Looks good to me.



---

archive/issue_comments_190726.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-12T14:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190726",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_040986.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-12T14:50:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14426#event-40986"
}
```



---

archive/issue_comments_190727.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-12T14:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190727",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_190728.json:
```json
{
    "body": "<a id='comment:36'></a>Was the patch forwarded to upstream?",
    "created_at": "2013-04-12T15:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190728",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:36'></a>Was the patch forwarded to upstream?



---

archive/issue_comments_190729.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:36 Snark]:\n> Was the patch forwarded to upstream?\n\nYes.",
    "created_at": "2013-04-12T15:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190729",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>Replying to [comment:36 Snark]:
> Was the patch forwarded to upstream?

Yes.



---

archive/issue_comments_190730.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 jdemeyer]:\n> Replying to [comment:36 Snark]:\n> > Was the patch forwarded to upstream?\n\n> Yes.\n\nPerfect!",
    "created_at": "2013-04-12T15:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190730",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:38'></a>Replying to [comment:37 jdemeyer]:
> Replying to [comment:36 Snark]:
> > Was the patch forwarded to upstream?

> Yes.

Perfect!



---

archive/issue_comments_190731.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:25 jdemeyer]:\n> Replying to [comment:24 vbraun]:\n> > I don't get any doctest failures from `linear_algebra.rst`, for the record.\n\n> Well, the error isn't reproducible. When it fails, it usually fails like\n\nAre you sure this is related to this ticket? I only see this after applying the patches at #14055, and I see this whether I have applied the patches here or not. This is happening on both mark and taurus. (I also mentioned it on #14055.)",
    "created_at": "2013-04-13T03:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190731",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:39'></a>Replying to [comment:25 jdemeyer]:
> Replying to [comment:24 vbraun]:
> > I don't get any doctest failures from `linear_algebra.rst`, for the record.

> Well, the error isn't reproducible. When it fails, it usually fails like

Are you sure this is related to this ticket? I only see this after applying the patches at #14055, and I see this whether I have applied the patches here or not. This is happening on both mark and taurus. (I also mentioned it on #14055.)



---

archive/issue_comments_190732.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:36 Snark]:\n> Was the patch forwarded to upstream?\n\nYes, but upstream is totally ignoring it...",
    "created_at": "2013-04-29T12:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190732",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>Replying to [comment:36 Snark]:
> Was the patch forwarded to upstream?

Yes, but upstream is totally ignoring it...



---

archive/issue_comments_190733.json:
```json
{
    "body": "<a id='comment:41'></a>Replying to [comment:40 jdemeyer]:\n> Replying to [comment:36 Snark]:\n> > Was the patch forwarded to upstream?\n\n> Yes, but upstream is totally ignoring it...\n\nhere is another try. Upstream points out, correctly, that the patch does not work if ECL is configured without disabling threads.\n\nhttps://gitlab.com/embeddable-common-lisp/ecl/merge_requests/1\nand\nhttps://gitlab.com/embeddable-common-lisp/ecl/issues/43",
    "created_at": "2015-07-20T20:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190733",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>Replying to [comment:40 jdemeyer]:
> Replying to [comment:36 Snark]:
> > Was the patch forwarded to upstream?

> Yes, but upstream is totally ignoring it...

here is another try. Upstream points out, correctly, that the patch does not work if ECL is configured without disabling threads.

https://gitlab.com/embeddable-common-lisp/ecl/merge_requests/1
and
https://gitlab.com/embeddable-common-lisp/ecl/issues/43



---

archive/issue_comments_190734.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,61 @@\n+On some systems, when executing\n+\n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**upstream bug**: [http://sourceforge.net/p/ecls/bugs/303/](http://sourceforge.net/p/ecls/bugs/303/)\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n+\n+**apply**: [attachment:14426_doctest.patch]\n+\n+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)\n+* #14426: write_error.patch: avoid an infinite loop when reporting\n+  an error while writing to stderr.\n+* Rename spkg-make to spkg-src.\n+* Don't unset MAKEFLAGS (it was not clear why this was needed).\n+* It seems no longer needed to disable Altivec.\n+* Support ECL_CONFIGURE environment variable for options to\n+  ./configure.\n \n \n Summary: Runaway ECL processes\n```\n",
    "created_at": "2015-07-21T09:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190734",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,61 @@
+On some systems, when executing
+
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**upstream bug**: [http://sourceforge.net/p/ecls/bugs/303/](http://sourceforge.net/p/ecls/bugs/303/)
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
+
+**apply**: [attachment:14426_doctest.patch]
+
+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)
+* #14426: write_error.patch: avoid an infinite loop when reporting
+  an error while writing to stderr.
+* Rename spkg-make to spkg-src.
+* Don't unset MAKEFLAGS (it was not clear why this was needed).
+* It seems no longer needed to disable Altivec.
+* Support ECL_CONFIGURE environment variable for options to
+  ./configure.
 
 
 Summary: Runaway ECL processes
```




---

archive/issue_comments_190735.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,61 @@\n+On some systems, when executing\n+\n+\\`\\`\\`\n+./sage -tp --long devel/sage/sage/interfaces/lisp.py\n+\\`\\`\\`\n+there are two ECL processes which do (strace log)\n+\n+\\`\\`\\`\n+read(0, \"(setq sage0 2)\\n\", 1024)       = 15\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \"2\", 1)                        = 1\n+write(1, \"\\n\", 1)                       = 1\n+write(1, \">\", 1)                        = 1\n+write(1, \" \", 1)                        = 1\n+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)\n+--- SIGHUP (Hangup) @ 0 (0) ---\n+--- SIGCONT (Continued) @ 0 (0) ---\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})\n+read(0, \"\", 1024)                       = 0\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+write(2, \"\\n\", 1)                       = -1 EIO (Input/output error)\n+[...]\n+\\`\\`\\`\n+after which they either segfault or keep running forever.\n+\n+A different way to see this problem:\n+\n+\\`\\`\\`\n+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'\n+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)\n+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya\n+Copyright (C) 1993 Giuseppe Attardi\n+Copyright (C) 2000 Juan J. Garcia-Ripoll\n+ECL is free software, and you are welcome to redistribute it\n+under certain conditions; see file 'Copyright' for details.\n+Type :h for Help.  \n+Top level.\n+> /bin/bash: line 1: 11264 Done                    echo syntax error\n+     11265 Segmentation fault      | ecl 2> /dev/full\n+\\`\\`\\`\n+\n+**upstream bug**: [https://gitlab.com/embeddable-common-lisp/ecl/issues/43](https://gitlab.com/embeddable-common-lisp/ecl/issues/43)\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])\n+\n+**apply**: [attachment:14426_doctest.patch]\n+\n+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)\n+* #14426: write_error.patch: avoid an infinite loop when reporting\n+  an error while writing to stderr.\n+* Rename spkg-make to spkg-src.\n+* Don't unset MAKEFLAGS (it was not clear why this was needed).\n+* It seems no longer needed to disable Altivec.\n+* Support ECL_CONFIGURE environment variable for options to\n+  ./configure.\n \n \n Summary: Runaway ECL processes\n```\n",
    "created_at": "2015-07-21T10:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14426#issuecomment-190735",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,61 @@
+On some systems, when executing
+
+\`\`\`
+./sage -tp --long devel/sage/sage/interfaces/lisp.py
+\`\`\`
+there are two ECL processes which do (strace log)
+
+\`\`\`
+read(0, "(setq sage0 2)\n", 1024)       = 15
+write(1, "\n", 1)                       = 1
+write(1, "2", 1)                        = 1
+write(1, "\n", 1)                       = 1
+write(1, ">", 1)                        = 1
+write(1, " ", 1)                        = 1
+read(0, 0x7f2c263b1000, 1024)           = -1 EIO (Input/output error)
+--- SIGHUP (Hangup) @ 0 (0) ---
+--- SIGCONT (Continued) @ 0 (0) ---
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+select(1, [0], NULL, NULL, {0, 0})      = 1 (in [0], left {0, 0})
+read(0, "", 1024)                       = 0
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+write(2, "\n", 1)                       = -1 EIO (Input/output error)
+[...]
+\`\`\`
+after which they either segfault or keep running forever.
+
+A different way to see this problem:
+
+\`\`\`
+jdemeyer@boxen:/release/merger/sage-5.9.beta2$ ./sage --sh -c 'echo syntax error |ecl 2>/dev/full'
+ECL (Embeddable Common-Lisp) 12.12.1 (git:UNKNOWN)
+Copyright (C) 1984 Taiichi Yuasa and Masami Hagiya
+Copyright (C) 1993 Giuseppe Attardi
+Copyright (C) 2000 Juan J. Garcia-Ripoll
+ECL is free software, and you are welcome to redistribute it
+under certain conditions; see file 'Copyright' for details.
+Type :h for Help.  
+Top level.
+> /bin/bash: line 1: 11264 Done                    echo syntax error
+     11265 Segmentation fault      | ecl 2> /dev/full
+\`\`\`
+
+**upstream bug**: [https://gitlab.com/embeddable-common-lisp/ecl/issues/43](https://gitlab.com/embeddable-common-lisp/ecl/issues/43)
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/ecl-12.12.1.p2.spkg) ([attachment:ecl-12.12.1.p2.diff diff])
+
+**apply**: [attachment:14426_doctest.patch]
+
+### ecl-12.12.1.p2 (Jeroen Demeyer, 9 April 2013)
+* #14426: write_error.patch: avoid an infinite loop when reporting
+  an error while writing to stderr.
+* Rename spkg-make to spkg-src.
+* Don't unset MAKEFLAGS (it was not clear why this was needed).
+* It seems no longer needed to disable Altivec.
+* Support ECL_CONFIGURE environment variable for options to
+  ./configure.
 
 
 Summary: Runaway ECL processes
```

