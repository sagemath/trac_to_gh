# Issue 14543: Implement compositional inverses of cycle index series

archive/issues_014339.json:
```json
{
    "body": "In #14348, I submitted code which computes the cycle index of the virtual species \u03a9, which is the compositional inverse of the species E+ of nonempty sets. It is possible to compute the compositional inverse of (most) arbitrary cycle indices (subject to some conditions on the low-order terms). The attached patch implements this calculation by adding a compositional_inverse() method to the class CycleIndexSeries. This code is doctested and builds HTML docs without errors.\n\nIt should be noted that this algorithm is very slow; however, it is the best one I know for the general case. The algorithm for computing the cycle index of \u03a9 in #14348 is *much* faster, and that specific species has real computational utility, so I believe it is worthwhile to have both in Sage.\n\nApply [attachment:trac_14543_cycle_index_compositional_inverse.patch].\n\nAssignee: sage-combinat\n\nCC:  sage-combinat @mantepse\n\nKeywords: species, cycle indices, LazyPowerSeries\n\nWork_Issues: documentation\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Andrew Gainer-Dewar\n\nBranch: a1d35362dc7663a346971ab75c389b0e100ae9e7\n\nCommit: a1d35362dc7663a346971ab75c389b0e100ae9e7\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14543\n\n",
    "closed_at": "2014-06-02T12:54:44Z",
    "created_at": "2013-05-06T22:13:20Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Implement compositional inverses of cycle index series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14543",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```
In #14348, I submitted code which computes the cycle index of the virtual species Ω, which is the compositional inverse of the species E+ of nonempty sets. It is possible to compute the compositional inverse of (most) arbitrary cycle indices (subject to some conditions on the low-order terms). The attached patch implements this calculation by adding a compositional_inverse() method to the class CycleIndexSeries. This code is doctested and builds HTML docs without errors.

It should be noted that this algorithm is very slow; however, it is the best one I know for the general case. The algorithm for computing the cycle index of Ω in #14348 is *much* faster, and that specific species has real computational utility, so I believe it is worthwhile to have both in Sage.

Apply [attachment:trac_14543_cycle_index_compositional_inverse.patch].

Assignee: sage-combinat

CC:  sage-combinat @mantepse

Keywords: species, cycle indices, LazyPowerSeries

Work_Issues: documentation

Reviewer: Frédéric Chapoton

Author: Andrew Gainer-Dewar

Branch: a1d35362dc7663a346971ab75c389b0e100ae9e7

Commit: a1d35362dc7663a346971ab75c389b0e100ae9e7

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14543





---

archive/issue_comments_180883.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-05-06T22:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180883",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_180884.json:
```json
{
    "body": "<a id='comment:2'></a>This needs to be rebased on a recent version of sage. You need to import the patch on a recent sage, to look at the reject file (containing pieces of code that could not be put at their place), make the appropriate corrections, and then refresh and  export it again.",
    "created_at": "2013-06-05T20:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180884",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>This needs to be rebased on a recent version of sage. You need to import the patch on a recent sage, to look at the reject file (containing pieces of code that could not be put at their place), make the appropriate corrections, and then refresh and  export it again.



---

archive/issue_comments_180885.json:
```json
{
    "body": "<a id='comment:3'></a>This patch applies fine for me (sage-main 5.10rc0) **after #14542 is applied**. Obviously the patch was made with #14542 applied, and inserts code directly before the method added by #14542, so I can see where the rejection comes from. Does this warrant adding a dependency?",
    "created_at": "2013-06-08T09:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180885",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:3'></a>This patch applies fine for me (sage-main 5.10rc0) **after #14542 is applied**. Obviously the patch was made with #14542 applied, and inserts code directly before the method added by #14542, so I can see where the rejection comes from. Does this warrant adding a dependency?



---

archive/issue_comments_180886.json:
```json
{
    "body": "<a id='comment:4'></a>yes indeed, this is exactly what dependencies are for. I have added the dep. to #14542.",
    "created_at": "2013-06-08T11:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180886",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>yes indeed, this is exactly what dependencies are for. I have added the dep. to #14542.



---

archive/issue_comments_180887.json:
```json
{
    "body": "<a id='comment:5'></a>I have uploaded a new version of the patch which moves the code to a different part of the class, eliminating the spurious dependency on #14542. I have also expanded and updated the documentation in two ways: by adding an ALGORITHM block explaining the (rather clumsy) method which is used here, and by adding a SEEALSO explaining the connection to CombinatorialLogarithmSeries.\n\ndarij has suggested in discussion on #14542 that this use of `assert` may cause problems when CycleIndexSeriesRing is based in a complicated ring (like another LazyPowerSeriesRing). Is the best option here to add something like an optional `check_input` option which allows the user to suppress these assertions?",
    "created_at": "2013-06-16T17:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180887",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:5'></a>I have uploaded a new version of the patch which moves the code to a different part of the class, eliminating the spurious dependency on #14542. I have also expanded and updated the documentation in two ways: by adding an ALGORITHM block explaining the (rather clumsy) method which is used here, and by adding a SEEALSO explaining the connection to CombinatorialLogarithmSeries.

darij has suggested in discussion on #14542 that this use of `assert` may cause problems when CycleIndexSeriesRing is based in a complicated ring (like another LazyPowerSeriesRing). Is the best option here to add something like an optional `check_input` option which allows the user to suppress these assertions?



---

archive/issue_comments_180888.json:
```json
{
    "body": "<a id='comment:6'></a>On line 775, when you say `0 + p_{1} + \\dots`, does p_{1} just mean the variable X?\n\nI'm surprised that this stuff is in a class named \"CycleIndexSeries\" -- I'd expect it to be defined for LazyPowerSeries in full generality? Of course, it makes sense to also have a wrapper in CycleIndexSeries that gives back the answer in the correct type. (I fear this will have to depend on #13433.)",
    "created_at": "2013-06-17T09:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180888",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:6'></a>On line 775, when you say `0 + p_{1} + \dots`, does p_{1} just mean the variable X?

I'm surprised that this stuff is in a class named "CycleIndexSeries" -- I'd expect it to be defined for LazyPowerSeries in full generality? Of course, it makes sense to also have a wrapper in CycleIndexSeries that gives back the answer in the correct type. (I fear this will have to depend on #13433.)



---

archive/issue_comments_180889.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 darij]:\n\n> On line 775, when you say `0 + p_{1} + \\dots` , does p_{1}  just mean the variable X?\n\n\nIn a `CycleIndexSeries` as implemented in Sage, the coefficient on `x^n` is a symmetric function in the power sum basis whose terms are all of degree n. Of course, `p_1` is the only such symmetric function for `n=1`, so the only actual freedom is the coefficient from the underlying base ring. This needs to be non-zero for this inversion method to work; assuming that it's 1 makes things much simpler and is, I think, not a significant restriction.\n\nOr perhaps you meant the *species* `X`? If so, `p_1` is indeed its cycle index series, but this code isn't running at the level of `Species`, so `p_1` seemed clearer.\n\nEither way, if you think there's a better way to write that docstring, I'm certainly open to it\u2014I want the meaning to be as clear as possible!\n\n> I'm surprised that this stuff is in a class named \"CycleIndexSeries \" -- I'd expect it to be defined for LazyPowerSeries  in full generality? Of course, it makes sense to also have a wrapper in CycleIndexSeries  that gives back the answer in the correct type. (I fear this will have to depend on #13433 .)\n\n\nThat would probably make sense; there's nothing about this algorithm that obviously depends on working at the level of `CycleIndexSeries` (at least to my eye). However, to do that, I'll need some mechanism for determining the compositional identity of an arbitrary `LazyPowerSeriesRing`, to stand in where `X` is now.\n\nIt's not clear to me how this should be done without some detailed knowledge of the specifics of the algebra in question. On the other hand, this does seem like information that each `LazyPowerSeriesRing` should know about itself. Maybe I should add a `compositional_identity` method to `LazyPowerSeriesRing`, move `compositional_inverse` there, and then override `compositional_identity` in `CycleIndexSeriesRing`?",
    "created_at": "2013-06-17T19:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180889",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:7'></a>Replying to [comment:6 darij]:

> On line 775, when you say `0 + p_{1} + \dots` , does p_{1}  just mean the variable X?


In a `CycleIndexSeries` as implemented in Sage, the coefficient on `x^n` is a symmetric function in the power sum basis whose terms are all of degree n. Of course, `p_1` is the only such symmetric function for `n=1`, so the only actual freedom is the coefficient from the underlying base ring. This needs to be non-zero for this inversion method to work; assuming that it's 1 makes things much simpler and is, I think, not a significant restriction.

Or perhaps you meant the *species* `X`? If so, `p_1` is indeed its cycle index series, but this code isn't running at the level of `Species`, so `p_1` seemed clearer.

Either way, if you think there's a better way to write that docstring, I'm certainly open to it—I want the meaning to be as clear as possible!

> I'm surprised that this stuff is in a class named "CycleIndexSeries " -- I'd expect it to be defined for LazyPowerSeries  in full generality? Of course, it makes sense to also have a wrapper in CycleIndexSeries  that gives back the answer in the correct type. (I fear this will have to depend on #13433 .)


That would probably make sense; there's nothing about this algorithm that obviously depends on working at the level of `CycleIndexSeries` (at least to my eye). However, to do that, I'll need some mechanism for determining the compositional identity of an arbitrary `LazyPowerSeriesRing`, to stand in where `X` is now.

It's not clear to me how this should be done without some detailed knowledge of the specifics of the algebra in question. On the other hand, this does seem like information that each `LazyPowerSeriesRing` should know about itself. Maybe I should add a `compositional_identity` method to `LazyPowerSeriesRing`, move `compositional_inverse` there, and then override `compositional_identity` in `CycleIndexSeriesRing`?



---

archive/issue_comments_180890.json:
```json
{
    "body": "<a id='comment:8'></a>For the record: I recently needed the compositional inverse for Lazy power series, and a couple other related operations; they are in the patch I am about to attach; you can also find it in the queue. Feel free to take over / recycle whatever might be relevant.",
    "created_at": "2013-06-17T20:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180890",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:8'></a>For the record: I recently needed the compositional inverse for Lazy power series, and a couple other related operations; they are in the patch I am about to attach; you can also find it in the queue. Feel free to take over / recycle whatever might be relevant.



---

archive/issue_comments_180891.json:
```json
{
    "body": "<a id='comment:9'></a>Attachment [lazy_power_series-more_operations-nt.patch](tarball://root/attachments/some-uuid/ticket14543/lazy_power_series-more_operations-nt.patch) by @darijgr created at 2013-06-17 20:13:12\n\nOoh -- this is not literally the compositional inverse of a power series? Sorry then; please disregard what I wrote. It would still be nicer to have some explanation of what exactly this is, or a more precise reference (to a section number?).",
    "created_at": "2013-06-17T20:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180891",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:9'></a>Attachment [lazy_power_series-more_operations-nt.patch](tarball://root/attachments/some-uuid/ticket14543/lazy_power_series-more_operations-nt.patch) by @darijgr created at 2013-06-17 20:13:12

Ooh -- this is not literally the compositional inverse of a power series? Sorry then; please disregard what I wrote. It would still be nicer to have some explanation of what exactly this is, or a more precise reference (to a section number?).



---

archive/issue_comments_180892.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 darij]:\n> Ooh -- this is not literally the compositional inverse of a power series? Sorry then; please disregard what I wrote. It would still be nicer to have some explanation of what exactly this is, or a more precise reference (to a section number?).\n\n\nFormally, this is the inverse of the operation of \"cycle index plethysm\", which is handled by the `composition` method of `CycleIndexSeries`. As an abstract operation, it has many of the same properties as power series composition, but at the computational level it is somewhat different; in particular, the induced operation on coefficients is something a bit more subtle than simply multiplying things out.\n\nThat said, the inversion procedure as I've written it out doesn't actually depend on any of the details of the operation \u2218. It suffices that there is a two-sided \u2218-inverse (call it X) and that \u2218 distributes over addition. Thus, writing this procedure up at the `LazyPowerSeries` level and letting `CycleIndexSeries` inherit it should work fine, since `CycleIndexSeries` appropriately overrides `composition`.\n\nThe standard reference on the subject is section 1.4 of \"Combinatorial species and tree-like structures\" by Bergeron, Labelle, and Leroux, although it is discussed at some length in many other sources as well.",
    "created_at": "2013-06-17T20:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180892",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:10'></a>Replying to [comment:9 darij]:
> Ooh -- this is not literally the compositional inverse of a power series? Sorry then; please disregard what I wrote. It would still be nicer to have some explanation of what exactly this is, or a more precise reference (to a section number?).


Formally, this is the inverse of the operation of "cycle index plethysm", which is handled by the `composition` method of `CycleIndexSeries`. As an abstract operation, it has many of the same properties as power series composition, but at the computational level it is somewhat different; in particular, the induced operation on coefficients is something a bit more subtle than simply multiplying things out.

That said, the inversion procedure as I've written it out doesn't actually depend on any of the details of the operation ∘. It suffices that there is a two-sided ∘-inverse (call it X) and that ∘ distributes over addition. Thus, writing this procedure up at the `LazyPowerSeries` level and letting `CycleIndexSeries` inherit it should work fine, since `CycleIndexSeries` appropriately overrides `composition`.

The standard reference on the subject is section 1.4 of "Combinatorial species and tree-like structures" by Bergeron, Labelle, and Leroux, although it is discussed at some length in many other sources as well.



---

archive/issue_comments_180893.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:8 nthiery]:\n> For the record: I recently needed the compositional inverse for Lazy power series, and a couple other related operations; they are in the patch I am about to attach; you can also find it in the queue. Feel free to take over / recycle whatever might be relevant.\n\n\nUnfortunately, I don't think this approach will work at the `CycleIndexSeries` level. The `compose_inverse_with` method from your patch, it appears that you're using the Inverse Function Theorem. This actually *does* work at the level of cycle index series (by a sort of combinatorial chain rule!), but the resulting differential equation is intractable in general, because taking species-theoretic derivatives of cycle index series destroys *lots* of information (in particular, every term without a p_1 is destroyed).\n\nI haven't dug too deeply into the algebra, but I am fairly confident that using `LazyPowerSeries` derivatives instead is not mathematically meaningful and won't yield anything useful.\n\nLooking this over has, however, brought to my attention that Sage does not have a method for `CycleIndexSeries` implementing the *species-theoretic* derivative. Curiously, the `LazyPowerSeries` `derivative()` and `integral()` methods are used several times in the existing code-base to pull off algebra tricks, so factoring out these (in my opinion) deceptive names would be a bit of a hassle, but it might still be worthwhile. This is probably at least as much a cultural question as a code one, though, so perhaps I should steer clear until I get to know the environment better?\n\nAlso, since the patchbot now seems to be confused:\n\napply trac_14543_cycle_index_compositional_inverse.patch",
    "created_at": "2013-06-22T22:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180893",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:11'></a>Replying to [comment:8 nthiery]:
> For the record: I recently needed the compositional inverse for Lazy power series, and a couple other related operations; they are in the patch I am about to attach; you can also find it in the queue. Feel free to take over / recycle whatever might be relevant.


Unfortunately, I don't think this approach will work at the `CycleIndexSeries` level. The `compose_inverse_with` method from your patch, it appears that you're using the Inverse Function Theorem. This actually *does* work at the level of cycle index series (by a sort of combinatorial chain rule!), but the resulting differential equation is intractable in general, because taking species-theoretic derivatives of cycle index series destroys *lots* of information (in particular, every term without a p_1 is destroyed).

I haven't dug too deeply into the algebra, but I am fairly confident that using `LazyPowerSeries` derivatives instead is not mathematically meaningful and won't yield anything useful.

Looking this over has, however, brought to my attention that Sage does not have a method for `CycleIndexSeries` implementing the *species-theoretic* derivative. Curiously, the `LazyPowerSeries` `derivative()` and `integral()` methods are used several times in the existing code-base to pull off algebra tricks, so factoring out these (in my opinion) deceptive names would be a bit of a hassle, but it might still be worthwhile. This is probably at least as much a cultural question as a code one, though, so perhaps I should steer clear until I get to know the environment better?

Also, since the patchbot now seems to be confused:

apply trac_14543_cycle_index_compositional_inverse.patch



---

archive/issue_comments_180894.json:
```json
{
    "body": "<a id='comment:13'></a>EDIT: ignore",
    "created_at": "2013-07-29T20:06:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180894",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:13'></a>EDIT: ignore



---

archive/issue_comments_180895.json:
```json
{
    "body": "suggestions. please don't fold until you feel safe that they're correct!",
    "created_at": "2013-07-29T20:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180895",
    "user": "https://github.com/darijgr"
}
```

suggestions. please don't fold until you feel safe that they're correct!



---

archive/issue_comments_180896.json:
```json
{
    "body": "<a id='comment:14'></a>Attachment [trac_14543-suggestions-dg.patch](tarball://root/attachments/some-uuid/ticket14543/trac_14543-suggestions-dg.patch) by @darijgr created at 2013-07-29 20:58:05\n\nI've uploaded a bunch of suggestions: [attachment:trac_14543-suggestions-dg.patch\u200b]. Do you agree with them? I'm not sure of them myself, as some of them are just my guesses. And I have not filled in the definition of functorial composition since I don't fully understand it myself (I don't have the [BLL] reference, only [BLL-Intro]), but I've added a #TODO because it should eventually be filled in.\n\nIn the stretch doctest, I replaced `f = CIS([p([1])])` by `f = CIS([p([]), p([1]), p([2]), p.zero()])` because, as far as I understand, when you write a cycle index series as a power series in t, the coefficient before `t^n` has to be a symmetric polynomial homogeneous of degree n.\n\nI have removed the reference to [BLL] from your method because the same reference appears in another method. Generally, every reference needs to exist only once in the source.\n\nI added the `res._name = 'res'` line because the examples in the `define` method in `series.py` do that. Maybe it is cargo cult. I hope you can shed light on this.\n\nIn case you have troubles applying my patch: I've been working atop of #10227, #14685 and #14542. Maybe some of these are dependencies.",
    "created_at": "2013-07-29T20:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180896",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:14'></a>Attachment [trac_14543-suggestions-dg.patch](tarball://root/attachments/some-uuid/ticket14543/trac_14543-suggestions-dg.patch) by @darijgr created at 2013-07-29 20:58:05

I've uploaded a bunch of suggestions: [attachment:trac_14543-suggestions-dg.patch​]. Do you agree with them? I'm not sure of them myself, as some of them are just my guesses. And I have not filled in the definition of functorial composition since I don't fully understand it myself (I don't have the [BLL] reference, only [BLL-Intro]), but I've added a #TODO because it should eventually be filled in.

In the stretch doctest, I replaced `f = CIS([p([1])])` by `f = CIS([p([]), p([1]), p([2]), p.zero()])` because, as far as I understand, when you write a cycle index series as a power series in t, the coefficient before `t^n` has to be a symmetric polynomial homogeneous of degree n.

I have removed the reference to [BLL] from your method because the same reference appears in another method. Generally, every reference needs to exist only once in the source.

I added the `res._name = 'res'` line because the examples in the `define` method in `series.py` do that. Maybe it is cargo cult. I hope you can shed light on this.

In case you have troubles applying my patch: I've been working atop of #10227, #14685 and #14542. Maybe some of these are dependencies.



---

archive/issue_events_041393.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41393"
}
```



---

archive/issue_comments_180897.json:
```json
{
    "body": "<a id='comment:17'></a>I am assuming the patch should be merged and the git branch is just there for reference.",
    "created_at": "2013-08-19T06:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180897",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>I am assuming the patch should be merged and the git branch is just there for reference.



---

archive/issue_comments_180898.json:
```json
{
    "body": "Attachment [trac_14543_cycle_index_compositional_inverse.patch](tarball://root/attachments/some-uuid/ticket14543/trac_14543_cycle_index_compositional_inverse.patch) by agd created at 2013-08-27 21:21:50\n\nImplement compositional inverses of cycle index series",
    "created_at": "2013-08-27T21:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180898",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

Attachment [trac_14543_cycle_index_compositional_inverse.patch](tarball://root/attachments/some-uuid/ticket14543/trac_14543_cycle_index_compositional_inverse.patch) by agd created at 2013-08-27 21:21:50

Implement compositional inverses of cycle index series



---

archive/issue_comments_180899.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:14 darij]:\n\nThanks for your suggestions! I've uploaded a new version of my patch which incorporates some of your changes and applies on top of the current 5.12-beta3 source; see comments below.\n\n> And I have not filled in the definition of functorial composition since I don't fully understand it myself (I don't have the [BLL] reference, only [BLL-Intro]), but I've added a #TODO because it should eventually be filled in.\n\n\nI cleaned this up in #14809, which will go live when 5.12 ships.\n\n> In the stretch doctest, I replaced `f = CIS([p([1])])` by `f = CIS([p([]), p([1]), p([2]), p.zero()])` because, as far as I understand, when you write a cycle index series as a power series in t, the coefficient before `t^n` has to be a symmetric polynomial homogeneous of degree n.\n\n\nThis sounds right to me, but I haven't rolled it in because it's not related to compositional inverses. I also left out your other small tweaks to other docstrings It looks like all of this documentation could use an overhaul, though.\n\n> I have removed the reference to [BLL] from your method because the same reference appears in another method. Generally, every reference needs to exist only once in the source.\n\n\nWhoops!\n\n> I added the `res._name = 'res'` line because the examples in the `define` method in `series.py` do that. Maybe it is cargo cult. I hope you can shed light on this.\n\n\nI don't claim to understand this entirely either, but I believe (presumably cultishly) that the _name field is meant for user-facing output and shouldn't be set to something not user-useful like \"res\".\n\nPerhaps one day we'll all ascend to the inner temple of `define` and gain true wisdom.",
    "created_at": "2013-08-27T21:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180899",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:19'></a>Replying to [comment:14 darij]:

Thanks for your suggestions! I've uploaded a new version of my patch which incorporates some of your changes and applies on top of the current 5.12-beta3 source; see comments below.

> And I have not filled in the definition of functorial composition since I don't fully understand it myself (I don't have the [BLL] reference, only [BLL-Intro]), but I've added a #TODO because it should eventually be filled in.


I cleaned this up in #14809, which will go live when 5.12 ships.

> In the stretch doctest, I replaced `f = CIS([p([1])])` by `f = CIS([p([]), p([1]), p([2]), p.zero()])` because, as far as I understand, when you write a cycle index series as a power series in t, the coefficient before `t^n` has to be a symmetric polynomial homogeneous of degree n.


This sounds right to me, but I haven't rolled it in because it's not related to compositional inverses. I also left out your other small tweaks to other docstrings It looks like all of this documentation could use an overhaul, though.

> I have removed the reference to [BLL] from your method because the same reference appears in another method. Generally, every reference needs to exist only once in the source.


Whoops!

> I added the `res._name = 'res'` line because the examples in the `define` method in `series.py` do that. Maybe it is cargo cult. I hope you can shed light on this.


I don't claim to understand this entirely either, but I believe (presumably cultishly) that the _name field is meant for user-facing output and shouldn't be set to something not user-useful like "res".

Perhaps one day we'll all ascend to the inner temple of `define` and gain true wisdom.



---

archive/issue_comments_180900.json:
```json
{
    "body": "<a id='comment:20'></a>I fear I don't understand the species code well enough to complete the review. :( How on earth does the `compose` method know to do plethystic rather than usual composition? I assume the answer lies in `_compose_term` in generating.series.py, but that's some unreadable code with unreadable doc.\n\nYou are right about `_name`; what I wrote was bull. Sorry!\n\nPlease remove the trailing whitespace in your code (such as in `return res    `).",
    "created_at": "2013-09-03T14:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180900",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:20'></a>I fear I don't understand the species code well enough to complete the review. :( How on earth does the `compose` method know to do plethystic rather than usual composition? I assume the answer lies in `_compose_term` in generating.series.py, but that's some unreadable code with unreadable doc.

You are right about `_name`; what I wrote was bull. Sorry!

Please remove the trailing whitespace in your code (such as in `return res    `).



---

archive/issue_comments_180901.json:
```json
{
    "body": "<a id='comment:22'></a>for the **patchbots**:\n\napply trac_14543_cycle_index_compositional_inverse.patch",
    "created_at": "2013-10-22T11:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180901",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>for the **patchbots**:

apply trac_14543_cycle_index_compositional_inverse.patch



---

archive/issue_events_041394.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:07:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41394"
}
```



---

archive/issue_events_041395.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:07:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41395"
}
```



---

archive/issue_comments_180902.json:
```json
{
    "body": "<a id='comment:23'></a>I'll be glad to talk through the math of this code with any interested reviewers. It's not horribly complicated, but it's definitely going to look a bit weird if you're used to working with LazyPowerSeries in different contexts. (CycleIndexSeries is a strange creature, but it's super useful!)\n\nAlso, I've switched back over to using Git to manage this\u2014the old Mercurial workflow is just too confusing. How do I tell the build bot to ignore the attachments and only use the branch?",
    "created_at": "2013-11-23T17:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180902",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:23'></a>I'll be glad to talk through the math of this code with any interested reviewers. It's not horribly complicated, but it's definitely going to look a bit weird if you're used to working with LazyPowerSeries in different contexts. (CycleIndexSeries is a strange creature, but it's super useful!)

Also, I've switched back over to using Git to manage this—the old Mercurial workflow is just too confusing. How do I tell the build bot to ignore the attachments and only use the branch?



---

archive/issue_events_041396.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41396"
}
```



---

archive/issue_events_041397.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41397"
}
```



---

archive/issue_comments_180903.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-12-25T19:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180904.json:
```json
{
    "body": "Changing keywords from \"species, cycle indices\" to \"species, cycle indices, LazyPowerSeries\".",
    "created_at": "2014-01-10T20:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180904",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "species, cycle indices" to "species, cycle indices, LazyPowerSeries".



---

archive/issue_events_041398.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41398"
}
```



---

archive/issue_events_041399.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41399"
}
```



---

archive/issue_events_041400.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41400"
}
```



---

archive/issue_events_041401.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41401"
}
```



---

archive/issue_comments_180905.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-19T06:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180905",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_180906.json:
```json
{
    "body": "<a id='comment:29'></a>```\nError building the documentation.\nOSError: [combinat ] None:4: WARNING: citation not found: BLL-Intro\n```",
    "created_at": "2014-05-19T06:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180906",
    "user": "https://github.com/rwst"
}
```

<a id='comment:29'></a>```
Error building the documentation.
OSError: [combinat ] None:4: WARNING: citation not found: BLL-Intro
```



---

archive/issue_comments_180907.json:
```json
{
    "body": "<a id='comment:31'></a>I have corrected the failing doc, hopefully.\n\n---\nNew commits:",
    "created_at": "2014-05-25T20:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180907",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>I have corrected the failing doc, hopefully.

---
New commits:



---

archive/issue_comments_180908.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-25T20:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180908",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_180909.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-28T12:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_180910.json:
```json
{
    "body": "<a id='comment:33'></a>This looks good to me. Andrew, if you agree with my latest commit, you can set that to positive review.",
    "created_at": "2014-05-28T18:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180910",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'></a>This looks good to me. Andrew, if you agree with my latest commit, you can set that to positive review.



---

archive/issue_comments_180911.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-31T16:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180911",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_180912.json:
```json
{
    "body": "<a id='comment:34'></a>Yes, this looks good to me as well! Positive review confirmed. Thanks for your help!",
    "created_at": "2014-05-31T16:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180912",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:34'></a>Yes, this looks good to me as well! Positive review confirmed. Thanks for your help!



---

archive/issue_comments_180913.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-02T12:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14543#issuecomment-180913",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_041402.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-02T12:54:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14543",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14543#event-41402"
}
```
