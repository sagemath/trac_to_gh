# Issue 14209: Extra assumption kept by Maxima

archive/issues_014005.json:
```json
{
    "body": "From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY\n\n```\nInitial symptom:\nsage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           \n2*log(2)\nsage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n```\n\nA closer look:\n\n```\nsage: from sage.interfaces.maxima_lib import sr_to_max\nsage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n<ECL: ((MTIMES) ((%LOG) 2) 2)>\nsage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n```\n\nAssignee: @burcin\n\nKeywords: maxima ecl\n\nBranch/Commit: 999e21f109dd9741693987a91728129955c50056\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Travis Scrimshaw, Peter Bruin\n\nAuthor: Karl-Dieter Crisman\n\nDependencies: #13973, #13712, #11984, #15386\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14209\n\n",
    "closed_at": "2014-06-02T12:54:38Z",
    "created_at": "2013-03-01T14:13:50Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Extra assumption kept by Maxima",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14209",
    "user": "https://github.com/pipedream"
}
```
From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY

```
Initial symptom:
sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           
2*log(2)
sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
```

A closer look:

```
sage: from sage.interfaces.maxima_lib import sr_to_max
sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
<ECL: ((MTIMES) ((%LOG) 2) 2)>
sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
```

Assignee: @burcin

Keywords: maxima ecl

Branch/Commit: 999e21f109dd9741693987a91728129955c50056

Upstream: Fixed upstream, in a later stable release.

Reviewer: Travis Scrimshaw, Peter Bruin

Author: Karl-Dieter Crisman

Dependencies: #13973, #13712, #11984, #15386

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14209





---

archive/issue_comments_218240.json:
```json
{
    "body": "Replying to [ticket:14209 pipedream]:\n> From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY\n> \n> Initial symptom:\n> sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           \n> 2*log(2)\n> sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\n> \n> ---\n> ValueError                                Traceback (most recent call last)\n> \n> \n> A closer look:\n> sage: from sage.interfaces.maxima_lib import sr_to_max\n> sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n> <ECL: ((MTIMES) ((%LOG) 2) 2)>\n> sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n> \n> ---\n> ValueError                                Traceback (most recent call last)\n\n>",
    "created_at": "2013-03-01T14:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218240",
    "user": "https://github.com/pipedream"
}
```

Replying to [ticket:14209 pipedream]:
> From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY
> 
> Initial symptom:
> sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           
> 2*log(2)
> sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
> 
> ---
> ValueError                                Traceback (most recent call last)
> 
> 
> A closer look:
> sage: from sage.interfaces.maxima_lib import sr_to_max
> sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
> <ECL: ((MTIMES) ((%LOG) 2) 2)>
> sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
> 
> ---
> ValueError                                Traceback (most recent call last)

>



---

archive/issue_comments_218241.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY\n \n+\"\"\"\n Initial symptom:\n sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           \n 2*log(2)\n@@ -7,9 +8,10 @@\n \n ---\n ValueError                                Traceback (most recent call last)\n-\n+\"\"\"\n \n A closer look:\n+\"\"\"\n sage: from sage.interfaces.maxima_lib import sr_to_max\n sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n <ECL: ((MTIMES) ((%LOG) 2) 2)>\n@@ -17,5 +19,5 @@\n \n ---\n ValueError                                Traceback (most recent call last)\n+\"\"\"\n \n-\n``````\n",
    "created_at": "2013-03-01T14:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218241",
    "user": "https://github.com/pipedream"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
 From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY
 
+"""
 Initial symptom:
 sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           
 2*log(2)
@@ -7,9 +8,10 @@
 
 ---
 ValueError                                Traceback (most recent call last)
-
+"""
 
 A closer look:
+"""
 sage: from sage.interfaces.maxima_lib import sr_to_max
 sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
 <ECL: ((MTIMES) ((%LOG) 2) 2)>
@@ -17,5 +19,5 @@
 
 ---
 ValueError                                Traceback (most recent call last)
+"""
 
-
``````




---

archive/issue_comments_218242.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to calculus.",
    "created_at": "2013-03-01T16:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218242",
    "user": "https://github.com/kcrisman"
}
```

Changing component from PLEASE CHANGE to calculus.



---

archive/issue_comments_218243.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,23 +1,21 @@\n From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY\n \n-\"\"\"\n+```\n Initial symptom:\n sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           \n 2*log(2)\n sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\n-\n----\n+---------------------------------------------------------------------------\n ValueError                                Traceback (most recent call last)\n-\"\"\"\n+```\n \n A closer look:\n-\"\"\"\n+\n+```\n sage: from sage.interfaces.maxima_lib import sr_to_max\n sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n <ECL: ((MTIMES) ((%LOG) 2) 2)>\n sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))\n-\n----\n+---------------------------------------------------------------------------\n ValueError                                Traceback (most recent call last)\n-\"\"\"\n-\n+```\n``````\n",
    "created_at": "2013-03-01T16:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218243",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,23 +1,21 @@
 From: https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/jIjYSSCPrrY
 
-"""
+```
 Initial symptom:
 sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           
 2*log(2)
 sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
-
----
+---------------------------------------------------------------------------
 ValueError                                Traceback (most recent call last)
-"""
+```
 
 A closer look:
-"""
+
+```
 sage: from sage.interfaces.maxima_lib import sr_to_max
 sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
 <ECL: ((MTIMES) ((%LOG) 2) 2)>
 sage: sr_to_max(integral(e^(-abs(x))/cosh(x),x,-infinity,infinity))
-
----
+---------------------------------------------------------------------------
 ValueError                                Traceback (most recent call last)
-"""
-
+```
``````




---

archive/issue_comments_218244.json:
```json
{
    "body": "Changing assignee from tbd to @burcin.",
    "created_at": "2013-03-01T16:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218244",
    "user": "https://github.com/kcrisman"
}
```

Changing assignee from tbd to @burcin.



---

archive/issue_comments_218245.json:
```json
{
    "body": "<a id='comment:3'></a>Just a couple of notes:\n- we patch maxima to throw an error rather than print \"Principal Value\".\n- internally, maxima has a flag that gets set if Principal Value has already been printed, to prevent it from being printed repeatedly.\n- this flag also gets used to suppress the \"Principal Value\" warning in certain cases where their integration code apparently knows it's safe to take a principal value.\n- so we don't throw an error if maxima wouldn't print the warning.\n\nIt would seem something about this setting gets messed up. My guess it's the way maxima deals internally with the doubly infinite integral:\n\n```\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)\nlog(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,0,oo)\nlog(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)\nlog(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,0,oo)\nlog(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)\n2*log(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,0,oo)\nlog(2)\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)\nValueError: Integral is divergent.\nsage: integrate(exp(-abs(x))/cosh(x),x,0,oo)\nlog(2)\n```\nAt this point it can hardly be anything in the way we translate things for maxima. It's got to be in the internals in maxima. They may have changed something internally in maxima that doesn't jive well with our patch (see `maxima_lib.py`):\n\n```\necl_eval('(defun principal nil (cond ($noprincipal (diverg)) ((not pcprntd) (merror \"Divergent Integral\"))))')\n```\nFor instance, in sage 4.7.1, which uses maxima 5.23.2, this problem does not arise. \n\nIn fact, when you look at the message that is returned, it's:\n\n```\nECL says: Error executing code in Maxima: defint: integral is divergent.\n```\nwhich is the error message that gets generated by `diverg`. So it seems the second time around, this code is executed with `$noprincipal` set.\n\nBEWARE: both `noprincipal` and `pcprntd` are \"special\" variables, which means they are dynamically scoped. That's different from what you're probably used to.\n\nFurthermore, the definition of `diverg` is:\n\n```\n(defun diverg nil\n  (cond (*nodiverg (throw 'divergent 'divergent))\n\t(t (merror (intl:gettext \"defint: integral is divergent.\")))))\n```\nwhich shows the behaviour can be influenced by yet another special variable, `*nodiverg`. In `defint.lisp` this really gets used: they sometimes prefer a condition thrown that they catch rather than generate an `merror`. If you compare the `defint.lisp` between 5.26.0 and 5.29.1 (sage 5.0 uses the former and does not have this problem. sage 5.7 uses the latter), you'll find some changes that look like they might change behaviour around such constructs, but I wasn't able to detect a smoking gun. And of course the problem may lie in a different file and/or a bug in how the new ECL handles dynamic variables (which is unlikely and would be disconcerting, because they form a basic component of CL)",
    "created_at": "2013-03-01T18:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218245",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:3'></a>Just a couple of notes:
- we patch maxima to throw an error rather than print "Principal Value".
- internally, maxima has a flag that gets set if Principal Value has already been printed, to prevent it from being printed repeatedly.
- this flag also gets used to suppress the "Principal Value" warning in certain cases where their integration code apparently knows it's safe to take a principal value.
- so we don't throw an error if maxima wouldn't print the warning.

It would seem something about this setting gets messed up. My guess it's the way maxima deals internally with the doubly infinite integral:

```
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)
log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,0,oo)
log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)
log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,0,oo)
log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)
2*log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,0,oo)
log(2)
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,0)
ValueError: Integral is divergent.
sage: integrate(exp(-abs(x))/cosh(x),x,0,oo)
log(2)
```
At this point it can hardly be anything in the way we translate things for maxima. It's got to be in the internals in maxima. They may have changed something internally in maxima that doesn't jive well with our patch (see `maxima_lib.py`):

```
ecl_eval('(defun principal nil (cond ($noprincipal (diverg)) ((not pcprntd) (merror "Divergent Integral"))))')
```
For instance, in sage 4.7.1, which uses maxima 5.23.2, this problem does not arise. 

In fact, when you look at the message that is returned, it's:

```
ECL says: Error executing code in Maxima: defint: integral is divergent.
```
which is the error message that gets generated by `diverg`. So it seems the second time around, this code is executed with `$noprincipal` set.

BEWARE: both `noprincipal` and `pcprntd` are "special" variables, which means they are dynamically scoped. That's different from what you're probably used to.

Furthermore, the definition of `diverg` is:

```
(defun diverg nil
  (cond (*nodiverg (throw 'divergent 'divergent))
	(t (merror (intl:gettext "defint: integral is divergent.")))))
```
which shows the behaviour can be influenced by yet another special variable, `*nodiverg`. In `defint.lisp` this really gets used: they sometimes prefer a condition thrown that they catch rather than generate an `merror`. If you compare the `defint.lisp` between 5.26.0 and 5.29.1 (sage 5.0 uses the former and does not have this problem. sage 5.7 uses the latter), you'll find some changes that look like they might change behaviour around such constructs, but I wasn't able to detect a smoking gun. And of course the problem may lie in a different file and/or a bug in how the new ECL handles dynamic variables (which is unlikely and would be disconcerting, because they form a basic component of CL)



---

archive/issue_comments_218246.json:
```json
{
    "body": "<a id='comment:4'></a>I don't think it has anything to do with `principal` or with `diverg`. I think there is an assumption on `x` that sticks around so that `abs(x)` gets simplified to `x`. Of course, `integrate(exp(-abs(x))/cosh(x),x,-oo,oo)` really is divergent. Evidence:\n\n```\nsage: maxima_calculus.eval(\"facts()\")\n'[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing)]'\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)\n2*log(2)\nsage: maxima_calculus.eval(\"facts()\")\n'[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing),x>0]'\n```\nIndeed, if we subsequently do\n\n```\nsage: maxima_calculus.eval(\"forget(x>0)\")\n'[x>0]'\nsage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)\n2*log(2)\n```\nwe see the damage is undone (and redone with the second line of course).\n\nThe fact that we have a problem here and maxima itself doesn't seem to have a problem suggests that we are handling contexts differently from what maxima is doing. See maxima's documentation.\n\nmaxima's `defint.lisp` contains plenty of `assume` commands, but very little seems to have changed in how they're used. I don't know where the change comes from.",
    "created_at": "2013-03-02T03:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218246",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:4'></a>I don't think it has anything to do with `principal` or with `diverg`. I think there is an assumption on `x` that sticks around so that `abs(x)` gets simplified to `x`. Of course, `integrate(exp(-abs(x))/cosh(x),x,-oo,oo)` really is divergent. Evidence:

```
sage: maxima_calculus.eval("facts()")
'[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing)]'
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)
2*log(2)
sage: maxima_calculus.eval("facts()")
'[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing),x>0]'
```
Indeed, if we subsequently do

```
sage: maxima_calculus.eval("forget(x>0)")
'[x>0]'
sage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)
2*log(2)
```
we see the damage is undone (and redone with the second line of course).

The fact that we have a problem here and maxima itself doesn't seem to have a problem suggests that we are handling contexts differently from what maxima is doing. See maxima's documentation.

maxima's `defint.lisp` contains plenty of `assume` commands, but very little seems to have changed in how they're used. I don't know where the change comes from.



---

archive/issue_comments_218247.json:
```json
{
    "body": "<a id='comment:5'></a>> {{{\n> sage: maxima_calculus.eval(\"facts()\")\n> '[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing)]'\n> sage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)\n> 2*log(2)\n> sage: maxima_calculus.eval(\"facts()\")\n> '[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing),x>0]'\n> }}}\n\nYeah, that sounds like a bug or something.  Huh.",
    "created_at": "2013-03-02T04:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218247",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>> {{{
> sage: maxima_calculus.eval("facts()")
> '[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing)]'
> sage: integrate(exp(-abs(x))/cosh(x),x,-oo,oo)
> 2*log(2)
> sage: maxima_calculus.eval("facts()")
> '[kind(sinh,one_to_one),kind(log,one_to_one),kind(tanh,one_to_one),kind(log,increasing),x>0]'
> }}}

Yeah, that sounds like a bug or something.  Huh.



---

archive/issue_comments_218248.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2013-03-02T05:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218248",
    "user": "https://github.com/nbruin"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_218249.json:
```json
{
    "body": "<a id='comment:6'></a>Cool. It's not our fault. It's an error in `abs_integrate.mac`, which we load:\n\n```\nMaxima 5.29.1 http://maxima.sourceforge.net\nusing Lisp ECL 12.12.1\nDistributed under the GNU Public License. See the file COPYING.\nDedicated to the memory of William Schelter.\nThe function bug_report() provides bug reporting information.\n(%i1) load(abs_integrate);\ndefint(exp(-abs(x))/cosh(x),x,minf,inf);\ndefint(exp(-abs(x))/cosh(x),x,minf,inf);\n(%o1) /usr/local/sage/5.7/local/share/maxima/5.29.1/share/contrib/integration/\\\nabs_integrate.mac\n(%i2) (%o2)                              2 log(2)\n(%i3) \ndefint: integral is divergent.\n -- an error. To debug this try: debugmode(true);\n```\nThis is now [maxima #2557](https://sourceforge.net/p/maxima/bugs/2557/).",
    "created_at": "2013-03-02T05:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218249",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:6'></a>Cool. It's not our fault. It's an error in `abs_integrate.mac`, which we load:

```
Maxima 5.29.1 http://maxima.sourceforge.net
using Lisp ECL 12.12.1
Distributed under the GNU Public License. See the file COPYING.
Dedicated to the memory of William Schelter.
The function bug_report() provides bug reporting information.
(%i1) load(abs_integrate);
defint(exp(-abs(x))/cosh(x),x,minf,inf);
defint(exp(-abs(x))/cosh(x),x,minf,inf);
(%o1) /usr/local/sage/5.7/local/share/maxima/5.29.1/share/contrib/integration/\
abs_integrate.mac
(%i2) (%o2)                              2 log(2)
(%i3) 
defint: integral is divergent.
 -- an error. To debug this try: debugmode(true);
```
This is now [maxima #2557](https://sourceforge.net/p/maxima/bugs/2557/).



---

archive/issue_comments_218250.json:
```json
{
    "body": "<a id='comment:7'></a>There has been a fair amount of activity on this, see the [thread starting here](http://www.math.utexas.edu/pipermail/maxima/2013/032109.html) on the Maxima list.",
    "created_at": "2013-03-15T18:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218250",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>There has been a fair amount of activity on this, see the [thread starting here](http://www.math.utexas.edu/pipermail/maxima/2013/032109.html) on the Maxima list.



---

archive/issue_comments_218251.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2013-03-15T18:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218251",
    "user": "https://github.com/kcrisman"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_218252.json:
```json
{
    "body": "<a id='comment:9'></a>Maxima bug #2557 [1] fixed by commit 4b8a98648d4 [2]. Thanks for the bug report.\n\n[1] https://sourceforge.net/p/maxima/bugs/2557/\n[2] https://sourceforge.net/p/maxima/code/ci/4b8a98648d4da26805ea3238eee216611245e14a/",
    "created_at": "2013-03-23T04:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218252",
    "user": "https://trac.sagemath.org/admin/accounts/users/robert_dodier"
}
```

<a id='comment:9'></a>Maxima bug #2557 [1] fixed by commit 4b8a98648d4 [2]. Thanks for the bug report.

[1] https://sourceforge.net/p/maxima/bugs/2557/
[2] https://sourceforge.net/p/maxima/code/ci/4b8a98648d4da26805ea3238eee216611245e14a/



---

archive/issue_comments_218253.json:
```json
{
    "body": "<a id='comment:10'></a>This will be in the upcoming 5.30.  Needs patch to verify at that time.",
    "created_at": "2013-03-23T12:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218253",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>This will be in the upcoming 5.30.  Needs patch to verify at that time.



---

archive/issue_comments_218254.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2013-03-23T12:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218254",
    "user": "https://github.com/kcrisman"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, in a later stable release."



---

archive/issue_events_040114.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40114"
}
```



---

archive/issue_events_040115.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40115"
}
```



---

archive/issue_events_040116.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40116"
}
```



---

archive/issue_events_040117.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40117"
}
```



---

archive/issue_events_040118.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40118"
}
```



---

archive/issue_comments_218255.json:
```json
{
    "body": "<a id='comment:14'></a>This is indeed fixed upstream and after #13973 we get\n\n```\nsage: sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           \n2*log(2)\nsage: sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\n2*log(2)\n```",
    "created_at": "2014-05-17T14:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218255",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:14'></a>This is indeed fixed upstream and after #13973 we get

```
sage: sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)           
2*log(2)
sage: sage: integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
2*log(2)
```



---

archive/issue_comments_218256.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#13973\"",
    "created_at": "2014-05-17T14:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218256",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "" to "#13973"



---

archive/issue_comments_218257.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218257",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218258.json:
```json
{
    "body": "Changing commit from \"\" to \"54d060972983ad223c7b7f572ffad308b8b4dc56\"",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218258",
    "user": "https://github.com/kcrisman"
}
```

Changing commit from "" to "54d060972983ad223c7b7f572ffad308b8b4dc56"



---

archive/issue_comments_218259.json:
```json
{
    "body": "<a id='comment:15'></a>Again, my apologies for all the dependencies, not knowing how to do this so it doesn't depend on previous stuff - I'm still in the hg queue mode.\n\n---\nLast 10 new commits:",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218259",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>Again, my apologies for all the dependencies, not knowing how to do this so it doesn't depend on previous stuff - I'm still in the hg queue mode.

---
Last 10 new commits:



---

archive/issue_comments_218260.json:
```json
{
    "body": "Changing dependencies from \"#13973\" to \"#13973, #13712, #11984, #15386\"",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218260",
    "user": "https://github.com/kcrisman"
}
```

Changing dependencies from "#13973" to "#13973, #13712, #11984, #15386"



---

archive/issue_comments_218261.json:
```json
{
    "body": "Changing author from \"\" to \"Karl-Dieter Crisman\"",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218261",
    "user": "https://github.com/kcrisman"
}
```

Changing author from "" to "Karl-Dieter Crisman"



---

archive/issue_comments_218262.json:
```json
{
    "body": "Changing branch from \"\" to \"u/kcrisman/14209_doc_fix_twoints\"",
    "created_at": "2014-05-30T13:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218262",
    "user": "https://github.com/kcrisman"
}
```

Changing branch from "" to "u/kcrisman/14209_doc_fix_twoints"



---

archive/issue_comments_218263.json:
```json
{
    "body": "<a id='comment:16'></a>Just commit 54d0609 matters.",
    "created_at": "2014-05-30T13:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218263",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'></a>Just commit 54d0609 matters.



---

archive/issue_comments_218264.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2014-05-30T13:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218264",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_218265.json:
```json
{
    "body": "<a id='comment:17'></a>LGTM (as well `:p`)",
    "created_at": "2014-05-30T13:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218265",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>LGTM (as well `:p`)



---

archive/issue_comments_218266.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-30T13:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218266",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218267.json:
```json
{
    "body": "<a id='comment:18'></a>Doctests fail on my system:\n\n```\nsage -t --long src/sage/symbolic/integration/integral.py\n**********************************************************************\nFile \"src/sage/symbolic/integration/integral.py\", line 684, in sage.symbolic.int\negration.integral.integrate\nFailed example:\n    integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: Integral is divergent.\n**********************************************************************\nFile \"src/sage/symbolic/integration/integral.py\", line 686, in sage.symbolic.int\negration.integral.integrate\nFailed example:\n    integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: Integral is divergent.\n**********************************************************************\n```\nThere is no error when running the example directly from the Sage prompt.  Maybe a bad assumption made elsewhere in `integral.py` is creeping in?  [Edit: it seems to be caused by \"assume(x>0)\" a few lines above.]",
    "created_at": "2014-05-30T14:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218267",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:18'></a>Doctests fail on my system:

```
sage -t --long src/sage/symbolic/integration/integral.py
**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 684, in sage.symbolic.int
egration.integral.integrate
Failed example:
    integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: Integral is divergent.
**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 686, in sage.symbolic.int
egration.integral.integrate
Failed example:
    integral(e^(-abs(x))/cosh(x),x,-infinity,infinity)
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: Integral is divergent.
**********************************************************************
```
There is no error when running the example directly from the Sage prompt.  Maybe a bad assumption made elsewhere in `integral.py` is creeping in?  [Edit: it seems to be caused by "assume(x>0)" a few lines above.]



---

archive/issue_comments_218268.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-05-30T14:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218268",
    "user": "https://github.com/pjbruin"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218269.json:
```json
{
    "body": "<a id='comment:19'></a>Integrating over *x* in **R** after assuming *x* > 0 is problematic in Maxima:\n\n```\n$ sage --maxima\n...\n(%i1) load(abs_integrate)$\n\n(%i2) defint(exp(-abs(x))/cosh(x),x,minf,inf);\n(%o2)                              2 log(2)\n(%i3) assume(x>0);\n(%o3)                               [x > 0]\n(%i4) defint(exp(-abs(x))/cosh(x),x,minf,inf);\n\ndefint: integral is divergent.\n -- an error. To debug this try: debugmode(true);\n```\nThe easiest solution is to put `forget(x > 0)` at the end of the doctest with `assume(x > 0)`.",
    "created_at": "2014-05-30T14:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218269",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:19'></a>Integrating over *x* in **R** after assuming *x* > 0 is problematic in Maxima:

```
$ sage --maxima
...
(%i1) load(abs_integrate)$

(%i2) defint(exp(-abs(x))/cosh(x),x,minf,inf);
(%o2)                              2 log(2)
(%i3) assume(x>0);
(%o3)                               [x > 0]
(%i4) defint(exp(-abs(x))/cosh(x),x,minf,inf);

defint: integral is divergent.
 -- an error. To debug this try: debugmode(true);
```
The easiest solution is to put `forget(x > 0)` at the end of the doctest with `assume(x > 0)`.



---

archive/issue_comments_218270.json:
```json
{
    "body": "<a id='comment:20'></a>> The easiest solution is to put `forget(x > 0)` at the end of the doctest with `assume(x > 0)`.\n\nSorry, I didn't run tests because it worked in my local Sage, as you say.  Certainly if we assumed this above we should forget it - preferably immediately after the assumption - that is the usual practice here.\n\nAnyway, I'll update this momentarily.",
    "created_at": "2014-05-30T16:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218270",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>> The easiest solution is to put `forget(x > 0)` at the end of the doctest with `assume(x > 0)`.

Sorry, I didn't run tests because it worked in my local Sage, as you say.  Certainly if we assumed this above we should forget it - preferably immediately after the assumption - that is the usual practice here.

Anyway, I'll update this momentarily.



---

archive/issue_comments_218271.json:
```json
{
    "body": "Changing commit from \"54d060972983ad223c7b7f572ffad308b8b4dc56\" to \"999e21f109dd9741693987a91728129955c50056\"",
    "created_at": "2014-05-30T16:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "54d060972983ad223c7b7f572ffad308b8b4dc56" to "999e21f109dd9741693987a91728129955c50056"



---

archive/issue_comments_218272.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-30T16:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218272",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218273.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-30T16:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218273",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218274.json:
```json
{
    "body": "Changing reviewer from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Peter Bruin\"",
    "created_at": "2014-05-30T16:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218274",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "Travis Scrimshaw" to "Travis Scrimshaw, Peter Bruin"



---

archive/issue_comments_218275.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-30T16:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218275",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218276.json:
```json
{
    "body": "<a id='comment:24'></a>Thanks.",
    "created_at": "2014-05-30T16:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218276",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>Thanks.



---

archive/issue_comments_218277.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-02T12:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218277",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_218278.json:
```json
{
    "body": "Changing branch from \"u/kcrisman/14209_doc_fix_twoints\" to \"999e21f109dd9741693987a91728129955c50056\"",
    "created_at": "2014-06-02T12:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14209#issuecomment-218278",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/kcrisman/14209_doc_fix_twoints" to "999e21f109dd9741693987a91728129955c50056"



---

archive/issue_events_040119.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-02T12:54:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14209",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14209#event-40119"
}
```
