# Issue 14219: rational preperiodic points for projective morphisms

archive/issues_014015.json:
```json
{
    "body": "Main algorithms from Hutz, \"Determination of all rational preperiodic points for morphisms of PN\", submitted\n\nAlso includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.\n\nImplements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.\n\n\nApply:\n\n* [attachment:trac_14219_rational_preperiodic.patch]\n\n**Assignee:** @bhutz\n\n**Keywords:** dynamics, sage-days55\n\n**Reviewer:** Vincent Delecroix, Adam Towsley\n\n**Author:** Ben Hutz\n\n**Merged:** sage-5.13.beta4\n\n**Dependencies:** #14218\n\nIssue created by migration from https://trac.sagemath.org/ticket/14219\n\n",
    "closed_at": "2013-11-22T15:49:05Z",
    "created_at": "2013-03-03T18:35:02Z",
    "labels": [
        "component: algebraic geometry",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "rational preperiodic points for projective morphisms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14219",
    "user": "https://github.com/bhutz"
}
```
Main algorithms from Hutz, "Determination of all rational preperiodic points for morphisms of PN", submitted

Also includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.

Implements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.


Apply:

* [attachment:trac_14219_rational_preperiodic.patch]

**Assignee:** @bhutz

**Keywords:** dynamics, sage-days55

**Reviewer:** Vincent Delecroix, Adam Towsley

**Author:** Ben Hutz

**Merged:** sage-5.13.beta4

**Dependencies:** #14218

Issue created by migration from https://trac.sagemath.org/ticket/14219





---

archive/issue_comments_172149.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Main algorithms from Hutz, \"Determination of all rational preperiodic points for morphisms of PN\", submitted\n \n-Also includes the last of the ICERM dynamics functionality. Building on Trac 13130, Trac 14217, Trac 14218.\n+Also includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.\n \n Implements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.\n``````\n",
    "created_at": "2013-03-06T12:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172149",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Main algorithms from Hutz, "Determination of all rational preperiodic points for morphisms of PN", submitted
 
-Also includes the last of the ICERM dynamics functionality. Building on Trac 13130, Trac 14217, Trac 14218.
+Also includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.
 
 Implements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.
``````




---

archive/attachments_019187.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "rational_preperiodic.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14219/rational_preperiodic.patch",
    "created_at": "2013-03-06T12:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/fchapoton"
}
```



---

archive/issue_comments_172150.json:
```json
{
    "body": "<a id='comment:1'></a>\n",
    "created_at": "2013-03-06T12:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172150",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>




---

archive/issue_comments_172151.json:
```json
{
    "body": "**Changing dependencies** from \"14128\" to \"#14128\".",
    "created_at": "2013-03-06T12:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172151",
    "user": "https://github.com/fchapoton"
}
```

**Changing dependencies** from "14128" to "#14128".



---

archive/issue_comments_172152.json:
```json
{
    "body": "**Changing dependencies** from \"#14128\" to \"#14218\".",
    "created_at": "2013-03-06T12:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172152",
    "user": "https://github.com/fchapoton"
}
```

**Changing dependencies** from "#14128" to "#14218".



---

archive/issue_comments_172153.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,8 @@\n Also includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.\n \n Implements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.\n+\n+\n+Apply:\n+\n+* [attachment:trac_14219_rational_preperiodic.patch]\n``````\n",
    "created_at": "2013-03-18T12:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172153",
    "user": "https://github.com/bhutz"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,8 @@
 Also includes the last of the ICERM dynamics functionality. Building on #13130, #14217, #14218.
 
 Implements all necessary functionality to determine QQ-rational periodic and preperiodic points for morphism of projective space in any dimension. This includes multipliers, hensel lifting, height difference bound, etc.
+
+
+Apply:
+
+* [attachment:trac_14219_rational_preperiodic.patch]
``````




---

archive/issue_events_122780.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-04-15T16:26:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122780"
}
```



---

archive/issue_comments_172154.json:
```json
{
    "body": "<a id='comment:5'></a>\nFinished cleaning it up. Ready for review.\n\nChanged the milestone to something more realistic.",
    "created_at": "2013-04-15T16:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172154",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:5'></a>
Finished cleaning it up. Ready for review.

Changed the milestone to something more realistic.



---

archive/issue_events_122781.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-04-15T16:26:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122781"
}
```



---

archive/issue_events_122782.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-04-15T16:26:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122782"
}
```



---

archive/issue_comments_172155.json:
```json
{
    "body": "<a id='comment:6'></a>\napply trac_14219_rational_preperiodic.patch",
    "created_at": "2013-05-07T20:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172155",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
apply trac_14219_rational_preperiodic.patch



---

archive/issue_comments_172156.json:
```json
{
    "body": "<a id='comment:7'></a>\nThere is one doctest missing.",
    "created_at": "2013-05-23T19:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172156",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>
There is one doctest missing.



---

archive/issue_comments_172157.json:
```json
{
    "body": "**Work_Issues:** doctest missing",
    "created_at": "2013-05-23T19:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172157",
    "user": "https://github.com/fchapoton"
}
```

**Work_Issues:** doctest missing



---

archive/issue_comments_172158.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"dynamics\".",
    "created_at": "2013-05-23T19:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172158",
    "user": "https://github.com/fchapoton"
}
```

**Changing keywords** from "" to "dynamics".



---

archive/issue_events_122783.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-23T19:52:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122783"
}
```



---

archive/issue_events_122784.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-23T19:52:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122784"
}
```



---

archive/issue_events_122785.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122785"
}
```



---

archive/issue_events_122786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122786"
}
```



---

archive/issue_events_122787.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-08-23T22:55:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122787"
}
```



---

archive/issue_events_122788.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-08-23T22:55:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122788"
}
```



---

archive/issue_comments_172159.json:
```json
{
    "body": "<a id='comment:9'></a>\nFixed the missing doctest.\n\nThis passes all tests on my machine for sage 5.11.",
    "created_at": "2013-08-23T22:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172159",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:9'></a>
Fixed the missing doctest.

This passes all tests on my machine for sage 5.11.



---

archive/issue_comments_172160.json:
```json
{
    "body": "**Changing work_issues** from \"doctest missing\" to \"\".",
    "created_at": "2013-08-23T22:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172160",
    "user": "https://github.com/bhutz"
}
```

**Changing work_issues** from "doctest missing" to "".



---

archive/issue_comments_172161.json:
```json
{
    "body": "<a id='comment:10'></a>\napply trac_14219_rational_preperiodic.patch",
    "created_at": "2013-08-23T22:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172161",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:10'></a>
apply trac_14219_rational_preperiodic.patch



---

archive/issue_comments_172162.json:
```json
{
    "body": "<a id='comment:11'></a>\napply trac_14219_rational_preperiodic.patch",
    "created_at": "2013-09-04T16:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172162",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:11'></a>
apply trac_14219_rational_preperiodic.patch



---

archive/issue_comments_172163.json:
```json
{
    "body": "<a id='comment:12'></a>\napply trac_14219_rational_preperiodic.patch",
    "created_at": "2013-10-20T13:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172163",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:12'></a>
apply trac_14219_rational_preperiodic.patch



---

archive/issue_comments_172164.json:
```json
{
    "body": "<a id='comment:13'></a>\napply trac_14219_rational_preperiodic.patch",
    "created_at": "2013-10-21T17:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172164",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:13'></a>
apply trac_14219_rational_preperiodic.patch



---

archive/issue_comments_172165.json:
```json
{
    "body": "optimize the root order computation over finite fields",
    "created_at": "2013-11-07T19:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172165",
    "user": "https://github.com/videlec"
}
```

optimize the root order computation over finite fields



---

archive/attachments_019188.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14219-optimize_root_order_computation.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14219/trac_14219-optimize_root_order_computation.patch",
    "created_at": "2013-11-07T19:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/videlec"
}
```



---

archive/issue_comments_172166.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi there,\n\nSome quick comments (I am not the person designed to review the mathematics in there):\n- the patch does not apply on sage-5.13.beta2\n- there are many trailing whitescaces that need to be removed\n- the indentation must be 4 spaces wide (it is 3 in many places)\n- sage convention is that `CamelCaseConvention` is somewhat reserved to classes and it would be better to not use it as variables names (I think this is too much pain to change it right now)\n- in the examples one should use \"a = bla()\" instead of \"a=bla()\"\n\nWe also discussed a very specific issue in the code (line 2588 to 2601). The [attachment:trac_14219-optimize_root_order_computation.patch] proposes a much direct version with, as a consequence, a little bit of speedup.",
    "created_at": "2013-11-07T19:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172166",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Hi there,

Some quick comments (I am not the person designed to review the mathematics in there):
- the patch does not apply on sage-5.13.beta2
- there are many trailing whitescaces that need to be removed
- the indentation must be 4 spaces wide (it is 3 in many places)
- sage convention is that `CamelCaseConvention` is somewhat reserved to classes and it would be better to not use it as variables names (I think this is too much pain to change it right now)
- in the examples one should use "a = bla()" instead of "a=bla()"

We also discussed a very specific issue in the code (line 2588 to 2601). The [attachment:trac_14219-optimize_root_order_computation.patch] proposes a much direct version with, as a consequence, a little bit of speedup.



---

archive/issue_events_122789.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2013-11-07T19:46:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122789"
}
```



---

archive/issue_events_122790.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2013-11-07T19:46:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122790"
}
```



---

archive/issue_comments_172167.json:
```json
{
    "body": "**Changing keywords** from \"dynamics\" to \"dynamics, sage-days55\".",
    "created_at": "2013-11-08T15:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172167",
    "user": "https://github.com/bhutz"
}
```

**Changing keywords** from "dynamics" to "dynamics, sage-days55".



---

archive/issue_comments_172168.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2013-11-08T15:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172168",
    "user": "https://github.com/bhutz"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_172169.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe change for the eigenvalue computation looks fine, I've folded that into the main patch.\n\nI removed the whitespace and added the spaces around the = signs.\n\nI also adjusted the variable naming as that wasn't too tedious.\n\nI couldn't find any 3 space indents, could you point out where those are.",
    "created_at": "2013-11-08T15:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172169",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:16'></a>
The change for the eigenvalue computation looks fine, I've folded that into the main patch.

I removed the whitespace and added the spaces around the = signs.

I also adjusted the variable naming as that wasn't too tedious.

I couldn't find any 3 space indents, could you point out where those are.



---

archive/issue_comments_172170.json:
```json
{
    "body": "<a id='comment:17'></a>\nTo be modified in projective_morphism.py\n\n1) trailing whitespaces in at lines 1663, 1754, 1954, 1971, 1982, 1985, 1992, 1998, 2085, 2106, 2158, 2169, 2221, 2257, 2273, 2317, 2352,\n\n2) why do you use Hom(P,P) instead of End(P) ?\n\n3) problem of upper case/lower case at line 1746 (Periods instead of periods)\n\n4) prefer (line 1743-1746)\n\n```\nreturn sorted(periods)\n```\ninstead of\n\n```\nperiods=list(periods)\nperiods.sort()\nreturn(periods)\n```\n\n5) in method dynatomic_polynomial the argument is called period but is refered in the documentation as n. Moreover the specification of arguments are given too late. In the examples it might be good to check that the dynatomic polynomial actually gives you solution!\n\n```\nsage: P.<x,y> = ProjectiveSpace(QQ,1)\nsage: H = Hom(P,P)\nsage: f = H([x^2+y^2,y^2])\nsage: f.dynatomic_polynomial(2)\nx^2 + x*y + 2*y^2\nsage: K.<c> = NumberField(X^2 + X + 2, 'c')\nsage: PP = P.change_ring(K)\nsage: ff = f.change_ring(K)\nsage: p = PP((c,1))\nsage: ff(ff(p)) == p\n```\nHere I get troubles with coercions (this is why I defined PP and ff): there should be some canonical coercions as there is for polynomials (this will go in another ticket)\n\n```\nsage: R.<x> = PolynomialRing(QQ,'x')\nsage: K.<c> = NumberField(x^2 + 3*x + 1, 'c')\nsage: P = x^6 + 3*x + 19\nsage: P(c)\n-141*c - 36\n```\n\n6) The rational for the choice of putting methods in projective_point.py instead in projective_morphism.py is not at all clear to me. Why orbit, canonical_heights, etc methods of points and not of morphisms ?\n\n7) docbuild troubles\n[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_periodic_points:4: WARNING: Inline literal start-string without end-string.\n[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_periodic_points:72: WARNING: Inline strong start-string without end-string.\n[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism:7: WARNING: Bullet list ends without a blank line; unexpected unindent.\n[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_preperiodic_points:4: WARNING: Inline literal start-string without end-string.\n[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism:12: WARNING: Bullet list ends without a blank line; unexpected unindent.\n\n8) I have serious trouble concerning the green function and canonical heights of points (I know that this was implemented in another ticket). In those two methods, there is no care about the fact that there are errors introduced by the fact that the floating points you are working with are with fixed precision. In particular, with floating points, the result of `x+y` is *not* the sum `x` + `y` but only an approximation of it. I really think that it should be reimplemented either using real interval fields (it will make it slower but at least you get a proven answer).",
    "created_at": "2013-11-08T21:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172170",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
To be modified in projective_morphism.py

1) trailing whitespaces in at lines 1663, 1754, 1954, 1971, 1982, 1985, 1992, 1998, 2085, 2106, 2158, 2169, 2221, 2257, 2273, 2317, 2352,

2) why do you use Hom(P,P) instead of End(P) ?

3) problem of upper case/lower case at line 1746 (Periods instead of periods)

4) prefer (line 1743-1746)

```
return sorted(periods)
```
instead of

```
periods=list(periods)
periods.sort()
return(periods)
```

5) in method dynatomic_polynomial the argument is called period but is refered in the documentation as n. Moreover the specification of arguments are given too late. In the examples it might be good to check that the dynatomic polynomial actually gives you solution!

```
sage: P.<x,y> = ProjectiveSpace(QQ,1)
sage: H = Hom(P,P)
sage: f = H([x^2+y^2,y^2])
sage: f.dynatomic_polynomial(2)
x^2 + x*y + 2*y^2
sage: K.<c> = NumberField(X^2 + X + 2, 'c')
sage: PP = P.change_ring(K)
sage: ff = f.change_ring(K)
sage: p = PP((c,1))
sage: ff(ff(p)) == p
```
Here I get troubles with coercions (this is why I defined PP and ff): there should be some canonical coercions as there is for polynomials (this will go in another ticket)

```
sage: R.<x> = PolynomialRing(QQ,'x')
sage: K.<c> = NumberField(x^2 + 3*x + 1, 'c')
sage: P = x^6 + 3*x + 19
sage: P(c)
-141*c - 36
```

6) The rational for the choice of putting methods in projective_point.py instead in projective_morphism.py is not at all clear to me. Why orbit, canonical_heights, etc methods of points and not of morphisms ?

7) docbuild troubles
[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_periodic_points:4: WARNING: Inline literal start-string without end-string.
[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_periodic_points:72: WARNING: Inline strong start-string without end-string.
[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism:7: WARNING: Bullet list ends without a blank line; unexpected unindent.
[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space_field.rational_preperiodic_points:4: WARNING: Inline literal start-string without end-string.
[schemes  ] /opt/sage/local/lib/python2.7/site-packages/sage/schemes/projective/projective_morphism.py:docstring of sage.schemes.projective.projective_morphism:12: WARNING: Bullet list ends without a blank line; unexpected unindent.

8) I have serious trouble concerning the green function and canonical heights of points (I know that this was implemented in another ticket). In those two methods, there is no care about the fact that there are errors introduced by the fact that the floating points you are working with are with fixed precision. In particular, with floating points, the result of `x+y` is *not* the sum `x` + `y` but only an approximation of it. I really think that it should be reimplemented either using real interval fields (it will make it slower but at least you get a proven answer).



---

archive/issue_comments_172171.json:
```json
{
    "body": "<a id='comment:18'></a>\nfixed: 1,2,3,4,7\n\n5 - is two separate issues for other tickets\n\n6 - since the methods depends on both points I didn't think it mattered. I can see a preference for the code in morphism. If this is a strong preference for Sage users, then open a separate ticket to move this.\n\n8 - also an issue for a separate ticket",
    "created_at": "2013-11-08T23:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172171",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:18'></a>
fixed: 1,2,3,4,7

5 - is two separate issues for other tickets

6 - since the methods depends on both points I didn't think it mattered. I can see a preference for the code in morphism. If this is a strong preference for Sage users, then open a separate ticket to move this.

8 - also an issue for a separate ticket



---

archive/issue_events_122791.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T00:55:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122791"
}
```



---

archive/issue_events_122792.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-11-10T00:55:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122792"
}
```



---

archive/issue_events_122793.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/atowsley",
    "created_at": "2013-11-10T16:41:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122793"
}
```



---

archive/issue_events_122794.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/atowsley",
    "created_at": "2013-11-10T16:41:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122794"
}
```



---

archive/issue_comments_172172.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe multiplier (and multipliermod) functions should have a check that the point P does have period n.",
    "created_at": "2013-11-10T16:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172172",
    "user": "https://trac.sagemath.org/admin/accounts/users/atowsley"
}
```

<a id='comment:20'></a>
The multiplier (and multipliermod) functions should have a check that the point P does have period n.



---

archive/issue_comments_172173.json:
```json
{
    "body": "<a id='comment:21'></a>\nHere are a few more comments:\n\n1) Please remove debugging code from lines 1865-1968.\n\n2) It would be helpful to have some more comments to the code for the Henzel lifting to make it easier to read.\n\n3) Use is_endomorphism() where possible. Lines 2044, 2138, and 2199.\n\n4) I think it would be clearer if the rational_preimages and all_rational_preimages were written in that order. That is the reverse of how they appear now.\n\n5) Line 2145 the set 'preperiodic' as the name is misleading. Maybe 'all_preimages' would be better?\n\n6) More comments on the Groebner basis code would be nice.\n\n7) You should consider caching the functions rational_preperiodic_points and rational_periodic_points.",
    "created_at": "2013-11-10T17:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172173",
    "user": "https://trac.sagemath.org/admin/accounts/users/atowsley"
}
```

<a id='comment:21'></a>
Here are a few more comments:

1) Please remove debugging code from lines 1865-1968.

2) It would be helpful to have some more comments to the code for the Henzel lifting to make it easier to read.

3) Use is_endomorphism() where possible. Lines 2044, 2138, and 2199.

4) I think it would be clearer if the rational_preimages and all_rational_preimages were written in that order. That is the reverse of how they appear now.

5) Line 2145 the set 'preperiodic' as the name is misleading. Maybe 'all_preimages' would be better?

6) More comments on the Groebner basis code would be nice.

7) You should consider caching the functions rational_preperiodic_points and rational_periodic_points.



---

archive/issue_comments_172174.json:
```json
{
    "body": "<a id='comment:22'></a>\nMultiplier check added for the (2)-previous comment. I added a parameter to specify whether to do this or not as this function is called many times for `rational_periodic` and it would be better not to check if you known the input is good.\n\n1,2,3,4,5,6 all done\n\n7) Not possible since the points are rational projective points and they are not hashable (only hashable over finite fields)\n\nI also changed the mrange to xmrange in `lift_to_rational` to help improve the higher dimension performance.",
    "created_at": "2013-11-10T18:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172174",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:22'></a>
Multiplier check added for the (2)-previous comment. I added a parameter to specify whether to do this or not as this function is called many times for `rational_periodic` and it would be better not to check if you known the input is good.

1,2,3,4,5,6 all done

7) Not possible since the points are rational projective points and they are not hashable (only hashable over finite fields)

I also changed the mrange to xmrange in `lift_to_rational` to help improve the higher dimension performance.



---

archive/issue_comments_172175.json:
```json
{
    "body": "changes made",
    "created_at": "2013-11-10T18:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172175",
    "user": "https://github.com/bhutz"
}
```

changes made



---

archive/issue_comments_172176.json:
```json
{
    "body": "**Changing reviewer** from \"Vincent Delecroix\" to \"Vincent Delecroix, Adam Towsley\".",
    "created_at": "2013-11-12T15:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172176",
    "user": "https://trac.sagemath.org/admin/accounts/users/atowsley"
}
```

**Changing reviewer** from "Vincent Delecroix" to "Vincent Delecroix, Adam Towsley".



---

archive/attachments_019189.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14219_rational_preperiodic.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14219/trac_14219_rational_preperiodic.patch",
    "created_at": "2013-11-12T15:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/atowsley"
}
```



---

archive/issue_comments_172177.json:
```json
{
    "body": "<a id='comment:23'></a>\nAll tests passed. Everything looks good.",
    "created_at": "2013-11-12T15:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172177",
    "user": "https://trac.sagemath.org/admin/accounts/users/atowsley"
}
```

<a id='comment:23'></a>
All tests passed. Everything looks good.



---

archive/issue_events_122795.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/atowsley",
    "created_at": "2013-11-12T15:34:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122795"
}
```



---

archive/issue_events_122796.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/atowsley",
    "created_at": "2013-11-12T15:34:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122796"
}
```



---

archive/issue_comments_172178.json:
```json
{
    "body": "**Merged:** sage-5.13.beta4",
    "created_at": "2013-11-22T15:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172178",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.13.beta4



---

archive/issue_events_122797.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-22T15:49:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122797"
}
```



---

archive/issue_events_122798.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-11-22T15:49:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14219#event-122798"
}
```



---

archive/issue_comments_172179.json:
```json
{
    "body": "**Changing author** from \"Ben Hutz\" to \"Benjamin Hutz\".",
    "created_at": "2013-12-15T08:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172179",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Ben Hutz" to "Benjamin Hutz".



---

archive/issue_comments_172180.json:
```json
{
    "body": "**Changing author** from \"Benjamin Hutz\" to \"Ben Hutz\".",
    "created_at": "2016-04-15T20:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14219#issuecomment-172180",
    "user": "https://github.com/fchapoton"
}
```

**Changing author** from "Benjamin Hutz" to "Ben Hutz".
