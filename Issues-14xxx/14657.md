# Issue 14657: Document that set_embedding fails for multigraphs

archive/issues_014453.json:
```json
{
    "body": "If you try to set the embedding for a multigraph, you will get an error if you specify all edges. If you bundle each multi-edge into a single edge it works. The following code, e.g., gives an error:\n\n```\nh = Graph({1:[2], 2:[3,3], 3:[]})\nh.set_embedding({1:[2], 2:[1,3,3], 3:[2,2]})\n```\n\nThe cause of this is the following lines in the method `check_embedding_validity`:\n\n```\nif len(embedding[v]) != len(self.neighbors(v)):\n    return False\n```\n\nA multigraph returns each neighbour only once, and not the number of times that there are edges between these two vertices.\n\nIs this the desired behaviour? If so, then maybe some documentation needs to be added to warn the user that this will not work. If not, how do we change it? Should the method `neighbors` return the 'multiset' of neighbours and not just the 'set'?\n\nAssignee: jason, ncohen, rlm\n\nCC:  @tscrim\n\nBranch/Commit: 00de6e6d69b40c7e0c9ad207628854292b237bdb\n\nReviewer: Travis Scrimshaw\n\nAuthor: David Coudert\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14657\n\n",
    "closed_at": "2021-10-19T20:31:22Z",
    "created_at": "2013-05-29T05:38:39Z",
    "labels": [
        "component: graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Document that set_embedding fails for multigraphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14657",
    "user": "https://github.com/nvcleemp"
}
```
If you try to set the embedding for a multigraph, you will get an error if you specify all edges. If you bundle each multi-edge into a single edge it works. The following code, e.g., gives an error:

```
h = Graph({1:[2], 2:[3,3], 3:[]})
h.set_embedding({1:[2], 2:[1,3,3], 3:[2,2]})
```

The cause of this is the following lines in the method `check_embedding_validity`:

```
if len(embedding[v]) != len(self.neighbors(v)):
    return False
```

A multigraph returns each neighbour only once, and not the number of times that there are edges between these two vertices.

Is this the desired behaviour? If so, then maybe some documentation needs to be added to warn the user that this will not work. If not, how do we change it? Should the method `neighbors` return the 'multiset' of neighbours and not just the 'set'?

Assignee: jason, ncohen, rlm

CC:  @tscrim

Branch/Commit: 00de6e6d69b40c7e0c9ad207628854292b237bdb

Reviewer: Travis Scrimshaw

Author: David Coudert

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14657





---

archive/issue_comments_233739.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2013-05-30T07:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233739",
    "user": "https://github.com/nvcleemp"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_233740.json:
```json
{
    "body": "<a id='comment:2'></a>\nHmm, probably this is not supported, because specifying an embedding like this is not unambiguous. For an edge with multiplicity more than one, you know the order around each vertex, but you don't know which edge around the first vertex corresponds to which edge around the second vertex.",
    "created_at": "2013-06-01T14:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233740",
    "user": "https://github.com/nvcleemp"
}
```

<a id='comment:2'></a>
Hmm, probably this is not supported, because specifying an embedding like this is not unambiguous. For an edge with multiplicity more than one, you know the order around each vertex, but you don't know which edge around the first vertex corresponds to which edge around the second vertex.



---

archive/issue_comments_233741.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere is of course a way to get unambiguous embeddings for multigraphs (with loops). Number all edges and instead of listing the neighbours around each vertex, you list all the edges around each vertex.\n\nIs this something that should be added to Sage? Possibly in parallel with the current system of listing all neighbours around each vertex?",
    "created_at": "2013-06-02T08:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233741",
    "user": "https://github.com/nvcleemp"
}
```

<a id='comment:3'></a>
There is of course a way to get unambiguous embeddings for multigraphs (with loops). Number all edges and instead of listing the neighbours around each vertex, you list all the edges around each vertex.

Is this something that should be added to Sage? Possibly in parallel with the current system of listing all neighbours around each vertex?



---

archive/issue_events_048194.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48194"
}
```



---

archive/issue_events_048195.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48195"
}
```



---

archive/issue_events_048196.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48196"
}
```



---

archive/issue_events_048197.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48197"
}
```



---

archive/issue_events_048198.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48198"
}
```



---

archive/issue_events_048199.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48199"
}
```



---

archive/issue_events_048200.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48200"
}
```



---

archive/issue_comments_233742.json:
```json
{
    "body": "Changing branch from \"\" to \"public/graphs/14657_set_embedding\"",
    "created_at": "2021-10-01T15:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233742",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "public/graphs/14657_set_embedding"



---

archive/issue_comments_233743.json:
```json
{
    "body": "Changing commit from \"\" to \"00de6e6d69b40c7e0c9ad207628854292b237bdb\"",
    "created_at": "2021-10-01T15:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233743",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "00de6e6d69b40c7e0c9ad207628854292b237bdb"



---

archive/issue_comments_233744.json:
```json
{
    "body": "<a id='comment:8'></a>\nWith this branch, we clearly say that the method does not work for graphs with loops or multiple edges.\n\n---\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[00de6e6](https://github.com/sagemath/sagetrac-mirror/commit/00de6e6d69b40c7e0c9ad207628854292b237bdb)|`trac #14657: better documentation for set_embedding`|",
    "created_at": "2021-10-01T15:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233744",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>
With this branch, we clearly say that the method does not work for graphs with loops or multiple edges.

---
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[00de6e6](https://github.com/sagemath/sagetrac-mirror/commit/00de6e6d69b40c7e0c9ad207628854292b237bdb)|`trac #14657: better documentation for set_embedding`|



---

archive/issue_events_048201.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2021-10-01T15:27:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48201"
}
```



---

archive/issue_events_048202.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2021-10-01T15:27:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48202"
}
```



---

archive/issue_comments_233745.json:
```json
{
    "body": "Changing author from \"\" to \"David Coudert\"",
    "created_at": "2021-10-01T15:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233745",
    "user": "https://github.com/dcoudert"
}
```

Changing author from "" to "David Coudert"



---

archive/issue_comments_233746.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2021-10-01T15:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233746",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_233747.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-02T00:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233747",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_233748.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis will work for now, but probably in the long-term we will want to have a multigraph embedding.",
    "created_at": "2021-10-02T00:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233748",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
This will work for now, but probably in the long-term we will want to have a multigraph embedding.



---

archive/issue_comments_233749.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2021-10-02T00:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233749",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_events_048203.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "rename": {
        "from": "set_embedding fails for multigraphs",
        "to": "Document that set_embedding fails for multigraphs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48203"
}
```



---

archive/issue_comments_233750.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-19T20:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233750",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048204.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:31:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14657#event-48204"
}
```



---

archive/issue_comments_233751.json:
```json
{
    "body": "Changing branch from \"public/graphs/14657_set_embedding\" to \"00de6e6d69b40c7e0c9ad207628854292b237bdb\"",
    "created_at": "2021-10-19T20:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14657#issuecomment-233751",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/graphs/14657_set_embedding" to "00de6e6d69b40c7e0c9ad207628854292b237bdb"
