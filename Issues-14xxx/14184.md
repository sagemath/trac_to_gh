# Issue 14184: Fix # optional tags

archive/issues_013980.json:
```json
{
    "body": "Execute\n\n```\nwhile read file; do\n\nif [ -h $file ]; then\n    continue\nfi\n\nsed -i -f /dev/stdin $file <<'EOF'\n\n/sage: .*#/ {\ns/\\(#.*\\) needs optional/\\1 optional -/i;\ns/\\(#.*\\) requires optional/\\1 optional -/i;\ns/\\(#\\) requires[-:, ]*\\([A-Za-z0-9_]*\\)[-:, ]*optional/\\1 optional - \\2/i;\ns/\\(#.*\\) and optional/\\1; optional/i;\ns/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\ns/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\ns/\\(#.*[^; ]\\)[; ]  *optional/\\1; optional/i;\n\ns/\\([#;,]\\) *optional and /\\1 optional; /i;\n\ns/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\ns/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\ns/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\ns/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\ns/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\ns/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\ns/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\ns/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\ns/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\ns/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\ns/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\ns/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n\ns/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\ns/\\([#;,]\\) *optional[-: ]* database_hohel/\\1 optional - database_kohel/i;\ns/\\([#;,]\\) *optional[-: ]* Octave/\\1 optional - octave/;\ns/\\([#;,]\\) *optional[-: ]* Axiom/\\1 optional - axiom/;\n\ns/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n\nT;\n\ns/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\ns/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n}\n\nEOF\ndone < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n\n# Fix specific files\nsed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py\n```\n\n**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch] and [attachment:14184_manual2.patch]\n\nAssignee: mvngu\n\nCC:  jpflori @dimpase\n\nReviewer: Karl-Dieter Crisman\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.8.beta3\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14184\n\n",
    "closed_at": "2013-03-04T07:38:41Z",
    "created_at": "2013-02-26T09:12:17Z",
    "labels": [
        "component: doctest coverage",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "Fix # optional tags",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14184",
    "user": "https://github.com/jdemeyer"
}
```
Execute

```
while read file; do

if [ -h $file ]; then
    continue
fi

sed -i -f /dev/stdin $file <<'EOF'

/sage: .*#/ {
s/\(#.*\) needs optional/\1 optional -/i;
s/\(#.*\) requires optional/\1 optional -/i;
s/\(#\) requires[-:, ]*\([A-Za-z0-9_]*\)[-:, ]*optional/\1 optional - \2/i;
s/\(#.*\) and optional/\1; optional/i;
s/\(#.*\) \(random\) optional/\1 \2; optional/i;
s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
s/\(#.*[^; ]\)[; ]  *optional/\1; optional/i;

s/\([#;,]\) *optional and /\1 optional; /i;

s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;

s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
s/\([#;,]\) *optional[-: ]* database_hohel/\1 optional - database_kohel/i;
s/\([#;,]\) *optional[-: ]* Octave/\1 optional - octave/;
s/\([#;,]\) *optional[-: ]* Axiom/\1 optional - axiom/;

s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;

T;

s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
}

EOF
done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')

# Fix specific files
sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py
```

**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch] and [attachment:14184_manual2.patch]

Assignee: mvngu

CC:  jpflori @dimpase

Reviewer: Karl-Dieter Crisman

Author: Jeroen Demeyer

Merged: sage-5.8.beta3

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14184





---

archive/issue_comments_185924.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,32 @@\n+Execute\n \n+```\n+for file in `find devel/sage/sage -name '*.py*'`; do\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+s/# *requires optional/# optional:/i;\n+s/# *optional and /# optional; /i;\n+\n+s/# *optional[-: ]* needs /# optional: /i;\n+s/# *optional[-: ]* requires /# optional: /i;\n+s/# *optional[-: ]* the /# optional: /i;\n+s/# *optional[-: ]* package/# optional:/i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) command/# optional: \\1/i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) and /# optional: \\1 /i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) \\(not tested\\)/# optional: \\1; \\2/i;\n+\n+s/# *optional[-: ]* internet connection/# optional: internet/i;\n+s/# *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/# optional: gap_packages (\\1 package)/i;\n+s/# *optional[-: ]* GAP optional databases*/# optional: database_gap/i;\n+\n+s/# *optional[-: ]* '\\(.*\\)'/# optional: \\1/i;\n+\n+s/\\(# *optional\\)[-: ]*$/\\1/i;\n+s/# *optional[-: ]* \\(.*\\)# *$/# optional: \\1/i;\n+\n+EOF\n+done\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T10:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185924",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,32 @@
+Execute
 
+```
+for file in `find devel/sage/sage -name '*.py*'`; do
+sed -i -f /dev/stdin $file <<'EOF'
+
+s/# *requires optional/# optional:/i;
+s/# *optional and /# optional; /i;
+
+s/# *optional[-: ]* needs /# optional: /i;
+s/# *optional[-: ]* requires /# optional: /i;
+s/# *optional[-: ]* the /# optional: /i;
+s/# *optional[-: ]* package/# optional:/i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) command/# optional: \1/i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) and /# optional: \1 /i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) \(not tested\)/# optional: \1; \2/i;
+
+s/# *optional[-: ]* internet connection/# optional: internet/i;
+s/# *optional[-: ]* GAP package \([A-Za-z0-9']*\)/# optional: gap_packages (\1 package)/i;
+s/# *optional[-: ]* GAP optional databases*/# optional: database_gap/i;
+
+s/# *optional[-: ]* '\(.*\)'/# optional: \1/i;
+
+s/\(# *optional\)[-: ]*$/\1/i;
+s/# *optional[-: ]* \(.*\)# *$/# optional: \1/i;
+
+EOF
+done
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185925.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,32 @@\n+Execute\n \n+```\n+for file in `find devel/sage/sage -name '*.py*'`; do\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+s/# *requires optional/# optional:/i;\n+s/# *optional and /# optional; /i;\n+\n+s/# *optional[-: ]* needs /# optional: /i;\n+s/# *optional[-: ]* requires /# optional: /i;\n+s/# *optional[-: ]* the /# optional: /i;\n+s/# *optional[-: ]* package/# optional:/i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) command/# optional: \\1/i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) and /# optional: \\1 /i;\n+s/# *optional[-: ]* \\([A-Za-z0-9]*\\) \\(not tested\\)/# optional: \\1; \\2/i;\n+\n+s/# *optional[-: ]* internet connection/# optional: internet/i;\n+s/# *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/# optional: gap_packages (\\1 package)/i;\n+s/# *optional[-: ]* GAP optional databases*/# optional: database_gap/i;\n+\n+s/# *optional[-: ]* \\(.*\\)'\\(.*\\)'/# optional: \\1\\2/i;\n+\n+s/\\(# *optional\\)[-: ]*$/\\1/i;\n+s/# *optional[-: ]* \\(.*\\)# *$/# optional: \\1/i;\n+\n+EOF\n+done\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T10:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185925",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,32 @@
+Execute
 
+```
+for file in `find devel/sage/sage -name '*.py*'`; do
+sed -i -f /dev/stdin $file <<'EOF'
+
+s/# *requires optional/# optional:/i;
+s/# *optional and /# optional; /i;
+
+s/# *optional[-: ]* needs /# optional: /i;
+s/# *optional[-: ]* requires /# optional: /i;
+s/# *optional[-: ]* the /# optional: /i;
+s/# *optional[-: ]* package/# optional:/i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) command/# optional: \1/i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) and /# optional: \1 /i;
+s/# *optional[-: ]* \([A-Za-z0-9]*\) \(not tested\)/# optional: \1; \2/i;
+
+s/# *optional[-: ]* internet connection/# optional: internet/i;
+s/# *optional[-: ]* GAP package \([A-Za-z0-9']*\)/# optional: gap_packages (\1 package)/i;
+s/# *optional[-: ]* GAP optional databases*/# optional: database_gap/i;
+
+s/# *optional[-: ]* \(.*\)'\(.*\)'/# optional: \1\2/i;
+
+s/\(# *optional\)[-: ]*$/\1/i;
+s/# *optional[-: ]* \(.*\)# *$/# optional: \1/i;
+
+EOF
+done
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185926.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,41 @@\n+Execute\n \n+```\n+for file in `find devel/sage/sage -name '*.py*'`; do\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP optional database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+s/\\([#;,]\\) *\\(optional - .*[^# ]\\)[# ] *$/\\1 \\2/i;\n+s/\\([#;,]\\) *optional[-: ][-: ]*$/\\1 optional/i;\n+}\n+\n+EOF\n+done\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T12:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185926",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,41 @@
+Execute
 
+```
+for file in `find devel/sage/sage -name '*.py*'`; do
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP optional database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) \(not tested\)/\1 optional - \2; \3/i;
+
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+s/\([#;,]\) *\(optional - .*[^# ]\)[# ] *$/\1 \2/i;
+s/\([#;,]\) *optional[-: ][-: ]*$/\1 optional/i;
+}
+
+EOF
+done
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,43 @@\n+Execute\n \n+```\n+for file in `find devel/sage/sage -name '*.py*'`; do\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP optional database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T12:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185927",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,43 @@
+Execute
 
+```
+for file in `find devel/sage/sage -name '*.py*'`; do
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP optional database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9]*\) \(not tested\)/\1 optional - \2; \3/i;
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185928.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,43 @@\n+Execute\n \n+```\n+while read file; do\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T13:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185928",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,43 @@
+Execute
 
+```
+while read file; do
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185929.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,48 @@\n+Execute\n \n+```\n+while read file; do\n+\n+if [ -h $file ]; then\n+    continue\n+fi\n+\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T14:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185929",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,48 @@
+Execute
 
+```
+while read file; do
+
+if [ -h $file ]; then
+    continue
+fi
+
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185930.json:
```json
{
    "body": "<a id='comment:7'></a>Isn't this exactly the kind of huge intrusive patch we've been trying to avoid?  ;-)  That said, it would be really nice to have standardization for people to look at, so I'm not opposed to this.\n\nStuff to fix and/or think about doing as long as this ticket is opened.\n\n* The sage/coding/guava.py should have the same message as the ones in sage/coding/code_bounds.py and sage/coding/linear_code.py \n* `# long time; optional - internet ` and in another place, reversed - I assume that won't matter, but just asking in case\n* `# optional - database_hohel` - I don't know of a Hohel in Sage development, but I bet [the database_kohel spkg](http://sagemath.org/packages/optional/database_kohel-20060803.spkg) is what is meant :-)\n* Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)\n* I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...\n* sometimes `octave`, sometimes `Octave` - does capitalization matter?  Same with `Axiom`.\n* `somewhat random` - is that an official designation?\n* `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.\n* What is the `time` command?  The one that we always have?  I'm confused here.\n\n```\nsage: q = qsieve(n, block=False, time=True)           # optional - time \n```\n* The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.\n* `# optional - FES, random` - does it matter if random is before or after?  I would think this is going to look for the `random` spkg.  Same with `# optional; randomly growing. `\n\nOtherwise looks good - I did look at all of them by hand, not the script.  Though obviously I am not going to try to test all of these optional tests by hand.",
    "created_at": "2013-02-26T16:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185930",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>Isn't this exactly the kind of huge intrusive patch we've been trying to avoid?  ;-)  That said, it would be really nice to have standardization for people to look at, so I'm not opposed to this.

Stuff to fix and/or think about doing as long as this ticket is opened.

* The sage/coding/guava.py should have the same message as the ones in sage/coding/code_bounds.py and sage/coding/linear_code.py 
* `# long time; optional - internet ` and in another place, reversed - I assume that won't matter, but just asking in case
* `# optional - database_hohel` - I don't know of a Hohel in Sage development, but I bet [the database_kohel spkg](http://sagemath.org/packages/optional/database_kohel-20060803.spkg) is what is meant :-)
* Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)
* I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...
* sometimes `octave`, sometimes `Octave` - does capitalization matter?  Same with `Axiom`.
* `somewhat random` - is that an official designation?
* `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.
* What is the `time` command?  The one that we always have?  I'm confused here.

```
sage: q = qsieve(n, block=False, time=True)           # optional - time 
```
* The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.
* `# optional - FES, random` - does it matter if random is before or after?  I would think this is going to look for the `random` spkg.  Same with `# optional; randomly growing. `

Otherwise looks good - I did look at all of them by hand, not the script.  Though obviously I am not going to try to test all of these optional tests by hand.



---

archive/issue_comments_185931.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 kcrisman]:\n> Isn't this exactly the kind of huge intrusive patch we've been trying to avoid?  ;-)\n\nNot really. Huge intrusive patches are okay as long as they serve a purpose. Removing whitespace all over the place doesn't serve a purpose, this patch certainly does.\n\nThis patch is mainly motivated by #12415, which has different (more strict) parsing for `# optional`, leading to less false positives (but also less true positives, hence this patch).\n\n>  * The sage/coding/guava.py should have the same message as the ones in sage/coding/code_bounds.py and sage/coding/linear_code.py\n \nOK, I'll have a look.\n\n>  * `# long time; optional - internet ` and in another place, reversed - I assume that won't matter, but just asking in case\n \nDoesn't matter.\n\n>  * `# optional - database_hohel` - I don't know of a Hohel in Sage development, but I bet [the database_kohel spkg](http://sagemath.org/packages/optional/database_kohel-20060803.spkg) is what is meant :-)\n \nOK, so that's a typo.\n\n>  * Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)\n \nI have no idea.\n\n>  * I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...\n \nI have no idea what these packages are.\n\n>  * sometimes `octave`, sometimes `Octave` - does capitalization matter?  Same with `Axiom`.\n \nOK, changing to all lowercase.\n\n>  * `somewhat random` - is that an official designation?\n \nThe doctester looks for \"random\", so it will be recognized. I think it's fine.\n\n>  * `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.\n \nThis can be seen as \"just a comment\" without further meaning.\n\n>  * What is the `time` command?  The one that we always have?  I'm confused here.\n \nI have no idea.\n\n>  * The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.\n \nTrue, it's odd. I think it means that you need to run `sympow` first to create some tables, but I don't know more.\n\n>  * `# optional - FES, random` - does it matter if random is before or after?  I would think this is going to look for the `random` spkg.  Same with `# optional; randomly growing. `\n \nAt least with the *new* doctester (which is what we're aiming for), `optional - FES, random` will only require `FES`.\n\n> Though obviously I am not going to try to test all of these optional tests by hand.\n\nThat is also most certainly not the point of this ticket.",
    "created_at": "2013-02-26T20:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185931",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:7 kcrisman]:
> Isn't this exactly the kind of huge intrusive patch we've been trying to avoid?  ;-)

Not really. Huge intrusive patches are okay as long as they serve a purpose. Removing whitespace all over the place doesn't serve a purpose, this patch certainly does.

This patch is mainly motivated by #12415, which has different (more strict) parsing for `# optional`, leading to less false positives (but also less true positives, hence this patch).

>  * The sage/coding/guava.py should have the same message as the ones in sage/coding/code_bounds.py and sage/coding/linear_code.py
 
OK, I'll have a look.

>  * `# long time; optional - internet ` and in another place, reversed - I assume that won't matter, but just asking in case
 
Doesn't matter.

>  * `# optional - database_hohel` - I don't know of a Hohel in Sage development, but I bet [the database_kohel spkg](http://sagemath.org/packages/optional/database_kohel-20060803.spkg) is what is meant :-)
 
OK, so that's a typo.

>  * Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)
 
I have no idea.

>  * I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...
 
I have no idea what these packages are.

>  * sometimes `octave`, sometimes `Octave` - does capitalization matter?  Same with `Axiom`.
 
OK, changing to all lowercase.

>  * `somewhat random` - is that an official designation?
 
The doctester looks for "random", so it will be recognized. I think it's fine.

>  * `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.
 
This can be seen as "just a comment" without further meaning.

>  * What is the `time` command?  The one that we always have?  I'm confused here.
 
I have no idea.

>  * The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.
 
True, it's odd. I think it means that you need to run `sympow` first to create some tables, but I don't know more.

>  * `# optional - FES, random` - does it matter if random is before or after?  I would think this is going to look for the `random` spkg.  Same with `# optional; randomly growing. `
 
At least with the *new* doctester (which is what we're aiming for), `optional - FES, random` will only require `FES`.

> Though obviously I am not going to try to test all of these optional tests by hand.

That is also most certainly not the point of this ticket.



---

archive/issue_comments_185932.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,57 @@\n+Execute\n \n+```\n+while read file; do\n+\n+if [ -h $file ]; then\n+    continue\n+fi\n+\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#\\) requires[-:, ]*\\([A-Za-z0-9_]*\\)[-:, ]*optional/\\1 optional - \\2/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*[^; ]\\)[; ]  *optional/\\1; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+s/\\([#;,]\\) *optional[-: ]* database_hohel/\\1 optional - database_kohel/i;\n+s/\\([#;,]\\) *optional[-: ]* Octave/\\1 optional - octave/;\n+s/\\([#;,]\\) *optional[-: ]* Axiom/\\1 optional - axiom/;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n+\n+# Fix specific files\n+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py\n+```\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-26T21:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185932",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,57 @@
+Execute
 
+```
+while read file; do
+
+if [ -h $file ]; then
+    continue
+fi
+
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#\) requires[-:, ]*\([A-Za-z0-9_]*\)[-:, ]*optional/\1 optional - \2/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+s/\(#.*[^; ]\)[; ]  *optional/\1; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;
+
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+s/\([#;,]\) *optional[-: ]* database_hohel/\1 optional - database_kohel/i;
+s/\([#;,]\) *optional[-: ]* Octave/\1 optional - octave/;
+s/\([#;,]\) *optional[-: ]* Axiom/\1 optional - axiom/;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')
+
+# Fix specific files
+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py
+```
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185933.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-26T21:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185933",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_185934.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-27T03:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185934",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_185935.json:
```json
{
    "body": "<a id='comment:11'></a>> This patch is mainly motivated by #12415, which has different (more strict) parsing for `# optional`, leading to less false positives (but also less true positives, hence this patch).\n\nI figured :)\n> >  * Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)\n \n> I have no idea.\nI was right - we did change it to the program needed.  `search_src('ImageMagick')` gets me a lot of hits, particularly in plot/animate.py\n\n```\nplot/animate.py:430:            sage: a.show()       # optional -- ImageMagick\nplot/animate.py:435:            sage: a.show(iterations=3)    # optional -- ImageMagick\nplot/animate.py:439:            sage: a.show(delay=50)        # optional -- ImageMagick\n```\nI think this needs to be uniformized.  See #11170, where this was done, except apparently to the guys here (see also #10655 and #7981 for background).  By the way, is the `--` versus `-` important?\n> >  * I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...\n \n> I have no idea what these packages are.\nIt's ok, I think this is okay after looking at the various package lists.\n> >  * `somewhat random` - is that an official designation?\n \n> The doctester looks for \"random\", so it will be recognized. I think it's fine.\nOk\n> >  * `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.\n \n> This can be seen as \"just a comment\" without further meaning.\nJust wanted to make sure that additional comments were okay in doctest lines.\n> >  * What is the `time` command?  The one that we always have?  I'm confused here.\n \n> I have no idea.\nGot it - see the line above them (which your script didn't catch)?\n\n```\nsage: v, t = qsieve(n, time=True)   # uses the sieve    (optional: time doesn't work on cygwin) \n```\nThis line should be changed to \"look nice\", and now we know why this was marked optional.  It hardly seems fair to make something optional that only doesn't work on a not-yet-supported platform... maybe we should remove these as optional?  I'll leave that to you.\n> >  * The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.\n \n> True, it's odd. I think it means that you need to run `sympow` first to create some tables, but I don't know more.\nI believe you are right.  But the doctest makes no sense as an automatic doctest in that case.  See [the relevant note](http://hg.sagemath.org/sage-main/file/5714ed3eab6a/sage/lfunctions/sympow.py#l116).  In fact, I get the bizarre (newlines not rendered)\n\n```\nsage: a = sympow.L(EllipticCurve('11a'), 2, 16); a \n\"Inertia Group is  C1 MULTIPLICATIVE REDUCTION\\nConductor is 11\\n**ERROR** P02L not found in param_data file\\nIt can be added with './sympow -new_data 2'\"\n```\nSo I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add \n\n```\nsage: sympow('-new_data 2') # not tested\n```\nto the doctest and make them all not tested, since by definition someone would have to do something \"by hand\" to make them testable.  Or do you have another creative solution?  I can think of a couple, but they are annoying and probably pointless.   \n\nThere should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?",
    "created_at": "2013-02-27T03:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185935",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>> This patch is mainly motivated by #12415, which has different (more strict) parsing for `# optional`, leading to less false positives (but also less true positives, hence this patch).

I figured :)
> >  * Did we change the `convert` ones to `ImageMagick`, or vice versa?  Anyway, that should be standardized if it wasn't already elsewhere (this feels familiar)
 
> I have no idea.
I was right - we did change it to the program needed.  `search_src('ImageMagick')` gets me a lot of hits, particularly in plot/animate.py

```
plot/animate.py:430:            sage: a.show()       # optional -- ImageMagick
plot/animate.py:435:            sage: a.show(iterations=3)    # optional -- ImageMagick
plot/animate.py:439:            sage: a.show(delay=50)        # optional -- ImageMagick
```
I think this needs to be uniformized.  See #11170, where this was done, except apparently to the guys here (see also #10655 and #7981 for background).  By the way, is the `--` versus `-` important?
> >  * I'm not sure why something can depend on dot2tex but not graphviz, and even more weirdly, graphviz is experimental, but not dot2tex ?!?!?  Though I guess it is okay...
 
> I have no idea what these packages are.
It's ok, I think this is okay after looking at the various package lists.
> >  * `somewhat random` - is that an official designation?
 
> The doctester looks for "random", so it will be recognized. I think it's fine.
Ok
> >  * `< 1/100th of a second ` - well, I guess it might be!  I guess we can leave that.
 
> This can be seen as "just a comment" without further meaning.
Just wanted to make sure that additional comments were okay in doctest lines.
> >  * What is the `time` command?  The one that we always have?  I'm confused here.
 
> I have no idea.
Got it - see the line above them (which your script didn't catch)?

```
sage: v, t = qsieve(n, time=True)   # uses the sieve    (optional: time doesn't work on cygwin) 
```
This line should be changed to "look nice", and now we know why this was marked optional.  It hardly seems fair to make something optional that only doesn't work on a not-yet-supported platform... maybe we should remove these as optional?  I'll leave that to you.
> >  * The `sage/lfunctions/sympow.py` test seems ... odd.  Should it instead be long test?  Note that the previous command just says optional, with no indication of why.
 
> True, it's odd. I think it means that you need to run `sympow` first to create some tables, but I don't know more.
I believe you are right.  But the doctest makes no sense as an automatic doctest in that case.  See [the relevant note](http://hg.sagemath.org/sage-main/file/5714ed3eab6a/sage/lfunctions/sympow.py#l116).  In fact, I get the bizarre (newlines not rendered)

```
sage: a = sympow.L(EllipticCurve('11a'), 2, 16); a 
"Inertia Group is  C1 MULTIPLICATIVE REDUCTION\nConductor is 11\n**ERROR** P02L not found in param_data file\nIt can be added with './sympow -new_data 2'"
```
So I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add 

```
sage: sympow('-new_data 2') # not tested
```
to the doctest and make them all not tested, since by definition someone would have to do something "by hand" to make them testable.  Or do you have another creative solution?  I can think of a couple, but they are annoying and probably pointless.   

There should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?



---

archive/issue_comments_185936.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,59 @@\n+Execute\n \n+```\n+while read file; do\n+\n+if [ -h $file ]; then\n+    continue\n+fi\n+\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#\\) requires[-:, ]*\\([A-Za-z0-9_]*\\)[-:, ]*optional/\\1 optional - \\2/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*[^; ]\\)[; ]  *optional/\\1; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+s/\\([#;,]\\) *optional[-: ]* database_hohel/\\1 optional - database_kohel/i;\n+s/\\([#;,]\\) *optional[-: ]* Octave/\\1 optional - octave/;\n+s/\\([#;,]\\) *optional[-: ]* Axiom/\\1 optional - axiom/;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n+\n+# Fix specific files\n+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py\n+```\n+\n+**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch]\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-02-27T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185936",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,59 @@
+Execute
 
+```
+while read file; do
+
+if [ -h $file ]; then
+    continue
+fi
+
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#\) requires[-:, ]*\([A-Za-z0-9_]*\)[-:, ]*optional/\1 optional - \2/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+s/\(#.*[^; ]\)[; ]  *optional/\1; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;
+
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+s/\([#;,]\) *optional[-: ]* database_hohel/\1 optional - database_kohel/i;
+s/\([#;,]\) *optional[-: ]* Octave/\1 optional - octave/;
+s/\([#;,]\) *optional[-: ]* Axiom/\1 optional - axiom/;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')
+
+# Fix specific files
+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py
+```
+
+**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch]
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185937.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 kcrisman]:\n> I was right - we did change it to the program needed.  `search_src('ImageMagick')` gets me a lot of hits, particularly in plot/animate.py\n> \n> ```\n> plot/animate.py:430:            sage: a.show()       # optional -- ImageMagick\n> plot/animate.py:435:            sage: a.show(iterations=3)    # optional -- ImageMagick\n> plot/animate.py:439:            sage: a.show(delay=50)        # optional -- ImageMagick\n> ```\n> I think this needs to be uniformized.\n\nDone, changed all to `optional -- ImageMagick`.\n\n> By the way, is the `--` versus `-` important?\n\nNo, I used a double dash for consistency here.\n\n> {{{\n> sage: v, t = qsieve(n, time=True)   # uses the sieve    (optional: time doesn't work on cygwin) \n> }}}\n> This line should be changed to \"look nice\", and now we know why this was marked optional.\n\nFixed.\n\n> I believe you are right.  But the doctest makes no sense as an automatic doctest in that case.  See [the relevant note](http://hg.sagemath.org/sage-main/file/5714ed3eab6a/sage/lfunctions/sympow.py#l116).  In fact, I get the bizarre (newlines not rendered)\n> \n> ```\n> sage: a = sympow.L(EllipticCurve('11a'), 2, 16); a \n> \"Inertia Group is  C1 MULTIPLICATIVE REDUCTION\\nConductor is 11\\n**ERROR** P02L not found in param_data file\\nIt can be added with './sympow -new_data 2'\"\n> ```\n> So I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add \n> \n> ```\n> sage: sympow('-new_data 2') # not tested\n> ```\n> to the doctest and make them all not tested, since by definition someone would have to do something \"by hand\" to make them testable.\n\nDone.\n\n> There should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?\n\nTechnically, it's worth a ticket but I have no plans to work on it.",
    "created_at": "2013-02-27T09:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185937",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Replying to [comment:11 kcrisman]:
> I was right - we did change it to the program needed.  `search_src('ImageMagick')` gets me a lot of hits, particularly in plot/animate.py
> 
> ```
> plot/animate.py:430:            sage: a.show()       # optional -- ImageMagick
> plot/animate.py:435:            sage: a.show(iterations=3)    # optional -- ImageMagick
> plot/animate.py:439:            sage: a.show(delay=50)        # optional -- ImageMagick
> ```
> I think this needs to be uniformized.

Done, changed all to `optional -- ImageMagick`.

> By the way, is the `--` versus `-` important?

No, I used a double dash for consistency here.

> {{{
> sage: v, t = qsieve(n, time=True)   # uses the sieve    (optional: time doesn't work on cygwin) 
> }}}
> This line should be changed to "look nice", and now we know why this was marked optional.

Fixed.

> I believe you are right.  But the doctest makes no sense as an automatic doctest in that case.  See [the relevant note](http://hg.sagemath.org/sage-main/file/5714ed3eab6a/sage/lfunctions/sympow.py#l116).  In fact, I get the bizarre (newlines not rendered)
> 
> ```
> sage: a = sympow.L(EllipticCurve('11a'), 2, 16); a 
> "Inertia Group is  C1 MULTIPLICATIVE REDUCTION\nConductor is 11\n**ERROR** P02L not found in param_data file\nIt can be added with './sympow -new_data 2'"
> ```
> So I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add 
> 
> ```
> sage: sympow('-new_data 2') # not tested
> ```
> to the doctest and make them all not tested, since by definition someone would have to do something "by hand" to make them testable.

Done.

> There should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?

Technically, it's worth a ticket but I have no plans to work on it.



---

archive/issue_comments_185938.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-27T10:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185938",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185939.json:
```json
{
    "body": "<a id='comment:14'></a>Attachment [14184_optional.patch](tarball://root/attachments/some-uuid/ticket14184/14184_optional.patch) by @jdemeyer created at 2013-02-27 10:49:26",
    "created_at": "2013-02-27T10:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185939",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Attachment [14184_optional.patch](tarball://root/attachments/some-uuid/ticket14184/14184_optional.patch) by @jdemeyer created at 2013-02-27 10:49:26



---

archive/issue_comments_185940.json:
```json
{
    "body": "<a id='comment:15'></a>> > So I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add \n> > \n> > ```\n> > sage: sympow('-new_data 2') # not tested\n> > ```\n> > to the doctest and make them all not tested, since by definition someone would have to do something \"by hand\" to make them testable.\n\n> Done.\nNote that technically ```sympow -new_data 2``` isn't needed; `sage: sympow('-new_data 2') ` is just as good, and has the advantage of being able to be included in the doctests (`# not tested`, of course).  May I ask for that very slight change in the \"manual\" patch - just so people don't think they *have* to go to the shell?\n> > There should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?\n\n> Technically, it's worth a ticket but I have no plans to work on it.\nNor do I.",
    "created_at": "2013-02-27T16:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185940",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>> > So I believe that both of them should probably be made `optional - precomputations`, or perhaps even better to add 
> > 
> > ```
> > sage: sympow('-new_data 2') # not tested
> > ```
> > to the doctest and make them all not tested, since by definition someone would have to do something "by hand" to make them testable.

> Done.
Note that technically ```sympow -new_data 2``` isn't needed; `sage: sympow('-new_data 2') ` is just as good, and has the advantage of being able to be included in the doctests (`# not tested`, of course).  May I ask for that very slight change in the "manual" patch - just so people don't think they *have* to go to the shell?
> > There should also be better error catching there, but I figure anyone using sympow knows what they are doing enough to read the documentation - or is that worth a ticket as well?

> Technically, it's worth a ticket but I have no plans to work on it.
Nor do I.



---

archive/issue_comments_185941.json:
```json
{
    "body": "<a id='comment:16'></a>Judging from sage-devel, it seems that `time` does work on Cygwin now (probably it didn't in some earlier version), so I removed `optional - time`. I also clarified the SYMPOW precomputations as you suggested.",
    "created_at": "2013-02-27T19:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185941",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Judging from sage-devel, it seems that `time` does work on Cygwin now (probably it didn't in some earlier version), so I removed `optional - time`. I also clarified the SYMPOW precomputations as you suggested.



---

archive/issue_comments_185942.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 jdemeyer]:\n> Judging from sage-devel, it seems that `time` does work on Cygwin now (probably it didn't in some earlier version), so I removed `optional - time`. I also clarified the SYMPOW precomputations as you suggested.\n\nSee [this comment on Trac 9164](http://trac.sagemath.org/sage_trac/ticket/9164#comment:3).  What do you think we should do?  I'm almost wondering whether it's worth keeping your current patch and then opening a ticket acknowledging that this doesn't work on Cygwin...",
    "created_at": "2013-02-27T22:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185942",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:17'></a>Replying to [comment:16 jdemeyer]:
> Judging from sage-devel, it seems that `time` does work on Cygwin now (probably it didn't in some earlier version), so I removed `optional - time`. I also clarified the SYMPOW precomputations as you suggested.

See [this comment on Trac 9164](http://trac.sagemath.org/sage_trac/ticket/9164#comment:3).  What do you think we should do?  I'm almost wondering whether it's worth keeping your current patch and then opening a ticket acknowledging that this doesn't work on Cygwin...



---

archive/issue_comments_185943.json:
```json
{
    "body": "<a id='comment:18'></a>But otherwise positive review.",
    "created_at": "2013-02-27T22:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185943",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>But otherwise positive review.



---

archive/issue_comments_185944.json:
```json
{
    "body": "<a id='comment:19'></a>I'd say leave this ticket as is and modify the code to try using time on Cygwin and suggesting installing the time package if it fails (or not using time=True) in another ticket.",
    "created_at": "2013-02-27T22:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185944",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:19'></a>I'd say leave this ticket as is and modify the code to try using time on Cygwin and suggesting installing the time package if it fails (or not using time=True) in another ticket.



---

archive/issue_comments_185945.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 jpflori]:\n> I'd say leave this ticket as is and modify the code to try using time on Cygwin and suggesting installing the time package if it fails (or not using time=True) in another ticket.\n\nSo in other words, *not* re-enabling optional, with the realization that we'll have a purposely failing doctest on Cygwin.  I don't really have a problem with this.",
    "created_at": "2013-02-27T22:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185945",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>Replying to [comment:19 jpflori]:
> I'd say leave this ticket as is and modify the code to try using time on Cygwin and suggesting installing the time package if it fails (or not using time=True) in another ticket.

So in other words, *not* re-enabling optional, with the realization that we'll have a purposely failing doctest on Cygwin.  I don't really have a problem with this.



---

archive/issue_comments_185946.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-27T22:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185946",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185947.json:
```json
{
    "body": "<a id='comment:21'></a>Exactly, but opening a follow up ticket.\nIt's now #14202",
    "created_at": "2013-02-27T22:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185947",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:21'></a>Exactly, but opening a follow up ticket.
It's now #14202



---

archive/issue_comments_185948.json:
```json
{
    "body": "<a id='comment:22'></a>Since the \"time\" problem has nothing to do with Cygwin, I will keep the\n\n```\n# optional - time\n```\ntags.",
    "created_at": "2013-02-28T07:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185948",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>Since the "time" problem has nothing to do with Cygwin, I will keep the

```
# optional - time
```
tags.



---

archive/issue_comments_185949.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-02-28T07:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185949",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_185950.json:
```json
{
    "body": "<a id='comment:24'></a>Attachment [14184_manual.patch](tarball://root/attachments/some-uuid/ticket14184/14184_manual.patch) by @jdemeyer created at 2013-02-28 09:35:14\n\nNew version of [attachment:14184_manual.patch] needs review.",
    "created_at": "2013-02-28T09:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185950",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>Attachment [14184_manual.patch](tarball://root/attachments/some-uuid/ticket14184/14184_manual.patch) by @jdemeyer created at 2013-02-28 09:35:14

New version of [attachment:14184_manual.patch] needs review.



---

archive/issue_comments_185951.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-28T09:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185951",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185952.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-28T14:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185952",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185953.json:
```json
{
    "body": "<a id='comment:25'></a>Patchbot is confused... apply 14184_optional.patch and 14184_manual.patch",
    "created_at": "2013-02-28T14:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185953",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:25'></a>Patchbot is confused... apply 14184_optional.patch and 14184_manual.patch



---

archive/issue_comments_185954.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-02T12:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185954",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_185955.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,59 @@\n+Execute\n \n+```\n+while read file; do\n+\n+if [ -h $file ]; then\n+    continue\n+fi\n+\n+sed -i -f /dev/stdin $file <<'EOF'\n+\n+/sage: .*#/ {\n+s/\\(#.*\\) needs optional/\\1 optional -/i;\n+s/\\(#.*\\) requires optional/\\1 optional -/i;\n+s/\\(#\\) requires[-:, ]*\\([A-Za-z0-9_]*\\)[-:, ]*optional/\\1 optional - \\2/i;\n+s/\\(#.*\\) and optional/\\1; optional/i;\n+s/\\(#.*\\) \\(random\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*\\) \\(long time\\) optional/\\1 \\2; optional/i;\n+s/\\(#.*[^; ]\\)[; ]  *optional/\\1; optional/i;\n+\n+s/\\([#;,]\\) *optional and /\\1 optional; /i;\n+\n+s/\\([#;,]\\) *optional[-:, ]* needs /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-:, ]* requires /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* the /\\1 optional - /i;\n+s/\\([#;,]\\) *optional[-: ]* GAP packages/\\1 optional - gap_packages/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP package \\([A-Za-z0-9']*\\)/\\1 optional - gap_packages (\\2 package)/i;\n+s/\\([#;,]\\) *optional[-: ]* GAP \\(optional \\)*database[s]*/\\1 optional - database_gap/i;\n+s/\\([#;,]\\) *optional[-: ]* package/\\1 optional -/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) command/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) package/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) installed/\\1 optional - \\2/i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) and /\\1 optional - \\2 /i;\n+s/\\([#;,]\\) *optional[-: ]* \\([A-Za-z0-9_]*\\) \\(not tested\\)/\\1 optional - \\2; \\3/i;\n+\n+s/\\([#;,]\\) *optional[-: ]* internet connection/\\1 optional - internet/i;\n+s/\\([#;,]\\) *optional[-: ]* database_hohel/\\1 optional - database_kohel/i;\n+s/\\([#;,]\\) *optional[-: ]* Octave/\\1 optional - octave/;\n+s/\\([#;,]\\) *optional[-: ]* Axiom/\\1 optional - axiom/;\n+\n+s/\\([#;,]\\) *optional[-: ]* \\(.*\\)'\\(.*\\)'/\\1 optional - \\2\\3/i;\n+\n+T;\n+\n+s/\\([#;,] *optional - .*[^# ]\\)[# ] *$/\\1/i;\n+s/\\([#;,] *optional\\)[-: ][-: ]*$/\\1/i;\n+}\n+\n+EOF\n+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')\n+\n+# Fix specific files\n+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py\n+```\n+\n+**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch] and [attachment:14184_manual2.patch]\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2013-03-02T12:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185955",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,59 @@
+Execute
 
+```
+while read file; do
+
+if [ -h $file ]; then
+    continue
+fi
+
+sed -i -f /dev/stdin $file <<'EOF'
+
+/sage: .*#/ {
+s/\(#.*\) needs optional/\1 optional -/i;
+s/\(#.*\) requires optional/\1 optional -/i;
+s/\(#\) requires[-:, ]*\([A-Za-z0-9_]*\)[-:, ]*optional/\1 optional - \2/i;
+s/\(#.*\) and optional/\1; optional/i;
+s/\(#.*\) \(random\) optional/\1 \2; optional/i;
+s/\(#.*\) \(long time\) optional/\1 \2; optional/i;
+s/\(#.*[^; ]\)[; ]  *optional/\1; optional/i;
+
+s/\([#;,]\) *optional and /\1 optional; /i;
+
+s/\([#;,]\) *optional[-:, ]* needs /\1 optional - /i;
+s/\([#;,]\) *optional[-:, ]* requires /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* the /\1 optional - /i;
+s/\([#;,]\) *optional[-: ]* GAP packages/\1 optional - gap_packages/i;
+s/\([#;,]\) *optional[-: ]* GAP package \([A-Za-z0-9']*\)/\1 optional - gap_packages (\2 package)/i;
+s/\([#;,]\) *optional[-: ]* GAP \(optional \)*database[s]*/\1 optional - database_gap/i;
+s/\([#;,]\) *optional[-: ]* package/\1 optional -/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) command/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) package/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) installed/\1 optional - \2/i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) and /\1 optional - \2 /i;
+s/\([#;,]\) *optional[-: ]* \([A-Za-z0-9_]*\) \(not tested\)/\1 optional - \2; \3/i;
+
+s/\([#;,]\) *optional[-: ]* internet connection/\1 optional - internet/i;
+s/\([#;,]\) *optional[-: ]* database_hohel/\1 optional - database_kohel/i;
+s/\([#;,]\) *optional[-: ]* Octave/\1 optional - octave/;
+s/\([#;,]\) *optional[-: ]* Axiom/\1 optional - axiom/;
+
+s/\([#;,]\) *optional[-: ]* \(.*\)'\(.*\)'/\1 optional - \2\3/i;
+
+T;
+
+s/\([#;,] *optional - .*[^# ]\)[# ] *$/\1/i;
+s/\([#;,] *optional\)[-: ][-: ]*$/\1/i;
+}
+
+EOF
+done < <(find devel/sage/sage devel/sage/doc/[a-z][a-z] -name '*.py*' -o -name '*.rst')
+
+# Fix specific files
+sed -i 's/# optional/# optional - gap_packages (Guava package)/' devel/sage/sage/coding/guava.py
+```
+
+**Apply** [attachment:14184_optional.patch] and [attachment:14184_manual.patch] and [attachment:14184_manual2.patch]
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_185956.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-02T12:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185956",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_185957.json:
```json
{
    "body": "<a id='comment:27'></a>I found some more which I missed initially.",
    "created_at": "2013-03-02T12:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185957",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>I found some more which I missed initially.



---

archive/issue_comments_185958.json:
```json
{
    "body": "Attachment [14184_manual2.patch](tarball://root/attachments/some-uuid/ticket14184/14184_manual2.patch) by @jdemeyer created at 2013-03-02 12:54:31",
    "created_at": "2013-03-02T12:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185958",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14184_manual2.patch](tarball://root/attachments/some-uuid/ticket14184/14184_manual2.patch) by @jdemeyer created at 2013-03-02 12:54:31



---

archive/issue_comments_185959.json:
```json
{
    "body": "<a id='comment:28'></a>I'm sure there will always be more...",
    "created_at": "2013-03-02T14:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185959",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:28'></a>I'm sure there will always be more...



---

archive/issue_comments_185960.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-02T14:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185960",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_040037.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-04T07:38:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14184#event-40037"
}
```



---

archive/issue_comments_185961.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-04T07:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14184#issuecomment-185961",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
