# Issue 14006: Bug with dumps() of Hasse diagrams

archive/issues_013802.json:
```json
{
    "assignees": [],
    "body": "The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)\n\n```\nsage: P = Poset()\nsage: H = P._hasse_diagram\nsage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0 \nsage: H.rank_function()\n<built-in method __getitem__ of dict object at 0x8a3ecec>\nsage: s = dumps(H)\n---------------------------------------------------------------------------\nTypeError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Traceback (most recent call last)\n...\nTypeError: expected string or Unicode object, NoneType found\n```\n\nAssignee: **@VivianePons**\n\nCC:  sage-combinat @fchapoton\n\nKeywords: **Hasse_diagrams, poset**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Viviane Pons**\n\nMerged: **sage-5.7.beta2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14006_\n\n",
    "closed_at": "2013-01-30T07:36:19Z",
    "created_at": "2013-01-24T14:58:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Bug with dumps() of Hasse diagrams",
    "type": "issue",
    "updated_at": "2013-01-30T07:36:19Z",
    "url": "https://github.com/sagemath/sage/issues/14006",
    "user": "https://github.com/VivianePons"
}
```
The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)

```
sage: P = Poset()
sage: H = P._hasse_diagram
sage: s = dumps(H)      
sage: H.rank_function()
<built-in method __getitem__ of dict object at 0x8a3ecec>
sage: s = dumps(H)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: expected string or Unicode object, NoneType found
```

Assignee: **@VivianePons**

CC:  sage-combinat @fchapoton

Keywords: **Hasse_diagrams, poset**

Reviewer: **Frédéric Chapoton**

Author: **Viviane Pons**

Merged: **sage-5.7.beta2**

_Issue created by migration from https://trac.sagemath.org/ticket/14006_





---

archive/issue_events_180479.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T14:58:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180479"
}
```



---

archive/issue_events_180480.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T14:58:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180480"
}
```



---

archive/issue_events_180481.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T14:58:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180481"
}
```



---

archive/issue_events_180482.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T14:58:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180482"
}
```



---

archive/issue_comments_168378.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,14 @@\n The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)\n \n ```\n-\n sage: P = Poset()\n sage: H = P._hasse_diagram\n-sage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n+sage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0 \n sage: H.rank_function()\n-<built-in method !__getitem!__ of dict object at 0x8a3ecec>\n+<built-in method __getitem__ of dict object at 0x8a3ecec>\n sage: s = dumps(H)\n-Traceback (most recent call last)\n+---------------------------------------------------------------------------\n+TypeError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Traceback (most recent call last)\n ...\n-!TypeError: expected string or Unicode object, !NoneType found\n+TypeError: expected string or Unicode object, NoneType found\n ```\n``````\n",
    "created_at": "2013-01-24T15:01:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168378",
    "user": "https://github.com/VivianePons"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,14 @@
 The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)
 
 ```
-
 sage: P = Poset()
 sage: H = P._hasse_diagram
-sage: s = dumps(H)         
+sage: s = dumps(H)      
 sage: H.rank_function()
-<built-in method !__getitem!__ of dict object at 0x8a3ecec>
+<built-in method __getitem__ of dict object at 0x8a3ecec>
 sage: s = dumps(H)
-Traceback (most recent call last)
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
 ...
-!TypeError: expected string or Unicode object, !NoneType found
+TypeError: expected string or Unicode object, NoneType found
 ```
``````




---

archive/issue_comments_168379.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\napply         *[trac_14006-hasse-diagrams-dumps-bug.patch](https://github.com/sagemath/sage/files/ticket14006/trac_14006-hasse-diagrams-dumps-bug.patch.gz)*",
    "created_at": "2013-01-24T18:10:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168379",
    "user": "https://github.com/VivianePons"
}
```

<a id='comment:2'>Comment 2:</a>
apply         *[trac_14006-hasse-diagrams-dumps-bug.patch](https://github.com/sagemath/sage/files/ticket14006/trac_14006-hasse-diagrams-dumps-bug.patch.gz)*



---

archive/issue_events_180483.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T18:11:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180483"
}
```



---

archive/issue_comments_168380.json:
```json
{
    "body": "Author: **Viviane Pons**",
    "created_at": "2013-01-24T18:28:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168380",
    "user": "https://github.com/VivianePons"
}
```

Author: **Viviane Pons**



---

archive/issue_comments_168381.json:
```json
{
    "body": "Attachment: **[trac_14006-hasse-diagrams-dumps-bug.patch.gz](https://github.com/sagemath/sage/files/ticket14006/trac_14006-hasse-diagrams-dumps-bug.patch.gz)**",
    "created_at": "2013-01-25T09:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168381",
    "user": "https://github.com/VivianePons"
}
```

Attachment: **[trac_14006-hasse-diagrams-dumps-bug.patch.gz](https://github.com/sagemath/sage/files/ticket14006/trac_14006-hasse-diagrams-dumps-bug.patch.gz)**



---

archive/issue_comments_168382.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nok for me, positive review",
    "created_at": "2013-01-25T11:51:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168382",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'>Comment 5:</a>
ok for me, positive review



---

archive/issue_events_180484.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-01-25T11:51:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180484"
}
```



---

archive/issue_events_180485.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-01-25T11:51:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180485"
}
```



---

archive/issue_comments_168383.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2013-01-26T10:02:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168383",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_events_180486.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T10:02:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "title_is": "Bug with dumps() of Hasse diagrams",
    "title_was": "Bug with dumps of hasse diargams",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180486"
}
```



---

archive/issue_comments_168384.json:
```json
{
    "body": "Merged: **sage-5.7.beta2**",
    "created_at": "2013-01-30T07:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14006#issuecomment-168384",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta2**



---

archive/issue_events_180487.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:36:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180487"
}
```



---

archive/issue_events_180488.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:36:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14006",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14006#event-180488"
}
```
