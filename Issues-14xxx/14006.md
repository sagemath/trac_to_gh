# Issue 14006: Bug with dumps() of Hasse diagrams

archive/issues_013802.json:
```json
{
    "body": "The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)\n\n```\nsage: P = Poset()\nsage: H = P._hasse_diagram\nsage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0 \nsage: H.rank_function()\n<built-in method __getitem__ of dict object at 0x8a3ecec>\nsage: s = dumps(H)\n---------------------------------------------------------------------------\nTypeError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Traceback (most recent call last)\n...\nTypeError: expected string or Unicode object, NoneType found\n```\n\n**Assignee:** @VivianePons\n\n**CC:**  sage-combinat @fchapoton\n\n**Keywords:** Hasse_diagrams, poset\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Viviane Pons\n\n**Merged:** sage-5.7.beta2\n\nIssue created by migration from https://trac.sagemath.org/ticket/14006\n\n",
    "closed_at": "2013-01-30T07:36:19Z",
    "created_at": "2013-01-24T14:58:14Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Bug with dumps() of Hasse diagrams",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14006",
    "user": "https://github.com/VivianePons"
}
```
The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)

```
sage: P = Poset()
sage: H = P._hasse_diagram
sage: s = dumps(H)      
sage: H.rank_function()
<built-in method __getitem__ of dict object at 0x8a3ecec>
sage: s = dumps(H)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: expected string or Unicode object, NoneType found
```

**Assignee:** @VivianePons

**CC:**  sage-combinat @fchapoton

**Keywords:** Hasse_diagrams, poset

**Reviewer:** Frédéric Chapoton

**Author:** Viviane Pons

**Merged:** sage-5.7.beta2

Issue created by migration from https://trac.sagemath.org/ticket/14006





---

archive/issue_comments_169924.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,14 +1,14 @@\n The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)\n \n ```\n-\n sage: P = Poset()\n sage: H = P._hasse_diagram\n-sage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n+sage: s = dumps(H)\u00a0\u00a0\u00a0\u00a0\u00a0 \n sage: H.rank_function()\n-<built-in method !__getitem!__ of dict object at 0x8a3ecec>\n+<built-in method __getitem__ of dict object at 0x8a3ecec>\n sage: s = dumps(H)\n-Traceback (most recent call last)\n+---------------------------------------------------------------------------\n+TypeError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Traceback (most recent call last)\n ...\n-!TypeError: expected string or Unicode object, !NoneType found\n+TypeError: expected string or Unicode object, NoneType found\n ```\n``````\n",
    "created_at": "2013-01-24T15:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169924",
    "user": "https://github.com/VivianePons"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,14 +1,14 @@
 The call of the _rank_function of a hasse diagrams breaks the dumps method of the object because of a nasty implementation of a cached parameter. (I suppose it's an old stuff that should be changed to lazy_attribute or something similar)
 
 ```
-
 sage: P = Poset()
 sage: H = P._hasse_diagram
-sage: s = dumps(H)         
+sage: s = dumps(H)      
 sage: H.rank_function()
-<built-in method !__getitem!__ of dict object at 0x8a3ecec>
+<built-in method __getitem__ of dict object at 0x8a3ecec>
 sage: s = dumps(H)
-Traceback (most recent call last)
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
 ...
-!TypeError: expected string or Unicode object, !NoneType found
+TypeError: expected string or Unicode object, NoneType found
 ```
``````




---

archive/issue_comments_169925.json:
```json
{
    "body": "<a id='comment:2'></a>\napply         *[trac_14006-hasse-diagrams-dumps-bug.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/14006/trac_14006-hasse-diagrams-dumps-bug.patch)*",
    "created_at": "2013-01-24T18:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169925",
    "user": "https://github.com/VivianePons"
}
```

<a id='comment:2'></a>
apply         *[trac_14006-hasse-diagrams-dumps-bug.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/14006/trac_14006-hasse-diagrams-dumps-bug.patch)*



---

archive/issue_events_123051.json:
```json
{
    "actor": "https://github.com/VivianePons",
    "created_at": "2013-01-24T18:11:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123051"
}
```



---

archive/issue_comments_169926.json:
```json
{
    "body": "**Author:** Viviane Pons",
    "created_at": "2013-01-24T18:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169926",
    "user": "https://github.com/VivianePons"
}
```

**Author:** Viviane Pons



---

archive/attachments_018911.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14006-hasse-diagrams-dumps-bug.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14006/trac_14006-hasse-diagrams-dumps-bug.patch",
    "created_at": "2013-01-25T09:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/VivianePons"
}
```



---

archive/issue_comments_169927.json:
```json
{
    "body": "",
    "created_at": "2013-01-25T09:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169927",
    "user": "https://github.com/VivianePons"
}
```





---

archive/issue_comments_169928.json:
```json
{
    "body": "<a id='comment:5'></a>\nok for me, positive review",
    "created_at": "2013-01-25T11:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169928",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
ok for me, positive review



---

archive/issue_events_123052.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-01-25T11:51:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123052"
}
```



---

archive/issue_events_123053.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-01-25T11:51:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123053"
}
```



---

archive/issue_comments_169929.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2013-01-26T10:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169929",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_events_123054.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T10:02:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "rename": {
        "from": "Bug with dumps of hasse diargams",
        "to": "Bug with dumps() of Hasse diagrams"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123054"
}
```



---

archive/issue_comments_169930.json:
```json
{
    "body": "**Merged:** sage-5.7.beta2",
    "created_at": "2013-01-30T07:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14006#issuecomment-169930",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.7.beta2



---

archive/issue_events_123055.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:36:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123055"
}
```



---

archive/issue_events_123056.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:36:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14006",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14006#event-123056"
}
```
