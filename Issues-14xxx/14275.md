# Issue 14275: Lazy imports with deprecation

archive/issues_014071.json:
```json
{
    "body": "It's annoying when other people move something around in the Sage library and it's no longer available in the previous location to be imported.  Sage currently has some mechanisms for alleviating this problem (`sage.misc.superceded.deprecated_callable_import` and `sage.structure.sage_object.register_unpickle_override` for example).  This ticket adds another option: lazily import the old name so that a deprecation warning is issued whenever it is referred to.\n\n**Assignee:** @jasongrout\n\n**Branch/Commit:** [a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)\n\n**Reviewer:** Travis Scrimshaw, Nathann Cohen\n\n**Author:** David Roe, Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/14275\n\n",
    "closed_at": "2014-04-04T15:55:31Z",
    "created_at": "2013-03-14T21:30:00Z",
    "labels": [
        "component: misc",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.2",
    "title": "Lazy imports with deprecation",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/14275",
    "user": "https://github.com/roed314"
}
```
It's annoying when other people move something around in the Sage library and it's no longer available in the previous location to be imported.  Sage currently has some mechanisms for alleviating this problem (`sage.misc.superceded.deprecated_callable_import` and `sage.structure.sage_object.register_unpickle_override` for example).  This ticket adds another option: lazily import the old name so that a deprecation warning is issued whenever it is referred to.

**Assignee:** @jasongrout

**Branch/Commit:** [a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)

**Reviewer:** Travis Scrimshaw, Nathann Cohen

**Author:** David Roe, Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/14275





---

archive/attachments_019282.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "14275.patch",
    "asset_url": "tarball://root/attachments/ticket14275/14275.patch",
    "created_at": "2013-03-14T21:32:15Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket14275/14275.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_173322.json:
```json
{
    "body": "Attachment [14275.patch](https://github.com/sagemath/sage/files/ticket14275/14275.patch) by @roed314 created at 2013-03-14 21:32:15",
    "created_at": "2013-03-14T21:32:15Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173322",
    "user": "https://github.com/roed314"
}
```

Attachment [14275.patch](https://github.com/sagemath/sage/files/ticket14275/14275.patch) by @roed314 created at 2013-03-14 21:32:15



---

archive/issue_events_123465.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-14T21:36:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123465"
}
```



---

archive/issue_comments_173323.json:
```json
{
    "body": "**Work_Issues:** failing doctest",
    "created_at": "2013-04-03T16:29:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173323",
    "user": "https://github.com/tscrim"
}
```

**Work_Issues:** failing doctest



---

archive/issue_events_123466.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-04-03T16:29:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123466"
}
```



---

archive/issue_events_123467.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-04-03T16:29:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123467"
}
```



---

archive/issue_comments_173324.json:
```json
{
    "body": "<a id='comment:2'></a>\nHey David,\n\nThe doctest is failing because the mismatch of the trac numbers. Also could you add a doctest with a message as well?\n\nThanks,\n\nTravis",
    "created_at": "2013-04-03T16:29:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173324",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
Hey David,

The doctest is failing because the mismatch of the trac numbers. Also could you add a doctest with a message as well?

Thanks,

Travis



---

archive/issue_comments_173325.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2013-04-03T16:29:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173325",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_173326.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe way I see it, deprecation only makes sense for stuff that is imported into the global namespace. Anything that is not directly accessible from the command line is, by definition, an implementation detail. And once you require backwards compatibility for implementation details it basically becomes impossible to change anything. So there is no point in deprecating import locations.",
    "created_at": "2013-04-22T13:55:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173326",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
The way I see it, deprecation only makes sense for stuff that is imported into the global namespace. Anything that is not directly accessible from the command line is, by definition, an implementation detail. And once you require backwards compatibility for implementation details it basically becomes impossible to change anything. So there is no point in deprecating import locations.



---

archive/issue_events_123468.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123468"
}
```



---

archive/issue_events_123469.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123469"
}
```



---

archive/issue_events_123470.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123470"
}
```



---

archive/issue_events_123471.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123471"
}
```



---

archive/issue_comments_173327.json:
```json
{
    "body": "**Commit:** [108e019185bf79a5e66c93a478f05116789278ae](https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae)",
    "created_at": "2014-03-09T18:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173327",
    "user": "https://github.com/tscrim"
}
```

**Commit:** [108e019185bf79a5e66c93a478f05116789278ae](https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae)



---

archive/issue_events_123472.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-03-09T18:53:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123472"
}
```



---

archive/issue_events_123473.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-03-09T18:53:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123473"
}
```



---

archive/issue_comments_173328.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis could be used to remove things from the global namespace but the class itself doesn't change.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae\">108e019</a></td><td><code>Adds a deprecation option to lazy_import.</code></td></tr></table>\n",
    "created_at": "2014-03-09T18:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173328",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
This could be used to remove things from the global namespace but the class itself doesn't change.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae">108e019</a></td><td><code>Adds a deprecation option to lazy_import.</code></td></tr></table>




---

archive/issue_comments_173329.json:
```json
{
    "body": "**Branch:** [u/tscrim/14275](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/14275)",
    "created_at": "2014-03-09T18:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173329",
    "user": "https://github.com/tscrim"
}
```

**Branch:** [u/tscrim/14275](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/14275)



---

archive/issue_comments_173330.json:
```json
{
    "body": "**Changing work_issues** from \"failing doctest\" to \"\".",
    "created_at": "2014-03-09T18:54:01Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173330",
    "user": "https://github.com/tscrim"
}
```

**Changing work_issues** from "failing doctest" to "".



---

archive/issue_comments_173331.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2\">a484809</a></td><td><code>Doctest fixes.</code></td></tr></table>\n",
    "created_at": "2014-03-09T18:59:10Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2">a484809</a></td><td><code>Doctest fixes.</code></td></tr></table>




---

archive/issue_comments_173332.json:
```json
{
    "body": "**Changing commit** from \"[108e019185bf79a5e66c93a478f05116789278ae](https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae)\" to \"[a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)\".",
    "created_at": "2014-03-09T18:59:10Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173332",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[108e019185bf79a5e66c93a478f05116789278ae](https://github.com/sagemath/sagetrac-mirror/commit/108e019185bf79a5e66c93a478f05116789278ae)" to "[a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)".



---

archive/issue_comments_173333.json:
```json
{
    "body": "<a id='comment:9'></a>\nComment from the sage-combinat thread :\n\nthe way it is implemented you add a \"deprecation\" \nfeature to lazy import. But lazy imports can be used a lot, so \nwouldn't it be better to instead add a \"lazy\" feature to \n\"deprecation_function_alias\" ? \n\nNathann",
    "created_at": "2014-04-03T14:11:19Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173333",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>
Comment from the sage-combinat thread :

the way it is implemented you add a "deprecation" 
feature to lazy import. But lazy imports can be used a lot, so 
wouldn't it be better to instead add a "lazy" feature to 
"deprecation_function_alias" ? 

Nathann



---

archive/issue_events_123474.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-04-03T14:11:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123474"
}
```



---

archive/issue_events_123475.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-04-03T14:11:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123475"
}
```



---

archive/issue_comments_173334.json:
```json
{
    "body": "<a id='comment:10'></a>\nNo, because then we'd have to import `deprecated_function_alias` (which doesn't currently accept a message too) and import the original object just to do something like\n\n```\nx = deprecation_function_alias(14275, x)\n```\nOtherwise we completely change the syntax and functionality to include `lazy_import`. Both of which are asinine.",
    "created_at": "2014-04-03T17:05:13Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173334",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
No, because then we'd have to import `deprecated_function_alias` (which doesn't currently accept a message too) and import the original object just to do something like

```
x = deprecation_function_alias(14275, x)
```
Otherwise we completely change the syntax and functionality to include `lazy_import`. Both of which are asinine.



---

archive/issue_events_123476.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-03T17:05:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123476"
}
```



---

archive/issue_events_123477.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-03T17:05:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123477"
}
```



---

archive/issue_comments_173335.json:
```json
{
    "body": "<a id='comment:11'></a>\nAhahaahha. Well, for as long as you know that the two reasons you gave me are bad reasons and can be easily avoided, all is fine. It is not so bad.\n\nGood to go !\n\nNathann",
    "created_at": "2014-04-03T20:37:13Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173335",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>
Ahahaahha. Well, for as long as you know that the two reasons you gave me are bad reasons and can be easily avoided, all is fine. It is not so bad.

Good to go !

Nathann



---

archive/issue_events_123478.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-04-03T20:37:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123478"
}
```



---

archive/issue_events_123479.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-04-03T20:37:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123479"
}
```



---

archive/issue_comments_173336.json:
```json
{
    "body": "**Changing reviewer** from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Nathann Cohen\".",
    "created_at": "2014-04-03T20:37:13Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173336",
    "user": "https://github.com/nathanncohen"
}
```

**Changing reviewer** from "Travis Scrimshaw" to "Travis Scrimshaw, Nathann Cohen".



---

archive/issue_comments_173337.json:
```json
{
    "body": "**Changing author** from \"David Roe\" to \"David Roe, Travis Scrimshaw\".",
    "created_at": "2014-04-03T20:37:13Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173337",
    "user": "https://github.com/nathanncohen"
}
```

**Changing author** from "David Roe" to "David Roe, Travis Scrimshaw".



---

archive/issue_comments_173338.json:
```json
{
    "body": "<a id='comment:12'></a>\nThanks Nathann.",
    "created_at": "2014-04-03T21:34:22Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173338",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Thanks Nathann.



---

archive/issue_comments_173339.json:
```json
{
    "body": "**Changing branch** from \"[u/tscrim/14275](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/14275)\" to \"[a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)\".",
    "created_at": "2014-04-04T15:55:31Z",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14275#issuecomment-173339",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/tscrim/14275](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/14275)" to "[a4848093884df99a12d031dc853ce9d97c0c3dc2](https://github.com/sagemath/sagetrac-mirror/commit/a4848093884df99a12d031dc853ce9d97c0c3dc2)".



---

archive/issue_events_123480.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-04T15:55:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123480"
}
```



---

archive/issue_events_123481.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-04T15:55:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14275",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14275#event-123481"
}
```
