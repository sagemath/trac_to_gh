# Issue 14377: Move spkg logs to logs/pkgs

archive/issues_014173.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-GeorgSWeber"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nSave logs of package builds in `logs/pkgs` instead of `spkg/logs`.\n\nDepends on #14328\nDepends on #14226\n\nCC:  @ohanar @ohanar\n\nComponent: **build**\n\nAuthor: **John Palmieri**\n\nReviewer: **R. Andrew Ohana, Jeroen Demeyer**\n\nMerged: **sage-5.9.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14377_\n\n",
    "closed_at": "2013-04-04T17:40:32Z",
    "created_at": "2013-03-29T03:49:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Move spkg logs to logs/pkgs",
    "type": "issue",
    "updated_at": "2013-05-12T15:45:01Z",
    "url": "https://github.com/sagemath/sage/issues/14377",
    "user": "https://github.com/jdemeyer"
}
```
<div id="comment:0"></div>

Save logs of package builds in `logs/pkgs` instead of `spkg/logs`.

Depends on #14328
Depends on #14226

CC:  @ohanar @ohanar

Component: **build**

Author: **John Palmieri**

Reviewer: **R. Andrew Ohana, Jeroen Demeyer**

Merged: **sage-5.9.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/14377_





---

archive/issue_events_201225.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-29T03:49:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201225"
}
```



---

archive/issue_events_201226.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-29T03:49:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201226"
}
```



---

archive/issue_events_201227.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-29T03:49:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201227"
}
```



---

archive/issue_events_201228.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-29T03:49:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201228"
}
```



---

archive/issue_events_201229.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2013-03-29T03:49:39Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201229"
}
```



---

archive/issue_comments_172889.json:
```json
{
    "body": "Dependencies: **#14328**",
    "created_at": "2013-03-29T03:50:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172889",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#14328**



---

archive/issue_comments_172890.json:
```json
{
    "body": "Author: **John Palmieri**",
    "created_at": "2013-03-29T17:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172890",
    "user": "https://github.com/jhpalmieri"
}
```

Author: **John Palmieri**



---

archive/issue_comments_172891.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHere is an untested patch to the root repo, along with a change to the documentation.",
    "created_at": "2013-03-29T17:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172891",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

Here is an untested patch to the root repo, along with a change to the documentation.



---

archive/issue_events_201230.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-03-29T17:19:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201230"
}
```



---

archive/issue_comments_172892.json:
```json
{
    "body": "Reviewer: **R. Andrew Ohana**",
    "created_at": "2013-03-30T23:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172892",
    "user": "https://github.com/ohanar"
}
```

Reviewer: **R. Andrew Ohana**



---

archive/issue_comments_172893.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nother than maybe removing the line in `make distclean`, this looks good to me.",
    "created_at": "2013-03-30T23:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172893",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:3" align="right">comment:3</div>

other than maybe removing the line in `make distclean`, this looks good to me.



---

archive/issue_events_201231.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-03-30T23:27:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201231"
}
```



---

archive/issue_events_201232.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-03-30T23:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201232"
}
```



---

archive/issue_comments_172894.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI think for the sake of upgrades, we should leave `make distclean` as is.",
    "created_at": "2013-03-31T14:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172894",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

I think for the sake of upgrades, we should leave `make distclean` as is.



---

archive/issue_comments_172895.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIs this going to break anything?  There are probably at least a few \"help\" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.\n\nAlso, does `make test` still work, though, and put a log somewhere?  Is that still documented anywhere, or was the README the last place?  \n\nJust checking in both cases, I presume by default these are silly questions.",
    "created_at": "2013-04-01T13:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172895",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:5" align="right">comment:5</div>

Is this going to break anything?  There are probably at least a few "help" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.

Also, does `make test` still work, though, and put a log somewhere?  Is that still documented anywhere, or was the README the last place?  

Just checking in both cases, I presume by default these are silly questions.



---

archive/issue_comments_172896.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@kcrisman](#comment%3A5):\n> Is this going to break anything?  There are probably at least a few \"help\" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.\n\nIf anything, `logs/pkgs` should be easier to find than `spkg/logs`. And also, when building fails, the error message is now a lot more clear.\n\n> Also, does `make test` still work, though, and put a log somewhere?\n\nYes, but see #14328 for this (it is unrelated to this ticket, which deals with logs of building packages).\n\n> Is that still documented anywhere\n\nNot that I know.",
    "created_at": "2013-04-01T13:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172896",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@kcrisman](#comment%3A5):
> Is this going to break anything?  There are probably at least a few "help" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.

If anything, `logs/pkgs` should be easier to find than `spkg/logs`. And also, when building fails, the error message is now a lot more clear.

> Also, does `make test` still work, though, and put a log somewhere?

Yes, but see #14328 for this (it is unrelated to this ticket, which deals with logs of building packages).

> Is that still documented anywhere

Not that I know.



---

archive/issue_comments_172897.json:
```json
{
    "body": "Attachment: **[trac_14377-root.patch.gz](https://github.com/sagemath/sage/files/ticket14377/trac_14377-root.patch.gz)**\n\nroot repo",
    "created_at": "2013-04-01T15:46:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172897",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[trac_14377-root.patch.gz](https://github.com/sagemath/sage/files/ticket14377/trac_14377-root.patch.gz)**

root repo



---

archive/issue_comments_172898.json:
```json
{
    "body": "Changed reviewer from **R. Andrew Ohana** to **R. Andrew Ohana, Jeroen Demeyer**",
    "created_at": "2013-04-01T15:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172898",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **R. Andrew Ohana** to **R. Andrew Ohana, Jeroen Demeyer**



---

archive/issue_comments_172899.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nRebased to #14226 and added:\n\n```diff\ndiff --git a/spkg/bin/sage-spkg b/spkg/bin/sage-spkg\n\nIndex: spkg/bin/sage-spkg\n===================================================================\n--- a/spkg/bin/sage-spkg\n+++ b/spkg/bin/sage-spkg\n@@ -64,13 +64,13 @@\n ************************************************************************\n Please email sage-devel (http://groups.google.com/group/sage-devel)\n explaining the problem and including the relevant part of the log file\n-  $SAGE_ROOT/spkg/logs/$PKG_NAME.log\n+  $SAGE_LOGS/$PKG_NAME.log\n Describe your computer, operating system, etc.\n If you want to try to fix the problem yourself, *don't* just cd to\n `pwd` and type '$2' or whatever is appropriate.\n Instead, the following commands setup all environment variables\n correctly and load a subshell for you to debug the error:\n-  (cd '`pwd`' && '$SAGE_ROOT/sage' -sh)\n+  (cd '`pwd`' && '$SAGE_ROOT/sage' --sh)\n When you are done debugging, you can type \"exit\" to leave the subshell.\n ************************************************************************\n MESSAGE\n```",
    "created_at": "2013-04-01T15:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172899",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Rebased to #14226 and added:

```diff
diff --git a/spkg/bin/sage-spkg b/spkg/bin/sage-spkg

Index: spkg/bin/sage-spkg
===================================================================
--- a/spkg/bin/sage-spkg
+++ b/spkg/bin/sage-spkg
@@ -64,13 +64,13 @@
 ************************************************************************
 Please email sage-devel (http://groups.google.com/group/sage-devel)
 explaining the problem and including the relevant part of the log file
-  $SAGE_ROOT/spkg/logs/$PKG_NAME.log
+  $SAGE_LOGS/$PKG_NAME.log
 Describe your computer, operating system, etc.
 If you want to try to fix the problem yourself, *don't* just cd to
 `pwd` and type '$2' or whatever is appropriate.
 Instead, the following commands setup all environment variables
 correctly and load a subshell for you to debug the error:
-  (cd '`pwd`' && '$SAGE_ROOT/sage' -sh)
+  (cd '`pwd`' && '$SAGE_ROOT/sage' --sh)
 When you are done debugging, you can type "exit" to leave the subshell.
 ************************************************************************
 MESSAGE
```



---

archive/issue_comments_172900.json:
```json
{
    "body": "Changed dependencies from **#14328** to **#14328, #14226**",
    "created_at": "2013-04-01T15:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172900",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#14328** to **#14328, #14226**



---

archive/issue_comments_172901.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOh, and now I've added this to the Sage library patch:\n\n```diff\ndiff --git a/sage/env.py b/sage/env.py\n--- a/sage/env.py\n+++ b/sage/env.py\n@@ -41,7 +41,7 @@\n         'SAGE_DATA'        : '$SAGE_SHARE',\n         'SAGE_EXTCODE'     : opj('$SAGE_SHARE', 'sage', 'ext'),\n         'SAGE_PACKAGES'    : opj('$SAGE_ROOT', 'spkg'),\n-        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'spkg', 'logs'),\n+        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'logs', 'pkgs'),\n         'SAGE_SPKG_INST'   : opj('$SAGE_ROOT', 'spkg', 'installed'),\n         'SAGE_DOC'         : opj('$SAGE_ROOT', 'devel', 'sage', 'doc'),\n         'DOT_SAGE'         : opj(os.environ.get('HOME','$SAGE_ROOT'), '.sage'),\n```",
    "created_at": "2013-04-01T16:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172901",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">comment:8</div>

Oh, and now I've added this to the Sage library patch:

```diff
diff --git a/sage/env.py b/sage/env.py
--- a/sage/env.py
+++ b/sage/env.py
@@ -41,7 +41,7 @@
         'SAGE_DATA'        : '$SAGE_SHARE',
         'SAGE_EXTCODE'     : opj('$SAGE_SHARE', 'sage', 'ext'),
         'SAGE_PACKAGES'    : opj('$SAGE_ROOT', 'spkg'),
-        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'spkg', 'logs'),
+        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'logs', 'pkgs'),
         'SAGE_SPKG_INST'   : opj('$SAGE_ROOT', 'spkg', 'installed'),
         'SAGE_DOC'         : opj('$SAGE_ROOT', 'devel', 'sage', 'doc'),
         'DOT_SAGE'         : opj(os.environ.get('HOME','$SAGE_ROOT'), '.sage'),
```



---

archive/issue_comments_172902.json:
```json
{
    "body": "documentation change (Sage library)",
    "created_at": "2013-04-01T16:31:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172902",
    "user": "https://github.com/jhpalmieri"
}
```

documentation change (Sage library)



---

archive/issue_events_201233.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T09:00:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201233"
}
```



---

archive/issue_events_201234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T09:00:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201234"
}
```



---

archive/issue_comments_172903.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAttachment: **[trac_14377-sagelib.patch.gz](https://github.com/sagemath/sage/files/ticket14377/trac_14377-sagelib.patch.gz)**",
    "created_at": "2013-04-03T09:00:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172903",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Attachment: **[trac_14377-sagelib.patch.gz](https://github.com/sagemath/sage/files/ticket14377/trac_14377-sagelib.patch.gz)**



---

archive/issue_events_201235.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-04T17:40:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201235"
}
```



---

archive/issue_events_201236.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-04T17:40:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14377#event-201236"
}
```



---

archive/issue_comments_172904.json:
```json
{
    "body": "Merged: **sage-5.9.beta4**",
    "created_at": "2013-04-04T17:40:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172904",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.9.beta4**



---

archive/issue_comments_172905.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nWhen upgrading, it would probably make sense to move old spkg build logs to the new folder, and afterwards create a symlink from `spkg/logs` to `logs/pkg/`.",
    "created_at": "2013-04-07T11:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172905",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:11" align="right">comment:11</div>

When upgrading, it would probably make sense to move old spkg build logs to the new folder, and afterwards create a symlink from `spkg/logs` to `logs/pkg/`.



---

archive/issue_comments_172906.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe odd thing is that this disturbs filename completion `$SAGE_ROOT/l...`; now one has to type three characters to disambiguate `local` from `logs`.\n\n---\n\nAlso, why `pkgs`, rather than `spkgs`?  Or `log/[s]pkg[s]/`, which would be consistent (with e.g. `/var/log/`)?\n\n[EDIT: Ooops.]",
    "created_at": "2013-05-12T15:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14377#issuecomment-172906",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

The odd thing is that this disturbs filename completion `$SAGE_ROOT/l...`; now one has to type three characters to disambiguate `local` from `logs`.

---

Also, why `pkgs`, rather than `spkgs`?  Or `log/[s]pkg[s]/`, which would be consistent (with e.g. `/var/log/`)?

[EDIT: Ooops.]
