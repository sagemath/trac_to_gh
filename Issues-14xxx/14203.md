# Issue 14203: Move DOCTEST_MODE to doctesting framework

archive/issues_013999.json:
```json
{
    "assignees": [
        "https://github.com/roed314"
    ],
    "body": "Move the `DOCTEST_MODE` setting to the doctesting framework, for example in the file `sage/doctest/all.py`.\n\nDepends on #12415\n\nCC:  @jhpalmieri\n\nReviewer: **Volker Braun**\n\nAuthor: **John Palmieri**\n\nMerged: **sage-5.10.beta1**\n\nComponent: **doctest framework**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14203_\n\n",
    "closed_at": "2013-04-28T10:34:10Z",
    "created_at": "2013-02-28T09:41:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Move DOCTEST_MODE to doctesting framework",
    "type": "issue",
    "updated_at": "2013-04-28T10:34:10Z",
    "url": "https://github.com/sagemath/sage/issues/14203",
    "user": "https://github.com/jdemeyer"
}
```
Move the `DOCTEST_MODE` setting to the doctesting framework, for example in the file `sage/doctest/all.py`.

Depends on #12415

CC:  @jhpalmieri

Reviewer: **Volker Braun**

Author: **John Palmieri**

Merged: **sage-5.10.beta1**

Component: **doctest framework**

_Issue created by migration from https://trac.sagemath.org/ticket/14203_





---

archive/issue_events_200031.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T09:41:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200031"
}
```



---

archive/issue_events_200032.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T09:41:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200032"
}
```



---

archive/issue_events_200033.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T09:41:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200033"
}
```



---

archive/issue_events_200034.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T09:41:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200034"
}
```



---

archive/issue_events_200035.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2013-02-28T09:41:24Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200035"
}
```



---

archive/issue_comments_169535.json:
```json
{
    "body": "Dependencies: **#12415**",
    "created_at": "2013-02-28T09:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169535",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#12415**



---

archive/issue_comments_169536.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?\n\nAt some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.",
    "created_at": "2013-03-01T04:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169536",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?

At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.



---

archive/issue_comments_169537.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jhpalmieri](#comment:3):\n> This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?\n\nWe need a combined `lazy_import`/`deprecate` for this situation.  :-)\n\n> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.\n\nWhere would `EMBEDDED_MODE` move to?",
    "created_at": "2013-03-14T20:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169537",
    "user": "https://github.com/roed314"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jhpalmieri](#comment:3):
> This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?

We need a combined `lazy_import`/`deprecate` for this situation.  :-)

> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.

Where would `EMBEDDED_MODE` move to?



---

archive/issue_comments_169538.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@roed314](#comment:4):\n> Where would `EMBEDDED_MODE` move to?\n\nMaybe somewhere in sagenb?",
    "created_at": "2013-03-14T20:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169538",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@roed314](#comment:4):
> Where would `EMBEDDED_MODE` move to?

Maybe somewhere in sagenb?



---

archive/issue_comments_169539.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@roed314](#comment:4):\n> We need a combined `lazy_import`/`deprecate` for this situation.  :-)\n\nI decided to write something: see #14275.",
    "created_at": "2013-03-14T21:37:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169539",
    "user": "https://github.com/roed314"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@roed314](#comment:4):
> We need a combined `lazy_import`/`deprecate` for this situation.  :-)

I decided to write something: see #14275.



---

archive/issue_comments_169540.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jhpalmieri](#comment:3):\n> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.\n\nAnd rename `EMBEDDED_MODE` to `HTML_MODE` or something else which describes the usage better.\n\nAnd `EMBEDDED_MODE` is actually independently defined in 6 different modules:\n\n```\ndevel/sagenb/sagenb/misc/support.py\ndevel/sage/sage/misc/pager.py\ndevel/sage/sage/misc/sageinspect.py\ndevel/sage/sage/misc/latex.py\ndevel/sage/sage/plot/plot.py\ndevel/sage/sage/server/support.py\n```",
    "created_at": "2013-03-18T16:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169540",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jhpalmieri](#comment:3):
> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.

And rename `EMBEDDED_MODE` to `HTML_MODE` or something else which describes the usage better.

And `EMBEDDED_MODE` is actually independently defined in 6 different modules:

```
devel/sagenb/sagenb/misc/support.py
devel/sage/sage/misc/pager.py
devel/sage/sage/misc/sageinspect.py
devel/sage/sage/misc/latex.py
devel/sage/sage/plot/plot.py
devel/sage/sage/server/support.py
```



---

archive/issue_comments_169541.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIs `NOTEBOOK_MODE` a good name?\n\nMaybe we should import it from `sagenb.misc.support` for now, and then rename it later. Or we could do this once somewhere in the Sage library:\n\n```python\ntry:\n    from sagenb.misc.support import NOTEBOOK_MODE\nexcept ImportError:\n    from sagenb.misc.support import EMBEDDED_MODE as NOTEBOOK_MODE\n```\nThen there can be an independent sagenb patch eventually.",
    "created_at": "2013-03-18T19:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169541",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">comment:8</div>

Is `NOTEBOOK_MODE` a good name?

Maybe we should import it from `sagenb.misc.support` for now, and then rename it later. Or we could do this once somewhere in the Sage library:

```python
try:
    from sagenb.misc.support import NOTEBOOK_MODE
except ImportError:
    from sagenb.misc.support import EMBEDDED_MODE as NOTEBOOK_MODE
```
Then there can be an independent sagenb patch eventually.



---

archive/issue_events_200036.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2013-03-28T22:45:08Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200036"
}
```



---

archive/issue_events_200037.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-28T22:45:08Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200037"
}
```



---

archive/issue_events_200038.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-28T22:45:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200038"
}
```



---

archive/issue_events_200039.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-03-28T22:45:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
    "label_color": "000080",
    "label_name": "c: doctest framework",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200039"
}
```



---

archive/issue_comments_169542.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIs this ticket ready for review?",
    "created_at": "2013-04-03T08:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169542",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Is this ticket ready for review?



---

archive/issue_comments_169543.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSure, why not?",
    "created_at": "2013-04-03T14:44:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169543",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">comment:11</div>

Sure, why not?



---

archive/issue_events_200040.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-04-03T14:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200040"
}
```



---

archive/issue_comments_169544.json:
```json
{
    "body": "initial patch",
    "created_at": "2013-04-03T17:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169544",
    "user": "https://github.com/jhpalmieri"
}
```

initial patch



---

archive/issue_comments_169545.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[trac_14203_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14203/trac_14203_doctest.patch.gz)**\n\nRebased to 5.9.beta2.",
    "created_at": "2013-04-03T17:08:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169545",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[trac_14203_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14203/trac_14203_doctest.patch.gz)**

Rebased to 5.9.beta2.



---

archive/issue_comments_169546.json:
```json
{
    "body": "Author: **John Palmieri**",
    "created_at": "2013-04-20T18:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169546",
    "user": "https://github.com/vbraun"
}
```

Author: **John Palmieri**



---

archive/issue_comments_169547.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2013-04-20T18:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169547",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_169548.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nLooks good to me!",
    "created_at": "2013-04-20T18:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169548",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

Looks good to me!



---

archive/issue_events_200041.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-20T18:37:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200041"
}
```



---

archive/issue_events_200042.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-20T18:37:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200042"
}
```



---

archive/issue_events_200043.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-20T18:37:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200043"
}
```



---

archive/issue_events_200044.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-20T18:37:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200044"
}
```



---

archive/issue_comments_169549.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nUmm... what about the #14275 situation?  I don't think this would mess things up as much as moving `EMBEDDED_MODE` but perhaps it's still unwise to do without this...",
    "created_at": "2013-04-22T13:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169549",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:14" align="right">comment:14</div>

Umm... what about the #14275 situation?  I don't think this would mess things up as much as moving `EMBEDDED_MODE` but perhaps it's still unwise to do without this...



---

archive/issue_comments_169550.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI don't agree with #14275, for starters. It would be a mistake to make any guarantees about the implementation of the doctesting framework. If your code depends on the location of `DOCTEST_MODE` then your code is broken.",
    "created_at": "2013-04-22T13:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169550",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

I don't agree with #14275, for starters. It would be a mistake to make any guarantees about the implementation of the doctesting framework. If your code depends on the location of `DOCTEST_MODE` then your code is broken.



---

archive/issue_events_200045.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-28T10:34:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200045"
}
```



---

archive/issue_events_200046.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-28T10:34:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14203#event-200046"
}
```



---

archive/issue_comments_169551.json:
```json
{
    "body": "Merged: **sage-5.10.beta1**",
    "created_at": "2013-04-28T10:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14203#issuecomment-169551",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.10.beta1**
