# Issue 14203: Move DOCTEST_MODE to doctesting framework

archive/issues_013999.json:
```json
{
    "body": "Move the `DOCTEST_MODE` setting to the doctesting framework, for example in the file `sage/doctest/all.py`.\n\n**Assignee:** @roed314\n\n**CC:**  @jhpalmieri\n\n**Reviewer:** Volker Braun\n\n**Author:** John Palmieri\n\n**Merged:** sage-5.10.beta1\n\n**Dependencies:** #12415\n\nIssue created by migration from https://trac.sagemath.org/ticket/14203\n\n",
    "closed_at": "2013-04-28T10:34:10Z",
    "created_at": "2013-02-28T09:41:24Z",
    "labels": [
        "component: doctest framework",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Move DOCTEST_MODE to doctesting framework",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14203",
    "user": "https://github.com/jdemeyer"
}
```
Move the `DOCTEST_MODE` setting to the doctesting framework, for example in the file `sage/doctest/all.py`.

**Assignee:** @roed314

**CC:**  @jhpalmieri

**Reviewer:** Volker Braun

**Author:** John Palmieri

**Merged:** sage-5.10.beta1

**Dependencies:** #12415

Issue created by migration from https://trac.sagemath.org/ticket/14203





---

archive/issue_comments_209350.json:
```json
{
    "body": "**Dependencies:** #12415",
    "created_at": "2013-02-28T09:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209350",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #12415



---

archive/issue_comments_209351.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?\n\nAt some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.",
    "created_at": "2013-03-01T04:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209351",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?

At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.



---

archive/issue_comments_209352.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [jhpalmieri](#comment%3A3):\n> This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?\n\n\nWe need a combined `lazy_import`/`deprecate` for this situation.  :-)\n\n> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.\n\n\nWhere would `EMBEDDED_MODE` move to?",
    "created_at": "2013-03-14T20:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209352",
    "user": "https://github.com/roed314"
}
```

<a id='comment:4'></a>
Replying to [jhpalmieri](#comment%3A3):
> This patch puts `DOCTEST_MODE` in `sage/doctest/__init__.py`. It also removes it entirely from `sage/plot/plot.py`, since it wasn't used there at all. Should we leave it there for backwards compatibility with optional/experimental packages and third party code?


We need a combined `lazy_import`/`deprecate` for this situation.  :-)

> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.


Where would `EMBEDDED_MODE` move to?



---

archive/issue_comments_209353.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [roed](#comment%3A4):\n> Where would `EMBEDDED_MODE` move to?\n\n\nMaybe somewhere in sagenb?",
    "created_at": "2013-03-14T20:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209353",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Replying to [roed](#comment%3A4):
> Where would `EMBEDDED_MODE` move to?


Maybe somewhere in sagenb?



---

archive/issue_comments_209354.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [roed](#comment%3A4):\n> We need a combined `lazy_import`/`deprecate` for this situation.  :-)\n\n\nI decided to write something: see #14275.",
    "created_at": "2013-03-14T21:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209354",
    "user": "https://github.com/roed314"
}
```

<a id='comment:6'></a>
Replying to [roed](#comment%3A4):
> We need a combined `lazy_import`/`deprecate` for this situation.  :-)


I decided to write something: see #14275.



---

archive/issue_comments_209355.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [jhpalmieri](#comment%3A3):\n> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.\n\nAnd rename `EMBEDDED_MODE` to `HTML_MODE` or something else which describes the usage better.\n\nAnd `EMBEDDED_MODE` is actually independently defined in 6 different modules:\n\n```\ndevel/sagenb/sagenb/misc/support.py\ndevel/sage/sage/misc/pager.py\ndevel/sage/sage/misc/sageinspect.py\ndevel/sage/sage/misc/latex.py\ndevel/sage/sage/plot/plot.py\ndevel/sage/sage/server/support.py\n```",
    "created_at": "2013-03-18T16:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209355",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [jhpalmieri](#comment%3A3):
> At some point, we might do the same with `EMBEDDED_MODE`, but this will also require patches to sagenb, and therefore is more annoying.

And rename `EMBEDDED_MODE` to `HTML_MODE` or something else which describes the usage better.

And `EMBEDDED_MODE` is actually independently defined in 6 different modules:

```
devel/sagenb/sagenb/misc/support.py
devel/sage/sage/misc/pager.py
devel/sage/sage/misc/sageinspect.py
devel/sage/sage/misc/latex.py
devel/sage/sage/plot/plot.py
devel/sage/sage/server/support.py
```



---

archive/issue_comments_209356.json:
```json
{
    "body": "<a id='comment:8'></a>\nIs `NOTEBOOK_MODE` a good name?\n\nMaybe we should import it from `sagenb.misc.support` for now, and then rename it later. Or we could do this once somewhere in the Sage library:\n\n```python\ntry:\n    from sagenb.misc.support import NOTEBOOK_MODE\nexcept ImportError:\n    from sagenb.misc.support import EMBEDDED_MODE as NOTEBOOK_MODE\n```\nThen there can be an independent sagenb patch eventually.",
    "created_at": "2013-03-18T19:09:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209356",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Is `NOTEBOOK_MODE` a good name?

Maybe we should import it from `sagenb.misc.support` for now, and then rename it later. Or we could do this once somewhere in the Sage library:

```python
try:
    from sagenb.misc.support import NOTEBOOK_MODE
except ImportError:
    from sagenb.misc.support import EMBEDDED_MODE as NOTEBOOK_MODE
```
Then there can be an independent sagenb patch eventually.



---

archive/issue_comments_209357.json:
```json
{
    "body": "**Changing assignee** from mvngu to @roed314.",
    "created_at": "2013-03-28T22:45:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209357",
    "user": "https://github.com/roed314"
}
```

**Changing assignee** from mvngu to @roed314.



---

archive/issue_comments_209358.json:
```json
{
    "body": "<a id='comment:10'></a>\nIs this ticket ready for review?",
    "created_at": "2013-04-03T08:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209358",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Is this ticket ready for review?



---

archive/issue_comments_209359.json:
```json
{
    "body": "<a id='comment:11'></a>\nSure, why not?",
    "created_at": "2013-04-03T14:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209359",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
Sure, why not?



---

archive/issue_comments_209360.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-04-03T14:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209360",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_209361.json:
```json
{
    "body": "initial patch",
    "created_at": "2013-04-03T17:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209361",
    "user": "https://github.com/jhpalmieri"
}
```

initial patch



---

archive/attachments_019173.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14203_doctest.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14203/trac_14203_doctest.patch",
    "created_at": "2013-04-03T17:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_209362.json:
```json
{
    "body": "<a id='comment:12'></a>\nRebased to 5.9.beta2.",
    "created_at": "2013-04-03T17:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209362",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Rebased to 5.9.beta2.



---

archive/issue_comments_209363.json:
```json
{
    "body": "**Author:** John Palmieri",
    "created_at": "2013-04-20T18:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209363",
    "user": "https://github.com/vbraun"
}
```

**Author:** John Palmieri



---

archive/issue_comments_209364.json:
```json
{
    "body": "**Reviewer:** Volker Braun",
    "created_at": "2013-04-20T18:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209364",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Volker Braun



---

archive/issue_comments_209365.json:
```json
{
    "body": "<a id='comment:13'></a>\nLooks good to me!",
    "created_at": "2013-04-20T18:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209365",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'></a>
Looks good to me!



---

archive/issue_comments_209366.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-04-20T18:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209366",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_046549.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-20T18:37:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14203#event-46549"
}
```



---

archive/issue_comments_209367.json:
```json
{
    "body": "<a id='comment:14'></a>\nUmm... what about the #14275 situation?  I don't think this would mess things up as much as moving `EMBEDDED_MODE` but perhaps it's still unwise to do without this...",
    "created_at": "2013-04-22T13:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209367",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'></a>
Umm... what about the #14275 situation?  I don't think this would mess things up as much as moving `EMBEDDED_MODE` but perhaps it's still unwise to do without this...



---

archive/issue_comments_209368.json:
```json
{
    "body": "<a id='comment:15'></a>\nI don't agree with #14275, for starters. It would be a mistake to make any guarantees about the implementation of the doctesting framework. If your code depends on the location of `DOCTEST_MODE` then your code is broken.",
    "created_at": "2013-04-22T13:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209368",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
I don't agree with #14275, for starters. It would be a mistake to make any guarantees about the implementation of the doctesting framework. If your code depends on the location of `DOCTEST_MODE` then your code is broken.



---

archive/issue_events_046550.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-28T10:34:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14203#event-46550"
}
```



---

archive/issue_comments_209369.json:
```json
{
    "body": "**Merged:** sage-5.10.beta1",
    "created_at": "2013-04-28T10:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14203#issuecomment-209369",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.10.beta1
