# Issue 14652: Lazy imports for WeylGroup and other MatrixGroups

archive/issues_014448.json:
```json
{
    "assignees": [],
    "body": "This patch makes various imports lazy so that less modules are dragged in on startup.\n\n\nDepends on #14014\n\nAssignee: **@wdjoyner**\n\nAuthor: **Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14652_\n\n",
    "created_at": "2013-05-28T11:40:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Lazy imports for WeylGroup and other MatrixGroups",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/14652",
    "user": "https://github.com/vbraun"
}
```
This patch makes various imports lazy so that less modules are dragged in on startup.


Depends on #14014

Assignee: **@wdjoyner**

Author: **Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/14652_





---

archive/issue_events_190603.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:40:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190603"
}
```



---

archive/issue_events_190604.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:40:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "component: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190604"
}
```



---

archive/issue_events_190605.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:40:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190605"
}
```



---

archive/issue_events_190606.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:40:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190606"
}
```



---

archive/issue_events_190607.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:41:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "title_is": "Lazy imports for WeylGroup and other MatrixGroups",
    "title_was": "Laziy imports for WeylGroup and other MatrixGroups",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190607"
}
```



---

archive/issue_comments_180397.json:
```json
{
    "body": "Updated patch",
    "created_at": "2013-05-28T11:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14652#issuecomment-180397",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_180398.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nAttachment: **[trac_14652_lazify_imports.patch.gz](https://github.com/sagemath/sage/files/ticket14652/trac_14652_lazify_imports.patch.gz)**",
    "created_at": "2013-05-28T11:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14652#issuecomment-180398",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">Comment 2</div>

Attachment: **[trac_14652_lazify_imports.patch.gz](https://github.com/sagemath/sage/files/ticket14652/trac_14652_lazify_imports.patch.gz)**



---

archive/issue_events_190608.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:46:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190608"
}
```



---

archive/issue_comments_180399.json:
```json
{
    "body": "Dependencies: **#14014**",
    "created_at": "2013-05-28T11:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14652#issuecomment-180399",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#14014**



---

archive/issue_events_190609.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:57:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190609"
}
```



---

archive/issue_events_190610.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-05-28T11:57:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190610"
}
```



---

archive/issue_comments_180400.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nI am not sure I should post this here or on #14014 but ...\n\nWith #14014 it now takes a long time the first time one creates a matrix group:\n\n```\nsage: %time WeylGroup([\"A\",3]) \nCPU times: user 10.10 s, sys: 0.11 s, total: 10.21 s\nWall time: 10.23 s\n```\n\nI guess that's the time needed to start gap. This feels like a lot\nthough, and is quite annoying.\n\nNote that just starting gap takes roughly half of that time::\n\n```\nmistral-~s/sage/algebras>time (echo \"quit;\" | sage -gap)\ngap: halving pool size.\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   GAP, Version 4.5.7 of 14-Dec-2012 (free software, GPL)\n \u2502  GAP  \u2502   http://www.gap-system.org\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   Architecture: x86_64-unknown-linux-gnu-gcc-default64\n Libs used:  gmp, readline\n Loading the library and packages ...\n ...\n5,44s user 0,16s system 98% cpu 5,661 total\n```\n\nAnd before #10414, starting Sage *and* creating a Weyl group took far less time:\n\n```\ntime (echo \"WeylGroup(['A',3])\" | ../../sage)\n...\nsage: WeylGroup(['A',3])\nWeyl Group of type ['A', 3] (as a matrix group acting on the ambient space)\nExiting Sage (CPU time 0m0.30s, Wall time 0m0.29s).\n( echo \"WeylGroup(['A',3])\" | ../../sage; )  3,04s user 0,54s system 89% cpu 3,998 total\n```\n\n\nWell, the above measurement are probably very rough, but this still\nseems to be saying that there would be room for improvement. Does\nlibgap load by default more libraries and packages than the usual gap\nloaded in Sage?\n\nCheers,\n                            Nicolas",
    "created_at": "2013-06-13T15:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14652#issuecomment-180400",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:4" align="right">Comment 4</div>

I am not sure I should post this here or on #14014 but ...

With #14014 it now takes a long time the first time one creates a matrix group:

```
sage: %time WeylGroup(["A",3]) 
CPU times: user 10.10 s, sys: 0.11 s, total: 10.21 s
Wall time: 10.23 s
```

I guess that's the time needed to start gap. This feels like a lot
though, and is quite annoying.

Note that just starting gap takes roughly half of that time::

```
mistral-~s/sage/algebras>time (echo "quit;" | sage -gap)
gap: halving pool size.
 ┌───────┐   GAP, Version 4.5.7 of 14-Dec-2012 (free software, GPL)
 │  GAP  │   http://www.gap-system.org
 └───────┘   Architecture: x86_64-unknown-linux-gnu-gcc-default64
 Libs used:  gmp, readline
 Loading the library and packages ...
 ...
5,44s user 0,16s system 98% cpu 5,661 total
```

And before #10414, starting Sage *and* creating a Weyl group took far less time:

```
time (echo "WeylGroup(['A',3])" | ../../sage)
...
sage: WeylGroup(['A',3])
Weyl Group of type ['A', 3] (as a matrix group acting on the ambient space)
Exiting Sage (CPU time 0m0.30s, Wall time 0m0.29s).
( echo "WeylGroup(['A',3])" | ../../sage; )  3,04s user 0,54s system 89% cpu 3,998 total
```


Well, the above measurement are probably very rough, but this still
seems to be saying that there would be room for improvement. Does
libgap load by default more libraries and packages than the usual gap
loaded in Sage?

Cheers,
                            Nicolas



---

archive/issue_comments_180401.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nLibGAP doesn't use the GAP saved workspace mechanism yet. Saving workspaces has a bug that occasionally corrupts the workspace http://tracker.gap-system.org/issues/224",
    "created_at": "2013-06-13T15:44:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14652#issuecomment-180401",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">Comment 5</div>

LibGAP doesn't use the GAP saved workspace mechanism yet. Saving workspaces has a bug that occasionally corrupts the workspace http://tracker.gap-system.org/issues/224



---

archive/issue_events_190611.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190611"
}
```



---

archive/issue_events_190612.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190612"
}
```



---

archive/issue_events_190613.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190613"
}
```



---

archive/issue_events_190614.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190614"
}
```



---

archive/issue_events_190615.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190615"
}
```



---

archive/issue_events_190616.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190616"
}
```



---

archive/issue_events_190617.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190617"
}
```



---

archive/issue_events_190618.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190618"
}
```



---

archive/issue_events_190619.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14652",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14652#event-190619"
}
```
