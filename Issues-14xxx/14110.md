# Issue 14110: Speed Up Poset Generation

archive/issues_013906.json:
```json
{
    "body": "Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.\n\nB. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179\n\nhttps://doi.org/10.1023/A:1016543307592\n\nAssignee: csar\n\nCC:  @kevindilks rowland ahmorales @jm58660 @jasongrout @nathanncohen @dimpase\n\nKeywords: posets\n\nReviewer: Thierry Monteil\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/14110\n\n",
    "created_at": "2013-02-13T20:34:48Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Speed Up Poset Generation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14110",
    "user": "https://trac.sagemath.org/admin/accounts/users/csar"
}
```
Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.

B. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179

https://doi.org/10.1023/A:1016543307592

Assignee: csar

CC:  @kevindilks rowland ahmorales @jm58660 @jasongrout @nathanncohen @dimpase

Keywords: posets

Reviewer: Thierry Monteil

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/14110





---

archive/issue_comments_184609.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2013-02-13T20:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184609",
    "user": "https://trac.sagemath.org/admin/accounts/users/csar"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_184610.json:
```json
{
    "body": "Changing keywords from \"\" to \"posets\".",
    "created_at": "2013-07-25T14:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184610",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "posets".



---

archive/issue_comments_184611.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.\n+\n+B. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179\n \n Comment: 1\n \n``````\n",
    "created_at": "2013-07-25T14:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184611",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.
+
+B. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179
 
 Comment: 1
 
``````




---

archive/issue_events_039771.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39771"
}
```



---

archive/issue_events_039772.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39772"
}
```



---

archive/issue_events_039773.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39773"
}
```



---

archive/issue_events_039774.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39774"
}
```



---

archive/issue_events_039775.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39775"
}
```



---

archive/issue_events_039776.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39776"
}
```



---

archive/issue_events_039777.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39777"
}
```



---

archive/issue_comments_184612.json:
```json
{
    "body": "<a id='comment:7'></a>Brinkmann was kind and send me C-code that he used. However, on sage-devel list Nathann Cohen said that at least Nauty is not available as GPL and can not be directly added to Sage. As an optional package it should be fine.\n\nTo glue C code to Sage or to read the paper and make same code in [c|p]ython?",
    "created_at": "2014-10-02T18:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184612",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:7'></a>Brinkmann was kind and send me C-code that he used. However, on sage-devel list Nathann Cohen said that at least Nauty is not available as GPL and can not be directly added to Sage. As an optional package it should be fine.

To glue C code to Sage or to read the paper and make same code in [c|p]ython?



---

archive/issue_comments_184613.json:
```json
{
    "body": "<a id='comment:8'></a>Since you have (working) specialized C-code, I'd just glue it to Sage using cython (guaranteed to be faster than a pure python implementation). Anyways, that's my opinion.",
    "created_at": "2014-10-03T04:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184613",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Since you have (working) specialized C-code, I'd just glue it to Sage using cython (guaranteed to be faster than a pure python implementation). Anyways, that's my opinion.



---

archive/issue_comments_184614.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 tscrim]:\n> Since you have (working) specialized C-code, I'd just glue it to Sage using cython (guaranteed to be faster than a pure python implementation). Anyways, that's my opinion.\n\n\nFor that I first have to learn how to do glueing... Somewhere in the net should be simple example of making python data structure from C code.",
    "created_at": "2014-10-03T04:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184614",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:9'></a>Replying to [comment:8 tscrim]:
> Since you have (working) specialized C-code, I'd just glue it to Sage using cython (guaranteed to be faster than a pure python implementation). Anyways, that's my opinion.


For that I first have to learn how to do glueing... Somewhere in the net should be simple example of making python data structure from C code.



---

archive/issue_comments_184615.json:
```json
{
    "body": "<a id='comment:10'></a>As a quick test: `len(Posets(6).list())` took about 10 seconds, reading binary output from Brinkmann's code for posets of size 7 took about 12 seconds. Maybe going to cython will make n=8 to took about same time.\n\nE: About 90% of time is used in making posets from digraphs.",
    "created_at": "2014-10-05T07:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184615",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:10'></a>As a quick test: `len(Posets(6).list())` took about 10 seconds, reading binary output from Brinkmann's code for posets of size 7 took about 12 seconds. Maybe going to cython will make n=8 to took about same time.

E: About 90% of time is used in making posets from digraphs.



---

archive/issue_comments_184616.json:
```json
{
    "body": "File from Brinkmann. Not GPL!",
    "created_at": "2014-10-06T10:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184616",
    "user": "https://github.com/jm58660"
}
```

File from Brinkmann. Not GPL!



---

archive/issue_comments_184617.json:
```json
{
    "body": "<a id='comment:11'></a>Attachment [poset_package.zip](tarball://root/attachments/some-uuid/ticket14110/poset_package.zip) by @jm58660 created at 2014-10-06 11:05:46\n\nI attached the code I got from Brinkmann. It contains a slightly modified version of nauty; hence copyright is free \"- - with the exception of sale for profit or application with nontrivial military significance.\" So it must be made to an optional package.\n\nIt compiles with `gcc -O4 -o /tmp/posets posets.c nauty_poset.c nautil_poset.c`. Code to use it in non-optimal way seems to be quite easy:\n\n```\nimport subprocess\ndef generate_posets(n):  # Add check for the argument etc.\n    cmd=[\"/tmp/posets\"]\n    args=[str(n), 'o']\n    sp=subprocess.Popen(cmd+args, shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, close_fds=True)\n    reader=iter(lambda: sp.stdout.read(2+2*n), '')\n    while True:\n        bin=reader.next()[2:]\n        L=[]\n        for i in range(0, n):\n            t=ord(bin[1+2*i])*256+ord(bin[2*i])\n            for j in range(0, n):\n                if (t << j) & 32768:\n                    L.append((i,j))\n        G=DiGraph()\n        G.add_vertices(range(0, n))\n        G.add_edges(L)\n        yield Poset(G, facade = True)\n```\n\nThere is much to make it even faster: for example to check linear extension and use FinitePoset directly, or even add to static sparse graphs an initializer that takes plain list as argument.",
    "created_at": "2014-10-06T11:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184617",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:11'></a>Attachment [poset_package.zip](tarball://root/attachments/some-uuid/ticket14110/poset_package.zip) by @jm58660 created at 2014-10-06 11:05:46

I attached the code I got from Brinkmann. It contains a slightly modified version of nauty; hence copyright is free "- - with the exception of sale for profit or application with nontrivial military significance." So it must be made to an optional package.

It compiles with `gcc -O4 -o /tmp/posets posets.c nauty_poset.c nautil_poset.c`. Code to use it in non-optimal way seems to be quite easy:

```
import subprocess
def generate_posets(n):  # Add check for the argument etc.
    cmd=["/tmp/posets"]
    args=[str(n), 'o']
    sp=subprocess.Popen(cmd+args, shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, close_fds=True)
    reader=iter(lambda: sp.stdout.read(2+2*n), '')
    while True:
        bin=reader.next()[2:]
        L=[]
        for i in range(0, n):
            t=ord(bin[1+2*i])*256+ord(bin[2*i])
            for j in range(0, n):
                if (t << j) & 32768:
                    L.append((i,j))
        G=DiGraph()
        G.add_vertices(range(0, n))
        G.add_edges(L)
        yield Poset(G, facade = True)
```

There is much to make it even faster: for example to check linear extension and use FinitePoset directly, or even add to static sparse graphs an initializer that takes plain list as argument.



---

archive/issue_comments_184618.json:
```json
{
    "body": "<a id='comment:12'></a>First test of packing files to .spkg is now attached to this ticket. Needs to add license information etc. Also I will do a test file and one line test script to check output.\n\nHowever, now somebody could test if also 32-bit Linux and Mac OS X are able to install this.\n\nLine `cmd=[\"/tmp/posets\"]` must be changed to `cmd=[sage.env.SAGE_LOCAL+\"/bin/genposets\"]`.",
    "created_at": "2014-10-08T20:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184618",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:12'></a>First test of packing files to .spkg is now attached to this ticket. Needs to add license information etc. Also I will do a test file and one line test script to check output.

However, now somebody could test if also 32-bit Linux and Mac OS X are able to install this.

Line `cmd=["/tmp/posets"]` must be changed to `cmd=[sage.env.SAGE_LOCAL+"/bin/genposets"]`.



---

archive/issue_comments_184619.json:
```json
{
    "body": "<a id='comment:13'></a>What should be the interface for this? If the package is installed, should `Posets(n)` use it automatically? What if we later got algorithm for generating for example all lattices or all modular lattices? Maybe this could be something like\n\n`Posets.PosetGenerator(n, properties='all')`\n\nAnd then later we could have something like `properties='lattice'`. Same arguments could be available also on `Posets.RandomPoset()`. Plain `Posets(n)` could be modified to use this, if the package is available.",
    "created_at": "2014-10-09T07:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184619",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:13'></a>What should be the interface for this? If the package is installed, should `Posets(n)` use it automatically? What if we later got algorithm for generating for example all lattices or all modular lattices? Maybe this could be something like

`Posets.PosetGenerator(n, properties='all')`

And then later we could have something like `properties='lattice'`. Same arguments could be available also on `Posets.RandomPoset()`. Plain `Posets(n)` could be modified to use this, if the package is available.



---

archive/issue_comments_184620.json:
```json
{
    "body": "<a id='comment:14'></a>I asked from Brendan McKay \"Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?\" and he answered: \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\n\nAnother thing, somebody using Mac should check if this compiles. And answer my last question.",
    "created_at": "2014-10-30T14:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184620",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:14'></a>I asked from Brendan McKay "Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?" and he answered: "It applies to all of the nauty files, but for incorporation into Sage you can ignore it.

Another thing, somebody using Mac should check if this compiles. And answer my last question.



---

archive/issue_comments_184621.json:
```json
{
    "body": "<a id='comment:15'></a>Note that `nauty` is already an optional Sage package, in old-spkg-style format : http://sagemath.org/packages/optional/",
    "created_at": "2014-11-25T11:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184621",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:15'></a>Note that `nauty` is already an optional Sage package, in old-spkg-style format : http://sagemath.org/packages/optional/



---

archive/issue_comments_184622.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 tmonteil]:\n> Note that `nauty` is already an optional Sage package\n\n\nTrue, but I think that it does not contain a code for generating posets.\n\nOr do you mean to append this poset generation to nauty package?",
    "created_at": "2014-11-26T12:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184622",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:16'></a>Replying to [comment:15 tmonteil]:
> Note that `nauty` is already an optional Sage package


True, but I think that it does not contain a code for generating posets.

Or do you mean to append this poset generation to nauty package?



---

archive/issue_comments_184623.json:
```json
{
    "body": "<a id='comment:17'></a>> > Note that `nauty` is already an optional Sage package\n\n> \n> True, but I think that it does not contain a code for generating posets.\n\n\nIndeed. Do you think is is possible to rely on the existing nauty package for the nauty-part, and only add the poset-specific stuff ? Maybe it does not worth the work if the nauty part is too modified and is a small part of posetgen.\n\nAlso, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?\n\n\n> Or do you mean to append this poset generation to nauty package?\n\n\nDefinitely not, i think we should keep upstream tarball's integrity as much as possible (in particular moving nauty to the new spkg layout could be nice).",
    "created_at": "2014-11-26T13:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184623",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:17'></a>> > Note that `nauty` is already an optional Sage package

> 
> True, but I think that it does not contain a code for generating posets.


Indeed. Do you think is is possible to rely on the existing nauty package for the nauty-part, and only add the poset-specific stuff ? Maybe it does not worth the work if the nauty part is too modified and is a small part of posetgen.

Also, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?


> Or do you mean to append this poset generation to nauty package?


Definitely not, i think we should keep upstream tarball's integrity as much as possible (in particular moving nauty to the new spkg layout could be nice).



---

archive/issue_comments_184624.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 tmonteil]:\n> Do you think is is possible to rely on the existing nauty package for the nauty-part, and only add the poset-specific stuff ? Maybe it does not worth the work if the nauty part is too modified and is a small part of posetgen.\n\n\n`nauty_poset.c` starts with \"modified by Gunnar Brinkmann for use with posets.\" Hence I guess it is inpractical to merge.\n\nWhole code for poset generation is about 7000 lines, so there is not much space to save.\n\n> Also, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?\n\n\nI haven't asked that. But if they are not going to maintain poset code, then what difference would that do?",
    "created_at": "2014-11-26T13:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184624",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:18'></a>Replying to [comment:17 tmonteil]:
> Do you think is is possible to rely on the existing nauty package for the nauty-part, and only add the poset-specific stuff ? Maybe it does not worth the work if the nauty part is too modified and is a small part of posetgen.


`nauty_poset.c` starts with "modified by Gunnar Brinkmann for use with posets." Hence I guess it is inpractical to merge.

Whole code for poset generation is about 7000 lines, so there is not much space to save.

> Also, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?


I haven't asked that. But if they are not going to maintain poset code, then what difference would that do?



---

archive/issue_comments_184625.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 jmantysalo]:\n> `nauty_poset.c` starts with \"modified by Gunnar Brinkmann for use with posets.\" Hence I guess it is inpractical to merge.\n> \n> Whole code for poset generation is about 7000 lines, so there is not much space to save.\n> \n\n\nOK, i was just asking to avoid code duplication (especially if was have to patch it).\n\n> > Also, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?\n\n> \n> I haven't asked that. But if they are not going to maintain poset code, then what difference would that do?\n\n\nUpstream will be that trac ticket. And each modified version (e.g. to compile on particular architecture) will become the next upstream without clear distinction.\n\nHaving a well identified upstream source whose checksum can be checked by anyone is preferable. If i come with a modified code that is attributed to someone else, there is no way to check my modifications (disclaimer: i am not insinuating anything with respect to the current package !). The new layout upstream-unmodified-checkable-source + downstream-readable-patches makes things more clear.",
    "created_at": "2014-11-26T14:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184625",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:19'></a>Replying to [comment:18 jmantysalo]:
> `nauty_poset.c` starts with "modified by Gunnar Brinkmann for use with posets." Hence I guess it is inpractical to merge.
> 
> Whole code for poset generation is about 7000 lines, so there is not much space to save.
> 


OK, i was just asking to avoid code duplication (especially if was have to patch it).

> > Also, do you think upstream could officially distribute its poset code (within nauty or in a separate tarball) ?

> 
> I haven't asked that. But if they are not going to maintain poset code, then what difference would that do?


Upstream will be that trac ticket. And each modified version (e.g. to compile on particular architecture) will become the next upstream without clear distinction.

Having a well identified upstream source whose checksum can be checked by anyone is preferable. If i come with a modified code that is attributed to someone else, there is no way to check my modifications (disclaimer: i am not insinuating anything with respect to the current package !). The new layout upstream-unmodified-checkable-source + downstream-readable-patches makes things more clear.



---

archive/issue_comments_184626.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:12 jmantysalo]:\n> However, now somebody could test if also 32-bit Linux and Mac OS X are able to install this.\n\n\nThis works for me (in the sense : i can compile and run the program, i did not check the results) on Linux 32 bits (Debian wheezy).\n\nHowever, i can not run the tests because of the `#!/usr/bin/sh` at the beginning of `spkg-check` (note that you used `#!/bin/sh` in `spkg-install`). Perhaps could you use `#!/usr/bin/env sh` instead.\n\nAlso, it is unlikely this test will work since `spkg-install` creates a binary named `posetgen` and `spkg-check` calls a binary named `genposets`.",
    "created_at": "2014-11-26T14:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184626",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:20'></a>Replying to [comment:12 jmantysalo]:
> However, now somebody could test if also 32-bit Linux and Mac OS X are able to install this.


This works for me (in the sense : i can compile and run the program, i did not check the results) on Linux 32 bits (Debian wheezy).

However, i can not run the tests because of the `#!/usr/bin/sh` at the beginning of `spkg-check` (note that you used `#!/bin/sh` in `spkg-install`). Perhaps could you use `#!/usr/bin/env sh` instead.

Also, it is unlikely this test will work since `spkg-install` creates a binary named `posetgen` and `spkg-check` calls a binary named `genposets`.



---

archive/issue_comments_184627.json:
```json
{
    "body": "<a id='comment:21'></a>Attachment [posetgen.spkg](tarball://root/attachments/some-uuid/ticket14110/posetgen.spkg) by @jm58660 created at 2015-06-03 17:21:48\n\nI changed package file. Hope it works now.",
    "created_at": "2015-06-03T17:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184627",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:21'></a>Attachment [posetgen.spkg](tarball://root/attachments/some-uuid/ticket14110/posetgen.spkg) by @jm58660 created at 2015-06-03 17:21:48

I changed package file. Hope it works now.



---

archive/issue_comments_184628.json:
```json
{
    "body": "<a id='comment:22'></a>Just an update on [comment:15]: since then, `nauty` has become a new-style package (#18425).",
    "created_at": "2015-06-04T07:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184628",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>Just an update on [comment:15]: since then, `nauty` has become a new-style package (#18425).



---

archive/issue_comments_184629.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:14 jmantysalo]:\n> I asked from Brendan McKay \"Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?\" and he answered: \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\n\n\nAny idea what \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it\" actually means? The problem is that it really needs to be GPL v3 to be standard in Sage. And once it's GPL, it's GPL for everybody, not just for Sage.\n\nThe \"sale for profit\" isn't an unlikely scenario given William Stein's plans to make money from SMC.\n\nFinal remark: it's allowed by the GPL to run Sage and nauty as separate programs (using Python's `subprocess` for example), but not to link nauty as a library.",
    "created_at": "2015-06-04T07:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184629",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Replying to [comment:14 jmantysalo]:
> I asked from Brendan McKay "Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?" and he answered: "It applies to all of the nauty files, but for incorporation into Sage you can ignore it.


Any idea what "It applies to all of the nauty files, but for incorporation into Sage you can ignore it" actually means? The problem is that it really needs to be GPL v3 to be standard in Sage. And once it's GPL, it's GPL for everybody, not just for Sage.

The "sale for profit" isn't an unlikely scenario given William Stein's plans to make money from SMC.

Final remark: it's allowed by the GPL to run Sage and nauty as separate programs (using Python's `subprocess` for example), but not to link nauty as a library.



---

archive/issue_comments_184630.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:23 jdemeyer]:\n\n> Any idea what \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it\" actually means? The problem is that it really needs to be GPL v3 to be standard in Sage. And once it's GPL, it's GPL for everybody, not just for Sage.\n> \n> The \"sale for profit\" isn't an unlikely scenario given William Stein's plans to make money from SMC.\n\n\nAnd even restriction to non-military applications is a problem. Who can be *sure* that there will never be any military application for posets?\n\nDo we have someone who is better to discuss with McKay about these license issues?",
    "created_at": "2015-06-05T14:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184630",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:24'></a>Replying to [comment:23 jdemeyer]:

> Any idea what "It applies to all of the nauty files, but for incorporation into Sage you can ignore it" actually means? The problem is that it really needs to be GPL v3 to be standard in Sage. And once it's GPL, it's GPL for everybody, not just for Sage.
> 
> The "sale for profit" isn't an unlikely scenario given William Stein's plans to make money from SMC.


And even restriction to non-military applications is a problem. Who can be *sure* that there will never be any military application for posets?

Do we have someone who is better to discuss with McKay about these license issues?



---

archive/issue_comments_184631.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:14 jmantysalo]:\n> I asked from Brendan McKay \"Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?\" and he answered: \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\n\n\nCan you give the complete contents of this email exchange with McKay?",
    "created_at": "2015-06-29T14:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184631",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [comment:14 jmantysalo]:
> I asked from Brendan McKay "Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?" and he answered: "It applies to all of the nauty files, but for incorporation into Sage you can ignore it.


Can you give the complete contents of this email exchange with McKay?



---

archive/issue_comments_184632.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:24 jmantysalo]:\n> Do we have someone who is better to discuss with McKay about these license issues?\n\nThere is not really that much to discuss. Either McKay wants to relicense nauty under GPL v3 or he does not want that. Only in the former case can we include it as standard Sage package.",
    "created_at": "2015-06-29T14:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184632",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>Replying to [comment:24 jmantysalo]:
> Do we have someone who is better to discuss with McKay about these license issues?

There is not really that much to discuss. Either McKay wants to relicense nauty under GPL v3 or he does not want that. Only in the former case can we include it as standard Sage package.



---

archive/issue_comments_184633.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:25 jdemeyer]:\n> Replying to [comment:14 jmantysalo]:\n> > I asked from Brendan McKay \"Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?\" and he answered: \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\n\n> \n> Can you give the complete contents of this email exchange with McKay?\n\n\nI already gave... (Except a trivial ping-message and a start \"Sorry, I forgot to answer.\")",
    "created_at": "2015-06-29T14:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184633",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:27'></a>Replying to [comment:25 jdemeyer]:
> Replying to [comment:14 jmantysalo]:
> > I asked from Brendan McKay "Nauty.h contains copyright with 'exception of sale for profit or application with nontrivial military significance.' Does this apply to whole package?" and he answered: "It applies to all of the nauty files, but for incorporation into Sage you can ignore it.

> 
> Can you give the complete contents of this email exchange with McKay?


I already gave... (Except a trivial ping-message and a start "Sorry, I forgot to answer.")



---

archive/issue_comments_184634.json:
```json
{
    "body": "<a id='comment:28'></a>The sentence \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\" really is the whole answer? :-)\n\nGiven that he is OK with Nauty being in Sage and given that people might use Sage commercially or for military applications, this should logically mean that he would agree to license Nauty under the GPL v3. Somebody just needs to ask...",
    "created_at": "2015-06-29T14:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184634",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>The sentence "It applies to all of the nauty files, but for incorporation into Sage you can ignore it." really is the whole answer? :-)

Given that he is OK with Nauty being in Sage and given that people might use Sage commercially or for military applications, this should logically mean that he would agree to license Nauty under the GPL v3. Somebody just needs to ask...



---

archive/issue_comments_184635.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 jdemeyer]:\n> The sentence \"It applies to all of the nauty files, but for incorporation into Sage you can ignore it.\" really is the whole answer? :-)\n\n\nYes.\n\n> Given that he is OK with Nauty being in Sage and given that people might use Sage commercially or for military applications, this should logically mean that he would agree to license Nauty under the GPL v3. Somebody just needs to ask...\n\n\nAnd what is more: Sage is free, so I can take any part of Sage and use it as a part of some other (free) program that is used to prepare against another shelling of Mainila. Free software can be splitted, not only combined.\n\nI am quite sure that he did not think about that. Not in a way or another.",
    "created_at": "2015-06-29T14:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184635",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:29'></a>Replying to [comment:28 jdemeyer]:
> The sentence "It applies to all of the nauty files, but for incorporation into Sage you can ignore it." really is the whole answer? :-)


Yes.

> Given that he is OK with Nauty being in Sage and given that people might use Sage commercially or for military applications, this should logically mean that he would agree to license Nauty under the GPL v3. Somebody just needs to ask...


And what is more: Sage is free, so I can take any part of Sage and use it as a part of some other (free) program that is used to prepare against another shelling of Mainila. Free software can be splitted, not only combined.

I am quite sure that he did not think about that. Not in a way or another.



---

archive/issue_comments_184636.json:
```json
{
    "body": "<a id='comment:30'></a>About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.",
    "created_at": "2015-10-29T08:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184636",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:30'></a>About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.



---

archive/issue_comments_184637.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 jmantysalo]:\n> About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.\n\n\nJeroen, isn't Brinkmann your colleague at UGent? Could you perhaps buy him a biertje so that he releases his related code under GPL, too?",
    "created_at": "2015-10-29T09:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184637",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>Replying to [comment:30 jmantysalo]:
> About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.


Jeroen, isn't Brinkmann your colleague at UGent? Could you perhaps buy him a biertje so that he releases his related code under GPL, too?



---

archive/issue_comments_184638.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 dimpase]:\n> Replying to [comment:30 jmantysalo]:\n> > About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.\n\n> \n> Jeroen, isn't Brinkmann your colleague at UGent?\n\n\nWell, he's in a different department, but I could ask him, yes.",
    "created_at": "2015-10-29T10:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184638",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>Replying to [comment:31 dimpase]:
> Replying to [comment:30 jmantysalo]:
> > About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.

> 
> Jeroen, isn't Brinkmann your colleague at UGent?


Well, he's in a different department, but I could ask him, yes.



---

archive/issue_comments_184639.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:32 jdemeyer]:\n> Replying to [comment:31 dimpase]:\n> > Replying to [comment:30 jmantysalo]:\n> > > About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.\n\n> > \n> > Jeroen, isn't Brinkmann your colleague at UGent?\n\n> \n> Well, he's in a different department, but I could ask him, yes.\n\n\nI forwarded you my latest email to him.",
    "created_at": "2015-10-29T11:03:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184639",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>Replying to [comment:32 jdemeyer]:
> Replying to [comment:31 dimpase]:
> > Replying to [comment:30 jmantysalo]:
> > > About license: Dima has asked McKay, who said that it is ok for him, IF Brinkmann do not complain. So we still wait to see if this can be added as a standard package.

> > 
> > Jeroen, isn't Brinkmann your colleague at UGent?

> 
> Well, he's in a different department, but I could ask him, yes.


I forwarded you my latest email to him.



---

archive/issue_comments_184640.json:
```json
{
    "body": "<a id='comment:34'></a>We can proceed to make posetgen a standard package, see https://groups.google.com/d/msg/sage-devel/VuNMvS9jyH8/fcUhKmraBAAJ",
    "created_at": "2015-11-23T08:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184640",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:34'></a>We can proceed to make posetgen a standard package, see https://groups.google.com/d/msg/sage-devel/VuNMvS9jyH8/fcUhKmraBAAJ



---

archive/issue_comments_184641.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.\n \n+B. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179\n+\n+https://doi.org/10.1023/A:1016543307592\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-01-04T18:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184641",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
+Currently (sage 5.6), Sage generates the posets on n elements by generating all digraphs with n vertices and checking which of those give posets. A paper of Brinkmann and McKay gives an algorithm for generating posets which they used to generate posets up to 16. Sage uses a related algorithm of McKay to generate the digraphs.
 
+B. D. McKay and G. Brinkmann, Posets on up to 16 points, Order, 19 (2002) 147-179
+
+https://doi.org/10.1023/A:1016543307592
 
 Comment: 1
 
``````




---

archive/issue_events_039778.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-04T18:13:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39778"
}
```



---

archive/issue_events_039779.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-01-04T18:13:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39779"
}
```



---

archive/issue_comments_184642.json:
```json
{
    "body": "<a id='comment:36'></a>Recently active topic on Math Overflow.\n\n- [Math Overflow question 375031: Minimal poset containing all 5-posets](https://mathoverflow.net/q/375031)",
    "created_at": "2021-01-08T16:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14110#issuecomment-184642",
    "user": "https://github.com/slel"
}
```

<a id='comment:36'></a>Recently active topic on Math Overflow.

- [Math Overflow question 375031: Minimal poset containing all 5-posets](https://mathoverflow.net/q/375031)



---

archive/issue_events_039780.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39780"
}
```



---

archive/issue_events_039781.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39781"
}
```



---

archive/issue_events_039782.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39782"
}
```



---

archive/issue_events_039783.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39783"
}
```



---

archive/issue_events_039784.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39784"
}
```



---

archive/issue_events_039785.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39785"
}
```



---

archive/issue_events_039786.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39786"
}
```



---

archive/issue_events_039787.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14110",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14110#event-39787"
}
```
