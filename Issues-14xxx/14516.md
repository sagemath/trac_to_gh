# Issue 14516: Refactoring of crystals for speedup

archive/issues_014312.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "In order to speed up many of the crystals computations, I'm proposing the following:\n\n- Cythonize `CrystalOfLetters`\n- Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list\n- Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)\n- Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.\n\nSee #14686 for a followup.\n\nApply:\n\n* [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)\n\nDepends on #2023\nDepends on #14402\nDepends on #14413\nDepends on #14143\nDepends on #12940\n\nCC:  @sagetrac-sage-combinat @bsalisbury1 @anneschilling @nthiery\n\nKeywords: **crystals speedup, days49**\n\nReviewer: **Anne Schilling**\n\nAuthor: **Travis Scrimshaw**\n\nMerged: **sage-5.12.beta1**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14516_\n\n",
    "closed_at": "2013-08-16T21:11:33Z",
    "created_at": "2013-05-01T23:35:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Refactoring of crystals for speedup",
    "type": "issue",
    "updated_at": "2013-08-16T21:11:33Z",
    "url": "https://github.com/sagemath/sage/issues/14516",
    "user": "https://github.com/tscrim"
}
```
In order to speed up many of the crystals computations, I'm proposing the following:

- Cythonize `CrystalOfLetters`
- Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list
- Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)
- Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.

See #14686 for a followup.

Apply:

* [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)

Depends on #2023
Depends on #14402
Depends on #14413
Depends on #14143
Depends on #12940

CC:  @sagetrac-sage-combinat @bsalisbury1 @anneschilling @nthiery

Keywords: **crystals speedup, days49**

Reviewer: **Anne Schilling**

Author: **Travis Scrimshaw**

Merged: **sage-5.12.beta1**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/14516_





---

archive/issue_events_206331.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-05-01T23:35:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206331"
}
```



---

archive/issue_events_206332.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-05-01T23:35:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206332"
}
```



---

archive/issue_events_206333.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-05-01T23:35:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206333"
}
```



---

archive/issue_events_206334.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-05-01T23:35:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206334"
}
```



---

archive/issue_events_206335.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2013-05-01T23:35:51Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "subject": "https://github.com/tscrim",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206335"
}
```



---

archive/issue_comments_175665.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHere are some timings.\n\nWith the patch:\n\n```\nsage: B = InfinityCrystalOfTableaux(['B',3])\nsage: S = B.subcrystal(max_depth=4)\nsage: %time G = B.digraph(subset=S)\nCPU times: user 19.55 s, sys: 0.62 s, total: 20.17 s\nWall time: 21.80 s\n\nsage: C = CrystalOfTableaux(['D',4], shape=[2,1])\nsage: %time G = C.digraph()\nCPU times: user 0.30 s, sys: 0.06 s, total: 0.36 s\nWall time: 0.45 s\n```\n\nBefore:\n\n```\nsage: B = InfinityCrystalOfTableaux(['B',3])\nsage: S = B.subcrystal(max_depth=4)\nsage: %time G = B.digraph(subset=S)\nCPU times: user 48.83 s, sys: 1.42 s, total: 50.24 s\nWall time: 58.49 s\n\nsage: C = CrystalOfTableaux(['D',4], shape=[2,1])\nsage: %time G = C.digraph()        \nCPU times: user 0.50 s, sys: 0.05 s, total: 0.54 s\nWall time: 0.66 s\n```",
    "created_at": "2013-05-02T00:16:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175665",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:1" align="right">comment:1</div>

Here are some timings.

With the patch:

```
sage: B = InfinityCrystalOfTableaux(['B',3])
sage: S = B.subcrystal(max_depth=4)
sage: %time G = B.digraph(subset=S)
CPU times: user 19.55 s, sys: 0.62 s, total: 20.17 s
Wall time: 21.80 s

sage: C = CrystalOfTableaux(['D',4], shape=[2,1])
sage: %time G = C.digraph()
CPU times: user 0.30 s, sys: 0.06 s, total: 0.36 s
Wall time: 0.45 s
```

Before:

```
sage: B = InfinityCrystalOfTableaux(['B',3])
sage: S = B.subcrystal(max_depth=4)
sage: %time G = B.digraph(subset=S)
CPU times: user 48.83 s, sys: 1.42 s, total: 50.24 s
Wall time: 58.49 s

sage: C = CrystalOfTableaux(['D',4], shape=[2,1])
sage: %time G = C.digraph()        
CPU times: user 0.50 s, sys: 0.05 s, total: 0.54 s
Wall time: 0.66 s
```



---

archive/issue_comments_175666.json:
```json
{
    "body": "Changed dependencies from **#14402 #2023** to **#14402 #14413 #14143 #2023**",
    "created_at": "2013-05-02T00:16:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175666",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#14402 #2023** to **#14402 #14413 #14143 #2023**



---

archive/issue_comments_175667.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n In order to speed up many of the crystals computations, I'm proposing the following:\n \n - Cythonize `CrystalOfLetters`\n-- Instead of e, f, epsilon, phi checking the index set each time, these functions will check to make sure i is in the index set, then call _e, _f, _epsilon, _phi which assume i is valid input and respectively call the private methods.\n-- Make index_set a cached method. Subsequently this requires it to be returned as a tuple instead of a list\n+- Instead of `e()`, `f()`, `epsilon()`, `phi()` checking the index set each time, these functions will check to make sure i is in the index set, then call `_e()`, `_f()`, `_epsilon()`, `_phi()` which assume i is valid input and respectively call the private methods.\n+- Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list\n+- Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)\n+- Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.\n \n``````\n",
    "created_at": "2013-05-02T22:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175667",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
 In order to speed up many of the crystals computations, I'm proposing the following:
 
 - Cythonize `CrystalOfLetters`
-- Instead of e, f, epsilon, phi checking the index set each time, these functions will check to make sure i is in the index set, then call _e, _f, _epsilon, _phi which assume i is valid input and respectively call the private methods.
-- Make index_set a cached method. Subsequently this requires it to be returned as a tuple instead of a list
+- Instead of `e()`, `f()`, `epsilon()`, `phi()` checking the index set each time, these functions will check to make sure i is in the index set, then call `_e()`, `_f()`, `_epsilon()`, `_phi()` which assume i is valid input and respectively call the private methods.
+- Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list
+- Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)
+- Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.
 
``````




---

archive/issue_events_206336.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-05-02T22:18:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206336"
}
```



---

archive/issue_comments_175668.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI'm also getting significant speedups now in creating `CrystalOfLetters` and doctests for `tensor_product.py` and `kirillov_reshetikhin.py`:\n\n```\nsage: %time C = CrystalOfLetters(['D',100])\nCPU times: user 0.84 s, sys: 0.24 s, total: 1.08 s\nWall time: 1.67 s\n\nsage -t tensor_product.py\n    [349 tests, 13.05 s]\nsage -t kirillov_reshetikhin.py\n    [653 tests, 30.51 s]\n```\nBefore:\n\n```\nsage: %time C = CrystalOfLetters(['D',100])\nCPU times: user 2.33 s, sys: 0.42 s, total: 2.76 s\nWall time: 3.58 s\n\nsage -t tensor_product.py\n    [349 tests, 14.60 s]\nsage -t kirillov_reshetikhin.py\n    [653 tests, 47.96 s]\n```",
    "created_at": "2013-05-02T22:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175668",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">comment:2</div>

I'm also getting significant speedups now in creating `CrystalOfLetters` and doctests for `tensor_product.py` and `kirillov_reshetikhin.py`:

```
sage: %time C = CrystalOfLetters(['D',100])
CPU times: user 0.84 s, sys: 0.24 s, total: 1.08 s
Wall time: 1.67 s

sage -t tensor_product.py
    [349 tests, 13.05 s]
sage -t kirillov_reshetikhin.py
    [653 tests, 30.51 s]
```
Before:

```
sage: %time C = CrystalOfLetters(['D',100])
CPU times: user 2.33 s, sys: 0.42 s, total: 2.76 s
Wall time: 3.58 s

sage -t tensor_product.py
    [349 tests, 14.60 s]
sage -t kirillov_reshetikhin.py
    [653 tests, 47.96 s]
```



---

archive/issue_comments_175669.json:
```json
{
    "body": "Changed dependencies from **#14402 #14413 #14143 #2023** to **#2023 #14402 #14413 #14143 #14573**",
    "created_at": "2013-06-02T01:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175669",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#14402 #14413 #14143 #2023** to **#2023 #14402 #14413 #14143 #14573**



---

archive/issue_comments_175670.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,9 @@\n In order to speed up many of the crystals computations, I'm proposing the following:\n \n - Cythonize `CrystalOfLetters`\n-- Instead of `e()`, `f()`, `epsilon()`, `phi()` checking the index set each time, these functions will check to make sure i is in the index set, then call `_e()`, `_f()`, `_epsilon()`, `_phi()` which assume i is valid input and respectively call the private methods.\n - Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list\n - Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)\n - Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.\n \n+See #14686 for a followup.\n+\n``````\n",
    "created_at": "2013-06-04T23:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175670",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,9 @@
 In order to speed up many of the crystals computations, I'm proposing the following:
 
 - Cythonize `CrystalOfLetters`
-- Instead of `e()`, `f()`, `epsilon()`, `phi()` checking the index set each time, these functions will check to make sure i is in the index set, then call `_e()`, `_f()`, `_epsilon()`, `_phi()` which assume i is valid input and respectively call the private methods.
 - Make `index_set()` a cached method. Subsequently this requires it to be returned as a tuple instead of a list
 - Make different letters classes, one for integers (classical types), one for tuples (exceptional/spin)
 - Store by caching result of `_element_constructor_()` the elements of `CrystalOfLetters`.
 
+See #14686 for a followup.
+
``````




---

archive/issue_events_206337.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-06-04T23:56:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206337"
}
```



---

archive/issue_events_206338.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-06-04T23:56:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206338"
}
```



---

archive/issue_comments_175671.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI'll upload the split patch shortly and check to see if it can commute pass #14143.",
    "created_at": "2013-06-04T23:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175671",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

I'll upload the split patch shortly and check to see if it can commute pass #14143.



---

archive/issue_comments_175672.json:
```json
{
    "body": "Changed dependencies from **#2023 #14402 #14413 #14143 #14573** to **#2023 #14402 #14413 #14143**",
    "created_at": "2013-06-04T23:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175672",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#2023 #14402 #14413 #14143 #14573** to **#2023 #14402 #14413 #14143**



---

archive/issue_events_206339.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-06-05T14:49:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206339"
}
```



---

archive/issue_events_206340.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-06-05T14:49:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206340"
}
```



---

archive/issue_comments_175673.json:
```json
{
    "body": "Changed dependencies from **#2023 #14402 #14413 #14143** to **#2023 #14402 #14413**",
    "created_at": "2013-06-05T14:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175673",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#2023 #14402 #14413 #14143** to **#2023 #14402 #14413**



---

archive/issue_comments_175674.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nNew patch which does not change the functions and does not depend on #14143. The functions are changed in #14686. Timings to come shortly.",
    "created_at": "2013-06-05T14:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175674",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

New patch which does not change the functions and does not depend on #14143. The functions are changed in #14686. Timings to come shortly.



---

archive/issue_comments_175675.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWith patch:\n\n```\nsage: %time C = CrystalOfLetters(['D',100])\nCPU times: user 1.54 s, sys: 0.03 s, total: 1.56 s\nWall time: 1.72 s\n\nsage: B = InfinityCrystalOfTableaux(['B',3])\nsage: S = B.subcrystal(max_depth=4)\nsage: %time G = B.digraph(subset=S)\nCPU times: user 28.20 s, sys: 0.03 s, total: 28.23 s\nWall time: 28.62 s\n\nsage: C = CrystalOfTableaux(['D',4], shape=[2,1])\nsage: %time G = C.digraph()                \nCPU times: user 0.33 s, sys: 0.00 s, total: 0.34 s\nWall time: 0.34 s\n```\nBefore:\n\n```\nsage: %time C = CrystalOfLetters(['D',100])\nCPU times: user 1.84 s, sys: 0.02 s, total: 1.86 s\nWall time: 2.00 s\n\nsage: B = InfinityCrystalOfTableaux(['B',3])\nsage: S = B.subcrystal(max_depth=4)\nsage: sage: %time G = B.digraph(subset=S)\nCPU times: user 28.96 s, sys: 0.03 s, total: 28.99 s\nWall time: 29.94 s\n\nsage: C = CrystalOfTableaux(['D',4], shape=[2,1])\nsage: %time G = C.digraph()\nCPU times: user 0.39 s, sys: 0.01 s, total: 0.40 s\nWall time: 0.39 s\n```\n\nSo currently I'm seeing small performance gains, the bigger ones are likely going to come from #14686.",
    "created_at": "2013-06-05T17:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175675",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

With patch:

```
sage: %time C = CrystalOfLetters(['D',100])
CPU times: user 1.54 s, sys: 0.03 s, total: 1.56 s
Wall time: 1.72 s

sage: B = InfinityCrystalOfTableaux(['B',3])
sage: S = B.subcrystal(max_depth=4)
sage: %time G = B.digraph(subset=S)
CPU times: user 28.20 s, sys: 0.03 s, total: 28.23 s
Wall time: 28.62 s

sage: C = CrystalOfTableaux(['D',4], shape=[2,1])
sage: %time G = C.digraph()                
CPU times: user 0.33 s, sys: 0.00 s, total: 0.34 s
Wall time: 0.34 s
```
Before:

```
sage: %time C = CrystalOfLetters(['D',100])
CPU times: user 1.84 s, sys: 0.02 s, total: 1.86 s
Wall time: 2.00 s

sage: B = InfinityCrystalOfTableaux(['B',3])
sage: S = B.subcrystal(max_depth=4)
sage: sage: %time G = B.digraph(subset=S)
CPU times: user 28.96 s, sys: 0.03 s, total: 28.99 s
Wall time: 29.94 s

sage: C = CrystalOfTableaux(['D',4], shape=[2,1])
sage: %time G = C.digraph()
CPU times: user 0.39 s, sys: 0.01 s, total: 0.40 s
Wall time: 0.39 s
```

So currently I'm seeing small performance gains, the bigger ones are likely going to come from #14686.



---

archive/issue_comments_175676.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHi Travis,\n\nThe two tests (with and without patch) do not seem to be the same!\n\nAnne",
    "created_at": "2013-06-05T17:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175676",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:8" align="right">comment:8</div>

Hi Travis,

The two tests (with and without patch) do not seem to be the same!

Anne



---

archive/issue_comments_175677.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n@anneschilling There was some omissions.\n\nNew version which fixes the pickling issues and should pass all doctests. #14143 does fix some of the doctests.",
    "created_at": "2013-06-17T10:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175677",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

@anneschilling There was some omissions.

New version which fixes the pickling issues and should pass all doctests. #14143 does fix some of the doctests.



---

archive/issue_comments_175678.json:
```json
{
    "body": "Changed dependencies from **#2023 #14402 #14413** to **#2023 #14402 #14413 #14143**",
    "created_at": "2013-06-17T10:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175678",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#2023 #14402 #14413** to **#2023 #14402 #14413 #14143**



---

archive/issue_comments_175679.json:
```json
{
    "body": "Reviewer: **Anne Schilling**",
    "created_at": "2013-06-23T19:01:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175679",
    "user": "https://github.com/anneschilling"
}
```

Reviewer: **Anne Schilling**



---

archive/issue_comments_175680.json:
```json
{
    "body": "Changed keywords from **crystals speedup** to **crystals speedup, days49**",
    "created_at": "2013-06-23T19:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175680",
    "user": "https://github.com/anneschilling"
}
```

Changed keywords from **crystals speedup** to **crystals speedup, days49**



---

archive/issue_comments_175681.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHi Travis,\n\nThe patch looks good (I put a reviewed patch on the sage-combinat queue). I am not so happy about the huge doc tests for __setstate__. As we discussed, perhaps just put a loads/dumps test?\n\nBest,\n\nAnne",
    "created_at": "2013-06-23T19:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175681",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:12" align="right">comment:12</div>

Hi Travis,

The patch looks good (I put a reviewed patch on the sage-combinat queue). I am not so happy about the huge doc tests for __setstate__. As we discussed, perhaps just put a loads/dumps test?

Best,

Anne



---

archive/issue_comments_175682.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nDone.",
    "created_at": "2013-06-23T19:23:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175682",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Done.



---

archive/issue_events_206341.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-23T19:25:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206341"
}
```



---

archive/issue_events_206342.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-06-23T19:25:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206342"
}
```



---

archive/issue_comments_175683.json:
```json
{
    "body": "Attachment: **[trac_14516-crystals_speedup-ts.2.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)**\n\nForgot to qrefresh...",
    "created_at": "2013-06-23T19:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175683",
    "user": "https://github.com/tscrim"
}
```

Attachment: **[trac_14516-crystals_speedup-ts.2.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)**

Forgot to qrefresh...



---

archive/issue_comments_175684.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nForgot to qrefresh.\n\nApply: trac_14516-crystals_speedup-ts.2.patch",
    "created_at": "2013-06-23T19:40:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175684",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Forgot to qrefresh.

Apply: trac_14516-crystals_speedup-ts.2.patch



---

archive/issue_comments_175685.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,6 @@\n \n See #14686 for a followup.\n \n+Apply:\n+\n+* [attachment: trac_14516-crystals_speedup-ts.2.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)\n``````\n",
    "created_at": "2013-06-23T19:40:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175685",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,6 @@
 
 See #14686 for a followup.
 
+Apply:
+
+* [attachment: trac_14516-crystals_speedup-ts.2.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)
``````




---

archive/issue_events_206343.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:41:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206343"
}
```



---

archive/issue_events_206344.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:41:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206344"
}
```



---

archive/issue_events_206345.json:
```json
{
    "actor": "https://github.com/jeffpferreira",
    "created_at": "2013-07-24T00:18:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206345"
}
```



---

archive/issue_events_206346.json:
```json
{
    "actor": "https://github.com/jeffpferreira",
    "created_at": "2013-07-24T00:18:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206346"
}
```



---

archive/issue_comments_175686.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI get a warning when building the doc:\n\n```\n[combinat ] docstring of sage.combinat.crystals.letters.CrystalOfLetters:21: WARNING: duplicate citation KN94, other instance in /Applications/sage/devel/sage/doc/en/reference/combinat/sage/combinat/crystals/infinity_crystals.rst\n```",
    "created_at": "2013-07-24T00:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175686",
    "user": "https://github.com/jeffpferreira"
}
```

<div id="comment:17" align="right">comment:17</div>

I get a warning when building the doc:

```
[combinat ] docstring of sage.combinat.crystals.letters.CrystalOfLetters:21: WARNING: duplicate citation KN94, other instance in /Applications/sage/devel/sage/doc/en/reference/combinat/sage/combinat/crystals/infinity_crystals.rst
```



---

archive/issue_comments_175687.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFixed. Thanks for catching that Jeff (I wish duplicate references would always show up every time you rebuild the doc instead of just the first time).\n\nFor patchbot:\n\nApply: trac_14516-crystals_speedup-ts.patch",
    "created_at": "2013-07-24T00:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175687",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Fixed. Thanks for catching that Jeff (I wish duplicate references would always show up every time you rebuild the doc instead of just the first time).

For patchbot:

Apply: trac_14516-crystals_speedup-ts.patch



---

archive/issue_comments_175688.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,4 @@\n \n Apply:\n \n-* [attachment: trac_14516-crystals_speedup-ts.2.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)\n+* [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)\n``````\n",
    "created_at": "2013-07-24T00:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175688",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,4 @@
 
 Apply:
 
-* [attachment: trac_14516-crystals_speedup-ts.2.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.2.patch.gz)
+* [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)
``````




---

archive/issue_events_206347.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-07-24T00:28:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206347"
}
```



---

archive/issue_events_206348.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-07-24T00:28:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206348"
}
```



---

archive/issue_comments_175689.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThere are doctest failures with #12940, please rebase:\n\n```\nsage -t devel/sage/sage/combinat/affine_permutation.py\n**********************************************************************\nFile \"devel/sage/sage/combinat/affine_permutation.py\", line 241, in sage.combinat.affine_permutation.AffinePermutation.index_set\nFailed example:\n    A.index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\nFile \"devel/sage/sage/combinat/affine_permutation.py\", line 2077, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set\nFailed example:\n    AffinePermutationGroup(['A',7,1]).index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\nFile \"devel/sage/sage/combinat/affine_permutation.py\", line 2088, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set\nFailed example:\n    AffinePermutationGroup(['A',7,1]).index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\n```",
    "created_at": "2013-07-30T14:47:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175689",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

There are doctest failures with #12940, please rebase:

```
sage -t devel/sage/sage/combinat/affine_permutation.py
**********************************************************************
File "devel/sage/sage/combinat/affine_permutation.py", line 241, in sage.combinat.affine_permutation.AffinePermutation.index_set
Failed example:
    A.index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
File "devel/sage/sage/combinat/affine_permutation.py", line 2077, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set
Failed example:
    AffinePermutationGroup(['A',7,1]).index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
File "devel/sage/sage/combinat/affine_permutation.py", line 2088, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set
Failed example:
    AffinePermutationGroup(['A',7,1]).index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
```



---

archive/issue_comments_175690.json:
```json
{
    "body": "Changed dependencies from **#2023 #14402 #14413 #14143** to **#2023, #14402, #14413, #14143, #12940**",
    "created_at": "2013-07-30T14:47:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175690",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#2023 #14402 #14413 #14143** to **#2023, #14402, #14413, #14143, #12940**



---

archive/issue_events_206349.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-30T14:47:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206349"
}
```



---

archive/issue_events_206350.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-30T14:47:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206350"
}
```



---

archive/issue_events_206351.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-08-01T01:37:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206351"
}
```



---

archive/issue_events_206352.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-08-01T01:37:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206352"
}
```



---

archive/issue_comments_175691.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nFixed:\n\n```\nsage -t affine_permutation.py\n    [335 tests, 28.87 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```\n\nFor patchbot:\n\nApply: trac_14516-crystals_speedup-ts.patch",
    "created_at": "2013-08-01T01:37:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175691",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Fixed:

```
sage -t affine_permutation.py
    [335 tests, 28.87 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```

For patchbot:

Apply: trac_14516-crystals_speedup-ts.patch



---

archive/issue_comments_175692.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAnne, could you do a double-check to make sure everything is consistent and works for you? Thanks.",
    "created_at": "2013-08-02T07:13:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175692",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Anne, could you do a double-check to make sure everything is consistent and works for you? Thanks.



---

archive/issue_comments_175693.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@tscrim](#comment:21):\n> Anne, could you do a double-check to make sure everything is consistent and works for you? Thanks.\n\nI still get the above mentioned errors:\n\n```\nsage -t affine_permutation.py\n**********************************************************************\nFile \"affine_permutation.py\", line 241, in sage.combinat.affine_permutation.AffinePermutation.index_set\nFailed example:\n    A.index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\nFile \"affine_permutation.py\", line 2077, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set\nFailed example:\n    AffinePermutationGroup(['A',7,1]).index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\nFile \"affine_permutation.py\", line 2088, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set\nFailed example:\n    AffinePermutationGroup(['A',7,1]).index_set()\nExpected:\n    [0, 1, 2, 3, 4, 5, 6, 7]\nGot:\n    (0, 1, 2, 3, 4, 5, 6, 7)\n**********************************************************************\n3 items had failures:\n   1 of   3 in sage.combinat.affine_permutation.AffinePermutation.index_set\n   1 of   2 in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set\n   1 of   2 in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set\n    [335 tests, 3 failures, 6.17 s]\n```\nDid you post an updated patch? I cannot see any mention of affine_permutation in your patch.\n\nAnne",
    "created_at": "2013-08-03T16:30:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175693",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@tscrim](#comment:21):
> Anne, could you do a double-check to make sure everything is consistent and works for you? Thanks.

I still get the above mentioned errors:

```
sage -t affine_permutation.py
**********************************************************************
File "affine_permutation.py", line 241, in sage.combinat.affine_permutation.AffinePermutation.index_set
Failed example:
    A.index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
File "affine_permutation.py", line 2077, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set
Failed example:
    AffinePermutationGroup(['A',7,1]).index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
File "affine_permutation.py", line 2088, in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set
Failed example:
    AffinePermutationGroup(['A',7,1]).index_set()
Expected:
    [0, 1, 2, 3, 4, 5, 6, 7]
Got:
    (0, 1, 2, 3, 4, 5, 6, 7)
**********************************************************************
3 items had failures:
   1 of   3 in sage.combinat.affine_permutation.AffinePermutation.index_set
   1 of   2 in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.index_set
   1 of   2 in sage.combinat.affine_permutation.AffinePermutationGroupGeneric.reflection_index_set
    [335 tests, 3 failures, 6.17 s]
```
Did you post an updated patch? I cannot see any mention of affine_permutation in your patch.

Anne



---

archive/issue_comments_175694.json:
```json
{
    "body": "Attachment: **[trac_14516-review-as.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)**",
    "created_at": "2013-08-03T17:05:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175694",
    "user": "https://github.com/anneschilling"
}
```

Attachment: **[trac_14516-review-as.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)**



---

archive/issue_comments_175695.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,4 @@\n Apply:\n \n * [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)\n+* [attachment: trac_14516-review-as.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)\n``````\n",
    "created_at": "2013-08-03T17:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175695",
    "user": "https://github.com/anneschilling"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,4 @@
 Apply:
 
 * [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)
+* [attachment: trac_14516-review-as.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)
``````




---

archive/issue_events_206353.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-08-03T17:05:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206353"
}
```



---

archive/issue_events_206354.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-08-03T17:05:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206354"
}
```



---

archive/issue_comments_175696.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,3 @@\n Apply:\n \n * [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)\n-* [attachment: trac_14516-review-as.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)\n``````\n",
    "created_at": "2013-08-05T23:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175696",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,3 @@
 Apply:
 
 * [attachment: trac_14516-crystals_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)
-* [attachment: trac_14516-review-as.patch](https://github.com/sagemath/sage/files/ticket14516/trac_14516-review-as.patch.gz)
``````




---

archive/issue_comments_175697.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAttachment: **[trac_14516-crystals_speedup-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)**\n\nHere's the fixed patch.\n\nFor patchbot:\n\nApply: trac_14516-crystals_speedup-ts.patch",
    "created_at": "2013-08-05T23:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175697",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">comment:24</div>

Attachment: **[trac_14516-crystals_speedup-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14516/trac_14516-crystals_speedup-ts.patch.gz)**

Here's the fixed patch.

For patchbot:

Apply: trac_14516-crystals_speedup-ts.patch



---

archive/issue_comments_175698.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nOk, looks good now!\n\nAnne",
    "created_at": "2013-08-06T00:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175698",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:25" align="right">comment:25</div>

Ok, looks good now!

Anne



---

archive/issue_comments_175699.json:
```json
{
    "body": "Merged: **sage-5.12.beta1**",
    "created_at": "2013-08-16T21:11:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14516#issuecomment-175699",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta1**



---

archive/issue_events_206355.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:11:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206355"
}
```



---

archive/issue_events_206356.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:11:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14516",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14516#event-206356"
}
```
