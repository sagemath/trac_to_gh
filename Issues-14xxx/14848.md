# Issue 14848: Inconsistencies with FreeAlgebra

archive/issues_014644.json:
```json
{
    "assignees": [],
    "body": "This ticket is \"inspired\" by [this ask.sagemath question](http://ask.sagemath.org/question/2760/products-in-a-free-algebra).\n\n1. First, there should be an easy way to get the variables out of an expression in FreeAlgebra. Compare with the output of polynomial ring.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)  \nsage: g=4+3*x^7*y^10*x^13\nsage: g.variables()            # <------------   Need this\nsage: h=g._FreeAlgebraElement__monomial_coefficients # This is what we need to do currently\nsage: h.items()[1][0]._element_list     # and do more post processing on the output.\n[(0, 7), (1, 10), (0, 13)]\n\n# Compare with polynomial ring\nsage: F.<x,y> = PolynomialRing(ZZ)\nsage: g=4+3*x^7*y^10*x^13\nsage: g.variables()\n(x, y)\nsage: g=4+3*x^7\nsage: g.variables()\n(x,)\n```\n2. The element `x<sup>7*y</sup>10*x^13` does not belong to the `FreeAlgebra` class once it is extracted from the expression. It belongs to `FreeMonoid`. I think the parent of it should be the same even after we extract it.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)  \nsage: g=4+3*x^7*y^10*x^13\nsage: h=g._FreeAlgebraElement__monomial_coefficients\nsage: h\n{1: 4, x^7*y^10*x^13: 3}\nsage: hh = h.items()[1][0]; hh\nx^7*y^10*x^13\nsage: hh.parent()\nFree monoid on 2 generators (x, y)\n```\n\nAssignee: **@aghitza**\n\nCC:  @nthiery\n\nBranch/Commit: **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**\n\nReviewer: **Punarbasu Purkayastha**\n\nAuthor: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14848_\n\n",
    "closed_at": "2014-04-22T22:02:31Z",
    "created_at": "2013-07-02T06:17:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Inconsistencies with FreeAlgebra",
    "type": "issue",
    "updated_at": "2014-04-22T22:02:31Z",
    "url": "https://github.com/sagemath/sage/issues/14848",
    "user": "https://github.com/ppurka"
}
```
This ticket is "inspired" by [this ask.sagemath question](http://ask.sagemath.org/question/2760/products-in-a-free-algebra).

1. First, there should be an easy way to get the variables out of an expression in FreeAlgebra. Compare with the output of polynomial ring.

```
sage: F.<x,y>=FreeAlgebra(ZZ)  
sage: g=4+3*x^7*y^10*x^13
sage: g.variables()            # <------------   Need this
sage: h=g._FreeAlgebraElement__monomial_coefficients # This is what we need to do currently
sage: h.items()[1][0]._element_list     # and do more post processing on the output.
[(0, 7), (1, 10), (0, 13)]

# Compare with polynomial ring
sage: F.<x,y> = PolynomialRing(ZZ)
sage: g=4+3*x^7*y^10*x^13
sage: g.variables()
(x, y)
sage: g=4+3*x^7
sage: g.variables()
(x,)
```
2. The element `x<sup>7*y</sup>10*x^13` does not belong to the `FreeAlgebra` class once it is extracted from the expression. It belongs to `FreeMonoid`. I think the parent of it should be the same even after we extract it.

```
sage: F.<x,y>=FreeAlgebra(ZZ)  
sage: g=4+3*x^7*y^10*x^13
sage: h=g._FreeAlgebraElement__monomial_coefficients
sage: h
{1: 4, x^7*y^10*x^13: 3}
sage: hh = h.items()[1][0]; hh
x^7*y^10*x^13
sage: hh.parent()
Free monoid on 2 generators (x, y)
```

Assignee: **@aghitza**

CC:  @nthiery

Branch/Commit: **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**

Reviewer: **Punarbasu Purkayastha**

Author: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/14848_





---

archive/issue_events_193822.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-07-02T06:17:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193822"
}
```



---

archive/issue_events_193823.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-07-02T06:17:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193823"
}
```



---

archive/issue_events_193824.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-07-02T06:17:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193824"
}
```



---

archive/issue_events_193825.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-07-02T06:17:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193825"
}
```



---

archive/issue_comments_184370.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nIn regards to my question on ask.sagemath, what I would have really liked was if elements supported indexing. So for example, g[0] should return 4. g[1] should return 3*x<sup>7*y</sup>10*x^13 and then g[1][0] should return 3 i guess, g[1][1] should return x^7 and so on. After that, it would be nice to have a way to iterate over 4+3*x<sup>7*y</sup>10*x^13. Maybe we would need len() for that? Has there ever been any talk about implementing something like this?",
    "created_at": "2013-07-02T12:18:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184370",
    "user": "https://github.com/sagetrac-broken-symlink"
}
```

<div id="comment:1" align="right">Comment 1</div>

In regards to my question on ask.sagemath, what I would have really liked was if elements supported indexing. So for example, g[0] should return 4. g[1] should return 3*x<sup>7*y</sup>10*x^13 and then g[1][0] should return 3 i guess, g[1][1] should return x^7 and so on. After that, it would be nice to have a way to iterate over 4+3*x<sup>7*y</sup>10*x^13. Maybe we would need len() for that? Has there ever been any talk about implementing something like this?



---

archive/issue_comments_184371.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI think this kind of indexing has never been discussed or implemented. There could be several reasons, one of the foremost being that the order in which you enter the expression is not preserved.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)\nsage: g = x^5 * y^4 + 3\nsage: g\n3 + x^5*y^4\n```",
    "created_at": "2013-07-02T12:27:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184371",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:2" align="right">Comment 2</div>

I think this kind of indexing has never been discussed or implemented. There could be several reasons, one of the foremost being that the order in which you enter the expression is not preserved.

```
sage: F.<x,y>=FreeAlgebra(ZZ)
sage: g = x^5 * y^4 + 3
sage: g
3 + x^5*y^4
```



---

archive/issue_comments_184372.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nelements support iteration, but not indexing, which is appropriate because as ppurka said there is no real ordering on the expressions.\n\n```\nsage: F.<x,y> = FreeAlgebra(ZZ)\nsage: g = x^5 * y^4 + 3\nsage: for m in g:\n....:     print m\n....: \n(3, 1)\n(1, x^5*y^4)\nsage: list(g)\n[(3, 1), (1, x^5*y^4)]\n```\n\nall works fine.",
    "created_at": "2013-09-06T20:50:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184372",
    "user": "https://github.com/samclearman"
}
```

<div id="comment:3" align="right">Comment 3</div>

elements support iteration, but not indexing, which is appropriate because as ppurka said there is no real ordering on the expressions.

```
sage: F.<x,y> = FreeAlgebra(ZZ)
sage: g = x^5 * y^4 + 3
sage: for m in g:
....:     print m
....: 
(3, 1)
(1, x^5*y^4)
sage: list(g)
[(3, 1), (1, x^5*y^4)]
```

all works fine.



---

archive/issue_events_193826.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193826"
}
```



---

archive/issue_events_193827.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:55:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193827"
}
```



---

archive/issue_events_193828.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:55:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193828"
}
```



---

archive/issue_events_193829.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193829"
}
```



---

archive/issue_comments_184373.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nMarking as invalid.",
    "created_at": "2013-10-12T07:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184373",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:4" align="right">Comment 4</div>

Marking as invalid.



---

archive/issue_events_193830.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:56:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193830"
}
```



---

archive/issue_events_193831.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:56:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193831"
}
```



---

archive/issue_comments_184374.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nOh. Sorry. I forgot that the original questions were very different from the discussion that ensued.",
    "created_at": "2013-10-12T07:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184374",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:5" align="right">Comment 5</div>

Oh. Sorry. I forgot that the original questions were very different from the discussion that ensued.



---

archive/issue_comments_184375.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nRegarding point 1: Accessing underscore methods is bound to make your life hard: the underscore marks that these are methods/attributes for internal use. The interface is via iteration and using that one can easily accomplish the task:\n\n```\nsage: tuple({n[0] for m in g for n in m[1]})\n(y, x)\n```\n(i.e., iterate over the terms making up the algebra element, extract the monomial and iterate over that to extract the variables that occur in them).\n\nWhether this needs to be wrapped in a method: The operation isn't very natural: The parent will naturally tell you which variables CAN occur in in algebra elements. Are the ones that don't have all those variables really so special that there needs to be a method to query about that?\n\nFor polynomials, the same argument holds, but there it was probably added because some beginners will tend to think of polynomials in terms of SR, where the variables occurring is really a property of the expression and not really of SR.\n\nConcerning point 2: The nested operation above shows why it's natural to return monomials NOT as elements of the algebra: iterating over an algebra element gives the pairs, iterating over a monomial gives variable-exponent pairs. The separation actually provides easier access to the underlying data.\n\nFor normal polynomial rings this is probably avoided for efficiency reasons, but you quickly notice that it's a little inconvenient: you end up testing quite a bit whether given polynomials are actually monomials, where doing this via a type check would often in principle be quite doable.",
    "created_at": "2013-10-12T15:16:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184375",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:6" align="right">Comment 6</div>

Regarding point 1: Accessing underscore methods is bound to make your life hard: the underscore marks that these are methods/attributes for internal use. The interface is via iteration and using that one can easily accomplish the task:

```
sage: tuple({n[0] for m in g for n in m[1]})
(y, x)
```
(i.e., iterate over the terms making up the algebra element, extract the monomial and iterate over that to extract the variables that occur in them).

Whether this needs to be wrapped in a method: The operation isn't very natural: The parent will naturally tell you which variables CAN occur in in algebra elements. Are the ones that don't have all those variables really so special that there needs to be a method to query about that?

For polynomials, the same argument holds, but there it was probably added because some beginners will tend to think of polynomials in terms of SR, where the variables occurring is really a property of the expression and not really of SR.

Concerning point 2: The nested operation above shows why it's natural to return monomials NOT as elements of the algebra: iterating over an algebra element gives the pairs, iterating over a monomial gives variable-exponent pairs. The separation actually provides easier access to the underlying data.

For normal polynomial rings this is probably avoided for efficiency reasons, but you quickly notice that it's a little inconvenient: you end up testing quite a bit whether given polynomials are actually monomials, where doing this via a type check would often in principle be quite doable.



---

archive/issue_comments_184376.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\n1. The iteration operation was not clear to me at all, and it definitely not possible for beginner to figure it out. By a beginner, I don't mean a beginner to programming - more like a beginner to Sage, or this specific implementation in Sage. I don't find this kind of iteration documented anywhere, even for polynomial rings - maybe it is hidden somewhere. Secondly, the parent `FreeAlgebra` does have `variable_name` and `variable_names` methods. Both are undocumented. The first one, for some weird reason, returns only the first variable as a string. The second one returns all the variables as strings. This is quite useless for programming purposes. It is *maybe* ok for interactive use, where one can look at this output and then decide to run the `F.inject_variables()` once one is sure it won't clobber existing variables.\n\n2. Checking for monomials can be easily done using the list comprehension you provided. Or, even better for efficiency reasons - a `for` loop with an `enumerate` that returns `False` as soon as it encounters a second tuple.\n\n```python\ndef is_monomial(self):\n    for i,_ in enumerate(self):\n        if i == 1:\n             return False\n    return True\n```",
    "created_at": "2013-10-13T08:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184376",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:7" align="right">Comment 7</div>

1. The iteration operation was not clear to me at all, and it definitely not possible for beginner to figure it out. By a beginner, I don't mean a beginner to programming - more like a beginner to Sage, or this specific implementation in Sage. I don't find this kind of iteration documented anywhere, even for polynomial rings - maybe it is hidden somewhere. Secondly, the parent `FreeAlgebra` does have `variable_name` and `variable_names` methods. Both are undocumented. The first one, for some weird reason, returns only the first variable as a string. The second one returns all the variables as strings. This is quite useless for programming purposes. It is *maybe* ok for interactive use, where one can look at this output and then decide to run the `F.inject_variables()` once one is sure it won't clobber existing variables.

2. Checking for monomials can be easily done using the list comprehension you provided. Or, even better for efficiency reasons - a `for` loop with an `enumerate` that returns `False` as soon as it encounters a second tuple.

```python
def is_monomial(self):
    for i,_ in enumerate(self):
        if i == 1:
             return False
    return True
```



---

archive/issue_comments_184377.json:
```json
{
    "body": "Branch: **[public/algebras/fix_free_algebras-14848](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/fix_free_algebras-14848)**",
    "created_at": "2014-04-02T01:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184377",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/algebras/fix_free_algebras-14848](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/fix_free_algebras-14848)**



---

archive/issue_events_193832.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-02T01:22:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193832"
}
```



---

archive/issue_events_193833.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-02T01:22:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193833"
}
```



---

archive/issue_comments_184378.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do. I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947). So iterating through an element of `FreeAlgera` gives `index,coeff` now (finally consistency! this had bugged me a few times). I've also added a `variables` method as I don't think it does much harm to have it and `support` returns the monomials that occur.\n\nRegarding point 2, you can now use the `monomial_coefficients()` to iterate over pairs (monomial in free algebra, coefficient)] (well...TBH actually it's a `dict`, so you need an additional `items()`). Also I agree with Nils' opinion.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/771ac4cfefe832d4db2f24e5d5ee74b75b7447a8\">771ac4c</a></td><td><code>Converted FreeAlgebra to inherit from CombinatrialFreeModule.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2d1f8df3751dc79eeab62ad65dbaf5f36c546a6\">a2d1f8d</a></td><td><code>Fixes for coercion maps.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5045cc5ffff734b87c76fe980ccbb8ec23e937a4\">5045cc5</a></td><td><code>pyflakes cleanup of free_algebra.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b52e779d8a15c4ff277abc39bdc4e15e2f658f74\">b52e779</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c25070237ed2ae8360999bc8b4c1f6aea1fe33c5\">c250702</a></td><td><code>(Hack) Fix for making FreeAlgebraElement work as a base ring for matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981\">0de106a</a></td><td><code>Added variables() method to free module elements.</code></td></tr></table>\n",
    "created_at": "2014-04-02T01:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184378",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">Comment 8</div>

I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do. I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947). So iterating through an element of `FreeAlgera` gives `index,coeff` now (finally consistency! this had bugged me a few times). I've also added a `variables` method as I don't think it does much harm to have it and `support` returns the monomials that occur.

Regarding point 2, you can now use the `monomial_coefficients()` to iterate over pairs (monomial in free algebra, coefficient)] (well...TBH actually it's a `dict`, so you need an additional `items()`). Also I agree with Nils' opinion.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/771ac4cfefe832d4db2f24e5d5ee74b75b7447a8">771ac4c</a></td><td><code>Converted FreeAlgebra to inherit from CombinatrialFreeModule.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2d1f8df3751dc79eeab62ad65dbaf5f36c546a6">a2d1f8d</a></td><td><code>Fixes for coercion maps.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5045cc5ffff734b87c76fe980ccbb8ec23e937a4">5045cc5</a></td><td><code>pyflakes cleanup of free_algebra.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b52e779d8a15c4ff277abc39bdc4e15e2f658f74">b52e779</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c25070237ed2ae8360999bc8b4c1f6aea1fe33c5">c250702</a></td><td><code>(Hack) Fix for making FreeAlgebraElement work as a base ring for matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981">0de106a</a></td><td><code>Added variables() method to free module elements.</code></td></tr></table>




---

archive/issue_comments_184379.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2014-04-02T01:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184379",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_events_193834.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-02T01:22:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193834"
}
```



---

archive/issue_comments_184380.json:
```json
{
    "body": "Commit: **[0de106a](https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981)**",
    "created_at": "2014-04-02T01:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184380",
    "user": "https://github.com/tscrim"
}
```

Commit: **[0de106a](https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981)**



---

archive/issue_comments_184381.json:
```json
{
    "body": "Changed commit from **[0de106a](https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981)** to **[23d8c7b](https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6)**",
    "created_at": "2014-04-02T01:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184381",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0de106a](https://github.com/sagemath/sagetrac-mirror/commit/0de106a5831e0a06e9f8f050f35b15d2d3494981)** to **[23d8c7b](https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6)**



---

archive/issue_comments_184382.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6\">23d8c7b</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr></table>\n",
    "created_at": "2014-04-02T01:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184382",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9" align="right">Comment 9</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6">23d8c7b</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr></table>




---

archive/issue_comments_184383.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@tscrim](#comment%3A8):\n> I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do.\n\nYeah!\n\n> I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947).\n\nAny chance to get rid of the use of AlgebraElement there altogether?\n\nCheers,\n                      Nicolas",
    "created_at": "2014-04-02T20:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184383",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@tscrim](#comment%3A8):
> I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do.

Yeah!

> I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947).

Any chance to get rid of the use of AlgebraElement there altogether?

Cheers,
                      Nicolas



---

archive/issue_comments_184384.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@nthiery](#comment%3A10):\n> Any chance to get rid of the use of AlgebraElement there altogether?\n\nAlas, no. We'd have to do something with `_rmul_` and `_lmul_` of the matrices without introducing a speed regression, which IDK what the best way to do it will be. The alternative would be to remove/change those failing doctests. I've posted an idea I've just had to #15947.",
    "created_at": "2014-04-02T20:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184384",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@nthiery](#comment%3A10):
> Any chance to get rid of the use of AlgebraElement there altogether?

Alas, no. We'd have to do something with `_rmul_` and `_lmul_` of the matrices without introducing a speed regression, which IDK what the best way to do it will be. The alternative would be to remove/change those failing doctests. I've posted an idea I've just had to #15947.



---

archive/issue_comments_184385.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51b2e5fc7e35b1bcfeedb5bc033f7d84db059345\">51b2e5f</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3\">9f49f2f</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr></table>\n",
    "created_at": "2014-04-15T02:16:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184385",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12" align="right">Comment 12</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51b2e5fc7e35b1bcfeedb5bc033f7d84db059345">51b2e5f</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3">9f49f2f</a></td><td><code>Merge branch 'develop' into public/algebras/fix_free_algebras-14848</code></td></tr></table>




---

archive/issue_comments_184386.json:
```json
{
    "body": "Changed commit from **[23d8c7b](https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6)** to **[9f49f2f](https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3)**",
    "created_at": "2014-04-15T02:16:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184386",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[23d8c7b](https://github.com/sagemath/sagetrac-mirror/commit/23d8c7b0b0204d3b93e67969bfc7f4dccaeb5be6)** to **[9f49f2f](https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3)**



---

archive/issue_comments_184387.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nI got one error in doctests:\n\n```\nsage -t --long src/sage/algebras/algebra.py\n**********************************************************************\nFile \"src/sage/algebras/algebra.py\", line 29, in sage.algebras.algebra.is_Algebra\nFailed example:\n    is_Algebra(R)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```\n\nPoint 1. in description is fixed, but I guess it is harder to fix point 2. So, other than this doctest, the patch looks OK to me.",
    "created_at": "2014-04-15T13:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184387",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:13" align="right">Comment 13</div>

I got one error in doctests:

```
sage -t --long src/sage/algebras/algebra.py
**********************************************************************
File "src/sage/algebras/algebra.py", line 29, in sage.algebras.algebra.is_Algebra
Failed example:
    is_Algebra(R)
Expected:
    True
Got:
    False
**********************************************************************
```

Point 1. in description is fixed, but I guess it is harder to fix point 2. So, other than this doctest, the patch looks OK to me.



---

archive/issue_events_193835.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2014-04-15T13:03:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193835"
}
```



---

archive/issue_events_193836.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2014-04-15T13:03:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193836"
}
```



---

archive/issue_comments_184388.json:
```json
{
    "body": "Work Issues: **fix doctests**",
    "created_at": "2014-04-15T13:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184388",
    "user": "https://github.com/ppurka"
}
```

Work Issues: **fix doctests**



---

archive/issue_comments_184389.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956\">74734db</a></td><td><code>Fixed failing doctests.</code></td></tr></table>\n",
    "created_at": "2014-04-15T15:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184389",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14" align="right">Comment 14</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956">74734db</a></td><td><code>Fixed failing doctests.</code></td></tr></table>




---

archive/issue_comments_184390.json:
```json
{
    "body": "Changed commit from **[9f49f2f](https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3)** to **[74734db](https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956)**",
    "created_at": "2014-04-15T15:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184390",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9f49f2f](https://github.com/sagemath/sagetrac-mirror/commit/9f49f2f52c1125c8fd32f79a0f25f0032bd6ead3)** to **[74734db](https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956)**



---

archive/issue_comments_184391.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nFixed (and also some doctests in `categories/rings.py` that I found).",
    "created_at": "2014-04-15T15:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184391",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">Comment 15</div>

Fixed (and also some doctests in `categories/rings.py` that I found).



---

archive/issue_comments_184392.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nI am surprised. I have two questions\n\n1. Why does this patch affect `categories/rings.py`?\n2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?",
    "created_at": "2014-04-16T09:03:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184392",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:16" align="right">Comment 16</div>

I am surprised. I have two questions

1. Why does this patch affect `categories/rings.py`?
2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?



---

archive/issue_comments_184393.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@ppurka](#comment%3A16):\n> I am surprised. I have two questions\n> \n> 1. Why does this patch affect `categories/rings.py`?\n\nIt's just a doctest and it's because I swapped the order when iterating over the objects (i.e., it became index, coefficient whereas before it was coefficient, index).\n\n> 2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?\n\nThere's a doctest in `categories/commutative_ring_ideals.py` which tries to pass off (incorrectly) `Partitions(4)` as a commutative ring, but the `is_Algebra` fails with a `TypeError`. However, it could also fail with other errors and I didn't want the `is_Algebra` to error out for similar reasoning to a `__contains__()` check. We can add additional doctests to `is_Algebra` but I think we're already covered by other parts of the library.",
    "created_at": "2014-04-16T13:56:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184393",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@ppurka](#comment%3A16):
> I am surprised. I have two questions
> 
> 1. Why does this patch affect `categories/rings.py`?

It's just a doctest and it's because I swapped the order when iterating over the objects (i.e., it became index, coefficient whereas before it was coefficient, index).

> 2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?

There's a doctest in `categories/commutative_ring_ideals.py` which tries to pass off (incorrectly) `Partitions(4)` as a commutative ring, but the `is_Algebra` fails with a `TypeError`. However, it could also fail with other errors and I didn't want the `is_Algebra` to error out for similar reasoning to a `__contains__()` check. We can add additional doctests to `is_Algebra` but I think we're already covered by other parts of the library.



---

archive/issue_events_193837.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-16T13:56:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193837"
}
```



---

archive/issue_events_193838.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-16T13:56:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193838"
}
```



---

archive/issue_comments_184394.json:
```json
{
    "body": "Changed work issues from **fix doctests** to none",
    "created_at": "2014-04-17T18:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184394",
    "user": "https://github.com/tscrim"
}
```

Changed work issues from **fix doctests** to none



---

archive/issue_comments_184395.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nOk. Then. Setting it to positive review.",
    "created_at": "2014-04-18T03:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184395",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:19" align="right">Comment 19</div>

Ok. Then. Setting it to positive review.



---

archive/issue_events_193839.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2014-04-18T03:33:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193839"
}
```



---

archive/issue_events_193840.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2014-04-18T03:33:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193840"
}
```



---

archive/issue_comments_184396.json:
```json
{
    "body": "Reviewer: **Punarbasu Purkayastha**",
    "created_at": "2014-04-18T03:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184396",
    "user": "https://github.com/ppurka"
}
```

Reviewer: **Punarbasu Purkayastha**



---

archive/issue_comments_184397.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nThank you for doing the review.",
    "created_at": "2014-04-18T03:36:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184397",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">Comment 20</div>

Thank you for doing the review.



---

archive/issue_comments_184398.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nLots of doctests failures",
    "created_at": "2014-04-20T12:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184398",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:21" align="right">Comment 21</div>

Lots of doctests failures



---

archive/issue_events_193841.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-20T12:24:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193841"
}
```



---

archive/issue_events_193842.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-20T12:24:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193842"
}
```



---

archive/issue_comments_184399.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nCan you list which files?",
    "created_at": "2014-04-20T12:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184399",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:22" align="right">Comment 22</div>

Can you list which files?



---

archive/issue_comments_184400.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nSorry, too late. But there was enough breakage that you should run the whole testsuite.",
    "created_at": "2014-04-20T13:24:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184400",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">Comment 23</div>

Sorry, too late. But there was enough breakage that you should run the whole testsuite.



---

archive/issue_comments_184401.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nThis is mostly for my records. Here's the list I got that were \"bad\" errors:\n\n```\nsage -t rings/quotient_ring.py  # 8 doctests failed\nsage -t rings/ring.pyx  # 3 doctests failed\nsage -t structure/sage_object.pyx  # 1 doctest failed\nsage -t structure/factorization.py  # 1 doctest failed\n```\nThe pickling one is going to be the most fun to deal with.\n\nThese were from dictionary orderings (likely from hash values):\n\n```\nsage -t libs/singular/groebner_strategy.pyx  # 2 doctests failed\nsage -t rings/polynomial/plural.pyx  # 5 doctests failed\nsage -t rings/polynomial/multi_polynomial_ideal.py  # 13 doctests failed\n```\n\nOne I don't think is related:\n\n```\nsage -t doctest/test.py  # 1 doctest failed\n```\nThese seem to be maxima related (i.e. local to my setup so I'm going to ignore them):\n\n```\nsage -t tests/french_book/integration_doctest.py  # 1 doctest failed\nsage -t calculus/desolvers.py  # 8 doctests failed\nsage -t /home/travis/sage/src/doc/en/prep/Quickstarts/Differential-Equations.rst  # 2 doctests failed\nsage -t /home/travis/sage/src/doc/en/constructions/calculus.rst  # 4 doctests failed\n```",
    "created_at": "2014-04-20T14:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184401",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">Comment 24</div>

This is mostly for my records. Here's the list I got that were "bad" errors:

```
sage -t rings/quotient_ring.py  # 8 doctests failed
sage -t rings/ring.pyx  # 3 doctests failed
sage -t structure/sage_object.pyx  # 1 doctest failed
sage -t structure/factorization.py  # 1 doctest failed
```
The pickling one is going to be the most fun to deal with.

These were from dictionary orderings (likely from hash values):

```
sage -t libs/singular/groebner_strategy.pyx  # 2 doctests failed
sage -t rings/polynomial/plural.pyx  # 5 doctests failed
sage -t rings/polynomial/multi_polynomial_ideal.py  # 13 doctests failed
```

One I don't think is related:

```
sage -t doctest/test.py  # 1 doctest failed
```
These seem to be maxima related (i.e. local to my setup so I'm going to ignore them):

```
sage -t tests/french_book/integration_doctest.py  # 1 doctest failed
sage -t calculus/desolvers.py  # 8 doctests failed
sage -t /home/travis/sage/src/doc/en/prep/Quickstarts/Differential-Equations.rst  # 2 doctests failed
sage -t /home/travis/sage/src/doc/en/constructions/calculus.rst  # 4 doctests failed
```



---

archive/issue_comments_184402.json:
```json
{
    "body": "Changed commit from **[74734db](https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956)** to **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**",
    "created_at": "2014-04-22T16:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184402",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[74734db](https://github.com/sagemath/sagetrac-mirror/commit/74734db11fe788440775741de7519e9f2b7f7956)** to **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**



---

archive/issue_comments_184403.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9899a9cfd908d43157791e39d31f73caa13a2dca\">9899a9c</a></td><td><code>Fixing doctests in quotient_ring.py and ring.pyx.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/073b57717fe266dc3e6294a93438c0009f4416bc\">073b577</a></td><td><code>Fixed dict ordering doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e\">0f9bf9d</a></td><td><code>Fixed remaining doctests.</code></td></tr></table>\n",
    "created_at": "2014-04-22T16:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184403",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25" align="right">Comment 25</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9899a9cfd908d43157791e39d31f73caa13a2dca">9899a9c</a></td><td><code>Fixing doctests in quotient_ring.py and ring.pyx.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/073b57717fe266dc3e6294a93438c0009f4416bc">073b577</a></td><td><code>Fixed dict ordering doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e">0f9bf9d</a></td><td><code>Fixed remaining doctests.</code></td></tr></table>




---

archive/issue_comments_184404.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nVolker, double-check that I got them all please.",
    "created_at": "2014-04-22T16:12:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184404",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">Comment 26</div>

Volker, double-check that I got them all please.



---

archive/issue_events_193843.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-22T16:12:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193843"
}
```



---

archive/issue_events_193844.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-22T16:12:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193844"
}
```



---

archive/issue_events_193845.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-22T22:02:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193845"
}
```



---

archive/issue_events_193846.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "798b56a26e887d4935a4c47ba216985db6099001",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-04-22T22:02:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14848#event-193846"
}
```



---

archive/issue_comments_184405.json:
```json
{
    "body": "Changed branch from **[public/algebras/fix_free_algebras-14848](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/fix_free_algebras-14848)** to **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**",
    "created_at": "2014-04-22T22:02:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14848",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14848#issuecomment-184405",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/algebras/fix_free_algebras-14848](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/fix_free_algebras-14848)** to **[0f9bf9d](https://github.com/sagemath/sagetrac-mirror/commit/0f9bf9dbdd714429fd290f8c42811e143ca5d70e)**
