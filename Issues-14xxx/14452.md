# Issue 14452: Upgrade to Cython 0.19

archive/issues_014248.json:
```json
{
    "body": "Upgrade to Cython 0.19.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg) ([attachment:cython-0.19.p0.diff spkg diff])\n\n**upstream**:\n1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)\n2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)\n3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)\n4. Bug with `cpdef` keyword arguments in `lazy_import.pyx`: [http://trac.cython.org/cython_trac/ticket/810](http://trac.cython.org/cython_trac/ticket/810)\n\nWith this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.\n\nOn Itanium, there is a doctest failure\n\n```\nsage -t --long devel/sage/sage/structure/element.pyx\n**********************************************************************\nFile \"devel/sage/sage/structure/element.pyx\", line 1733, in sage.structure.element.RingElement.__pow__\nFailed example:\n    p(a,2,1)\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: __pow__ dummy argument not used\nGot:\n    202\n**********************************************************************\n```\nThis is likely a bug in GCC-4.7.3, but no further investigation has been done. Compiling `sage/structure/element.pyx` with `-Os` works around the problem, see patch.\n\n**apply** [attachment:14452_cython_0.19.patch]\n\nAssignee: @jdemeyer\n\nCC:  @robertwb\n\nUpstream: None of the above - read trac for reasoning.\n\nReviewer: Robert Bradshaw\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.9.rc0\n\nDependencies: #13826\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14452\n\n",
    "closed_at": "2013-04-23T19:08:37Z",
    "created_at": "2013-04-15T12:04:02Z",
    "labels": [
        "component: packages: standard",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Upgrade to Cython 0.19",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14452",
    "user": "https://github.com/jdemeyer"
}
```
Upgrade to Cython 0.19.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg) ([attachment:cython-0.19.p0.diff spkg diff])

**upstream**:
1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)
2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)
3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)
4. Bug with `cpdef` keyword arguments in `lazy_import.pyx`: [http://trac.cython.org/cython_trac/ticket/810](http://trac.cython.org/cython_trac/ticket/810)

With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.

On Itanium, there is a doctest failure

```
sage -t --long devel/sage/sage/structure/element.pyx
**********************************************************************
File "devel/sage/sage/structure/element.pyx", line 1733, in sage.structure.element.RingElement.__pow__
Failed example:
    p(a,2,1)
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: __pow__ dummy argument not used
Got:
    202
**********************************************************************
```
This is likely a bug in GCC-4.7.3, but no further investigation has been done. Compiling `sage/structure/element.pyx` with `-Os` works around the problem, see patch.

**apply** [attachment:14452_cython_0.19.patch]

Assignee: @jdemeyer

CC:  @robertwb

Upstream: None of the above - read trac for reasoning.

Reviewer: Robert Bradshaw

Author: Jeroen Demeyer

Merged: sage-5.9.rc0

Dependencies: #13826

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14452





---

archive/issue_comments_223974.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Upgrade to Cython 0.19 when it's released.\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))\n``````\n",
    "created_at": "2013-04-15T12:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223974",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Upgrade to Cython 0.19 when it's released.
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))
``````




---

archive/issue_comments_223975.json:
```json
{
    "body": "<a id='comment:2'></a>\nRobert, I think there is a serious Cython bug: the `__new__` method of a class might actually use the wrong class: in `devel/sage/sage/libs/gap/element.pyx`, the code\n\n```\ndef GapElement_Record r = GapElement_Record.__new__(GapElement_Record)\n```\ngenerates\n\n```\n__pyx_t_1 = __pyx_tp_new_4sage_4libs_3gap_7element_GapElement(((PyTypeObject *)((PyObject*)__pyx_ptype_4sage_4libs_3gap_7element_GapElement_Record)), ((PyObject *)__pyx_empty_tuple), NULL);\n```\nNote the call to the `tp_new` function of `GapElement` (a child class), not `GapElement_Record`.",
    "created_at": "2013-04-16T17:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223975",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Robert, I think there is a serious Cython bug: the `__new__` method of a class might actually use the wrong class: in `devel/sage/sage/libs/gap/element.pyx`, the code

```
def GapElement_Record r = GapElement_Record.__new__(GapElement_Record)
```
generates

```
__pyx_t_1 = __pyx_tp_new_4sage_4libs_3gap_7element_GapElement(((PyTypeObject *)((PyObject*)__pyx_ptype_4sage_4libs_3gap_7element_GapElement_Record)), ((PyObject *)__pyx_empty_tuple), NULL);
```
Note the call to the `tp_new` function of `GapElement` (a child class), not `GapElement_Record`.



---

archive/issue_comments_223976.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2013-04-16T18:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223976",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_223977.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Upgrade to Cython 0.19 when it's released.\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))\n+\n+**upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n``````\n",
    "created_at": "2013-04-16T18:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223977",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Upgrade to Cython 0.19 when it's released.
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))
+
+**upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
``````




---

archive/issue_comments_223978.json:
```json
{
    "body": "<a id='comment:4'></a>\nhttps://github.com/cython/cython/pull/214",
    "created_at": "2013-04-17T05:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223978",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:4'></a>
https://github.com/cython/cython/pull/214



---

archive/issue_comments_223979.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2013-04-17T05:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223979",
    "user": "https://github.com/robertwb"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_223980.json:
```json
{
    "body": "<a id='comment:5'></a>\nAttachment [sage_crash_W7eVMu.log](tarball://root/attachments/some-uuid/ticket14452/sage_crash_W7eVMu.log) by @jdemeyer created at 2013-04-17 18:13:03",
    "created_at": "2013-04-17T18:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223980",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Attachment [sage_crash_W7eVMu.log](tarball://root/attachments/some-uuid/ticket14452/sage_crash_W7eVMu.log) by @jdemeyer created at 2013-04-17 18:13:03



---

archive/issue_comments_223981.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))\n \n **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n+\n+With this spkg, all doctests pass, but the docbuilder crashes: [attachment:sage_crash_W7eVMu.log]\n``````\n",
    "created_at": "2013-04-17T18:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223981",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))
 
 **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
+
+With this spkg, all doctests pass, but the docbuilder crashes: [attachment:sage_crash_W7eVMu.log]
``````




---

archive/issue_comments_223982.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Upgrade to Cython 0.19 when it's released.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)\n \n **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n \n``````\n",
    "created_at": "2013-04-17T18:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223982",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Upgrade to Cython 0.19 when it's released.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on [Cython-0.19 beta2](http://mail.python.org/pipermail/cython-devel/2013-April/003564.html))
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)
 
 **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
 
``````




---

archive/issue_comments_223983.json:
```json
{
    "body": "<a id='comment:7'></a>\nHere is what I found about the docbuilder crash: it works with Cython 0.18, not with current master at `0ee15b1829125b6844ac13f437c2d9bd61a4ceca`.\n\nIn `lazy_import.pyx`, somehow `self._object` becomes `NULL` in the line\n\n```\nsetattr(cls, alias, self._object)\n```\nwhich is compiled to\n\n```\n           __pyx_t_1 = __pyx_v_self->_object;                                      \n           __Pyx_INCREF(__pyx_t_1);\n           __pyx_t_10 = PyObject_SetAttr(__pyx_v_cls, __pyx_v_alias, __pyx_t_1); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __py\n           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;                                 \n```\nI don't see anything suspicious here.",
    "created_at": "2013-04-18T08:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223983",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Here is what I found about the docbuilder crash: it works with Cython 0.18, not with current master at `0ee15b1829125b6844ac13f437c2d9bd61a4ceca`.

In `lazy_import.pyx`, somehow `self._object` becomes `NULL` in the line

```
setattr(cls, alias, self._object)
```
which is compiled to

```
           __pyx_t_1 = __pyx_v_self->_object;                                      
           __Pyx_INCREF(__pyx_t_1);
           __pyx_t_10 = PyObject_SetAttr(__pyx_v_cls, __pyx_v_alias, __pyx_t_1); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __py
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;                                 
```
I don't see anything suspicious here.



---

archive/issue_comments_223984.json:
```json
{
    "body": "<a id='comment:8'></a>\nGenerating just `lazy_import.c` with Cython-0.18 makes the documentation build.",
    "created_at": "2013-04-18T08:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223984",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Generating just `lazy_import.c` with Cython-0.18 makes the documentation build.



---

archive/issue_comments_223985.json:
```json
{
    "body": "<a id='comment:9'></a>\nRobert, I feel like I can not do much more to debug the docbuilding since I don't really understand the mechanics of `lazy_import`.",
    "created_at": "2013-04-18T08:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223985",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Robert, I feel like I can not do much more to debug the docbuilding since I don't really understand the mechanics of `lazy_import`.



---

archive/issue_comments_223986.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n \n-With this spkg, all doctests pass, but the docbuilder crashes: [attachment:sage_crash_W7eVMu.log]\n+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]\n``````\n",
    "created_at": "2013-04-18T08:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223986",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 **upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
 
-With this spkg, all doctests pass, but the docbuilder crashes: [attachment:sage_crash_W7eVMu.log]
+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]
``````




---

archive/issue_comments_223987.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)\n \n-**upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n+**upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n \n With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]\n``````\n",
    "created_at": "2013-04-18T08:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223987",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)
 
-**upstream** bug report causing segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
+**upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
 
 With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]
``````




---

archive/issue_comments_223988.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n **upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n \n-With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]\n+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] If the file `lazy_import.c` is generated with Cython 0.18, the problem goes away.\n``````\n",
    "created_at": "2013-04-18T11:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223988",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 **upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
 
-With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log]
+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] If the file `lazy_import.c` is generated with Cython 0.18, the problem goes away.
``````




---

archive/issue_comments_223989.json:
```json
{
    "body": "<a id='comment:13'></a>\nI don't see anything suspicious there either. Can you try compiling lazy_import.pyx with -O0? What's the diff of this file between 0.18 and 0.19?",
    "created_at": "2013-04-18T22:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223989",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:13'></a>
I don't see anything suspicious there either. Can you try compiling lazy_import.pyx with -O0? What's the diff of this file between 0.18 and 0.19?



---

archive/issue_comments_223990.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [robertwb](#comment%3A13):\n> Can you try compiling lazy_import.pyx with -O0?\n\nI did, and it didn't help. I could try to bisect the Cython git repo for the bug.",
    "created_at": "2013-04-19T06:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223990",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [robertwb](#comment%3A13):
> Can you try compiling lazy_import.pyx with -O0?

I did, and it didn't help. I could try to bisect the Cython git repo for the bug.



---

archive/issue_comments_223991.json:
```json
{
    "body": "<a id='comment:15'></a>\nResults of bisecting:\n\n* commit `19c0408476515c89a60655b753f08a3bd18eec83` is good\n\n* commit `d44a0845fc91bf7ade61dee431358f375c580f44` is bad\n\nAll commits in between simply fail to compile.",
    "created_at": "2013-04-19T10:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223991",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Results of bisecting:

* commit `19c0408476515c89a60655b753f08a3bd18eec83` is good

* commit `d44a0845fc91bf7ade61dee431358f375c580f44` is bad

All commits in between simply fail to compile.



---

archive/issue_comments_223992.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe relevant change seems to be the line\n\n```\nobj = self._get_object(owner=owner)\n```\n\nwhich was compiled in the **good** way as\n\n```\n  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s___get_object); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  __Pyx_GOTREF(__pyx_t_1);\n  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  __Pyx_GOTREF(((PyObject *)__pyx_t_2));\n  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__owner), __pyx_v_owner) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  __Pyx_GOTREF(__pyx_t_3);\n  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;\n  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;\n  __pyx_v_obj = __pyx_t_3;\n  __pyx_t_3 = 0;\n```\n\nand in the **bad** way as\n\n```\n  __pyx_t_2.__pyx_n = 1;\n  __pyx_t_2.owner = __pyx_v_owner;\n  __pyx_t_1 = ((struct __pyx_vtabstruct_4sage_4misc_11lazy_import_LazyImport *)__pyx_v_self->__pyx_vtab)->_get_object(__pyx_v_self, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n  __Pyx_GOTREF(__pyx_t_1);\n  __pyx_v_obj = __pyx_t_1;\n  __pyx_t_1 = 0;\n```",
    "created_at": "2013-04-19T14:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223992",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
The relevant change seems to be the line

```
obj = self._get_object(owner=owner)
```

which was compiled in the **good** way as

```
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s___get_object); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__owner), __pyx_v_owner) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_obj = __pyx_t_3;
  __pyx_t_3 = 0;
```

and in the **bad** way as

```
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.owner = __pyx_v_owner;
  __pyx_t_1 = ((struct __pyx_vtabstruct_4sage_4misc_11lazy_import_LazyImport *)__pyx_v_self->__pyx_vtab)->_get_object(__pyx_v_self, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_obj = __pyx_t_1;
  __pyx_t_1 = 0;
```



---

archive/issue_comments_223993.json:
```json
{
    "body": "<a id='comment:17'></a>\nAlternatively, changing the line\n\n```\ncpdef _get_object(self, owner=None):\n```\nto\n\n```\ndef _get_object(self, owner=None):\n```\nalso fixes the problem. I am applying this workaround in [attachment:14452_cython_0.19.patch].",
    "created_at": "2013-04-19T14:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223993",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
Alternatively, changing the line

```
cpdef _get_object(self, owner=None):
```
to

```
def _get_object(self, owner=None):
```
also fixes the problem. I am applying this workaround in [attachment:14452_cython_0.19.patch].



---

archive/issue_comments_223994.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,9 @@\n-Upgrade to Cython 0.19 when it's released.\n+Upgrade to Cython 0.19.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg)\n \n **upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n \n-With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] If the file `lazy_import.c` is generated with Cython 0.18, the problem goes away.\n+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.\n+\n+**apply** [attachment:14452_cython_0.19.patch]\n``````\n",
    "created_at": "2013-04-19T14:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223994",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,9 @@
-Upgrade to Cython 0.19 when it's released.
+Upgrade to Cython 0.19.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg) (based on Cython master)
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg)
 
 **upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
 
-With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] If the file `lazy_import.c` is generated with Cython 0.18, the problem goes away.
+With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.
+
+**apply** [attachment:14452_cython_0.19.patch]
``````




---

archive/issue_comments_223995.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-19T14:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223995",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_events_041101.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-19T18:54:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14452#event-41101"
}
```



---

archive/issue_comments_223996.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,11 @@\n Upgrade to Cython 0.19.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg)\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg)\n \n-**upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)\n+**upstream**:\n+1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)\n+2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)\n+3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)\n \n With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.\n \n``````\n",
    "created_at": "2013-04-21T15:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223996",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,11 @@
 Upgrade to Cython 0.19.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.spkg)
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg)
 
-**upstream** bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808)
+**upstream**:
+1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)
+2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)
+3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)
 
 With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.
 
``````




---

archive/issue_comments_223997.json:
```json
{
    "body": "Changing upstream from \"Fixed upstream, but not in a stable release.\" to \"None of the above - read trac for reasoning.\"",
    "created_at": "2013-04-21T15:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223997",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Fixed upstream, but not in a stable release." to "None of the above - read trac for reasoning."



---

archive/issue_comments_223998.json:
```json
{
    "body": "spkg diff",
    "created_at": "2013-04-21T15:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223998",
    "user": "https://github.com/jdemeyer"
}
```

spkg diff



---

archive/issue_comments_223999.json:
```json
{
    "body": "<a id='comment:21'></a>\nAttachment [cython-0.19.p0.diff](tarball://root/attachments/some-uuid/ticket14452/cython-0.19.p0.diff) by @jdemeyer created at 2013-04-21 15:07:43",
    "created_at": "2013-04-21T15:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-223999",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Attachment [cython-0.19.p0.diff](tarball://root/attachments/some-uuid/ticket14452/cython-0.19.p0.diff) by @jdemeyer created at 2013-04-21 15:07:43



---

archive/issue_comments_224000.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Upgrade to Cython 0.19.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg)\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg) ([attachment:cython-0.19.p0.diff spkg diff])\n \n **upstream**:\n 1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)\n``````\n",
    "created_at": "2013-04-21T15:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224000",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Upgrade to Cython 0.19.
 
-**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg)
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/cython-0.19.p0.spkg) ([attachment:cython-0.19.p0.diff spkg diff])
 
 **upstream**:
 1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)
``````




---

archive/issue_comments_224001.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,22 @@\n \n With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.\n \n+On Itanium, there is a doctest failure\n+\n+```\n+sage -t --long devel/sage/sage/structure/element.pyx\n+**********************************************************************\n+File \"devel/sage/sage/structure/element.pyx\", line 1733, in sage.structure.element.RingElement.__pow__\n+Failed example:\n+    p(a,2,1)\n+Expected:\n+    Traceback (most recent call last):\n+    ...\n+    RuntimeError: __pow__ dummy argument not used\n+Got:\n+    202\n+**********************************************************************\n+```\n+This is likely a bug in GCC-4.7.3, but no further investigation has been done. Compiling `sage/structure/element.pyx` with `-Os` works around the problem, see patch.\n+\n **apply** [attachment:14452_cython_0.19.patch]\n``````\n",
    "created_at": "2013-04-22T12:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224001",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,22 @@
 
 With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.
 
+On Itanium, there is a doctest failure
+
+```
+sage -t --long devel/sage/sage/structure/element.pyx
+**********************************************************************
+File "devel/sage/sage/structure/element.pyx", line 1733, in sage.structure.element.RingElement.__pow__
+Failed example:
+    p(a,2,1)
+Expected:
+    Traceback (most recent call last):
+    ...
+    RuntimeError: __pow__ dummy argument not used
+Got:
+    202
+**********************************************************************
+```
+This is likely a bug in GCC-4.7.3, but no further investigation has been done. Compiling `sage/structure/element.pyx` with `-Os` works around the problem, see patch.
+
 **apply** [attachment:14452_cython_0.19.patch]
``````




---

archive/issue_comments_224002.json:
```json
{
    "body": "<a id='comment:23'></a>\nWith these patches, all fine on the buildbot.",
    "created_at": "2013-04-22T12:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224002",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
With these patches, all fine on the buildbot.



---

archive/issue_comments_224003.json:
```json
{
    "body": "Attachment [14452_cython_0.19.patch](tarball://root/attachments/some-uuid/ticket14452/14452_cython_0.19.patch) by @jdemeyer created at 2013-04-23 10:39:52",
    "created_at": "2013-04-23T10:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224003",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14452_cython_0.19.patch](tarball://root/attachments/some-uuid/ticket14452/14452_cython_0.19.patch) by @jdemeyer created at 2013-04-23 10:39:52



---

archive/issue_comments_224004.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#13826\"",
    "created_at": "2013-04-23T10:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224004",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#13826"



---

archive/issue_comments_224005.json:
```json
{
    "body": "<a id='comment:24'></a>\nRebased to #13826.",
    "created_at": "2013-04-23T10:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224005",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Rebased to #13826.



---

archive/issue_comments_224006.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2013-04-23T18:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224006",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to critical.



---

archive/issue_comments_224007.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-23T18:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224007",
    "user": "https://github.com/robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_224008.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks for debugging this! I filed http://trac.cython.org/cython_trac/ticket/810 about (what I think is) the underlying bug you uncovered with the lazy import stuff.",
    "created_at": "2013-04-23T18:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224008",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:26'></a>
Thanks for debugging this! I filed http://trac.cython.org/cython_trac/ticket/810 about (what I think is) the underlying bug you uncovered with the lazy import stuff.



---

archive/issue_events_041102.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-23T19:08:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14452#event-41102"
}
```



---

archive/issue_comments_224009.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-23T19:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224009",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_224010.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.9.rc0\"",
    "created_at": "2013-04-23T19:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224010",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.9.rc0"



---

archive/issue_comments_224011.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Robert Bradshaw\"",
    "created_at": "2013-04-23T19:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224011",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Robert Bradshaw"



---

archive/issue_comments_224012.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [robertwb](#comment%3A26):\n> Thanks for debugging this! I filed http://trac.cython.org/cython_trac/ticket/810 about (what I think is) the underlying bug you uncovered with the lazy import stuff. \n\nDo you have a better idea about what precisely is wrong? I isolated the problem, but I don't know why it segfaults.",
    "created_at": "2013-04-24T12:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224012",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
Replying to [robertwb](#comment%3A26):
> Thanks for debugging this! I filed http://trac.cython.org/cython_trac/ticket/810 about (what I think is) the underlying bug you uncovered with the lazy import stuff. 

Do you have a better idea about what precisely is wrong? I isolated the problem, but I don't know why it segfaults.



---

archive/issue_comments_224013.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,7 @@\n 1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)\n 2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)\n 3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)\n+4. Bug with `cpdef` keyword arguments in `lazy_import.pyx`: [http://trac.cython.org/cython_trac/ticket/810](http://trac.cython.org/cython_trac/ticket/810)\n \n With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.\n \n``````\n",
    "created_at": "2013-04-24T12:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14452",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14452#issuecomment-224013",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,7 @@
 1. Bug report about segfaults in libGAP: [http://trac.cython.org/cython_trac/ticket/808](http://trac.cython.org/cython_trac/ticket/808) (fixed in Cython 0.19)
 2. Bug with g++ on Solaris: [http://trac.cython.org/cython_trac/ticket/809](http://trac.cython.org/cython_trac/ticket/809) (patch in spkg and submitted upstream)
 3. Bug with g++ on Solaris: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57025) (deny it's a bug)
+4. Bug with `cpdef` keyword arguments in `lazy_import.pyx`: [http://trac.cython.org/cython_trac/ticket/810](http://trac.cython.org/cython_trac/ticket/810)
 
 With this spkg, all doctests pass, but the docbuilder (in particular the command `./sage --docbuild reference/combinat html`) crashes due to a problem with `lazy_import`: [attachment:sage_crash_W7eVMu.log] The Sage library patch works around this problem.
 
``````

