# Issue 14399: MPIR 2.6.0's test suite fails with GCC 4.8.0

archive/issues_014195.json:
```json
{
    "body": "The fix is fairly easy:\n\n```patch\n--- mpir-2.6.0/tests/mpz/t-scan.c.orig 2012-10-03 22:07:32.000000000 +0200\n+++ mpir-2.6.0/tests/mpz/t-scan.c 2013-04-02 18:39:17.704366985 +0200\n@@ -84,7 +84,7 @@\n \n               for (isize = 0; isize <= size; isize++)\n                 {\n-                  for (oindex = 0; oindex <= numberof (offset); oindex++)\n+                  for (oindex = 0; oindex < numberof (offset); oindex++)\n                     {\n                       o = offset[oindex];\n                       if ((int) isize*GMP_NUMB_BITS < -o)\n```\n\n---\n\n**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg)\n\n**md5sum:** `b54f86c06dac76947d47a7d0bb2f1dfc  mpir-2.6.0.p2.spkg`\n\n\n### mpir-2.6.0.p2 (Leif Leonhardy, April 3rd 2013)\n* #14399: MPIR 2.6.0's test suite fails with GCC 4.8.0\n  Rather surprisingly, this bug, now causing a segfault in MPIR's test suite,\n  apparently never showed up before.\n  Add patch (`mpz__t-scan-bugfix.patch`) fixing an invalid array access in\n  the test code.\n  Patch has been submitted upstream.\n\n\nAssignee: @nexttime\n\nCC:  jpflori\n\nKeywords: spkg t-scan segmentation fault segfault\n\nUpstream: Completely fixed; Fix reported upstream\n\nReviewer: Jean-Pierre Flori\n\nAuthor: Leif Leonhardy\n\nMerged: sage-5.9.beta4\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14399\n\n",
    "closed_at": "2013-04-04T17:41:01Z",
    "created_at": "2013-04-02T17:33:33Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "MPIR 2.6.0's test suite fails with GCC 4.8.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14399",
    "user": "https://github.com/nexttime"
}
```
The fix is fairly easy:

```patch
--- mpir-2.6.0/tests/mpz/t-scan.c.orig 2012-10-03 22:07:32.000000000 +0200
+++ mpir-2.6.0/tests/mpz/t-scan.c 2013-04-02 18:39:17.704366985 +0200
@@ -84,7 +84,7 @@
 
               for (isize = 0; isize <= size; isize++)
                 {
-                  for (oindex = 0; oindex <= numberof (offset); oindex++)
+                  for (oindex = 0; oindex < numberof (offset); oindex++)
                     {
                       o = offset[oindex];
                       if ((int) isize*GMP_NUMB_BITS < -o)
```

---

**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg)

**md5sum:** `b54f86c06dac76947d47a7d0bb2f1dfc  mpir-2.6.0.p2.spkg`


### mpir-2.6.0.p2 (Leif Leonhardy, April 3rd 2013)
* #14399: MPIR 2.6.0's test suite fails with GCC 4.8.0
  Rather surprisingly, this bug, now causing a segfault in MPIR's test suite,
  apparently never showed up before.
  Add patch (`mpz__t-scan-bugfix.patch`) fixing an invalid array access in
  the test code.
  Patch has been submitted upstream.


Assignee: @nexttime

CC:  jpflori

Keywords: spkg t-scan segmentation fault segfault

Upstream: Completely fixed; Fix reported upstream

Reviewer: Jean-Pierre Flori

Author: Leif Leonhardy

Merged: sage-5.9.beta4

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14399





---

archive/issue_comments_222856.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2013-04-02T17:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222856",
    "user": "https://github.com/nexttime"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_222857.json:
```json
{
    "body": "<a id='comment:2'></a>Upstream report is at [this mpir-devel thread](http://groups.google.com/group/mpir-devel/browse_thread/thread/a0b93780c50bc6ed).",
    "created_at": "2013-04-02T18:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222857",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>Upstream report is at [this mpir-devel thread](http://groups.google.com/group/mpir-devel/browse_thread/thread/a0b93780c50bc6ed).



---

archive/issue_comments_222858.json:
```json
{
    "body": "Attachment [mpir-2.6.0.p1-p2.diff](tarball://root/attachments/some-uuid/ticket14399/mpir-2.6.0.p1-p2.diff) by @nexttime created at 2013-04-03 13:36:21\n\nDiff between the `.p1` and the `.p2` spkg.  For reference / review only.",
    "created_at": "2013-04-03T13:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222858",
    "user": "https://github.com/nexttime"
}
```

Attachment [mpir-2.6.0.p1-p2.diff](tarball://root/attachments/some-uuid/ticket14399/mpir-2.6.0.p1-p2.diff) by @nexttime created at 2013-04-03 13:36:21

Diff between the `.p1` and the `.p2` spkg.  For reference / review only.



---

archive/issue_comments_222859.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-03T13:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222859",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_222860.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Completely fixed; Fix reported upstream\"",
    "created_at": "2013-04-03T13:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222860",
    "user": "https://github.com/nexttime"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Completely fixed; Fix reported upstream"



---

archive/issue_comments_222861.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,18 @@\n                        if ((int) isize*GMP_NUMB_BITS < -o)\n ```\n \n+---\n+\n+**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg)\n+\n+**md5sum:** `b54f86c06dac76947d47a7d0bb2f1dfc  mpir-2.6.0.p2.spkg`\n+\n+\n+### mpir-2.6.0.p2 (Leif Leonhardy, April 3rd 2013)\n+* #14399: MPIR 2.6.0's test suite fails with GCC 4.8.0\n+  Rather surprisingly, this bug, now causing a segfault in MPIR's test suite,\n+  apparently never showed up before.\n+  Add patch (`mpz__t-scan-bugfix.patch`) fixing an invalid array access in\n+  the test code.\n+  Patch has been submitted upstream.\n+\n``````\n",
    "created_at": "2013-04-03T13:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222861",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,18 @@
                        if ((int) isize*GMP_NUMB_BITS < -o)
 ```
 
+---
+
+**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p2.spkg)
+
+**md5sum:** `b54f86c06dac76947d47a7d0bb2f1dfc  mpir-2.6.0.p2.spkg`
+
+
+### mpir-2.6.0.p2 (Leif Leonhardy, April 3rd 2013)
+* #14399: MPIR 2.6.0's test suite fails with GCC 4.8.0
+  Rather surprisingly, this bug, now causing a segfault in MPIR's test suite,
+  apparently never showed up before.
+  Add patch (`mpz__t-scan-bugfix.patch`) fixing an invalid array access in
+  the test code.
+  Patch has been submitted upstream.
+
``````




---

archive/issue_comments_222862.json:
```json
{
    "body": "Changing author from \"\" to \"Leif Leonhardy\"",
    "created_at": "2013-04-03T13:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222862",
    "user": "https://github.com/nexttime"
}
```

Changing author from "" to "Leif Leonhardy"



---

archive/issue_comments_222863.json:
```json
{
    "body": "<a id='comment:4'></a>Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.",
    "created_at": "2013-04-03T16:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222863",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:4'></a>Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.



---

archive/issue_comments_222864.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jean-Pierre Flori\"",
    "created_at": "2013-04-03T16:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222864",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing reviewer from "" to "Jean-Pierre Flori"



---

archive/issue_comments_222865.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-03T16:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222865",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_222866.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 jpflori]:\n> Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.\n\n\nThanks.  I guess using GCC 4.8 will become less \"unusual\" soon.  (Ubuntu tends to incorporate patches from later versions into their \"previous\" GCC versions anyway, and as mentioned, it's rather surprising this long-lasting bug never caused problems before.  Although note that only the test code was broken, not the library itself.)",
    "created_at": "2013-04-03T17:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222866",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>Replying to [comment:4 jpflori]:
> Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.


Thanks.  I guess using GCC 4.8 will become less "unusual" soon.  (Ubuntu tends to incorporate patches from later versions into their "previous" GCC versions anyway, and as mentioned, it's rather surprising this long-lasting bug never caused problems before.  Although note that only the test code was broken, not the library itself.)



---

archive/issue_events_040883.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-04T17:41:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14399#event-40883"
}
```



---

archive/issue_comments_222867.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.9.beta4\"",
    "created_at": "2013-04-04T17:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222867",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.9.beta4"



---

archive/issue_comments_222868.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-04T17:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222868",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_222869.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n The fix is fairly easy:\n \n ```patch\n---- mpir-2.6.0/tests/mpz/t-scan.c.orig\t2012-10-03 22:07:32.000000000 +0200\n-+++ mpir-2.6.0/tests/mpz/t-scan.c\t2013-04-02 18:39:17.704366985 +0200\n+--- mpir-2.6.0/tests/mpz/t-scan.c.orig 2012-10-03 22:07:32.000000000 +0200\n++++ mpir-2.6.0/tests/mpz/t-scan.c 2013-04-02 18:39:17.704366985 +0200\n @@ -84,7 +84,7 @@\n  \n                for (isize = 0; isize <= size; isize++)\n``````\n",
    "created_at": "2015-09-06T13:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14399#issuecomment-222869",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 The fix is fairly easy:
 
 ```patch
---- mpir-2.6.0/tests/mpz/t-scan.c.orig	2012-10-03 22:07:32.000000000 +0200
-+++ mpir-2.6.0/tests/mpz/t-scan.c	2013-04-02 18:39:17.704366985 +0200
+--- mpir-2.6.0/tests/mpz/t-scan.c.orig 2012-10-03 22:07:32.000000000 +0200
++++ mpir-2.6.0/tests/mpz/t-scan.c 2013-04-02 18:39:17.704366985 +0200
 @@ -84,7 +84,7 @@
  
                for (isize = 0; isize <= size; isize++)
``````

