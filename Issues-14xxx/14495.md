# Issue 14495: Install ATLAS header files and cleanup IML spkg

archive/issues_014495.json:
```json
{
    "body": "Assignee: @jdemeyer\n\nCC:  @nexttime jpflori @jdemeyer @vbraun\n\nKeywords: atlas IML testsuite check cblas.h\n\nWith the new ATLAS spkg from #10508, iml fails its self tests. See [http://trac.sagemath.org/sage_trac/ticket/10508#comment:518](http://trac.sagemath.org/sage_trac/ticket/10508#comment:518) and later comments.\n\nUse spkgs at:\n* [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg) ([attachment:atlas-3.10.1.p1.diff spkg diff])\n* [http://boxen.math.washington.edu/home/jdemeyer/spkg/iml-1.0.1.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/iml-1.0.1.p15.spkg) ([attachment:iml-1.0.1.p15.diff spkg diff without deletes])\n\n**Apply** [attachment:14699_env_version_bump.patch] to `SAGE_ROOT`\n\nIssue created by migration from https://trac.sagemath.org/ticket/14699\n\n",
    "closed_at": "2013-06-17T12:06:01Z",
    "created_at": "2013-06-06T21:23:23Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Install ATLAS header files and cleanup IML spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14495",
    "user": "https://github.com/jhpalmieri"
}
```
Assignee: @jdemeyer

CC:  @nexttime jpflori @jdemeyer @vbraun

Keywords: atlas IML testsuite check cblas.h

With the new ATLAS spkg from #10508, iml fails its self tests. See [http://trac.sagemath.org/sage_trac/ticket/10508#comment:518](http://trac.sagemath.org/sage_trac/ticket/10508#comment:518) and later comments.

Use spkgs at:
* [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg) ([attachment:atlas-3.10.1.p1.diff spkg diff])
* [http://boxen.math.washington.edu/home/jdemeyer/spkg/iml-1.0.1.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/iml-1.0.1.p15.spkg) ([attachment:iml-1.0.1.p15.diff spkg diff without deletes])

**Apply** [attachment:14699_env_version_bump.patch] to `SAGE_ROOT`

Issue created by migration from https://trac.sagemath.org/ticket/14699





---

archive/issue_comments_183204.json:
```json
{
    "body": "Surely an ATLAS problem, see http://trac.sagemath.org/sage_trac/ticket/10508#comment:526 for a solution.\n\nI suggest we call at least install_inc and potentially install_lib from ATLAS build system to install headers and static libs.",
    "created_at": "2013-06-06T21:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183204",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Surely an ATLAS problem, see http://trac.sagemath.org/sage_trac/ticket/10508#comment:526 for a solution.

I suggest we call at least install_inc and potentially install_lib from ATLAS build system to install headers and static libs.



---

archive/issue_comments_183205.json:
```json
{
    "body": "Or just install which should call both of them.",
    "created_at": "2013-06-06T21:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183205",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Or just install which should call both of them.



---

archive/issue_comments_183206.json:
```json
{
    "body": "John, U sure about **sage**.math?\n\n```\n128.208.160.191\tsage.math.washington.edu sage sage.math\n```",
    "created_at": "2013-06-06T21:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183206",
    "user": "https://github.com/nexttime"
}
```

John, U sure about **sage**.math?

```
128.208.160.191	sage.math.washington.edu sage sage.math
```



---

archive/issue_comments_183207.json:
```json
{
    "body": "Replying to [comment:3 leif]:\n> John, U sure about **sage**.math?\n> \n> ```\n> 128.208.160.191\tsage.math.washington.edu sage sage.math\n> ```\n\n(As opposed to\n\n```\n;; ANSWER SECTION:\nsage.math.washington.edu. 600\tIN\tA\t128.208.160.197\n```\nwhich is boxen.)",
    "created_at": "2013-06-06T21:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183207",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:3 leif]:
> John, U sure about **sage**.math?
> 
> ```
> 128.208.160.191	sage.math.washington.edu sage sage.math
> ```

(As opposed to

```
;; ANSWER SECTION:
sage.math.washington.edu. 600	IN	A	128.208.160.197
```
which is boxen.)



---

archive/issue_comments_183208.json:
```json
{
    "body": "It would be nice to fix that on top of #14605 which I've tested quite extensively and is finished since some time.",
    "created_at": "2013-06-06T21:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183208",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

It would be nice to fix that on top of #14605 which I've tested quite extensively and is finished since some time.



---

archive/issue_comments_183209.json:
```json
{
    "body": "+1 to also again install static libs.",
    "created_at": "2013-06-06T21:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183209",
    "user": "https://github.com/nexttime"
}
```

+1 to also again install static libs.



---

archive/issue_comments_183210.json:
```json
{
    "body": "Changing keywords from \"\" to \"atlas\".",
    "created_at": "2013-06-06T21:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183210",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing keywords from "" to "atlas".



---

archive/issue_comments_183211.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2013-06-06T21:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183211",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing priority from major to critical.



---

archive/issue_comments_183212.json:
```json
{
    "body": "In fact disregard my comment about #14605.\nWe should fix the issue here quickly, hopefully before 5.10 official release if it's not too late.\nAlthough as it does not seem to prevent anything from working except for IML testsuite, 5.11 should be ok as well.",
    "created_at": "2013-06-06T21:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183212",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

In fact disregard my comment about #14605.
We should fix the issue here quickly, hopefully before 5.10 official release if it's not too late.
Although as it does not seem to prevent anything from working except for IML testsuite, 5.11 should be ok as well.



---

archive/issue_comments_183213.json:
```json
{
    "body": "Changing keywords from \"atlas\" to \"atlas IML testsuite check cblas.h\".",
    "created_at": "2013-06-06T21:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183213",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "atlas" to "atlas IML testsuite check cblas.h".



---

archive/issue_comments_183214.json:
```json
{
    "body": "A side-effect of this ticket is probably that numpy gets built without ATLAS acceleration.",
    "created_at": "2013-06-06T22:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183214",
    "user": "https://trac.sagemath.org/admin/accounts/users/Koen"
}
```

A side-effect of this ticket is probably that numpy gets built without ATLAS acceleration.



---

archive/issue_comments_183215.json:
```json
{
    "body": "For the record, I did get\n\n```\nATLAS_CFLAGS=''\nATLAS_LIBS='-lcblas -latlas'\n```\n`-L${SAGE_LOCAL}/lib` \"incidentally\" came from / for GMP, although **after** `-lcblas -latlas`, but we meanwhile add `${SAGE_LOCAL}/lib` to `LIBRARY_PATH` (in `sage-env`), so that it worked.",
    "created_at": "2013-06-06T22:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183215",
    "user": "https://github.com/nexttime"
}
```

For the record, I did get

```
ATLAS_CFLAGS=''
ATLAS_LIBS='-lcblas -latlas'
```
`-L${SAGE_LOCAL}/lib` "incidentally" came from / for GMP, although **after** `-lcblas -latlas`, but we meanwhile add `${SAGE_LOCAL}/lib` to `LIBRARY_PATH` (in `sage-env`), so that it worked.



---

archive/issue_comments_183216.json:
```json
{
    "body": "P.S.:  Although IIRC according to POSIX, `-Ldir1 -lfoo -Ldir2 -lbar` is the same as `-Ldir1 -Ldir2 -lfoo -lbar`.",
    "created_at": "2013-06-06T22:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183216",
    "user": "https://github.com/nexttime"
}
```

P.S.:  Although IIRC according to POSIX, `-Ldir1 -lfoo -Ldir2 -lbar` is the same as `-Ldir1 -Ldir2 -lfoo -lbar`.



---

archive/issue_comments_183217.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-06T22:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183217",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_183218.json:
```json
{
    "body": "Replying to [comment:11 leif]:\n> P.S.:  Although IIRC according to POSIX, `-Ldir1 -lfoo -Ldir2 -lbar` is the same as `-Ldir1 -Ldir2 -lfoo -lbar`.\n\n\nAt least GNU `ld` docs agree with this:\n\n  *All -L options apply to all -l options, regardless of the order in which the options appear.*",
    "created_at": "2013-06-06T22:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183218",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:11 leif]:
> P.S.:  Although IIRC according to POSIX, `-Ldir1 -lfoo -Ldir2 -lbar` is the same as `-Ldir1 -Ldir2 -lfoo -lbar`.


At least GNU `ld` docs agree with this:

  *All -L options apply to all -l options, regardless of the order in which the options appear.*



---

archive/issue_comments_183219.json:
```json
{
    "body": "You'd still need a line\n\n```\n    cmd += ' --incdir=' + os.path.join(conf['SAGE_LOCAL'],'include') \n```\nin `configure_atlas_library()` for the header files to go the correct place?\n\nAnd currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).",
    "created_at": "2013-06-06T22:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183219",
    "user": "https://trac.sagemath.org/admin/accounts/users/Koen"
}
```

You'd still need a line

```
    cmd += ' --incdir=' + os.path.join(conf['SAGE_LOCAL'],'include') 
```
in `configure_atlas_library()` for the header files to go the correct place?

And currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).



---

archive/issue_comments_183220.json:
```json
{
    "body": "Replying to [comment:14 Koen]:\n> You'd still need a line\n> \n> ```\n>     cmd += ' --incdir=' + os.path.join(conf['SAGE_LOCAL'],'include') \n> ```\n> in `configure_atlas_library()` for the header files to go the correct place?\n\nI don't think so.\nWe use prefix and that should be enough from what I've seen in ATLAS configure script.",
    "created_at": "2013-06-06T22:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183220",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:14 Koen]:
> You'd still need a line
> 
> ```
>     cmd += ' --incdir=' + os.path.join(conf['SAGE_LOCAL'],'include') 
> ```
> in `configure_atlas_library()` for the header files to go the correct place?

I don't think so.
We use prefix and that should be enough from what I've seen in ATLAS configure script.



---

archive/issue_comments_183221.json:
```json
{
    "body": "Replying to [comment:14 Koen]:\n> And currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).\n\nOn my gcc110 install (where IML testsuite fails), numpy uses ATLAS correctly.\nThere is no ATLAS symbols in the file you pointed because we now use a shared version of ATLAS.\nBut if I run ldd on the file it points to the ATLAS libs.\n\nAnd I seem to remember we had lots of troubles correctly biulding numpy and scipy with the new ATLAS so hopefully it was actually used.",
    "created_at": "2013-06-06T22:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183221",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:14 Koen]:
> And currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).

On my gcc110 install (where IML testsuite fails), numpy uses ATLAS correctly.
There is no ATLAS symbols in the file you pointed because we now use a shared version of ATLAS.
But if I run ldd on the file it points to the ATLAS libs.

And I seem to remember we had lots of troubles correctly biulding numpy and scipy with the new ATLAS so hopefully it was actually used.



---

archive/issue_comments_183222.json:
```json
{
    "body": "s/inlcude/include/\n\nand IMHO (=WTF?) also s/serial/single-threaded/g s/parallel/multi-threaded/g ... \n\n(but the latter is not JP's invention I guess)",
    "created_at": "2013-06-06T22:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183222",
    "user": "https://github.com/nexttime"
}
```

s/inlcude/include/

and IMHO (=WTF?) also s/serial/single-threaded/g s/parallel/multi-threaded/g ... 

(but the latter is not JP's invention I guess)



---

archive/issue_comments_183223.json:
```json
{
    "body": "Replying to [comment:17 leif]:\n> s/inlcude/include/\n\nDone.\n> \n> and IMHO (=WTF?) also s/serial/single-threaded/g s/parallel/multi-threaded/g ... \n> \n> (but the latter is not JP's invention I guess)\n\nNot mine indeed.",
    "created_at": "2013-06-06T22:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183223",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:17 leif]:
> s/inlcude/include/

Done.
> 
> and IMHO (=WTF?) also s/serial/single-threaded/g s/parallel/multi-threaded/g ... 
> 
> (but the latter is not JP's invention I guess)

Not mine indeed.



---

archive/issue_comments_183224.json:
```json
{
    "body": "Replying to [comment:16 jpflori]:\n> Replying to [comment:14 Koen]:\n> > And currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).\n\n> On my gcc110 install (where IML testsuite fails), numpy uses ATLAS correctly.\n> There is no ATLAS symbols in the file you pointed because we now use a shared version of ATLAS.\n> But if I run ldd on the file it points to the ATLAS libs.\n\n\nYes.\n\n```\n$ readelf -d local/lib/python2.7/site-packages/numpy/core/_dotblas.so\n\nDynamic section at offset 0x4dc0 contains 26 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libptf77blas.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libptcblas.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libatlas.so.2]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n ...\n```",
    "created_at": "2013-06-06T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183224",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:16 jpflori]:
> Replying to [comment:14 Koen]:
> > And currently numpy is built without Atlas (it uses another blas): local/lib/python2.7/site-packages/numpy/core/_dotblas.so normally contains ATL_* symbols (for an old Atlas 3.8.3 version, at least).

> On my gcc110 install (where IML testsuite fails), numpy uses ATLAS correctly.
> There is no ATLAS symbols in the file you pointed because we now use a shared version of ATLAS.
> But if I run ldd on the file it points to the ATLAS libs.


Yes.

```
$ readelf -d local/lib/python2.7/site-packages/numpy/core/_dotblas.so

Dynamic section at offset 0x4dc0 contains 26 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libptf77blas.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libptcblas.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libatlas.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 ...
```



---

archive/issue_comments_183225.json:
```json
{
    "body": "make_atlas() takes no argument.",
    "created_at": "2013-06-06T22:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183225",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

make_atlas() takes no argument.



---

archive/issue_comments_183226.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-06T22:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183226",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183227.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-06T22:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183227",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183228.json:
```json
{
    "body": "I saw the error on boxen. I thought that sage.math was dead? In any case, it's the machine I get to by typing `ssh sage.math.washington.edu`, and when I log off it says `Connection to sage.math.washington.edu closed.` The `$HOSTNAME` is boxen, though.",
    "created_at": "2013-06-06T23:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183228",
    "user": "https://github.com/jhpalmieri"
}
```

I saw the error on boxen. I thought that sage.math was dead? In any case, it's the machine I get to by typing `ssh sage.math.washington.edu`, and when I log off it says `Connection to sage.math.washington.edu closed.` The `$HOSTNAME` is boxen, though.



---

archive/issue_comments_183229.json:
```json
{
    "body": "On boxen, after installing the new ATLAS spkg, the current iml spkg installs and passes its tests. Same for an iml spkg which doesn't copy over the patched version of `configure`.",
    "created_at": "2013-06-07T00:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183229",
    "user": "https://github.com/jhpalmieri"
}
```

On boxen, after installing the new ATLAS spkg, the current iml spkg installs and passes its tests. Same for an iml spkg which doesn't copy over the patched version of `configure`.



---

archive/issue_comments_183230.json:
```json
{
    "body": "P.S.:  I guess the odd \"patch\" to IML's `configure` dates back to the times when ATLAS was somehow optional, or at least did not get properly detected on all systems.  Running / building IML's test suite on such systems was always broken then.\n\n(In other parts of Sage using IML, BLAS libraries get explicitly added by us when linking.)",
    "created_at": "2013-06-07T00:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183230",
    "user": "https://github.com/nexttime"
}
```

P.S.:  I guess the odd "patch" to IML's `configure` dates back to the times when ATLAS was somehow optional, or at least did not get properly detected on all systems.  Running / building IML's test suite on such systems was always broken then.

(In other parts of Sage using IML, BLAS libraries get explicitly added by us when linking.)



---

archive/issue_comments_183231.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2013-06-07T07:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183231",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_183232.json:
```json
{
    "body": "**Do not install static libraries**, its a feature that we don't.\n\nAlso, nobody in his right mind expects blas headers. This is why the iml testsuite, which the authors probably didn't expect to be distributed, is the only place that trips over it. For starters, there is no universal naming standard (blas.h vs. cblas.h vs. foo_cblas.h vs. foo/cblas.h). There are multiple blas implementations and if you all install them at the same place then they would overwrite each other.",
    "created_at": "2013-06-07T09:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183232",
    "user": "https://github.com/vbraun"
}
```

**Do not install static libraries**, its a feature that we don't.

Also, nobody in his right mind expects blas headers. This is why the iml testsuite, which the authors probably didn't expect to be distributed, is the only place that trips over it. For starters, there is no universal naming standard (blas.h vs. cblas.h vs. foo_cblas.h vs. foo/cblas.h). There are multiple blas implementations and if you all install them at the same place then they would overwrite each other.



---

archive/issue_comments_183233.json:
```json
{
    "body": "And if you need a reason for not installing static libraries you just have to look at this ticket where you got confused about whether something links against atlas or not. Shared libraries are the only way that make it clear **which particular atlas version** you are linking against and that you didn't accidentally pick up some system atlas.",
    "created_at": "2013-06-07T09:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183233",
    "user": "https://github.com/vbraun"
}
```

And if you need a reason for not installing static libraries you just have to look at this ticket where you got confused about whether something links against atlas or not. Shared libraries are the only way that make it clear **which particular atlas version** you are linking against and that you didn't accidentally pick up some system atlas.



---

archive/issue_comments_183234.json:
```json
{
    "body": "I disagree that nobody expects the blas headers. If I try to install a package on top of Sage, e.g. the Shogun machine learning toolbox, then it will only compile in certain features if it can find a blas - and for that it needs blas headers. With older sage versions this works just fine.",
    "created_at": "2013-06-07T09:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183234",
    "user": "https://trac.sagemath.org/admin/accounts/users/Koen"
}
```

I disagree that nobody expects the blas headers. If I try to install a package on top of Sage, e.g. the Shogun machine learning toolbox, then it will only compile in certain features if it can find a blas - and for that it needs blas headers. With older sage versions this works just fine.



---

archive/issue_comments_183235.json:
```json
{
    "body": "Shogun just makes it unnecessarily complicated for themselves, you need to define preprocessor constants to tell it which blas header to look for...\n\nI agree that we should have blas/cblas/f77blas **headers** since its the right thing to do. But when we fix the IML testsuite we shouldn't introduce that as a dependency, because very often the headers are either not installed or installed with a funky name.",
    "created_at": "2013-06-07T09:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183235",
    "user": "https://github.com/vbraun"
}
```

Shogun just makes it unnecessarily complicated for themselves, you need to define preprocessor constants to tell it which blas header to look for...

I agree that we should have blas/cblas/f77blas **headers** since its the right thing to do. But when we fix the IML testsuite we shouldn't introduce that as a dependency, because very often the headers are either not installed or installed with a funky name.



---

archive/issue_events_042099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-07T09:56:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42099"
}
```



---

archive/issue_comments_183236.json:
```json
{
    "body": "Replying to [comment:26 vbraun]:\n> **Do not install static libraries**, its a feature that we don't.\n\n\nAt least they shouldn't get discarded, which is simply stupid.",
    "created_at": "2013-06-07T10:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183236",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:26 vbraun]:
> **Do not install static libraries**, its a feature that we don't.


At least they shouldn't get discarded, which is simply stupid.



---

archive/issue_comments_183237.json:
```json
{
    "body": "Btw., the new spkg and afterwards IML installed without problems, and both passed their test suites on Linux x86_64 (Ubuntu 10.04.4, Sage 5.10.rc0).",
    "created_at": "2013-06-07T10:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183237",
    "user": "https://github.com/nexttime"
}
```

Btw., the new spkg and afterwards IML installed without problems, and both passed their test suites on Linux x86_64 (Ubuntu 10.04.4, Sage 5.10.rc0).



---

archive/issue_comments_183238.json:
```json
{
    "body": "Replying to [comment:31 leif]:\n> At least they shouldn't get discarded, which is simply stupid.\n\n\nDo you also object to discarding the `*.o` files? We delete what we don't want around in the install, thats the way it works. Ideally upstream would have an `--disable-static` switch, but they don't.",
    "created_at": "2013-06-07T10:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183238",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:31 leif]:
> At least they shouldn't get discarded, which is simply stupid.


Do you also object to discarding the `*.o` files? We delete what we don't want around in the install, thats the way it works. Ideally upstream would have an `--disable-static` switch, but they don't.



---

archive/issue_comments_183239.json:
```json
{
    "body": "Removed the static library install bit from the spkg",
    "created_at": "2013-06-07T10:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183239",
    "user": "https://github.com/vbraun"
}
```

Removed the static library install bit from the spkg



---

archive/issue_comments_183240.json:
```json
{
    "body": "Replying to [comment:33 vbraun]:\n> Replying to [comment:31 leif]:\n> > At least they shouldn't get discarded, which is simply stupid.\n\n> \n> Do you also object to discarding the `*.o` files?\n\n\n`man ar`?",
    "created_at": "2013-06-07T11:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183240",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:33 vbraun]:
> Replying to [comment:31 leif]:
> > At least they shouldn't get discarded, which is simply stupid.

> 
> Do you also object to discarding the `*.o` files?


`man ar`?



---

archive/issue_comments_183241.json:
```json
{
    "body": "Replying to [comment:35 leif]:\n> `man ar`?\n\n\nI take it that this means that you agree with me, and we should neither install object files nor static libraries ;-)",
    "created_at": "2013-06-07T11:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183241",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:35 leif]:
> `man ar`?


I take it that this means that you agree with me, and we should neither install object files nor static libraries ;-)



---

archive/issue_comments_183242.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-06-08T13:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183242",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_183243.json:
```json
{
    "body": "Probably vote on sage-devel on whether to discard the static libraries or not.",
    "created_at": "2013-06-08T13:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183243",
    "user": "https://github.com/nexttime"
}
```

Probably vote on sage-devel on whether to discard the static libraries or not.



---

archive/issue_comments_183244.json:
```json
{
    "body": "Replying to [comment:31 leif]:\n> Replying to [comment:26 vbraun]:\n> > **Do not install static libraries**, its a feature that we don't.\n\n> \n> At least they shouldn't get discarded, which is simply stupid.\n\nHaving static libraries rather than nothing on systems where building shared ones is problematic might be nice...\nAlso note it's the only option upstream really supports.",
    "created_at": "2013-06-08T13:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183244",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:31 leif]:
> Replying to [comment:26 vbraun]:
> > **Do not install static libraries**, its a feature that we don't.

> 
> At least they shouldn't get discarded, which is simply stupid.

Having static libraries rather than nothing on systems where building shared ones is problematic might be nice...
Also note it's the only option upstream really supports.



---

archive/issue_comments_183245.json:
```json
{
    "body": "Replying to [comment:38 leif]:\n> Probably vote on sage-devel on whether to discard the static libraries or not.\n\n\n... or make it optional.",
    "created_at": "2013-06-08T13:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183245",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:38 leif]:
> Probably vote on sage-devel on whether to discard the static libraries or not.


... or make it optional.



---

archive/issue_comments_183246.json:
```json
{
    "body": "Done, see https://groups.google.com/d/msg/sage-devel/mthuvh5SRpQ/nDekknXc76IJ",
    "created_at": "2013-06-08T15:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183246",
    "user": "https://github.com/vbraun"
}
```

Done, see https://groups.google.com/d/msg/sage-devel/mthuvh5SRpQ/nDekknXc76IJ



---

archive/issue_comments_183247.json:
```json
{
    "body": "Can we please concentrate on the actual ticket issue here, which is about header files and iml failing? I don't think this has anything to do with static libraries (but please correct me if I'm wrong).",
    "created_at": "2013-06-10T12:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183247",
    "user": "https://github.com/jdemeyer"
}
```

Can we please concentrate on the actual ticket issue here, which is about header files and iml failing? I don't think this has anything to do with static libraries (but please correct me if I'm wrong).



---

archive/issue_comments_183248.json:
```json
{
    "body": "Attachment [atlas-3.10.1.p1.diff](tarball://root/attachments/some-uuid/ticket14699/atlas-3.10.1.p1.diff) by @jdemeyer created at 2013-06-10 12:26:31",
    "created_at": "2013-06-10T12:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183248",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [atlas-3.10.1.p1.diff](tarball://root/attachments/some-uuid/ticket14699/atlas-3.10.1.p1.diff) by @jdemeyer created at 2013-06-10 12:26:31



---

archive/issue_comments_183249.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-06-10T12:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183249",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_183250.json:
```json
{
    "body": "Ok.\nOnly concentrating on that, I'm ok with Volker changes to my changes.",
    "created_at": "2013-06-10T12:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183250",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Ok.
Only concentrating on that, I'm ok with Volker changes to my changes.



---

archive/issue_comments_183251.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-06-10T12:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183251",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_183252.json:
```json
{
    "body": "I'm ok with Jean-Pierre changes to the extent that I haven't changed them, of course.",
    "created_at": "2013-06-10T12:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183252",
    "user": "https://github.com/vbraun"
}
```

I'm ok with Jean-Pierre changes to the extent that I haven't changed them, of course.



---

archive/issue_comments_183253.json:
```json
{
    "body": "Replying to [comment:42 jdemeyer]:\n> Can we please concentrate on the actual ticket issue here, which is about header files and iml failing? I don't think this has anything to do with static libraries (but please correct me if I'm wrong).\n\n\nWell, if we used ATLAS' install rather than further hacking, we'd get both the headers and the static libraries.\n\nI don't see any reason why **discarding** static libraries should be done by default; if someone feels they're dangerous to him/her, we could add some option to *automatically* remove them, although that's IMHO a pretty unimportant feature.",
    "created_at": "2013-06-10T13:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183253",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:42 jdemeyer]:
> Can we please concentrate on the actual ticket issue here, which is about header files and iml failing? I don't think this has anything to do with static libraries (but please correct me if I'm wrong).


Well, if we used ATLAS' install rather than further hacking, we'd get both the headers and the static libraries.

I don't see any reason why **discarding** static libraries should be done by default; if someone feels they're dangerous to him/her, we could add some option to *automatically* remove them, although that's IMHO a pretty unimportant feature.



---

archive/issue_comments_183254.json:
```json
{
    "body": "P.S.:  Removing the \"patch\" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.",
    "created_at": "2013-06-10T13:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183254",
    "user": "https://github.com/nexttime"
}
```

P.S.:  Removing the "patch" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.



---

archive/issue_comments_183255.json:
```json
{
    "body": "Replying to [comment:46 leif]:\n> P.S.:  Removing the \"patch\" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.\n\n\nThen either attach a fixed iml spkg to this packet real soon (TM) or open a ticket for it. But don't leave footnotes on finished tickets.",
    "created_at": "2013-06-10T13:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183255",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:46 leif]:
> P.S.:  Removing the "patch" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.


Then either attach a fixed iml spkg to this packet real soon (TM) or open a ticket for it. But don't leave footnotes on finished tickets.



---

archive/issue_comments_183256.json:
```json
{
    "body": "Replying to [comment:47 vbraun]:\n> Replying to [comment:46 leif]:\n> > P.S.:  Removing the \"patch\" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.\n\n> \n> Then either attach a fixed iml spkg to this packet real soon (TM) or open a ticket for it. But don't leave footnotes on finished tickets.\n\n\nI was saying it's **IMHO** not finished.",
    "created_at": "2013-06-10T14:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183256",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:47 vbraun]:
> Replying to [comment:46 leif]:
> > P.S.:  Removing the "patch" to IML's `configure` from the IML spkg IMHO belongs to this ticket as well, as that was hiding (or rather obscuring) the real problem.

> 
> Then either attach a fixed iml spkg to this packet real soon (TM) or open a ticket for it. But don't leave footnotes on finished tickets.


I was saying it's **IMHO** not finished.



---

archive/issue_comments_183257.json:
```json
{
    "body": "Indeed, the ticket original title was about IML testsuite, so we should also provide an IML spkg (quite trivial just remove the horrible patch disabling test for cblas.h).\n\nleif: could you make the spkg? I'll quickly review it.",
    "created_at": "2013-06-10T15:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183257",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Indeed, the ticket original title was about IML testsuite, so we should also provide an IML spkg (quite trivial just remove the horrible patch disabling test for cblas.h).

leif: could you make the spkg? I'll quickly review it.



---

archive/issue_comments_183258.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-06-10T15:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183258",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_183259.json:
```json
{
    "body": "Or at least we should provide this fixed IML spkg in a follow up ticket mentioned here and put as blocker for 5.10.",
    "created_at": "2013-06-10T15:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183259",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Or at least we should provide this fixed IML spkg in a follow up ticket mentioned here and put as blocker for 5.10.



---

archive/issue_comments_183260.json:
```json
{
    "body": "This doesn't at all work with `SAGE_ATLAS_LIB` [unless the headers happen to be installed system-wide, which is the same situation as before], since headers don't get copied / symlinked.\n\n\n\n\nWhat happens on MacOS X (where Sage's ATLAS by default doesn't get built)?\n\n(Similar for Cygwin perhaps.)\n\nReplying to [comment:49 jpflori]:\n> Indeed, the ticket original title was about IML testsuite, so we should also provide an IML spkg (quite trivial just remove the horrible patch disabling test for cblas.h).\n\n\nSo I'm not sure if it's really that easy.",
    "created_at": "2013-06-10T19:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183260",
    "user": "https://github.com/nexttime"
}
```

This doesn't at all work with `SAGE_ATLAS_LIB` [unless the headers happen to be installed system-wide, which is the same situation as before], since headers don't get copied / symlinked.




What happens on MacOS X (where Sage's ATLAS by default doesn't get built)?

(Similar for Cygwin perhaps.)

Replying to [comment:49 jpflori]:
> Indeed, the ticket original title was about IML testsuite, so we should also provide an IML spkg (quite trivial just remove the horrible patch disabling test for cblas.h).


So I'm not sure if it's really that easy.



---

archive/issue_comments_183261.json:
```json
{
    "body": "Yeah, I was just looking into that...\nNot really anything useful to do when a system-wide ATLAS is used.\n\nDoes really no software linking to ATLAS expect to find headers in some standard or provided place?\nDo they all provide their own BLAS headers and expect everything to be fine?",
    "created_at": "2013-06-10T19:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183261",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Yeah, I was just looking into that...
Not really anything useful to do when a system-wide ATLAS is used.

Does really no software linking to ATLAS expect to find headers in some standard or provided place?
Do they all provide their own BLAS headers and expect everything to be fine?



---

archive/issue_comments_183262.json:
```json
{
    "body": "Its pretty much common practice to use your own blas/lapack headers. For example, linbox/fflas: http://linalg.org/projects/fflas-ffpack/browser/fflas-ffpack/config-blas.h Definitely weird, but then its probably the most stable API ever. And the lack of uniform naming of the header across vendors doesn't help.",
    "created_at": "2013-06-10T19:52:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183262",
    "user": "https://github.com/vbraun"
}
```

Its pretty much common practice to use your own blas/lapack headers. For example, linbox/fflas: http://linalg.org/projects/fflas-ffpack/browser/fflas-ffpack/config-blas.h Definitely weird, but then its probably the most stable API ever. And the lack of uniform naming of the header across vendors doesn't help.



---

archive/issue_comments_183263.json:
```json
{
    "body": "A test spkg is at:\n* http://boxen.math.washington.edu/home/jpflori/spkg/iml-1.0.1.p15.spkg\nNot really wonderful as the src directory still includes a modified upstream source, but maybe a little bit better looking.\nNot tested yet, I'm doing it right now.",
    "created_at": "2013-06-10T20:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183263",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

A test spkg is at:
* http://boxen.math.washington.edu/home/jpflori/spkg/iml-1.0.1.p15.spkg
Not really wonderful as the src directory still includes a modified upstream source, but maybe a little bit better looking.
Not tested yet, I'm doing it right now.



---

archive/issue_comments_183264.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-10T20:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183264",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183265.json:
```json
{
    "body": "The use of `\"$SAGE_LOCAL\"/lib/libatlas.so.*.*` seems to assume that there is exactly one file matching `\"$SAGE_LOCAL\"/lib/libatlas.so.*.*`\n\nI doubt that this assumption is true in general.",
    "created_at": "2013-06-10T20:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183265",
    "user": "https://github.com/jdemeyer"
}
```

The use of `"$SAGE_LOCAL"/lib/libatlas.so.*.*` seems to assume that there is exactly one file matching `"$SAGE_LOCAL"/lib/libatlas.so.*.*`

I doubt that this assumption is true in general.



---

archive/issue_comments_183266.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-10T20:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183266",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183267.json:
```json
{
    "body": "Quite true (just wondering if we really want to support Sage's installs with multiple ATLAS version installed?).",
    "created_at": "2013-06-10T20:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183267",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Quite true (just wondering if we really want to support Sage's installs with multiple ATLAS version installed?).



---

archive/issue_comments_183268.json:
```json
{
    "body": "Working on IML spkg, hang on...",
    "created_at": "2013-06-10T21:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183268",
    "user": "https://github.com/jdemeyer"
}
```

Working on IML spkg, hang on...



---

archive/issue_comments_183269.json:
```json
{
    "body": "Of course I guess the IML testsuite will still fail on OS X or Cygwin.",
    "created_at": "2013-06-10T21:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183269",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Of course I guess the IML testsuite will still fail on OS X or Cygwin.



---

archive/issue_comments_183270.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-10T22:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183270",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183271.json:
```json
{
    "body": "IML spkg needs review, I restored upstream sources and added patches in the `patches/` directory. I know the patches can be catalogued and documented better, but let's leave that for next time...\n\nTested on Linux and OS X x86_64, IML (with testsuite) works.",
    "created_at": "2013-06-10T22:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183271",
    "user": "https://github.com/jdemeyer"
}
```

IML spkg needs review, I restored upstream sources and added patches in the `patches/` directory. I know the patches can be catalogued and documented better, but let's leave that for next time...

Tested on Linux and OS X x86_64, IML (with testsuite) works.



---

archive/issue_comments_183272.json:
```json
{
    "body": "Attachment [14699_env_version_bump.patch](tarball://root/attachments/some-uuid/ticket14699/14699_env_version_bump.patch) by @jdemeyer created at 2013-06-11 06:52:18",
    "created_at": "2013-06-11T06:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183272",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14699_env_version_bump.patch](tarball://root/attachments/some-uuid/ticket14699/14699_env_version_bump.patch) by @jdemeyer created at 2013-06-11 06:52:18



---

archive/issue_comments_183273.json:
```json
{
    "body": "I'm adding [attachment:14699_env_version_bump.patch] because ATLAS now requires the `FC` environment variable to be set, so it needs an up-to-date `sage-env`.",
    "created_at": "2013-06-11T06:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183273",
    "user": "https://github.com/jdemeyer"
}
```

I'm adding [attachment:14699_env_version_bump.patch] because ATLAS now requires the `FC` environment variable to be set, so it needs an up-to-date `sage-env`.



---

archive/issue_comments_183274.json:
```json
{
    "body": "Attachment [iml-1.0.1.p15.diff](tarball://root/attachments/some-uuid/ticket14699/iml-1.0.1.p15.diff) by @jdemeyer created at 2013-06-11 07:08:09\n\nSpkg diff, for review only.",
    "created_at": "2013-06-11T07:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183274",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [iml-1.0.1.p15.diff](tarball://root/attachments/some-uuid/ticket14699/iml-1.0.1.p15.diff) by @jdemeyer created at 2013-06-11 07:08:09

Spkg diff, for review only.



---

archive/issue_comments_183275.json:
```json
{
    "body": "Replying to [comment:66 jdemeyer]:\n> I'm adding [attachment:14699_env_version_bump.patch] because ATLAS now requires the `FC` environment variable to be set, so it needs an up-to-date `sage-env`.\n\nWhat does that achieve exactly?\nJust looking at the patch, I cannot really guess.\nDoes it force upgrading the sage-env script?\n\nA question for Volker: How does the SO_VERSION variable in the ATLAS autotools project be updated?",
    "created_at": "2013-06-11T08:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183275",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:66 jdemeyer]:
> I'm adding [attachment:14699_env_version_bump.patch] because ATLAS now requires the `FC` environment variable to be set, so it needs an up-to-date `sage-env`.

What does that achieve exactly?
Just looking at the patch, I cannot really guess.
Does it force upgrading the sage-env script?

A question for Volker: How does the SO_VERSION variable in the ATLAS autotools project be updated?



---

archive/issue_comments_183276.json:
```json
{
    "body": "I'll copy the comments from `sage-env`:\n\n```\n# Don't execute the commands more than once for the same version of\n# sage-env.  Check this after checking the validity of SAGE_ROOT, but\n# before modifying its value.\n#\n# The idea of versioning is that SAGE_ENV_SOURCED will be set to a\n# \"version number\" of sage-env.  If a different version of sage-env was\n# sourced earlier (when upgrading), we still source the new version.\n# The sage-env version should be increased whenever a newer sage-env is\n# required for upgrading.  Note that spkg/standard/deps might also need\n# to be changed: the packages which need the new sage-env must depend on\n# SAGE_ROOT_REPO (the root repo contains sage-env).\n#\n# sage-env version history:\n# - sage-4.7.1: version 1 (#10469)\n# - sage-5.4:   version 2 (#13395)\n#\nSAGE_ENV_VERSION=2\nif [ \"$SAGE_ENV_SOURCED\" = \"$SAGE_ENV_VERSION\" ]; then\n    # Already sourced, nothing to do.\n    return 0\nfi\nexport SAGE_ENV_SOURCED=$SAGE_ENV_VERSION\n```",
    "created_at": "2013-06-11T09:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183276",
    "user": "https://github.com/jdemeyer"
}
```

I'll copy the comments from `sage-env`:

```
# Don't execute the commands more than once for the same version of
# sage-env.  Check this after checking the validity of SAGE_ROOT, but
# before modifying its value.
#
# The idea of versioning is that SAGE_ENV_SOURCED will be set to a
# "version number" of sage-env.  If a different version of sage-env was
# sourced earlier (when upgrading), we still source the new version.
# The sage-env version should be increased whenever a newer sage-env is
# required for upgrading.  Note that spkg/standard/deps might also need
# to be changed: the packages which need the new sage-env must depend on
# SAGE_ROOT_REPO (the root repo contains sage-env).
#
# sage-env version history:
# - sage-4.7.1: version 1 (#10469)
# - sage-5.4:   version 2 (#13395)
#
SAGE_ENV_VERSION=2
if [ "$SAGE_ENV_SOURCED" = "$SAGE_ENV_VERSION" ]; then
    # Already sourced, nothing to do.
    return 0
fi
export SAGE_ENV_SOURCED=$SAGE_ENV_VERSION
```



---

archive/issue_comments_183277.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-11T21:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183277",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_183278.json:
```json
{
    "body": "In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).\n\nAnd when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.",
    "created_at": "2013-06-11T21:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183278",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).

And when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.



---

archive/issue_comments_183279.json:
```json
{
    "body": "Replying to [comment:69 jpflori]:\n> In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).\n\nIt's already exported before. No need to \"reexport\" it.\n\n> And when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.\n\nIndeed, that's a Trac bug.",
    "created_at": "2013-06-12T06:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183279",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:69 jpflori]:
> In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).

It's already exported before. No need to "reexport" it.

> And when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.

Indeed, that's a Trac bug.



---

archive/issue_comments_183280.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-12T06:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183280",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_183281.json:
```json
{
    "body": "I should also note that the only *new* patch in IML is `patches/remove_repl.patch`, all the others were already (pre-patched) in the spkg.",
    "created_at": "2013-06-12T07:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183281",
    "user": "https://github.com/jdemeyer"
}
```

I should also note that the only *new* patch in IML is `patches/remove_repl.patch`, all the others were already (pre-patched) in the spkg.



---

archive/issue_comments_183282.json:
```json
{
    "body": "Replying to [comment:70 jdemeyer]:\n> Replying to [comment:69 jpflori]:\n> > In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).\n\n> It's already exported before. No need to \"reexport\" it.\n> \n\nDamn, I was not aware of that!\n> > And when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.\n\n> Indeed, that's a Trac bug.",
    "created_at": "2013-06-12T18:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183282",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:70 jdemeyer]:
> Replying to [comment:69 jpflori]:
> > In the IMl spkg, you don't reexport CFLAGS after checking for SAGE64 (both in spkg-check and spkg-install).

> It's already exported before. No need to "reexport" it.
> 

Damn, I was not aware of that!
> > And when looking through trac there is a strange .patch part about renaming sage3_memleak, but that may just be a trac issue.

> Indeed, that's a Trac bug.



---

archive/issue_comments_183283.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-06-14T08:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183283",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_183284.json:
```json
{
    "body": "The spkg looks good, seems to work on my systems.",
    "created_at": "2013-06-14T08:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183284",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

The spkg looks good, seems to work on my systems.



---

archive/issue_comments_183285.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-14T09:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183285",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_042100.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-14T09:19:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42100"
}
```



---

archive/issue_comments_183286.json:
```json
{
    "body": "Thanks for the review, do you by chance feel like reviewing the IML upgrade at #748?",
    "created_at": "2013-06-14T09:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183286",
    "user": "https://github.com/jdemeyer"
}
```

Thanks for the review, do you by chance feel like reviewing the IML upgrade at #748?



---

archive/issue_comments_183287.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2013-06-17T12:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183287",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_042101.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:04:33Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42101"
}
```



---

archive/issue_comments_183288.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2013-06-17T12:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183288",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_183289.json:
```json
{
    "body": "Reverting the ATLAS package: #14753.",
    "created_at": "2013-06-17T12:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183289",
    "user": "https://github.com/jdemeyer"
}
```

Reverting the ATLAS package: #14753.



---

archive/issue_events_042102.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:04:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42102"
}
```



---

archive/issue_events_042103.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:04:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42103"
}
```



---

archive/issue_comments_183290.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-06-17T12:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183290",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_042104.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:06:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42104"
}
```



---

archive/issue_events_042105.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:06:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42105"
}
```



---

archive/issue_events_042106.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:06:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14495#event-42106"
}
```



---

archive/issue_comments_183291.json:
```json
{
    "body": "Keeping \"merged in\" information for future reference, we should not change this ticket further.",
    "created_at": "2013-06-17T12:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14495",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14495#issuecomment-183291",
    "user": "https://github.com/jdemeyer"
}
```

Keeping "merged in" information for future reference, we should not change this ticket further.
