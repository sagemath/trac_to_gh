# Issue 14619: Test if a graph is distance-regular

archive/issues_014415.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/nathanncohen",
        "https://github.com/rlmill"
    ],
    "body": "Nothing more that what the title says !\n\nNathann\n\nApply:\n* [attachment: 14619.patch](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)\n* [attachment: 14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)\n\nCC:  @dimpase @sagetrac-azi @sagetrac-Slani\n\nKeywords: **distance**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Nathann Cohen**\n\nMerged: **sage-5.12.beta5**\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14619_\n\n",
    "closed_at": "2013-09-04T08:06:22Z",
    "created_at": "2013-05-20T12:59:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Test if a graph is distance-regular",
    "type": "issue",
    "updated_at": "2014-02-27T10:29:08Z",
    "url": "https://github.com/sagemath/sage/issues/14619",
    "user": "https://github.com/nathanncohen"
}
```
Nothing more that what the title says !

Nathann

Apply:
* [attachment: 14619.patch](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)
* [attachment: 14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)

CC:  @dimpase @sagetrac-azi @sagetrac-Slani

Keywords: **distance**

Reviewer: **Frédéric Chapoton**

Author: **Nathann Cohen**

Merged: **sage-5.12.beta5**

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/14619_





---

archive/issue_events_207089.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207089"
}
```



---

archive/issue_events_207090.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207090"
}
```



---

archive/issue_events_207091.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207091"
}
```



---

archive/issue_events_207092.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207092"
}
```



---

archive/issue_events_207093.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "subject": "https://github.com/nathanncohen",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207093"
}
```



---

archive/issue_events_207094.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "subject": "https://github.com/nathanncohen",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207094"
}
```



---

archive/issue_events_207095.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2013-05-20T12:59:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "subject": "https://github.com/nathanncohen",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207095"
}
```



---

archive/issue_comments_177403.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nNetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?\n\nAlso is there a chance we would want to have a certificate for this function as well?",
    "created_at": "2013-05-20T13:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177403",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:1" align="right">comment:1</div>

NetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?

Also is there a chance we would want to have a certificate for this function as well?



---

archive/issue_comments_177404.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nYoooooooooo !\n\n> NetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?\n\nOh ? Well, I would be surprised if NetworkX could beat us for these distance functions\n\n> Also is there a chance we would want to have a certificate for this function as well?\n\nI don't see one. What could be a good certificate ? `O_o`\n\nNathann",
    "created_at": "2013-05-20T13:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177404",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:2" align="right">comment:2</div>

Yoooooooooo !

> NetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?

Oh ? Well, I would be surprised if NetworkX could beat us for these distance functions

> Also is there a chance we would want to have a certificate for this function as well?

I don't see one. What could be a good certificate ? `O_o`

Nathann



---

archive/issue_comments_177405.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nYeah. Precisely `:-P`\n\n```\nsage: import networkx                 \nsage: g = graphs.CubeGraph(9)         \nsage: gn = g.networkx_graph()         \nsage: %time g.is_distance_regular()   \nCPU times: user 0.03 s, sys: 0.00 s, total: 0.03 s\nWall time: 0.04 s\nTrue\nsage: networkx.is_distance_regular(gn)\nTrue\nsage: %time networkx.is_distance_regular(gn)\nCPU times: user 2.18 s, sys: 0.02 s, total: 2.20 s\nWall time: 2.20 s\nTrue\n```\n\nNathann",
    "created_at": "2013-05-20T13:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177405",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:3" align="right">comment:3</div>

Yeah. Precisely `:-P`

```
sage: import networkx                 
sage: g = graphs.CubeGraph(9)         
sage: gn = g.networkx_graph()         
sage: %time g.is_distance_regular()   
CPU times: user 0.03 s, sys: 0.00 s, total: 0.03 s
Wall time: 0.04 s
True
sage: networkx.is_distance_regular(gn)
True
sage: %time networkx.is_distance_regular(gn)
CPU times: user 2.18 s, sys: 0.02 s, total: 2.20 s
Wall time: 2.20 s
True
```

Nathann



---

archive/issue_events_207096.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-05-20T13:10:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207096"
}
```



---

archive/issue_comments_177406.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNice!\n\nWell for the certificate.. Perhaps not really a certificate but a distance partition.",
    "created_at": "2013-05-20T13:13:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177406",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:5" align="right">comment:5</div>

Nice!

Well for the certificate.. Perhaps not really a certificate but a distance partition.



---

archive/issue_comments_177407.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> Well for the certificate.. Perhaps not really a certificate but a distance partition.\n\nA distance partition ? `O_o`\n\nWhat do you mean ? You can already get the distribution of distances with ``parameters=True``, but I don't see what else we could return...\n\nNathann",
    "created_at": "2013-05-20T13:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177407",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

> Well for the certificate.. Perhaps not really a certificate but a distance partition.

A distance partition ? `O_o`

What do you mean ? You can already get the distribution of distances with ``parameters=True``, but I don't see what else we could return...

Nathann



---

archive/issue_comments_177408.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@sagetrac-azi](#comment:1):\n> NetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?\n> \n> Also is there a chance we would want to have a certificate for this function as well?\n\nwhat do you mean by \"certificate\"?\n\nThere is in fact an algebraic certificate of distance regularity, that is, the adjacency matrix A_k of the distance k graph of the original graph G is a polynomial in A_1 (the adjacency matrix of G). And these polynomials can be computed from the \"intersection arrays\". But that's a long story.",
    "created_at": "2013-05-20T13:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177408",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@sagetrac-azi](#comment:1):
> NetworkX should have a pretty decent test for distance regular graphs. Could you perhaps just verify the performance of yours vs NetworkX?
> 
> Also is there a chance we would want to have a certificate for this function as well?

what do you mean by "certificate"?

There is in fact an algebraic certificate of distance regularity, that is, the adjacency matrix A_k of the distance k graph of the original graph G is a polynomial in A_1 (the adjacency matrix of G). And these polynomials can be computed from the "intersection arrays". But that's a long story.



---

archive/issue_comments_177409.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n> what do you mean by \"certificate\"?\n\nWell, usually it is some short data which proves that the result returned is valid. Formally, I think that it is only defined for NP-Hard problems, but well...\n\n> There is in fact an algebraic certificate of distance regularity, that is, the adjacency matrix A_k of the distance k graph of the original graph G is a polynomial in A_1 (the adjacency matrix of G). And these polynomials can be computed from the \"intersection arrays\". But that's a long story.\n\nWell, that would fit the definition I guess. But I wouldn't know what to make of it `:-P`\n\nNathann",
    "created_at": "2013-05-20T13:32:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177409",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:8" align="right">comment:8</div>

> what do you mean by "certificate"?

Well, usually it is some short data which proves that the result returned is valid. Formally, I think that it is only defined for NP-Hard problems, but well...

> There is in fact an algebraic certificate of distance regularity, that is, the adjacency matrix A_k of the distance k graph of the original graph G is a polynomial in A_1 (the adjacency matrix of G). And these polynomials can be computed from the "intersection arrays". But that's a long story.

Well, that would fit the definition I guess. But I wouldn't know what to make of it `:-P`

Nathann



---

archive/issue_comments_177410.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFrom what I know the guys doing distance-regular graphs they use to write \"bubbles.\" They pick a vertex v which is the first \"bubble\", then they take the neighborhood of v to be the second bubble and then the neighbors at distance 3 from $v$ and so on...",
    "created_at": "2013-05-20T16:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177410",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:9" align="right">comment:9</div>

From what I know the guys doing distance-regular graphs they use to write "bubbles." They pick a vertex v which is the first "bubble", then they take the neighborhood of v to be the second bubble and then the neighbors at distance 3 from $v$ and so on...



---

archive/issue_comments_177411.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@sagetrac-azi](#comment:9):\n> From what I know the guys doing distance-regular graphs they use to write \"bubbles.\" They pick a vertex v which is the first \"bubble\", then they take the neighborhood of v to be the second bubble and then the neighbors at distance 3 from $v$ and so on... \n\nsure, one not only wants to know whether the graph is distance regular, but also its parameters\n(analog of k, lambda, mu for strongly regular graphs). E.g. GRAPE, a GAP package, does the following:\nhttp://www.maths.qmul.ac.uk/~leonard/grape/manual/CHAP004.htm#SECT002\n(see `GlobalParameters()`).\nAnd you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?",
    "created_at": "2013-05-20T22:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177411",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@sagetrac-azi](#comment:9):
> From what I know the guys doing distance-regular graphs they use to write "bubbles." They pick a vertex v which is the first "bubble", then they take the neighborhood of v to be the second bubble and then the neighbors at distance 3 from $v$ and so on... 

sure, one not only wants to know whether the graph is distance regular, but also its parameters
(analog of k, lambda, mu for strongly regular graphs). E.g. GRAPE, a GAP package, does the following:
http://www.maths.qmul.ac.uk/~leonard/grape/manual/CHAP004.htm#SECT002
(see `GlobalParameters()`).
And you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?



---

archive/issue_comments_177412.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nYoooooooooo !\n\n> And you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?\n\nIt is already available in the patch\n\n```\nsage: graphs.CubeGraph(4).is_distance_regular(parameters = True)\n{1: 4, 2: 6, 3: 4, 4: 1}\n```\n\nnathann",
    "created_at": "2013-05-21T07:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177412",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:11" align="right">comment:11</div>

Yoooooooooo !

> And you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?

It is already available in the patch

```
sage: graphs.CubeGraph(4).is_distance_regular(parameters = True)
{1: 4, 2: 6, 3: 4, 4: 1}
```

nathann



---

archive/issue_comments_177413.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@nathanncohen](#comment:11):\n> Yoooooooooo !\n> \n> > And you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?\n\n> \n> It is already available in the patch\n> \n> ```\n> sage: graphs.CubeGraph(4).is_distance_regular(parameters = True)\n> {1: 4, 2: 6, 3: 4, 4: 1}\n> ```\n> \n\nand how about `local parameters`: i.e. computing parameters w.r.t. just 1 vertex?\nThis would also allow to return a certificate of non-distance-regularity, i.e. either a vertex for which parameters don't exist, or two vertices with different parameters (for the latter, you can test on complete bipartite graphs with parts of unequal size).",
    "created_at": "2013-05-21T07:53:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177413",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@nathanncohen](#comment:11):
> Yoooooooooo !
> 
> > And you have this kind of info when checking distance regularity anyway, so why not have a corresponding function?

> 
> It is already available in the patch
> 
> ```
> sage: graphs.CubeGraph(4).is_distance_regular(parameters = True)
> {1: 4, 2: 6, 3: 4, 4: 1}
> ```
> 

and how about `local parameters`: i.e. computing parameters w.r.t. just 1 vertex?
This would also allow to return a certificate of non-distance-regularity, i.e. either a vertex for which parameters don't exist, or two vertices with different parameters (for the latter, you can test on complete bipartite graphs with parts of unequal size).



---

archive/issue_comments_177414.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n> and how about `local parameters`: i.e. computing parameters w.r.t. just 1 vertex?\n> This would also allow to return a certificate of non-distance-regularity, i.e. either a vertex for which parameters don't exist, or two vertices with different parameters (for the latter, you can test on complete bipartite graphs with parts of unequal size).\n\nOh. Well, we do not have a \"distance all vertices\" method at Python level, which would return the kind of information you want, though we have it in the backends\n\nhttp://www.sagemath.org/doc/reference/graphs/sage/graphs/base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.shortest_path_all_vertices\n\nWe could return as a NO-certificate a pair of vertices that do not have the same \"local parameters\", as you say. And I would probably change the output so that it returns a pair, `(True/False, certificate)` instead.\n\nDo you think that it would be useful to expose this `distance_all_vertices` method at Python level ? And/or only `shortest_path_all_vertices` ? I don't really like it myself, but if you think that it would be useful ...\n\nNathann",
    "created_at": "2013-05-21T08:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177414",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:13" align="right">comment:13</div>

> and how about `local parameters`: i.e. computing parameters w.r.t. just 1 vertex?
> This would also allow to return a certificate of non-distance-regularity, i.e. either a vertex for which parameters don't exist, or two vertices with different parameters (for the latter, you can test on complete bipartite graphs with parts of unequal size).

Oh. Well, we do not have a "distance all vertices" method at Python level, which would return the kind of information you want, though we have it in the backends

http://www.sagemath.org/doc/reference/graphs/sage/graphs/base/c_graph.html#sage.graphs.base.c_graph.CGraphBackend.shortest_path_all_vertices

We could return as a NO-certificate a pair of vertices that do not have the same "local parameters", as you say. And I would probably change the output so that it returns a pair, `(True/False, certificate)` instead.

Do you think that it would be useful to expose this `distance_all_vertices` method at Python level ? And/or only `shortest_path_all_vertices` ? I don't really like it myself, but if you think that it would be useful ...

Nathann



---

archive/issue_events_207097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207097"
}
```



---

archive/issue_events_207098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207098"
}
```



---

archive/issue_comments_177415.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nok, looks almost good to me (with my rather basic cython understanding)\n\na few details:\n\n* needs to be rebased (HUNK)\n* a typo in the doc `;;` instead of `::`\n* the function does not give the correct result for the connected graph with 2 vertices\n* you should say in the doc that distance-regular means **regular** + the distance condition\n* missing spaces before and after `==`",
    "created_at": "2013-08-29T12:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177415",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

ok, looks almost good to me (with my rather basic cython understanding)

a few details:

* needs to be rebased (HUNK)
* a typo in the doc `;;` instead of `::`
* the function does not give the correct result for the connected graph with 2 vertices
* you should say in the doc that distance-regular means **regular** + the distance condition
* missing spaces before and after `==`



---

archive/issue_comments_177416.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nYoooooooooooooo !!\n\n> * needs to be rebased (HUNK)\n\nDone !\n\n> * a typo in the doc `;;` instead of `::`\n\nDone !\n\n> * the function does not give the correct result for the connected graph with 2 vertices\n\nDone ! It was enough to change the `<= 2` to a `<= 1` in the beginning `;-)`\n\n> * you should say in the doc that distance-regular means **regular** + the distance condition\n\nWell, regularity is implied by distance regularity, for if a graph is distance-regular all vertices have \"the same number of vertices at distance 1\" (i.e. neighbors). I made that clear in an additional sentence of documentation.\n\n> * missing spaces before and after `==`\n\nFixed. In the whole file.\n\nI also noticed that there was an ugly segfault produced when the graph was disconnected. In this case, the \"distance\" between the two vertices is reported as 65536, but I try to write that in a the 65536th cell of a C array that may be much shorter. I began to write a proper fix to only run this method on connected graphs, and the method would have called itself on each connected component if the graph was not connected from the beginning, but I gave up this approach as it wouldd have added 15 lines of \"details\" to a code which isn't that clear already. Hence I chosed the lazy approach, which thanks to branch prediction in our CPU may not be that bad.\n\nAnd it can be changed, if this is a problem later on.\n\nHere it is ! Former rebased patch, and the answer to your remarks.\n\nThaaaaaaaaaanks !\n\nNathann",
    "created_at": "2013-08-29T12:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177416",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:16" align="right">comment:16</div>

Yoooooooooooooo !!

> * needs to be rebased (HUNK)

Done !

> * a typo in the doc `;;` instead of `::`

Done !

> * the function does not give the correct result for the connected graph with 2 vertices

Done ! It was enough to change the `<= 2` to a `<= 1` in the beginning `;-)`

> * you should say in the doc that distance-regular means **regular** + the distance condition

Well, regularity is implied by distance regularity, for if a graph is distance-regular all vertices have "the same number of vertices at distance 1" (i.e. neighbors). I made that clear in an additional sentence of documentation.

> * missing spaces before and after `==`

Fixed. In the whole file.

I also noticed that there was an ugly segfault produced when the graph was disconnected. In this case, the "distance" between the two vertices is reported as 65536, but I try to write that in a the 65536th cell of a C array that may be much shorter. I began to write a proper fix to only run this method on connected graphs, and the method would have called itself on each connected component if the graph was not connected from the beginning, but I gave up this approach as it wouldd have added 15 lines of "details" to a code which isn't that clear already. Hence I chosed the lazy approach, which thanks to branch prediction in our CPU may not be that bad.

And it can be changed, if this is a problem later on.

Here it is ! Former rebased patch, and the answer to your remarks.

Thaaaaaaaaaanks !

Nathann



---

archive/issue_comments_177417.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nalmost good to go. I would like this function to appear in the doc !",
    "created_at": "2013-08-29T15:33:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177417",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

almost good to go. I would like this function to appear in the doc !



---

archive/issue_comments_177418.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n> almost good to go. I would like this function to appear in the doc !\n\nYeah ?... Well it does, doesn't it ?\n\nNathann",
    "created_at": "2013-08-29T15:55:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177418",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:18" align="right">comment:18</div>

> almost good to go. I would like this function to appear in the doc !

Yeah ?... Well it does, doesn't it ?

Nathann



---

archive/issue_comments_177419.json:
```json
{
    "body": "Changed keywords from none to **distance**",
    "created_at": "2013-08-29T16:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177419",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from none to **distance**



---

archive/issue_comments_177420.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n Nothing more that what the title says !\n \n Nathann\n+\n+Apply:\n+* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)\n+* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)\n``````\n",
    "created_at": "2013-08-29T16:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177420",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
 Nothing more that what the title says !
 
 Nathann
+
+Apply:
+* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)
+* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)
``````




---

archive/issue_events_207099.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-08-29T16:02:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207099"
}
```



---

archive/issue_events_207100.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-08-29T16:02:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207100"
}
```



---

archive/issue_comments_177421.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nok, I have found it in undirected graphs documentation\n\nI am giving a positive review, not waiting for the bot to do its job.",
    "created_at": "2013-08-29T16:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177421",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

ok, I have found it in undirected graphs documentation

I am giving a positive review, not waiting for the bot to do its job.



---

archive/issue_comments_177422.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2013-08-29T16:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177422",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_177423.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nCool. Thaaaaaaaaaaaaaaaaaanks ! `:-)`\n\nNathann",
    "created_at": "2013-08-29T16:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177423",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:20" align="right">comment:20</div>

Cool. Thaaaaaaaaaaaaaaaaaanks ! `:-)`

Nathann



---

archive/issue_comments_177424.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n Nathann\n \n Apply:\n-* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)\n-* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)\n+* [attachment: trac_14619.patch]\n+* [attachment: trac_14619-rev.patch]\n``````\n",
    "created_at": "2013-08-29T16:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177424",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 Nathann
 
 Apply:
-* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)
-* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)
+* [attachment: trac_14619.patch]
+* [attachment: trac_14619-rev.patch]
``````




---

archive/issue_comments_177425.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n Nathann\n \n Apply:\n-* [attachment: trac_14619.patch]\n-* [attachment: trac_14619-rev.patch]\n+* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)\n+* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)\n``````\n",
    "created_at": "2013-08-30T08:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177425",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 Nathann
 
 Apply:
-* [attachment: trac_14619.patch]
-* [attachment: trac_14619-rev.patch]
+* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)
+* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)
``````




---

archive/issue_comments_177426.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThere is something wrong with the filenames of these patches, there are some weird characters at the end. The same issue also happened with the \"part5\" patch of #14980. Please find out why and fix it.",
    "created_at": "2013-08-30T08:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177426",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

There is something wrong with the filenames of these patches, there are some weird characters at the end. The same issue also happened with the "part5" patch of #14980. Please find out why and fix it.



---

archive/issue_events_207101.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-30T08:35:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207101"
}
```



---

archive/issue_events_207102.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-30T08:35:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207102"
}
```



---

archive/issue_comments_177427.json:
```json
{
    "body": "Work Issues: **patch filenames**",
    "created_at": "2013-08-30T08:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177427",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **patch filenames**



---

archive/issue_comments_177428.json:
```json
{
    "body": "Attachment: **[14619.patch.gz](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)**",
    "created_at": "2013-08-30T08:43:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177428",
    "user": "https://github.com/nathanncohen"
}
```

Attachment: **[14619.patch.gz](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)**



---

archive/issue_comments_177429.json:
```json
{
    "body": "Attachment: **[14619-rev.patch.gz](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)**",
    "created_at": "2013-08-30T08:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177429",
    "user": "https://github.com/nathanncohen"
}
```

Attachment: **[14619-rev.patch.gz](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)**



---

archive/issue_comments_177430.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n Nathann\n \n Apply:\n-* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)\n-* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)\n+* [attachment: 14619.patch](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)\n+* [attachment: 14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)\n``````\n",
    "created_at": "2013-08-30T08:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177430",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 Nathann
 
 Apply:
-* [attachment: trac_14619.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619.patch.gz)
-* [attachment: trac_14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/trac_14619-rev.patch.gz)
+* [attachment: 14619.patch](https://github.com/sagemath/sage/files/ticket14619/14619.patch.gz)
+* [attachment: 14619-rev.patch](https://github.com/sagemath/sage/files/ticket14619/14619-rev.patch.gz)
``````




---

archive/issue_comments_177431.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nIt seems to be a very rare bug that happens when a file is named \"trac_14619.patch\". No idea on earth of what is happening.\n\nI \"fixed\" it.\n\nNathann",
    "created_at": "2013-08-30T08:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177431",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:24" align="right">comment:24</div>

It seems to be a very rare bug that happens when a file is named "trac_14619.patch". No idea on earth of what is happening.

I "fixed" it.

Nathann



---

archive/issue_events_207103.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-08-30T08:45:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207103"
}
```



---

archive/issue_events_207104.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-08-30T08:45:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207104"
}
```



---

archive/issue_comments_177432.json:
```json
{
    "body": "Changed work issues from **patch filenames** to none",
    "created_at": "2013-08-30T08:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177432",
    "user": "https://github.com/nathanncohen"
}
```

Changed work issues from **patch filenames** to none



---

archive/issue_events_207105.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-09-04T08:06:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207105"
}
```



---

archive/issue_events_207106.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-09-04T08:06:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14619#event-207106"
}
```



---

archive/issue_comments_177433.json:
```json
{
    "body": "Merged: **sage-5.12.beta5**",
    "created_at": "2013-09-04T08:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177433",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta5**



---

archive/issue_comments_177434.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI just checked this out, and the definition is not right.\nWith such a definition e.g. every vertex-transitive graph is \ndistance-regular, and this is clearly nonsense! I wish I had time to look at this 6 months ago :-(\n\nCf. http://permalink.gmane.org/gmane.comp.mathematics.sage.support/33339\nwhere this was pointed out...",
    "created_at": "2014-02-24T18:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177434",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

I just checked this out, and the definition is not right.
With such a definition e.g. every vertex-transitive graph is 
distance-regular, and this is clearly nonsense! I wish I had time to look at this 6 months ago :-(

Cf. http://permalink.gmane.org/gmane.comp.mathematics.sage.support/33339
where this was pointed out...



---

archive/issue_comments_177435.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAn example of a graph on 12 vertices which satisfies the wrong definition here, but is not distance-regular, can be constructed using GRAPE (a package of GAP included in Sage). It's vertex-transitive (and even edge-transitive) bipartite graph of diameter 3, which is not distance-regular. Some vertices (e.g. 1 and 6) at distance 2 from each other have 4 common neighbours, and some (e.g. 1 and 2) only 2 common neighbours, whereas this must be a constant across all distance 2 pairs.\nHere is the adjacency list (say for a doctest) of this graph (vertices from 1 to 12):\n\n```\n[ [   8,   9,  10,  11 ],\n  [   7,   9,  10,  12 ],\n  [   7,   8,  11,  12 ],\n  [   7,   8,  11,  12 ],\n  [   7,   9,  10,  12 ],\n  [   8,   9,  10,  11 ],\n  [   2,   3,   4,   5 ],\n  [   1,   3,   4,   6 ],\n  [   1,   2,   5,   6 ],\n  [   1,   2,   5,   6 ],\n  [   1,   3,   4,   6 ],\n  [   2,   3,   4,   5 ] ]\n```\n\nand this is the GAP computation\n\n```\n$ sage -gap\n...\ngap> LoadPackage(\"grape\");\ngap> gamma := JohnsonGraph(4,2);;                                     \ngap> B:=BipartiteDouble(gamma);; \ngap> GlobalParameters(B);\n[ [ 0, 0, 4 ], [ 1, 0, 3 ], [ -1, 0, -1 ], [ 4, 0, 0 ] ]\ngap> a:=AutGroupGraph(B);;\ngap> Orbits(a,[1..12]);\n[ [ 1, 2, 7, 5, 3, 8, 12, 4, 6, 11, 9, 10 ] ]\ngap> ha:=Stabilizer(a,1);;\ngap> Orbits(ha,[1..12]);\n[ [ 1 ], [ 2, 5, 3, 4 ], [ 6 ], [ 7, 12 ], [ 8, 9, 10, 11 ] ]\ngap> List([1..12],x->Adjacency(B,x));\n[ [ 8, 9, 10, 11 ], [ 7, 9, 10, 12 ], [ 7, 8, 11, 12 ], [ 7, 8, 11, 12 ], [ 7, 9, 10, 12 ], [ 8, 9, 10, 11 ], [ 2, 3, 4, 5 ], [ 1, 3, 4, 6 ], \n  [ 1, 2, 5, 6 ], [ 1, 2, 5, 6 ], [ 1, 3, 4, 6 ], [ 2, 3, 4, 5 ] ]\n```",
    "created_at": "2014-02-24T19:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177435",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

An example of a graph on 12 vertices which satisfies the wrong definition here, but is not distance-regular, can be constructed using GRAPE (a package of GAP included in Sage). It's vertex-transitive (and even edge-transitive) bipartite graph of diameter 3, which is not distance-regular. Some vertices (e.g. 1 and 6) at distance 2 from each other have 4 common neighbours, and some (e.g. 1 and 2) only 2 common neighbours, whereas this must be a constant across all distance 2 pairs.
Here is the adjacency list (say for a doctest) of this graph (vertices from 1 to 12):

```
[ [   8,   9,  10,  11 ],
  [   7,   9,  10,  12 ],
  [   7,   8,  11,  12 ],
  [   7,   8,  11,  12 ],
  [   7,   9,  10,  12 ],
  [   8,   9,  10,  11 ],
  [   2,   3,   4,   5 ],
  [   1,   3,   4,   6 ],
  [   1,   2,   5,   6 ],
  [   1,   2,   5,   6 ],
  [   1,   3,   4,   6 ],
  [   2,   3,   4,   5 ] ]
```

and this is the GAP computation

```
$ sage -gap
...
gap> LoadPackage("grape");
gap> gamma := JohnsonGraph(4,2);;                                     
gap> B:=BipartiteDouble(gamma);; 
gap> GlobalParameters(B);
[ [ 0, 0, 4 ], [ 1, 0, 3 ], [ -1, 0, -1 ], [ 4, 0, 0 ] ]
gap> a:=AutGroupGraph(B);;
gap> Orbits(a,[1..12]);
[ [ 1, 2, 7, 5, 3, 8, 12, 4, 6, 11, 9, 10 ] ]
gap> ha:=Stabilizer(a,1);;
gap> Orbits(ha,[1..12]);
[ [ 1 ], [ 2, 5, 3, 4 ], [ 6 ], [ 7, 12 ], [ 8, 9, 10, 11 ] ]
gap> List([1..12],x->Adjacency(B,x));
[ [ 8, 9, 10, 11 ], [ 7, 9, 10, 12 ], [ 7, 8, 11, 12 ], [ 7, 8, 11, 12 ], [ 7, 9, 10, 12 ], [ 8, 9, 10, 11 ], [ 2, 3, 4, 5 ], [ 1, 3, 4, 6 ], 
  [ 1, 2, 5, 6 ], [ 1, 2, 5, 6 ], [ 1, 3, 4, 6 ], [ 2, 3, 4, 5 ] ]
```



---

archive/issue_comments_177436.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nsee #15864 for a fix.",
    "created_at": "2014-02-27T10:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14619",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14619#issuecomment-177436",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

see #15864 for a fix.
