# Issue 14866: Lazy imports, NilCoxeterAlgebra, Hall-Littlewood Polynomials

archive/issues_014662.json:
```json
{
    "assignees": [],
    "body": "Currently, at startup, algebras.all does `from nil_coxeter_algebra import NilCoxeterAlgebra`,\nwhich results in `import kfpoly` in combinat.sf.hall_littlewood in\nline 32, which creates PolynomialRing(ZZ,'t').\n\nThis should be made more lazy; there is no reason to import HL polynomials nor the NilCoxeterAlgebra at startup, *and* it would be nicer to not create a polynomial ring upon importing HL polynomials.\n\nAssignee: **sage-combinat**\n\nReviewer: **Volker Braun**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nMerged: **sage-5.12.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14866_\n\n",
    "closed_at": "2013-08-16T21:14:12Z",
    "created_at": "2013-07-07T21:41:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Lazy imports, NilCoxeterAlgebra, Hall-Littlewood Polynomials",
    "type": "issue",
    "updated_at": "2013-08-16T21:14:12Z",
    "url": "https://github.com/sagemath/sage/issues/14866",
    "user": "https://github.com/simon-king-jena"
}
```
Currently, at startup, algebras.all does `from nil_coxeter_algebra import NilCoxeterAlgebra`,
which results in `import kfpoly` in combinat.sf.hall_littlewood in
line 32, which creates PolynomialRing(ZZ,'t').

This should be made more lazy; there is no reason to import HL polynomials nor the NilCoxeterAlgebra at startup, *and* it would be nicer to not create a polynomial ring upon importing HL polynomials.

Assignee: **sage-combinat**

Reviewer: **Volker Braun**

Author: **Frédéric Chapoton**

Merged: **sage-5.12.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/14866_





---

archive/issue_events_194068.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-07-07T21:41:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194068"
}
```



---

archive/issue_events_194069.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-07-07T21:41:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194069"
}
```



---

archive/issue_events_194070.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-07-07T21:41:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194070"
}
```



---

archive/issue_events_194071.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-07-07T21:41:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194071"
}
```



---

archive/issue_events_194072.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-07-08T19:19:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194072"
}
```



---

archive/issue_comments_184661.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nhere is a patch, that hopefully does the job.",
    "created_at": "2013-07-08T19:19:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184661",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'>Comment 1:</a>
here is a patch, that hopefully does the job.



---

archive/issue_comments_184662.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nok, bot is happy, is there anybody for a review ?",
    "created_at": "2013-07-12T15:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184662",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'>Comment 2:</a>
ok, bot is happy, is there anybody for a review ?



---

archive/issue_comments_184663.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBy doing it this way, there is not a significant improvement to startup time, even though all 3 modules are not imported at startup. Also what is your criterion for lazily importing these three modules and not others (such as the Jack symmetric functions)? It feels kind of arbitrary to me.\n\nI think we should do the following:\n\n- Move the import of `kfpoly.py` into the appropriate method (as per the current patch)\n- Remove the `global_t` in `kfpoly.py` which will remove the creation (from `kfpoly.py` at least) of the poylnomial ring.\n- Have a well-defined set of criterion for when we should lazily import modules.\n\nBest,\n\nTravis",
    "created_at": "2013-07-13T12:54:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184663",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'>Comment 3:</a>
By doing it this way, there is not a significant improvement to startup time, even though all 3 modules are not imported at startup. Also what is your criterion for lazily importing these three modules and not others (such as the Jack symmetric functions)? It feels kind of arbitrary to me.

I think we should do the following:

- Move the import of `kfpoly.py` into the appropriate method (as per the current patch)
- Remove the `global_t` in `kfpoly.py` which will remove the creation (from `kfpoly.py` at least) of the poylnomial ring.
- Have a well-defined set of criterion for when we should lazily import modules.

Best,

Travis



---

archive/issue_comments_184664.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nAttachment: **[trac_14866_first_step.patch.gz](https://github.com/sagemath/sage/files/ticket14866/trac_14866_first_step.patch.gz)**\n\nok, I have (maybe) taken care of the global_t in kf_poly\n\nconcerning the policy for \"lazy_import\", I would vote for lazy_importing everybody, but I do not understand if it is good or not for the starting time.",
    "created_at": "2013-07-16T16:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184664",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'>Comment 4:</a>
Attachment: **[trac_14866_first_step.patch.gz](https://github.com/sagemath/sage/files/ticket14866/trac_14866_first_step.patch.gz)**

ok, I have (maybe) taken care of the global_t in kf_poly

concerning the policy for "lazy_import", I would vote for lazy_importing everybody, but I do not understand if it is good or not for the starting time.



---

archive/issue_events_194073.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-17T20:09:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194073"
}
```



---

archive/issue_events_194074.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-17T20:09:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194074"
}
```



---

archive/issue_comments_184665.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2013-07-17T20:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184665",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_184666.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2013-07-17T20:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184666",
    "user": "https://github.com/vbraun"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_comments_184667.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nLooks good to me.",
    "created_at": "2013-07-17T20:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184667",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'>Comment 5:</a>
Looks good to me.



---

archive/issue_comments_184668.json:
```json
{
    "body": "Merged: **sage-5.12.beta1**",
    "created_at": "2013-08-16T21:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14866#issuecomment-184668",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta1**



---

archive/issue_events_194075.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:14:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194075"
}
```



---

archive/issue_events_194076.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:14:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14866",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14866#event-194076"
}
```
