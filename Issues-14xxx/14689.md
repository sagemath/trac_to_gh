# Issue 14689: Atlas in sage 5.10.rc0 doesn't build on ARM chromebooks

archive/issues_014485.json:
```json
{
    "body": "I was trying to build sage 5.10.rc0 on a brand new box, and failed to build because the atlas spkg doesn't fall back to anything if 'fast' doesn't work.\n\n**Assignee:** GeorgSWeber\n\n**CC:**  jpflori\n\n**Reviewer:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/14689\n\n",
    "closed_at": "2014-12-18T07:39:25Z",
    "created_at": "2013-06-05T08:16:02Z",
    "labels": [
        "component: build",
        "critical",
        "bug",
        "invalid"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Atlas in sage 5.10.rc0 doesn't build on ARM chromebooks",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14689",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```
I was trying to build sage 5.10.rc0 on a brand new box, and failed to build because the atlas spkg doesn't fall back to anything if 'fast' doesn't work.

**Assignee:** GeorgSWeber

**CC:**  jpflori

**Reviewer:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/14689





---

archive/attachments_019777.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "atlas-3.10.1.p0.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14689/atlas-3.10.1.p0.log",
    "created_at": "2013-06-05T08:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```



---

archive/issue_comments_219969.json:
```json
{
    "body": "Log of the failing build",
    "created_at": "2013-06-05T08:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219969",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Log of the failing build



---

archive/issue_comments_219970.json:
```json
{
    "body": "**Assignee:** GeorgSWeber",
    "created_at": "2013-06-05T08:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219970",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

**Assignee:** GeorgSWeber



---

archive/attachments_019778.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "chromebook.cpuinfo",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14689/chromebook.cpuinfo",
    "created_at": "2013-06-05T09:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.cpuinfo",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```



---

archive/issue_comments_219971.json:
```json
{
    "body": "cpuinfo of the box",
    "created_at": "2013-06-05T09:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219971",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

cpuinfo of the box



---

archive/issue_events_048606.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "rename": {
        "from": "Atlas in sage 5.10.rc0 doesn't build if 'fast' doesn't work",
        "to": "Atlas in sage 5.10.rc0 doesn't build on ARM chromebooks"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48606"
}
```



---

archive/issue_comments_219972.json:
```json
{
    "body": "<a id='comment:3'></a>\nAccording to a discussion on #ubuntu-arm, -mfloat-abi=soft must have been forced down gcc's throat to make it want to #include stubs-soft.h, because it isn't correct for this platform.",
    "created_at": "2013-06-05T09:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219972",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:3'></a>
According to a discussion on #ubuntu-arm, -mfloat-abi=soft must have been forced down gcc's throat to make it want to #include stubs-soft.h, because it isn't correct for this platform.



---

archive/issue_comments_219973.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe box has gcc 4.7.3-1ubuntu1 and libc6 2.17-0ubuntu5.",
    "created_at": "2013-06-07T06:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219973",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:4'></a>
The box has gcc 4.7.3-1ubuntu1 and libc6 2.17-0ubuntu5.



---

archive/issue_comments_219974.json:
```json
{
    "body": "<a id='comment:5'></a>\nOk, I tried to know a little more about it and found: [this erratum](http://math-atlas.sourceforge.net/errata.html#armhardfp). I'll try to see what can be done about it with upstream.",
    "created_at": "2013-06-07T16:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219974",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:5'></a>
Ok, I tried to know a little more about it and found: [this erratum](http://math-atlas.sourceforge.net/errata.html#armhardfp). I'll try to see what can be done about it with upstream.



---

archive/issue_comments_219975.json:
```json
{
    "body": "<a id='comment:6'></a>\nOk, I have tried to use the erratum to get around the issue and go further ; indeed I manage to compile quite a few things afterwards, but matplotlib fails because numpy doesn't work:\n\n```\nImportError: /home/jpuydt/sage-5.10.rc1/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_\n```\nand the reason it doesn't work can only be found in numpy's log:\n\n```\n    Lapack library (from ATLAS) is probably incomplete:\n      size of /home/jpuydt/sage-5.10.rc1/local/lib/liblapack.so is 215k (expected >4000k)\n```\nI'll try to find out if the problem comes from:\n1. the upstream workaround not being complete ;\n2. my own repackaging of said workaround",
    "created_at": "2013-06-08T18:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219975",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:6'></a>
Ok, I have tried to use the erratum to get around the issue and go further ; indeed I manage to compile quite a few things afterwards, but matplotlib fails because numpy doesn't work:

```
ImportError: /home/jpuydt/sage-5.10.rc1/local/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so: undefined symbol: dpotrf_
```
and the reason it doesn't work can only be found in numpy's log:

```
    Lapack library (from ATLAS) is probably incomplete:
      size of /home/jpuydt/sage-5.10.rc1/local/lib/liblapack.so is 215k (expected >4000k)
```
I'll try to find out if the problem comes from:
1. the upstream workaround not being complete ;
2. my own repackaging of said workaround



---

archive/issue_comments_219976.json:
```json
{
    "body": "<a id='comment:7'></a>\nAnd the answer is: the upstream workaround is not complete.",
    "created_at": "2013-06-08T18:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219976",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:7'></a>
And the answer is: the upstream workaround is not complete.



---

archive/issue_comments_219977.json:
```json
{
    "body": "<a id='comment:8'></a>\nI had issues with ATLAS not building LAPACK on Solaris because it used the non POSIX -r option, but we patch that, so the reason is elsewhere...\n\nI'll give it a shot on an ARM devboard, but I fear it will be in two weeks from now...\n\nI could try on a Raspberry Pi inbetween but that will surely take as long to fail :)",
    "created_at": "2013-06-11T22:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219977",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:8'></a>
I had issues with ATLAS not building LAPACK on Solaris because it used the non POSIX -r option, but we patch that, so the reason is elsewhere...

I'll give it a shot on an ARM devboard, but I fear it will be in two weeks from now...

I could try on a Raspberry Pi inbetween but that will surely take as long to fail :)



---

archive/issue_comments_219978.json:
```json
{
    "body": "<a id='comment:9'></a>\nCould you post ATLAS log obtained after using the upstream workaround.\n\nFrom your posts I understand the spkg built successfully (or said so at least).",
    "created_at": "2013-06-11T22:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219978",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:9'></a>
Could you post ATLAS log obtained after using the upstream workaround.

From your posts I understand the spkg built successfully (or said so at least).



---

archive/issue_events_048607.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:34:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48607"
}
```



---

archive/issue_events_048608.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48608"
}
```



---

archive/issue_events_048609.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48609"
}
```



---

archive/issue_events_048610.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48610"
}
```



---

archive/issue_events_048611.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48611"
}
```



---

archive/issue_events_048612.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48612"
}
```



---

archive/issue_events_048613.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48613"
}
```



---

archive/issue_events_048614.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-14T17:28:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48614"
}
```



---

archive/issue_events_048615.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-12-14T17:28:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48615"
}
```



---

archive/issue_comments_219979.json:
```json
{
    "body": "<a id='comment:14'></a>\nObsolete...",
    "created_at": "2014-12-14T17:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219979",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Obsolete...



---

archive/issue_comments_219980.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2014-12-14T17:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219980",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_219981.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2014-12-14T17:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219981",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_219982.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2014-12-14T17:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14689#issuecomment-219982",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_048616.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-12-18T07:39:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14689",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14689#event-48616"
}
```
