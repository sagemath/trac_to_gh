# Issue 14068: nauty_geng is naughty

archive/issues_013864.json:
```json
{
    "body": "I think nauty_geng should not ignore geng's return value and return an exception if the returned value is not 0. Consider the following:\n\n```\ndef find_counterexample(n):\n   for G in graphs.nauty_geng(\"-c\" + str(n)):\n     if is_counterexample(G):\n        print 'Yeees, there is a counterexample'\n        return \n   print 'No counterexamples! Conjecture holds'\n```\n\nthe code appears to be just fine but it has a bug! Namely it tries to run the program geng with the parameter \"-cn\" instead of \"-c n\". Hence geng returns an error and instead of getting an error in Sage, it simply does not generate  any graphs.\n\nThe branch implements the catching of geng's error.\nWe also clean up the code of graph_generators a bit.\n\n---\n\n\n---\n\n\nAssignee: jason, ncohen, rlm\n\nCC:  @dimpase\n\nBranch/Commit: 93edfb05921b4fba999b9eda0c7f128d99be1f36\n\nReviewer: Dima Pasechnik\n\nAuthor: David Coudert, Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14068\n\n",
    "closed_at": "2019-10-03T17:58:42Z",
    "created_at": "2013-02-06T13:25:04Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "nauty_geng is naughty",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14068",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```
I think nauty_geng should not ignore geng's return value and return an exception if the returned value is not 0. Consider the following:

```
def find_counterexample(n):
   for G in graphs.nauty_geng("-c" + str(n)):
     if is_counterexample(G):
        print 'Yeees, there is a counterexample'
        return 
   print 'No counterexamples! Conjecture holds'
```

the code appears to be just fine but it has a bug! Namely it tries to run the program geng with the parameter "-cn" instead of "-c n". Hence geng returns an error and instead of getting an error in Sage, it simply does not generate  any graphs.

The branch implements the catching of geng's error.
We also clean up the code of graph_generators a bit.

---


---


Assignee: jason, ncohen, rlm

CC:  @dimpase

Branch/Commit: 93edfb05921b4fba999b9eda0c7f128d99be1f36

Reviewer: Dima Pasechnik

Author: David Coudert, Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14068





---

archive/issue_events_039592.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39592"
}
```



---

archive/issue_events_039593.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39593"
}
```



---

archive/issue_events_039594.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39594"
}
```



---

archive/issue_events_039595.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39595"
}
```



---

archive/issue_events_039596.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39596"
}
```



---

archive/issue_events_039597.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39597"
}
```



---

archive/issue_events_039598.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39598"
}
```



---

archive/issue_comments_215335.json:
```json
{
    "body": "Changing author from \"\" to \"David Coudert\"",
    "created_at": "2019-09-17T15:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215335",
    "user": "https://github.com/dcoudert"
}
```

Changing author from "" to "David Coudert"



---

archive/issue_comments_215336.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-17T15:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215336",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_215337.json:
```json
{
    "body": "<a id='comment:5'></a>A possible fix is to raise an error only when parameter debug is False and that something goes wrong.\n\nWhen debug is True, the behavior remains the same as before and so we continue to display the message output by geng in stderr.\n\n---\nNew commits:",
    "created_at": "2019-09-17T15:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215337",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>A possible fix is to raise an error only when parameter debug is False and that something goes wrong.

When debug is True, the behavior remains the same as before and so we continue to display the message output by geng in stderr.

---
New commits:



---

archive/issue_events_039599.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-09-17T15:44:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39599"
}
```



---

archive/issue_events_039600.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-09-17T15:44:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39600"
}
```



---

archive/issue_comments_215338.json:
```json
{
    "body": "Changing branch from \"\" to \"public/graphs/14068_nauty\"",
    "created_at": "2019-09-17T15:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215338",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "public/graphs/14068_nauty"



---

archive/issue_comments_215339.json:
```json
{
    "body": "Changing commit from \"\" to \"759fab2f8961aa5ab7e6d5e57ac96f9625f70080\"",
    "created_at": "2019-09-17T15:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215339",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "759fab2f8961aa5ab7e6d5e57ac96f9625f70080"



---

archive/issue_comments_215340.json:
```json
{
    "body": "<a id='comment:6'></a>I don't understand the reported pyflakes error with `sage.graphs.strongly_regular_db`. Other modules are imported the same way without causing pyflakes errors.",
    "created_at": "2019-09-18T09:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215340",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>I don't understand the reported pyflakes error with `sage.graphs.strongly_regular_db`. Other modules are imported the same way without causing pyflakes errors.



---

archive/issue_comments_215341.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [dcoudert](#comment%3A6):\n> I don't understand the reported pyflakes error with `sage.graphs.strongly_regular_db`. Other modules are imported the same way without causing pyflakes errors.\n\n\nperhaps pyflakes is confused by `staticmethod()` thing.\nThe only place where a method from `strongly_regular_db` is used is\n\n```\nstrongly_regular_graph = staticmethod(sage.graphs.strongly_regular_db.strongly_regular_graph)\n```\nby the way, I don't understand why it's not written as\n\n```\nfrom . import strongly_regular_db\n...\nstrongly_regular_graph = staticmethod(strongly_regular_db.strongly_regular_graph)\n```\nIs it cause this code pre-dates `from .` syntax?",
    "created_at": "2019-09-21T22:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215341",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>Replying to [dcoudert](#comment%3A6):
> I don't understand the reported pyflakes error with `sage.graphs.strongly_regular_db`. Other modules are imported the same way without causing pyflakes errors.


perhaps pyflakes is confused by `staticmethod()` thing.
The only place where a method from `strongly_regular_db` is used is

```
strongly_regular_graph = staticmethod(sage.graphs.strongly_regular_db.strongly_regular_graph)
```
by the way, I don't understand why it's not written as

```
from . import strongly_regular_db
...
strongly_regular_graph = staticmethod(strongly_regular_db.strongly_regular_graph)
```
Is it cause this code pre-dates `from .` syntax?



---

archive/issue_comments_215342.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-22T00:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215343.json:
```json
{
    "body": "Changing commit from \"759fab2f8961aa5ab7e6d5e57ac96f9625f70080\" to \"93edfb05921b4fba999b9eda0c7f128d99be1f36\"",
    "created_at": "2019-09-22T00:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215343",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "759fab2f8961aa5ab7e6d5e57ac96f9625f70080" to "93edfb05921b4fba999b9eda0c7f128d99be1f36"



---

archive/issue_comments_215344.json:
```json
{
    "body": "<a id='comment:10'></a>OK, otherwise looks good. let's see if this commit makes pyflakes happy",
    "created_at": "2019-09-22T00:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215344",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>OK, otherwise looks good. let's see if this commit makes pyflakes happy



---

archive/issue_comments_215345.json:
```json
{
    "body": "<a id='comment:11'></a>pyflakes is now happy !",
    "created_at": "2019-09-22T08:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215345",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>pyflakes is now happy !



---

archive/issue_comments_215346.json:
```json
{
    "body": "Changing author from \"David Coudert\" to \"David Coudert, Dima Pasechnik\"",
    "created_at": "2019-09-22T08:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215346",
    "user": "https://github.com/dimpase"
}
```

Changing author from "David Coudert" to "David Coudert, Dima Pasechnik"



---

archive/issue_comments_215347.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2019-09-22T08:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215347",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_215348.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-09-22T08:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215348",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_215349.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,4 +11,11 @@\n \n the code appears to be just fine but it has a bug! Namely it tries to run the program geng with the parameter \"-cn\" instead of \"-c n\". Hence geng returns an error and instead of getting an error in Sage, it simply does not generate  any graphs.\n \n-There are plenty of ways one could shot himself in the foot in this way and not know it. Hence I propose this gets fixed somehow!\n+The branch implements the catching of geng's error.\n+We also clean up the code of graph_generators a bit.\n+\n+---\n+\n+\n+---\n+\n``````\n",
    "created_at": "2019-09-22T08:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215349",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,4 +11,11 @@
 
 the code appears to be just fine but it has a bug! Namely it tries to run the program geng with the parameter "-cn" instead of "-c n". Hence geng returns an error and instead of getting an error in Sage, it simply does not generate  any graphs.
 
-There are plenty of ways one could shot himself in the foot in this way and not know it. Hence I propose this gets fixed somehow!
+The branch implements the catching of geng's error.
+We also clean up the code of graph_generators a bit.
+
+---
+
+
+---
+
``````




---

archive/issue_events_039601.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39601"
}
```



---

archive/issue_events_039602.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-09-30T08:12:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39602"
}
```



---

archive/issue_comments_215350.json:
```json
{
    "body": "<a id='comment:13'></a>moving milestone to 9.0 (after release of 8.9)",
    "created_at": "2019-09-30T08:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215350",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>moving milestone to 9.0 (after release of 8.9)



---

archive/issue_comments_215351.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-03T17:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215351",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_039603.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-03T17:58:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14068#event-39603"
}
```



---

archive/issue_comments_215352.json:
```json
{
    "body": "Changing branch from \"public/graphs/14068_nauty\" to \"93edfb05921b4fba999b9eda0c7f128d99be1f36\"",
    "created_at": "2019-10-03T17:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14068",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14068#issuecomment-215352",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/graphs/14068_nauty" to "93edfb05921b4fba999b9eda0c7f128d99be1f36"
