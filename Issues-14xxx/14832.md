# Issue 14832: Unified construction of irreducible polynomials over finite fields

archive/issues_014628.json:
```json
{
    "assignees": [
        "https://github.com/ClementPernet"
    ],
    "body": "Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  This ticket does the following:\n\n- implement a new class `PolynomialRing_dense_finite_field`\n- create methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.\n\nIn a separate ticket (#14833), the `FiniteField` constructor is adapted to call the new function.\n\nThe default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.\n\nSince it uses PARI's `ffinit`, this depends on #14818.\n\nApply:\n* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)\n* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)\n* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)\n* [attachment: trac_14832-doctest.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)\n\n\nDepends on #14817\nDepends on #14818\n\nCC:  @xcaruso\n\nComponent: **finite rings**\n\nKeywords: **polynomials**\n\nAuthor: **Peter Bruin**\n\nReviewer: **Jean-Pierre Flori**\n\nMerged: **sage-5.12.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14832_\n\n",
    "closed_at": "2013-08-16T21:12:58Z",
    "created_at": "2013-06-27T07:30:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Unified construction of irreducible polynomials over finite fields",
    "type": "issue",
    "updated_at": "2013-08-16T21:12:58Z",
    "url": "https://github.com/sagemath/sage/issues/14832",
    "user": "https://github.com/pjbruin"
}
```
Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  This ticket does the following:

- implement a new class `PolynomialRing_dense_finite_field`
- create methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.

In a separate ticket (#14833), the `FiniteField` constructor is adapted to call the new function.

The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.

Since it uses PARI's `ffinit`, this depends on #14818.

Apply:
* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)
* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)
* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)
* [attachment: trac_14832-doctest.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)


Depends on #14817
Depends on #14818

CC:  @xcaruso

Component: **finite rings**

Keywords: **polynomials**

Author: **Peter Bruin**

Reviewer: **Jean-Pierre Flori**

Merged: **sage-5.12.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/14832_





---

archive/issue_events_208884.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-06-27T07:30:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208884"
}
```



---

archive/issue_events_208885.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-06-27T07:30:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
    "label_color": "0000ff",
    "label_name": "c: finite rings",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208885"
}
```



---

archive/issue_events_208886.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-06-27T07:30:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208886"
}
```



---

archive/issue_events_208887.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-06-27T07:30:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208887"
}
```



---

archive/issue_events_208888.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2013-06-27T07:30:40Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "subject": "https://github.com/pjbruin",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208888"
}
```



---

archive/issue_comments_181553.json:
```json
{
    "body": "based on 5.11.beta3",
    "created_at": "2013-06-27T07:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181553",
    "user": "https://github.com/pjbruin"
}
```

based on 5.11.beta3



---

archive/issue_events_208889.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-06-27T07:42:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208889"
}
```



---

archive/issue_comments_181554.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_14832_make_irreducible_polynomial.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)**",
    "created_at": "2013-06-27T07:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181554",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_14832_make_irreducible_polynomial.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)**



---

archive/issue_comments_181555.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket, the `FiniteField` constructor will be adapted to call this function.\n+Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket (#14833), the `FiniteField` constructor is adapted to call this function.\n+\n+The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.\n \n Since it uses PARI's `ffinit`, this depends on #14817.\n \n``````\n",
    "created_at": "2013-06-27T07:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181555",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket, the `FiniteField` constructor will be adapted to call this function.
+Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket (#14833), the `FiniteField` constructor is adapted to call this function.
+
+The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.
 
 Since it uses PARI's `ffinit`, this depends on #14817.
 
``````




---

archive/issue_comments_181556.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,5 @@\n \n Since it uses PARI's `ffinit`, this depends on #14817.\n \n+Apply: [attachment: trac_14832_make_irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)\n+\n``````\n",
    "created_at": "2013-06-27T07:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181556",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,5 @@
 
 Since it uses PARI's `ffinit`, this depends on #14817.
 
+Apply: [attachment: trac_14832_make_irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)
+
``````




---

archive/issue_comments_181557.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nMoved finite field-specific code from `PolynomialRing_field.__init__()` to `PolynomialRing_dense_finite_field.__init__()`.",
    "created_at": "2013-06-29T10:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181557",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:4" align="right">comment:4</div>

Moved finite field-specific code from `PolynomialRing_field.__init__()` to `PolynomialRing_dense_finite_field.__init__()`.



---

archive/issue_comments_181558.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,13 @@\n-Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket (#14833), the `FiniteField` constructor is adapted to call this function.\n+Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  This ticket does the following:\n+\n+- implement a new class `PolynomialRing_dense_finite_field`\n+- create methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.\n+\n+In a separate ticket (#14833), the `FiniteField` constructor is adapted to call the new function.\n \n The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.\n \n Since it uses PARI's `ffinit`, this depends on #14817.\n \n-Apply: [attachment: trac_14832_make_irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)\n+Apply: [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz), [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)\n \n``````\n",
    "created_at": "2013-06-29T10:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181558",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,13 @@
-Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  Here is a patch that creates methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.  In a separate ticket (#14833), the `FiniteField` constructor is adapted to call this function.
+Currently, every finite field implementation (integers mod *p*, Givaro, NTL, PARI) has its own code for constructing an irreducible polynomial when given a string as the `modulus` keyword.  This ticket does the following:
+
+- implement a new class `PolynomialRing_dense_finite_field`
+- create methods `PolynomialRing_dense_{finite_field,mod_p}.irreducible_element(n, algorithm=None)`.
+
+In a separate ticket (#14833), the `FiniteField` constructor is adapted to call the new function.
 
 The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.
 
 Since it uses PARI's `ffinit`, this depends on #14817.
 
-Apply: [attachment: trac_14832_make_irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832_make_irreducible_polynomial.patch.gz)
+Apply: [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz), [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)
 
``````




---

archive/issue_comments_181559.json:
```json
{
    "body": "new class for polynomial rings over finite fields",
    "created_at": "2013-06-29T10:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181559",
    "user": "https://github.com/pjbruin"
}
```

new class for polynomial rings over finite fields



---

archive/issue_comments_181560.json:
```json
{
    "body": "Attachment: **[trac_14832-PolynomialRing_dense_finite_field.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)**\n\nmethod irreducible_element()",
    "created_at": "2013-06-29T10:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181560",
    "user": "https://github.com/pjbruin"
}
```

Attachment: **[trac_14832-PolynomialRing_dense_finite_field.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)**

method irreducible_element()



---

archive/issue_comments_181561.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[trac_14832-irreducible_polynomial.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)**\n\nIs there any reason for removing the implementation arg to the PR_field constructor?\nI agree it's not used, but maybe at some point :)\n\nAnd why not test in the PR_field constructor if the field is finite and call the new constructor in that case?\n\nBy the way, I'm not sure using is_FiniteField is the right way to check for finite fields.\nUsing the category framework and doing something like \"R in FiniteFields()\" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.",
    "created_at": "2013-07-08T14:43:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181561",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[trac_14832-irreducible_polynomial.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)**

Is there any reason for removing the implementation arg to the PR_field constructor?
I agree it's not used, but maybe at some point :)

And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.



---

archive/issue_comments_181562.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n(The same category stuff would be true for IntegerModRing and so on... but I'm not asking you to fix the old code, just not to introduce new \"bad\" stuff.)",
    "created_at": "2013-07-08T14:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181562",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:6" align="right">comment:6</div>

(The same category stuff would be true for IntegerModRing and so on... but I'm not asking you to fix the old code, just not to introduce new "bad" stuff.)



---

archive/issue_comments_181563.json:
```json
{
    "body": "Reviewer: **Jean-Pierre Flori**",
    "created_at": "2013-07-08T14:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181563",
    "user": "https://github.com/jpflori"
}
```

Reviewer: **Jean-Pierre Flori**



---

archive/issue_events_208890.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-07-08T14:49:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208890"
}
```



---

archive/issue_events_208891.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-07-08T14:49:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208891"
}
```



---

archive/issue_comments_181564.json:
```json
{
    "body": "Work Issues: **double colons, check for finite fields**",
    "created_at": "2013-07-08T14:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181564",
    "user": "https://github.com/jpflori"
}
```

Work Issues: **double colons, check for finite fields**



---

archive/issue_comments_181565.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYou also need to use two consecutive colons to introduce examples:\n\n```\nEXAMPLES::\n\n    sage: 1+1\n    2\n```\nor\n\n```\nEXAMPLES:\n\nWe check that 1+1 is equal to 2::\n\n    sage: 1+1\n    2\n```",
    "created_at": "2013-07-08T14:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181565",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:7" align="right">comment:7</div>

You also need to use two consecutive colons to introduce examples:

```
EXAMPLES::

    sage: 1+1
    2
```
or

```
EXAMPLES:

We check that 1+1 is equal to 2::

    sage: 1+1
    2
```



---

archive/issue_comments_181566.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jpflori](#comment%3A5):\n> Is there any reason for removing the implementation arg to the PR_field constructor?\n> I agree it's not used, but maybe at some point :)\n\n>\n> And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?\n\nI think it is better to be conservative with the `implementation` parameter: allow it for the generic `PolynomialRing` constructor and pass it to subclasses that actually have different implementations, but do not add (or keep) the flag in subclasses where it does not do anything.\n\n> By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.\n> Using the category framework and doing something like \"R in FiniteFields()\" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.\n\nI did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.\n\nFirst, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.\n\nSecond, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)",
    "created_at": "2013-07-11T16:59:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181566",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jpflori](#comment%3A5):
> Is there any reason for removing the implementation arg to the PR_field constructor?
> I agree it's not used, but maybe at some point :)

>
> And why not test in the PR_field constructor if the field is finite and call the new constructor in that case?

I think it is better to be conservative with the `implementation` parameter: allow it for the generic `PolynomialRing` constructor and pass it to subclasses that actually have different implementations, but do not add (or keep) the flag in subclasses where it does not do anything.

> By the way, I'm not sure using is_FiniteField is the right way to check for finite fields.
> Using the category framework and doing something like "R in FiniteFields()" is surely better unless you really rely on implementation details of the FiniteField class and subclasses.

I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.

First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.

Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)



---

archive/issue_comments_181567.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@pjbruin](#comment%3A8):\n> I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.\n> \n> First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.\n\n>\n\nI'd say that a subfield of an algebraic closure would be in the category of finite fields and the new one, just as it is as well in that of integral domains. \n> Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)\n\nI agree, but I don't think the test performed by is_FiniteField is to ensure implementations details, but really the fact that the robject represents a finite field.\n\nAnyway, as you pointed out you just moved the test  so let's keep this for later.\n\nIf you fix the doc, I'll happily positive review that.",
    "created_at": "2013-07-11T20:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181567",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@pjbruin](#comment%3A8):
> I did not introduce this way of checking for finite fields; I just moved it to a more specific `__init__` method.  Having said that, I wouldn't agree that using the category framework here is a good thing.
> 
> First, a finite field might be in different categories (e.g. `FiniteFields` or the future category of subfields of an algebraic closure of **F**<sub>*p*</sub> that we were discussing at #8335); probably the polynomial ring constructor shouldn't have to care about that.

>

I'd say that a subfield of an algebraic closure would be in the category of finite fields and the new one, just as it is as well in that of integral domains. 
> Second, one reason to have different implementations of `PolynomialRing` *is* so that we can take advantage of implementation details of (subclasses of) `FiniteField`.  There already is an implementation for polynomials over NTL finite fields; similarly, for PARI finite fields it would be desirable to have an implementation for polynomials over those fields.  (I have some code that is much slower than necessary because it uses PARI finite field elements but NTL polynomials over the same finite fields.)

I agree, but I don't think the test performed by is_FiniteField is to ensure implementations details, but really the fact that the robject represents a finite field.

Anyway, as you pointed out you just moved the test  so let's keep this for later.

If you fix the doc, I'll happily positive review that.



---

archive/issue_comments_181568.json:
```json
{
    "body": "Reviewer patch.",
    "created_at": "2013-07-11T21:21:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181568",
    "user": "https://github.com/jpflori"
}
```

Reviewer patch.



---

archive/issue_comments_181569.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAttachment: **[trac_14832-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)**",
    "created_at": "2013-07-11T21:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181569",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:10" align="right">comment:10</div>

Attachment: **[trac_14832-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)**



---

archive/issue_comments_181570.json:
```json
{
    "body": "Changed work issues from **double colons, check for finite fields** to none",
    "created_at": "2013-07-11T21:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181570",
    "user": "https://github.com/jpflori"
}
```

Changed work issues from **double colons, check for finite fields** to none



---

archive/issue_events_208892.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-07-11T21:21:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208892"
}
```



---

archive/issue_events_208893.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2013-07-11T21:21:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208893"
}
```



---

archive/issue_comments_181571.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,5 +9,8 @@\n \n Since it uses PARI's `ffinit`, this depends on #14817.\n \n-Apply: [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz), [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)\n+Apply:\n+* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),\n+* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),\n+* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).\n \n``````\n",
    "created_at": "2013-07-11T21:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181571",
    "user": "https://github.com/jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,5 +9,8 @@
 
 Since it uses PARI's `ffinit`, this depends on #14817.
 
-Apply: [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz), [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)
+Apply:
+* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),
+* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),
+* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).
 
``````




---

archive/issue_comments_181572.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nFor the patchbot, apply only:\n* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),\n* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),\n* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).",
    "created_at": "2013-07-12T09:44:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181572",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:11" align="right">comment:11</div>

For the patchbot, apply only:
* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),
* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),
* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).



---

archive/issue_comments_181573.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe patchbot doesn't get it:\n\nApply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch",
    "created_at": "2013-07-16T09:44:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181573",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:12" align="right">comment:12</div>

The patchbot doesn't get it:

Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch



---

archive/issue_comments_181574.json:
```json
{
    "body": "Changed dependencies from **#14817** to **#14817, #14818**",
    "created_at": "2013-07-16T11:43:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181574",
    "user": "https://github.com/pjbruin"
}
```

Changed dependencies from **#14817** to **#14817, #14818**



---

archive/issue_comments_181575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n \n The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.\n \n-Since it uses PARI's `ffinit`, this depends on #14817.\n+Since it uses PARI's `ffinit`, this depends on #14818.\n \n Apply:\n * [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),\n``````\n",
    "created_at": "2013-07-16T11:43:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181575",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 
 The default choice is now deterministic: Conway polynomials if available, otherwise lexicographically first (via NTL/GF2E) in characteristic 2, Adleman-Lenstra (via PARI) in characteristic > 2.
 
-Since it uses PARI's `ffinit`, this depends on #14817.
+Since it uses PARI's `ffinit`, this depends on #14818.
 
 Apply:
 * [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),
``````




---

archive/issue_comments_181576.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n\n```\nApply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch\n```",
    "created_at": "2013-07-17T08:42:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181576",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:14" align="right">comment:14</div>


```
Apply trac_14832-PolynomialRing_dense_finite_field.patch, trac_14832-irreducible_polynomial.patch, trac_14832-reviewer.patch
```



---

archive/issue_comments_181577.json:
```json
{
    "body": "Attachment: **[trac_14832-doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)**\n\nadd doctest",
    "created_at": "2013-07-17T13:12:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181577",
    "user": "https://github.com/pjbruin"
}
```

Attachment: **[trac_14832-doctest.patch.gz](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)**

add doctest



---

archive/issue_comments_181578.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,8 @@\n Since it uses PARI's `ffinit`, this depends on #14818.\n \n Apply:\n-* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),\n-* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),\n-* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).\n+* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)\n+* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)\n+* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)\n+* [attachment: trac_14832-doctest.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)\n \n``````\n",
    "created_at": "2013-07-17T13:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181578",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,8 @@
 Since it uses PARI's `ffinit`, this depends on #14818.
 
 Apply:
-* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz),
-* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz),
-* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz).
+* [attachment: trac_14832-PolynomialRing_dense_finite_field.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-PolynomialRing_dense_finite_field.patch.gz)
+* [attachment: trac_14832-irreducible_polynomial.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-irreducible_polynomial.patch.gz)
+* [attachment: trac_14832-reviewer.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-reviewer.patch.gz)
+* [attachment: trac_14832-doctest.patch](https://github.com/sagemath/sage/files/ticket14832/trac_14832-doctest.patch.gz)
 
``````




---

archive/issue_comments_181579.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nJust want to confirm that Peter's patch solves the patchbot rant and is correct.",
    "created_at": "2013-07-17T13:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181579",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:16" align="right">comment:16</div>

Just want to confirm that Peter's patch solves the patchbot rant and is correct.



---

archive/issue_comments_181580.json:
```json
{
    "body": "Merged: **sage-5.12.beta1**",
    "created_at": "2013-08-16T21:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14832#issuecomment-181580",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta1**



---

archive/issue_events_208894.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:12:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208894"
}
```



---

archive/issue_events_208895.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-16T21:12:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14832",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14832#event-208895"
}
```
