# Issue 14821: Weird error in exponential integral

archive/issues_014617.json:
```json
{
    "assignees": [
        "https://github.com/burcin"
    ],
    "body": "\n```\nintegral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)\n...\nRuntimeError: ECL says: In function GCD, the value of the second argument is\n  1.0\nwhich is not of the expected type INTEGER\n```\n\nThe original ticket description whose case does work now:\n\nThis is so trivial that I am surprised this bug even exists. :) Present since at least sage-5.2 till present versions.\n\nThe following integral works\n\n```\nH = exp(-x)\nH.integral(x, 0, 1)\n\n-e^(-1) + 1\n```\n\nBut the following integral errors out\n\n```\nH = exp(-1.0 * x)\nH.integral(x, 0, 1)\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"_sage_input_19.py\", line 10, in <module>\n    exec compile(u'open(\"___code___.py\",\"w\").write(\"# -*- coding: utf-8 -*-\\\\n\" + _support_.preparse_worksheet_cell(base64.b64decode(\"SCA9IGV4cCgtMS4wKjEwXi0xKngpCkguaW50ZWdyYWwoeCwgMCwgMSk=\"),globals())+\"\\\\n\"); execfile(os.path.abspath(\"___code___.py\"))\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpE7_LAK/___code___.py\", line 4, in <module>\n    exec compile(u'H.integral(x, _sage_const_0 , _sage_const_1 )\n  File \"\", line 1, in <module>\n    \n  File \"expression.pyx\", line 9058, in sage.symbolic.expression.Expression.integral (sage/symbolic/expression.cpp:37991)\n  File \"/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py\", line 683, in integrate\n    return definite_integral(expression, v, a, b)\n  File \"function.pyx\", line 432, in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:4941)\n  File \"/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py\", line 173, in _eval_\n    return integrator(*args)\n  File \"/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 21, in maxima_integrator\n    result = maxima.sr_integral(expression, v, a, b)\n  File \"/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 746, in sr_integral\n    raise error\nRuntimeError: ECL says: In function GCD, the value of the second argument is\n  1.0\nwhich is not of the expected type INTEGER\n```\n\nCC:  @nbruin @rwst\n\nKeywords: **integration, maxima**\n\nBranch/Commit: **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**\n\nReviewer: **Ralf Stephan, Travis Scrimshaw**\n\nAuthor: **Paul Masson, Dave Morris**\n\nComponent: **calculus**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14821_\n\n",
    "closed_at": "2021-01-24T10:36:54Z",
    "created_at": "2013-06-26T04:55:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20calculus",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Weird error in exponential integral",
    "type": "issue",
    "updated_at": "2021-01-24T10:36:54Z",
    "url": "https://github.com/sagemath/sage/issues/14821",
    "user": "https://github.com/ppurka"
}
```

```
integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)
...
RuntimeError: ECL says: In function GCD, the value of the second argument is
  1.0
which is not of the expected type INTEGER
```

The original ticket description whose case does work now:

This is so trivial that I am surprised this bug even exists. :) Present since at least sage-5.2 till present versions.

The following integral works

```
H = exp(-x)
H.integral(x, 0, 1)

-e^(-1) + 1
```

But the following integral errors out

```
H = exp(-1.0 * x)
H.integral(x, 0, 1)

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_19.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("SCA9IGV4cCgtMS4wKjEwXi0xKngpCkguaW50ZWdyYWwoeCwgMCwgMSk="),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpE7_LAK/___code___.py", line 4, in <module>
    exec compile(u'H.integral(x, _sage_const_0 , _sage_const_1 )
  File "", line 1, in <module>
    
  File "expression.pyx", line 9058, in sage.symbolic.expression.Expression.integral (sage/symbolic/expression.cpp:37991)
  File "/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py", line 683, in integrate
    return definite_integral(expression, v, a, b)
  File "function.pyx", line 432, in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:4941)
  File "/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py", line 173, in _eval_
    return integrator(*args)
  File "/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 21, in maxima_integrator
    result = maxima.sr_integral(expression, v, a, b)
  File "/usr/local/src/sage/sage-5.2.server/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 746, in sr_integral
    raise error
RuntimeError: ECL says: In function GCD, the value of the second argument is
  1.0
which is not of the expected type INTEGER
```

CC:  @nbruin @rwst

Keywords: **integration, maxima**

Branch/Commit: **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**

Reviewer: **Ralf Stephan, Travis Scrimshaw**

Author: **Paul Masson, Dave Morris**

Component: **calculus**

_Issue created by migration from https://trac.sagemath.org/ticket/14821_





---

archive/issue_events_208651.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-06-26T04:55:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208651"
}
```



---

archive/issue_events_208652.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-06-26T04:55:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208652"
}
```



---

archive/issue_events_208653.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-06-26T04:55:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208653"
}
```



---

archive/issue_events_208654.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-06-26T04:55:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208654"
}
```



---

archive/issue_events_208655.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-06-26T04:55:22Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "subject": "https://github.com/ppurka",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208655"
}
```



---

archive/issue_comments_181276.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nEven simpler example.",
    "created_at": "2013-06-26T04:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181276",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:1" align="right">comment:1</div>

Even simpler example.



---

archive/issue_comments_181277.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,16 +3,16 @@\n The following integral works\n \n ```\n-H = exp(-10^-1*x)\n+H = exp(-x)\n H.integral(x, 0, 1)\n \n--10*e^(-1/10) + 10\n+-e^(-1) + 1\n ```\n \n But the following integral errors out\n \n ```\n-H = exp(-1.0 * 10^-1*x)\n+H = exp(-1.0 * x)\n H.integral(x, 0, 1)\n \n Traceback (most recent call last):\n``````\n",
    "created_at": "2013-06-26T04:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181277",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,16 +3,16 @@
 The following integral works
 
 ```
-H = exp(-10^-1*x)
+H = exp(-x)
 H.integral(x, 0, 1)
 
--10*e^(-1/10) + 10
+-e^(-1) + 1
 ```
 
 But the following integral errors out
 
 ```
-H = exp(-1.0 * 10^-1*x)
+H = exp(-1.0 * x)
 H.integral(x, 0, 1)
 
 Traceback (most recent call last):
``````




---

archive/issue_comments_181278.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAlmost certainly the same error (see [this sage-support thread](https://groups.google.com/forum/#!topic/sage-support/zpbCOeljVqI):\n\n```\nsage: integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0) \n```\nand also [this ask.sagemath question](http://ask.sagemath.org/question/2028/def-fx-evaluvates-individually-but-not-inside-plot).\n\nThe real underlying issue is the one [at this Maxima bug](https://sourceforge.net/p/maxima/bugs/2510/); basically, we use `keepfloat:true` in Maxima so that things like the integral of `e<sup>(-x</sup>2)` come out right, but this causes things to go wrong in these examples.\n\nAnd [Nils' comment](https://groups.google.com/forum/#!topic/sage-devel/JZ54xk51F-E) still applies, that it's not clear why something with a float in it should be integrated symbolically (rather than numerically) at all.  I think this is an important point, though I'm not sure how to resolve it in such a ridiculously simple case as yours.  Note that I updated the Maxima bug, and with `keepfloat:false` it is ridiculously accurate as a float.\n\nThat said, we should still have a better error message, and ideally just a correct answer.",
    "created_at": "2013-06-26T15:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181278",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:2" align="right">comment:2</div>

Almost certainly the same error (see [this sage-support thread](https://groups.google.com/forum/#!topic/sage-support/zpbCOeljVqI):

```
sage: integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0) 
```
and also [this ask.sagemath question](http://ask.sagemath.org/question/2028/def-fx-evaluvates-individually-but-not-inside-plot).

The real underlying issue is the one [at this Maxima bug](https://sourceforge.net/p/maxima/bugs/2510/); basically, we use `keepfloat:true` in Maxima so that things like the integral of `e<sup>(-x</sup>2)` come out right, but this causes things to go wrong in these examples.

And [Nils' comment](https://groups.google.com/forum/#!topic/sage-devel/JZ54xk51F-E) still applies, that it's not clear why something with a float in it should be integrated symbolically (rather than numerically) at all.  I think this is an important point, though I'm not sure how to resolve it in such a ridiculously simple case as yours.  Note that I updated the Maxima bug, and with `keepfloat:false` it is ridiculously accurate as a float.

That said, we should still have a better error message, and ideally just a correct answer.



---

archive/issue_comments_181279.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n`-` *deleted dumb comment (look at the diff and [comment:5](#comment%3A5) if you want to know why I deleted this :)* `-`\n\nI saw you mention in the ticket whether it is user error to provide a floating number `-1.0` in the exponential function. The `-1.0` used in the example is just an example. I had a more complicated number there. It really surprised me when the integral failed. Such kind of integrals should never fail.",
    "created_at": "2013-06-28T08:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181279",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:3" align="right">comment:3</div>

`-` *deleted dumb comment (look at the diff and [comment:5](#comment%3A5) if you want to know why I deleted this :)* `-`

I saw you mention in the ticket whether it is user error to provide a floating number `-1.0` in the exponential function. The `-1.0` used in the example is just an example. I had a more complicated number there. It really surprised me when the integral failed. Such kind of integrals should never fail.



---

archive/issue_comments_181280.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWait, I'm confused.  What does the value of the derivative have to do with `keepfloat` and this behavior?  \n\n```\nsage: H = exp(-.00001*x)\nsage: H.integral(x,0,1)\n<same error>\nsage: plot(H,(x,0,1),ymin=0)\n<essentially constant plot>\n```\n\nThe reason why Nils and others consider this to be close to user error is that it's not clear what a non-numerical integral of an integral with floats in it should mean.  The indefinite integral would be inaccurate by definition.  Or am I misrepresenting something, Nils?\n\nOne possible workaround I see is that we could catch this error and ask the user whether they wanted a numerical integral, or even return a numerical integral.    We haven't seen this in circumstances without exponentials of floats.\n\nAnother thing to note is that it's the *endpoints* being floats which caused `keepfloat` to be necessary.  We could investigate whether we want to only use `keepfloat:true` in those situations.",
    "created_at": "2013-06-28T13:34:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181280",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

Wait, I'm confused.  What does the value of the derivative have to do with `keepfloat` and this behavior?  

```
sage: H = exp(-.00001*x)
sage: H.integral(x,0,1)
<same error>
sage: plot(H,(x,0,1),ymin=0)
<essentially constant plot>
```

The reason why Nils and others consider this to be close to user error is that it's not clear what a non-numerical integral of an integral with floats in it should mean.  The indefinite integral would be inaccurate by definition.  Or am I misrepresenting something, Nils?

One possible workaround I see is that we could catch this error and ask the user whether they wanted a numerical integral, or even return a numerical integral.    We haven't seen this in circumstances without exponentials of floats.

Another thing to note is that it's the *endpoints* being floats which caused `keepfloat` to be necessary.  We could investigate whether we want to only use `keepfloat:true` in those situations.



---

archive/issue_comments_181281.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOh, now that I read the maxima ticket again, I see that sage was forcing keepfloat true  and not the other way around. Sorry for the misleading comments earlier.",
    "created_at": "2013-06-28T17:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181281",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:5" align="right">comment:5</div>

Oh, now that I read the maxima ticket again, I see that sage was forcing keepfloat true  and not the other way around. Sorry for the misleading comments earlier.



---

archive/issue_events_208656.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208656"
}
```



---

archive/issue_events_208657.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208657"
}
```



---

archive/issue_events_208658.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208658"
}
```



---

archive/issue_events_208659.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208659"
}
```



---

archive/issue_events_208660.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208660"
}
```



---

archive/issue_events_208661.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208661"
}
```



---

archive/issue_comments_181282.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOriginal commands now give `0.6321205588285577` which seems correct so just a doctest is now needed.",
    "created_at": "2014-12-30T17:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181282",
    "user": "https://github.com/rwst"
}
```

<div id="comment:9" align="right">comment:9</div>

Original commands now give `0.6321205588285577` which seems correct so just a doctest is now needed.



---

archive/issue_comments_181283.json:
```json
{
    "body": "Branch: **[u/paulmasson/14821](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/14821)**",
    "created_at": "2016-07-22T20:47:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181283",
    "user": "https://github.com/paulmasson"
}
```

Branch: **[u/paulmasson/14821](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/14821)**



---

archive/issue_events_208662.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-07-22T20:50:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208662"
}
```



---

archive/issue_events_208663.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-07-22T20:50:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208663"
}
```



---

archive/issue_events_208664.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-07-22T20:50:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208664"
}
```



---

archive/issue_events_208665.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-07-22T20:50:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208665"
}
```



---

archive/issue_comments_181284.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAdded doctest\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7\"><code>65b3b55</code></a></td><td><code>Add doctest</code></td></tr></table>\n",
    "created_at": "2016-07-22T20:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181284",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:11" align="right">comment:11</div>

Added doctest

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7"><code>65b3b55</code></a></td><td><code>Add doctest</code></td></tr></table>




---

archive/issue_comments_181285.json:
```json
{
    "body": "Commit: **[`65b3b55`](https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7)**",
    "created_at": "2016-07-22T20:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181285",
    "user": "https://github.com/paulmasson"
}
```

Commit: **[`65b3b55`](https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7)**



---

archive/issue_events_208666.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-07-22T20:50:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208666"
}
```



---

archive/issue_comments_181286.json:
```json
{
    "body": "Author: **Paul Masson**",
    "created_at": "2016-07-22T20:56:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181286",
    "user": "https://github.com/paulmasson"
}
```

Author: **Paul Masson**



---

archive/issue_comments_181287.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+\n+```\n+integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)\n+...\n+RuntimeError: ECL says: In function GCD, the value of the second argument is\n+  1.0\n+which is not of the expected type INTEGER\n+```\n+\n+The original ticket description whose case does work now:\n+\n This is so trivial that I am surprised this bug even exists. :) Present since at least sage-5.2 till present versions.\n \n The following integral works\n``````\n",
    "created_at": "2016-07-23T06:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181287",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+
+```
+integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)
+...
+RuntimeError: ECL says: In function GCD, the value of the second argument is
+  1.0
+which is not of the expected type INTEGER
+```
+
+The original ticket description whose case does work now:
+
 This is so trivial that I am surprised this bug even exists. :) Present since at least sage-5.2 till present versions.
 
 The following integral works
``````




---

archive/issue_comments_181288.json:
```json
{
    "body": "Reviewer: **Ralf Stephan**",
    "created_at": "2016-07-23T06:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181288",
    "user": "https://github.com/rwst"
}
```

Reviewer: **Ralf Stephan**



---

archive/issue_comments_181289.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYour commit is fine and can be considered as reviewed. However, I made the mistake not looking at the second case given in [comment:2](#comment%3A2). This one still crashes. So, to preserve the valuable discussion, instead of closing the ticket and opening a second, I put the second case on top of the ticket description and set \"needs work\".",
    "created_at": "2016-07-23T06:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181289",
    "user": "https://github.com/rwst"
}
```

<div id="comment:13" align="right">comment:13</div>

Your commit is fine and can be considered as reviewed. However, I made the mistake not looking at the second case given in [comment:2](#comment%3A2). This one still crashes. So, to preserve the valuable discussion, instead of closing the ticket and opening a second, I put the second case on top of the ticket description and set "needs work".



---

archive/issue_events_208667.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-07-23T06:47:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208667"
}
```



---

archive/issue_events_208668.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-07-23T06:47:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208668"
}
```



---

archive/issue_comments_181290.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWhen running the following cell:\n\n\n```\nu(x,t)=0;\nfor n in [1..10]:\n    u=u+exp(-n^2*(pi^2/4)*t)*sin(n*(pi/4)*x);\nplot(u(x,1.80),(0,4))\n```\n\nThe output presents a sinus like curve with huge amplitude for t = 1.80, 1.79 or 1.78. This cannot be, for the exponential should make the values very small.\n\nIt seems to me a problem with the evaluation of the exponential for these  values. What am I missing?",
    "created_at": "2018-10-22T19:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181290",
    "user": "https://github.com/marcioadames"
}
```

<div id="comment:14" align="right">comment:14</div>

When running the following cell:


```
u(x,t)=0;
for n in [1..10]:
    u=u+exp(-n^2*(pi^2/4)*t)*sin(n*(pi/4)*x);
plot(u(x,1.80),(0,4))
```

The output presents a sinus like curve with huge amplitude for t = 1.80, 1.79 or 1.78. This cannot be, for the exponential should make the values very small.

It seems to me a problem with the evaluation of the exponential for these  values. What am I missing?



---

archive/issue_comments_181291.json:
```json
{
    "body": "Changed branch from **[u/paulmasson/14821](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/14821)** to **[public/14821](https://github.com/sagemath/sagetrac-mirror/tree/public/14821)**",
    "created_at": "2020-12-31T05:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181291",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changed branch from **[u/paulmasson/14821](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/14821)** to **[public/14821](https://github.com/sagemath/sagetrac-mirror/tree/public/14821)**



---

archive/issue_comments_181292.json:
```json
{
    "body": "Changed commit from **[`65b3b55`](https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7)** to **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**",
    "created_at": "2020-12-31T05:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181292",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changed commit from **[`65b3b55`](https://github.com/sagemath/sagetrac-mirror/commit/65b3b55e4aa15b2bb85b3854611932e4d76637c7)** to **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**



---

archive/issue_events_208669.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-12-31T05:57:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208669"
}
```



---

archive/issue_events_208670.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-12-31T05:57:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208670"
}
```



---

archive/issue_comments_181293.json:
```json
{
    "body": "Changed author from **Paul Masson** to **Paul Masson, Dave Morris**",
    "created_at": "2020-12-31T05:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181293",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changed author from **Paul Masson** to **Paul Masson, Dave Morris**



---

archive/issue_events_208671.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-12-31T05:57:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208671"
}
```



---

archive/issue_events_208672.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-12-31T05:57:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208672"
}
```



---

archive/issue_comments_181294.json:
```json
{
    "body": "Changed keywords from none to **integration, maxima**",
    "created_at": "2020-12-31T05:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181294",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changed keywords from none to **integration, maxima**



---

archive/issue_comments_181295.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe `RuntimeError` at the start of the ticket description (and mentioned in [comment:13](#comment%3A13)) is gone:\n\n```\nsage: integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)                                        \n4.62770039817000e-9\n```\nI added a doctest for this and rebased on 9.3b5, so I hope we can close this old ticket.\n\nThe issue in [comment:14](#comment%3A14) is invalid. The plot has an amplitude of approximately 0.12, which is correct.  The only reason it looks large in the picture is that the y-axis has been scaled to fit the graph.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/758517a0d8bff3307a7f9b3f79ed037b0f125ae1\"><code>758517a</code></a></td><td><code>Add doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19\"><code>5101846</code></a></td><td><code>another doctest for trac 14821</code></td></tr></table>\n",
    "created_at": "2020-12-31T05:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181295",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:16" align="right">comment:16</div>

The `RuntimeError` at the start of the ticket description (and mentioned in [comment:13](#comment%3A13)) is gone:

```
sage: integral(exp(-300.0/(-0.064*x+14.0)),x,0.0,120.0)                                        
4.62770039817000e-9
```
I added a doctest for this and rebased on 9.3b5, so I hope we can close this old ticket.

The issue in [comment:14](#comment%3A14) is invalid. The plot has an amplitude of approximately 0.12, which is correct.  The only reason it looks large in the picture is that the y-axis has been scaled to fit the graph.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/758517a0d8bff3307a7f9b3f79ed037b0f125ae1"><code>758517a</code></a></td><td><code>Add doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19"><code>5101846</code></a></td><td><code>another doctest for trac 14821</code></td></tr></table>




---

archive/issue_events_208673.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-01-05T01:38:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208673"
}
```



---

archive/issue_events_208674.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-01-05T01:38:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208674"
}
```



---

archive/issue_comments_181296.json:
```json
{
    "body": "Changed reviewer from **Ralf Stephan** to **Ralf Stephan, Travis Scrimshaw**",
    "created_at": "2021-01-05T01:38:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181296",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Ralf Stephan** to **Ralf Stephan, Travis Scrimshaw**



---

archive/issue_comments_181297.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI believe all issues raised in this ticket have been addressed.",
    "created_at": "2021-01-05T01:38:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181297",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

I believe all issues raised in this ticket have been addressed.



---

archive/issue_comments_181298.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThanks for doing the review!",
    "created_at": "2021-01-05T22:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181298",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:18" align="right">comment:18</div>

Thanks for doing the review!



---

archive/issue_events_208675.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-24T10:36:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208675"
}
```



---

archive/issue_events_208676.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "70291edd23c5eaa9a0d9d75611e15e91865a9bb4",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-01-24T10:36:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14821#event-208676"
}
```



---

archive/issue_comments_181299.json:
```json
{
    "body": "Changed branch from **[public/14821](https://github.com/sagemath/sagetrac-mirror/tree/public/14821)** to **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**",
    "created_at": "2021-01-24T10:36:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14821#issuecomment-181299",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/14821](https://github.com/sagemath/sagetrac-mirror/tree/public/14821)** to **[`5101846`](https://github.com/sagemath/sagetrac-mirror/commit/5101846c85fbd2064023db7ded02900d7ff2ab19)**
