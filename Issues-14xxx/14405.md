# Issue 14405: Replace termcap with ncurses

archive/issues_014201.json:
```json
{
    "assignees": [
        "https://github.com/jdemeyer"
    ],
    "body": "The readline in IPython is broken if ncurses-devel is not installed in various modern Linux distributions. Installing the ncurses headers from the distribution (yum install ncurses-devel on Fedora) fixes this.\n\nExample video:  http://youtu.be/dxp1SIXbIyY\n\nThe problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.\n\n* Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo\n* Apply [attachment: 14405_hgignore.patch](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz) to `$SAGE_LOCAL/bin`\n* Delete the termcap spkg\n* Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg\n* Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg\n  \n\nCC:  @jdemeyer @jpflori @nexttime\n\nReviewer: **Volker Braun, Jean-Pierre Flori, Jeroen Demeyer**\n\nAuthor: **Volker Braun, Jean-Pierre Flori**\n\nMerged: **sage-5.12.beta2**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14405_\n\n",
    "closed_at": "2013-08-20T08:01:37Z",
    "created_at": "2013-04-03T11:34:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Replace termcap with ncurses",
    "type": "issue",
    "updated_at": "2013-10-22T17:08:37Z",
    "url": "https://github.com/sagemath/sage/issues/14405",
    "user": "https://github.com/vbraun"
}
```
The readline in IPython is broken if ncurses-devel is not installed in various modern Linux distributions. Installing the ncurses headers from the distribution (yum install ncurses-devel on Fedora) fixes this.

Example video:  http://youtu.be/dxp1SIXbIyY

The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.

* Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo
* Apply [attachment: 14405_hgignore.patch](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz) to `$SAGE_LOCAL/bin`
* Delete the termcap spkg
* Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg
* Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg
  

CC:  @jdemeyer @jpflori @nexttime

Reviewer: **Volker Braun, Jean-Pierre Flori, Jeroen Demeyer**

Author: **Volker Braun, Jean-Pierre Flori**

Merged: **sage-5.12.beta2**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/14405_





---

archive/issue_events_203575.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-03T11:34:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203575"
}
```



---

archive/issue_events_203576.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-03T11:34:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203576"
}
```



---

archive/issue_events_203577.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-03T11:34:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203577"
}
```



---

archive/issue_events_203578.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-03T11:34:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203578"
}
```



---

archive/issue_events_203579.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T11:34:58Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "subject": "https://github.com/vbraun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203579"
}
```



---

archive/issue_comments_173341.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nDoes Python's readline work correctly with the old termcap spkg (http://boxen.math.washington.edu/home/release/sage-5.6/sage-5.6/spkg/standard/termcap-1.3.1.p2.spkg)? Because if it worked neither before #12725, nor after #12725, there is no bug.\n\nIf Python's readline did work before #12725 and #12725 broke it: please attach logs of the Python compilation, before and after (with the same Sage version, serial install).",
    "created_at": "2013-04-03T12:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173341",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Does Python's readline work correctly with the old termcap spkg (http://boxen.math.washington.edu/home/release/sage-5.6/sage-5.6/spkg/standard/termcap-1.3.1.p2.spkg)? Because if it worked neither before #12725, nor after #12725, there is no bug.

If Python's readline did work before #12725 and #12725 broke it: please attach logs of the Python compilation, before and after (with the same Sage version, serial install).



---

archive/issue_comments_173342.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI've tested an old 4.8 install which works fine whereas I found the same problem as Volker on a recent 5.9.beta2.\nThis is on two different Ubuntu 12.04.1 installs where libncurses5 and libncursesw5 packages are installed but no -dev packages are.",
    "created_at": "2013-04-03T12:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173342",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:3" align="right">comment:3</div>

I've tested an old 4.8 install which works fine whereas I found the same problem as Volker on a recent 5.9.beta2.
This is on two different Ubuntu 12.04.1 installs where libncurses5 and libncursesw5 packages are installed but no -dev packages are.



---

archive/issue_comments_173343.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jpflori](#comment:3):\n> I've tested an old 4.8 install which works fine whereas I found the same problem as Volker on a recent 5.9.beta2.\n> This is on two different Ubuntu 12.04.1 installs where libncurses5 and libncursesw5 packages are installed but no -dev packages are.\n\nOK, then please try the things I asked to Volker: try without #12725 and show the Python logs so we can see what the problem is.",
    "created_at": "2013-04-03T12:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173343",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jpflori](#comment:3):
> I've tested an old 4.8 install which works fine whereas I found the same problem as Volker on a recent 5.9.beta2.
> This is on two different Ubuntu 12.04.1 installs where libncurses5 and libncursesw5 packages are installed but no -dev packages are.

OK, then please try the things I asked to Volker: try without #12725 and show the Python logs so we can see what the problem is.



---

archive/issue_comments_173344.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAs I already typed that, here is a bit of info:\n* On the 4.8 install, I have the usual \"Python build finished, but the necessary bits to build these modules were not found\" and the modules listed include _curses and _curses_panel.\n* On the 5.9.beta2 install, it only lists the _curses_panel module and I have a new worrying line \"Failed to build these modules\" which only lists _curses. And indeed before in the log, there's an error:\n\n```\nIn file included from .../_cursesmodule.c:114:0:\nInclude/py_curses.h:57:20: erreur fatale: curses.h : Aucun fichier ou dossier de ce type\n```",
    "created_at": "2013-04-03T12:39:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173344",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:5" align="right">comment:5</div>

As I already typed that, here is a bit of info:
* On the 4.8 install, I have the usual "Python build finished, but the necessary bits to build these modules were not found" and the modules listed include _curses and _curses_panel.
* On the 5.9.beta2 install, it only lists the _curses_panel module and I have a new worrying line "Failed to build these modules" which only lists _curses. And indeed before in the log, there's an error:

```
In file included from .../_cursesmodule.c:114:0:
Include/py_curses.h:57:20: erreur fatale: curses.h : Aucun fichier ou dossier de ce type
```



---

archive/issue_comments_173345.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n(And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)",
    "created_at": "2013-04-03T12:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173345",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:6" align="right">comment:6</div>

(And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)



---

archive/issue_comments_173346.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jpflori](#comment:6):\n> (And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)\n\nBut the end result is the same: the `_curses` module doesn't build (either due to \"missing bits\" or \"failed to build\"), neither with #12725, nor without. So I still doubt that #12725 is a problem.\n\nWhat happens with other packages using readline, PARI/GP for example? How is the line editing in\n\n```\n$ ./sage --gp\n```\nAnd what is the header message when starting GP, it indicates whether or not readline is used.",
    "created_at": "2013-04-03T12:54:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173346",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jpflori](#comment:6):
> (And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)

But the end result is the same: the `_curses` module doesn't build (either due to "missing bits" or "failed to build"), neither with #12725, nor without. So I still doubt that #12725 is a problem.

What happens with other packages using readline, PARI/GP for example? How is the line editing in

```
$ ./sage --gp
```
And what is the header message when starting GP, it indicates whether or not readline is used.



---

archive/issue_comments_173347.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAnd after removing the libncurses.a symlink and rebuilding the Python 2.7 spkg on the 5.9.beta2, the log looks similar to the one on the 4.8 install.\nBut Sage command line still seems broken (I've rebuilt ipython and run ./sage -b).\n\nI could not test the new python on the 4.8 install as it does not like it that much and fails to rebuild.\n\nNo such problems on 5.6 and 5.7, so I guess that #12725 is not the culprit for the bug (although the error message about _curses I get shows it may not be that useful).\nMaybe new ipython?",
    "created_at": "2013-04-03T12:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173347",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:8" align="right">comment:8</div>

And after removing the libncurses.a symlink and rebuilding the Python 2.7 spkg on the 5.9.beta2, the log looks similar to the one on the 4.8 install.
But Sage command line still seems broken (I've rebuilt ipython and run ./sage -b).

I could not test the new python on the 4.8 install as it does not like it that much and fails to rebuild.

No such problems on 5.6 and 5.7, so I guess that #12725 is not the culprit for the bug (although the error message about _curses I get shows it may not be that useful).
Maybe new ipython?



---

archive/issue_comments_173348.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe standard Fedora install contains `ncurses` and `ncurses-libs` rpms, which install `libncurses.so.5` but no `libncurses.so`. Only the `ncurses-devel` package, which is not installed by default, brings `libncurses.so`.",
    "created_at": "2013-04-03T12:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173348",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

The standard Fedora install contains `ncurses` and `ncurses-libs` rpms, which install `libncurses.so.5` but no `libncurses.so`. Only the `ncurses-devel` package, which is not installed by default, brings `libncurses.so`.



---

archive/issue_comments_173349.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jpflori](#comment:8):\n> And after removing the libncurses.a symlink and rebuilding the Python 2.7 spkg on the 5.9.beta2, the log looks similar to the one on the 4.8 install.\n> But Sage command line still seems broken (I've rebuilt ipython and run ./sage -b).\n> \n> I could not test the new python on the 4.8 install as it does not like it that much and fails to rebuild.\n> \n> No such problems on 5.6 and 5.7, so I guess that #12725 is not the culprit for the bug (although the error message about _curses I get shows it may not be that useful).\n> Maybe new ipython?\n\nIpython was updated in 5.7, so that's not it.",
    "created_at": "2013-04-03T13:02:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173349",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jpflori](#comment:8):
> And after removing the libncurses.a symlink and rebuilding the Python 2.7 spkg on the 5.9.beta2, the log looks similar to the one on the 4.8 install.
> But Sage command line still seems broken (I've rebuilt ipython and run ./sage -b).
> 
> I could not test the new python on the 4.8 install as it does not like it that much and fails to rebuild.
> 
> No such problems on 5.6 and 5.7, so I guess that #12725 is not the culprit for the bug (although the error message about _curses I get shows it may not be that useful).
> Maybe new ipython?

Ipython was updated in 5.7, so that's not it.



---

archive/issue_comments_173350.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI've removed `ncurses-devel` again and compiled sage-5.9.beta2 with the old termcap-1.3.1.p2.spkg. The python command line is still borked in the same way. But no libncurses symlink. So I guess the bug is somewhere else.",
    "created_at": "2013-04-03T13:04:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173350",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

I've removed `ncurses-devel` again and compiled sage-5.9.beta2 with the old termcap-1.3.1.p2.spkg. The python command line is still borked in the same way. But no libncurses symlink. So I guess the bug is somewhere else.



---

archive/issue_comments_173351.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jdemeyer](#comment:7):\n> Replying to [@jpflori](#comment:6):\n> > (And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)\n\n> But the end result is the same: the `_curses` module doesn't build (either due to \"missing bits\" or \"failed to build\"), neither with #12725, nor without. So I still doubt that #12725 is a problem.\n> \n> What happens with other packages using readline, PARI/GP for example? How is the line editing in\n> \n> ```\n> $ ./sage --gp\n> ```\n> And what is the header message when starting GP, it indicates whether or not readline is used.\n\nI've now rebuilt readline, ipython, pari as well, still without the libncurses.a symlink.\n./sage -gp works fine (and shows realine 6.2 is enabled), and sage command line still broken.",
    "created_at": "2013-04-03T13:06:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173351",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jdemeyer](#comment:7):
> Replying to [@jpflori](#comment:6):
> > (And installing the latest Python spkg on the 4.8 Sage install gives the same result as the old 2.6.* spkg which it included, i.e. missing bits for _curses and _curses_panel.)

> But the end result is the same: the `_curses` module doesn't build (either due to "missing bits" or "failed to build"), neither with #12725, nor without. So I still doubt that #12725 is a problem.
> 
> What happens with other packages using readline, PARI/GP for example? How is the line editing in
> 
> ```
> $ ./sage --gp
> ```
> And what is the header message when starting GP, it indicates whether or not readline is used.

I've now rebuilt readline, ipython, pari as well, still without the libncurses.a symlink.
./sage -gp works fine (and shows realine 6.2 is enabled), and sage command line still broken.



---

archive/issue_comments_173352.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nNote the ./sage -python command line is fine, whereas ./sage -ipython is not.",
    "created_at": "2013-04-03T13:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173352",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:13" align="right">comment:13</div>

Note the ./sage -python command line is fine, whereas ./sage -ipython is not.



---

archive/issue_comments_173353.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIn Sage 5.7, the sage command line is fine whereas the ipython one is already (in color) and broken.",
    "created_at": "2013-04-03T13:08:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173353",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:14" align="right">comment:14</div>

In Sage 5.7, the sage command line is fine whereas the ipython one is already (in color) and broken.



---

archive/issue_comments_173354.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIn fact with the old ipython 0.10 from sage 5.6, the command line is already broken.",
    "created_at": "2013-04-03T13:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173354",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:15" align="right">comment:15</div>

In fact with the old ipython 0.10 from sage 5.6, the command line is already broken.



---

archive/issue_comments_173355.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@vbraun](#comment:9):\n> The standard Fedora install contains `ncurses` and `ncurses-libs` rpms, which install `libncurses.so.5` but no `libncurses.so`. Only the `ncurses-devel` package, which is not installed by default, brings `libncurses.so`.\n\nWhich is pretty correct.  No system should have `foo.so` (nor `foo.a`!) unless `foo.h` (i.e., the related headers) are also present.",
    "created_at": "2013-04-03T13:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173355",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@vbraun](#comment:9):
> The standard Fedora install contains `ncurses` and `ncurses-libs` rpms, which install `libncurses.so.5` but no `libncurses.so`. Only the `ncurses-devel` package, which is not installed by default, brings `libncurses.so`.

Which is pretty correct.  No system should have `foo.so` (nor `foo.a`!) unless `foo.h` (i.e., the related headers) are also present.



---

archive/issue_comments_173356.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nTo go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.",
    "created_at": "2013-04-03T13:25:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173356",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">comment:18</div>

To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.



---

archive/issue_comments_173357.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe `sage -gp` readline also is different between the working and broken sage commandline. If I compile the working readline, `sage -gp` has correct multi-line readline (input is continued on subsequent lines. With the broken readline, `sage -gp` falls back to single-line readline (input scrolls horizontally if necessary).",
    "created_at": "2013-04-03T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173357",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

The `sage -gp` readline also is different between the working and broken sage commandline. If I compile the working readline, `sage -gp` has correct multi-line readline (input is continued on subsequent lines. With the broken readline, `sage -gp` falls back to single-line readline (input scrolls horizontally if necessary).



---

archive/issue_comments_173358.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nCuriously, the log file for readline is identical (apart from the timing stats). But it fails to link to tinfo in the broken version\n\n```\n[vbraun@volker-desktop sage-5.9.beta2]$ ldd local/lib/libreadline.so\n\tlinux-vdso.so.1 =>  (0x00007fff365fe000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007f2866ee3000)\n\t/lib64/ld-linux-x86-64.so.2 (0x0000003c14800000)\n```\nvs the fixed version:\n\n```\n[vbraun@volker-desktop sage-5.9.beta2]$ ldd local/lib/libreadline.so\n\tlinux-vdso.so.1 =>  (0x00007fffef3fe000)\n\tlibtinfo.so.5 => /lib64/libtinfo.so.5 (0x00007ffb0c10a000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007ffb0bd51000)\n\t/lib64/ld-linux-x86-64.so.2 (0x0000003c14800000)\n[vbraun@volker-desktop sage-5.9.beta2]$ cat /usr/lib64/libncurses.so\nINPUT(libncurses.so.5 -ltinfo)\n```",
    "created_at": "2013-04-03T13:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173358",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:20" align="right">comment:20</div>

Curiously, the log file for readline is identical (apart from the timing stats). But it fails to link to tinfo in the broken version

```
[vbraun@volker-desktop sage-5.9.beta2]$ ldd local/lib/libreadline.so
	linux-vdso.so.1 =>  (0x00007fff365fe000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f2866ee3000)
	/lib64/ld-linux-x86-64.so.2 (0x0000003c14800000)
```
vs the fixed version:

```
[vbraun@volker-desktop sage-5.9.beta2]$ ldd local/lib/libreadline.so
	linux-vdso.so.1 =>  (0x00007fffef3fe000)
	libtinfo.so.5 => /lib64/libtinfo.so.5 (0x00007ffb0c10a000)
	libc.so.6 => /lib64/libc.so.6 (0x00007ffb0bd51000)
	/lib64/ld-linux-x86-64.so.2 (0x0000003c14800000)
[vbraun@volker-desktop sage-5.9.beta2]$ cat /usr/lib64/libncurses.so
INPUT(libncurses.so.5 -ltinfo)
```



---

archive/issue_comments_173359.json:
```json
{
    "body": "Attachment: **[log-python-2.7.3.p5.diff.gz](https://github.com/sagemath/sage/files/ticket14405/log-python-2.7.3.p5.diff.gz)**\n\nDiff between broken and fixed python install",
    "created_at": "2013-04-03T13:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173359",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[log-python-2.7.3.p5.diff.gz](https://github.com/sagemath/sage/files/ticket14405/log-python-2.7.3.p5.diff.gz)**

Diff between broken and fixed python install



---

archive/issue_comments_173360.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@vbraun](#comment:19):\n> The `sage -gp` readline also is different between the working and broken sage commandline. If I compile the working readline, `sage -gp` has correct multi-line readline (input is continued on subsequent lines. With the broken readline, `sage -gp` falls back to single-line readline (input scrolls horizontally if necessary).\n> \n\nWith all versions I have, I get horizontla scrolling indeed (but not borken as with the ipython command prompt).",
    "created_at": "2013-04-03T13:44:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173360",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@vbraun](#comment:19):
> The `sage -gp` readline also is different between the working and broken sage commandline. If I compile the working readline, `sage -gp` has correct multi-line readline (input is continued on subsequent lines. With the broken readline, `sage -gp` falls back to single-line readline (input scrolls horizontally if necessary).
> 

With all versions I have, I get horizontla scrolling indeed (but not borken as with the ipython command prompt).



---

archive/issue_comments_173361.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@vbraun](#comment:16):\n> Deleting (renaming) `$SAGE_LOCAL/share` fixes this, even without recompiling.\n\nSo the issue is IPython configuration then?",
    "created_at": "2013-04-03T13:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173361",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@vbraun](#comment:16):
> Deleting (renaming) `$SAGE_LOCAL/share` fixes this, even without recompiling.

So the issue is IPython configuration then?



---

archive/issue_comments_173362.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@vbraun](#comment:18):\n> To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.\n\nBut I guess this \"fixed\" readline links to libncurses, doesn't it?\nWe don't want that...\nWe want to use the libtermcap we provide.",
    "created_at": "2013-04-03T13:47:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173362",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@vbraun](#comment:18):
> To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.

But I guess this "fixed" readline links to libncurses, doesn't it?
We don't want that...
We want to use the libtermcap we provide.



---

archive/issue_comments_173363.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nIn fact, I don't need to recompile python. Just install ncurses-devel and recompile readline = working. Uninstall ncurses-devel and recompile readline = broken.",
    "created_at": "2013-04-03T13:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173363",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>

In fact, I don't need to recompile python. Just install ncurses-devel and recompile readline = working. Uninstall ncurses-devel and recompile readline = broken.



---

archive/issue_comments_173364.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-#12725 symlinks libtermcap.a to libncurses.a if it doesn't exist. This workaround allows Sage to compile, but the readline in Python is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this, because then the symlink is not created. \n+The readline in IPython is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this.\n \n Example video:  http://youtu.be/dxp1SIXbIyY\n \n``````\n",
    "created_at": "2013-04-03T13:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173364",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-#12725 symlinks libtermcap.a to libncurses.a if it doesn't exist. This workaround allows Sage to compile, but the readline in Python is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this, because then the symlink is not created. 
+The readline in IPython is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this.
 
 Example video:  http://youtu.be/dxp1SIXbIyY
 
``````




---

archive/issue_events_203580.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T13:52:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "title_is": "IPython readline broken if ncurses-devel is not installed",
    "title_was": "The libncurses hack breaks Python/readline",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203580"
}
```



---

archive/issue_comments_173365.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThe real reason is libtinfo. In fact I can just `export LD_PRELOAD=/usr/lib64/libtinfo.so.5` and this fixes it.",
    "created_at": "2013-04-03T13:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173365",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

The real reason is libtinfo. In fact I can just `export LD_PRELOAD=/usr/lib64/libtinfo.so.5` and this fixes it.



---

archive/issue_comments_173366.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nSo what should we do, make a tinfo spkg or require ncurses-devel?",
    "created_at": "2013-04-03T13:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173366",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

So what should we do, make a tinfo spkg or require ncurses-devel?



---

archive/issue_comments_173367.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jpflori](#comment:23):\n> Replying to [@vbraun](#comment:18):\n> > To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.\n\n> But I guess this \"fixed\" readline links to libncurses, doesn't it?\n> We don't want that...\n> We want to use the libtermcap we provide.\n\nNot me.  We shouldn't build libtermcap at all on systems that have libncurses / libtinfo [-dev].",
    "created_at": "2013-04-03T13:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173367",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jpflori](#comment:23):
> Replying to [@vbraun](#comment:18):
> > To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.

> But I guess this "fixed" readline links to libncurses, doesn't it?
> We don't want that...
> We want to use the libtermcap we provide.

Not me.  We shouldn't build libtermcap at all on systems that have libncurses / libtinfo [-dev].



---

archive/issue_comments_173368.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@vbraun](#comment:27):\n> So what should we do, make a tinfo spkg or require ncurses-devel?\n\nFix IPython?",
    "created_at": "2013-04-03T14:03:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173368",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@vbraun](#comment:27):
> So what should we do, make a tinfo spkg or require ncurses-devel?

Fix IPython?



---

archive/issue_comments_173369.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@nexttime](#comment:28):\n> Replying to [@jpflori](#comment:23):\n> > Replying to [@vbraun](#comment:18):\n> > > To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.\n\n> > But I guess this \"fixed\" readline links to libncurses, doesn't it?\n> > We don't want that...\n> > We want to use the libtermcap we provide.\n\n> \n> Not me.  We shouldn't build libtermcap at all on systems that have libncurses / libtinfo [-dev].\n\nAnd what about systems not having any -dev packages?",
    "created_at": "2013-04-03T14:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173369",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@nexttime](#comment:28):
> Replying to [@jpflori](#comment:23):
> > Replying to [@vbraun](#comment:18):
> > > To go from broken -> fixed: Install ncurses-devel, recompile readline, recompile python.

> > But I guess this "fixed" readline links to libncurses, doesn't it?
> > We don't want that...
> > We want to use the libtermcap we provide.

> 
> Not me.  We shouldn't build libtermcap at all on systems that have libncurses / libtinfo [-dev].

And what about systems not having any -dev packages?



---

archive/issue_comments_173370.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@vbraun](#comment:26):\n> The real reason is libtinfo. In fact I can just `export LD_PRELOAD=/usr/lib64/libtinfo.so.5` and this fixes it.\n\nI don't have libtinfo on my systems :)",
    "created_at": "2013-04-03T14:13:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173370",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@vbraun](#comment:26):
> The real reason is libtinfo. In fact I can just `export LD_PRELOAD=/usr/lib64/libtinfo.so.5` and this fixes it.

I don't have libtinfo on my systems :)



---

archive/issue_comments_173371.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI guess Ubuntu packages it inside libncurses: https://bugs.launchpad.net/ubuntu/+source/ncurses/+bug/259139",
    "created_at": "2013-04-03T14:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173371",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:32" align="right">comment:32</div>

I guess Ubuntu packages it inside libncurses: https://bugs.launchpad.net/ubuntu/+source/ncurses/+bug/259139



---

archive/issue_comments_173372.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nFedora packages libtinfo also as part of ncurses.\n\nJeroen, please read my edits on [comment:16](#comment:16)",
    "created_at": "2013-04-03T14:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173372",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

Fedora packages libtinfo also as part of ncurses.

Jeroen, please read my edits on [comment:16](#comment:16)



---

archive/issue_comments_173373.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nIf I run LD_PRELOAD=...libncurses.so.5 ./sage -ipython then long command lines are ok.\nNotice that the same experiment with ./sage -gp still gives me horizontal scrolling.",
    "created_at": "2013-04-03T14:28:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173373",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:34" align="right">comment:34</div>

If I run LD_PRELOAD=...libncurses.so.5 ./sage -ipython then long command lines are ok.
Notice that the same experiment with ./sage -gp still gives me horizontal scrolling.



---

archive/issue_comments_173374.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@vbraun](#comment:33):\n> Jeroen, please read my edits on [comment:16](#comment:16)\n\nOK, I didn't understand your edit, I just removed the whole comment, which is actually more clear.",
    "created_at": "2013-04-03T14:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173374",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@vbraun](#comment:33):
> Jeroen, please read my edits on [comment:16](#comment:16)

OK, I didn't understand your edit, I just removed the whole comment, which is actually more clear.



---

archive/issue_comments_173375.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nWhat's strange is that iPython runs \"import curses\" which fails (whether lincurses is preloaded or not) and so should behave correctly without curses installed.",
    "created_at": "2013-04-03T14:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173375",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:36" align="right">comment:36</div>

What's strange is that iPython runs "import curses" which fails (whether lincurses is preloaded or not) and so should behave correctly without curses installed.



---

archive/issue_comments_173376.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jpflori](#comment:34):\n> If I run LD_PRELOAD=...libncurses.so.5 ./sage -ipython then long command lines are ok.\n> Notice that the same experiment with ./sage -gp still gives me horizontal scrolling.\n\nHmm, strange. Works for me: with LD_PRELOAD, `sage -gp` has multi-line readline. Without it, only single-line.",
    "created_at": "2013-04-03T14:38:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173376",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jpflori](#comment:34):
> If I run LD_PRELOAD=...libncurses.so.5 ./sage -ipython then long command lines are ok.
> Notice that the same experiment with ./sage -gp still gives me horizontal scrolling.

Hmm, strange. Works for me: with LD_PRELOAD, `sage -gp` has multi-line readline. Without it, only single-line.



---

archive/issue_comments_173377.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nlibtinfo is actually part of ncurses (distributed inside the ncurses tarball)",
    "created_at": "2013-04-03T14:39:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173377",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">comment:38</div>

libtinfo is actually part of ncurses (distributed inside the ncurses tarball)



---

archive/issue_comments_173378.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@vbraun](#comment:38):\n> libtinfo is actually part of ncurses (distributed inside the ncurses tarball)\n\nYup, and on Ubuntu, there is even no separate libtinfo.so file (except for the libncurses-dbg debug package).\nThe functions it should provided are actually provided by libncurses.so directly.",
    "created_at": "2013-04-03T14:57:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173378",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@vbraun](#comment:38):
> libtinfo is actually part of ncurses (distributed inside the ncurses tarball)

Yup, and on Ubuntu, there is even no separate libtinfo.so file (except for the libncurses-dbg debug package).
The functions it should provided are actually provided by libncurses.so directly.



---

archive/issue_comments_173379.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nUbuntu 12.04 has /lib/i386-linux-gnu/libtinfo.so.5 and /lib/x86_64-linux-gnu/libtinfo.so.5.",
    "created_at": "2013-04-03T15:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173379",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:40" align="right">comment:40</div>

Ubuntu 12.04 has /lib/i386-linux-gnu/libtinfo.so.5 and /lib/x86_64-linux-gnu/libtinfo.so.5.



---

archive/issue_comments_173380.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nOh yes it has...\nPlease disregard all my rambling then.",
    "created_at": "2013-04-03T15:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173380",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:41" align="right">comment:41</div>

Oh yes it has...
Please disregard all my rambling then.



---

archive/issue_comments_173381.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@jpflori](#comment:41):\n> Oh yes it has...\n\nOtherwise\n\n```\nINPUT(libncurses.so.5 -ltinfo)\n```\nwouldn't make sense... ;-)\n\n> Please disregard all my rambling then.",
    "created_at": "2013-04-03T15:12:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173381",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@jpflori](#comment:41):
> Oh yes it has...

Otherwise

```
INPUT(libncurses.so.5 -ltinfo)
```
wouldn't make sense... ;-)

> Please disregard all my rambling then.



---

archive/issue_comments_173382.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI made some experimental spkgs for \n\n* Ncurses: http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg\n* Readline (using curses instead of libtermcap): http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg",
    "created_at": "2013-04-03T16:07:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173382",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:43" align="right">comment:43</div>

I made some experimental spkgs for 

* Ncurses: http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg
* Readline (using curses instead of libtermcap): http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg



---

archive/issue_comments_173383.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2013-04-04T18:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173383",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_173384.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-The readline in IPython is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this.\n+The readline in IPython is broken if ncurses-devel is not installed in various modern Linux distributions. Installing the ncurses headers from the distribution (yum install ncurses-devel on Fedora) fixes this.\n \n Example video:  http://youtu.be/dxp1SIXbIyY\n \n-\n+The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.\n``````\n",
    "created_at": "2013-04-04T18:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173384",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-The readline in IPython is broken. Installing the ncurses headers from the distribution (yum install ncurses-devel) fixes this.
+The readline in IPython is broken if ncurses-devel is not installed in various modern Linux distributions. Installing the ncurses headers from the distribution (yum install ncurses-devel on Fedora) fixes this.
 
 Example video:  http://youtu.be/dxp1SIXbIyY
 
-
+The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.
``````




---

archive/issue_events_203581.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-04T18:10:16Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "title_is": "Replace termcap with ncurses",
    "title_was": "IPython readline broken if ncurses-devel is not installed",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203581"
}
```



---

archive/issue_comments_173385.json:
```json
{
    "body": "Attachment: **[trac_14405_replace_termcap_with_ncurses.patch.gz](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz)**\n\nUpdated patch",
    "created_at": "2013-04-04T18:11:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173385",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_14405_replace_termcap_with_ncurses.patch.gz](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz)**

Updated patch



---

archive/issue_comments_173386.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,9 @@\n Example video:  http://youtu.be/dxp1SIXbIyY\n \n The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.\n+\n+* Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo\n+* Delete the termcap spkg\n+* Add http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg\n+* Update http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg\n+  \n``````\n",
    "created_at": "2013-04-04T18:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173386",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,9 @@
 Example video:  http://youtu.be/dxp1SIXbIyY
 
 The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.
+
+* Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo
+* Delete the termcap spkg
+* Add http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg
+* Update http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg
+  
``````




---

archive/issue_comments_173387.json:
```json
{
    "body": "for review only",
    "created_at": "2013-04-04T18:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173387",
    "user": "https://github.com/vbraun"
}
```

for review only



---

archive/issue_comments_173388.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nAttachment: **[readline-p3-to-p4.patch.gz](https://github.com/sagemath/sage/files/ticket14405/readline-p3-to-p4.patch.gz)**",
    "created_at": "2013-04-04T18:17:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173388",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:46" align="right">comment:46</div>

Attachment: **[readline-p3-to-p4.patch.gz](https://github.com/sagemath/sage/files/ticket14405/readline-p3-to-p4.patch.gz)**



---

archive/issue_events_203582.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-04-04T18:17:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203582"
}
```



---

archive/issue_comments_173389.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nJust for completeness, I'd like to see if its possible to fix iPython so its not broken when using termcap only.\nI'll have some time tonight or tomorrow hopefully.",
    "created_at": "2013-04-05T09:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173389",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:47" align="right">comment:47</div>

Just for completeness, I'd like to see if its possible to fix iPython so its not broken when using termcap only.
I'll have some time tonight or tomorrow hopefully.



---

archive/issue_comments_173390.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nIts really readline that breaks, as demonstrated by the fact that it falls back to single-line editing. Ihmo its pointless to improve support for the dead libtermcap, but then its your time ;-)",
    "created_at": "2013-04-05T10:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173390",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

Its really readline that breaks, as demonstrated by the fact that it falls back to single-line editing. Ihmo its pointless to improve support for the dead libtermcap, but then its your time ;-)



---

archive/issue_events_203583.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-05T10:11:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203583"
}
```



---

archive/issue_events_203584.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-05T10:11:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203584"
}
```



---

archive/issue_comments_173391.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@vbraun](#comment:48):\n> Its really readline that breaks, as demonstrated by the fact that it falls back to single-line editing. Ihmo its pointless to improve support for the dead libtermcap, but then its your time ;-)\n\nCan we consider it is broken because it uses single-line editing mode?\nIsn't that to be expected with termcap?\n(I really have no clue...)\n\nNote that this single-line mode is ok in gp and python, it's only in ipython its broken, so there is a problem with ipython (and its been there since at least 0.10, we just encountered it recently in Sage because the way we use ipython must have changed).\n\nAnyway, I agree that multi-line editing looks nicer so just ignoring this ipython/readline/termcap problem and using ipython/readlines/ncurses is a sensible workaround/fix.",
    "created_at": "2013-04-05T11:42:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173391",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@vbraun](#comment:48):
> Its really readline that breaks, as demonstrated by the fact that it falls back to single-line editing. Ihmo its pointless to improve support for the dead libtermcap, but then its your time ;-)

Can we consider it is broken because it uses single-line editing mode?
Isn't that to be expected with termcap?
(I really have no clue...)

Note that this single-line mode is ok in gp and python, it's only in ipython its broken, so there is a problem with ipython (and its been there since at least 0.10, we just encountered it recently in Sage because the way we use ipython must have changed).

Anyway, I agree that multi-line editing looks nicer so just ignoring this ipython/readline/termcap problem and using ipython/readlines/ncurses is a sensible workaround/fix.



---

archive/issue_comments_173392.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI see you disabled static libs, any reason for that except for the fact \"shared libraries are better\" (or \"static ones sucks\" :)).",
    "created_at": "2013-04-05T11:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173392",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:51" align="right">comment:51</div>

I see you disabled static libs, any reason for that except for the fact "shared libraries are better" (or "static ones sucks" :)).



---

archive/issue_comments_173393.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nOnly because static libraries suck.",
    "created_at": "2013-04-05T13:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173393",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">comment:52</div>

Only because static libraries suck.



---

archive/issue_comments_173394.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nAbout the horizontal-scroll-mode, that just shows that readline couldn't figure out the UP capability. Its pretty clear that this is because we only installed libtermcap, but not an actual termcap data file. So libtermcap used to fall back to `/etc/termcap`, but newer Linux distributions don't include that any more since libtermcap is being phased out in favor of ncurses.",
    "created_at": "2013-04-05T13:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173394",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:53" align="right">comment:53</div>

About the horizontal-scroll-mode, that just shows that readline couldn't figure out the UP capability. Its pretty clear that this is because we only installed libtermcap, but not an actual termcap data file. So libtermcap used to fall back to `/etc/termcap`, but newer Linux distributions don't include that any more since libtermcap is being phased out in favor of ncurses.



---

archive/issue_comments_173395.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nGood point.\nUbuntu 12.04 does not ship /etc/termcap indeed.\nAlthough that does not clearly explain the discrepancy between the behavior of ipython vs. python and gp.",
    "created_at": "2013-04-05T13:39:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173395",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:54" align="right">comment:54</div>

Good point.
Ubuntu 12.04 does not ship /etc/termcap indeed.
Although that does not clearly explain the discrepancy between the behavior of ipython vs. python and gp.



---

archive/issue_comments_173396.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThe ncurses spkg fails to build on OS X 10.8.3. [log file here](http://sage.math.washington.edu/home/palmieri/misc/ncurses-5.9.log).",
    "created_at": "2013-04-05T18:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173396",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:55" align="right">comment:55</div>

The ncurses spkg fails to build on OS X 10.8.3. [log file here](http://sage.math.washington.edu/home/palmieri/misc/ncurses-5.9.log).



---

archive/issue_comments_173397.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nFixed, new spkg at same place. I checked that it compiles on bsd.math.",
    "created_at": "2013-04-05T20:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173397",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:56" align="right">comment:56</div>

Fixed, new spkg at same place. I checked that it compiles on bsd.math.



---

archive/issue_comments_173398.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nJust a reminder for myself: HAVE TO FIX THIS.\nEither find out how ipython breaks with termcap only or be lazy and use Volker spkgs.\n\nThe broken command line edit is just driving me crazy, I cannot understand why the google groups are not flooded by rants about that.\nDoes every one use the notebook?",
    "created_at": "2013-07-04T15:33:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173398",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:57" align="right">comment:57</div>

Just a reminder for myself: HAVE TO FIX THIS.
Either find out how ipython breaks with termcap only or be lazy and use Volker spkgs.

The broken command line edit is just driving me crazy, I cannot understand why the google groups are not flooded by rants about that.
Does every one use the notebook?



---

archive/issue_comments_173399.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nWe should switch to ncurses anyways, I don't see a point in adding workarounds for termcap.\n\nI guess most users already have ncurses headers in their OS install, if you install any development packages then its very likely to be pulled in.",
    "created_at": "2013-07-04T15:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173399",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:58" align="right">comment:58</div>

We should switch to ncurses anyways, I don't see a point in adding workarounds for termcap.

I guess most users already have ncurses headers in their OS install, if you install any development packages then its very likely to be pulled in.



---

archive/issue_comments_173400.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAgreed, I'll try to review it tonight.\n\nIf by any chance there have been upgrades to curses and readline, could you upload new spkgs?",
    "created_at": "2013-07-04T16:04:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173400",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:59" align="right">comment:59</div>

Agreed, I'll try to review it tonight.

If by any chance there have been upgrades to curses and readline, could you upload new spkgs?



---

archive/issue_comments_173401.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nNeither readline nor ncurses has been updated in the last 3 months... neither of them is exactly a moving target ;-)",
    "created_at": "2013-07-04T21:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173401",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:60" align="right">comment:60</div>

Neither readline nor ncurses has been updated in the last 3 months... neither of them is exactly a moving target ;-)



---

archive/issue_comments_173402.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nYup I saw that.\n\nCleaned up spkg are up.\n\nI'm testing them right now.",
    "created_at": "2013-07-04T21:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173402",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:61" align="right">comment:61</div>

Yup I saw that.

Cleaned up spkg are up.

I'm testing them right now.



---

archive/issue_comments_173403.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nI've removed obsolete comments, homogenized spkg scripts and so on.\nThe only thing Im not sure about is the LIB_TERMCAP patch which was added in #11970 is needed anymore.\n\nThe only thing you did I changed is to not disable static libs :)\nPlease let keep that change for later and for a more general clean up of spkgs regarding static libs.",
    "created_at": "2013-07-04T21:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173403",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:62" align="right">comment:62</div>

I've removed obsolete comments, homogenized spkg scripts and so on.
The only thing Im not sure about is the LIB_TERMCAP patch which was added in #11970 is needed anymore.

The only thing you did I changed is to not disable static libs :)
Please let keep that change for later and for a more general clean up of spkgs regarding static libs.



---

archive/issue_comments_173404.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nSpkgs at:\n* http://boxen.math.washington.edu/home/jpflori/ncurses-5.9.p0.spkg\n* http://boxen.math.washington.edu/home/jpflori/readline-6.4.p5.spkg\ntermcap patch was needed to finish building Sage.\nLooks to be working.\nldd'ing $SAGE_LOCAL/lib shows only ncurses in the same dir.",
    "created_at": "2013-07-04T22:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173404",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:63" align="right">comment:63</div>

Spkgs at:
* http://boxen.math.washington.edu/home/jpflori/ncurses-5.9.p0.spkg
* http://boxen.math.washington.edu/home/jpflori/readline-6.4.p5.spkg
termcap patch was needed to finish building Sage.
Looks to be working.
ldd'ing $SAGE_LOCAL/lib shows only ncurses in the same dir.



---

archive/issue_comments_173405.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nspkg urls don't work",
    "created_at": "2013-07-04T23:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173405",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:64" align="right">comment:64</div>

spkg urls don't work



---

archive/issue_comments_173406.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nFixed:\n* http://boxen.math.washington.edu/home/jpflori/spkg/ncurses-5.9.p0.spkg\n* http://boxen.math.washington.edu/home/jpflori/spkg/readline-6.2.p5.spkg",
    "created_at": "2013-07-05T07:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173406",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:65" align="right">comment:65</div>

Fixed:
* http://boxen.math.washington.edu/home/jpflori/spkg/ncurses-5.9.p0.spkg
* http://boxen.math.washington.edu/home/jpflori/spkg/readline-6.2.p5.spkg



---

archive/issue_comments_173407.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nStrange, yesterday the doc failed to build because of not finding some UP stuff in readline, and I thought it was solved by readding the termcap patch.\nBut now on another machine it fails though I used the patch.",
    "created_at": "2013-07-05T14:05:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173407",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:66" align="right">comment:66</div>

Strange, yesterday the doc failed to build because of not finding some UP stuff in readline, and I thought it was solved by readding the termcap patch.
But now on another machine it fails though I used the patch.



---

archive/issue_comments_173408.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nMaybe that was because of old termcap libs being around on this setup were I.\nRemoving them and rebuilding everything was fine...",
    "created_at": "2013-07-05T14:38:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173408",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:67" align="right">comment:67</div>

Maybe that was because of old termcap libs being around on this setup were I.
Removing them and rebuilding everything was fine...



---

archive/issue_comments_173409.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nAnd this is why we shouldn't have static libraries (sorry couldn't resist ;-)",
    "created_at": "2013-07-05T15:28:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173409",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:68" align="right">comment:68</div>

And this is why we shouldn't have static libraries (sorry couldn't resist ;-)



---

archive/issue_comments_173410.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nWhats the point of \n\n```\n    [ -r \"$patch\" ] || continue  # Skip non-existing or non-readable patches\n``` \nIMHO we should error out if the spkg permissions are not set correctly instead of silently not applying the patch.",
    "created_at": "2013-07-05T17:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173410",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:69" align="right">comment:69</div>

Whats the point of 

```
    [ -r "$patch" ] || continue  # Skip non-existing or non-readable patches
``` 
IMHO we should error out if the spkg permissions are not set correctly instead of silently not applying the patch.



---

archive/issue_comments_173411.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nThe rest looks good to me (modulo building static libraries, though I don't mind disabling them globally after we switch to git and the new repo layout)",
    "created_at": "2013-07-05T18:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173411",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:70" align="right">comment:70</div>

The rest looks good to me (modulo building static libraries, though I don't mind disabling them globally after we switch to git and the new repo layout)



---

archive/issue_comments_173412.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@vbraun](#comment:69):\n> Whats the point of \n> \n> ```\n>     [ -r \"$patch\" ] || continue  # Skip non-existing or non-readable patches\n> ``` \n> IMHO we should error out if the spkg permissions are not set correctly instead of silently not applying the patch.\n\nThat's Jeroen's invention, the idea being to be able to (temporarily) \"disable\" a patch by `chmod -r ...` without having to change `spkg-install` (which usually unconditionally applies all [readable] patches in a loop).\n\nAnd if there are no patches at all, `patch` doesn't bail out because the shell doesn't expand `.../*.patch` (where `[ -f ... ]` would be sufficient).",
    "created_at": "2013-07-05T20:15:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173412",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@vbraun](#comment:69):
> Whats the point of 
> 
> ```
>     [ -r "$patch" ] || continue  # Skip non-existing or non-readable patches
> ``` 
> IMHO we should error out if the spkg permissions are not set correctly instead of silently not applying the patch.

That's Jeroen's invention, the idea being to be able to (temporarily) "disable" a patch by `chmod -r ...` without having to change `spkg-install` (which usually unconditionally applies all [readable] patches in a loop).

And if there are no patches at all, `patch` doesn't bail out because the shell doesn't expand `.../*.patch` (where `[ -f ... ]` would be sufficient).



---

archive/issue_comments_173413.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@jpflori](#comment:62):\n> The only thing Im not sure about is the LIB_TERMCAP patch which was added in #11970 is needed anymore.\n\nDid you finally remove it?  (Too lazy to look at the spkg now.)\n\nIf so, please make sure R still builds on `$DISTRO`...",
    "created_at": "2013-07-05T20:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173413",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@jpflori](#comment:62):
> The only thing Im not sure about is the LIB_TERMCAP patch which was added in #11970 is needed anymore.

Did you finally remove it?  (Too lazy to look at the spkg now.)

If so, please make sure R still builds on `$DISTRO`...



---

archive/issue_comments_173414.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nI did at first, but in a build from scratch the doc failed to build complaining about UP missing and after rebuilding readline with it, it was ok so I've left it in.\n\nAnother installation of just the two spkg after that on a system where Sage was already installed, with the patch in, also failed with the same error.\nBut it seems it was because a previous libtermcap.a was already in $SAGE_LOCAL/lib when the spkgs were built.\nAt least removing libtermcap.a and rebuilding once more let the doc build.\nNote I've not looked deeply into this and this is mostly experimental.\nBut I seem to remember that in this latter case, the first libreadline.so produced was not linked with libtinfo (that ncurses should now provide, but I did not look to see if it was there during that try) and that the second one was.\nNot completely sure about that though.",
    "created_at": "2013-07-05T20:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173414",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:73" align="right">comment:73</div>

I did at first, but in a build from scratch the doc failed to build complaining about UP missing and after rebuilding readline with it, it was ok so I've left it in.

Another installation of just the two spkg after that on a system where Sage was already installed, with the patch in, also failed with the same error.
But it seems it was because a previous libtermcap.a was already in $SAGE_LOCAL/lib when the spkgs were built.
At least removing libtermcap.a and rebuilding once more let the doc build.
Note I've not looked deeply into this and this is mostly experimental.
But I seem to remember that in this latter case, the first libreadline.so produced was not linked with libtinfo (that ncurses should now provide, but I did not look to see if it was there during that try) and that the second one was.
Not completely sure about that though.



---

archive/issue_events_203585.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-06T14:29:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203585"
}
```



---

archive/issue_events_203586.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-06T14:29:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203586"
}
```



---

archive/issue_comments_173415.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nR builds for me, even has working readline in the standalone R binary.",
    "created_at": "2013-07-06T14:29:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173415",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:74" align="right">comment:74</div>

R builds for me, even has working readline in the standalone R binary.



---

archive/issue_comments_173416.json:
```json
{
    "body": "Changed author from **Volker Braun** to **Volker Braun, Jean-Pierre Flori**",
    "created_at": "2013-07-06T14:29:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173416",
    "user": "https://github.com/vbraun"
}
```

Changed author from **Volker Braun** to **Volker Braun, Jean-Pierre Flori**



---

archive/issue_comments_173417.json:
```json
{
    "body": "Reviewer: **Volker Braun, Jean-Pierre Flori**",
    "created_at": "2013-07-06T14:29:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173417",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun, Jean-Pierre Flori**



---

archive/issue_events_203587.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:46:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203587"
}
```



---

archive/issue_events_203588.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:46:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203588"
}
```



---

archive/issue_comments_173418.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nThe spkg needs some trivial work:\n\nIn `SPKG.txt`, the license should be GPL v3+ and the following paragraph needs to be updated:\n\n```\n== Dependencies ==\n\n * GNU patch\n\n * libtermcap (or libncurses or libtinfo), but not Sage's one,\n   since we only build a static version. I.e., the system has\n   to provide one of these.\n```\n\nAlso, the file `src/support/mkinstalldirs` is not user-writable, which is strange.",
    "created_at": "2013-08-02T15:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173418",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:76" align="right">comment:76</div>

The spkg needs some trivial work:

In `SPKG.txt`, the license should be GPL v3+ and the following paragraph needs to be updated:

```
== Dependencies ==

 * GNU patch

 * libtermcap (or libncurses or libtinfo), but not Sage's one,
   since we only build a static version. I.e., the system has
   to provide one of these.
```

Also, the file `src/support/mkinstalldirs` is not user-writable, which is strange.



---

archive/issue_events_203589.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T15:09:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203589"
}
```



---

archive/issue_events_203590.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T15:09:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203590"
}
```



---

archive/issue_comments_173419.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nI've updated the readline spkg documentation.\n\nThe permissions of `mkinstalldirs` are what upstream uses; since its not copied anywhere it doesn't really matter if it is user-writeable or not.",
    "created_at": "2013-08-02T16:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173419",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:77" align="right">comment:77</div>

I've updated the readline spkg documentation.

The permissions of `mkinstalldirs` are what upstream uses; since its not copied anywhere it doesn't really matter if it is user-writeable or not.



---

archive/issue_comments_173420.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,6 @@\n \n * Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo\n * Delete the termcap spkg\n-* Add http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg\n-* Update http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg\n+* Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg\n+* Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg\n   \n``````\n",
    "created_at": "2013-08-02T16:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173420",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,6 @@
 
 * Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo
 * Delete the termcap spkg
-* Add http://www.stp.dias.ie/~vbraun/Sage/spkg/ncurses-5.9.spkg
-* Update http://www.stp.dias.ie/~vbraun/Sage/spkg/readline-6.2.p4.spkg
+* Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg
+* Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg
   
``````




---

archive/issue_events_203591.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-02T16:06:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203591"
}
```



---

archive/issue_events_203592.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-02T16:06:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203592"
}
```



---

archive/issue_comments_173421.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nSome files in `$SAGE_LOCAL/bin` need to be added to `.hgignore`:\n\n```\n? captoinfo\n? clear\n? infocmp\n? infotocap\n? ncurses5-config\n? reset\n? tabs\n? tic\n? toe\n? tput\n? tset\n```",
    "created_at": "2013-08-04T16:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173421",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:78" align="right">comment:78</div>

Some files in `$SAGE_LOCAL/bin` need to be added to `.hgignore`:

```
? captoinfo
? clear
? infocmp
? infotocap
? ncurses5-config
? reset
? tabs
? tic
? toe
? tput
? tset
```



---

archive/issue_events_203593.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-04T16:24:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203593"
}
```



---

archive/issue_events_203594.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-04T16:24:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203594"
}
```



---

archive/issue_events_203595.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-05T10:04:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203595"
}
```



---

archive/issue_events_203596.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-05T10:04:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203596"
}
```



---

archive/issue_comments_173422.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nAttachment: **[14405_hgignore.patch.gz](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz)**",
    "created_at": "2013-08-05T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173422",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:79" align="right">comment:79</div>

Attachment: **[14405_hgignore.patch.gz](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz)**



---

archive/issue_comments_173423.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,7 @@\n The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.\n \n * Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo\n+* Apply [attachment: 14405_hgignore.patch](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz) to `$SAGE_LOCAL/bin`\n * Delete the termcap spkg\n * Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg\n * Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg\n``````\n",
    "created_at": "2013-08-05T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173423",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,7 @@
 The problem seems to be that the ancient libtermcap (no new releases since March 2002) is not enough anymore. I suggest to replace the termcap spkg with ncurses. Sage-5.9.beta3 builds fine. The only downside is that it takes ~2mb instead of ~300k, but on the upside the terminal is no longer broken.
 
 * Apply [attachment: trac_14405_replace_termcap_with_ncurses.patch](https://github.com/sagemath/sage/files/ticket14405/trac_14405_replace_termcap_with_ncurses.patch.gz) to the SAGE_ROOT repo
+* Apply [attachment: 14405_hgignore.patch](https://github.com/sagemath/sage/files/ticket14405/14405_hgignore.patch.gz) to `$SAGE_LOCAL/bin`
 * Delete the termcap spkg
 * Add http://boxen.math.washington.edu/home/vbraun/spkg/ncurses-5.9.spkg
 * Update http://boxen.math.washington.edu/home/vbraun/spkg/readline-6.2.p4.spkg
``````




---

archive/issue_events_203597.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-05T10:11:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203597"
}
```



---

archive/issue_events_203598.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-05T10:11:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203598"
}
```



---

archive/issue_comments_173424.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nThanks!",
    "created_at": "2013-08-05T10:11:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173424",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:80" align="right">comment:80</div>

Thanks!



---

archive/issue_events_203599.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-14T09:59:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203599"
}
```



---

archive/issue_events_203600.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-14T09:59:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203600"
}
```



---

archive/issue_comments_173425.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nBuildbot failure on snapperkob (Ubuntu 12.04 x86_64) while building Python:\n\n```\nbuilding 'readline' extension\ngcc -pthread -fPIC -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/include -I. -IInclude -I./Include -I/usr/include/x86_64-linux-gnu -I/usr/local/include -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Include -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src -c /home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.c -o build/temp.linux-x86_64-2.7/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o\ngcc -pthread -shared -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib build/temp.linux-x86_64-2.7/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o -L/usr/lib/termcap -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib -L/usr/lib/x86_64-linux-gnu -L/usr/local/lib -L. -lreadline -lncurses -lpython2.7 -o build/lib.linux-x86_64-2.7/readline.so\n*** WARNING: renaming \"readline\" since importing it failed: /home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib/libreadline.so.6: undefined symbol: UP\n```\n\nThis causes in the end\n\n```\nTesting importing of various modules...\nctypes module imported OK\nmath module imported OK\nhashlib module imported OK\ncrypt module imported OK\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named readline\nreadline module failed to import\nsocket module imported OK\nError: One or more modules failed to import.\n```\n* [Python build log](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402/steps/shell_6/logs/python)\n* [readline build log](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402/steps/shell_6/logs/python)\n* [Other logs of that build](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402)",
    "created_at": "2013-08-14T09:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173425",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:81" align="right">comment:81</div>

Buildbot failure on snapperkob (Ubuntu 12.04 x86_64) while building Python:

```
building 'readline' extension
gcc -pthread -fPIC -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/include -I. -IInclude -I./Include -I/usr/include/x86_64-linux-gnu -I/usr/local/include -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Include -I/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src -c /home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.c -o build/temp.linux-x86_64-2.7/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o
gcc -pthread -shared -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib build/temp.linux-x86_64-2.7/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o -L/usr/lib/termcap -L/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib -L/usr/lib/x86_64-linux-gnu -L/usr/local/lib -L. -lreadline -lncurses -lpython2.7 -o build/lib.linux-x86_64-2.7/readline.so
*** WARNING: renaming "readline" since importing it failed: /home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.12.beta1/local/lib/libreadline.so.6: undefined symbol: UP
```

This causes in the end

```
Testing importing of various modules...
ctypes module imported OK
math module imported OK
hashlib module imported OK
crypt module imported OK
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named readline
readline module failed to import
socket module imported OK
Error: One or more modules failed to import.
```
* [Python build log](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402/steps/shell_6/logs/python)
* [readline build log](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402/steps/shell_6/logs/python)
* [Other logs of that build](http://build.sagemath.org/sage/builders/AIMS%20snapperkob%20%28Ubuntu%2012.04%20x86_64%29/builds/402)



---

archive/issue_comments_173426.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nExact same failure on `arando` (Ubuntu 13.04 32-bit).",
    "created_at": "2013-08-14T10:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173426",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:82" align="right">comment:82</div>

Exact same failure on `arando` (Ubuntu 13.04 32-bit).



---

archive/issue_comments_173427.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nNo, the issue that, despite the `-lncurses` in the gcc invocation, Python's `readline.so` does not actually link against `libncurses.so:\n\n```\n(sage-sh) buildbot@arando:src$ ldd build/lib.linux-i686-2.7/readline.so\n        linux-gate.so.1 =>  (0xb778b000)\n        libreadline.so.6 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libreadline.so.6 (0xb7746000)\n        libpython2.7.so.1.0 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libpython2.7.so.1.0 (0xb758e000)\n        libpthread.so.0 => /lib/i386-linux-gnu/libpthread.so.0 (0xb7564000)\n        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb73b1000)\n        libdl.so.2 => /lib/i386-linux-gnu/libdl.so.2 (0xb73ac000)\n        libutil.so.1 => /lib/i386-linux-gnu/libutil.so.1 (0xb73a8000)\n        libm.so.6 => /lib/i386-linux-gnu/libm.so.6 (0xb7365000)\n        /lib/ld-linux.so.2 (0xb778c000)\n```\nSome dynamic linking expert is needed here.\n\nRunning Python with `LD_PRELOAD=\"$SAGE_LOCAL/lib/libncurses.so\"` solves the problem.",
    "created_at": "2013-08-14T10:26:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173427",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:83" align="right">comment:83</div>

No, the issue that, despite the `-lncurses` in the gcc invocation, Python's `readline.so` does not actually link against `libncurses.so:

```
(sage-sh) buildbot@arando:src$ ldd build/lib.linux-i686-2.7/readline.so
        linux-gate.so.1 =>  (0xb778b000)
        libreadline.so.6 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libreadline.so.6 (0xb7746000)
        libpython2.7.so.1.0 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libpython2.7.so.1.0 (0xb758e000)
        libpthread.so.0 => /lib/i386-linux-gnu/libpthread.so.0 (0xb7564000)
        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb73b1000)
        libdl.so.2 => /lib/i386-linux-gnu/libdl.so.2 (0xb73ac000)
        libutil.so.1 => /lib/i386-linux-gnu/libutil.so.1 (0xb73a8000)
        libm.so.6 => /lib/i386-linux-gnu/libm.so.6 (0xb7365000)
        /lib/ld-linux.so.2 (0xb778c000)
```
Some dynamic linking expert is needed here.

Running Python with `LD_PRELOAD="$SAGE_LOCAL/lib/libncurses.so"` solves the problem.



---

archive/issue_comments_173428.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nThe issue is [https://lists.ubuntu.com/archives/ubuntu-devel/2010-November/031991.html](https://lists.ubuntu.com/archives/ubuntu-devel/2010-November/031991.html)\n\nAdding `-Wl,--no-as-needed` to the linker invocation solves the problem.\n\n```\ngcc -pthread -shared -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib build/temp.linux-i686-2.7/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o -L/usr/lib/termcap -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib -L/usr/lib/i386-linux-gnu -L/usr/local/lib -L. -lreadline -Wl,--no-as-needed -lncurses -lpython2.7 -o build/lib.linux-i686-2.7/readline.so\n```",
    "created_at": "2013-08-14T10:34:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173428",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">comment:84</div>

The issue is [https://lists.ubuntu.com/archives/ubuntu-devel/2010-November/031991.html](https://lists.ubuntu.com/archives/ubuntu-devel/2010-November/031991.html)

Adding `-Wl,--no-as-needed` to the linker invocation solves the problem.

```
gcc -pthread -shared -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib build/temp.linux-i686-2.7/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/spkg/build/python-2.7.5.p1/src/Modules/readline.o -L/usr/lib/termcap -L/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib -L/usr/lib/i386-linux-gnu -L/usr/local/lib -L. -lreadline -Wl,--no-as-needed -lncurses -lpython2.7 -o build/lib.linux-i686-2.7/readline.so
```



---

archive/issue_comments_173429.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nlibcurses is just a symlink to libncurses. I don't have an account on any of those machines. Can you post the ldd output for libncurses.so and libreadline.so? I would guess that the latter is underlinked, and since python readline.so doesn't use UP directly we end up not pulling in ncurses.",
    "created_at": "2013-08-14T11:20:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173429",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:85" align="right">comment:85</div>

libcurses is just a symlink to libncurses. I don't have an account on any of those machines. Can you post the ldd output for libncurses.so and libreadline.so? I would guess that the latter is underlinked, and since python readline.so doesn't use UP directly we end up not pulling in ncurses.



---

archive/issue_comments_173430.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\n\n```\n(sage-sh) buildbot@arando:sage$ ldd $SAGE_LOCAL/lib/libncurses.so\n        linux-gate.so.1 =>  (0xb7759000)\n        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb7573000)\n        libtinfo.so.5 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libtinfo.so.5 (0xb7549000)\n        /lib/ld-linux.so.2 (0xb775a000)\n(sage-sh) buildbot@arando:sage$ ldd $SAGE_LOCAL/lib/libreadline.so\n        linux-gate.so.1 =>  (0xb773a000)\n        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb753a000)\n        /lib/ld-linux.so.2 (0xb773b000)\n```",
    "created_at": "2013-08-14T11:23:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173430",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:86" align="right">comment:86</div>


```
(sage-sh) buildbot@arando:sage$ ldd $SAGE_LOCAL/lib/libncurses.so
        linux-gate.so.1 =>  (0xb7759000)
        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb7573000)
        libtinfo.so.5 => /var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.12.beta1/local/lib/libtinfo.so.5 (0xb7549000)
        /lib/ld-linux.so.2 (0xb775a000)
(sage-sh) buildbot@arando:sage$ ldd $SAGE_LOCAL/lib/libreadline.so
        linux-gate.so.1 =>  (0xb773a000)
        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb753a000)
        /lib/ld-linux.so.2 (0xb773b000)
```



---

archive/issue_comments_173431.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nContrast with `boxen.math` (Ubuntu 8.04):\n\n```\n(sage-sh) jdemeyer@boxen:sage-5.12.beta1$ ldd $SAGE_LOCAL/lib/libncurses.so\n        linux-vdso.so.1 =>  (0x00007fff2fffe000)\n        libc.so.6 => /lib/libc.so.6 (0x00007ffc27946000)\n        libtinfo.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libtinfo.so.5 (0x00007ffc27712000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007ffc27ee2000)\n(sage-sh) jdemeyer@boxen:sage-5.12.beta1$ ldd $SAGE_LOCAL/lib/libreadline.so\n        linux-vdso.so.1 =>  (0x00007fff099fe000)\n        libncurses.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libncurses.so.5 (0x00007f8b01386000)\n        libc.so.6 => /lib/libc.so.6 (0x00007f8b0100f000)\n        libtinfo.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libtinfo.so.5 (0x00007f8b00ddc000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f8b017f0000)\n```",
    "created_at": "2013-08-14T11:26:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173431",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:87" align="right">comment:87</div>

Contrast with `boxen.math` (Ubuntu 8.04):

```
(sage-sh) jdemeyer@boxen:sage-5.12.beta1$ ldd $SAGE_LOCAL/lib/libncurses.so
        linux-vdso.so.1 =>  (0x00007fff2fffe000)
        libc.so.6 => /lib/libc.so.6 (0x00007ffc27946000)
        libtinfo.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libtinfo.so.5 (0x00007ffc27712000)
        /lib64/ld-linux-x86-64.so.2 (0x00007ffc27ee2000)
(sage-sh) jdemeyer@boxen:sage-5.12.beta1$ ldd $SAGE_LOCAL/lib/libreadline.so
        linux-vdso.so.1 =>  (0x00007fff099fe000)
        libncurses.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libncurses.so.5 (0x00007f8b01386000)
        libc.so.6 => /lib/libc.so.6 (0x00007f8b0100f000)
        libtinfo.so.5 => /mazur/release/merger/sage-5.12.beta1/local/lib/libtinfo.so.5 (0x00007f8b00ddc000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f8b017f0000)
```



---

archive/issue_comments_173432.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nYes, it is exactly as I suspected: libreadline does not link against libncurses. In fact, the terminal handling stuff is in libtinfo (part of ncurses), this is why the `-lcurses` is a no-op when linking libreadline.\n\nI've updated the readline spkg to link with `-ltinfo`, this is the proper thing to do. While I was at it I removed various old cruft.",
    "created_at": "2013-08-14T12:49:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173432",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:88" align="right">comment:88</div>

Yes, it is exactly as I suspected: libreadline does not link against libncurses. In fact, the terminal handling stuff is in libtinfo (part of ncurses), this is why the `-lcurses` is a no-op when linking libreadline.

I've updated the readline spkg to link with `-ltinfo`, this is the proper thing to do. While I was at it I removed various old cruft.



---

archive/issue_events_203601.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-14T12:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203601"
}
```



---

archive/issue_events_203602.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-14T12:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203602"
}
```



---

archive/issue_comments_173433.json:
```json
{
    "body": "for review only",
    "created_at": "2013-08-14T12:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173433",
    "user": "https://github.com/vbraun"
}
```

for review only



---

archive/issue_comments_173434.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nAttachment: **[readline-tinfo.diff.gz](https://github.com/sagemath/sage/files/ticket14405/readline-tinfo.diff.gz)**\n\nLooks good on first sight, still have to test it though...",
    "created_at": "2013-08-14T15:43:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173434",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:89" align="right">comment:89</div>

Attachment: **[readline-tinfo.diff.gz](https://github.com/sagemath/sage/files/ticket14405/readline-tinfo.diff.gz)**

Looks good on first sight, still have to test it though...



---

archive/issue_comments_173435.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\n`ncurses` always fails its testsuite (`spkg-check`) because of\n\n```\nRunning the test suite for ncurses-5.9...\nmake[3]: *** No rule to make target `check'.\n```",
    "created_at": "2013-08-14T16:06:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173435",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:90" align="right">comment:90</div>

`ncurses` always fails its testsuite (`spkg-check`) because of

```
Running the test suite for ncurses-5.9...
make[3]: *** No rule to make target `check'.
```



---

archive/issue_events_203603.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-14T16:06:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203603"
}
```



---

archive/issue_events_203604.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-14T16:06:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203604"
}
```



---

archive/issue_comments_173436.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\n`ncurses` fails to build on `mark` (Solaris SPARC) because of\n\n```\n/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/bin/g++ -I../c++ -I../include -I. -DHAVE_CONFIG_H   -D__EXTENSIONS__ -D_XOPEN_SOURCE=500 -D_FILE_OFFSET_BITS=64  -DNDEBUG -I. -I../include -I/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/include  -fPIC -c ../c++/cursesm.cc -o ../obj_s/cursesm.o\n<command-line>:0:0: warning: \"_XOPEN_SOURCE\" redefined [enabled by default]\n../c++/cursesm.cc:1:0: note: this is the location of the previous definition\n<command-line>:0:0: warning: \"_XOPEN_SOURCE\" redefined [enabled by default]\n../c++/cursesf.cc:1:0: note: this is the location of the previous definition\nIn file included from /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/lib/gcc/sparc-sun-solaris2.10/4.7.3/include-fixed/iso/stdlib_iso.h:39:0,\n                 from /usr/include/stdlib.h:18,\n                 from ../c++/internal.h:53,\n                 from ../c++/cursesm.cc:34:\n/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/lib/gcc/sparc-sun-solaris2.10/4.7.3/include-fixed/sys/feature_tests.h:341:2: error: #error \"Compiler or options invalid for pre-UNIX 03 X/Open applications \tand pre-2001 POSIX applications\"\n```",
    "created_at": "2013-08-14T16:08:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173436",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:91" align="right">comment:91</div>

`ncurses` fails to build on `mark` (Solaris SPARC) because of

```
/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/bin/g++ -I../c++ -I../include -I. -DHAVE_CONFIG_H   -D__EXTENSIONS__ -D_XOPEN_SOURCE=500 -D_FILE_OFFSET_BITS=64  -DNDEBUG -I. -I../include -I/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/include  -fPIC -c ../c++/cursesm.cc -o ../obj_s/cursesm.o
<command-line>:0:0: warning: "_XOPEN_SOURCE" redefined [enabled by default]
../c++/cursesm.cc:1:0: note: this is the location of the previous definition
<command-line>:0:0: warning: "_XOPEN_SOURCE" redefined [enabled by default]
../c++/cursesf.cc:1:0: note: this is the location of the previous definition
In file included from /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/lib/gcc/sparc-sun-solaris2.10/4.7.3/include-fixed/iso/stdlib_iso.h:39:0,
                 from /usr/include/stdlib.h:18,
                 from ../c++/internal.h:53,
                 from ../c++/cursesm.cc:34:
/home/buildbot/build/sage/mark-1/mark_full/build/sage-5.12.beta1/local/lib/gcc/sparc-sun-solaris2.10/4.7.3/include-fixed/sys/feature_tests.h:341:2: error: #error "Compiler or options invalid for pre-UNIX 03 X/Open applications 	and pre-2001 POSIX applications"
```



---

archive/issue_comments_173437.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nI've deleted spkg-check and added the patch from http://stackoverflow.com/questions/6774738/compiling-ncurses-on-solaris-compiler-or-options-invalid-for-pre-unix-03-x-op\n\nUpdated ncurses spkg at the same place.",
    "created_at": "2013-08-14T17:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173437",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:92" align="right">comment:92</div>

I've deleted spkg-check and added the patch from http://stackoverflow.com/questions/6774738/compiling-ncurses-on-solaris-compiler-or-options-invalid-for-pre-unix-03-x-op

Updated ncurses spkg at the same place.



---

archive/issue_events_203605.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-14T17:49:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203605"
}
```



---

archive/issue_events_203606.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-08-14T17:49:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203606"
}
```



---

archive/issue_events_203607.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-15T08:49:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203607"
}
```



---

archive/issue_events_203608.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-15T08:49:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203608"
}
```



---

archive/issue_comments_173438.json:
```json
{
    "body": "Changed reviewer from **Volker Braun, Jean-Pierre Flori** to **Volker Braun, Jean-Pierre Flori, Jeroen Demeyer**",
    "created_at": "2013-08-15T08:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173438",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Volker Braun, Jean-Pierre Flori** to **Volker Braun, Jean-Pierre Flori, Jeroen Demeyer**



---

archive/issue_comments_173439.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nHaven't tested all systems yet, but looks good so far.",
    "created_at": "2013-08-15T08:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173439",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:93" align="right">comment:93</div>

Haven't tested all systems yet, but looks good so far.



---

archive/issue_events_203609.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-20T08:01:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203609"
}
```



---

archive/issue_events_203610.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-20T08:01:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14405#event-203610"
}
```



---

archive/issue_comments_173440.json:
```json
{
    "body": "Merged: **sage-5.12.beta2**",
    "created_at": "2013-08-20T08:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173440",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta2**



---

archive/issue_comments_173441.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nJust a random rant on this closed ticket: not building the readline static library makes python fails to build on Cygwin.\nOk this is without doubt because of python build system as it does not manage to find the specially named shared libraries on cygwin (note that when shared and static are installed, gcc will be smart enough to pick the shared one first, so this really is a python issue which fails to detect the shared one...).",
    "created_at": "2013-10-22T17:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173441",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:95" align="right">comment:95</div>

Just a random rant on this closed ticket: not building the readline static library makes python fails to build on Cygwin.
Ok this is without doubt because of python build system as it does not manage to find the specially named shared libraries on cygwin (note that when shared and static are installed, gcc will be smart enough to pick the shared one first, so this really is a python issue which fails to detect the shared one...).



---

archive/issue_comments_173442.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nNote for myself: http://bugs.python.org/issue4032",
    "created_at": "2013-10-22T17:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14405",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14405#issuecomment-173442",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:96" align="right">comment:96</div>

Note for myself: http://bugs.python.org/issue4032
