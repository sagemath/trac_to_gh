# Issue 14218: height and canonical height for projective points and morphisms

archive/issues_014014.json:
```json
{
    "assignees": [
        "https://github.com/bhutz"
    ],
    "body": "This patch implements height functionality from the initial dynamics functionality problems proposed at the 2012 ICERM semester in Complex and Arithmetic dynamics.\n\nBuilds on Trac #13130 and Trac #14217\n\nImplements height functionality:\n\n* height of points\n* height of morphisms\n* local green's functions\n* canonical heights\n\n\nApply:\n\n* [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)\n* [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)\n* [attachment: trac_14218_addon1.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)\n\nKeywords: **height, canonical, projective, dynamics**\n\nReviewer: **Joao Alberto de Faria, Adam Towsley**\n\nAuthor: **Ben Hutz**\n\nMerged: **sage-5.13.beta2**\n\nComponent: **algebraic geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14218_\n\n",
    "closed_at": "2013-10-31T19:16:24Z",
    "created_at": "2013-03-03T18:29:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "height and canonical height for projective points and morphisms",
    "type": "issue",
    "updated_at": "2016-04-15T20:26:44Z",
    "url": "https://github.com/sagemath/sage/issues/14218",
    "user": "https://github.com/bhutz"
}
```
This patch implements height functionality from the initial dynamics functionality problems proposed at the 2012 ICERM semester in Complex and Arithmetic dynamics.

Builds on Trac #13130 and Trac #14217

Implements height functionality:

* height of points
* height of morphisms
* local green's functions
* canonical heights


Apply:

* [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)
* [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)
* [attachment: trac_14218_addon1.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)

Keywords: **height, canonical, projective, dynamics**

Reviewer: **Joao Alberto de Faria, Adam Towsley**

Author: **Ben Hutz**

Merged: **sage-5.13.beta2**

Component: **algebraic geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/14218_





---

archive/issue_events_198396.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-03T18:29:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198396"
}
```



---

archive/issue_events_198397.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-03T18:29:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198397"
}
```



---

archive/issue_events_198398.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-03T18:29:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198398"
}
```



---

archive/issue_events_198399.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-03T18:29:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198399"
}
```



---

archive/issue_events_198400.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-03T18:29:52Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "subject": "https://github.com/bhutz",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198400"
}
```



---

archive/issue_comments_169750.json:
```json
{
    "body": "Attachment: **[heights.patch.gz](https://github.com/sagemath/sage/files/ticket14218/heights.patch.gz)**",
    "created_at": "2013-03-03T18:30:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169750",
    "user": "https://github.com/bhutz"
}
```

Attachment: **[heights.patch.gz](https://github.com/sagemath/sage/files/ticket14218/heights.patch.gz)**



---

archive/issue_comments_169751.json:
```json
{
    "body": "Changed dependencies from **13130, 14217** to **#13130, #14217**",
    "created_at": "2013-03-06T12:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169751",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **13130, 14217** to **#13130, #14217**



---

archive/issue_comments_169752.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,8 @@\n * height of morphisms\n * local green's functions\n * canonical heights\n+\n+\n+Apply:\n+\n+* [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)\n``````\n",
    "created_at": "2013-03-18T12:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169752",
    "user": "https://github.com/bhutz"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,8 @@
 * height of morphisms
 * local green's functions
 * canonical heights
+
+
+Apply:
+
+* [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)
``````




---

archive/issue_events_198401.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-03-18T12:31:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198401"
}
```



---

archive/issue_comments_169753.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\napply trac_14218_heights.patch",
    "created_at": "2013-05-07T20:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169753",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

apply trac_14218_heights.patch



---

archive/issue_comments_169754.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\napply trac_14218_heights.patch",
    "created_at": "2013-05-16T11:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169754",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:4" align="right">comment:4</div>

apply trac_14218_heights.patch



---

archive/issue_events_198402.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198402"
}
```



---

archive/issue_events_198403.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198403"
}
```



---

archive/issue_comments_169755.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,3 +13,4 @@\n Apply:\n \n * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)\n+* [attachment: trac_14218_remove_imports](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.gz)\n``````\n",
    "created_at": "2013-08-23T19:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169755",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,3 +13,4 @@
 Apply:
 
 * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)
+* [attachment: trac_14218_remove_imports](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.gz)
``````




---

archive/issue_comments_169756.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,4 @@\n Apply:\n \n * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)\n-* [attachment: trac_14218_remove_imports](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.gz)\n+* [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)\n``````\n",
    "created_at": "2013-08-23T19:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169756",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,4 @@
 Apply:
 
 * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)
-* [attachment: trac_14218_remove_imports](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.gz)
+* [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)
``````




---

archive/issue_comments_169757.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_14218_remove_imports.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)**\n\nnew patch, changed the import of copy",
    "created_at": "2013-08-29T17:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169757",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_14218_remove_imports.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)**

new patch, changed the import of copy



---

archive/issue_comments_169758.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch",
    "created_at": "2013-09-04T16:36:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169758",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:9" align="right">comment:9</div>

apply trac_14218_heights.patch trac_14218_remove_imports.patch



---

archive/issue_events_198404.json:
```json
{
    "actor": "https://github.com/sagetrac-jdefaria",
    "created_at": "2013-10-02T16:45:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198404"
}
```



---

archive/issue_events_198405.json:
```json
{
    "actor": "https://github.com/sagetrac-jdefaria",
    "created_at": "2013-10-02T16:45:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198405"
}
```



---

archive/issue_comments_169759.json:
```json
{
    "body": "Reviewer: **Joao Alberto de Faria**",
    "created_at": "2013-10-02T16:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169759",
    "user": "https://github.com/sagetrac-jdefaria"
}
```

Reviewer: **Joao Alberto de Faria**



---

archive/issue_comments_169760.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nConfirmed that the functions were returning the correct values. Also tested the functions would not accept undefined variables, here are the list of known issues found\n\nprojective_point.py:\n- green_function: kwd \"precision\"in should be \"prec\"\n- green_function: Joe's name is spelled wrong\n- global_height: lacking both a number field and precision example\n- global_height: description still says ZZ or QQ only\n- canonical_height: lacking a precision example",
    "created_at": "2013-10-02T16:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169760",
    "user": "https://github.com/sagetrac-jdefaria"
}
```

<div id="comment:10" align="right">comment:10</div>

Confirmed that the functions were returning the correct values. Also tested the functions would not accept undefined variables, here are the list of known issues found

projective_point.py:
- green_function: kwd "precision"in should be "prec"
- green_function: Joe's name is spelled wrong
- global_height: lacking both a number field and precision example
- global_height: description still says ZZ or QQ only
- canonical_height: lacking a precision example



---

archive/issue_comments_169761.json:
```json
{
    "body": "Changed dependencies from **#13130, #14217** to none",
    "created_at": "2013-10-03T12:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169761",
    "user": "https://github.com/bhutz"
}
```

Changed dependencies from **#13130, #14217** to none



---

archive/issue_events_198406.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-10-03T12:55:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198406"
}
```



---

archive/issue_events_198407.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-10-03T12:55:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198407"
}
```



---

archive/issue_comments_169762.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nFixed all the issues described above. The only change of note was that fixing the 'precision' keyword required more than just a rename. The use of the precision needed to be included throughout the green's function computation.\n\nSince that patchbot seems to be trying to apply the patches from the *closed* dependencies #13130 and #14217, I've removed those from the dependency field. Hopefully that will allow the patchbot to test this patch.",
    "created_at": "2013-10-03T12:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169762",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:11" align="right">comment:11</div>

Fixed all the issues described above. The only change of note was that fixing the 'precision' keyword required more than just a rename. The use of the precision needed to be included throughout the green's function computation.

Since that patchbot seems to be trying to apply the patches from the *closed* dependencies #13130 and #14217, I've removed those from the dependency field. Hopefully that will allow the patchbot to test this patch.



---

archive/issue_comments_169763.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch",
    "created_at": "2013-10-03T12:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169763",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:12" align="right">comment:12</div>

apply trac_14218_heights.patch trac_14218_remove_imports.patch



---

archive/issue_events_198408.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-03T18:15:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198408"
}
```



---

archive/issue_events_198409.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-03T18:15:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198409"
}
```



---

archive/issue_comments_169764.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWhen computing the height of the constant 0 in a function field global_height gives and error. Every other constant seems fine.\n\nR.<x> = PolynomialRing(QQ)\n\nA.<x> = AffineSpace(QQ,1)\n\nH=Hom(A,A)\n\nf=H([0])\n\nf.global_height()\n\n\nreturns \n\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"_sage_input_100.py\", line 10, in <module>\n    exec compile(u'open(\"___code___.py\",\"w\").write(\"# -*- coding: utf-8 -*-\\\\n\" + _support_.preparse_worksheet_cell(base64.b64decode(\"Ui48eD4gPSBQb2x5bm9taWFsUmluZyhRUSkKQS48eD4gPSBBZmZpbmVTcGFjZShRUSwxKQpIPUhvbShBLEEpCmY9SChbMF0pCmYuZ2xvYmFsX2hlaWdodCgp\"),globals())+\"\\\\n\"); execfile(os.path.abspath(\"___code___.py\"))\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpYiF_cn/___code___.py\", line 7, in <module>\n    exec compile(u'f.global_height()\n  File \"\", line 1, in <module>\n    \n  File \"/home/atowsley/sage-5.12.rc0/local/lib/python2.7/site-packages/sage/schemes/affine/affine_morphism.py\", line 542, in global_height\n    h=max([c.global_height(prec) for c in C])\nValueError: max() arg is an empty sequence",
    "created_at": "2013-10-03T18:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169764",
    "user": "https://github.com/sagetrac-atowsley"
}
```

<div id="comment:13" align="right">comment:13</div>

When computing the height of the constant 0 in a function field global_height gives and error. Every other constant seems fine.

R.<x> = PolynomialRing(QQ)

A.<x> = AffineSpace(QQ,1)

H=Hom(A,A)

f=H([0])

f.global_height()


returns 


Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_100.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("Ui48eD4gPSBQb2x5bm9taWFsUmluZyhRUSkKQS48eD4gPSBBZmZpbmVTcGFjZShRUSwxKQpIPUhvbShBLEEpCmY9SChbMF0pCmYuZ2xvYmFsX2hlaWdodCgp"),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpYiF_cn/___code___.py", line 7, in <module>
    exec compile(u'f.global_height()
  File "", line 1, in <module>
    
  File "/home/atowsley/sage-5.12.rc0/local/lib/python2.7/site-packages/sage/schemes/affine/affine_morphism.py", line 542, in global_height
    h=max([c.global_height(prec) for c in C])
ValueError: max() arg is an empty sequence



---

archive/issue_events_198410.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-10-03T19:20:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198410"
}
```



---

archive/issue_events_198411.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-10-03T19:20:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198411"
}
```



---

archive/issue_comments_169765.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYes, missed that case. Actually, in any dimension if any one of the coordinate functions is 0 it has the same issue. The new patches catches those.\n\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch",
    "created_at": "2013-10-03T19:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169765",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:14" align="right">comment:14</div>

Yes, missed that case. Actually, in any dimension if any one of the coordinate functions is 0 it has the same issue. The new patches catches those.


apply trac_14218_heights.patch trac_14218_remove_imports.patch



---

archive/issue_events_198412.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-06T19:11:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198412"
}
```



---

archive/issue_events_198413.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-06T19:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198413"
}
```



---

archive/issue_comments_169766.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI found no more issues. It passed the long test.",
    "created_at": "2013-10-06T19:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169766",
    "user": "https://github.com/sagetrac-atowsley"
}
```

<div id="comment:15" align="right">comment:15</div>

I found no more issues. It passed the long test.



---

archive/issue_comments_169767.json:
```json
{
    "body": "Changed reviewer from **Joao Alberto de Faria** to **Joao Alberto de Faria, Adam Towsley**",
    "created_at": "2013-10-07T00:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169767",
    "user": "https://github.com/bhutz"
}
```

Changed reviewer from **Joao Alberto de Faria** to **Joao Alberto de Faria, Adam Towsley**



---

archive/issue_comments_169768.json:
```json
{
    "body": "Merged: **sage-5.13.beta1**",
    "created_at": "2013-10-12T09:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169768",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta1**



---

archive/issue_events_198414.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-12T09:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198414"
}
```



---

archive/issue_events_198415.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-12T09:45:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198415"
}
```



---

archive/issue_comments_169769.json:
```json
{
    "body": "Changed merged from **sage-5.13.beta1** to none",
    "created_at": "2013-10-19T09:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169769",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-5.13.beta1** to none



---

archive/issue_events_198416.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-19T09:18:43Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198416"
}
```



---

archive/issue_comments_169770.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSorry, but this needs work:\n\nthere are numerical precision issues on Solaris with `green_function`:\n\n```\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/projective_morphism.py\", line 1236, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function\nFailed example:\n    f.green_function(P.point([5,2],False),0,N=30)\nExpected:\n    1.7315451844777406965714211646\nGot:\n    1.7315451844777406965172110560\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/projective_morphism.py\", line 1238, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function\nFailed example:\n    f.green_function(P.point([2,1],False),0,N=30)\nExpected:\n    0.86577259223181085968927265240\nGot:\n    0.86577259223181085966216759809\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/projective_morphism.py\", line 1240, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function\nFailed example:\n    f.green_function(P.point([1,1],False),0,N=30)\nExpected:\n    0.43288629610862337434550672337\nGot:\n    0.43288629610862337433195419621\n**********************************************************************\nFile \"devel/sage/sage/schemes/projective/projective_point.py\", line 727, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.green_function\nFailed example:\n    Q.green_function(f,0,N=200,prec=200)\nExpected:\n    1.6460930160038721221892751679783564477424287857689424150860\nGot:\n    1.6460930160038721221892751679783564477424287857689424150656\n**********************************************************************\n```\n\nThis actually shows a bigger problem: it shows that some computations depend on machine floats and therefore are done only to 53 bits precision. In the code I see:\n\n```\nRealField(prec)(log(m))\n```\nthis should be\n\n```\nRealField(prec)(m).log()\n```\n(the best solution to avoid this is simply removing `from math import log`)\n\nAlso, I recommend you to write *once*\n\n```\nR = RealField(prec)\n```\nand then use `R(a)` every where.\n\nAlso, comparisons to `None` should be done with `is`: `a is None` or `a is not None`.",
    "created_at": "2013-10-19T09:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169770",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Sorry, but this needs work:

there are numerical precision issues on Solaris with `green_function`:

```
**********************************************************************
File "devel/sage/sage/schemes/projective/projective_morphism.py", line 1236, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function
Failed example:
    f.green_function(P.point([5,2],False),0,N=30)
Expected:
    1.7315451844777406965714211646
Got:
    1.7315451844777406965172110560
**********************************************************************
File "devel/sage/sage/schemes/projective/projective_morphism.py", line 1238, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function
Failed example:
    f.green_function(P.point([2,1],False),0,N=30)
Expected:
    0.86577259223181085968927265240
Got:
    0.86577259223181085966216759809
**********************************************************************
File "devel/sage/sage/schemes/projective/projective_morphism.py", line 1240, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.green_function
Failed example:
    f.green_function(P.point([1,1],False),0,N=30)
Expected:
    0.43288629610862337434550672337
Got:
    0.43288629610862337433195419621
**********************************************************************
File "devel/sage/sage/schemes/projective/projective_point.py", line 727, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.green_function
Failed example:
    Q.green_function(f,0,N=200,prec=200)
Expected:
    1.6460930160038721221892751679783564477424287857689424150860
Got:
    1.6460930160038721221892751679783564477424287857689424150656
**********************************************************************
```

This actually shows a bigger problem: it shows that some computations depend on machine floats and therefore are done only to 53 bits precision. In the code I see:

```
RealField(prec)(log(m))
```
this should be

```
RealField(prec)(m).log()
```
(the best solution to avoid this is simply removing `from math import log`)

Also, I recommend you to write *once*

```
R = RealField(prec)
```
and then use `R(a)` every where.

Also, comparisons to `None` should be done with `is`: `a is None` or `a is not None`.



---

archive/issue_comments_169771.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch \n\nRemoved the `math.log` function and replaced with `R.log()` everywhere it occurred. That should fix the precision issue.\n\nFixed comparisons to None everywhere they occurred.\n\nAlso, added another input check to the `error_bound` kwd.",
    "created_at": "2013-10-20T12:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169771",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:19" align="right">comment:19</div>

apply trac_14218_heights.patch trac_14218_remove_imports.patch 

Removed the `math.log` function and replaced with `R.log()` everywhere it occurred. That should fix the precision issue.

Fixed comparisons to None everywhere they occurred.

Also, added another input check to the `error_bound` kwd.



---

archive/issue_events_198417.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2013-10-20T13:00:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198417"
}
```



---

archive/issue_comments_169772.json:
```json
{
    "body": "Attachment: **[trac_14218_addon1.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)**",
    "created_at": "2013-10-20T17:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169772",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14218_addon1.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)**



---

archive/issue_comments_169773.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHello,\n\nI have added a patch which mainly cleans the doc a little bit.\n\nfor the patchbot:\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch trac_14218_addon1.patch\n\nBy the way, did you know that you could run your own patchbot on your own tickets instead of waiting for the bot of someone else ?",
    "created_at": "2013-10-20T17:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169773",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

Hello,

I have added a patch which mainly cleans the doc a little bit.

for the patchbot:

apply trac_14218_heights.patch trac_14218_remove_imports.patch trac_14218_addon1.patch

By the way, did you know that you could run your own patchbot on your own tickets instead of waiting for the bot of someone else ?



---

archive/issue_comments_169774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n \n * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)\n * [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)\n+* [attachment: trac_14218_addon1.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)\n``````\n",
    "created_at": "2013-10-20T17:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169774",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 
 * [attachment: trac_14218_heights.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)
 * [attachment: trac_14218_remove_imports.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_remove_imports.patch.gz)
+* [attachment: trac_14218_addon1.patch](https://github.com/sagemath/sage/files/ticket14218/trac_14218_addon1.patch.gz)
``````




---

archive/issue_comments_169775.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI suggest removing the added\n\n```\nfrom math import log\n```\n(the addon patch removes only 1 out of 2)",
    "created_at": "2013-10-21T12:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169775",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

I suggest removing the added

```
from math import log
```
(the addon patch removes only 1 out of 2)



---

archive/issue_comments_169776.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nYes, thanks, I'll upload a new version that gets the missed one in affine_point.py as soon as my tests are done.",
    "created_at": "2013-10-21T12:24:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169776",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:23" align="right">comment:23</div>

Yes, thanks, I'll upload a new version that gets the missed one in affine_point.py as soon as my tests are done.



---

archive/issue_comments_169777.json:
```json
{
    "body": "Attachment: **[trac_14218_heights.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)**\n\nremoved the log import from affine_point.py",
    "created_at": "2013-10-21T17:30:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169777",
    "user": "https://github.com/bhutz"
}
```

Attachment: **[trac_14218_heights.patch.gz](https://github.com/sagemath/sage/files/ticket14218/trac_14218_heights.patch.gz)**

removed the log import from affine_point.py



---

archive/issue_comments_169778.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\napply trac_14218_heights.patch trac_14218_remove_imports.patch trac_14218_addon1.patch \n\nall I have to say is that I can't wait to switch to git instead of dealing with a stack of patches like this...",
    "created_at": "2013-10-21T17:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169778",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:24" align="right">comment:24</div>

apply trac_14218_heights.patch trac_14218_remove_imports.patch trac_14218_addon1.patch 

all I have to say is that I can't wait to switch to git instead of dealing with a stack of patches like this...



---

archive/issue_comments_169779.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@bhutz](#comment:24):\n> all I have to say is that I can't wait to switch to git instead of dealing with a stack of patches like this...\n\nIt is perfectly fine to fold all patches into one patch.",
    "created_at": "2013-10-22T06:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169779",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@bhutz](#comment:24):
> all I have to say is that I can't wait to switch to git instead of dealing with a stack of patches like this...

It is perfectly fine to fold all patches into one patch.



---

archive/issue_events_198418.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-24T18:02:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198418"
}
```



---

archive/issue_events_198419.json:
```json
{
    "actor": "https://github.com/sagetrac-atowsley",
    "created_at": "2013-10-24T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198419"
}
```



---

archive/issue_comments_169780.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nGreen's function works and is accurate on my computer.",
    "created_at": "2013-10-24T18:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169780",
    "user": "https://github.com/sagetrac-atowsley"
}
```

<div id="comment:26" align="right">comment:26</div>

Green's function works and is accurate on my computer.



---

archive/issue_events_198420.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198420"
}
```



---

archive/issue_events_198421.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14218#event-198421"
}
```



---

archive/issue_comments_169781.json:
```json
{
    "body": "Merged: **sage-5.13.beta2**",
    "created_at": "2013-10-31T19:16:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169781",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta2**



---

archive/issue_comments_169782.json:
```json
{
    "body": "Changed author from **Ben Hutz** to **Benjamin Hutz**",
    "created_at": "2013-12-15T08:44:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169782",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Ben Hutz** to **Benjamin Hutz**



---

archive/issue_comments_169783.json:
```json
{
    "body": "Changed author from **Benjamin Hutz** to **Ben Hutz**",
    "created_at": "2016-04-15T20:26:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14218#issuecomment-169783",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Benjamin Hutz** to **Ben Hutz**
