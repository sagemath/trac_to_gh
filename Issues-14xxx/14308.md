# Issue 14308: unwanted maxima verbose output

archive/issues_014104.json:
```json
{
    "assignees": [],
    "body": "with Sage 5.7 I get:\n\n```\nsage: a, q, k = var('a, q, k'); assume(q > 1)                            \nsage: try:\n....:     sum(a*q^k, k, 0, infinity)\n....: except ValueError:\n....:     0\n....:     \n#0: simplify_sum(expr='sum(q^k,k,0,inf))\n#1: simplify_sum(expr=a*'sum(q^k,k,0,inf))\n0\n```\nWhy do I get the `#0` and `#1` lines?\n\nPaul\n\nPS: this is one of the examples of our book (in french) about Sage at\nhttp://sagebook.gforge.inria.fr/, and it makes our doctests fail.\n\nAssignee: **@williamstein**\n\nBranch/Commit: **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**\n\nReviewer: **Karl-Dieter Crisman, Paul Zimmermann**\n\nAuthor: **Nils Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14308_\n\n",
    "closed_at": "2022-10-17T22:43:42Z",
    "created_at": "2013-03-19T09:41:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "unwanted maxima verbose output",
    "type": "issue",
    "updated_at": "2022-10-17T22:43:42Z",
    "url": "https://github.com/sagemath/sage/issues/14308",
    "user": "https://github.com/zimmermann6"
}
```
with Sage 5.7 I get:

```
sage: a, q, k = var('a, q, k'); assume(q > 1)                            
sage: try:
....:     sum(a*q^k, k, 0, infinity)
....: except ValueError:
....:     0
....:     
#0: simplify_sum(expr='sum(q^k,k,0,inf))
#1: simplify_sum(expr=a*'sum(q^k,k,0,inf))
0
```
Why do I get the `#0` and `#1` lines?

Paul

PS: this is one of the examples of our book (in french) about Sage at
http://sagebook.gforge.inria.fr/, and it makes our doctests fail.

Assignee: **@williamstein**

Branch/Commit: **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**

Reviewer: **Karl-Dieter Crisman, Paul Zimmermann**

Author: **Nils Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/14308_





---

archive/issue_events_178725.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2013-03-19T09:41:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178725"
}
```



---

archive/issue_events_178726.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2013-03-19T09:41:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "component: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178726"
}
```



---

archive/issue_events_178727.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2013-03-19T09:41:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178727"
}
```



---

archive/issue_events_178728.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2013-03-19T09:41:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178728"
}
```



---

archive/issue_comments_174066.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nI get those sometimes too, but I don't recall them making doctests fail...  It's some kind of verbose Maxima thing.",
    "created_at": "2013-03-19T13:32:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174066",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'>Comment 1:</a>
I get those sometimes too, but I don't recall them making doctests fail...  It's some kind of verbose Maxima thing.



---

archive/issue_events_178729.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178729"
}
```



---

archive/issue_events_178730.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178730"
}
```



---

archive/issue_events_178731.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178731"
}
```



---

archive/issue_events_178732.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178732"
}
```



---

archive/issue_events_178733.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178733"
}
```



---

archive/issue_events_178734.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178734"
}
```



---

archive/issue_events_178735.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178735"
}
```



---

archive/issue_events_178736.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178736"
}
```



---

archive/issue_comments_174067.json:
```json
{
    "body": "Changed assignee from **@burcin** to **@williamstein**",
    "created_at": "2014-11-17T17:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174067",
    "user": "https://github.com/kcrisman"
}
```

Changed assignee from **@burcin** to **@williamstein**



---

archive/issue_events_178737.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-17T17:29:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "component: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178737"
}
```



---

archive/issue_events_178738.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-17T17:29:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178738"
}
```



---

archive/issue_events_178739.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-17T17:29:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "title_is": "unwanted maxima verbose output",
    "title_was": "strange debug output",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178739"
}
```



---

archive/issue_comments_174068.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThis is just what maxima does. It prints a bit of a stack backtrace:\n\n```\n(%i1) t(a):= if a = 0 then 1/0 else t(a-1);\n                                           1\n(%o1)                t(a) := if a = 0 then - else t(a - 1)\n                                           0\n(%i2) t(10);\n\nexpt: undefined: 0 to a negative exponent.\n#0: t(a=0)(stdin line 0)\n#1: t(a=1)(stdin line 0)\n#2: t(a=2)(stdin line 0)\n -- an error. To debug this try: debugmode(true);\n```\nApparently we're not turning this off.",
    "created_at": "2014-11-18T06:14:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174068",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:7'>Comment 7:</a>
This is just what maxima does. It prints a bit of a stack backtrace:

```
(%i1) t(a):= if a = 0 then 1/0 else t(a-1);
                                           1
(%o1)                t(a) := if a = 0 then - else t(a - 1)
                                           0
(%i2) t(10);

expt: undefined: 0 to a negative exponent.
#0: t(a=0)(stdin line 0)
#1: t(a=1)(stdin line 0)
#2: t(a=2)(stdin line 0)
 -- an error. To debug this try: debugmode(true);
```
Apparently we're not turning this off.



---

archive/issue_comments_174069.json:
```json
{
    "body": "Branch: **[u/nbruin/maxima_verbose_output](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/maxima_verbose_output)**",
    "created_at": "2014-11-18T07:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174069",
    "user": "https://github.com/nbruin"
}
```

Branch: **[u/nbruin/maxima_verbose_output](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/maxima_verbose_output)**



---

archive/issue_events_178740.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2014-11-18T07:46:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178740"
}
```



---

archive/issue_comments_174070.json:
```json
{
    "body": "Author: **Nils Bruin**",
    "created_at": "2014-11-18T07:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174070",
    "user": "https://github.com/nbruin"
}
```

Author: **Nils Bruin**



---

archive/issue_comments_174071.json:
```json
{
    "body": "Commit: **[9724271](https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe)**",
    "created_at": "2014-11-18T07:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174071",
    "user": "https://github.com/nbruin"
}
```

Commit: **[9724271](https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe)**



---

archive/issue_comments_174072.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThanks! that error finally make me find the better routine in maxima to execute maxima code while getting lisp errors rather than maxima's own funny throw/catch signalling. This simplifies code considerably.\n\nfor reference: the printing of 3 lines of traceback is hardcoded in `merror` (in the file `merror.lisp`), just prior to throwing the `macsyma-quit`. Previously we were just catching that throw, but the traceback would already have been printed. Instead, by using `with-$error` we make sure we end up in a different branch (by setting `errcatch` to T), which ensures `merror` will just raise the appropriate error.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe\">9724271</a></td><td><code>trac 14308: use maxima's own lisp routine for running maxima code while producing lisp errors</code></td></tr></table>\n",
    "created_at": "2014-11-18T07:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174072",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:9'>Comment 9:</a>
Thanks! that error finally make me find the better routine in maxima to execute maxima code while getting lisp errors rather than maxima's own funny throw/catch signalling. This simplifies code considerably.

for reference: the printing of 3 lines of traceback is hardcoded in `merror` (in the file `merror.lisp`), just prior to throwing the `macsyma-quit`. Previously we were just catching that throw, but the traceback would already have been printed. Instead, by using `with-$error` we make sure we end up in a different branch (by setting `errcatch` to T), which ensures `merror` will just raise the appropriate error.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe">9724271</a></td><td><code>trac 14308: use maxima's own lisp routine for running maxima code while producing lisp errors</code></td></tr></table>




---

archive/issue_comments_174073.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\n> that error finally make me find the better routine in maxima to execute maxima code [...]\n\ngreat!\n\nPaul",
    "created_at": "2014-11-18T08:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174073",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:10'>Comment 10:</a>
> that error finally make me find the better routine in maxima to execute maxima code [...]

great!

Paul



---

archive/issue_comments_174074.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\n> > that error finally make me find the better routine in maxima to execute maxima code [...]\n\n> \n> great!\n\nIndeed!  Took me a while to figure out what was going on there but I agree this is probably better than printing the backtrace (though see [here](http://comments.gmane.org/gmane.comp.mathematics.maxima.general/40253) for some other discussion; we could have just commented that out in a patch).  The only downside is that it now talks only about ECL and not Maxima, which may be confusing for some folks.  What do you think?  Otherwise this is fine, modulo doctests...\n\n```\n\nsage -t src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 9388, in sage.symbolic.expression.Expression.solve\nFailed example:\n    solve(acot(x),x)\n    TypeError: ECL says: cot: argument 0 isn't in the domain of cot.\n\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 9393, in sage.symbolic.expression.Expression.solve\nFailed example:\n    solve(acot(x),x,to_poly_solve=True)\n    TypeError: ECL says: cot: argument 0 isn't in the domain of cot.\n\n**********************************************************************\n1 item had failures:\n```\nThis comes from\n\n```\n\n        TESTS:\n\n        :trac:`7325` (solving inequalities)::\n\n            sage: (x^2>1).solve(x)\n            [[x < -1], [x > 1]]\n\n        Catch error message from Maxima::\n\n            sage: solve(acot(x),x)\n            []\n\n        ::\n\n            sage: solve(acot(x),x,to_poly_solve=True)\n            []\n```\nAmazingly, I personally am responsible for the [code](https://github.com/sagemath/sage/files/ticket7745/trac_7745-upgrade-maxima.patch.gz) that catches this.   Now that we have the lib etc., what do you think?  I think it's still okay that we catch an error in solve and just return that we can't do it, but in retrospect the way I did it was just enough to get by.",
    "created_at": "2014-11-18T14:59:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174074",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'>Comment 11:</a>
> > that error finally make me find the better routine in maxima to execute maxima code [...]

> 
> great!

Indeed!  Took me a while to figure out what was going on there but I agree this is probably better than printing the backtrace (though see [here](http://comments.gmane.org/gmane.comp.mathematics.maxima.general/40253) for some other discussion; we could have just commented that out in a patch).  The only downside is that it now talks only about ECL and not Maxima, which may be confusing for some folks.  What do you think?  Otherwise this is fine, modulo doctests...

```

sage -t src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 9388, in sage.symbolic.expression.Expression.solve
Failed example:
    solve(acot(x),x)
    TypeError: ECL says: cot: argument 0 isn't in the domain of cot.

**********************************************************************
File "src/sage/symbolic/expression.pyx", line 9393, in sage.symbolic.expression.Expression.solve
Failed example:
    solve(acot(x),x,to_poly_solve=True)
    TypeError: ECL says: cot: argument 0 isn't in the domain of cot.

**********************************************************************
1 item had failures:
```
This comes from

```

        TESTS:

        :trac:`7325` (solving inequalities)::

            sage: (x^2>1).solve(x)
            [[x < -1], [x > 1]]

        Catch error message from Maxima::

            sage: solve(acot(x),x)
            []

        ::

            sage: solve(acot(x),x,to_poly_solve=True)
            []
```
Amazingly, I personally am responsible for the [code](https://github.com/sagemath/sage/files/ticket7745/trac_7745-upgrade-maxima.patch.gz) that catches this.   Now that we have the lib etc., what do you think?  I think it's still okay that we catch an error in solve and just return that we can't do it, but in retrospect the way I did it was just enough to get by.



---

archive/issue_comments_174075.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nmy opinion is that it is better to get rid of those debug lines from Maxima,\nthat couldn't be caught at all before. Thanks.\n\nPaul",
    "created_at": "2014-11-18T15:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174075",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:12'>Comment 12:</a>
my opinion is that it is better to get rid of those debug lines from Maxima,
that couldn't be caught at all before. Thanks.

Paul



---

archive/issue_comments_174076.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@kcrisman](#comment%3A11):\n> > > that error finally make me find the better routine in maxima to execute maxima code [...]\n\n> > \n> > great!\n\n> \n> The only downside is that it now talks only about ECL and not Maxima, which may be confusing for some folks.  What do you think?\n\nI'm not so keen on the ECL says -- Maxima says bit. It makes debugging feel like marriage counselling. I only put that in when I was writing the error catching and I wanted to confirm which code was catching/producing the errors. We can of course regain this behaviour quite easily without patching merror or writing the horrible shim we had before. If errcatch is true then merror raises a very clearly marked condition (CL for exception) so we could just catch that and raise another error with the \"Maxima says\" thrown in. I'd rather stick to what maxima offers already, though.\n\n> Amazingly, I personally am responsible for the [code](https://github.com/sagemath/sage/files/ticket7745/trac_7745-upgrade-maxima.patch.gz) that catches this.   Now that we have the lib etc., what do you think?  I think it's still okay that we catch an error in solve and just return that we can't do it, but in retrospect the way I did it was just enough to get by.\n\nI would normally think it's not a good idea to catch that error so broadly -- you really only know *something* went wrong (and having Maxima in the error message hardly improves that -- Checking the \"ECL\" is hardly more generic). On the other hand, it's in solve. Those answers aren't trustworthy if there's no error either.",
    "created_at": "2014-11-18T17:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174076",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@kcrisman](#comment%3A11):
> > > that error finally make me find the better routine in maxima to execute maxima code [...]

> > 
> > great!

> 
> The only downside is that it now talks only about ECL and not Maxima, which may be confusing for some folks.  What do you think?

I'm not so keen on the ECL says -- Maxima says bit. It makes debugging feel like marriage counselling. I only put that in when I was writing the error catching and I wanted to confirm which code was catching/producing the errors. We can of course regain this behaviour quite easily without patching merror or writing the horrible shim we had before. If errcatch is true then merror raises a very clearly marked condition (CL for exception) so we could just catch that and raise another error with the "Maxima says" thrown in. I'd rather stick to what maxima offers already, though.

> Amazingly, I personally am responsible for the [code](https://github.com/sagemath/sage/files/ticket7745/trac_7745-upgrade-maxima.patch.gz) that catches this.   Now that we have the lib etc., what do you think?  I think it's still okay that we catch an error in solve and just return that we can't do it, but in retrospect the way I did it was just enough to get by.

I would normally think it's not a good idea to catch that error so broadly -- you really only know *something* went wrong (and having Maxima in the error message hardly improves that -- Checking the "ECL" is hardly more generic). On the other hand, it's in solve. Those answers aren't trustworthy if there's no error either.



---

archive/issue_comments_174077.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\n> On the other hand, it's in solve. Those answers aren't trustworthy if there's no error either.\n\nIn this particular case, I guess we noticed that \n\n```\ncot: argument 0 isn't in the domain of cot.\n```\nwhich is true, and so solve should give the empty solution.  Would it be fairly easy to change that solve code to catch this type of wording `argument 0 isn't in the domain` in which case presumably no solution *is* correct?  Though...\n\n```\n(%i6) solve(x*acot(x),x);\n\ncot: argument 0 isn't in the domain of cot.\n(%i7) acot(0)\n;\n                                      %pi\n(%o7)                                 ---\n                                       2\n```\nwhich is not ideal.  I opened https://sourceforge.net/p/maxima/bugs/2844/ for this.\n\nAnyway, one way or another that doctest failure needs to be dealt with, and so much the better if it improves the solve code.",
    "created_at": "2014-11-18T17:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174077",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'>Comment 14:</a>
> On the other hand, it's in solve. Those answers aren't trustworthy if there's no error either.

In this particular case, I guess we noticed that 

```
cot: argument 0 isn't in the domain of cot.
```
which is true, and so solve should give the empty solution.  Would it be fairly easy to change that solve code to catch this type of wording `argument 0 isn't in the domain` in which case presumably no solution *is* correct?  Though...

```
(%i6) solve(x*acot(x),x);

cot: argument 0 isn't in the domain of cot.
(%i7) acot(0)
;
                                      %pi
(%o7)                                 ---
                                       2
```
which is not ideal.  I opened https://sourceforge.net/p/maxima/bugs/2844/ for this.

Anyway, one way or another that doctest failure needs to be dealt with, and so much the better if it improves the solve code.



---

archive/issue_comments_174078.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2014-12-03T15:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174078",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_comments_174079.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nAnyway, one way or another we need to decide what to do with these doctests.",
    "created_at": "2014-12-03T15:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174079",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'>Comment 15:</a>
Anyway, one way or another we need to decide what to do with these doctests.



---

archive/issue_events_178741.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-03T15:05:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178741"
}
```



---

archive/issue_events_178742.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-03T15:05:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178742"
}
```



---

archive/issue_events_178743.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-10T12:28:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178743"
}
```



---

archive/issue_events_178744.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-10T12:28:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178744"
}
```



---

archive/issue_events_178745.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-10T12:28:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178745"
}
```



---

archive/issue_events_178746.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-10T12:28:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178746"
}
```



---

archive/issue_comments_174080.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\ntrying again\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521\">2475b31</a></td><td><code>simplify maxima error handling</code></td></tr></table>\n",
    "created_at": "2022-10-10T12:28:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174080",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>Comment 16:</a>
trying again

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521">2475b31</a></td><td><code>simplify maxima error handling</code></td></tr></table>




---

archive/issue_comments_174081.json:
```json
{
    "body": "Changed branch from **[u/nbruin/maxima_verbose_output](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/maxima_verbose_output)** to **[public/ticket/14308](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14308)**",
    "created_at": "2022-10-10T12:28:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174081",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/nbruin/maxima_verbose_output](https://github.com/sagemath/sagetrac-mirror/tree/u/nbruin/maxima_verbose_output)** to **[public/ticket/14308](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14308)**



---

archive/issue_comments_174082.json:
```json
{
    "body": "Changed commit from **[9724271](https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe)** to **[2475b31](https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521)**",
    "created_at": "2022-10-10T12:28:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174082",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[9724271](https://github.com/sagemath/sagetrac-mirror/commit/972427193788bc3f0c61951b063780772d55edfe)** to **[2475b31](https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521)**



---

archive/issue_comments_174083.json:
```json
{
    "body": "Changed commit from **[2475b31](https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521)** to **[9a9af76](https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8)**",
    "created_at": "2022-10-10T13:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174083",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2475b31](https://github.com/sagemath/sagetrac-mirror/commit/2475b31d2046ac176b41f5c8ebe1831215519521)** to **[9a9af76](https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8)**



---

archive/issue_comments_174084.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8\">9a9af76</a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2022-10-10T13:30:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174084",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8">9a9af76</a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_comments_174085.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af\">e5a96a1</a></td><td><code>simplify maxima error handling</code></td></tr></table>\n",
    "created_at": "2022-10-11T08:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174085",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'>Comment 18:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af">e5a96a1</a></td><td><code>simplify maxima error handling</code></td></tr></table>




---

archive/issue_comments_174086.json:
```json
{
    "body": "Changed commit from **[9a9af76](https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8)** to **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**",
    "created_at": "2022-10-11T08:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174086",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9a9af76](https://github.com/sagemath/sagetrac-mirror/commit/9a9af76644116337a602aa927fbd4419ad64d4b8)** to **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**



---

archive/issue_comments_174087.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI get several doctesting failures when applying this patch to master, but they look unrelated:\n\n```\nFeatures detected for doctesting: 4ti2,gfan,graphviz,imagemagick,nauty,palp,pandoc,pdftocairo,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.misc.cython,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sagemath_doc_html,sphinx\npytest is not installed in the venv, skip checking tests that rely on it\n```\nThus this seems ok for me.",
    "created_at": "2022-10-12T06:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174087",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:19'>Comment 19:</a>
I get several doctesting failures when applying this patch to master, but they look unrelated:

```
Features detected for doctesting: 4ti2,gfan,graphviz,imagemagick,nauty,palp,pandoc,pdftocairo,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.misc.cython,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sagemath_doc_html,sphinx
pytest is not installed in the venv, skip checking tests that rely on it
```
Thus this seems ok for me.



---

archive/issue_comments_174088.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Paul Zimmermann**",
    "created_at": "2022-10-12T06:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174088",
    "user": "https://github.com/zimmermann6"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Paul Zimmermann**



---

archive/issue_events_178747.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2022-10-12T06:44:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178747"
}
```



---

archive/issue_events_178748.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2022-10-12T06:44:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178748"
}
```



---

archive/issue_events_178749.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-17T22:43:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178749"
}
```



---

archive/issue_events_178750.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "df5472fb5375ca20e14c9b0855d4c9332d97be1f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-10-17T22:43:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14308#event-178750"
}
```



---

archive/issue_comments_174089.json:
```json
{
    "body": "Changed branch from **[public/ticket/14308](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14308)** to **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**",
    "created_at": "2022-10-17T22:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14308#issuecomment-174089",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/14308](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14308)** to **[e5a96a1](https://github.com/sagemath/sagetrac-mirror/commit/e5a96a17642ef4453e6a1344126d5007735711af)**
