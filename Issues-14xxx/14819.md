# Issue 14819: Root system plot improvements: arrow tips, fundamental polygon, ...

archive/issues_014615.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "This small patch implements some little improvements to root system plots:\n\n- Configurable arrow tip size\n- Thicker 0-walls to highlight the fundamental polygon and its translates\n\nTODO, in this ticket or later: \"a4\" \"a4l\" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.\n\nApply [attachment: trac_14819-root_system_plots-nt-folded.patch](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw**\n\nAuthor: **Nicolas M. Thi\u00e9ry**\n\nMerged: **sage-5.12.beta4**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14819_\n\n",
    "closed_at": "2013-08-28T06:54:03Z",
    "created_at": "2013-06-25T13:59:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Root system plot improvements: arrow tips, fundamental polygon, ...",
    "type": "issue",
    "updated_at": "2013-08-28T06:54:03Z",
    "url": "https://github.com/sagemath/sage/issues/14819",
    "user": "https://github.com/nthiery"
}
```
This small patch implements some little improvements to root system plots:

- Configurable arrow tip size
- Thicker 0-walls to highlight the fundamental polygon and its translates

TODO, in this ticket or later: "a4" "a4l" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.

Apply [attachment: trac_14819-root_system_plots-nt-folded.patch](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)

Reviewer: **Frédéric Chapoton, Travis Scrimshaw**

Author: **Nicolas M. Thiéry**

Merged: **sage-5.12.beta4**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/14819_





---

archive/issue_events_211514.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-06-25T13:59:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211514"
}
```



---

archive/issue_events_211515.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-06-25T13:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211515"
}
```



---

archive/issue_events_211516.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-06-25T13:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211516"
}
```



---

archive/issue_events_211517.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-06-25T13:59:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211517"
}
```



---

archive/issue_events_211518.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2013-06-25T13:59:47Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "subject": "https://github.com/nthiery",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211518"
}
```



---

archive/issue_comments_181248.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_14819-root_system_plots-nt.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt.patch.gz)**",
    "created_at": "2013-06-25T14:03:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181248",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_14819-root_system_plots-nt.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt.patch.gz)**



---

archive/issue_events_211519.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-06-25T14:03:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211519"
}
```



---

archive/issue_comments_181249.json:
```json
{
    "body": "Attachment: **[trac_14819_review1.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819_review1.patch.gz)**",
    "created_at": "2013-08-21T12:39:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181249",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14819_review1.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819_review1.patch.gz)**



---

archive/issue_comments_181250.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nhere is a review patch, trying to make all tests pass",
    "created_at": "2013-08-21T12:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181250",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">comment:2</div>

here is a review patch, trying to make all tests pass



---

archive/issue_comments_181251.json:
```json
{
    "body": "Attachment: **[trac_14819-review2-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-review2-ts.patch.gz)**",
    "created_at": "2013-08-24T15:59:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181251",
    "user": "https://github.com/tscrim"
}
```

Attachment: **[trac_14819-review2-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-review2-ts.patch.gz)**



---

archive/issue_comments_181252.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAll tests pass for me, however I'm a little paranoid about ordering in dictionaries (of more than 3 entries), so I've just changed it to output a sorted list of the items.",
    "created_at": "2013-08-24T16:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181252",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

All tests pass for me, however I'm a little paranoid about ordering in dictionaries (of more than 3 entries), so I've just changed it to output a sorted list of the items.



---

archive/issue_comments_181253.json:
```json
{
    "body": "Reviewer: **Federic Chapoton, Travis Scrimshaw**",
    "created_at": "2013-08-24T16:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181253",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Federic Chapoton, Travis Scrimshaw**



---

archive/issue_comments_181254.json:
```json
{
    "body": "Changed reviewer from **Federic Chapoton, Travis Scrimshaw** to **Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw**",
    "created_at": "2013-08-24T19:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181254",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Federic Chapoton, Travis Scrimshaw** to **Frédéric Chapoton, Travis Scrimshaw**



---

archive/issue_comments_181255.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI agree with your changes. \n\nShould we wait until the patchbot raises from the deads, before we give a positive review ?",
    "created_at": "2013-08-24T19:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181255",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

I agree with your changes. 

Should we wait until the patchbot raises from the deads, before we give a positive review ?



---

archive/issue_comments_181256.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI think we should wait (at most a day) as well. I just gave it a kick since it timed out on trying to apply this ticket.",
    "created_at": "2013-08-24T19:33:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181256",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

I think we should wait (at most a day) as well. I just gave it a kick since it timed out on trying to apply this ticket.



---

archive/issue_comments_181257.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSo the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?",
    "created_at": "2013-08-25T01:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181257",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?



---

archive/issue_comments_181258.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI get the same failure as the bot on 5.12.beta3\n\nSo I propose to correct the doctest. Here is a patch doing just that",
    "created_at": "2013-08-25T07:25:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181258",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

I get the same failure as the bot on 5.12.beta3

So I propose to correct the doctest. Here is a patch doing just that



---

archive/issue_comments_181259.json:
```json
{
    "body": "Attachment: **[trac_14819_review3-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819_review3-fc.patch.gz)**",
    "created_at": "2013-08-25T07:25:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181259",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14819_review3-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819_review3-fc.patch.gz)**



---

archive/issue_comments_181260.json:
```json
{
    "body": "Attachment: **[trac_14819-root_system_plots-nt-folded.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)**",
    "created_at": "2013-08-25T13:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181260",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14819-root_system_plots-nt-folded.patch.gz](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)**



---

archive/issue_comments_181261.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI have folded all the patches:\n\napply only trac_14819-root_system_plots-nt-folded.patch",
    "created_at": "2013-08-25T13:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181261",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

I have folded all the patches:

apply only trac_14819-root_system_plots-nt-folded.patch



---

archive/issue_comments_181262.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,4 @@\n \n TODO, in this ticket or later: \"a4\" \"a4l\" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.\n \n+Apply [attachment: trac_14819-root_system_plots-nt-folded.patch](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)\n``````\n",
    "created_at": "2013-08-25T13:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181262",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,4 @@
 
 TODO, in this ticket or later: "a4" "a4l" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.
 
+Apply [attachment: trac_14819-root_system_plots-nt-folded.patch](https://github.com/sagemath/sage/files/ticket14819/trac_14819-root_system_plots-nt-folded.patch.gz)
``````




---

archive/issue_events_211520.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-08-25T17:08:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211520"
}
```



---

archive/issue_events_211521.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-08-25T17:08:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211521"
}
```



---

archive/issue_comments_181263.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nNow I get (with `sage-5.11.rc0` in the combinat queue):\n\n```\nsage -t root_lattice_realizations.py\n    [450 tests, 49.10 s]\nsage -t plot.py\n**********************************************************************\nFile \"plot.py\", line 1091, in sage.combinat.root_system.plot.PlotOptions.?\nFailed example:\n    sorted(p[0].options().items())\nExpected:\n    [('alpha', 0.500000000000000), ('legend_color', None),\n     ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4),\n     ('zorder', 1)]\nGot:\n    [('alpha', 0.500000000000000), ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4), ('zorder', 1)]\n**********************************************************************\n1 item had failures:\n   1 of  33 in sage.combinat.root_system.plot.PlotOptions.?\n    [252 tests, 1 failure, 74.20 s]\n----------------------------------------------------------------------\nsage -t plot.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nSo it's probable that something changed between `5.11.rc0` and `5.12.beta3` which is not reflected in the combinat queue. I'm going to set this to positive review and build `5.12.beta3` today and report back if I get a doctest failure.",
    "created_at": "2013-08-25T17:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181263",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

Now I get (with `sage-5.11.rc0` in the combinat queue):

```
sage -t root_lattice_realizations.py
    [450 tests, 49.10 s]
sage -t plot.py
**********************************************************************
File "plot.py", line 1091, in sage.combinat.root_system.plot.PlotOptions.?
Failed example:
    sorted(p[0].options().items())
Expected:
    [('alpha', 0.500000000000000), ('legend_color', None),
     ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4),
     ('zorder', 1)]
Got:
    [('alpha', 0.500000000000000), ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4), ('zorder', 1)]
**********************************************************************
1 item had failures:
   1 of  33 in sage.combinat.root_system.plot.PlotOptions.?
    [252 tests, 1 failure, 74.20 s]
----------------------------------------------------------------------
sage -t plot.py  # 1 doctest failed
----------------------------------------------------------------------
```

So it's probable that something changed between `5.11.rc0` and `5.12.beta3` which is not reflected in the combinat queue. I'm going to set this to positive review and build `5.12.beta3` today and report back if I get a doctest failure.



---

archive/issue_comments_181264.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tscrim](#comment:6):\n> So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?\n\nOr with some properly placed \"...\" ?\n\nIn any cases, thanks guys for reviewing this ticket!",
    "created_at": "2013-08-27T10:53:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181264",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tscrim](#comment:6):
> So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?

Or with some properly placed "..." ?

In any cases, thanks guys for reviewing this ticket!



---

archive/issue_comments_181265.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIt worked for me on `5.12.beta3`, so something probably changed in the general graphics part of Sage...",
    "created_at": "2013-08-27T15:56:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181265",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

It worked for me on `5.12.beta3`, so something probably changed in the general graphics part of Sage...



---

archive/issue_comments_181266.json:
```json
{
    "body": "Merged: **sage-5.12.beta4**",
    "created_at": "2013-08-28T06:54:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14819#issuecomment-181266",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta4**



---

archive/issue_events_211522.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-28T06:54:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211522"
}
```



---

archive/issue_events_211523.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-28T06:54:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14819",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14819#event-211523"
}
```
