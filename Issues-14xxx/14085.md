# Issue 14085: Ambient spaces for dual and affine root systems

archive/issues_013881.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "This ticket implements ambient spaces for dual and affine root\nsystems. So now all finite and affine crystallographic root systems\nhave an ambient space, except for relabeled ones (to be handled in a\nseparate ticket).\n\nUpcoming applications:\n\n* Plotting #4237\n* Affine permutation representations built from the ambient space\n* Macdonald polynomials\n* Affine weight ring (in waiting for #7922 for weight rings built from\n  the root or weight lattice)\n\nA couple things handled by this patch:\n- Fixing a couple whitespaces\n- Standard color scheme (to be used by #4237)\n- Fundamental weights computed from simple roots (finite type)\n- Better handling of the smallest base ring for the ambient space\n  (toward ambient spaces over fields/rings like RR)\n- Better handling of dual types: in particular make sure the dual\n  CartanType belongs to the appropriate CartanType classes; this\n  allowed to remove now unnecessary code.\n- Fix the embedding of the root lattice into the extended weight\n  lattice for type BC dual. A Type free approach would be better.\n- Prevent affine crystals to use the ambient space, even if available,\n  for backward compatibility. This may be changed in a later ticket.\n- Implement to_simple_root, and generalizes associated_reflection for\n  every root lattice realizations using it\n- More tests for the null (co)root.\n- Improved section about ambient spaces in the introduction to root systems.\n  Includes the link with (affine/signed) permutation representations.\n- Improved doc for the delta notation glitch for extended weight lattice realizations.\n- Various documentation improvements.\n\nCC:  @sagetrac-sage-combinat @tscrim @sagetrac-mshimo @anneschilling\n\nReviewer: **Dan Orr, Anne Schilling**\n\nAuthor: **Nicolas M. Thi\u00e9ry**\n\nMerged: **sage-5.8.beta2**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14085_\n\n",
    "closed_at": "2013-02-28T10:34:02Z",
    "created_at": "2013-02-09T01:43:33Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Ambient spaces for dual and affine root systems",
    "type": "issue",
    "updated_at": "2013-02-28T10:34:02Z",
    "url": "https://github.com/sagemath/sage/issues/14085",
    "user": "https://github.com/nthiery"
}
```
This ticket implements ambient spaces for dual and affine root
systems. So now all finite and affine crystallographic root systems
have an ambient space, except for relabeled ones (to be handled in a
separate ticket).

Upcoming applications:

* Plotting #4237
* Affine permutation representations built from the ambient space
* Macdonald polynomials
* Affine weight ring (in waiting for #7922 for weight rings built from
  the root or weight lattice)

A couple things handled by this patch:
- Fixing a couple whitespaces
- Standard color scheme (to be used by #4237)
- Fundamental weights computed from simple roots (finite type)
- Better handling of the smallest base ring for the ambient space
  (toward ambient spaces over fields/rings like RR)
- Better handling of dual types: in particular make sure the dual
  CartanType belongs to the appropriate CartanType classes; this
  allowed to remove now unnecessary code.
- Fix the embedding of the root lattice into the extended weight
  lattice for type BC dual. A Type free approach would be better.
- Prevent affine crystals to use the ambient space, even if available,
  for backward compatibility. This may be changed in a later ticket.
- Implement to_simple_root, and generalizes associated_reflection for
  every root lattice realizations using it
- More tests for the null (co)root.
- Improved section about ambient spaces in the introduction to root systems.
  Includes the link with (affine/signed) permutation representations.
- Improved doc for the delta notation glitch for extended weight lattice realizations.
- Various documentation improvements.

CC:  @sagetrac-sage-combinat @tscrim @sagetrac-mshimo @anneschilling

Reviewer: **Dan Orr, Anne Schilling**

Author: **Nicolas M. Thi√©ry**

Merged: **sage-5.8.beta2**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/14085_





---

archive/issue_events_198065.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T01:43:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198065"
}
```



---

archive/issue_events_198066.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T01:43:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198066"
}
```



---

archive/issue_events_198067.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T01:43:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198067"
}
```



---

archive/issue_events_198068.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T01:43:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198068"
}
```



---

archive/issue_events_198069.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2013-02-09T01:43:33Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "subject": "https://github.com/nthiery",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198069"
}
```



---

archive/issue_events_198070.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T02:08:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "title_is": "Ambient spaces for dual and affine root systems",
    "title_was": "Implement ambient spaces for dual and affine root systems",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198070"
}
```



---

archive/issue_comments_167509.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,25 @@\n+This ticket implements ambient spaces for dual and affine root\n+systems. So now all finite and affine crystallographic root systems\n+have an ambient space, except for relabeled ones (to be handled in a\n+separate ticket).\n \n+Upcoming applications:\n+\n+* Plotting #4237\n+* Affine permutation representations built from the ambient space\n+* Macdonald polynomials\n+* Affine weight ring (in waiting for #7922 for weight rings built from\n+  the root or weight lattice)\n+\n+A couple things handled by this patch:\n+- Fixing a couple whitespaces\n+- Standard color scheme (to be used by #4237)\n+- Fundamental weights computed from simple roots (finite type)\n+- Better handling of the smallest base ring for the ambient space\n+  (toward ambient spaces over fields/rings like RR)\n+- Better handling of dual types: in particular make sure the dual\n+  CartanType belongs to the appropriate CartanType classes; this\n+  allowed to remove now unnecessary code.\n+- Fix the embedding of the root lattice into the extended weight\n+  lattice for type BC dual. A Type free approach would be better.\n+\n``````\n",
    "created_at": "2013-02-09T02:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167509",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,25 @@
+This ticket implements ambient spaces for dual and affine root
+systems. So now all finite and affine crystallographic root systems
+have an ambient space, except for relabeled ones (to be handled in a
+separate ticket).
 
+Upcoming applications:
+
+* Plotting #4237
+* Affine permutation representations built from the ambient space
+* Macdonald polynomials
+* Affine weight ring (in waiting for #7922 for weight rings built from
+  the root or weight lattice)
+
+A couple things handled by this patch:
+- Fixing a couple whitespaces
+- Standard color scheme (to be used by #4237)
+- Fundamental weights computed from simple roots (finite type)
+- Better handling of the smallest base ring for the ambient space
+  (toward ambient spaces over fields/rings like RR)
+- Better handling of dual types: in particular make sure the dual
+  CartanType belongs to the appropriate CartanType classes; this
+  allowed to remove now unnecessary code.
+- Fix the embedding of the root lattice into the extended weight
+  lattice for type BC dual. A Type free approach would be better.
+
``````




---

archive/issue_events_198071.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T03:48:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198071"
}
```



---

archive/issue_events_198072.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T03:55:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198072"
}
```



---

archive/issue_events_198073.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T03:55:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198073"
}
```



---

archive/issue_comments_167510.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,4 +22,5 @@\n   allowed to remove now unnecessary code.\n - Fix the embedding of the root lattice into the extended weight\n   lattice for type BC dual. A Type free approach would be better.\n-\n+- Prevent affine crystals to use the ambient space, even if available,\n+  for backward compatibility. This may be changed in a later ticket.\n``````\n",
    "created_at": "2013-02-09T04:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167510",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,4 +22,5 @@
   allowed to remove now unnecessary code.
 - Fix the embedding of the root lattice into the extended weight
   lattice for type BC dual. A Type free approach would be better.
-
+- Prevent affine crystals to use the ambient space, even if available,
+  for backward compatibility. This may be changed in a later ticket.
``````




---

archive/issue_events_198074.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T04:33:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198074"
}
```



---

archive/issue_events_198075.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-09T04:33:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198075"
}
```



---

archive/issue_comments_167511.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe updated patch fixes two minor doctests failures I had missed and that the patchbot reported. I assume that the third failure in interface/expect.py is unrelated.\n\nCheers,\n                                Nicolas",
    "created_at": "2013-02-10T07:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167511",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:6" align="right">comment:6</div>

The updated patch fixes two minor doctests failures I had missed and that the patchbot reported. I assume that the third failure in interface/expect.py is unrelated.

Cheers,
                                Nicolas



---

archive/issue_comments_167512.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,3 +24,10 @@\n   lattice for type BC dual. A Type free approach would be better.\n - Prevent affine crystals to use the ambient space, even if available,\n   for backward compatibility. This may be changed in a later ticket.\n+- Implement to_simple_root, and generalizes associated_reflection for\n+  every root lattice realizations using it\n+- More tests for the null (co)root.\n+- Improved section about ambient spaces in the introduction to root systems.\n+  Includes the link with (affine/signed) permutation representations.\n+- Improved doc for the delta notation glitch for extended weight lattice realizations.\n+- Various documentation improvements.\n``````\n",
    "created_at": "2013-02-24T07:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167512",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,3 +24,10 @@
   lattice for type BC dual. A Type free approach would be better.
 - Prevent affine crystals to use the ambient space, even if available,
   for backward compatibility. This may be changed in a later ticket.
+- Implement to_simple_root, and generalizes associated_reflection for
+  every root lattice realizations using it
+- More tests for the null (co)root.
+- Improved section about ambient spaces in the introduction to root systems.
+  Includes the link with (affine/signed) permutation representations.
+- Improved doc for the delta notation glitch for extended weight lattice realizations.
+- Various documentation improvements.
``````




---

archive/issue_comments_167513.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNew version with quite a few improvements. Unless I missed something, I consider this patch as final. Please review!",
    "created_at": "2013-02-24T07:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167513",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:8" align="right">comment:8</div>

New version with quite a few improvements. Unless I missed something, I consider this patch as final. Please review!



---

archive/issue_comments_167514.json:
```json
{
    "body": "Attachment: **[trac_14085-root_system-ambient_spaces-nt.patch.gz](https://github.com/sagemath/sage/files/ticket14085/trac_14085-root_system-ambient_spaces-nt.patch.gz)**",
    "created_at": "2013-02-25T02:13:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167514",
    "user": "https://github.com/nthiery"
}
```

Attachment: **[trac_14085-root_system-ambient_spaces-nt.patch.gz](https://github.com/sagemath/sage/files/ticket14085/trac_14085-root_system-ambient_spaces-nt.patch.gz)**



---

archive/issue_comments_167515.json:
```json
{
    "body": "Changed reviewer from **Dan Orr, ...** to **Dan Orr, Anne Schilling**",
    "created_at": "2013-02-25T02:16:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167515",
    "user": "https://github.com/nthiery"
}
```

Changed reviewer from **Dan Orr, ...** to **Dan Orr, Anne Schilling**



---

archive/issue_events_198076.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-25T02:16:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198076"
}
```



---

archive/issue_events_198077.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2013-02-25T02:16:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198077"
}
```



---

archive/issue_comments_167516.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAnne reviewed this patch on the Sage-Combinat queue. The updated patch includes her changes which were cross checked by Nicolas. We also discussed further the math with Mark Shimozono.\n\nPositive review!\n                               Anne and Nicolas",
    "created_at": "2013-02-25T02:16:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167516",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:9" align="right">comment:9</div>

Anne reviewed this patch on the Sage-Combinat queue. The updated patch includes her changes which were cross checked by Nicolas. We also discussed further the math with Mark Shimozono.

Positive review!
                               Anne and Nicolas



---

archive/issue_comments_167517.json:
```json
{
    "body": "Merged: **sage-5.8.beta2**",
    "created_at": "2013-02-28T10:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14085#issuecomment-167517",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.8.beta2**



---

archive/issue_events_198078.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T10:34:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198078"
}
```



---

archive/issue_events_198079.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-28T10:34:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14085",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14085#event-198079"
}
```
