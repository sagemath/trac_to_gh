# Issue 14496: unify the three implementations of gaussian q-binomial coefficients

archive/issues_014292.json:
```json
{
    "assignees": [],
    "body": "In sage 5.8, one can find the gaussian q-binomial coefficients in (at least) **three** places :\n\n- sage.combinat.sf.kfpoly.q_bin\n- sage.combinat.q_analogues.q_binomial\n- sage.rings.arith.gaussian_binomial\n\nThe syntax is not quite the same for q_bin as for the two others.\n\nSome timings:\n\n```\nsage: timeit(\"sage.combinat.sf.kfpoly.q_bin(7,5)\")\n625 loops, best of 3: 819 \u00b5s per loop\nsage: timeit(\"sage.combinat.q_analogues.q_binomial(12,5)\")\n625 loops, best of 3: 1.12 ms per loop\nsage: timeit(\"sage.rings.arith.gaussian_binomial(12,5)\")  \n625 loops, best of 3: 294 \u00b5s per loop\n```\nThe parents :\n\n```\nsage: sage.combinat.sf.kfpoly.q_bin(7,5).parent()\nFraction Field of Univariate Polynomial Ring in t over Integer Ring\nsage: sage.combinat.q_analogues.q_binomial(12,5).parent()\nUnivariate Polynomial Ring in q over Integer Ring\nsage: sage.rings.arith.gaussian_binomial(12,5).parent()\nFraction Field of Univariate Polynomial Ring in q over Integer Ring\n```\nThe behaviour with an added integer parameter\n\n```\nsage: sage.combinat.sf.kfpoly.q_bin(7,5,2)               \n114429029715\nsage: sage.combinat.q_analogues.q_binomial(12,5,2)\nDOES NOT WORK\nsage: sage.rings.arith.gaussian_binomial(12,5,2)    \n114429029715\n```\nThe behaviour with a polynomial parameter\n\n```\nsage: w=polygen(ZZ,'w')\nsage: sage.combinat.sf.kfpoly.q_bin(4,2,w)\nw^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1\nsage: sage.combinat.q_analogues.q_binomial(6,2,w)   \nw^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1\nsage: sage.rings.arith.gaussian_binomial(6,2,w) \nw^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1\nsage: sage.combinat.sf.kfpoly.q_bin(4,2,w).parent()             \nUnivariate Polynomial Ring in w over Integer Ring\nsage: sage.combinat.q_analogues.q_binomial(6,2,w).parent()      \nUnivariate Polynomial Ring in w over Integer Ring\nsage: sage.rings.arith.gaussian_binomial(6,2,w).parent()        \nFraction Field of Univariate Polynomial Ring in w over Integer Ring\n```\n\nMaybe it would be better to have a single function ?\n\nCC:  @sagetrac-fwclarke @AndrewAtLarge\n\nComponent: **combinatorics**\n\nKeywords: **gaussian binomial**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nReviewer: **Francis Clarke, Travis Scrimshaw**\n\nMerged: **sage-5.10.beta2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14496_\n\n",
    "closed_at": "2013-05-08T07:44:31Z",
    "created_at": "2013-04-26T20:11:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "unify the three implementations of gaussian q-binomial coefficients",
    "type": "issue",
    "updated_at": "2013-05-08T07:44:31Z",
    "url": "https://github.com/sagemath/sage/issues/14496",
    "user": "https://github.com/fchapoton"
}
```
In sage 5.8, one can find the gaussian q-binomial coefficients in (at least) **three** places :

- sage.combinat.sf.kfpoly.q_bin
- sage.combinat.q_analogues.q_binomial
- sage.rings.arith.gaussian_binomial

The syntax is not quite the same for q_bin as for the two others.

Some timings:

```
sage: timeit("sage.combinat.sf.kfpoly.q_bin(7,5)")
625 loops, best of 3: 819 µs per loop
sage: timeit("sage.combinat.q_analogues.q_binomial(12,5)")
625 loops, best of 3: 1.12 ms per loop
sage: timeit("sage.rings.arith.gaussian_binomial(12,5)")  
625 loops, best of 3: 294 µs per loop
```
The parents :

```
sage: sage.combinat.sf.kfpoly.q_bin(7,5).parent()
Fraction Field of Univariate Polynomial Ring in t over Integer Ring
sage: sage.combinat.q_analogues.q_binomial(12,5).parent()
Univariate Polynomial Ring in q over Integer Ring
sage: sage.rings.arith.gaussian_binomial(12,5).parent()
Fraction Field of Univariate Polynomial Ring in q over Integer Ring
```
The behaviour with an added integer parameter

```
sage: sage.combinat.sf.kfpoly.q_bin(7,5,2)               
114429029715
sage: sage.combinat.q_analogues.q_binomial(12,5,2)
DOES NOT WORK
sage: sage.rings.arith.gaussian_binomial(12,5,2)    
114429029715
```
The behaviour with a polynomial parameter

```
sage: w=polygen(ZZ,'w')
sage: sage.combinat.sf.kfpoly.q_bin(4,2,w)
w^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1
sage: sage.combinat.q_analogues.q_binomial(6,2,w)   
w^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1
sage: sage.rings.arith.gaussian_binomial(6,2,w) 
w^8 + w^7 + 2*w^6 + 2*w^5 + 3*w^4 + 2*w^3 + 2*w^2 + w + 1
sage: sage.combinat.sf.kfpoly.q_bin(4,2,w).parent()             
Univariate Polynomial Ring in w over Integer Ring
sage: sage.combinat.q_analogues.q_binomial(6,2,w).parent()      
Univariate Polynomial Ring in w over Integer Ring
sage: sage.rings.arith.gaussian_binomial(6,2,w).parent()        
Fraction Field of Univariate Polynomial Ring in w over Integer Ring
```

Maybe it would be better to have a single function ?

CC:  @sagetrac-fwclarke @AndrewAtLarge

Component: **combinatorics**

Keywords: **gaussian binomial**

Author: **Frédéric Chapoton**

Reviewer: **Francis Clarke, Travis Scrimshaw**

Merged: **sage-5.10.beta2**

_Issue created by migration from https://trac.sagemath.org/ticket/14496_





---

archive/issue_events_203146.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-26T20:11:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203146"
}
```



---

archive/issue_events_203147.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-26T20:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203147"
}
```



---

archive/issue_comments_175252.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHere is already a seemingly faster function. There remains to deprecate the two others. The most annoying one is q_bin, with a different syntax and with a global variable inside.",
    "created_at": "2013-04-26T21:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175252",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

Here is already a seemingly faster function. There remains to deprecate the two others. The most annoying one is q_bin, with a different syntax and with a global variable inside.



---

archive/issue_events_203148.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-26T21:28:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203148"
}
```



---

archive/issue_comments_175253.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis looks good.  It's certainly nice to have integer parameters giving integer results.  \n\nBut `n//d` can causes problems if `q` takes a real value, and similarly in some other cases.  Perhaps this should be a \"`try:`\", with the exception giving `n/d` or even `gaussian_binomial(n, k)(q)`.  [It is surely not necessary to introduce `var` when this occurs before.]\n\nI also don't like the way (inherited from the existing code) that `n` plays two very different r\u00f4les; the line\n\n```\n        n = prod([1 - q**i for i in range(n-k+1,n+1)])\n```\nis particularly bad style.  It would make the code more readable to call them \"`numerator`\" and \"`denominator`\" (possibly abbreviated)",
    "created_at": "2013-04-27T15:50:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175253",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:3" align="right">comment:3</div>

This looks good.  It's certainly nice to have integer parameters giving integer results.  

But `n//d` can causes problems if `q` takes a real value, and similarly in some other cases.  Perhaps this should be a "`try:`", with the exception giving `n/d` or even `gaussian_binomial(n, k)(q)`.  [It is surely not necessary to introduce `var` when this occurs before.]

I also don't like the way (inherited from the existing code) that `n` plays two very different rôles; the line

```
        n = prod([1 - q**i for i in range(n-k+1,n+1)])
```
is particularly bad style.  It would make the code more readable to call them "`numerator`" and "`denominator`" (possibly abbreviated)



---

archive/issue_events_203149.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-27T15:50:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203149"
}
```



---

archive/issue_events_203150.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-27T15:50:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203150"
}
```



---

archive/issue_events_203151.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-27T17:13:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203151"
}
```



---

archive/issue_events_203152.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-27T17:13:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203152"
}
```



---

archive/issue_comments_175254.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHere is a new version of the patch. I have modified the names d and n and introduced a try statement. I am not sure what kind of exceptions I need to catch.\n\n\nStill it remains to choose if one keeps the gaussian_binomial or rather the q_binomial function.",
    "created_at": "2013-04-27T17:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175254",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

Here is a new version of the patch. I have modified the names d and n and introduced a try statement. I am not sure what kind of exceptions I need to catch.


Still it remains to choose if one keeps the gaussian_binomial or rather the q_binomial function.



---

archive/issue_comments_175255.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2013-04-27T17:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175255",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_203153.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-27T17:14:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203153"
}
```



---

archive/issue_events_203154.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-27T18:50:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203154"
}
```



---

archive/issue_events_203155.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-27T18:50:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203155"
}
```



---

archive/issue_comments_175256.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n1. There's a doctest failure at line 341 of `sage/combinat/sf/kfpoly.py`.  I don't know what's being computed here, so I don't know what's going wrong.\n\n2.  I thought the standard spacing was as\n\n```\ndef gaussian_binomial(n, k, q=None): \n```\n\n3. I think `TypeError` is enough; I never saw anything else when I was testing your code.\n\n4. Is it intentional not to alter `sage/combinat/q_analogues.py` ?\n\nSo it's nearly ready for a positive review.",
    "created_at": "2013-04-27T18:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175256",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:6" align="right">comment:6</div>

1. There's a doctest failure at line 341 of `sage/combinat/sf/kfpoly.py`.  I don't know what's being computed here, so I don't know what's going wrong.

2.  I thought the standard spacing was as

```
def gaussian_binomial(n, k, q=None): 
```

3. I think `TypeError` is enough; I never saw anything else when I was testing your code.

4. Is it intentional not to alter `sage/combinat/q_analogues.py` ?

So it's nearly ready for a positive review.



---

archive/issue_events_203156.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-27T19:55:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203156"
}
```



---

archive/issue_events_203157.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-27T19:55:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203157"
}
```



---

archive/issue_comments_175257.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere is a new patch. \n\nPoint 1 is indeed a problem. I do not understand either what is computed in the weight function. The procedure q_bin was returning 1 for any negative values of n and any k. This is not a very natural behaviour.\n\nPoint 4 : I have chosen that the name to be kept would be q_binomial.\n\nThere is another problem remaining. The existing algorithm in sage.combinat.q_analogues uses cyclotomic polynomials and become faster than the naive one when the arguments are big (and of similar size ?), but is much slower in some cases (when n is small or k is small ?).\n\n```\nsage: timeit(\"sage.combinat.q_analogues.q_binomial(85,3)\")\n625 loops, best of 3: 246 \u00b5s per loop\nsage: timeit(\"sage.combinat.q_analogues.q_binomial_via_cyclotomic(85,3)\")\n125 loops, best of 3: 2.78 ms per loop\nsage: timeit(\"sage.combinat.q_analogues.q_binomial(85,43)\")               \n25 loops, best of 3: 9.21 ms per loop\nsage: timeit(\"sage.combinat.q_analogues.q_binomial_via_cyclotomic(85,43)\")\n25 loops, best of 3: 8.18 ms per loop\n```\nSo one needs to keep both and find a strategy of choice..",
    "created_at": "2013-04-27T19:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175257",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

Here is a new patch. 

Point 1 is indeed a problem. I do not understand either what is computed in the weight function. The procedure q_bin was returning 1 for any negative values of n and any k. This is not a very natural behaviour.

Point 4 : I have chosen that the name to be kept would be q_binomial.

There is another problem remaining. The existing algorithm in sage.combinat.q_analogues uses cyclotomic polynomials and become faster than the naive one when the arguments are big (and of similar size ?), but is much slower in some cases (when n is small or k is small ?).

```
sage: timeit("sage.combinat.q_analogues.q_binomial(85,3)")
625 loops, best of 3: 246 µs per loop
sage: timeit("sage.combinat.q_analogues.q_binomial_via_cyclotomic(85,3)")
125 loops, best of 3: 2.78 ms per loop
sage: timeit("sage.combinat.q_analogues.q_binomial(85,43)")               
25 loops, best of 3: 9.21 ms per loop
sage: timeit("sage.combinat.q_analogues.q_binomial_via_cyclotomic(85,43)")
25 loops, best of 3: 8.18 ms per loop
```
So one needs to keep both and find a strategy of choice..



---

archive/issue_comments_175258.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI'll take a look at why the weight function in SF fails; but the best way to fix it is in the weight, have a check for negative `n` or `k` and just circumvent the call to `q_binomial()` and return 1.\n\nAs for the speed of the naive vs. cyclotomic polys, I would pick a cutoff value which you think is about the breakeven point(s) for the two, and call which ever function is faster based on that.\n\nAlso, have you tried implementing it by computing the q-binomial, then substituting in a user defined `q` value to the result (in particular, have you compared the speed)? I'm thinking this might be slower than just computing it outright if `q` is in `GF(3)` for example... If you haven't, I can write it up and run the tests.\n\nThanks for noticing this and working on it,\n\nTravis",
    "created_at": "2013-04-27T20:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175258",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

I'll take a look at why the weight function in SF fails; but the best way to fix it is in the weight, have a check for negative `n` or `k` and just circumvent the call to `q_binomial()` and return 1.

As for the speed of the naive vs. cyclotomic polys, I would pick a cutoff value which you think is about the breakeven point(s) for the two, and call which ever function is faster based on that.

Also, have you tried implementing it by computing the q-binomial, then substituting in a user defined `q` value to the result (in particular, have you compared the speed)? I'm thinking this might be slower than just computing it outright if `q` is in `GF(3)` for example... If you haven't, I can write it up and run the tests.

Thanks for noticing this and working on it,

Travis



---

archive/issue_comments_175259.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nGood idea, I have done just that in the new patch, so there is no doctest failure now.\n\nThere remains to choose a strategy..",
    "created_at": "2013-04-27T20:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175259",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

Good idea, I have done just that in the new patch, so there is no doctest failure now.

There remains to choose a strategy..



---

archive/issue_comments_175260.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nSome timings were given in the ticket #13166\n\nAccording to my own timings, it seems that for n <= ~ 78 the naive algorithm is faster than the cyclotomic algorithm for computing the gaussian polynomial.",
    "created_at": "2013-04-27T20:36:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175260",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

Some timings were given in the ticket #13166

According to my own timings, it seems that for n <= ~ 78 the naive algorithm is faster than the cyclotomic algorithm for computing the gaussian polynomial.



---

archive/issue_comments_175261.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@fchapoton](#comment%3A10):\n> According to my own timings, it seems that for n <= ~ 78 the naive algorithm is faster than the cyclotomic algorithm for computing the gaussian polynomial.\n\nI get much the same.  For `gaussian_binomial(2*k, k)` I found the naive method faster for `k < 30`, and the cyclotomic method faster for `k > 30'.\n\nOne point about the naive method:\n\n```\nsage: %timeit gaussian_binomial(50, 4)\n1000 loops, best of 3: 287 \u00b5s per loop\nsage: %timeit gaussian_binomial(50, 46)\n100 loops, best of 3: 3.41 ms per loop\n```\nSince the code contains two loops of length `k`, it's obviously better to evaluate `gaussian_binomial(n, k)` as `gaussian_binomial(n, n-k)` if `k > n/2`.",
    "created_at": "2013-04-28T11:03:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175261",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@fchapoton](#comment%3A10):
> According to my own timings, it seems that for n <= ~ 78 the naive algorithm is faster than the cyclotomic algorithm for computing the gaussian polynomial.

I get much the same.  For `gaussian_binomial(2*k, k)` I found the naive method faster for `k < 30`, and the cyclotomic method faster for `k > 30'.

One point about the naive method:

```
sage: %timeit gaussian_binomial(50, 4)
1000 loops, best of 3: 287 µs per loop
sage: %timeit gaussian_binomial(50, 46)
100 loops, best of 3: 3.41 ms per loop
```
Since the code contains two loops of length `k`, it's obviously better to evaluate `gaussian_binomial(n, k)` as `gaussian_binomial(n, n-k)` if `k > n/2`.



---

archive/issue_comments_175262.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere is a new patch\n\n* using the minimum of k and n-k in the naive algo\n\n* implementing the following strategy :\n\nif n <= 70 or k <= N/4 or q is not a polynomial, use the naive algo\n\notherwise use the cyclotomic algo\n\nI have found this strategy using some timings (I only timed the polynomial case).",
    "created_at": "2013-04-28T19:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175262",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

Here is a new patch

* using the minimum of k and n-k in the naive algo

* implementing the following strategy :

if n <= 70 or k <= N/4 or q is not a polynomial, use the naive algo

otherwise use the cyclotomic algo

I have found this strategy using some timings (I only timed the polynomial case).



---

archive/issue_events_203158.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-28T19:19:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203158"
}
```



---

archive/issue_events_203159.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-28T19:19:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203159"
}
```



---

archive/issue_comments_175263.json:
```json
{
    "body": "Reviewer: **Francis Clarke, Travis Scrimshaw**",
    "created_at": "2013-04-28T19:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175263",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Francis Clarke, Travis Scrimshaw**



---

archive/issue_events_203160.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-28T19:55:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203160"
}
```



---

archive/issue_comments_175264.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nTwo points remain, I think:\n\n1. On speed, I see that you are not using the cyclotomic method when `q` is not a polynomial.  But by using `cyclotomic_value` the faster method can be efficient for \"scalar\" values too.\n\n2. I don't see any reason why `gaussian_binomial` should be *deprecated*.  This terminology is in common use, and a mathematician who knows only this name should not be told that it is \"wrong\".  She should be able to use it without necessarily ever knowing that some people use a different name.  Doesn't deprecation mean that eventually the function will disappear from Sage?  This would only cause confusion.  Surely the two should be *synonyms*, as are, for example, the number-field methods `ring_of_integers` and `maximal_order`.",
    "created_at": "2013-04-29T09:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175264",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:15" align="right">comment:15</div>

Two points remain, I think:

1. On speed, I see that you are not using the cyclotomic method when `q` is not a polynomial.  But by using `cyclotomic_value` the faster method can be efficient for "scalar" values too.

2. I don't see any reason why `gaussian_binomial` should be *deprecated*.  This terminology is in common use, and a mathematician who knows only this name should not be told that it is "wrong".  She should be able to use it without necessarily ever knowing that some people use a different name.  Doesn't deprecation mean that eventually the function will disappear from Sage?  This would only cause confusion.  Surely the two should be *synonyms*, as are, for example, the number-field methods `ring_of_integers` and `maximal_order`.



---

archive/issue_events_203161.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-29T09:54:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203161"
}
```



---

archive/issue_events_203162.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-04-29T09:54:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203162"
}
```



---

archive/issue_comments_175265.json:
```json
{
    "body": "Attachment: **[trac_14496_qbinomial-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496_qbinomial-fc.patch.gz)**",
    "created_at": "2013-04-29T20:08:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175265",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14496_qbinomial-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496_qbinomial-fc.patch.gz)**



---

archive/issue_comments_175266.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHere is a new patch.\n\nFor point 2, I have now defined gaussian_binomial as being an alias to q_binomial. The global namespace only contains gaussian_binomial, as before the patch.\n\nFor point 1, I have made some changes in the choice of algo, mainly about symbolic inputs. But I do not think that it is really worth spending more time on trying harder to enhance the speed for arbitrary inputs. This function is supposed to be used mainly without 3rd argument.",
    "created_at": "2013-04-29T20:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175266",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

Here is a new patch.

For point 2, I have now defined gaussian_binomial as being an alias to q_binomial. The global namespace only contains gaussian_binomial, as before the patch.

For point 1, I have made some changes in the choice of algo, mainly about symbolic inputs. But I do not think that it is really worth spending more time on trying harder to enhance the speed for arbitrary inputs. This function is supposed to be used mainly without 3rd argument.



---

archive/issue_events_203163.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-30T07:17:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203163"
}
```



---

archive/issue_events_203164.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-30T07:17:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203164"
}
```



---

archive/issue_comments_175267.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nHey Frederic and Francis,\n\nI've uploaded a review patch which does two things I wanted, an input for the algorithm and handling objects which may not have division (by computing it using a formal variable and then substituting in `q`). If you're happy with my changes, feel free to set this to a positive review.\n\nBest,\n\nTravis",
    "created_at": "2013-04-30T19:43:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175267",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Hey Frederic and Francis,

I've uploaded a review patch which does two things I wanted, an input for the algorithm and handling objects which may not have division (by computing it using a formal variable and then substituting in `q`). If you're happy with my changes, feel free to set this to a positive review.

Best,

Travis



---

archive/issue_comments_175268.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nhello,\n\nit seems to me that at the end you can write simply\n\n```\nreturn q_binomial(n, k)(q) \n```\nbecause then the polygen import will be done inside the function",
    "created_at": "2013-04-30T19:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175268",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

hello,

it seems to me that at the end you can write simply

```
return q_binomial(n, k)(q) 
```
because then the polygen import will be done inside the function



---

archive/issue_comments_175269.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAttachment: **[trac_14496-qbinomial-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496-qbinomial-review-ts.patch.gz)**\n\nYep, that works. I've uploaded the updated patch.",
    "created_at": "2013-04-30T21:35:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175269",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Attachment: **[trac_14496-qbinomial-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496-qbinomial-review-ts.patch.gz)**

Yep, that works. I've uploaded the updated patch.



---

archive/issue_comments_175270.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI was about to say positive review, when I noticed two things:\n\n1.  `gaussian_polynomial(5, 2, 7r)` fails.  But this caused by a feature of `cyclotomic_value`, so should probably be ignored.\n\n2.  `gaussian_binomial(4, 2, Zmod(6)(2), algorithm='naive')` fails.  This can be very simply rectified by excepting a `ZeroDivisionError` as well as a `TypeError` just before the \"last attempt\".",
    "created_at": "2013-05-01T20:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175270",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:21" align="right">comment:21</div>

I was about to say positive review, when I noticed two things:

1.  `gaussian_polynomial(5, 2, 7r)` fails.  But this caused by a feature of `cyclotomic_value`, so should probably be ignored.

2.  `gaussian_binomial(4, 2, Zmod(6)(2), algorithm='naive')` fails.  This can be very simply rectified by excepting a `ZeroDivisionError` as well as a `TypeError` just before the "last attempt".



---

archive/issue_events_203165.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-05-01T20:59:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203165"
}
```



---

archive/issue_events_203166.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-05-01T20:59:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203166"
}
```



---

archive/issue_events_203167.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-04T09:08:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203167"
}
```



---

archive/issue_events_203168.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-04T09:08:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203168"
}
```



---

archive/issue_comments_175271.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nPoint 2 is done. I vote to ignore point 1 (anyway, who cares about that ?)",
    "created_at": "2013-05-04T09:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175271",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

Point 2 is done. I vote to ignore point 1 (anyway, who cares about that ?)



---

archive/issue_comments_175272.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@fchapoton](#comment%3A22):\n> Point 2 is done. I vote to ignore point 1 (anyway, who cares about that ?)\n\nAgreed.  Positive review.",
    "created_at": "2013-05-04T10:31:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175272",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@fchapoton](#comment%3A22):
> Point 2 is done. I vote to ignore point 1 (anyway, who cares about that ?)

Agreed.  Positive review.



---

archive/issue_events_203169.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-05-04T10:31:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203169"
}
```



---

archive/issue_events_203170.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2013-05-04T10:31:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203170"
}
```



---

archive/issue_comments_175273.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n\n```\ndochtml.log:[combinat ] /mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/combinat/q_analogues.py:docstring of sage.combinat.q_analogues.q_binomial:141: WARNING: Duplicate explicit target name: \"ch2006\".\ndochtml.log:[combinat ] /mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/combinat/q_analogues.py:docstring of sage.combinat.q_analogues.q_binomial:141: WARNING: duplicate citation CH2006, other instance in /mazur/release/merger/sage-5.10.beta2/devel/sage/doc/en/reference/combinat/sage/combinat/q_analogues.rst\n```",
    "created_at": "2013-05-04T17:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175273",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>


```
dochtml.log:[combinat ] /mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/combinat/q_analogues.py:docstring of sage.combinat.q_analogues.q_binomial:141: WARNING: Duplicate explicit target name: "ch2006".
dochtml.log:[combinat ] /mazur/release/merger/sage-5.10.beta2/local/lib/python2.7/site-packages/sage/combinat/q_analogues.py:docstring of sage.combinat.q_analogues.q_binomial:141: WARNING: duplicate citation CH2006, other instance in /mazur/release/merger/sage-5.10.beta2/devel/sage/doc/en/reference/combinat/sage/combinat/q_analogues.rst
```



---

archive/issue_events_203171.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-04T17:02:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203171"
}
```



---

archive/issue_events_203172.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-04T17:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203172"
}
```



---

archive/issue_comments_175274.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nah, well, sorry. \n\nThis is because I defined an alias in an incorrect way, using\n`gaussian_binomial = q_binomial`\n\nBut what is the correct way ?",
    "created_at": "2013-05-04T17:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175274",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

ah, well, sorry. 

This is because I defined an alias in an incorrect way, using
`gaussian_binomial = q_binomial`

But what is the correct way ?



---

archive/issue_comments_175275.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nHum, it seems that I have used the correct way to create an alias. But as the doc is duplicated (instead of saying that one function is an alias for the other), it will necessarily create a conflict any time it contains a reference. I am surprised that this problem has never been met before !\n\nOne can compare the situation to the definition of charpoly and characteristic_polynomial in sage.misc.functional, which does not contain a reference, hence dos not raise this problem.",
    "created_at": "2013-05-04T18:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175275",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:26" align="right">comment:26</div>

Hum, it seems that I have used the correct way to create an alias. But as the doc is duplicated (instead of saying that one function is an alias for the other), it will necessarily create a conflict any time it contains a reference. I am surprised that this problem has never been met before !

One can compare the situation to the definition of charpoly and characteristic_polynomial in sage.misc.functional, which does not contain a reference, hence dos not raise this problem.



---

archive/issue_comments_175276.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThere are two workarounds I can see:\n\n1. Put the reference in a place that isn't duplicated such as at the module level.\n2. Write in `gaussian_binomial()` which calls `q_binomial()` and it's doc just says \"see `q_binomial()`\"\n\nOption 2 is more work and less clean IMO. Option 1 isn't perfect to me either but is the lesser of 2 evils. Up to you; either way would be okay with me.",
    "created_at": "2013-05-04T20:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175276",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

There are two workarounds I can see:

1. Put the reference in a place that isn't duplicated such as at the module level.
2. Write in `gaussian_binomial()` which calls `q_binomial()` and it's doc just says "see `q_binomial()`"

Option 2 is more work and less clean IMO. Option 1 isn't perfect to me either but is the lesser of 2 evils. Up to you; either way would be okay with me.



---

archive/issue_comments_175277.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nok, this should be good now. Back to positive review",
    "created_at": "2013-05-05T16:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175277",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:29" align="right">comment:29</div>

ok, this should be good now. Back to positive review



---

archive/issue_events_203173.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-05T16:57:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203173"
}
```



---

archive/issue_events_203174.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-05-05T16:57:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203174"
}
```



---

archive/issue_comments_175278.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHey Frederic,\n\nTwo minor things on the doc for `gaussian_binomial()`:\n\n- There should be periods '.' at the end of the sentences.\n- The 'this function' is slightly ambiguous to me, I would explicitly put <code>:func:\\`q_binomial()\\`</code> to avoid this.\n\nOtherwise I'm also happy with the patch. Thanks.",
    "created_at": "2013-05-06T15:23:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175278",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:30" align="right">comment:30</div>

Hey Frederic,

Two minor things on the doc for `gaussian_binomial()`:

- There should be periods '.' at the end of the sentences.
- The 'this function' is slightly ambiguous to me, I would explicitly put <code>:func:\`q_binomial()\`</code> to avoid this.

Otherwise I'm also happy with the patch. Thanks.



---

archive/issue_comments_175279.json:
```json
{
    "body": "Attachment: **[trac_14496-qbinomial-rev-rev-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496-qbinomial-rev-rev-fc.patch.gz)**",
    "created_at": "2013-05-06T18:01:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175279",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14496-qbinomial-rev-rev-fc.patch.gz](https://github.com/sagemath/sage/files/ticket14496/trac_14496-qbinomial-rev-rev-fc.patch.gz)**



---

archive/issue_comments_175280.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nDone, and thanks for the review",
    "created_at": "2013-05-06T18:02:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175280",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:31" align="right">comment:31</div>

Done, and thanks for the review



---

archive/issue_events_203175.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-08T07:44:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203175"
}
```



---

archive/issue_events_203176.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-08T07:44:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14496#event-203176"
}
```



---

archive/issue_comments_175281.json:
```json
{
    "body": "Merged: **sage-5.10.beta2**",
    "created_at": "2013-05-08T07:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14496",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14496#issuecomment-175281",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.10.beta2**
