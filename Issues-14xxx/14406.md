# Issue 14406: Various prereq fixes

archive/issues_014202.json:
```json
{
    "body": "* Allow Sage to build on Cygwin without setting `SAGE_PORT`.\n* Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).\n* Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n* Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.\n* Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.\n\n**Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])\n\n**Apply** [attachment:trac_14406+reviewer-v3.patch]\n\n**Assignee:** drkirkby\n\n**CC:**  @jdemeyer @nexttime jpflori\n\n**Reviewer:** Jean-Pierre Flori, Jeroen Demeyer\n\n**Author:** Jeroen Demeyer, Jean-Pierre Flori\n\n**Merged:** sage-5.9.beta4\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14406\n\n",
    "closed_at": "2013-04-04T17:41:11Z",
    "created_at": "2013-04-03T13:03:52Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Various prereq fixes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14406",
    "user": "https://github.com/jdemeyer"
}
```
* Allow Sage to build on Cygwin without setting `SAGE_PORT`.
* Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).
* Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
* Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.
* Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.

**Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])

**Apply** [attachment:trac_14406+reviewer-v3.patch]

**Assignee:** drkirkby

**CC:**  @jdemeyer @nexttime jpflori

**Reviewer:** Jean-Pierre Flori, Jeroen Demeyer

**Author:** Jeroen Demeyer, Jean-Pierre Flori

**Merged:** sage-5.9.beta4

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/14406





---

archive/issue_comments_228090.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n Allow Sage to build on Cygwin without setting `SAGE_PORT`.\n+\n+While we're at it:\n+* remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n``````\n",
    "created_at": "2013-04-03T13:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228090",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 Allow Sage to build on Cygwin without setting `SAGE_PORT`.
+
+While we're at it:
+* remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
``````




---

archive/issue_comments_228091.json:
```json
{
    "body": "**Changing assignee** from tbd to drkirkby.",
    "created_at": "2013-04-03T13:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228091",
    "user": "https://github.com/jdemeyer"
}
```

**Changing assignee** from tbd to drkirkby.



---

archive/issue_comments_228092.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2013-04-03T13:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228092",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_events_047181.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "rename": {
        "from": "Update prereq for Cygwin",
        "to": "Various prereq fixes"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14406#event-47181"
}
```



---

archive/issue_comments_228093.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n-Allow Sage to build on Cygwin without setting `SAGE_PORT`.\n-\n-While we're at it:\n-* remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n+* Allow Sage to build on Cygwin without setting `SAGE_PORT`.\n+* Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).\n+* Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n+* Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.\n+* Check for `tar` before actually untarring the prereq tarball (originally #14407).\n``````\n",
    "created_at": "2013-04-03T13:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228093",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
-Allow Sage to build on Cygwin without setting `SAGE_PORT`.
-
-While we're at it:
-* remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
+* Allow Sage to build on Cygwin without setting `SAGE_PORT`.
+* Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).
+* Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
+* Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.
+* Check for `tar` before actually untarring the prereq tarball (originally #14407).
``````




---

archive/issue_comments_228094.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n * Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).\n * Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n * Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.\n-* Check for `tar` before actually untarring the prereq tarball (originally #14407).\n+* Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.\n``````\n",
    "created_at": "2013-04-03T13:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228094",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 * Don't check for `sqrtl()` which is apparently not needed (Cygwin doesn't have it, yet Sage builds).
 * Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
 * Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.
-* Check for `tar` before actually untarring the prereq tarball (originally #14407).
+* Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.
``````




---

archive/issue_comments_228095.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,7 @@\n * Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.\n * Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.\n * Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.\n+\n+**Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])\n+\n+**Apply** [attachment:14406_cygwin_prereq.patch]\n``````\n",
    "created_at": "2013-04-03T13:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228095",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,7 @@
 * Remove all checks for the deprecated variable `SAGE_FORTRAN_LIB`.
 * Remove `AC_ARG_VAR(SAGE_FORTRAN)` which is a deprecated variable.
 * Check for `tar` before actually untarring the prereq tarball (originally #14407), only do these checks if `SAGE_PORT` is unset.
+
+**Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])
+
+**Apply** [attachment:14406_cygwin_prereq.patch]
``````




---

archive/issue_comments_228096.json:
```json
{
    "body": "<a id='comment:5'></a>\nAttachment [prereq-1.2.diff](tarball://root/attachments/some-uuid/ticket14406/prereq-1.2.diff) by @jdemeyer created at 2013-04-03 13:58:47",
    "created_at": "2013-04-03T13:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Attachment [prereq-1.2.diff](tarball://root/attachments/some-uuid/ticket14406/prereq-1.2.diff) by @jdemeyer created at 2013-04-03 13:58:47



---

archive/issue_comments_228097.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-04-03T13:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228097",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_228098.json:
```json
{
    "body": "<a id='comment:6'></a>\nIn the prereq install script, the Solaris part could be a little bit polished.\nThe first sentence includes a disturbing also:\n\n```\nYou MUST also use the GNU version of tar...\n```\nwhereas nothing precedes it.\n\nI don't really like the fact that both tar and make are tested together in the constructions\n\n```\nif [ -f \"/usr/sfw/bin/gtar\" ]  && [ -f \"/usr/sfw/bin/gmake\" ] ; then\n```\nThe only advantage of doing this is to easily suggest to do \n\n```\n   echo \"$ mkdir \\$HOME/bins-for-sage\" \n   echo \"$ cp /usr/sfw/bin/gmake \\$HOME/bins-for-sage/make\" \n   echo \"$ cp /usr/sfw/bin/gtar \\$HOME/bins-for-sage/tar\" \n   echo \"$ export PATH=\\$HOME/bins-for-sage:\\$PATH\" \n```\nI think we'd better split the two tests, i.e. only check for tar in the tar part and for make in the make part.\nAt worst, a naive user will have to run make twice before it passes the prereq checks and will have twice $HAME\\bins-for-sage in its PATH.\n\nThere are also ugly double spaces before \"&&\" on the (new) lines 132 and 165 :)",
    "created_at": "2013-04-03T14:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228098",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:6'></a>
In the prereq install script, the Solaris part could be a little bit polished.
The first sentence includes a disturbing also:

```
You MUST also use the GNU version of tar...
```
whereas nothing precedes it.

I don't really like the fact that both tar and make are tested together in the constructions

```
if [ -f "/usr/sfw/bin/gtar" ]  && [ -f "/usr/sfw/bin/gmake" ] ; then
```
The only advantage of doing this is to easily suggest to do 

```
   echo "$ mkdir \$HOME/bins-for-sage" 
   echo "$ cp /usr/sfw/bin/gmake \$HOME/bins-for-sage/make" 
   echo "$ cp /usr/sfw/bin/gtar \$HOME/bins-for-sage/tar" 
   echo "$ export PATH=\$HOME/bins-for-sage:\$PATH" 
```
I think we'd better split the two tests, i.e. only check for tar in the tar part and for make in the make part.
At worst, a naive user will have to run make twice before it passes the prereq checks and will have twice $HAME\bins-for-sage in its PATH.

There are also ugly double spaces before "&&" on the (new) lines 132 and 165 :)



---

archive/issue_comments_228099.json:
```json
{
    "body": "<a id='comment:7'></a>\nWe could also include the Solaris parts together with the HP-UX and other strange Unix oses as elif clauses a little down below.\n\nThat may look nicer and prevent running \"tar --version\" twice.\n\nIf so, the commented out comments will need just a little rewriting and relocation.",
    "created_at": "2013-04-03T14:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228099",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>
We could also include the Solaris parts together with the HP-UX and other strange Unix oses as elif clauses a little down below.

That may look nicer and prevent running "tar --version" twice.

If so, the commented out comments will need just a little rewriting and relocation.



---

archive/issue_comments_228100.json:
```json
{
    "body": "<a id='comment:8'></a>\nOK, making changes...",
    "created_at": "2013-04-03T14:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228100",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
OK, making changes...



---

archive/issue_comments_228101.json:
```json
{
    "body": "<a id='comment:9'></a>\nDidn't we want to replace the check for `sqrtl()` by a check for `?gammal()`?  (OTOH I don't recall why exactly... ;-) )\n\nActually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes, i.e., unless we're on Cygwin(?) or on FreeBSD, or skip the test because `SAGE_PORT` is set.",
    "created_at": "2013-04-03T14:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228101",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
Didn't we want to replace the check for `sqrtl()` by a check for `?gammal()`?  (OTOH I don't recall why exactly... ;-) )

Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes, i.e., unless we're on Cygwin(?) or on FreeBSD, or skip the test because `SAGE_PORT` is set.



---

archive/issue_comments_228102.json:
```json
{
    "body": "<a id='comment:10'></a>\nAlso recall we still don't have `logl` (#14078) and so things are still weird, though we worked around it there.  But I don't have a problem with the Cygwin stuff here; Sage builds as is on Cygwin.  I think David originally added that check just to make sure one didn't need stuff like Cephes, but apparently we don't actually *use* `sqrtl()` and friends.",
    "created_at": "2013-04-03T14:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228102",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
Also recall we still don't have `logl` (#14078) and so things are still weird, though we worked around it there.  But I don't have a problem with the Cygwin stuff here; Sage builds as is on Cygwin.  I think David originally added that check just to make sure one didn't need stuff like Cephes, but apparently we don't actually *use* `sqrtl()` and friends.



---

archive/issue_comments_228103.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [leif](#comment%3A9):\n> Didn't we want to replace the check for `sqrtl()` by a check for `?gammal()`?  (OTOH I don't recall why exactly... ;-) )\n> \n> Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes, i.e., unless we're on Cygwin(?) or on FreeBSD, or skip the test because `SAGE_PORT` is set.\n\nWe don't build Cephes on Cygwin.\nOn Cygwin, the only *l functions actually needed anywhere in Sage and which caused troubles (and that Cygwin libm does not provide, not sure what it actually provides, but I seem to remember it provides no \"long double\" functions at all) was \"logl\" because of R, but we patched R so that its not needed anymore, and the next R upstream version provides a configure option to disable the use of \"long double\" functions anyway.",
    "created_at": "2013-04-03T14:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228103",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:11'></a>
Replying to [leif](#comment%3A9):
> Didn't we want to replace the check for `sqrtl()` by a check for `?gammal()`?  (OTOH I don't recall why exactly... ;-) )
> 
> Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes, i.e., unless we're on Cygwin(?) or on FreeBSD, or skip the test because `SAGE_PORT` is set.

We don't build Cephes on Cygwin.
On Cygwin, the only *l functions actually needed anywhere in Sage and which caused troubles (and that Cygwin libm does not provide, not sure what it actually provides, but I seem to remember it provides no "long double" functions at all) was "logl" because of R, but we patched R so that its not needed anymore, and the next R upstream version provides a configure option to disable the use of "long double" functions anyway.



---

archive/issue_comments_228104.json:
```json
{
    "body": "<a id='comment:12'></a>\nHere is what was recently included in Cygwin:\n\n```\nSupport for the C99 complex functions, except for the \"long double\" implementations. New APIs: cacos, cacosf, cacosh, cacoshf, carg, cargf, casin, casinf, casinh, casinhf, catan, catanf, catanh, catanhf, ccos, ccosf, ccosh, ccoshf, cexp, cexpf, cimag, cimagf, clog, clogf, conj, conjf, cpow, cpowf, cproj, cprojf, creal, crealf, csin, csinf, csinh, csinhf, csqrt, csqrtf, ctan, ctanf, ctanh, ctanhf. \n```\nSee http://cygwin.com/cygwin-ug-net/ov-new1.7.html.",
    "created_at": "2013-04-03T14:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228104",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>
Here is what was recently included in Cygwin:

```
Support for the C99 complex functions, except for the "long double" implementations. New APIs: cacos, cacosf, cacosh, cacoshf, carg, cargf, casin, casinf, casinh, casinhf, catan, catanf, catanh, catanhf, ccos, ccosf, ccosh, ccoshf, cexp, cexpf, cimag, cimagf, clog, clogf, conj, conjf, cpow, cpowf, cproj, cprojf, creal, crealf, csin, csinf, csinh, csinhf, csqrt, csqrtf, ctan, ctanf, ctanh, ctanhf. 
```
See http://cygwin.com/cygwin-ug-net/ov-new1.7.html.



---

archive/issue_comments_228105.json:
```json
{
    "body": "<a id='comment:13'></a>\nAnd I don't know what the FreeBSD libm lacks that make Sage's compilation fail (except for the logl function for R of course).",
    "created_at": "2013-04-03T14:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228105",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>
And I don't know what the FreeBSD libm lacks that make Sage's compilation fail (except for the logl function for R of course).



---

archive/issue_comments_228106.json:
```json
{
    "body": "<a id='comment:14'></a>\nAnd of course we could revert the patch for R from #14078 and let Cephes install again on Cygwin.\nIt is just that at the time we were working on #14078, patching R, which is about to get the \"without long double\" support in a future release seemed easier.\nI cannot not promise that installing Cephes and then trying to install R without the patch will just work out of the box.",
    "created_at": "2013-04-03T14:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228106",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:14'></a>
And of course we could revert the patch for R from #14078 and let Cephes install again on Cygwin.
It is just that at the time we were working on #14078, patching R, which is about to get the "without long double" support in a future release seemed easier.
I cannot not promise that installing Cephes and then trying to install R without the patch will just work out of the box.



---

archive/issue_comments_228107.json:
```json
{
    "body": "<a id='comment:15'></a>\nAttachment [14406_cygwin_prereq.patch](tarball://root/attachments/some-uuid/ticket14406/14406_cygwin_prereq.patch) by @jdemeyer created at 2013-04-03 14:58:17\n\nReplying to [leif](#comment%3A9):\n> Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes\n\nIt seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.",
    "created_at": "2013-04-03T14:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228107",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Attachment [14406_cygwin_prereq.patch](tarball://root/attachments/some-uuid/ticket14406/14406_cygwin_prereq.patch) by @jdemeyer created at 2013-04-03 14:58:17

Replying to [leif](#comment%3A9):
> Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes

It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.



---

archive/issue_comments_228108.json:
```json
{
    "body": "<a id='comment:16'></a>\nOK, simplified the `tar`/`make` checks.",
    "created_at": "2013-04-03T15:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228108",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
OK, simplified the `tar`/`make` checks.



---

archive/issue_comments_228109.json:
```json
{
    "body": "<a id='comment:17'></a>\nOk, I've slightly recomplexified it :)",
    "created_at": "2013-04-03T15:22:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228109",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:17'></a>
Ok, I've slightly recomplexified it :)



---

archive/issue_comments_228110.json:
```json
{
    "body": "<a id='comment:18'></a>\nOops, something is wrong, coming back with a proper patch.",
    "created_at": "2013-04-03T15:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228110",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:18'></a>
Oops, something is wrong, coming back with a proper patch.



---

archive/issue_comments_228111.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jdemeyer](#comment%3A15):\n> Replying to [leif](#comment%3A9):\n> > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes\n\n> It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.\n\nIIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.\n\n\n\n\nTo repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?\n\nI.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].",
    "created_at": "2013-04-03T15:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228111",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>
Replying to [jdemeyer](#comment%3A15):
> Replying to [leif](#comment%3A9):
> > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes

> It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.

IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.




To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?

I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].



---

archive/issue_comments_228112.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [leif](#comment%3A19):\n> Replying to [jdemeyer](#comment%3A15):\n> > Replying to [leif](#comment%3A9):\n> > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes\n\n> > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.\n> \n> IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.\n\nI'll have a look.\n> \n> \n\n\n> \n> To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?\n\n>\nMaybe for complex functions \"c*\" (which are now in Cygwin libm but used not to be)? \n> I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].",
    "created_at": "2013-04-03T15:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228112",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:20'></a>
Replying to [leif](#comment%3A19):
> Replying to [jdemeyer](#comment%3A15):
> > Replying to [leif](#comment%3A9):
> > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes

> > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.
> 
> IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.

I'll have a look.
> 
> 


> 
> To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?

>
Maybe for complex functions "c*" (which are now in Cygwin libm but used not to be)? 
> I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].



---

archive/issue_comments_228113.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [jpflori](#comment%3A20):\n> Replying to [leif](#comment%3A19):\n> > Replying to [jdemeyer](#comment%3A15):\n> > > Replying to [leif](#comment%3A9):\n> > > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes\n\n> > > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.\n> > \n> > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.\n\n> I'll have a look.\nIndeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n> > \n> > \n\n\n> > \n> > To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?\n\n> >\n> Maybe for complex functions \"c*\" (which are now in Cygwin libm but used not to be)? \n> > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].",
    "created_at": "2013-04-03T15:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228113",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:21'></a>
Replying to [jpflori](#comment%3A20):
> Replying to [leif](#comment%3A19):
> > Replying to [jdemeyer](#comment%3A15):
> > > Replying to [leif](#comment%3A9):
> > > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes

> > > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.
> > 
> > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.

> I'll have a look.
Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.
> > 
> > 


> > 
> > To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?

> >
> Maybe for complex functions "c*" (which are now in Cygwin libm but used not to be)? 
> > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].



---

archive/issue_comments_228114.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jpflori](#comment%3A21):\n> Replying to [jpflori](#comment%3A20):\n> > Replying to [leif](#comment%3A19):\n> > > Replying to [jdemeyer](#comment%3A15):\n> > > > Replying to [leif](#comment%3A9):\n> > > > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes\n\n> > > > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.\n> > > \n> > > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.\n\n> > I'll have a look.\n> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n\nAnd as we only cheat on Cygwin, this implies Cephes is definitively needed on FreeBSD for this file already.\n> > > \n> > > \n\n\n> > > \n> > > To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?\n\n> > >\n> > Maybe for complex functions \"c*\" (which are now in Cygwin libm but used not to be)? \n> > > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].",
    "created_at": "2013-04-03T15:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228114",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:22'></a>
Replying to [jpflori](#comment%3A21):
> Replying to [jpflori](#comment%3A20):
> > Replying to [leif](#comment%3A19):
> > > Replying to [jdemeyer](#comment%3A15):
> > > > Replying to [leif](#comment%3A9):
> > > > > Actually, we need both `sqrtl()` and `[lt]gammal()` unless we build Cephes

> > > > It seems not, Cygwin doesn't have `sqrtl()`, nor does it build Cephes. Despite this, Sage builds.
> > > 
> > > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.

> > I'll have a look.
> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.

And as we only cheat on Cygwin, this implies Cephes is definitively needed on FreeBSD for this file already.
> > > 
> > > 


> > > 
> > > To repeat Karl-Dieter's question:  What is Cephes then needed for at all [on e.g. FreeBSD]?

> > >
> > Maybe for complex functions "c*" (which are now in Cygwin libm but used not to be)? 
> > > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].



---

archive/issue_comments_228115.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [jpflori](#comment%3A22):\n> Replying to [jpflori](#comment%3A21):\n> > Replying to [jpflori](#comment%3A20):\n> > > Replying to [leif](#comment%3A19):\n> > > > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.\n\n> > Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n> And as we only cheat on Cygwin, this implies Cephes is definitively needed on FreeBSD for this file already.\n\n\nSo what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)\n\n\n\n\n> > > > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].",
    "created_at": "2013-04-03T15:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228115",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
Replying to [jpflori](#comment%3A22):
> Replying to [jpflori](#comment%3A21):
> > Replying to [jpflori](#comment%3A20):
> > > Replying to [leif](#comment%3A19):
> > > > IIRC, because we (still) have some special-casing on Cygwin w.r.t. at least (just?) the (`long double`) gamma functions.

> > Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.
> And as we only cheat on Cygwin, this implies Cephes is definitively needed on FreeBSD for this file already.


So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)




> > > > I.e., we should probably check for those functions Cephes provides (and Sage needs) [unless we're on FreeBSD where Cephes gets built anyway, or `SAGE_PORT` is set].



---

archive/issue_comments_228116.json:
```json
{
    "body": "<a id='comment:24'></a>\nIn fact I slightly prefer the way things get printed with the second version of the reviewer patch.\nIt's slightly easier to understand if both tar and make are missing.\nFeel free to change it back if you want.",
    "created_at": "2013-04-03T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228116",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:24'></a>
In fact I slightly prefer the way things get printed with the second version of the reviewer patch.
It's slightly easier to understand if both tar and make are missing.
Feel free to change it back if you want.



---

archive/issue_comments_228117.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n **Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])\n \n-**Apply** [attachment:14406_cygwin_prereq.patch]\n+**Apply** [attachment:trac_14406+reviewer-v2.patch]\n``````\n",
    "created_at": "2013-04-03T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228117",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
 **Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])
 
-**Apply** [attachment:14406_cygwin_prereq.patch]
+**Apply** [attachment:trac_14406+reviewer-v2.patch]
``````




---

archive/issue_comments_228118.json:
```json
{
    "body": "<a id='comment:25'></a>\nP.S.:  I don't have a strong opinion on the libm tests; building Sage requires a C99 environment (compiler + library) anyway.  We may add a comment on this to the *Sage Porting Guide<sup>TM</sup>*.",
    "created_at": "2013-04-03T15:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228118",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:25'></a>
P.S.:  I don't have a strong opinion on the libm tests; building Sage requires a C99 environment (compiler + library) anyway.  We may add a comment on this to the *Sage Porting Guide<sup>TM</sup>*.



---

archive/issue_comments_228119.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [leif](#comment%3A23):\n> So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)\n\nDon't really know.\nCheck for sqrtl, logl, tgammal and lgammal everywhere except where:\n* we cheat, which is currently Cygwin,\n* we install Cephes, which is currently FreeBSD.\nAnd if that fails, rant that supported platform should provide \"long double\" functions (except for the the two categories filtered out above) and suggest:\n* setting SAGE_PORT to something non-empty,\n* and:\n  * either try installing the Cephes spkg,\n  * or cheating as on Cygwin.\nBoth of these will be non-trivial anyway.\n>",
    "created_at": "2013-04-03T15:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228119",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:26'></a>
Replying to [leif](#comment%3A23):
> So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)

Don't really know.
Check for sqrtl, logl, tgammal and lgammal everywhere except where:
* we cheat, which is currently Cygwin,
* we install Cephes, which is currently FreeBSD.
And if that fails, rant that supported platform should provide "long double" functions (except for the the two categories filtered out above) and suggest:
* setting SAGE_PORT to something non-empty,
* and:
  * either try installing the Cephes spkg,
  * or cheating as on Cygwin.
Both of these will be non-trivial anyway.
>



---

archive/issue_comments_228120.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jpflori](#comment%3A26):\n> Replying to [leif](#comment%3A23):\n> > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)\n\n> Don't really know.\n> Check for sqrtl, logl, tgammal and lgammal everywhere except where:\n> * we cheat, which is currently Cygwin,\n> * we install Cephes, which is currently FreeBSD.\n> And if that fails, rant that supported platform should provide \"long double\" functions (except for the the two categories filtered out above) and suggest:\n> * setting SAGE_PORT to something non-empty,\n> * and:\n>   * either try installing the Cephes spkg,\n>   * or cheating as on Cygwin.\n\n\n+ * switch to another OS\n\n+ Provide a link to the C99 standard.\n\n\n\n\n> Both of these will be non-trivial anyway.\n\n\nReally?",
    "created_at": "2013-04-03T16:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228120",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>
Replying to [jpflori](#comment%3A26):
> Replying to [leif](#comment%3A23):
> > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)

> Don't really know.
> Check for sqrtl, logl, tgammal and lgammal everywhere except where:
> * we cheat, which is currently Cygwin,
> * we install Cephes, which is currently FreeBSD.
> And if that fails, rant that supported platform should provide "long double" functions (except for the the two categories filtered out above) and suggest:
> * setting SAGE_PORT to something non-empty,
> * and:
>   * either try installing the Cephes spkg,
>   * or cheating as on Cygwin.


+ * switch to another OS

+ Provide a link to the C99 standard.




> Both of these will be non-trivial anyway.


Really?



---

archive/issue_comments_228121.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [leif](#comment%3A27):\n> Replying to [jpflori](#comment%3A26):\n> > Replying to [leif](#comment%3A23):\n> > > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)\n\n> > Don't really know.\n> > Check for sqrtl, logl, tgammal and lgammal everywhere except where:\n> > * we cheat, which is currently Cygwin,\n> > * we install Cephes, which is currently FreeBSD.\n> > And if that fails, rant that supported platform should provide \"long double\" functions (except for the the two categories filtered out above) and suggest:\n> > * setting SAGE_PORT to something non-empty,\n> > * and:\n> >   * either try installing the Cephes spkg,\n> >   * or cheating as on Cygwin.\n \n> \n> + * switch to another OS\n> \n> + Provide a link to the C99 standard.\n> \n> \n\n\n> \n> > Both of these will be non-trivial anyway.\n\n> \n> Really?\n\nDepends on who tries it...\n* Cheating as on Cygwin is easy if you know where to look, although you should know a little bit of Sage to modify the R spkg, but I somehow agree it is not a long term solution, we don't want to patch every part of Sage which at some point will use \"long double\" functions... but then we can hope that Cygwin also include these functions in their libm, as they did for the \"complex\" functions, if every piece of software in the world need them.\n* Don't really know if installing Cephes just works out of the box, i.e. \"oh I have a non-C99 compliant libm, let's just install cephes and every piece of Sage looking for C99 libm functions will find them now\", that's surely the case but I've never tried.",
    "created_at": "2013-04-03T16:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228121",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:28'></a>
Replying to [leif](#comment%3A27):
> Replying to [jpflori](#comment%3A26):
> > Replying to [leif](#comment%3A23):
> > > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)

> > Don't really know.
> > Check for sqrtl, logl, tgammal and lgammal everywhere except where:
> > * we cheat, which is currently Cygwin,
> > * we install Cephes, which is currently FreeBSD.
> > And if that fails, rant that supported platform should provide "long double" functions (except for the the two categories filtered out above) and suggest:
> > * setting SAGE_PORT to something non-empty,
> > * and:
> >   * either try installing the Cephes spkg,
> >   * or cheating as on Cygwin.
 
> 
> + * switch to another OS
> 
> + Provide a link to the C99 standard.
> 
> 


> 
> > Both of these will be non-trivial anyway.

> 
> Really?

Depends on who tries it...
* Cheating as on Cygwin is easy if you know where to look, although you should know a little bit of Sage to modify the R spkg, but I somehow agree it is not a long term solution, we don't want to patch every part of Sage which at some point will use "long double" functions... but then we can hope that Cygwin also include these functions in their libm, as they did for the "complex" functions, if every piece of software in the world need them.
* Don't really know if installing Cephes just works out of the box, i.e. "oh I have a non-C99 compliant libm, let's just install cephes and every piece of Sage looking for C99 libm functions will find them now", that's surely the case but I've never tried.



---

archive/issue_comments_228122.json:
```json
{
    "body": "<a id='comment:29'></a>\nFor Jeroen:\n\nI guess we should check that the lapack (in fact its dependency liblapack0) and liblapack-devel packages are installed on Cygwin.\nIn fact it should be enough to check the existence of the import libraries for libblas (and liblapack once we get #10508 in) as I do in the spkg-install file of ATLAS from #10508:\n\n```\n    libraries = ['/usr/lib/libblas.dll.a', '/usr/lib/liblapack.dll.a']\n    for lib in libraries:\n        if not os.path.exists(lib):\n            print '*'*75\n            print 'Could not locate required file: \"' + lib + '\".'\n            print 'On Cygwin you must install the following standard LAPACK Cygwin packages'\n            print 'via the Cygwin setup.exe program in the \"Math\" category:'\n            print '* lapack,'\n            print '* liblapack-devel.'\n            print 'Alternatively you can try building your own ATLAS by setting'\n            print 'SAGE_ATLAS_ARCH to something sensible although that is not'\n            print 'officially supported.'\n            print '*'*75\n            sys.exit(1)\n```\nModifying the spkg from #10508 so that it correctly builds will be slighlty non-trivial, or rather the way we include that in Volker's autotools stuff needs some thoughts.",
    "created_at": "2013-04-03T16:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228122",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:29'></a>
For Jeroen:

I guess we should check that the lapack (in fact its dependency liblapack0) and liblapack-devel packages are installed on Cygwin.
In fact it should be enough to check the existence of the import libraries for libblas (and liblapack once we get #10508 in) as I do in the spkg-install file of ATLAS from #10508:

```
    libraries = ['/usr/lib/libblas.dll.a', '/usr/lib/liblapack.dll.a']
    for lib in libraries:
        if not os.path.exists(lib):
            print '*'*75
            print 'Could not locate required file: "' + lib + '".'
            print 'On Cygwin you must install the following standard LAPACK Cygwin packages'
            print 'via the Cygwin setup.exe program in the "Math" category:'
            print '* lapack,'
            print '* liblapack-devel.'
            print 'Alternatively you can try building your own ATLAS by setting'
            print 'SAGE_ATLAS_ARCH to something sensible although that is not'
            print 'officially supported.'
            print '*'*75
            sys.exit(1)
```
Modifying the spkg from #10508 so that it correctly builds will be slighlty non-trivial, or rather the way we include that in Volker's autotools stuff needs some thoughts.



---

archive/issue_comments_228123.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [jpflori](#comment%3A28):\n> Replying to [leif](#comment%3A27):\n> > Replying to [jpflori](#comment%3A26):\n> > > Replying to [leif](#comment%3A23):\n> > > > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)\n\n> > > Don't really know.\n> > > Check for sqrtl, logl, tgammal and lgammal everywhere except where:\n> > > * we cheat, which is currently Cygwin,\n> > > * we install Cephes, which is currently FreeBSD.\n> > > And if that fails, rant that supported platform should provide \"long double\" functions (except for the the two categories filtered out above) and suggest:\n> > > * setting SAGE_PORT to something non-empty,\n> > > * and:\n> > >   * either try installing the Cephes spkg,\n> > >   * or cheating as on Cygwin.\n \n> > \n> > + * switch to another OS\n> > \n> > + Provide a link to the C99 standard.\n> > \n> > \n\n\n> > \n> > > Both of these will be non-trivial anyway.\n\n> > \n> > Really?\n\n> Depends on who tries it...\n> * Cheating as on Cygwin is easy if you know where to look, although you should know a little bit of Sage to modify the R spkg, but I somehow agree it is not a long term solution, we don't want to patch every part of Sage which at some point will use \"long double\" functions... but then we can hope that Cygwin also include these functions in their libm, as they did for the \"complex\" functions, if every piece of software in the world need them.\n> * Don't really know if installing Cephes just works out of the box, i.e. \"oh I have a non-C99 compliant libm, let's just install cephes and every piece of Sage looking for C99 libm functions will find them now\", that's surely the case but I've never tried.\n \nI think that for the long term, especially if a lot of standard stuff we need use \"long double\" functions by default and provide no way of easily disabling their use (as R will do), the best solution would be to:\n* check for sqrtl (or any random \"long double\" function);\n* if that's not available, then set some SAGE_INSTALL_CEPHES variable which triggers the installation of Sage;\n* remove all the Cygwin \"long double\" hacks.\n\nBut please, let's do that later...\nFor the moment, just:\n* check for sqrtl except on FreeBSD and Cygwin,\n* rant if not available, provide links to C99 standard, suggest the user to use a mainstream OS, invite him to have coffee or whatever (and maybe mention the fact that if he dares to set SAGE_PORT, then he could also try to manually install the cephes spkg when something fails because of the lack of \"long double\" functions).",
    "created_at": "2013-04-03T16:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228123",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:30'></a>
Replying to [jpflori](#comment%3A28):
> Replying to [leif](#comment%3A27):
> > Replying to [jpflori](#comment%3A26):
> > > Replying to [leif](#comment%3A23):
> > > > So what's your conclusion?  (Regardless of perhaps cheating on FreeBSD as well.)

> > > Don't really know.
> > > Check for sqrtl, logl, tgammal and lgammal everywhere except where:
> > > * we cheat, which is currently Cygwin,
> > > * we install Cephes, which is currently FreeBSD.
> > > And if that fails, rant that supported platform should provide "long double" functions (except for the the two categories filtered out above) and suggest:
> > > * setting SAGE_PORT to something non-empty,
> > > * and:
> > >   * either try installing the Cephes spkg,
> > >   * or cheating as on Cygwin.
 
> > 
> > + * switch to another OS
> > 
> > + Provide a link to the C99 standard.
> > 
> > 


> > 
> > > Both of these will be non-trivial anyway.

> > 
> > Really?

> Depends on who tries it...
> * Cheating as on Cygwin is easy if you know where to look, although you should know a little bit of Sage to modify the R spkg, but I somehow agree it is not a long term solution, we don't want to patch every part of Sage which at some point will use "long double" functions... but then we can hope that Cygwin also include these functions in their libm, as they did for the "complex" functions, if every piece of software in the world need them.
> * Don't really know if installing Cephes just works out of the box, i.e. "oh I have a non-C99 compliant libm, let's just install cephes and every piece of Sage looking for C99 libm functions will find them now", that's surely the case but I've never tried.
 
I think that for the long term, especially if a lot of standard stuff we need use "long double" functions by default and provide no way of easily disabling their use (as R will do), the best solution would be to:
* check for sqrtl (or any random "long double" function);
* if that's not available, then set some SAGE_INSTALL_CEPHES variable which triggers the installation of Sage;
* remove all the Cygwin "long double" hacks.

But please, let's do that later...
For the moment, just:
* check for sqrtl except on FreeBSD and Cygwin,
* rant if not available, provide links to C99 standard, suggest the user to use a mainstream OS, invite him to have coffee or whatever (and maybe mention the fact that if he dares to set SAGE_PORT, then he could also try to manually install the cephes spkg when something fails because of the lack of "long double" functions).



---

archive/issue_comments_228124.json:
```json
{
    "body": "<a id='comment:31'></a>\n> To repeat Karl-Dieter's question: What is Cephes then needed for at all [on e.g. FreeBSD]?\n\nI don't recall asking about FreeBSD, simply stating that we do need it there.  You can ask Stephen M-S about that on one of those ticket.\n> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n\nHowever, I do invite someone to open a ticket to re-enable Cephes on Cygwin so that we can drop that entire file!  If that is indeed the \"right\" solution.\n\n---\n\n> But please, let's do that later...\n\nYes, please.\n> I guess we should check that the lapack (in fact its dependency liblapack0) and liblapack-devel packages are installed on Cygwin.\n\nOh, right.  Good point, since #10508 is not yet in.  But I was discouraged earlier from adding this to prereq, that's why I figured #10508 was better.  I would definitely be in support of this being done on this ticket, and I've put something about that at #6743.\n> For the moment, just:\n> * check for sqrtl except on FreeBSD and Cygwin,\n> * rant if not available, provide links to C99 standard, suggest the user to use a mainstream OS, invite him to have coffee or whatever (and maybe mention the fact that if he dares to set SAGE_PORT, then he could also try to manually install the cephes spkg when something fails because of the lack of \"long double\" functions).\n \nI think that some variation on this is very reasonable.",
    "created_at": "2013-04-03T16:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228124",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>
> To repeat Karl-Dieter's question: What is Cephes then needed for at all [on e.g. FreeBSD]?

I don't recall asking about FreeBSD, simply stating that we do need it there.  You can ask Stephen M-S about that on one of those ticket.
> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.

However, I do invite someone to open a ticket to re-enable Cephes on Cygwin so that we can drop that entire file!  If that is indeed the "right" solution.

---

> But please, let's do that later...

Yes, please.
> I guess we should check that the lapack (in fact its dependency liblapack0) and liblapack-devel packages are installed on Cygwin.

Oh, right.  Good point, since #10508 is not yet in.  But I was discouraged earlier from adding this to prereq, that's why I figured #10508 was better.  I would definitely be in support of this being done on this ticket, and I've put something about that at #6743.
> For the moment, just:
> * check for sqrtl except on FreeBSD and Cygwin,
> * rant if not available, provide links to C99 standard, suggest the user to use a mainstream OS, invite him to have coffee or whatever (and maybe mention the fact that if he dares to set SAGE_PORT, then he could also try to manually install the cephes spkg when something fails because of the lack of "long double" functions).
 
I think that some variation on this is very reasonable.



---

archive/issue_comments_228125.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [jpflori](#comment%3A29):\n> we should check that the lapack [...] packages are installed on Cygwin\n\nWhy is it needed? I really don't like adding an extra check without understanding (and documenting) why.",
    "created_at": "2013-04-03T17:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228125",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
Replying to [jpflori](#comment%3A29):
> we should check that the lapack [...] packages are installed on Cygwin

Why is it needed? I really don't like adding an extra check without understanding (and documenting) why.



---

archive/issue_comments_228126.json:
```json
{
    "body": "<a id='comment:33'></a>\n> > we should check that the lapack [...] packages are installed on Cygwin\n\n> Why is it needed? I really don't like adding an extra check without understanding why.\nAbsolutely needed, because Sage ordinarily could build ATLAS/lapack spkgs on other systems but on Cygwin we (currently) need to have lapack already to get atlas to build things like R and Scipy, and it's not officially a prerequisite for Sage in general.\n\nUnless I'm misunderstanding something about your question?",
    "created_at": "2013-04-03T17:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228126",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:33'></a>
> > we should check that the lapack [...] packages are installed on Cygwin

> Why is it needed? I really don't like adding an extra check without understanding why.
Absolutely needed, because Sage ordinarily could build ATLAS/lapack spkgs on other systems but on Cygwin we (currently) need to have lapack already to get atlas to build things like R and Scipy, and it's not officially a prerequisite for Sage in general.

Unless I'm misunderstanding something about your question?



---

archive/issue_comments_228127.json:
```json
{
    "body": "<a id='comment:34'></a>\nI disagree with\n\n```\nif [ \"$UNAME\" = \"SunOS\" ]\n```",
    "created_at": "2013-04-03T17:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228127",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
I disagree with

```
if [ "$UNAME" = "SunOS" ]
```



---

archive/issue_comments_228128.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [kcrisman](#comment%3A33):\n> Unless I'm misunderstanding something about your question?\n\nYou didn't really answer my question, you *confirmed* that it is needed without mentioning *why* it is needed. Perhaps a more explicit question is: **what goes wrong if you don't have lapack?**",
    "created_at": "2013-04-03T17:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228128",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>
Replying to [kcrisman](#comment%3A33):
> Unless I'm misunderstanding something about your question?

You didn't really answer my question, you *confirmed* that it is needed without mentioning *why* it is needed. Perhaps a more explicit question is: **what goes wrong if you don't have lapack?**



---

archive/issue_comments_228129.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [jpflori](#comment%3A21):\n> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n\n\nI wouldn't mind always \"cheating\", i.e. not supporting `logl()` at all and drop all the Cygwin/FreeBSD hassle. Especially because long doubles don't have a portable meaning (they have a different precision on different systems).",
    "created_at": "2013-04-03T18:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228129",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
Replying to [jpflori](#comment%3A21):
> Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.


I wouldn't mind always "cheating", i.e. not supporting `logl()` at all and drop all the Cygwin/FreeBSD hassle. Especially because long doubles don't have a portable meaning (they have a different precision on different systems).



---

archive/issue_comments_228130.json:
```json
{
    "body": "<a id='comment:37'></a>\nI would be against more system-specific checks in `prereq`, I would like to move to a real `./configure` before we do that. Because otherwise, it will lead to inconsistent checks (inconsistency between prereq and cephes's `spkg-install` like we're seeing now).",
    "created_at": "2013-04-03T18:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228130",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
I would be against more system-specific checks in `prereq`, I would like to move to a real `./configure` before we do that. Because otherwise, it will lead to inconsistent checks (inconsistency between prereq and cephes's `spkg-install` like we're seeing now).



---

archive/issue_comments_228131.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [jdemeyer](#comment%3A34):\n> I disagree with\n> \n> ```\n> if [ \"$UNAME\" = \"SunOS\" ]\n> ```\n\nI guess you been we should only \n\n```\n[ -f /usr/sfw/bin/* ]\n```\n?\nBut will there really be anything else than SunOS where /usr/sfw/bin exists?",
    "created_at": "2013-04-03T18:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228131",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:38'></a>
Replying to [jdemeyer](#comment%3A34):
> I disagree with
> 
> ```
> if [ "$UNAME" = "SunOS" ]
> ```

I guess you been we should only 

```
[ -f /usr/sfw/bin/* ]
```
?
But will there really be anything else than SunOS where /usr/sfw/bin exists?



---

archive/issue_comments_228132.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [jdemeyer](#comment%3A35):\n> Replying to [kcrisman](#comment%3A33):\n> > Unless I'm misunderstanding something about your question?\n\n> You didn't really answer my question, you *confirmed* that it is needed without mentioning *why* it is needed. Perhaps a more explicit question is: **what goes wrong if you don't have lapack?**\nOn Cygwin the lapack packages provide both BLAS and LAPACK.\nAnd the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.\nIt will not be really hard, but requires some more thoughts and work.",
    "created_at": "2013-04-03T18:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228132",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:39'></a>
Replying to [jdemeyer](#comment%3A35):
> Replying to [kcrisman](#comment%3A33):
> > Unless I'm misunderstanding something about your question?

> You didn't really answer my question, you *confirmed* that it is needed without mentioning *why* it is needed. Perhaps a more explicit question is: **what goes wrong if you don't have lapack?**
On Cygwin the lapack packages provide both BLAS and LAPACK.
And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.
It will not be really hard, but requires some more thoughts and work.



---

archive/issue_comments_228133.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [jpflori](#comment%3A38):\n> But will there really be anything else than SunOS where /usr/sfw/bin exists?\n\nAssuming not, the check for SunOS is redundant anyway.\n\nIt all goes back to the philosophy of not checking the system, but checking features.",
    "created_at": "2013-04-03T18:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228133",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Replying to [jpflori](#comment%3A38):
> But will there really be anything else than SunOS where /usr/sfw/bin exists?

Assuming not, the check for SunOS is redundant anyway.

It all goes back to the philosophy of not checking the system, but checking features.



---

archive/issue_comments_228134.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [jpflori](#comment%3A39):\n> And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.\n> It will not be really hard, but requires some more thoughts and work.\n\nOK, so it's a problem with the ATLAS spkg. In that case, would it not make more sense to add the check to the ATLAS spkg instead of `prereq`?",
    "created_at": "2013-04-03T18:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228134",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>
Replying to [jpflori](#comment%3A39):
> And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.
> It will not be really hard, but requires some more thoughts and work.

OK, so it's a problem with the ATLAS spkg. In that case, would it not make more sense to add the check to the ATLAS spkg instead of `prereq`?



---

archive/issue_comments_228135.json:
```json
{
    "body": "<a id='comment:42'></a>\nAttachment [trac_14406+reviewer-v3.patch](tarball://root/attachments/some-uuid/ticket14406/trac_14406+reviewer-v3.patch) by jpflori created at 2013-04-03 18:42:13\n\nReplying to [jdemeyer](#comment%3A41):\n> Replying to [jpflori](#comment%3A39):\n> > And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.\n> > It will not be really hard, but requires some more thoughts and work.\n\n> OK, so it's a problem with the ATLAS spkg. In that case, would it not make more sense to add the check to the ATLAS spkg instead of `prereq`?\nIts already there and provides info.\nI'm ok to not check anything in prereq and let the ATLAS spkg do the job (although the user might say \"hey it passed prereq and now its asking for something more to be installed so much later!!!\").\n\n(And I just uploaded a new patch without redundant SunOS check.)",
    "created_at": "2013-04-03T18:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228135",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:42'></a>
Attachment [trac_14406+reviewer-v3.patch](tarball://root/attachments/some-uuid/ticket14406/trac_14406+reviewer-v3.patch) by jpflori created at 2013-04-03 18:42:13

Replying to [jdemeyer](#comment%3A41):
> Replying to [jpflori](#comment%3A39):
> > And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin.
> > It will not be really hard, but requires some more thoughts and work.

> OK, so it's a problem with the ATLAS spkg. In that case, would it not make more sense to add the check to the ATLAS spkg instead of `prereq`?
Its already there and provides info.
I'm ok to not check anything in prereq and let the ATLAS spkg do the job (although the user might say "hey it passed prereq and now its asking for something more to be installed so much later!!!").

(And I just uploaded a new patch without redundant SunOS check.)



---

archive/issue_comments_228136.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n **Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])\n \n-**Apply** [attachment:trac_14406+reviewer-v2.patch]\n+**Apply** [attachment:trac_14406+reviewer-v3.patch]\n``````\n",
    "created_at": "2013-04-03T18:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228136",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
 **Copy** [http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz](http://boxen.math.washington.edu/home/jdemeyer/spkg/prereq-1.2.tar.gz) to `spkg/base` ([attachment:prereq-1.2.diff diff])
 
-**Apply** [attachment:trac_14406+reviewer-v2.patch]
+**Apply** [attachment:trac_14406+reviewer-v3.patch]
``````




---

archive/issue_comments_228137.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [jdemeyer](#comment%3A36):\n> Replying to [jpflori](#comment%3A21):\n> > Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.\n\n> \n> I wouldn't mind always \"cheating\", i.e. not supporting `logl()` at all and drop all the Cygwin/FreeBSD hassle. Especially because long doubles don't have a portable meaning (they have a different precision on different systems).\n\nIve got a slight preference for the SAGE_INST_CEPHES solution, espoecially it \"could\" be easier to maintain, but for the moment I could go with not even testing sqrtl anywhere assuming that its in the libm of supported platforms or were dealing with Cygwin or FreeBSD.",
    "created_at": "2013-04-03T18:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228137",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:43'></a>
Replying to [jdemeyer](#comment%3A36):
> Replying to [jpflori](#comment%3A21):
> > Indeed, we cheat for logl/sqrtl/tgammal/lgammal in sage/symbolic/pynac_cc.h just as we do with the R patch for logl.

> 
> I wouldn't mind always "cheating", i.e. not supporting `logl()` at all and drop all the Cygwin/FreeBSD hassle. Especially because long doubles don't have a portable meaning (they have a different precision on different systems).

Ive got a slight preference for the SAGE_INST_CEPHES solution, espoecially it "could" be easier to maintain, but for the moment I could go with not even testing sqrtl anywhere assuming that its in the libm of supported platforms or were dealing with Cygwin or FreeBSD.



---

archive/issue_comments_228138.json:
```json
{
    "body": "<a id='comment:44'></a>\nReviewer patch is okay for me.",
    "created_at": "2013-04-03T21:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228138",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
Reviewer patch is okay for me.



---

archive/issue_comments_228139.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [jpflori](#comment%3A43):\n> Ive got a slight preference for the SAGE_INST_CEPHES solution\n\nI don't really know what that \"solution\" would be.\n\nThe main thing I don't want is to spread the same checks in different places. For example, the lapack check should be either in prereq, either in ATLAS, not in both. Since it currently cannot be done only in prereq, it must be done in ATLAS.",
    "created_at": "2013-04-03T21:09:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228139",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>
Replying to [jpflori](#comment%3A43):
> Ive got a slight preference for the SAGE_INST_CEPHES solution

I don't really know what that "solution" would be.

The main thing I don't want is to spread the same checks in different places. For example, the lapack check should be either in prereq, either in ATLAS, not in both. Since it currently cannot be done only in prereq, it must be done in ATLAS.



---

archive/issue_comments_228140.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [jdemeyer](#comment%3A45):\n> Replying to [jpflori](#comment%3A43):\n> > Ive got a slight preference for the SAGE_INST_CEPHES solution\n\n> I don't really know what that \"solution\" would be.\nThat would be:\n* check for sqrtl.\n* if not available trigger installation of the cephes spkg.\n> \n> The main thing I don't want is to spread the same checks in different places. For example, the lapack check should be either in prereq, either in ATLAS, not in both. Since it currently cannot be done only in prereq, it must be done in ATLAS.",
    "created_at": "2013-04-03T21:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228140",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:46'></a>
Replying to [jdemeyer](#comment%3A45):
> Replying to [jpflori](#comment%3A43):
> > Ive got a slight preference for the SAGE_INST_CEPHES solution

> I don't really know what that "solution" would be.
That would be:
* check for sqrtl.
* if not available trigger installation of the cephes spkg.
> 
> The main thing I don't want is to spread the same checks in different places. For example, the lapack check should be either in prereq, either in ATLAS, not in both. Since it currently cannot be done only in prereq, it must be done in ATLAS.



---

archive/issue_comments_228141.json:
```json
{
    "body": "<a id='comment:47'></a>\n> > > Unless I'm misunderstanding something about your question? \n\n> > You didn't really answer my question, you confirmed that it is needed without mentioning why it is needed. Perhaps a more explicit question is: what goes wrong if you don't have lapack? \n> On Cygwin the lapack packages provide both BLAS and LAPACK. And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin. It will not be really hard, but requires some more thoughts and work. \n\nI thought that was basically what I was saying... not sure what happened here.\n\nAnyway, as to the check, the reason to have it early is that atlas might build quite late in a process, and then someone says \"Oh, Mxyzptlk, why did I waste all that time building Sage and I didn't have the right prereqs?\"  Which I guess JP just said too.",
    "created_at": "2013-04-04T00:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228141",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:47'></a>
> > > Unless I'm misunderstanding something about your question? 

> > You didn't really answer my question, you confirmed that it is needed without mentioning why it is needed. Perhaps a more explicit question is: what goes wrong if you don't have lapack? 
> On Cygwin the lapack packages provide both BLAS and LAPACK. And the current Sage's ATLAS spkg, or the one from #10508, does not build ATLAS on Cygwin. It will not be really hard, but requires some more thoughts and work. 

I thought that was basically what I was saying... not sure what happened here.

Anyway, as to the check, the reason to have it early is that atlas might build quite late in a process, and then someone says "Oh, Mxyzptlk, why did I waste all that time building Sage and I didn't have the right prereqs?"  Which I guess JP just said too.



---

archive/issue_comments_228142.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [jpflori](#comment%3A46):\n> That would be:\n> * check for sqrtl.\n> * if not available trigger installation of the cephes spkg.\n \nAnd how would a prereq check \"trigger\" the installation of the cephes spkg? I don't think that can currently be done.",
    "created_at": "2013-04-04T06:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228142",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>
Replying to [jpflori](#comment%3A46):
> That would be:
> * check for sqrtl.
> * if not available trigger installation of the cephes spkg.
 
And how would a prereq check "trigger" the installation of the cephes spkg? I don't think that can currently be done.



---

archive/issue_comments_228143.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [kcrisman](#comment%3A47):\n> Anyway, as to the check, the reason to have it early is that atlas might build quite late in a process, and then someone says \"Oh, Mxyzptlk, why did I waste all that time building Sage and I didn't have the right prereqs?\"  Which I guess JP just said too.\n\nI certainly don't disagree with this, but for this to work (and also jpflori's idea of \"triggering\"), we need to change the prereq mechanism which is a lot less trivial than this ticket.",
    "created_at": "2013-04-04T06:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228143",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>
Replying to [kcrisman](#comment%3A47):
> Anyway, as to the check, the reason to have it early is that atlas might build quite late in a process, and then someone says "Oh, Mxyzptlk, why did I waste all that time building Sage and I didn't have the right prereqs?"  Which I guess JP just said too.

I certainly don't disagree with this, but for this to work (and also jpflori's idea of "triggering"), we need to change the prereq mechanism which is a lot less trivial than this ticket.



---

archive/issue_comments_228144.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [jdemeyer](#comment%3A48):\n> Replying to [jpflori](#comment%3A46):\n> > That would be:\n> > * check for sqrtl.\n> > * if not available trigger installation of the cephes spkg.\n \n> And how would a prereq check \"trigger\" the installation of the cephes spkg? I don't think that can currently be done.\nI thought we could do that just like you do for GCC.\nBut that might be impossible, i did not check.",
    "created_at": "2013-04-04T06:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228144",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:50'></a>
Replying to [jdemeyer](#comment%3A48):
> Replying to [jpflori](#comment%3A46):
> > That would be:
> > * check for sqrtl.
> > * if not available trigger installation of the cephes spkg.
 
> And how would a prereq check "trigger" the installation of the cephes spkg? I don't think that can currently be done.
I thought we could do that just like you do for GCC.
But that might be impossible, i did not check.



---

archive/issue_comments_228145.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [jpflori](#comment%3A50):\n> Replying to [jdemeyer](#comment%3A48):\n> > Replying to [jpflori](#comment%3A46):\n> > > That would be:\n> > > * check for sqrtl.\n> > > * if not available trigger installation of the cephes spkg.\n \n> > And how would a prereq check \"trigger\" the installation of the cephes spkg? I don't think that can currently be done.\n> I thought we could do that just like you do for GCC.\n> But that might be impossible, i did not check.\n\nJust a little more details of the way I see this, but that may be wrong:\n* at prereq time (or whenever the gcc version checks are done), set an env variable if the test fails (or the user can override it if he wants),\n* then either our spkg system is smart enough to build the cephes spkg iff this variable is set, or the spkg-install script from cephes spkg checks its value by itself and decide whether it should build or not (just like it now checks it is running on FreeBSD).",
    "created_at": "2013-04-04T06:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228145",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:51'></a>
Replying to [jpflori](#comment%3A50):
> Replying to [jdemeyer](#comment%3A48):
> > Replying to [jpflori](#comment%3A46):
> > > That would be:
> > > * check for sqrtl.
> > > * if not available trigger installation of the cephes spkg.
 
> > And how would a prereq check "trigger" the installation of the cephes spkg? I don't think that can currently be done.
> I thought we could do that just like you do for GCC.
> But that might be impossible, i did not check.

Just a little more details of the way I see this, but that may be wrong:
* at prereq time (or whenever the gcc version checks are done), set an env variable if the test fails (or the user can override it if he wants),
* then either our spkg system is smart enough to build the cephes spkg iff this variable is set, or the spkg-install script from cephes spkg checks its value by itself and decide whether it should build or not (just like it now checks it is running on FreeBSD).



---

archive/issue_comments_228146.json:
```json
{
    "body": "<a id='comment:52'></a>\nAnd I'm in for the idea of \"let's postpone this complicated stuff\" (for the ATLAS and Cephes stuff).\n\nIf nobody rants too loud, I'll put this ticket to positive review so that we have official \"experimental\" for Cygwin in 5.9 or 5.10.",
    "created_at": "2013-04-04T06:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228146",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:52'></a>
And I'm in for the idea of "let's postpone this complicated stuff" (for the ATLAS and Cephes stuff).

If nobody rants too loud, I'll put this ticket to positive review so that we have official "experimental" for Cygwin in 5.9 or 5.10.



---

archive/issue_comments_228147.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [jpflori](#comment%3A50):\n> I thought we could do that just like you do for GCC.\n\nNot really, the check for GCC is done in `spkg/install`, not prereq.\n\nI agree that all these checks should eventually move to a new file `$SAGE_ROOT/configure`, but that would require some refactoring of the build system. Since the Sage+GIT people are also refactoring the build system, it might make sense to wait for sage-6.1 to do this.",
    "created_at": "2013-04-04T06:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228147",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>
Replying to [jpflori](#comment%3A50):
> I thought we could do that just like you do for GCC.

Not really, the check for GCC is done in `spkg/install`, not prereq.

I agree that all these checks should eventually move to a new file `$SAGE_ROOT/configure`, but that would require some refactoring of the build system. Since the Sage+GIT people are also refactoring the build system, it might make sense to wait for sage-6.1 to do this.



---

archive/issue_comments_228148.json:
```json
{
    "body": "<a id='comment:54'></a>\nAgreed, let's move on and merge this considering:\n* sqrtl is not really a prereq as it should be on all supported platform or provided either by cheating or by building cephes (and note FreeBSD is even not officialy supported). Later we can give it a similar treatment as GCC. We can wait for 6.1 to do this.\n* the ATLAS thing is currently only somehow boring on Cygwin, but the ATLAS spkg takes care of this (although later than the prereq one) and that is planned to change. For the moment what will happen is that ATLAS build will fail and tell the user to install the needed packages, he will do that and then the build process will go on. I guess someone actually trying to compile a huge thing as Sage can live with that. We should already wait for #10508 to be merged before doing that.",
    "created_at": "2013-04-04T07:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228148",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:54'></a>
Agreed, let's move on and merge this considering:
* sqrtl is not really a prereq as it should be on all supported platform or provided either by cheating or by building cephes (and note FreeBSD is even not officialy supported). Later we can give it a similar treatment as GCC. We can wait for 6.1 to do this.
* the ATLAS thing is currently only somehow boring on Cygwin, but the ATLAS spkg takes care of this (although later than the prereq one) and that is planned to change. For the moment what will happen is that ATLAS build will fail and tell the user to install the needed packages, he will do that and then the build process will go on. I guess someone actually trying to compile a huge thing as Sage can live with that. We should already wait for #10508 to be merged before doing that.



---

archive/issue_comments_228149.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-04-04T07:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228149",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_228150.json:
```json
{
    "body": "**Reviewer:** Jean-Pierre Flori, Jeroen Demeyer",
    "created_at": "2013-04-04T07:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228150",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Reviewer:** Jean-Pierre Flori, Jeroen Demeyer



---

archive/issue_comments_228151.json:
```json
{
    "body": "**Changing author** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Jean-Pierre Flori\".",
    "created_at": "2013-04-04T07:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228151",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing author** from "Jeroen Demeyer" to "Jeroen Demeyer, Jean-Pierre Flori".



---

archive/issue_comments_228152.json:
```json
{
    "body": "<a id='comment:55'></a>\nI've opened #14410 for the ATLAS on Cygwin stuff.",
    "created_at": "2013-04-04T07:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228152",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:55'></a>
I've opened #14410 for the ATLAS on Cygwin stuff.



---

archive/issue_comments_228153.json:
```json
{
    "body": "<a id='comment:56'></a>\nOkay, this is better than the alternatives.",
    "created_at": "2013-04-04T13:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228153",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:56'></a>
Okay, this is better than the alternatives.



---

archive/issue_comments_228154.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-04-04T17:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228154",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed



---

archive/issue_events_047182.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-04T17:41:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14406#event-47182"
}
```



---

archive/issue_comments_228155.json:
```json
{
    "body": "**Merged:** sage-5.9.beta4",
    "created_at": "2013-04-04T17:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228155",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.9.beta4



---

archive/issue_comments_228156.json:
```json
{
    "body": "<a id='comment:58'></a>\nGroumpf, I just realized that the last elif clause filtering OS names should include Cygwin (and beware that uname does not just return CYGWIN but CYGWIN... where ... gives additional precision which we don't really care about at the moment).\nShould we fix that on another ticket?",
    "created_at": "2013-04-11T22:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228156",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:58'></a>
Groumpf, I just realized that the last elif clause filtering OS names should include Cygwin (and beware that uname does not just return CYGWIN but CYGWIN... where ... gives additional precision which we don't really care about at the moment).
Should we fix that on another ticket?



---

archive/issue_comments_228157.json:
```json
{
    "body": "<a id='comment:59'></a>\nReplying to [jpflori](#comment%3A58):\n> Should we fix that on another ticket?\n\nYes, I made #14447 but I'll let you write the patch.\n\nAs for the Cygwin version thing: I propose\n\n```\nif uname | grep CYGWIN >/dev/null; then\n    ...\nfi\n```",
    "created_at": "2013-04-12T06:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14406#issuecomment-228157",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:59'></a>
Replying to [jpflori](#comment%3A58):
> Should we fix that on another ticket?

Yes, I made #14447 but I'll let you write the patch.

As for the Cygwin version thing: I propose

```
if uname | grep CYGWIN >/dev/null; then
    ...
fi
```
