# Issue 14172: mpir-2.6.0.p0 fails to build on Intel "Core" and Pentium4 Prescott CPUs

archive/issues_013968.json:
```json
{
    "body": "The build of sage 5.7 stops during the build of the mpir-2.6.0.p0 package.\n\nspkg/logs/mpir-2.6.0.p0.log is pasted at http://paste.debian.net/237529/\n\nThe problem seems related to some 32-bit architecture:\n\n```\nBuilding a 32-bit version of MPIR.\nBuilding MPIR with the C++ interface and (also) static libraries.\n** Building with \"fat binary\" support for 32-bit CPUs **\n[...]\nconfigure: error: ABI=32 is not among the following valid choices: standard\nError configuring MPIR (with CFLAGS unset).\n```\n\nThe machine is running Debian wheezy, Linux 3.2.0-4-686-pae #1 SMP Debian 3.2.35-2 i686 GNU/Linux\n\nI used the following sage variables :\n- SAGE_FAT_BINARY='yes'\n- SAGE_BINARY_BUILD='yes'\n- SAGE_CHECK=\"yes\"\n- MAKE=\"make -j2\"\n\nExporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).\n\n\n---\n\nJust for completeness:  The previous spkg (and of course also vanilla MPIR 2.6.0) failed in exactly the same way when configured on (or with [`MPIR_CONFIGURE=`]`--host=`)`prescott-pc-linux-gnu`:\n\n```\n...\nusing ABI=\"standard\"\n      CC=\"gcc -std=gnu99\"\n      CFLAGS=\"-O2\"\n      CPPFLAGS=\"\"\n      CXX=\"g++\"\n      CXXFLAGS=\"-O2\"\n      MPN_PATH=\"  generic\"\n...\n```\n\nThe new spkg also fixes this.\n\n---\n\n**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)\n\n**md5sum:** `6e65bb989b0e5513371a35447b43b0da  mpir-2.6.0.p1.spkg`\n\nNow patches `acinclude.m4`, `configure.in`, and `configure`.\n\n(Changes now committed, and [bug report](https://groups.google.com/forum/?fromgroups=#!topic/mpir-devel/TyfWY6Mcm1A) and patches submitted upstream, too.)\n\n### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)\n* #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n  \"Core\" CPUs (expecting ABI to be \"standard\" rather than \"32\", which is\n  just one symptom).  (Similar for Pentium4 Prescott.)\n  Add patch (`core-prescott-configure.patch`) fixing `acinclude.m4`,\n  `configure.in`, and the generated `configure`, rebased to the patches we\n  apply in advance.\n  Patch(es) have been submitted upstream.\n\n\n**Assignee:** GeorgSWeber\n\n**CC:**  @nexttime jpflori @jhpalmieri @kcrisman\n\n**Keywords:** mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl\n\n**Upstream:** Completely fixed; Fix reported upstream\n\n**Reviewer:** Thierry Monteil, Jean-Pierre Flori\n\n**Author:** Leif Leonhardy\n\n**Merged:** sage-5.9.beta2\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14172\n\n",
    "closed_at": "2013-03-28T17:59:20Z",
    "created_at": "2013-02-24T11:55:22Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "mpir-2.6.0.p0 fails to build on Intel \"Core\" and Pentium4 Prescott CPUs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14172",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
The build of sage 5.7 stops during the build of the mpir-2.6.0.p0 package.

spkg/logs/mpir-2.6.0.p0.log is pasted at http://paste.debian.net/237529/

The problem seems related to some 32-bit architecture:

```
Building a 32-bit version of MPIR.
Building MPIR with the C++ interface and (also) static libraries.
** Building with "fat binary" support for 32-bit CPUs **
[...]
configure: error: ABI=32 is not among the following valid choices: standard
Error configuring MPIR (with CFLAGS unset).
```

The machine is running Debian wheezy, Linux 3.2.0-4-686-pae #1 SMP Debian 3.2.35-2 i686 GNU/Linux

I used the following sage variables :
- SAGE_FAT_BINARY='yes'
- SAGE_BINARY_BUILD='yes'
- SAGE_CHECK="yes"
- MAKE="make -j2"

Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).


---

Just for completeness:  The previous spkg (and of course also vanilla MPIR 2.6.0) failed in exactly the same way when configured on (or with [`MPIR_CONFIGURE=`]`--host=`)`prescott-pc-linux-gnu`:

```
...
using ABI="standard"
      CC="gcc -std=gnu99"
      CFLAGS="-O2"
      CPPFLAGS=""
      CXX="g++"
      CXXFLAGS="-O2"
      MPN_PATH="  generic"
...
```

The new spkg also fixes this.

---

**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)

**md5sum:** `6e65bb989b0e5513371a35447b43b0da  mpir-2.6.0.p1.spkg`

Now patches `acinclude.m4`, `configure.in`, and `configure`.

(Changes now committed, and [bug report](https://groups.google.com/forum/?fromgroups=#!topic/mpir-devel/TyfWY6Mcm1A) and patches submitted upstream, too.)

### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)
* #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
  "Core" CPUs (expecting ABI to be "standard" rather than "32", which is
  just one symptom).  (Similar for Pentium4 Prescott.)
  Add patch (`core-prescott-configure.patch`) fixing `acinclude.m4`,
  `configure.in`, and the generated `configure`, rebased to the patches we
  apply in advance.
  Patch(es) have been submitted upstream.


**Assignee:** GeorgSWeber

**CC:**  @nexttime jpflori @jhpalmieri @kcrisman

**Keywords:** mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl

**Upstream:** Completely fixed; Fix reported upstream

**Reviewer:** Thierry Monteil, Jean-Pierre Flori

**Author:** Leif Leonhardy

**Merged:** sage-5.9.beta2

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/14172





---

archive/issue_comments_222627.json:
```json
{
    "body": "**Changing keywords** from \"mpir, spkg\" to \"mpir spkg ABI 32\".",
    "created_at": "2013-02-24T14:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222627",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "mpir, spkg" to "mpir spkg ABI 32".



---

archive/issue_comments_222628.json:
```json
{
    "body": "<a id='comment:2'></a>\nCould you attach `spkg/build/mpir-2.6.0.p0/src/config.log` (of a *failed* build)?\n\nWhat does `spkg/build/mpir-2.6.0.p0/src/config.guess` give?",
    "created_at": "2013-02-24T14:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222628",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>
Could you attach `spkg/build/mpir-2.6.0.p0/src/config.log` (of a *failed* build)?

What does `spkg/build/mpir-2.6.0.p0/src/config.guess` give?



---

archive/issue_comments_222629.json:
```json
{
    "body": "<a id='comment:3'></a>\nAlso `/proc/cpuinfo` might be interesting.",
    "created_at": "2013-02-24T14:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222629",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>
Also `/proc/cpuinfo` might be interesting.



---

archive/issue_comments_222630.json:
```json
{
    "body": "<a id='comment:4'></a>\nFor reference, this is the current logic (originally for MPIR 2.4.0):\n\n```sh\n\n    Linux)\n        # MPIR fails to build on 32-bit operating systems running on\n        # 64-bit CPUs if CFLAGS happen to contain '-m32' and ABI is\n        # *not* set, so we set it here if necessary:\n        # (Cf. http://groups.google.com/group/mpir-devel/browse_thread/thread/46ccdc5dfc3485cd#)\n        # Note: This code snippet could in principle be moved out of the\n        #       Linux branch, but since we already set ABI for other\n        #       OSs above (and print an according message), it's here.\n        if [ -z \"$ABI\" ]; then\n            echo \"int main(){return 0;}\" > foo.c\n            # Try building and running a 64-bit executable:\n            # (Building usually succeeds even on 32-bit systems, unless e.g. a 32-bit\n            # CPU is explicitly selected by CFLAGS, while running does not.)\n            if $CC $CFLAGS $CFLAG64 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then\n                # We can run 64-bit executables.\n                # Setting ABI=64 shouldn't be necessary, but shouldn't hurt either.\n                echo \"Building a 64-bit version of MPIR.\"\n                case \"`uname -m`\" in\n                    ppc64) ABI=mode64;;\n                    *)     ABI=64\n                esac\n            elif $CC $CFLAGS $CFLAG32 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then\n                # We're on a 32-bit OS which cannot run 64-bit executables.\n                echo \"Building a 32-bit version of MPIR.\"\n                ABI=32\n            else\n                # It seems the compiler does not support -m32 nor -m64 (e.g.\n                # GCC on Itanium rejects both); do not set ABI at all.\n                echo \"Your compiler does not support '$CFLAG32' nor '$CFLAG64'.  Leaving ABI unset.\"\n            fi\n            rm -f foo foo.c\n        fi\n        ;; # Linux\n```\n\n---\n\nIf only MPIR (2.6.0) requires `ABI=standard` (rather than `ABI=32`, or left empty/unset), one should presumably only set it for building MPIR:\n\n```\n$ unset ABI # (or set it to \"32\" on 32-bit operating systems running on a 64-bit CPU)\n$ make -k # continue as far as possible\n$ env ABI=standard ./sage -i spkg/standand/mpir-2.6.0.p0.spkg\n$ make # build the rest\n```\n\nThat way (not *globally* setting `ABI=standard`) shouldn't cause problems with other spkgs (such as GAP).\n\nWe'll see whether we can tweak `spkg-install` (or patch MPIR's `configure`) to not require this manual intervention, although [from a previous thread on a similar problem]\n\n```\nOn Dec 24, 1:51\u00a0am, Bill Hart <goodwillh...@googlemail.com> wrote:\n> I agree with William's synopsis. You definitely have 64 bit hardware,\n> but a 32 bit OS. It's not that your hardware is \"old\". I was just\n> wrong about that. We support much older hardware than Core 2's!\n>\n> Note that you will get an approximately 2x speedup of much\n> mathematical software if you upgrade your linux to a 64 bit linux. So\n> it is worth considering.\n```\n(SCNR.)",
    "created_at": "2013-02-24T16:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222630",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
For reference, this is the current logic (originally for MPIR 2.4.0):

```sh

    Linux)
        # MPIR fails to build on 32-bit operating systems running on
        # 64-bit CPUs if CFLAGS happen to contain '-m32' and ABI is
        # *not* set, so we set it here if necessary:
        # (Cf. http://groups.google.com/group/mpir-devel/browse_thread/thread/46ccdc5dfc3485cd#)
        # Note: This code snippet could in principle be moved out of the
        #       Linux branch, but since we already set ABI for other
        #       OSs above (and print an according message), it's here.
        if [ -z "$ABI" ]; then
            echo "int main(){return 0;}" > foo.c
            # Try building and running a 64-bit executable:
            # (Building usually succeeds even on 32-bit systems, unless e.g. a 32-bit
            # CPU is explicitly selected by CFLAGS, while running does not.)
            if $CC $CFLAGS $CFLAG64 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then
                # We can run 64-bit executables.
                # Setting ABI=64 shouldn't be necessary, but shouldn't hurt either.
                echo "Building a 64-bit version of MPIR."
                case "`uname -m`" in
                    ppc64) ABI=mode64;;
                    *)     ABI=64
                esac
            elif $CC $CFLAGS $CFLAG32 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then
                # We're on a 32-bit OS which cannot run 64-bit executables.
                echo "Building a 32-bit version of MPIR."
                ABI=32
            else
                # It seems the compiler does not support -m32 nor -m64 (e.g.
                # GCC on Itanium rejects both); do not set ABI at all.
                echo "Your compiler does not support '$CFLAG32' nor '$CFLAG64'.  Leaving ABI unset."
            fi
            rm -f foo foo.c
        fi
        ;; # Linux
```

---

If only MPIR (2.6.0) requires `ABI=standard` (rather than `ABI=32`, or left empty/unset), one should presumably only set it for building MPIR:

```
$ unset ABI # (or set it to "32" on 32-bit operating systems running on a 64-bit CPU)
$ make -k # continue as far as possible
$ env ABI=standard ./sage -i spkg/standand/mpir-2.6.0.p0.spkg
$ make # build the rest
```

That way (not *globally* setting `ABI=standard`) shouldn't cause problems with other spkgs (such as GAP).

We'll see whether we can tweak `spkg-install` (or patch MPIR's `configure`) to not require this manual intervention, although [from a previous thread on a similar problem]

```
On Dec 24, 1:51 am, Bill Hart <goodwillh...@googlemail.com> wrote:
> I agree with William's synopsis. You definitely have 64 bit hardware,
> but a 32 bit OS. It's not that your hardware is "old". I was just
> wrong about that. We support much older hardware than Core 2's!
>
> Note that you will get an approximately 2x speedup of much
> mathematical software if you upgrade your linux to a 64 bit linux. So
> it is worth considering.
```
(SCNR.)



---

archive/issue_events_046223.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "rename": {
        "from": "mpir-2.6.0.p0 fails to build on 32-bit architecure",
        "to": "mpir-2.6.0.p0 fails to build on Intel \"Core\" CPU running 32-bit Linux"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14172#event-46223"
}
```



---

archive/issue_comments_222631.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe problem seems to be an upstream bug in MPIR 2.6.0, specifically on **Intel Core** (not Core2 or Core i7) processors, or, more precisely, shows up if `config.guess` yields `core-*` (probably only in conjunction with a 32-bit [Linux] OS, not sure right now).",
    "created_at": "2013-02-24T18:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222631",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
The problem seems to be an upstream bug in MPIR 2.6.0, specifically on **Intel Core** (not Core2 or Core i7) processors, or, more precisely, shows up if `config.guess` yields `core-*` (probably only in conjunction with a 32-bit [Linux] OS, not sure right now).



---

archive/issue_comments_222632.json:
```json
{
    "body": "**Changing keywords** from \"mpir spkg ABI 32\" to \"mpir spkg ABI standard Intel Core\".",
    "created_at": "2013-02-24T19:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222632",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "mpir spkg ABI 32" to "mpir spkg ABI standard Intel Core".



---

archive/issue_comments_222633.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt doesn't seem to matter whether the OS is 32- or 64-bit, it's just `core-*` that doesn't allow `ABI=32` nor `ABI=64`.\n\nNote that (on `core-*`) with `ABI=standard`, the *generic C implementation* is chosen, which is odd.",
    "created_at": "2013-02-24T19:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222633",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
It doesn't seem to matter whether the OS is 32- or 64-bit, it's just `core-*` that doesn't allow `ABI=32` nor `ABI=64`.

Note that (on `core-*`) with `ABI=standard`, the *generic C implementation* is chosen, which is odd.



---

archive/issue_comments_222634.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"Reported upstream. Developers acknowledge bug.\".",
    "created_at": "2013-02-24T19:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222634",
    "user": "https://github.com/nexttime"
}
```

**Changing upstream** from "N/A" to "Reported upstream. Developers acknowledge bug.".



---

archive/issue_events_046224.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "rename": {
        "from": "mpir-2.6.0.p0 fails to build on Intel \"Core\" CPU running 32-bit Linux",
        "to": "mpir-2.6.0.p0 fails to build on Intel \"Core\" CPUs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14172#event-46224"
}
```



---

archive/issue_comments_222635.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [leif](#comment%3A3):\n> Also `/proc/cpuinfo` might be interesting.\n\n\nThierry, could you paste the output of `cat /proc/cpuinfo`?\n\nAlso, do you happen to have the MPIR build log from Sage 5.6 on the same machine?  (It seems the actual bug had been present in MPIR 2.4.0 and probably older releases as well, so we're curious what has changed inbetween -- probably the output of MPIR's `config.guess`.)",
    "created_at": "2013-02-24T20:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222635",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
Replying to [leif](#comment%3A3):
> Also `/proc/cpuinfo` might be interesting.


Thierry, could you paste the output of `cat /proc/cpuinfo`?

Also, do you happen to have the MPIR build log from Sage 5.6 on the same machine?  (It seems the actual bug had been present in MPIR 2.4.0 and probably older releases as well, so we're curious what has changed inbetween -- probably the output of MPIR's `config.guess`.)



---

archive/issue_comments_222636.json:
```json
{
    "body": "<a id='comment:9'></a>\nHere are the files.\n\n- /proc/cpuinfo is at http://paste.debian.net/237897/\n- spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/\n- spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/\n\nI will see if i can found a log for the sage 5.6 build somewhere.\n\nNote that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.",
    "created_at": "2013-02-24T21:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222636",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:9'></a>
Here are the files.

- /proc/cpuinfo is at http://paste.debian.net/237897/
- spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/
- spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/

I will see if i can found a log for the sage 5.6 build somewhere.

Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.



---

archive/issue_comments_222637.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [tmonteil](#comment%3A9):\n> Here are the files.\n\n\nThanks.\n\n> - /proc/cpuinfo is at http://paste.debian.net/237897/\n> - spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/\n> - spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/\n\n\nSorry, I meant the output of running `config.guess` (you uploaded the file itself), but I guess it is just `core-pc-linux-gnu`.  (Its output would also be interesting for MPIR 2.4.0, although I doubt it'll differ.)\n\n\n\n\n> I will see if i can found a log for the sage 5.6 build somewhere.\n\n\nIf you still have the Sage 5.6 installation (but not the logs in `spkg/logs/`), you could try reinstalling MPIR 2.4.0 with `./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg`. (`-s` keeps the spkg build directory, where the source code (including `config.guess`) and `config.log` are located, even if no error occurred during the installation.)\n\n\n\n\n> Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.\n\n\nYes.  Some also prefer 32-bit versions for virtual machines (on 64-bit machines).\n\nThe safest way to produce (32-bit) binary dists is still to create them natively, on old machines.  (E.g., `ECM_CONFIGURE=--disable-sse2` is currently necessary for Pentium III and some older CPUs, which I only noticed while actually building on a Pentium III ...)",
    "created_at": "2013-02-24T22:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222637",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>
Replying to [tmonteil](#comment%3A9):
> Here are the files.


Thanks.

> - /proc/cpuinfo is at http://paste.debian.net/237897/
> - spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/
> - spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/


Sorry, I meant the output of running `config.guess` (you uploaded the file itself), but I guess it is just `core-pc-linux-gnu`.  (Its output would also be interesting for MPIR 2.4.0, although I doubt it'll differ.)




> I will see if i can found a log for the sage 5.6 build somewhere.


If you still have the Sage 5.6 installation (but not the logs in `spkg/logs/`), you could try reinstalling MPIR 2.4.0 with `./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg`. (`-s` keeps the spkg build directory, where the source code (including `config.guess`) and `config.log` are located, even if no error occurred during the installation.)




> Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.


Yes.  Some also prefer 32-bit versions for virtual machines (on 64-bit machines).

The safest way to produce (32-bit) binary dists is still to create them natively, on old machines.  (E.g., `ECM_CONFIGURE=--disable-sse2` is currently necessary for Pentium III and some older CPUs, which I only noticed while actually building on a Pentium III ...)



---

archive/issue_comments_222638.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,7 +21,5 @@\n - SAGE_CHECK=\"yes\"\n - MAKE=\"make -j2\"\n \n-I had no problem building sage-5.6 on the same machine with the same configuration.\n-\n Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).\n \n``````\n",
    "created_at": "2013-02-25T14:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222638",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,7 +21,5 @@
 - SAGE_CHECK="yes"
 - MAKE="make -j2"
 
-I had no problem building sage-5.6 on the same machine with the same configuration.
-
 Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).
 
``````




---

archive/issue_comments_222639.json:
```json
{
    "body": "<a id='comment:11'></a>\nThe output of running config.guess is indeed core-pc-linux-gnu (as well as on the mpir-2.4.0.p6.spkg).\n\nNow, looking back at the logs of the sage-5.6 build, it seems that i built it on a more recent machine (though the live USB key with 32-bit OS was the same). Sorry for having missing that (i am currently oscillating between two different locations every two weeks).\n\nRunning ./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg on the older machine does the same bug.",
    "created_at": "2013-02-25T14:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222639",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:11'></a>
The output of running config.guess is indeed core-pc-linux-gnu (as well as on the mpir-2.4.0.p6.spkg).

Now, looking back at the logs of the sage-5.6 build, it seems that i built it on a more recent machine (though the live USB key with 32-bit OS was the same). Sorry for having missing that (i am currently oscillating between two different locations every two weeks).

Running ./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg on the older machine does the same bug.



---

archive/issue_comments_222640.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,3 +23,25 @@\n \n Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).\n \n+---\n+\n+**Preliminary new spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg)\n+\n+**md5sum:** `e2839d31c41934ceb5fdda4a6399028d  mpir-2.6.0.p1-preliminary.spkg`\n+\n+This currently only patches `configure`, not [in addition] its source files.\n+\n+(Changes not yet committed either.)\n+\n+### mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013)\n+* #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n+  \"Core\" CPUs (expecting ABI to be \"standard\" rather than \"32\", which is\n+  just a symptom).  (Similar for Pentium4 Prescott.)\n+  We currently only patch (the generated) `configure` (after another patch\n+  to it and its source files has been applied), rather than [also]\n+  `aclocal.m4` and `configure.in`.\n+  I'll submit proper patches upstream later.\n+\n+\n+\n+\n``````\n",
    "created_at": "2013-02-27T00:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222640",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,3 +23,25 @@
 
 Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).
 
+---
+
+**Preliminary new spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg)
+
+**md5sum:** `e2839d31c41934ceb5fdda4a6399028d  mpir-2.6.0.p1-preliminary.spkg`
+
+This currently only patches `configure`, not [in addition] its source files.
+
+(Changes not yet committed either.)
+
+### mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013)
+* #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
+  "Core" CPUs (expecting ABI to be "standard" rather than "32", which is
+  just a symptom).  (Similar for Pentium4 Prescott.)
+  We currently only patch (the generated) `configure` (after another patch
+  to it and its source files has been applied), rather than [also]
+  `aclocal.m4` and `configure.in`.
+  I'll submit proper patches upstream later.
+
+
+
+
``````




---

archive/issue_comments_222641.json:
```json
{
    "body": "**Author:** Leif Leonhardy",
    "created_at": "2013-02-27T00:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222641",
    "user": "https://github.com/nexttime"
}
```

**Author:** Leif Leonhardy



---

archive/issue_comments_222642.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-02-27T00:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222642",
    "user": "https://github.com/nexttime"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_222643.json:
```json
{
    "body": "<a id='comment:13'></a>\nThierry, could you give [this preliminary spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg) a try on your Intel Core machine?\n\nEspecially **without** `SAGE_FAT_BINARY=yes`, and `ABI` either unset or set to `32`.\n\n(`SAGE_FAT_BINARY=yes` should also work; you could of course try that as well, but the former is more important / interesting.)\n\nAnd attach the resulting spkg log(s) here...\n\nThanks.\n\n\nP.S.:  If you're going to rebuild Sage or other spkgs depending on it with that, you should copy the spkg into `$SAGE_ROOT/spkg/standard/`.  (You can use `env SAGE_UPGRADING=yes make` after doing so, in order to rebuild all dependent spkgs as well, although this is likely to take quite some time.)",
    "created_at": "2013-02-27T00:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222643",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Thierry, could you give [this preliminary spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg) a try on your Intel Core machine?

Especially **without** `SAGE_FAT_BINARY=yes`, and `ABI` either unset or set to `32`.

(`SAGE_FAT_BINARY=yes` should also work; you could of course try that as well, but the former is more important / interesting.)

And attach the resulting spkg log(s) here...

Thanks.


P.S.:  If you're going to rebuild Sage or other spkgs depending on it with that, you should copy the spkg into `$SAGE_ROOT/spkg/standard/`.  (You can use `env SAGE_UPGRADING=yes make` after doing so, in order to rebuild all dependent spkgs as well, although this is likely to take quite some time.)



---

archive/issue_comments_222644.json:
```json
{
    "body": "Replying to [ticket:14172 leif]:\n> === mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013) ===\n> * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n>   \"Core\" CPUs (expecting ABI to be \"standard\" rather than \"32\", which is\n>   just a symptom).  (Similar for Pentium4 Prescott.)\n>   We currently only patch (the generated) `configure` (after another patch\n>   to it and its source files has been applied), rather than [also]\n>   `aclocal.m4` and `configure.in`.\n\n\n`s/aclocal.m4/acinclude.m4/`",
    "created_at": "2013-02-27T01:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222644",
    "user": "https://github.com/nexttime"
}
```

Replying to [ticket:14172 leif]:
> === mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013) ===
> * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
>   "Core" CPUs (expecting ABI to be "standard" rather than "32", which is
>   just a symptom).  (Similar for Pentium4 Prescott.)
>   We currently only patch (the generated) `configure` (after another patch
>   to it and its source files has been applied), rather than [also]
>   `aclocal.m4` and `configure.in`.


`s/aclocal.m4/acinclude.m4/`



---

archive/issue_comments_222645.json:
```json
{
    "body": "<a id='comment:15'></a>\n[Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)",
    "created_at": "2013-02-27T03:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222645",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>
[Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)



---

archive/issue_comments_222646.json:
```json
{
    "body": "Diff between the `.p1` and the `.p0`.  For reference / review only.",
    "created_at": "2013-02-27T07:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222646",
    "user": "https://github.com/nexttime"
}
```

Diff between the `.p1` and the `.p0`.  For reference / review only.



---

archive/attachments_019128.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "mpir-2.6.0.p0-p1.diff",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/mpir-2.6.0.p0-p1.diff",
    "created_at": "2013-02-27T08:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.diff",
    "user": "https://github.com/nexttime"
}
```



---

archive/issue_comments_222647.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [leif](#comment%3A15):\n> [Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)\n\n\nDone.  Note: [New spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg) also has a new name (`-preliminary` dropped).",
    "created_at": "2013-02-27T08:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222647",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
Replying to [leif](#comment%3A15):
> [Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)


Done.  Note: [New spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg) also has a new name (`-preliminary` dropped).



---

archive/issue_comments_222648.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. Developers acknowledge bug.\" to \"Completely fixed; Fix reported upstream\".",
    "created_at": "2013-02-27T08:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222648",
    "user": "https://github.com/nexttime"
}
```

**Changing upstream** from "Reported upstream. Developers acknowledge bug." to "Completely fixed; Fix reported upstream".



---

archive/issue_comments_222649.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -25,23 +25,20 @@\n \n ---\n \n-**Preliminary new spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg)\n+**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)\n \n-**md5sum:** `e2839d31c41934ceb5fdda4a6399028d  mpir-2.6.0.p1-preliminary.spkg`\n+**md5sum:** `6e65bb989b0e5513371a35447b43b0da  mpir-2.6.0.p1.spkg`\n \n-This currently only patches `configure`, not [in addition] its source files.\n+Now patches `acinclude.m4`, `configure.in`, and `configure`.\n \n-(Changes not yet committed either.)\n+(Changes now committed, and [upstream] patches submitted upstream, too.)\n \n-### mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013)\n+### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)\n * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n   \"Core\" CPUs (expecting ABI to be \"standard\" rather than \"32\", which is\n-  just a symptom).  (Similar for Pentium4 Prescott.)\n-  We currently only patch (the generated) `configure` (after another patch\n-  to it and its source files has been applied), rather than [also]\n-  `aclocal.m4` and `configure.in`.\n-  I'll submit proper patches upstream later.\n+  just one symptom).  (Similar for Pentium4 Prescott.)\n+  Add patch (`core-prescott-configure.patch`) fixing `acinclude.m4`,\n+  `configure.in`, and the generated `configure`, rebased to the patches we\n+  apply in advance.\n+  Patch(es) have been submitted upstream.\n \n-\n-\n-\n``````\n",
    "created_at": "2013-02-27T08:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222649",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -25,23 +25,20 @@
 
 ---
 
-**Preliminary new spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg)
+**New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)
 
-**md5sum:** `e2839d31c41934ceb5fdda4a6399028d  mpir-2.6.0.p1-preliminary.spkg`
+**md5sum:** `6e65bb989b0e5513371a35447b43b0da  mpir-2.6.0.p1.spkg`
 
-This currently only patches `configure`, not [in addition] its source files.
+Now patches `acinclude.m4`, `configure.in`, and `configure`.
 
-(Changes not yet committed either.)
+(Changes now committed, and [upstream] patches submitted upstream, too.)
 
-### mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013)
+### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)
 * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
   "Core" CPUs (expecting ABI to be "standard" rather than "32", which is
-  just a symptom).  (Similar for Pentium4 Prescott.)
-  We currently only patch (the generated) `configure` (after another patch
-  to it and its source files has been applied), rather than [also]
-  `aclocal.m4` and `configure.in`.
-  I'll submit proper patches upstream later.
+  just one symptom).  (Similar for Pentium4 Prescott.)
+  Add patch (`core-prescott-configure.patch`) fixing `acinclude.m4`,
+  `configure.in`, and the generated `configure`, rebased to the patches we
+  apply in advance.
+  Patch(es) have been submitted upstream.
 
-
-
-
``````




---

archive/issue_comments_222650.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,6 +23,24 @@\n \n Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).\n \n+\n+---\n+\n+Just for completeness:  The previous spkg (and of course also vanilla MPIR 2.6.0) failed in exactly the same way when configured on (or with [`MPIR_CONFIGURE=`]`--host=`)`prescott-pc-linux-gnu`:\n+\n+```\n+...\n+using ABI=\"standard\"\n+      CC=\"gcc -std=gnu99\"\n+      CFLAGS=\"-O2\"\n+      CPPFLAGS=\"\"\n+      CXX=\"g++\"\n+      CXXFLAGS=\"-O2\"\n+      MPN_PATH=\"  generic\"\n+```\n+\n+The new spkg also fixes this.\n+\n ---\n \n **New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)\n``````\n",
    "created_at": "2013-02-27T08:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222650",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,6 +23,24 @@
 
 Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).
 
+
+---
+
+Just for completeness:  The previous spkg (and of course also vanilla MPIR 2.6.0) failed in exactly the same way when configured on (or with [`MPIR_CONFIGURE=`]`--host=`)`prescott-pc-linux-gnu`:
+
+```
+...
+using ABI="standard"
+      CC="gcc -std=gnu99"
+      CFLAGS="-O2"
+      CPPFLAGS=""
+      CXX="g++"
+      CXXFLAGS="-O2"
+      MPN_PATH="  generic"
+```
+
+The new spkg also fixes this.
+
 ---
 
 **New spkg:** [http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg)
``````




---

archive/issue_events_046225.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "rename": {
        "from": "mpir-2.6.0.p0 fails to build on Intel \"Core\" CPUs",
        "to": "mpir-2.6.0.p0 fails to build on Intel \"Core\" and Pentium4 Prescott CPUs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14172#event-46225"
}
```



---

archive/issue_comments_222651.json:
```json
{
    "body": "**Changing keywords** from \"mpir spkg ABI standard Intel Core\" to \"mpir spkg ABI standard Intel Core Pentium4 Prescott\".",
    "created_at": "2013-02-27T08:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222651",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "mpir spkg ABI standard Intel Core" to "mpir spkg ABI standard Intel Core Pentium4 Prescott".



---

archive/issue_comments_222652.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -37,6 +37,7 @@\n       CXX=\"g++\"\n       CXXFLAGS=\"-O2\"\n       MPN_PATH=\"  generic\"\n+...\n ```\n \n The new spkg also fixes this.\n``````\n",
    "created_at": "2013-02-27T08:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222652",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -37,6 +37,7 @@
       CXX="g++"
       CXXFLAGS="-O2"
       MPN_PATH="  generic"
+...
 ```
 
 The new spkg also fixes this.
``````




---

archive/issue_comments_222653.json:
```json
{
    "body": "<a id='comment:19'></a>\nHi Leif, i am back in Montpellier and the machine is still in Paris. I will try to find a similar machine here or ask someone to bring it back this week-end.",
    "created_at": "2013-02-27T11:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222653",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:19'></a>
Hi Leif, i am back in Montpellier and the machine is still in Paris. I will try to find a similar machine here or ask someone to bring it back this week-end.



---

archive/issue_comments_222654.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -50,7 +50,7 @@\n \n Now patches `acinclude.m4`, `configure.in`, and `configure`.\n \n-(Changes now committed, and [upstream] patches submitted upstream, too.)\n+(Changes now committed, and [bug report](https://groups.google.com/forum/?fromgroups=#!topic/mpir-devel/TyfWY6Mcm1A) and patches submitted upstream, too.)\n \n ### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)\n * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n``````\n",
    "created_at": "2013-02-27T18:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222654",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -50,7 +50,7 @@
 
 Now patches `acinclude.m4`, `configure.in`, and `configure`.
 
-(Changes now committed, and [upstream] patches submitted upstream, too.)
+(Changes now committed, and [bug report](https://groups.google.com/forum/?fromgroups=#!topic/mpir-devel/TyfWY6Mcm1A) and patches submitted upstream, too.)
 
 ### mpir-2.6.0.p1 (Leif Leonhardy, February 27th 2013)
 * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
``````




---

archive/issue_comments_222655.json:
```json
{
    "body": "<a id='comment:21'></a>\nJust in case you intend to support / fix the use of `SAGE64` on Linux, it would be nice if you based your spkg on this one... ;-)\n\n(And cc me if you open a ticket for that; I'll otherwise probably do so.)",
    "created_at": "2013-02-28T18:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222655",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Just in case you intend to support / fix the use of `SAGE64` on Linux, it would be nice if you based your spkg on this one... ;-)

(And cc me if you open a ticket for that; I'll otherwise probably do so.)



---

archive/attachments_019129.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p0_config.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0_config.log",
    "created_at": "2013-02-28T22:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222656.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222656",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019130.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p0-ABI32_config.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_config.log",
    "created_at": "2013-02-28T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222657.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222657",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019131.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p0-ABI32_mpir-2.6.0.p0.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_mpir-2.6.0.p0.log",
    "created_at": "2013-02-28T22:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222658.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222658",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019132.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p1_mpir-2.6.0.p1.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1_mpir-2.6.0.p1.log",
    "created_at": "2013-02-28T22:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222659.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222659",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019133.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p1-ABI32_config.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_config.log",
    "created_at": "2013-02-28T22:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222660.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222660",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019134.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p1-ABI32_mpir-2.6.0.p1.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_mpir-2.6.0.p1.log",
    "created_at": "2013-02-28T22:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222661.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222661",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019135.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p1-FAT_mpir-2.6.0.p1.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT_mpir-2.6.0.p1.log",
    "created_at": "2013-02-28T22:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222662.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222662",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019136.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "2.6.0.p1-FAT-ABI32_config.log",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT-ABI32_config.log",
    "created_at": "2013-02-28T22:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.log",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222663.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222663",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/attachments_019137.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "config.guess",
    "asset_url": "tarball://root/attachments/some-uuid/ticket14172/config.guess",
    "created_at": "2013-02-28T22:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.guess",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```



---

archive/issue_comments_222664.json:
```json
{
    "body": "",
    "created_at": "2013-02-28T22:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222664",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```





---

archive/issue_comments_222665.json:
```json
{
    "body": "<a id='comment:22'></a>\nHi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.",
    "created_at": "2013-02-28T22:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222665",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:22'></a>
Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.



---

archive/issue_comments_222666.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [tmonteil](#comment%3A22):\n> Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.\n\n\nSo do we have a positive review?",
    "created_at": "2013-03-02T18:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222666",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
Replying to [tmonteil](#comment%3A22):
> Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.


So do we have a positive review?



---

archive/issue_comments_222667.json:
```json
{
    "body": "**Reviewer:** Thierry Monteil, ...",
    "created_at": "2013-03-05T20:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222667",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Reviewer:** Thierry Monteil, ...



---

archive/issue_comments_222668.json:
```json
{
    "body": "<a id='comment:24'></a>\nAll tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.",
    "created_at": "2013-03-05T20:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222668",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:24'></a>
All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.



---

archive/issue_comments_222669.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [tmonteil](#comment%3A24):\n> All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.\n\n\nPing...\n\n(Yesterday again someone reported running into this on sage-release.)",
    "created_at": "2013-03-27T12:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222669",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:25'></a>
Replying to [tmonteil](#comment%3A24):
> All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.


Ping...

(Yesterday again someone reported running into this on sage-release.)



---

archive/issue_comments_222670.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-03-27T12:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222670",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_222671.json:
```json
{
    "body": "<a id='comment:26'></a>\nLooks fine and build on a my (non problematic) system.\n\nJust a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.",
    "created_at": "2013-03-27T12:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222671",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:26'></a>
Looks fine and build on a my (non problematic) system.

Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.



---

archive/issue_comments_222672.json:
```json
{
    "body": "**Changing reviewer** from \"Thierry Monteil, ...\" to \"Thierry Monteil, Jean-Pierre Flori\".",
    "created_at": "2013-03-27T12:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222672",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing reviewer** from "Thierry Monteil, ..." to "Thierry Monteil, Jean-Pierre Flori".



---

archive/issue_comments_222673.json:
```json
{
    "body": "<a id='comment:27'></a>\nThanks for the review.\n\nReplying to [jpflori](#comment%3A26):\n> Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.\n\n\nI prefer tagging the changesets myself (and I'd appreciate if others did as well -- some do); doing so makes it easier to base spkgs on previous ones which haven't been merged yet (otherwise tags may even be missing).\n\nThe merger script shouldn't do anything with spkgs unless necessary, i.e., it should only perform sanity checks, and in case some of these fail, automagically modify the spkg if appropriate (which includes adding a missing revision tag).",
    "created_at": "2013-03-27T13:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222673",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>
Thanks for the review.

Replying to [jpflori](#comment%3A26):
> Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.


I prefer tagging the changesets myself (and I'd appreciate if others did as well -- some do); doing so makes it easier to base spkgs on previous ones which haven't been merged yet (otherwise tags may even be missing).

The merger script shouldn't do anything with spkgs unless necessary, i.e., it should only perform sanity checks, and in case some of these fail, automagically modify the spkg if appropriate (which includes adding a missing revision tag).



---

archive/issue_comments_222674.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-03-28T17:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222674",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed



---

archive/issue_comments_222675.json:
```json
{
    "body": "**Merged:** sage-5.9.beta2",
    "created_at": "2013-03-28T17:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222675",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.9.beta2



---

archive/issue_events_046226.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-28T17:59:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14172#event-46226"
}
```



---

archive/issue_comments_222676.json:
```json
{
    "body": "**Changing keywords** from \"mpir spkg ABI standard Intel Core Pentium4 Prescott\" to \"mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl\".",
    "created_at": "2019-08-27T19:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14172#issuecomment-222676",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing keywords** from "mpir spkg ABI standard Intel Core Pentium4 Prescott" to "mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl".
