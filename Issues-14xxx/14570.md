# Issue 14570: Cythonize Sage library out of tree

archive/issues_014366.json:
```json
{
    "assignees": [],
    "body": "Nice for at least two reasons:\n\n1. Can grep through source code and not pick up any matches from autogenerated c files\n2. (mostly for git) Don't have to have all c/cpp files ignored by revision control\n\nApply:\n* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz))\n* [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library\n\nDepends on #14569\n\nAssignee: **GeorgSWeber**\n\nCC:  @nexttime @robertwb @jdemeyer\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **R. Andrew Ohana**\n\nMerged: **sage-5.10.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14570_\n\n",
    "closed_at": "2013-05-19T10:42:45Z",
    "created_at": "2013-05-12T06:27:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Cythonize Sage library out of tree",
    "type": "issue",
    "updated_at": "2013-06-16T09:09:50Z",
    "url": "https://github.com/sagemath/sage/issues/14570",
    "user": "https://github.com/ohanar"
}
```
Nice for at least two reasons:

1. Can grep through source code and not pick up any matches from autogenerated c files
2. (mostly for git) Don't have to have all c/cpp files ignored by revision control

Apply:
* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz))
* [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library

Depends on #14569

Assignee: **GeorgSWeber**

CC:  @nexttime @robertwb @jdemeyer

Reviewer: **Jeroen Demeyer**

Author: **R. Andrew Ohana**

Merged: **sage-5.10.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/14570_





---

archive/issue_events_182657.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:27:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "milestone_number": null,
    "milestone_title": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182657"
}
```



---

archive/issue_events_182658.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:27:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182658"
}
```



---

archive/issue_events_182659.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:27:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182659"
}
```



---

archive/issue_events_182660.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:27:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182660"
}
```



---

archive/issue_events_182661.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:28:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "title_is": "Cythonize Sage library out of tree",
    "title_was": "cythonize out of tree",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182661"
}
```



---

archive/issue_events_182662.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2013-05-12T06:42:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182662"
}
```



---

archive/issue_comments_179002.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,7 @@\n \n 1. Can grep through source code and not pick up any matches from autogenerated c files\n 2. (mostly for git) Don't have to have all c/cpp files ignored by revision control\n+\n+Apply:\n+* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.diff.gz))\n+* [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library\n``````\n",
    "created_at": "2013-05-12T06:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179002",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,7 @@
 
 1. Can grep through source code and not pick up any matches from autogenerated c files
 2. (mostly for git) Don't have to have all c/cpp files ignored by revision control
+
+Apply:
+* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.diff.gz))
+* [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library
``````




---

archive/issue_comments_179003.json:
```json
{
    "body": "Attachment: **[cython-0.19.1.p0.diff.gz](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz)**\n\nspkg diff",
    "created_at": "2013-05-12T06:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179003",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[cython-0.19.1.p0.diff.gz](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz)**

spkg diff



---

archive/issue_comments_179004.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,5 +4,5 @@\n 2. (mostly for git) Don't have to have all c/cpp files ignored by revision control\n \n Apply:\n-* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.diff.gz))\n+* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz))\n * [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library\n``````\n",
    "created_at": "2013-05-15T10:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179004",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,5 +4,5 @@
 2. (mostly for git) Don't have to have all c/cpp files ignored by revision control
 
 Apply:
-* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.diff.gz))
+* new SPKG: http://boxen.math.washington.edu/home/ohanar/spkgs/cython-0.19.1.p0.spkg ([spkg diff](https://github.com/sagemath/sage/files/ticket14570/cython-0.19.1.p0.diff.gz))
 * [attachment: trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz) to sage library
``````




---

archive/issue_comments_179005.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nDoesn't\n\n```\ncdef extern from *:\n```\nwork instead of \"empty.h\"?",
    "created_at": "2013-05-15T10:41:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179005",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'>Comment 4:</a>
Doesn't

```
cdef extern from *:
```
work instead of "empty.h"?



---

archive/issue_comments_179006.json:
```json
{
    "body": "apply to sage library",
    "created_at": "2013-05-15T22:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179006",
    "user": "https://github.com/ohanar"
}
```

apply to sage library



---

archive/issue_comments_179007.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nAttachment: **[trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz)**\n\nyup, new patch does that instead",
    "created_at": "2013-05-15T22:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179007",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:5'>Comment 5:</a>
Attachment: **[trac14570.patch.gz](https://github.com/sagemath/sage/files/ticket14570/trac14570.patch.gz)**

yup, new patch does that instead



---

archive/issue_comments_179008.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nWhy are some `c_lib` header files copied to `build/cythonized/c_lib`, is that supposed to be? I'm not saying it is a bad thing, I am just trying to understand what is happening.\n\n```\nbuildbot@sage sage$ ls -l devel/sage/build/cythonized/c_lib/include/\ntotal 74k\n4.1k -rw-r--r-- 2 buildbot buildbot  254 2013-05-16 23:52 convert.h\n4.1k -rw-r--r-- 2 buildbot buildbot 3.8k 2013-05-16 23:52 ginac_wrap.h\n4.1k -rw-r--r-- 2 buildbot buildbot  545 2013-05-16 23:52 gmp_globals.h\n 17k -rw-r--r-- 2 buildbot buildbot  15k 2013-05-16 23:52 interrupt.h\n4.1k -rw-r--r-- 2 buildbot buildbot  128 2013-05-16 23:52 mpz_longlong.h\n4.1k -rw-r--r-- 2 buildbot buildbot  380 2013-05-16 23:52 mpz_pylong.h\n 17k -rw-r--r-- 2 buildbot buildbot  13k 2013-05-16 23:52 ntl_wrap.h\n8.2k -rw-r--r-- 2 buildbot buildbot 6.1k 2013-05-16 23:52 pb_wrap.h\n8.2k -rw-r--r-- 2 buildbot buildbot 5.2k 2013-05-16 23:52 stdsage.h\n4.1k -rw-r--r-- 2 buildbot buildbot 1.2k 2013-05-16 23:52 ZZ_pylong.h\n```",
    "created_at": "2013-05-17T08:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179008",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'>Comment 6:</a>
Why are some `c_lib` header files copied to `build/cythonized/c_lib`, is that supposed to be? I'm not saying it is a bad thing, I am just trying to understand what is happening.

```
buildbot@sage sage$ ls -l devel/sage/build/cythonized/c_lib/include/
total 74k
4.1k -rw-r--r-- 2 buildbot buildbot  254 2013-05-16 23:52 convert.h
4.1k -rw-r--r-- 2 buildbot buildbot 3.8k 2013-05-16 23:52 ginac_wrap.h
4.1k -rw-r--r-- 2 buildbot buildbot  545 2013-05-16 23:52 gmp_globals.h
 17k -rw-r--r-- 2 buildbot buildbot  15k 2013-05-16 23:52 interrupt.h
4.1k -rw-r--r-- 2 buildbot buildbot  128 2013-05-16 23:52 mpz_longlong.h
4.1k -rw-r--r-- 2 buildbot buildbot  380 2013-05-16 23:52 mpz_pylong.h
 17k -rw-r--r-- 2 buildbot buildbot  13k 2013-05-16 23:52 ntl_wrap.h
8.2k -rw-r--r-- 2 buildbot buildbot 6.1k 2013-05-16 23:52 pb_wrap.h
8.2k -rw-r--r-- 2 buildbot buildbot 5.2k 2013-05-16 23:52 stdsage.h
4.1k -rw-r--r-- 2 buildbot buildbot 1.2k 2013-05-16 23:52 ZZ_pylong.h
```



---

archive/issue_comments_179009.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nEvery file that is in `SAGE_SRC` that is detected as a dependency or source file for an extension module will be copied to `SAGE_SRC/build/cythonized` (this is to make sure that including with relative paths still works). Since `SAGE_LOCAL/include/csage` is symlinked to a subdirectory of `SAGE_SRC`, these particular files appear. They won't actually be used during compilation since these files were never included using a relative path (at least as far as I'm aware).",
    "created_at": "2013-05-17T09:23:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179009",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:7'>Comment 7:</a>
Every file that is in `SAGE_SRC` that is detected as a dependency or source file for an extension module will be copied to `SAGE_SRC/build/cythonized` (this is to make sure that including with relative paths still works). Since `SAGE_LOCAL/include/csage` is symlinked to a subdirectory of `SAGE_SRC`, these particular files appear. They won't actually be used during compilation since these files were never included using a relative path (at least as far as I'm aware).



---

archive/issue_comments_179010.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2013-05-19T10:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179010",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_182663.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-19T10:42:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182663"
}
```



---

archive/issue_events_182664.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-19T10:42:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14570#event-182664"
}
```



---

archive/issue_comments_179011.json:
```json
{
    "body": "Merged: **sage-5.10.beta4**",
    "created_at": "2013-05-19T10:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179011",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.10.beta4**



---

archive/issue_comments_179012.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nOh, boys...\n\nThis completely breaks `sage -sync-build`! >8O",
    "created_at": "2013-05-31T04:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179012",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'>Comment 9:</a>
Oh, boys...

This completely breaks `sage -sync-build`! >8O



---

archive/issue_comments_179013.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nWe should probably wait with this feature until Cython supports a true `VPATH`, or at least symlinks the source files instead of copying all of them.\n\nP.S.: GNU `grep` supports inclusion / exclusion of files / dirs /  filename patterns, to be specified on the command line or taken from a file (similar to `tar`).  And (probably dynamically) generating `.gitignore` files shouldn't be too hard either.",
    "created_at": "2013-06-01T14:01:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179013",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'>Comment 10:</a>
We should probably wait with this feature until Cython supports a true `VPATH`, or at least symlinks the source files instead of copying all of them.

P.S.: GNU `grep` supports inclusion / exclusion of files / dirs /  filename patterns, to be specified on the command line or taken from a file (similar to `tar`).  And (probably dynamically) generating `.gitignore` files shouldn't be too hard either.



---

archive/issue_comments_179014.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReverting this patch in #14721.",
    "created_at": "2013-06-11T19:56:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179014",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'>Comment 11:</a>
Reverting this patch in #14721.



---

archive/issue_comments_179015.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\ngnu autotools has VPATH support. it should be implemented with the usual interface, not with ad-hoc hacks.\n\nonce sage (the distribution) is configurable (im working on it...) it will be extemely convenient to be able to have differently configured sage builds without complicating/breaking the internal sage build logic even more.\n\nif the cythonize doesnt support VPATH cleanly (yet?) use autotools for the build. it's much simpler, straightforward, faster and well designed. no need to reinvent the wheel.",
    "created_at": "2013-06-12T07:33:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179015",
    "user": "https://github.com/sagetrac-felixs"
}
```

<a id='comment:12'>Comment 12:</a>
gnu autotools has VPATH support. it should be implemented with the usual interface, not with ad-hoc hacks.

once sage (the distribution) is configurable (im working on it...) it will be extemely convenient to be able to have differently configured sage builds without complicating/breaking the internal sage build logic even more.

if the cythonize doesnt support VPATH cleanly (yet?) use autotools for the build. it's much simpler, straightforward, faster and well designed. no need to reinvent the wheel.



---

archive/issue_comments_179016.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [felixs](#comment%3A12):\n> gnu autotools has VPATH support. it should be implemented with the usual interface, not with ad-hoc hacks.\n> \n> once sage (the distribution) is configurable (im working on it...) it will be extemely convenient to be able to have differently configured sage builds without complicating/breaking the internal sage build logic even more.\n> \n> if the cythonize doesnt support VPATH cleanly (yet?) use autotools for the build. it's much simpler, straightforward, faster and well designed. no need to reinvent the wheel.\n\nThis kind of feedback should really be directed to Cython upstream. If somebody is reinventing the wheel here, it's Cython, not Sage.",
    "created_at": "2013-06-12T09:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179016",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [felixs](#comment%3A12):
> gnu autotools has VPATH support. it should be implemented with the usual interface, not with ad-hoc hacks.
> 
> once sage (the distribution) is configurable (im working on it...) it will be extemely convenient to be able to have differently configured sage builds without complicating/breaking the internal sage build logic even more.
> 
> if the cythonize doesnt support VPATH cleanly (yet?) use autotools for the build. it's much simpler, straightforward, faster and well designed. no need to reinvent the wheel.

This kind of feedback should really be directed to Cython upstream. If somebody is reinventing the wheel here, it's Cython, not Sage.



---

archive/issue_comments_179017.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nAlso note that Python doesn't use `automake` either. So what you ask might not easily be doable.",
    "created_at": "2013-06-12T09:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179017",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>Comment 14:</a>
Also note that Python doesn't use `automake` either. So what you ask might not easily be doable.



---

archive/issue_comments_179018.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@jdemeyer](#comment%3A13):\n> This kind of feedback should really be directed to Cython upstream. If somebody is reinventing the wheel here, it's Cython, not Sage. \n\nThe build system choice is clearly on the sage side. Just because the\n\"build system\" that cython provides lacks functionality, doesn't mean\nthat I expect them to fix it.\n\nReplying to [@jdemeyer](#comment%3A14):\n> Also note that Python doesn't use `automake` either. \n\nWhat are you trying to say (I dont want python to use automake.)?\n\nDo you agree that\n- Sage is built mostly by cython and gcc,\n- gcc does not use distutils and\n- Sage is not python?\n\n> So what you ask might not easily be doable.\n\nI am not asking for anything. Its just a proposal on how to fix it.\n\nMost things are implemented and ready-to-use within autotools, much more\nthan distutils can ever dream of. Currently, just cython build rules\nneed to be added manually (and are supported like any other custom build\nrules). native support for pyx->c->so within autotools is just a\nquestion of time.\n\nNote that one alternative would be autogenerating setup.py and\nmodule_list.py from templates with autoconf (yes, autoconf implements\nthe checks we need). I doubt that this can either be as functional nor\nmaintainable as a clean-room autotools-based implementation...\n\nAnd yes, it's doable with autotools. Any better ideas?",
    "created_at": "2013-06-15T15:53:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179018",
    "user": "https://github.com/sagetrac-felixs"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@jdemeyer](#comment%3A13):
> This kind of feedback should really be directed to Cython upstream. If somebody is reinventing the wheel here, it's Cython, not Sage. 

The build system choice is clearly on the sage side. Just because the
"build system" that cython provides lacks functionality, doesn't mean
that I expect them to fix it.

Replying to [@jdemeyer](#comment%3A14):
> Also note that Python doesn't use `automake` either. 

What are you trying to say (I dont want python to use automake.)?

Do you agree that
- Sage is built mostly by cython and gcc,
- gcc does not use distutils and
- Sage is not python?

> So what you ask might not easily be doable.

I am not asking for anything. Its just a proposal on how to fix it.

Most things are implemented and ready-to-use within autotools, much more
than distutils can ever dream of. Currently, just cython build rules
need to be added manually (and are supported like any other custom build
rules). native support for pyx->c->so within autotools is just a
question of time.

Note that one alternative would be autogenerating setup.py and
module_list.py from templates with autoconf (yes, autoconf implements
the checks we need). I doubt that this can either be as functional nor
maintainable as a clean-room autotools-based implementation...

And yes, it's doable with autotools. Any better ideas?



---

archive/issue_comments_179019.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [felixs](#comment%3A15):\n> The build system choice is clearly on the sage side. Just because the \"build system\" that cython provides lacks functionality, doesn't mean that I expect them to fix it. \n\nSage uses Cython's `cythonize()` as build system. There is Cython-the-compiler and `cythonize+distutils`-the-build-system.\n\n> Do you agree that\n> - Sage is built mostly by cython and gcc,\n\nFor different meanings of \"built by\": yes.",
    "created_at": "2013-06-16T09:03:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179019",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [felixs](#comment%3A15):
> The build system choice is clearly on the sage side. Just because the "build system" that cython provides lacks functionality, doesn't mean that I expect them to fix it. 

Sage uses Cython's `cythonize()` as build system. There is Cython-the-compiler and `cythonize+distutils`-the-build-system.

> Do you agree that
> - Sage is built mostly by cython and gcc,

For different meanings of "built by": yes.



---

archive/issue_comments_179020.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [felixs](#comment%3A15):\n> Most things are implemented and ready-to-use within autotools\n\nReally, does autotools support Cython dependency checking?",
    "created_at": "2013-06-16T09:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179020",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [felixs](#comment%3A15):
> Most things are implemented and ready-to-use within autotools

Really, does autotools support Cython dependency checking?



---

archive/issue_comments_179021.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@jdemeyer](#comment%3A17):\n> Really, does autotools support Cython dependency checking?\n\nThats a question of wheter cython supports writing out dependencies. See #14728 for a patch.",
    "created_at": "2013-06-16T09:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14570#issuecomment-179021",
    "user": "https://github.com/sagetrac-felixs"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@jdemeyer](#comment%3A17):
> Really, does autotools support Cython dependency checking?

Thats a question of wheter cython supports writing out dependencies. See #14728 for a patch.
