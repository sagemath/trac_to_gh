# Issue 14890: rounding in logs

archive/issues_014686.json:
```json
{
    "assignees": [
        "https://github.com/aghitza"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nLogarithms are not rounded correctly:\n\n```\nsage: (3.0^5).log(3.0) - 5.0\n-8.88178419700125e-16\n```\n\nComponent: **basic arithmetic**\n\nKeywords: **logarithm mpfr rounding**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14890_\n\n",
    "closed_at": "2014-08-29T18:33:03Z",
    "created_at": "2013-07-14T17:26:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "rounding in logs",
    "type": "issue",
    "updated_at": "2014-08-29T18:33:03Z",
    "url": "https://github.com/sagemath/sage/issues/14890",
    "user": "https://github.com/sagetrac-amy"
}
```
<div id="comment:0"></div>

Logarithms are not rounded correctly:

```
sage: (3.0^5).log(3.0) - 5.0
-8.88178419700125e-16
```

Component: **basic arithmetic**

Keywords: **logarithm mpfr rounding**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/14890_





---

archive/issue_events_209795.json:
```json
{
    "actor": "https://github.com/sagetrac-amy",
    "created_at": "2013-07-14T17:26:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209795"
}
```



---

archive/issue_events_209796.json:
```json
{
    "actor": "https://github.com/sagetrac-amy",
    "created_at": "2013-07-14T17:26:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209796"
}
```



---

archive/issue_events_209797.json:
```json
{
    "actor": "https://github.com/sagetrac-amy",
    "created_at": "2013-07-14T17:26:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209797"
}
```



---

archive/issue_events_209798.json:
```json
{
    "actor": "https://github.com/sagetrac-amy",
    "created_at": "2013-07-14T17:26:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209798"
}
```



---

archive/issue_events_209799.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2013-07-14T17:26:14Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "subject": "https://github.com/sagetrac-amy",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209799"
}
```



---

archive/issue_comments_182561.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nauthor is for the author of the patch :)  This is probably typical floating point stuff, not sure how easy it would be to fix.",
    "created_at": "2013-07-15T01:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182561",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:1" align="right">comment:1</div>

author is for the author of the patch :)  This is probably typical floating point stuff, not sure how easy it would be to fix.



---

archive/issue_comments_182562.json:
```json
{
    "body": "Changed author from **Amy Feaver, Anne Ho** to none",
    "created_at": "2013-07-15T01:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182562",
    "user": "https://github.com/kcrisman"
}
```

Changed author from **Amy Feaver, Anne Ho** to none



---

archive/issue_events_209800.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209800"
}
```



---

archive/issue_events_209801.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209801"
}
```



---

archive/issue_events_209802.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209802"
}
```



---

archive/issue_events_209803.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209803"
}
```



---

archive/issue_events_209804.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-27T10:37:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209804"
}
```



---

archive/issue_events_209805.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-27T10:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209805"
}
```



---

archive/issue_comments_182563.json:
```json
{
    "body": "Changed keywords from **logarithms** to **logarithm mpfr rounding**",
    "created_at": "2014-06-27T10:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182563",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **logarithms** to **logarithm mpfr rounding**



---

archive/issue_events_209806.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2014-06-27T10:37:58Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209806"
}
```



---

archive/issue_events_209807.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2014-06-27T10:37:58Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209807"
}
```



---

archive/issue_comments_182564.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,22 +1,6 @@\n-Logarithms seem to evaluate numbers differently, depending on type. This causes some precision errors when using numbers which can be coerced into integers. For example, if we use integers and evaluate something of the form log_b(b^k) the answer is what it should be:\n+Logarithms are not rounded correctly:\n \n ```\n-sage: log(3^5,3)==5\n-True\n+sage: (3.0^5).log(3.0) - 5.0\n+-8.88178419700125e-16\n ```\n-\n-However, if we use reals which can be coerced into integers, the answer is rounded and slightly off:\n-\n-```\n-sage: log(3.0^5,3.0)==5\n-False\n-```\n-\n-This problem doesn't always happen, for example if we replace the 5 with 12:\n-\n-```\n-sage: log(3.0^12,3.0)==12\n-True\n-```\n-\n-This only seems to be happening for some exponents; in base 3, we found that this sort of expression evaluates to False for exponents equal to 5, 13 and 17, but it does not happen for numbers in between.\n``````\n",
    "created_at": "2014-06-27T10:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182564",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,22 +1,6 @@
-Logarithms seem to evaluate numbers differently, depending on type. This causes some precision errors when using numbers which can be coerced into integers. For example, if we use integers and evaluate something of the form log_b(b^k) the answer is what it should be:
+Logarithms are not rounded correctly:
 
 ```
-sage: log(3^5,3)==5
-True
+sage: (3.0^5).log(3.0) - 5.0
+-8.88178419700125e-16
 ```
-
-However, if we use reals which can be coerced into integers, the answer is rounded and slightly off:
-
-```
-sage: log(3.0^5,3.0)==5
-False
-```
-
-This problem doesn't always happen, for example if we replace the 5 with 12:
-
-```
-sage: log(3.0^12,3.0)==12
-True
-```
-
-This only seems to be happening for some exponents; in base 3, we found that this sort of expression evaluates to False for exponents equal to 5, 13 and 17, but it does not happen for numbers in between.
``````




---

archive/issue_events_209808.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209808"
}
```



---

archive/issue_events_209809.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209809"
}
```



---

archive/issue_comments_182565.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSage is not the place to implement this. If you really need this, it should be implemented in MPFR, then Sage can interface it.\n\nClose as \"wontfix\".",
    "created_at": "2014-08-29T16:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182565",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Sage is not the place to implement this. If you really need this, it should be implemented in MPFR, then Sage can interface it.

Close as "wontfix".



---

archive/issue_events_209810.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-29T16:11:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209810"
}
```



---

archive/issue_events_209811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-29T16:11:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209811"
}
```



---

archive/issue_comments_182566.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-08-29T16:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14890#issuecomment-182566",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_209812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-29T16:11:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209812"
}
```



---

archive/issue_events_209813.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-29T16:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209813"
}
```



---

archive/issue_events_209814.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-29T18:33:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209814"
}
```



---

archive/issue_events_209815.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-29T18:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "c6c6c6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209815"
}
```



---

archive/issue_events_209816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-29T18:33:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209816"
}
```



---

archive/issue_events_209817.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-29T18:33:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14890",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14890#event-209817"
}
```
