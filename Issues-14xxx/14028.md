# Issue 14028: Fix "except:" statements

archive/issues_013824.json:
```json
{
    "body": "Replace\n\n```\nexcept:\n```\nby\n\n```\nexcept StandardError:\n```\n(or an other exception where it makes sense)\n\nAlso fix some dubious `except KeyboardInterrupt` which caused for example\n\n```\nInterrupting Gap...\nTraceback (most recent call last):\n  File \"/home/jdemeyer/slow5.py\", line 11, in <module>\n    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print \"Time: CPU %.2f s, Wall: %.2f s\"%(misc.cputime(__time__), misc.walltime(__wall__))\n  File \"/home/jdemeyer/slow5.py\", line 9, in test\n    assert G.order() == Gamma(n).index() / g.index()\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 415, in order\n    return self.cardinality()\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 398, in cardinality\n    g = self._gap_()\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 228, in _gap_\n    raise NotImplementedError, \"Matrix group over %s not implemented.\"%self.__R\nNotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.\n```\nor\n\n```\nInterrupting Gap...\nTraceback (most recent call last):\n  File \"/home/jdemeyer/slow5.py\", line 11, in <module>\n    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print \"Time: CPU %.2f s, Wall: %.2f s\"%(misc.cputime(__time__), misc.walltime(__wall__))\n  File \"/home/jdemeyer/slow5.py\", line 9, in test\n    assert G.order() == Gamma(n).index() / g.index()\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 415, in order\n    return self.cardinality()\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 400, in cardinality\n    return integer.Integer(gap(self).Size())\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 590, in __call__\n    return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/gap.py\", line 899, in function_call\n    return self.new('last')\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 266, in new\n    return self(code)\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 201, in __call__\n    return cls(self, x, name=name)\n  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 1285, in __init__\n    raise TypeError, x\nTypeError: Ctrl-c pressed while running Gap\n```\n(note the `TypeError`!)\n\nAssignee: @jasongrout\n\nReviewer: Volker Braun\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.7.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14028\n\n",
    "closed_at": "2013-01-31T09:19:33Z",
    "created_at": "2013-01-28T14:25:25Z",
    "labels": [
        "component: misc",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Fix \"except:\" statements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14028",
    "user": "https://github.com/jdemeyer"
}
```
Replace

```
except:
```
by

```
except StandardError:
```
(or an other exception where it makes sense)

Also fix some dubious `except KeyboardInterrupt` which caused for example

```
Interrupting Gap...
Traceback (most recent call last):
  File "/home/jdemeyer/slow5.py", line 11, in <module>
    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print "Time: CPU %.2f s, Wall: %.2f s"%(misc.cputime(__time__), misc.walltime(__wall__))
  File "/home/jdemeyer/slow5.py", line 9, in test
    assert G.order() == Gamma(n).index() / g.index()
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 415, in order
    return self.cardinality()
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 398, in cardinality
    g = self._gap_()
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 228, in _gap_
    raise NotImplementedError, "Matrix group over %s not implemented."%self.__R
NotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.
```
or

```
Interrupting Gap...
Traceback (most recent call last):
  File "/home/jdemeyer/slow5.py", line 11, in <module>
    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print "Time: CPU %.2f s, Wall: %.2f s"%(misc.cputime(__time__), misc.walltime(__wall__))
  File "/home/jdemeyer/slow5.py", line 9, in test
    assert G.order() == Gamma(n).index() / g.index()
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 415, in order
    return self.cardinality()
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 400, in cardinality
    return integer.Integer(gap(self).Size())
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 590, in __call__
    return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/gap.py", line 899, in function_call
    return self.new('last')
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 266, in new
    return self(code)
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 201, in __call__
    return cls(self, x, name=name)
  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 1285, in __init__
    raise TypeError, x
TypeError: Ctrl-c pressed while running Gap
```
(note the `TypeError`!)

Assignee: @jasongrout

Reviewer: Volker Braun

Author: Jeroen Demeyer

Merged: sage-5.7.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14028





---

archive/issue_comments_214316.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,4 @@\n ```\n except StandardError:\n ```\n+(or an other exception where it makes sense)\n``````\n",
    "created_at": "2013-01-28T14:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214316",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,4 @@
 ```
 except StandardError:
 ```
+(or an other exception where it makes sense)
``````




---

archive/issue_comments_214317.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,21 @@\n except StandardError:\n ```\n (or an other exception where it makes sense)\n+\n+Also fix some dubious `except KeyboardInterrupt` which caused for example\n+\n+```\n+Interrupting Gap...\n+Traceback (most recent call last):\n+  File \"/home/jdemeyer/slow5.py\", line 11, in <module>\n+    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print \"Time: CPU %.2f s, Wall: %.2f s\"%(misc.cputime(__time__), misc.walltime(__wall__))\n+  File \"/home/jdemeyer/slow5.py\", line 9, in test\n+    assert G.order() == Gamma(n).index() / g.index()\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 415, in order\n+    return self.cardinality()\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 398, in cardinality\n+    g = self._gap_()\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 228, in _gap_\n+    raise NotImplementedError, \"Matrix group over %s not implemented.\"%self.__R\n+NotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.\n+```\n``````\n",
    "created_at": "2013-01-28T14:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214317",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,21 @@
 except StandardError:
 ```
 (or an other exception where it makes sense)
+
+Also fix some dubious `except KeyboardInterrupt` which caused for example
+
+```
+Interrupting Gap...
+Traceback (most recent call last):
+  File "/home/jdemeyer/slow5.py", line 11, in <module>
+    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print "Time: CPU %.2f s, Wall: %.2f s"%(misc.cputime(__time__), misc.walltime(__wall__))
+  File "/home/jdemeyer/slow5.py", line 9, in test
+    assert G.order() == Gamma(n).index() / g.index()
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 415, in order
+    return self.cardinality()
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 398, in cardinality
+    g = self._gap_()
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 228, in _gap_
+    raise NotImplementedError, "Matrix group over %s not implemented."%self.__R
+NotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.
+```
``````




---

archive/issue_comments_214318.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,3 +27,29 @@\n     raise NotImplementedError, \"Matrix group over %s not implemented.\"%self.__R\n NotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.\n ```\n+or\n+\n+```\n+Interrupting Gap...\n+Traceback (most recent call last):\n+  File \"/home/jdemeyer/slow5.py\", line 11, in <module>\n+    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print \"Time: CPU %.2f s, Wall: %.2f s\"%(misc.cputime(__time__), misc.walltime(__wall__))\n+  File \"/home/jdemeyer/slow5.py\", line 9, in test\n+    assert G.order() == Gamma(n).index() / g.index()\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 415, in order\n+    return self.cardinality()\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 400, in cardinality\n+    return integer.Integer(gap(self).Size())\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 590, in __call__\n+    return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/gap.py\", line 899, in function_call\n+    return self.new('last')\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 266, in new\n+    return self(code)\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 201, in __call__\n+    return cls(self, x, name=name)\n+  File \"/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 1285, in __init__\n+    raise TypeError, x\n+TypeError: Ctrl-c pressed while running Gap\n+```\n+(note the `TypeError`!)\n``````\n",
    "created_at": "2013-01-28T14:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214318",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,3 +27,29 @@
     raise NotImplementedError, "Matrix group over %s not implemented."%self.__R
 NotImplementedError: Matrix group over Ring of integers modulo 2 not implemented.
 ```
+or
+
+```
+Interrupting Gap...
+Traceback (most recent call last):
+  File "/home/jdemeyer/slow5.py", line 11, in <module>
+    __time__=misc.cputime(); __wall__=misc.walltime(); test(); print "Time: CPU %.2f s, Wall: %.2f s"%(misc.cputime(__time__), misc.walltime(__wall__))
+  File "/home/jdemeyer/slow5.py", line 9, in test
+    assert G.order() == Gamma(n).index() / g.index()
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 415, in order
+    return self.cardinality()
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/groups/matrix_gps/matrix_group.py", line 400, in cardinality
+    return integer.Integer(gap(self).Size())
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 590, in __call__
+    return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/gap.py", line 899, in function_call
+    return self.new('last')
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 266, in new
+    return self(code)
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 201, in __call__
+    return cls(self, x, name=name)
+  File "/usr/local/src/sage-5.7.beta1/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 1285, in __init__
+    raise TypeError, x
+TypeError: Ctrl-c pressed while running Gap
+```
+(note the `TypeError`!)
``````




---

archive/issue_comments_214319.json:
```json
{
    "body": "<a id='comment:4'></a>Its pretty much a no-brainer. Ready for review?",
    "created_at": "2013-01-28T17:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214319",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>Its pretty much a no-brainer. Ready for review?



---

archive/issue_comments_214320.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 vbraun]:\n> Its pretty much a no-brainer. Ready for review?\n\nNot sure.  The following is fairly reproducible when interrupting GAP:\n\n```\nInterrupting Gap...\nException RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored\nException RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored\nException RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored\n[...ad infinitum...]\n```\nThe backtrace at this point (thanks to #14029) is attached.",
    "created_at": "2013-01-28T20:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214320",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Replying to [comment:4 vbraun]:
> Its pretty much a no-brainer. Ready for review?

Not sure.  The following is fairly reproducible when interrupting GAP:

```
Interrupting Gap...
Exception RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored
Exception RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored
Exception RuntimeError: RuntimeError('maximum recursion depth exceeded while calling a Python object',) in  ignored
[...ad infinitum...]
```
The backtrace at this point (thanks to #14029) is attached.



---

archive/issue_comments_214321.json:
```json
{
    "body": "Attachment [sage_crash_IAI1or.log](tarball://root/attachments/some-uuid/ticket14028/sage_crash_IAI1or.log) by @jdemeyer created at 2013-01-28 20:34:05",
    "created_at": "2013-01-28T20:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214321",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [sage_crash_IAI1or.log](tarball://root/attachments/some-uuid/ticket14028/sage_crash_IAI1or.log) by @jdemeyer created at 2013-01-28 20:34:05



---

archive/issue_comments_214322.json:
```json
{
    "body": "<a id='comment:6'></a>The problem was removing the statement\n\n```\nself._session_number = -1\n```\n\nNew patch attached which should fix this.  I also changed a few more instances of\n\n```\nexcept StandardError:\n```\nto\n\n```\nexcept BaseException:\n```\nin cases where the except-clause was doing cleanup + re-raise.",
    "created_at": "2013-01-29T11:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214322",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>The problem was removing the statement

```
self._session_number = -1
```

New patch attached which should fix this.  I also changed a few more instances of

```
except StandardError:
```
to

```
except BaseException:
```
in cases where the except-clause was doing cleanup + re-raise.



---

archive/issue_comments_214323.json:
```json
{
    "body": "Attachment [14028_bare_except.patch](tarball://root/attachments/some-uuid/ticket14028/14028_bare_except.patch) by @jdemeyer created at 2013-01-29 11:33:27",
    "created_at": "2013-01-29T11:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214323",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14028_bare_except.patch](tarball://root/attachments/some-uuid/ticket14028/14028_bare_except.patch) by @jdemeyer created at 2013-01-29 11:33:27



---

archive/issue_comments_214324.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-29T13:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214324",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214325.json:
```json
{
    "body": "<a id='comment:7'></a>Passes all long doctests, so ready for review.",
    "created_at": "2013-01-29T13:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214325",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>Passes all long doctests, so ready for review.



---

archive/issue_comments_214326.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-01-30T11:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214326",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_214327.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2013-01-30T11:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214327",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_214328.json:
```json
{
    "body": "<a id='comment:8'></a>Looks good to me.",
    "created_at": "2013-01-30T11:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214328",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>Looks good to me.



---

archive/issue_events_039448.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-31T09:19:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14028#event-39448"
}
```



---

archive/issue_comments_214329.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-31T09:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214329",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_214330.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.7.beta2\"",
    "created_at": "2013-01-31T09:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14028#issuecomment-214330",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.7.beta2"
