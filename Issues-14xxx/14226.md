# Issue 14226: add SAGE_SPKG_INST environment variable

archive/issues_014022.json:
```json
{
    "body": "There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.\n\n**Installation Instructions**:\n* apply [attachment:trac14226_library.patch] to the sage library\n* apply [attachment:trac14226_root.patch] and [attachment:14226_root_review.patch] to the root repository\n* apply [attachment:trac14226_scripts.patch] to the scripts repository\n\nAssignee: @jasongrout\n\nKeywords: installed spkgs directory\n\nReviewer: Robert Bradshaw, Leif Leonhardy, Jeroen Demeyer\n\nAuthor: R. Andrew Ohana\n\nMerged: sage-5.9.beta4\n\nDependencies: #13432, #14263\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14226\n\n",
    "closed_at": "2013-03-29T01:17:41Z",
    "created_at": "2013-03-05T07:34:06Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "add SAGE_SPKG_INST environment variable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14226",
    "user": "https://github.com/ohanar"
}
```
There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.

**Installation Instructions**:
* apply [attachment:trac14226_library.patch] to the sage library
* apply [attachment:trac14226_root.patch] and [attachment:14226_root_review.patch] to the root repository
* apply [attachment:trac14226_scripts.patch] to the scripts repository

Assignee: @jasongrout

Keywords: installed spkgs directory

Reviewer: Robert Bradshaw, Leif Leonhardy, Jeroen Demeyer

Author: R. Andrew Ohana

Merged: sage-5.9.beta4

Dependencies: #13432, #14263

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14226





---

archive/issue_comments_218684.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.\n+\n+**Installation Instructions**:\n+* apply attachment:trac14226_library.patch to the sage library\n+* apply attachment:trac14226_root.patch to the root repository\n``````\n",
    "created_at": "2013-03-05T07:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218684",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.
+
+**Installation Instructions**:
+* apply attachment:trac14226_library.patch to the sage library
+* apply attachment:trac14226_root.patch to the root repository
``````




---

archive/issue_comments_218685.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#13432\"",
    "created_at": "2013-03-05T07:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218685",
    "user": "https://github.com/ohanar"
}
```

Changing dependencies from "" to "#13432"



---

archive/issue_comments_218686.json:
```json
{
    "body": "Changing author from \"\" to \"R. Andrew Ohana\"",
    "created_at": "2013-03-05T07:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218686",
    "user": "https://github.com/ohanar"
}
```

Changing author from "" to "R. Andrew Ohana"



---

archive/issue_comments_218687.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-03-05T07:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218687",
    "user": "https://github.com/ohanar"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218688.json:
```json
{
    "body": "<a id='comment:3'></a>breaks stuff... working on a fix...",
    "created_at": "2013-03-05T08:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218688",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:3'></a>breaks stuff... working on a fix...



---

archive/issue_comments_218689.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-05T08:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218689",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218690.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-05T08:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218690",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218691.json:
```json
{
    "body": "<a id='comment:4'></a>Ok, found the missing link, should be good now.",
    "created_at": "2013-03-05T08:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218691",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:4'></a>Ok, found the missing link, should be good now.



---

archive/issue_events_040210.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-05T09:29:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14226#event-40210"
}
```



---

archive/issue_comments_218692.json:
```json
{
    "body": "<a id='comment:6'></a>Hmmm, I guess its name is pretty likely to confuse new users...\n\nNote that `$(INST)` in the Makefile now contains an *absolute* path...  (Similar for some scripts; although that doesn't break anything yet.)",
    "created_at": "2013-03-05T12:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218692",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>Hmmm, I guess its name is pretty likely to confuse new users...

Note that `$(INST)` in the Makefile now contains an *absolute* path...  (Similar for some scripts; although that doesn't break anything yet.)



---

archive/issue_comments_218693.json:
```json
{
    "body": "<a id='comment:7'></a>The patch looks fine as a quick solution.\n\nIn general though, I think that this directory shouldn't be needed from different places at all. There should be two functions (or shell scripts, or ./sage options) like set_installed(name, bool) and is_installed(name) that know about how installation status is tracked, and only they are allowed to know about this directory. Having INST in the environment will allow/encourage people to check installation status themselves, and I think that should be prevented.",
    "created_at": "2013-03-05T19:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218693",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:7'></a>The patch looks fine as a quick solution.

In general though, I think that this directory shouldn't be needed from different places at all. There should be two functions (or shell scripts, or ./sage options) like set_installed(name, bool) and is_installed(name) that know about how installation status is tracked, and only they are allowed to know about this directory. Having INST in the environment will allow/encourage people to check installation status themselves, and I think that should be prevented.



---

archive/issue_comments_218694.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 tkluck]:\n> In general though, I think that this directory shouldn't be needed from different places at all. There should be two functions (or shell scripts, or ./sage options) like set_installed(name, bool) and is_installed(name) that know about how installation status is tracked, and only they are allowed to know about this directory. Having INST in the environment will allow/encourage people to check installation status themselves, and I think that should be prevented.\n\n\nMaybe, but at the same time it makes it a lot easier to find offending cases if we do move to a pair of functions like you propose, so at the very least this would be a step in the right direction.",
    "created_at": "2013-03-10T03:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218694",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:8'></a>Replying to [comment:7 tkluck]:
> In general though, I think that this directory shouldn't be needed from different places at all. There should be two functions (or shell scripts, or ./sage options) like set_installed(name, bool) and is_installed(name) that know about how installation status is tracked, and only they are allowed to know about this directory. Having INST in the environment will allow/encourage people to check installation status themselves, and I think that should be prevented.


Maybe, but at the same time it makes it a lot easier to find offending cases if we do move to a pair of functions like you propose, so at the very least this would be a step in the right direction.



---

archive/issue_comments_218695.json:
```json
{
    "body": "<a id='comment:9'></a>Eventually we shouldn't be tracking this information ourselves at all (letting a package manager do it for us) so I'm fine with this \"quick\" solution.  Users shouldn't have to use it, so the name being obscure isn't a big deal (and it's easy to discover reading the code).",
    "created_at": "2013-03-10T08:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218695",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:9'></a>Eventually we shouldn't be tracking this information ourselves at all (letting a package manager do it for us) so I'm fine with this "quick" solution.  Users shouldn't have to use it, so the name being obscure isn't a big deal (and it's easy to discover reading the code).



---

archive/issue_comments_218696.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-10T08:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218696",
    "user": "https://github.com/robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218697.json:
```json
{
    "body": "<a id='comment:10'></a>`$SAGE_INST` needs to be quoted on line 339 of `$SAGE_ROOT/spkg/install`.",
    "created_at": "2013-03-10T11:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218697",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'></a>`$SAGE_INST` needs to be quoted on line 339 of `$SAGE_ROOT/spkg/install`.



---

archive/issue_comments_218698.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 leif]:\n> `$SAGE_INST` needs to be quoted on line 339 of `$SAGE_ROOT/spkg/install`.\n\n\nSame for `deps`, although I really don't like an *absolute* path there.",
    "created_at": "2013-03-10T12:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218698",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>Replying to [comment:10 leif]:
> `$SAGE_INST` needs to be quoted on line 339 of `$SAGE_ROOT/spkg/install`.


Same for `deps`, although I really don't like an *absolute* path there.



---

archive/issue_comments_218699.json:
```json
{
    "body": "<a id='comment:12'></a>And although this variable is (or should be) only used internally, we should document it (with a warning that it doesn't refer to the location of a Sage **inst**allation, nor should be set/modified by the user).\n\n2ct",
    "created_at": "2013-03-10T12:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218699",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>And although this variable is (or should be) only used internally, we should document it (with a warning that it doesn't refer to the location of a Sage **inst**allation, nor should be set/modified by the user).

2ct



---

archive/issue_comments_218700.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Robert Bradshaw, Leif Leonhardy\"",
    "created_at": "2013-03-10T12:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218700",
    "user": "https://github.com/nexttime"
}
```

Changing reviewer from "" to "Robert Bradshaw, Leif Leonhardy"



---

archive/issue_comments_218701.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-10T12:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218701",
    "user": "https://github.com/nexttime"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218702.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Fix files in `local/bin/` (scripts repo) as well.  Probably document the new variable.\"",
    "created_at": "2013-03-10T12:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218702",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "" to "Fix files in `local/bin/` (scripts repo) as well.  Probably document the new variable."



---

archive/issue_comments_218703.json:
```json
{
    "body": "<a id='comment:13'></a>There are also instances in the Sage scripts repository (`$SAGE_ROOT/local/bin/`) which have to get fixed, e.g. in\n`sage-update`:\n\n```python\n    installed = set(os.listdir(os.path.join(SPKG_ROOT, \"installed\")))\n```\n\nSame in `sage-list-packages`:\n\n```python\ntry:\n     installed = set(os.listdir(os.path.join(SPKG_ROOT, 'installed')))\nexcept OSError:\n     installed = set([])\n```\n\nThere are presumably even more, but simple grepping yields false positives as well; I've found:\n\n```\nlocal/bin/sage-bdist:   cp $CP_OPT installed \"$TMP/$PKGDIR/\"\n\nlocal/bin/sage-list-packages:     installed = set(os.listdir(os.path.join(SPKG_ROOT, 'installed')))\n\nlocal/bin/sage-make_devel_packages:SPKG_INST=\"$SAGE_ROOT\"/spkg/installed/\n\nlocal/bin/sage-update:    installed = set(os.listdir(os.path.join(SPKG_ROOT, \"installed\")))\n```\n\nLooking at those, isn't `SPKG_INST` (or `SAGE_SPKG_INST`) a better name? ;-)",
    "created_at": "2013-03-10T12:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218703",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>There are also instances in the Sage scripts repository (`$SAGE_ROOT/local/bin/`) which have to get fixed, e.g. in
`sage-update`:

```python
    installed = set(os.listdir(os.path.join(SPKG_ROOT, "installed")))
```

Same in `sage-list-packages`:

```python
try:
     installed = set(os.listdir(os.path.join(SPKG_ROOT, 'installed')))
except OSError:
     installed = set([])
```

There are presumably even more, but simple grepping yields false positives as well; I've found:

```
local/bin/sage-bdist:   cp $CP_OPT installed "$TMP/$PKGDIR/"

local/bin/sage-list-packages:     installed = set(os.listdir(os.path.join(SPKG_ROOT, 'installed')))

local/bin/sage-make_devel_packages:SPKG_INST="$SAGE_ROOT"/spkg/installed/

local/bin/sage-update:    installed = set(os.listdir(os.path.join(SPKG_ROOT, "installed")))
```

Looking at those, isn't `SPKG_INST` (or `SAGE_SPKG_INST`) a better name? ;-)



---

archive/issue_comments_218704.json:
```json
{
    "body": "Changing keywords from \"\" to \"installed spkgs directory\".",
    "created_at": "2013-03-10T12:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218704",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "" to "installed spkgs directory".



---

archive/issue_comments_218705.json:
```json
{
    "body": "Changing work_issues from \"Fix files in `local/bin/` (scripts repo) as well.  Probably document the new variable.\" to \"Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.  Probably document the new variable.\"",
    "created_at": "2013-03-10T12:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218705",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "Fix files in `local/bin/` (scripts repo) as well.  Probably document the new variable." to "Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.  Probably document the new variable."



---

archive/issue_comments_218706.json:
```json
{
    "body": "<a id='comment:15'></a>So my only objection to `SPKG_INST` is that it follows the convention of `SPKG_ROOT` which has been replaced with `SAGE_PACKAGES`, so it seems like a slight regression.\n\nOn the other hand, `SPKG_INST` makes sense in the context of trying to move to a real package manager, and that this directory only records the installations of spkgs (as opposed to packages installed with other methods). From this perspective, I agree that `SPKG_INST` would be a better name (enough to outweigh my objection).\n\nAs for documentation, from what I can tell there is no documentation on any development related variables, so I've made a new ticket for the task. (#14262)",
    "created_at": "2013-03-12T22:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218706",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:15'></a>So my only objection to `SPKG_INST` is that it follows the convention of `SPKG_ROOT` which has been replaced with `SAGE_PACKAGES`, so it seems like a slight regression.

On the other hand, `SPKG_INST` makes sense in the context of trying to move to a real package manager, and that this directory only records the installations of spkgs (as opposed to packages installed with other methods). From this perspective, I agree that `SPKG_INST` would be a better name (enough to outweigh my objection).

As for documentation, from what I can tell there is no documentation on any development related variables, so I've made a new ticket for the task. (#14262)



---

archive/issue_comments_218707.json:
```json
{
    "body": "Changing work_issues from \"Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.  Probably document the new variable.\" to \"Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.\"",
    "created_at": "2013-03-12T22:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218707",
    "user": "https://github.com/ohanar"
}
```

Changing work_issues from "Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.  Probably document the new variable." to "Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`."



---

archive/issue_comments_218708.json:
```json
{
    "body": "apply to scripts repository",
    "created_at": "2013-03-13T20:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218708",
    "user": "https://github.com/ohanar"
}
```

apply to scripts repository



---

archive/issue_comments_218709.json:
```json
{
    "body": "Attachment [trac14226_library.patch](tarball://root/attachments/some-uuid/ticket14226/trac14226_library.patch) by @ohanar created at 2013-03-13 20:12:56\n\napply to sage library",
    "created_at": "2013-03-13T20:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218709",
    "user": "https://github.com/ohanar"
}
```

Attachment [trac14226_library.patch](tarball://root/attachments/some-uuid/ticket14226/trac14226_library.patch) by @ohanar created at 2013-03-13 20:12:56

apply to sage library



---

archive/issue_comments_218710.json:
```json
{
    "body": "Changing work_issues from \"Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`.\" to \"\"",
    "created_at": "2013-03-13T20:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218710",
    "user": "https://github.com/ohanar"
}
```

Changing work_issues from "Fix files in `local/bin/` (scripts repo) as well.  Quote two instances in `deps` and `spkg/install`." to ""



---

archive/issue_comments_218711.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-13T20:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218711",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218712.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.\n \n **Installation Instructions**:\n-* apply attachment:trac14226_library.patch to the sage library\n-* apply attachment:trac14226_root.patch to the root repository\n+* apply [attachment:trac14226_library.patch] to the sage library\n+* apply [attachment:trac14226_root.patch] to the root repository\n+* apply [attachment:trac14226_scripts.patch] to the scripts repository\n``````\n",
    "created_at": "2013-03-13T20:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218712",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
 There are a fair number of places that does stuff with the directory `SAGE_ROOT/spkg/installed`, so let's add an environment variable for this directory. This will help ease the transition to git.
 
 **Installation Instructions**:
-* apply attachment:trac14226_library.patch to the sage library
-* apply attachment:trac14226_root.patch to the root repository
+* apply [attachment:trac14226_library.patch] to the sage library
+* apply [attachment:trac14226_root.patch] to the root repository
+* apply [attachment:trac14226_scripts.patch] to the scripts repository
``````




---

archive/issue_comments_218713.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Don't quote in deps\"",
    "created_at": "2013-03-17T09:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218713",
    "user": "https://github.com/ohanar"
}
```

Changing work_issues from "" to "Don't quote in deps"



---

archive/issue_comments_218714.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-17T09:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218714",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218715.json:
```json
{
    "body": "<a id='comment:17'></a>Quoting the variable in deps brakes lots of stuff.",
    "created_at": "2013-03-17T09:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218715",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:17'></a>Quoting the variable in deps brakes lots of stuff.



---

archive/issue_comments_218716.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 ohanar]:\n> Quoting the variable in deps brakes lots of stuff.\n\n\nApply `sage-make_relative` to it?  XD",
    "created_at": "2013-03-17T09:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218716",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>Replying to [comment:17 ohanar]:
> Quoting the variable in deps brakes lots of stuff.


Apply `sage-make_relative` to it?  XD



---

archive/issue_comments_218717.json:
```json
{
    "body": "<a id='comment:19'></a>Seriously, if you really want an absolute path there, create a symbolic link from `$(INST)` to `$SAGE_INST` before running `make`?\n\nBtw., what did it break?",
    "created_at": "2013-03-17T09:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218717",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>Seriously, if you really want an absolute path there, create a symbolic link from `$(INST)` to `$SAGE_INST` before running `make`?

Btw., what did it break?



---

archive/issue_comments_218718.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 leif]:\n> Seriously, if you really want an absolute path there, create a symbolic link from `$(INST)` to `$SAGE_INST` before running `make`?\n\n\n(Where `$(INST)` is still relative, but its target is absolute.)",
    "created_at": "2013-03-17T09:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218718",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>Replying to [comment:19 leif]:
> Seriously, if you really want an absolute path there, create a symbolic link from `$(INST)` to `$SAGE_INST` before running `make`?


(Where `$(INST)` is still relative, but its target is absolute.)



---

archive/issue_comments_218719.json:
```json
{
    "body": "<a id='comment:21'></a>I don't mind if it is relative, but I don't want to be fixed to the location `spkg/installed`. The problem with a relative path is that then there are issues if using `$SAGE_SPKG_INST` from some other directory (which can and does happen) and `sage-make_relative` isn't available upon the first usage of `deps`. Making a symbolic link would work in the case that `$(INST) != $SAGE_SPKG_INST`.",
    "created_at": "2013-03-17T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218719",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:21'></a>I don't mind if it is relative, but I don't want to be fixed to the location `spkg/installed`. The problem with a relative path is that then there are issues if using `$SAGE_SPKG_INST` from some other directory (which can and does happen) and `sage-make_relative` isn't available upon the first usage of `deps`. Making a symbolic link would work in the case that `$(INST) != $SAGE_SPKG_INST`.



---

archive/issue_comments_218720.json:
```json
{
    "body": "<a id='comment:22'></a>Or, how does `make INST=\"${SAGE_SPKG_INST:-installed}\"` behave?  (I think this would be better.)\n\n\n\n\nReplying to [comment:21 ohanar]:\n> I don't mind if it is relative, but I don't want to be fixed to the location `spkg/installed`.\n\n\nI meant just in the `Makefile`.  (`$SAGE_SPKG_INST` could still be absolute.)\n\n> The problem with a relative path is that then there are issues if using `$SAGE_SPKG_INST` from some other directory (which can and does happen)\n\n\nSee above.\n\n> `sage-make_relative` isn't available upon the first usage of `deps`.\n\n\nI was just kidding.\n\n> Making a symbolic link would work in the case that `$(INST) != $SAGE_SPKG_INST`.\n\n\nWell, just change `INST = installed` to something else (`INST = this_is_always_the_relative_path_to_a_symlink`), and let it point to either `installed` or `$SAGE_SPKG_INST` (where the latter is absolute).  Not sure about performance issues.",
    "created_at": "2013-03-17T10:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218720",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>Or, how does `make INST="${SAGE_SPKG_INST:-installed}"` behave?  (I think this would be better.)




Replying to [comment:21 ohanar]:
> I don't mind if it is relative, but I don't want to be fixed to the location `spkg/installed`.


I meant just in the `Makefile`.  (`$SAGE_SPKG_INST` could still be absolute.)

> The problem with a relative path is that then there are issues if using `$SAGE_SPKG_INST` from some other directory (which can and does happen)


See above.

> `sage-make_relative` isn't available upon the first usage of `deps`.


I was just kidding.

> Making a symbolic link would work in the case that `$(INST) != $SAGE_SPKG_INST`.


Well, just change `INST = installed` to something else (`INST = this_is_always_the_relative_path_to_a_symlink`), and let it point to either `installed` or `$SAGE_SPKG_INST` (where the latter is absolute).  Not sure about performance issues.



---

archive/issue_comments_218721.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 leif]:\n> Or, how does `make INST=\"${SAGE_SPKG_INST:-installed}\"` behave?  (I think this would be better.)\n\n\nYes, this resolves the issue -- which was that any entry of the form `$(MAKE) $(INST)/$(SPKG)` would error out complaining about a missing target.",
    "created_at": "2013-03-17T10:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218721",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:23'></a>Replying to [comment:22 leif]:
> Or, how does `make INST="${SAGE_SPKG_INST:-installed}"` behave?  (I think this would be better.)


Yes, this resolves the issue -- which was that any entry of the form `$(MAKE) $(INST)/$(SPKG)` would error out complaining about a missing target.



---

archive/issue_comments_218722.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-17T10:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218722",
    "user": "https://github.com/ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218723.json:
```json
{
    "body": "Changing work_issues from \"Don't quote in deps\" to \"\"",
    "created_at": "2013-03-17T10:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218723",
    "user": "https://github.com/ohanar"
}
```

Changing work_issues from "Don't quote in deps" to ""



---

archive/issue_comments_218724.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:22 leif]:\n> Or, how does `make INST=\"${SAGE_SPKG_INST:-installed}\"` behave?  (I think this would be better.)\n\n\nAfter deep thinking...\n\n```sh\nmake INST=\"`echo ${SAGE_SPKG_INST:-installed} | sed 's/ /\\\\\\\\ /g'`\"\n```\n(without changes to `deps`).\n\n\nI think this should solve all issues.",
    "created_at": "2013-03-17T10:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218724",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:24'></a>Replying to [comment:22 leif]:
> Or, how does `make INST="${SAGE_SPKG_INST:-installed}"` behave?  (I think this would be better.)


After deep thinking...

```sh
make INST="`echo ${SAGE_SPKG_INST:-installed} | sed 's/ /\\\\ /g'`"
```
(without changes to `deps`).


I think this should solve all issues.



---

archive/issue_comments_218725.json:
```json
{
    "body": "<a id='comment:25'></a>I'd keep the \"default\" value of `INST` in `deps`.\n\nAlso, I think there's more than one instance of `$MAKE` in `spkg/install`, not sure whether also elsewhere.",
    "created_at": "2013-03-17T11:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218725",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:25'></a>I'd keep the "default" value of `INST` in `deps`.

Also, I think there's more than one instance of `$MAKE` in `spkg/install`, not sure whether also elsewhere.



---

archive/issue_comments_218726.json:
```json
{
    "body": "<a id='comment:26'></a>ok, made your suggested changes.\n\nTesting locally I found no difference when introducing whitespace in the directory name of `SAGE_SPKG_INST`, but I have a very recent version of gmake installed on my system.",
    "created_at": "2013-03-17T11:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218726",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:26'></a>ok, made your suggested changes.

Testing locally I found no difference when introducing whitespace in the directory name of `SAGE_SPKG_INST`, but I have a very recent version of gmake installed on my system.



---

archive/issue_comments_218727.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 ohanar]:\n> Testing locally I found no difference when introducing whitespace in the directory name of `SAGE_SPKG_INST`, but I have a very recent version of gmake installed on my system.\n\n\n*Should<sup>TM</sup>* also work with\n\n```\nGNU Make 3.81\nCopyright (C) 2006  Free Software Foundation, Inc.\n```",
    "created_at": "2013-03-17T11:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218727",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>Replying to [comment:26 ohanar]:
> Testing locally I found no difference when introducing whitespace in the directory name of `SAGE_SPKG_INST`, but I have a very recent version of gmake installed on my system.


*Should<sup>TM</sup>* also work with

```
GNU Make 3.81
Copyright (C) 2006  Free Software Foundation, Inc.
```



---

archive/issue_comments_218728.json:
```json
{
    "body": "Changing dependencies from \"#13432\" to \"#13432, #14263\"",
    "created_at": "2013-03-26T21:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218728",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#13432" to "#13432, #14263"



---

archive/issue_comments_218729.json:
```json
{
    "body": "apply to root repository",
    "created_at": "2013-03-26T21:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218729",
    "user": "https://github.com/jdemeyer"
}
```

apply to root repository



---

archive/issue_comments_218730.json:
```json
{
    "body": "<a id='comment:29'></a>Attachment [trac14226_root.patch](tarball://root/attachments/some-uuid/ticket14226/trac14226_root.patch) by @jdemeyer created at 2013-03-26 21:20:20\n\nRebased to #14263.",
    "created_at": "2013-03-26T21:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218730",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>Attachment [trac14226_root.patch](tarball://root/attachments/some-uuid/ticket14226/trac14226_root.patch) by @jdemeyer created at 2013-03-26 21:20:20

Rebased to #14263.



---

archive/issue_comments_218731.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n \n **Installation Instructions**:\n * apply [attachment:trac14226_library.patch] to the sage library\n-* apply [attachment:trac14226_root.patch] to the root repository\n+* apply [attachment:trac14226_root.patch] and [attachment:14226_root_review.patch] to the root repository\n * apply [attachment:trac14226_scripts.patch] to the scripts repository\n``````\n",
    "created_at": "2013-03-26T22:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218731",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 
 **Installation Instructions**:
 * apply [attachment:trac14226_library.patch] to the sage library
-* apply [attachment:trac14226_root.patch] to the root repository
+* apply [attachment:trac14226_root.patch] and [attachment:14226_root_review.patch] to the root repository
 * apply [attachment:trac14226_scripts.patch] to the scripts repository
``````




---

archive/issue_comments_218732.json:
```json
{
    "body": "Changing reviewer from \"Robert Bradshaw, Leif Leonhardy\" to \"Robert Bradshaw, Leif Leonhardy, Jeroen Demeyer\"",
    "created_at": "2013-03-26T22:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218732",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Robert Bradshaw, Leif Leonhardy" to "Robert Bradshaw, Leif Leonhardy, Jeroen Demeyer"



---

archive/issue_comments_218733.json:
```json
{
    "body": "<a id='comment:30'></a>Attachment [14226_root_review.patch](tarball://root/attachments/some-uuid/ticket14226/14226_root_review.patch) by @jdemeyer created at 2013-03-26 22:29:14",
    "created_at": "2013-03-26T22:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218733",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Attachment [14226_root_review.patch](tarball://root/attachments/some-uuid/ticket14226/14226_root_review.patch) by @jdemeyer created at 2013-03-26 22:29:14



---

archive/issue_comments_218734.json:
```json
{
    "body": "<a id='comment:31'></a>Positive review given in person by R. Andrew Ohana.",
    "created_at": "2013-03-28T20:39:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218734",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>Positive review given in person by R. Andrew Ohana.



---

archive/issue_comments_218735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-28T20:39:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218735",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218736.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-29T01:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218736",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_040211.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-29T01:17:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14226#event-40211"
}
```



---

archive/issue_comments_218737.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.9.beta3\"",
    "created_at": "2013-03-29T01:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218737",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.9.beta3"



---

archive/issue_comments_218738.json:
```json
{
    "body": "Changing merged from \"sage-5.9.beta3\" to \"sage-5.9.beta4\"",
    "created_at": "2013-04-03T08:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14226#issuecomment-218738",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "sage-5.9.beta3" to "sage-5.9.beta4"
