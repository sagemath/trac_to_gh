# Issue 14234: Restructuring Diagram/Partition Algebras to match category structure

archive/issues_014030.json:
```json
{
    "body": "Currently, the Partition/Diagram Algebra implementations in Sage need to be redone. This problem was identified at Sage Days 38. The documentation is not very clear on how it should be used, and although it is supposed to be an algebra, it does not follow the standard form for algebras in Sage (most likely because these algebras have not been modified since 2007.) \n\nThis attached program seeks to provide an alternate implementation for, and eventually replace once dependencies are resolved, the existing PartionAlgebra package. More detail about these specific algebras can be found in a 2005 paper by Halverson and Ram titled \"Partition Algebras.\" This new implementation restructures the Partition/Diagram Algebras to use the category structure in Sage, so that they are actually implemented as Algebras_with_basis. The new implementation also provides much more detailed documentation on how to use the Partition Algebras, what they actually are, and provides an easier and more standard usage pattern (inherited from CombinatorialFreeModule.)\n\n---\n\nApply:\n\n* [attachment:trac_14234-folded-ts.patch]\n\nAssignee: @aghitza\n\nCC:  @alauve @srdoty @saliola\n\nKeywords: Partition algebra, diagram algebra, days38, days40\n\nReviewer: Travis Scrimshaw, Darij Grinberg\n\nAuthor: Stephen Doty, Aaron Lauve, George H. Seelinger\n\nMerged: sage-5.12.beta3\n\nDependencies: #10630\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/14234\n\n",
    "closed_at": "2013-08-20T12:55:50Z",
    "created_at": "2013-03-06T05:08:28Z",
    "labels": [
        "component: algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Restructuring Diagram/Partition Algebras to match category structure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14234",
    "user": "https://github.com/ghseeli"
}
```
Currently, the Partition/Diagram Algebra implementations in Sage need to be redone. This problem was identified at Sage Days 38. The documentation is not very clear on how it should be used, and although it is supposed to be an algebra, it does not follow the standard form for algebras in Sage (most likely because these algebras have not been modified since 2007.) 

This attached program seeks to provide an alternate implementation for, and eventually replace once dependencies are resolved, the existing PartionAlgebra package. More detail about these specific algebras can be found in a 2005 paper by Halverson and Ram titled "Partition Algebras." This new implementation restructures the Partition/Diagram Algebras to use the category structure in Sage, so that they are actually implemented as Algebras_with_basis. The new implementation also provides much more detailed documentation on how to use the Partition Algebras, what they actually are, and provides an easier and more standard usage pattern (inherited from CombinatorialFreeModule.)

---

Apply:

* [attachment:trac_14234-folded-ts.patch]

Assignee: @aghitza

CC:  @alauve @srdoty @saliola

Keywords: Partition algebra, diagram algebra, days38, days40

Reviewer: Travis Scrimshaw, Darij Grinberg

Author: Stephen Doty, Aaron Lauve, George H. Seelinger

Merged: sage-5.12.beta3

Dependencies: #10630

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/14234





---

archive/issue_comments_218901.json:
```json
{
    "body": "Changing keywords from \"Partition algebra, diagram algebra\" to \"Partition algebra, diagram algebra, days38, days40\".",
    "created_at": "2013-03-06T05:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218901",
    "user": "https://github.com/ghseeli"
}
```

Changing keywords from "Partition algebra, diagram algebra" to "Partition algebra, diagram algebra, days38, days40".



---

archive/issue_comments_218902.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [17710.patch](tarball://root/attachments/some-uuid/ticket14234/17710.patch) by @ghseeli created at 2013-03-06 05:14:38",
    "created_at": "2013-03-06T05:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218902",
    "user": "https://github.com/ghseeli"
}
```

<a id='comment:1'></a>
Attachment [17710.patch](tarball://root/attachments/some-uuid/ticket14234/17710.patch) by @ghseeli created at 2013-03-06 05:14:38



---

archive/issue_comments_218903.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis patch has been useful to some of my colleagues, and I would like to see it get into sage.  \n\nCurrently I couldn't see how we could display the diagrams pictorially in latex, and I think it would be really cool if we could have the latex version of the elements as sums of the pictorial diagrams. There seemed to be a few functions missing some doctests. Let me know when this gets ready for a formal review. Thanks.",
    "created_at": "2013-04-30T16:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218903",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
This patch has been useful to some of my colleagues, and I would like to see it get into sage.  

Currently I couldn't see how we could display the diagrams pictorially in latex, and I think it would be really cool if we could have the latex version of the elements as sums of the pictorial diagrams. There seemed to be a few functions missing some doctests. Let me know when this gets ready for a formal review. Thanks.



---

archive/issue_comments_218904.json:
```json
{
    "body": "<a id='comment:3'></a>\nI have a second revision on my computer that I am adding the finishing touches to. I will try to upload it in the following week. I have some ideas for pictorial representations using tikz, but the standard networkx and other drawing libraries are not powerful enough to make meaningful diagrams the same way sage does with other graphs. I wrote some code at one point in networkx to display them, but this ended up with issues when trying to create edges along the rows of diagrams, such as an edge between vertex 1 and vertex 3 (it looked the same as having edges {1,2},{2,3}). I will be sure to let you know when I need some formal review and I am glad your colleagues have found this patch useful. Thank you!",
    "created_at": "2013-04-30T17:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218904",
    "user": "https://github.com/ghseeli"
}
```

<a id='comment:3'></a>
I have a second revision on my computer that I am adding the finishing touches to. I will try to upload it in the following week. I have some ideas for pictorial representations using tikz, but the standard networkx and other drawing libraries are not powerful enough to make meaningful diagrams the same way sage does with other graphs. I wrote some code at one point in networkx to display them, but this ended up with issues when trying to create edges along the rows of diagrams, such as an edge between vertex 1 and vertex 3 (it looked the same as having edges {1,2},{2,3}). I will be sure to let you know when I need some formal review and I am glad your colleagues have found this patch useful. Thank you!



---

archive/issue_comments_218905.json:
```json
{
    "body": "<a id='comment:4'></a>\nEven if the diagrams are not too clean pictorially in tikz, as long as the output is moderately easily parseable and the connectivity is there, I think that will be good. Anyways, just let me know when it's ready. Thanks.",
    "created_at": "2013-05-02T14:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218905",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
Even if the diagrams are not too clean pictorially in tikz, as long as the output is moderately easily parseable and the connectivity is there, I think that will be good. Anyways, just let me know when it's ready. Thanks.



---

archive/issue_comments_218906.json:
```json
{
    "body": "<a id='comment:5'></a>\nAttachment [trac_14232_latexDrawing.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14232_latexDrawing.patch) by @ghseeli created at 2013-05-30 02:41:50\n\nI have added a new patch that I believe may need to be applied after the previous one has been. However, this patch *should* now allow for the generation of LaTeX code using TikZ to create diagrams for individual, basis diagrams. I have not changed any of the tests, however, so any tests that failed before will probably still fail.",
    "created_at": "2013-05-30T02:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218906",
    "user": "https://github.com/ghseeli"
}
```

<a id='comment:5'></a>
Attachment [trac_14232_latexDrawing.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14232_latexDrawing.patch) by @ghseeli created at 2013-05-30 02:41:50

I have added a new patch that I believe may need to be applied after the previous one has been. However, this patch *should* now allow for the generation of LaTeX code using TikZ to create diagrams for individual, basis diagrams. I have not changed any of the tests, however, so any tests that failed before will probably still fail.



---

archive/issue_comments_218907.json:
```json
{
    "body": "<a id='comment:6'></a>\nHow close is this to being ready review? Thanks.",
    "created_at": "2013-07-21T10:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218907",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
How close is this to being ready review? Thanks.



---

archive/issue_comments_218908.json:
```json
{
    "body": "<a id='comment:7'></a>\nI think the patch is ready for review. I'm sorry it took so long! Please let me know if more changes need to be made.",
    "created_at": "2013-07-23T02:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218908",
    "user": "https://github.com/ghseeli"
}
```

<a id='comment:7'></a>
I think the patch is ready for review. I'm sorry it took so long! Please let me know if more changes need to be made.



---

archive/issue_comments_218909.json:
```json
{
    "body": "<a id='comment:8'></a>\nI've set the ticket to needs_review and I'll write a review patch. I would like to know if there is a better name than `IdealAlgebra` since that will likely cause some confusion (perhaps something that does not begin with `Ideal` such as `PartitionIdealAlgebra`)? I'll take care of this in the review patch as well. Also, you'll need to fill in your real names as the authors.\n\nThank you,\n\nTravis\n\nPS - No need to worry about the time delay. Thanks for getting this done.",
    "created_at": "2013-07-23T03:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218909",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
I've set the ticket to needs_review and I'll write a review patch. I would like to know if there is a better name than `IdealAlgebra` since that will likely cause some confusion (perhaps something that does not begin with `Ideal` such as `PartitionIdealAlgebra`)? I'll take care of this in the review patch as well. Also, you'll need to fill in your real names as the authors.

Thank you,

Travis

PS - No need to worry about the time delay. Thanks for getting this done.



---

archive/issue_comments_218910.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-07-23T03:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218910",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218911.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2013-07-23T03:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218911",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_218912.json:
```json
{
    "body": "<a id='comment:9'></a>\nOkay, here's my review patch. I changed `IdealAlgebra` to `IdealPartitionAlgebra`, which is (much) better but I'm not perfectly happy with. If you can think of a better name, then I'll change it. I've also reorganized the class structure to better use base classes and implemented a coercion up to the ambient space for the subalgebras. After that it's mostly docstring/doctest additions and corrections.\n\nIf you agree with my changes (and can't think of a better name), you can go ahead and set this to positive review. Thanks.",
    "created_at": "2013-07-24T13:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218912",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Okay, here's my review patch. I changed `IdealAlgebra` to `IdealPartitionAlgebra`, which is (much) better but I'm not perfectly happy with. If you can think of a better name, then I'll change it. I've also reorganized the class structure to better use base classes and implemented a coercion up to the ambient space for the subalgebras. After that it's mostly docstring/doctest additions and corrections.

If you agree with my changes (and can't think of a better name), you can go ahead and set this to positive review. Thanks.



---

archive/issue_comments_218913.json:
```json
{
    "body": "Changing author from \"ghseeli, s.r.doty, alauve\" to \"Stephen Doty, Aaron Lauve, George H. Seelinger\"",
    "created_at": "2013-07-24T13:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218913",
    "user": "https://github.com/tscrim"
}
```

Changing author from "ghseeli, s.r.doty, alauve" to "Stephen Doty, Aaron Lauve, George H. Seelinger"



---

archive/issue_comments_218914.json:
```json
{
    "body": "<a id='comment:10'></a>\nFor patchbot:\n\nApply: trac_14234_revision_for_5.10_compatibility.patch trac_14234-review-ts.patch",
    "created_at": "2013-07-24T13:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218914",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
For patchbot:

Apply: trac_14234_revision_for_5.10_compatibility.patch trac_14234-review-ts.patch



---

archive/issue_comments_218915.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n Currently, the Partition/Diagram Algebra implementations in Sage need to be redone. This problem was identified at Sage Days 38. The documentation is not very clear on how it should be used, and although it is supposed to be an algebra, it does not follow the standard form for algebras in Sage (most likely because these algebras have not been modified since 2007.) \n \n This attached program seeks to provide an alternate implementation for, and eventually replace once dependencies are resolved, the existing PartionAlgebra package. More detail about these specific algebras can be found in a 2005 paper by Halverson and Ram titled \"Partition Algebras.\" This new implementation restructures the Partition/Diagram Algebras to use the category structure in Sage, so that they are actually implemented as Algebras_with_basis. The new implementation also provides much more detailed documentation on how to use the Partition Algebras, what they actually are, and provides an easier and more standard usage pattern (inherited from CombinatorialFreeModule.)\n+\n+---\n+\n+Apply:\n+\n+* [attachment:trac_14234_revision_for_5.10_compatibility.patch]\n+* [attachment:trac_14234-review-ts.patch]\n``````\n",
    "created_at": "2013-07-24T13:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218915",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
 Currently, the Partition/Diagram Algebra implementations in Sage need to be redone. This problem was identified at Sage Days 38. The documentation is not very clear on how it should be used, and although it is supposed to be an algebra, it does not follow the standard form for algebras in Sage (most likely because these algebras have not been modified since 2007.) 
 
 This attached program seeks to provide an alternate implementation for, and eventually replace once dependencies are resolved, the existing PartionAlgebra package. More detail about these specific algebras can be found in a 2005 paper by Halverson and Ram titled "Partition Algebras." This new implementation restructures the Partition/Diagram Algebras to use the category structure in Sage, so that they are actually implemented as Algebras_with_basis. The new implementation also provides much more detailed documentation on how to use the Partition Algebras, what they actually are, and provides an easier and more standard usage pattern (inherited from CombinatorialFreeModule.)
+
+---
+
+Apply:
+
+* [attachment:trac_14234_revision_for_5.10_compatibility.patch]
+* [attachment:trac_14234-review-ts.patch]
``````




---

archive/issue_comments_218916.json:
```json
{
    "body": "<a id='comment:11'></a>\nI talked to my co-authors and we seem to agree that \"PropagatingIdeal\" might be a better name for a few reasons:\n\n1) There are actually many ideals in the PartitionAlgebra.\n\n2) It is defined based on the propagating number of the diagrams.\n\n3) It is technically a non-unital algebra, which makes calling it an algebra debatable amongst some circles.\n\nOnce this is done, I think this enhancement is good to go. \n\nReplying to [tscrim](#comment%3A9):\n> Okay, here's my review patch. I changed `IdealAlgebra` to `IdealPartitionAlgebra`, which is (much) better but I'm not perfectly happy with. If you can think of a better name, then I'll change it. I've also reorganized the class structure to better use base classes and implemented a coercion up to the ambient space for the subalgebras. After that it's mostly docstring/doctest additions and corrections.\n> \n> If you agree with my changes (and can't think of a better name), you can go ahead and set this to positive review. Thanks.",
    "created_at": "2013-07-25T02:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218916",
    "user": "https://github.com/ghseeli"
}
```

<a id='comment:11'></a>
I talked to my co-authors and we seem to agree that "PropagatingIdeal" might be a better name for a few reasons:

1) There are actually many ideals in the PartitionAlgebra.

2) It is defined based on the propagating number of the diagrams.

3) It is technically a non-unital algebra, which makes calling it an algebra debatable amongst some circles.

Once this is done, I think this enhancement is good to go. 

Replying to [tscrim](#comment%3A9):
> Okay, here's my review patch. I changed `IdealAlgebra` to `IdealPartitionAlgebra`, which is (much) better but I'm not perfectly happy with. If you can think of a better name, then I'll change it. I've also reorganized the class structure to better use base classes and implemented a coercion up to the ambient space for the subalgebras. After that it's mostly docstring/doctest additions and corrections.
> 
> If you agree with my changes (and can't think of a better name), you can go ahead and set this to positive review. Thanks.



---

archive/issue_comments_218917.json:
```json
{
    "body": "<a id='comment:12'></a>\nAlright, the name has been changed (I like this one). Just needs one last lookover from you and you can set it to positive review. Thank you.\n\nFor patchbot:\n\nApply: trac_14234_revision_for_5.10_compatibility.patch trac_14234-review-ts.patch",
    "created_at": "2013-07-25T04:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218917",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Alright, the name has been changed (I like this one). Just needs one last lookover from you and you can set it to positive review. Thank you.

For patchbot:

Apply: trac_14234_revision_for_5.10_compatibility.patch trac_14234-review-ts.patch



---

archive/issue_comments_218918.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-07-26T00:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218918",
    "user": "https://github.com/ghseeli"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_040241.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-26T06:15:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14234#event-40241"
}
```



---

archive/issue_comments_218919.json:
```json
{
    "body": "<a id='comment:15'></a>\nAdding a dependency needed for this to apply.",
    "created_at": "2013-08-09T22:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218919",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:15'></a>
Adding a dependency needed for this to apply.



---

archive/issue_comments_218920.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#10630\"",
    "created_at": "2013-08-09T22:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218920",
    "user": "https://github.com/darijgr"
}
```

Changing dependencies from "" to "#10630"



---

archive/issue_comments_218921.json:
```json
{
    "body": "<a id='comment:17'></a>\nSorry that wasn't listed Darij. Thanks for updating this.",
    "created_at": "2013-08-09T22:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218921",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Sorry that wasn't listed Darij. Thanks for updating this.



---

archive/issue_comments_218922.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis is a very promising patch! Some errors I found:\n\n```\n    An propogating ideal.\n\n    A propogating ideal of rank `k` is a non-unital algebra with basis indexed\n    by the collection of ideal set partitions of `\\{1, \\ldots, k, -1, \\ldots,\n    -k\\}`. We say a set partition is ideal if its has propogating number is\n    less than `k`.\n\n    This algebra is thus a subalgebra of the partition algebra.\n    For more information, see :class:`PartitionAlgebra`\n```\n\nI don't like this. First of all, it should be \"propagating\", not \"propogating\" (fortunately the method name is correct). Second, this should be \"The\", not \"A\", propagating ideal. Otherwise it sounds like **some** ideal generated by ideal partitions -- and there are many of those.\n\nActually I see the \"propogating\" typo elsewhere too. Also, a \"with with\" in the definition of `ideal_diagrams`.\n\nAlso, typo: \"ommitted\".\n\nI'm not very happy with the use of floats (as in \"2.5\") for the \"intermediate\" partition algebras. Is it safe to assume that, say, `range(1,int(k+0.5))` always ends at k-0.5, or can it happen that k-0.5 is a tad smaller than an integer due to a rounding error and k-0.5 no longer falls in the interval?\n\nThere is a more serious issue with the intermediate algebras, and it's this (from your doctest):\n\n```\n        sage: da.partition_diagrams(1.5)\n        [{{2, -2}, {1, -1}}, {{-1}, {2, -2}, {1}}]\n```\n\nIf I am to follow the Halverson-Ram conventions, this should contain three more partition diagrams, e. g., {{1, -1, 2, -2}}. Generally, they define a (k+1/2)-partition diagram, for k being an integer, to be any (k+1)-partition diagram in which k+1 and -k-1 lie in the same block (but don't need to be alone there). These are in bijections with set partitions of a fixed (2k+1)-element set. What you define, instead, bijects with set partitions of a 2k-element set, which is boring since these are already the k-partition diagrams.\n\nMoreover, `da.partition_diagrams(2)` returns a combinatorial class whereas `da.partition_diagrams(1.5)` returns a list. I am a bit puzzled because this hardly intended behaviour is doctested for...",
    "created_at": "2013-08-10T02:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218922",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:18'></a>
This is a very promising patch! Some errors I found:

```
    An propogating ideal.

    A propogating ideal of rank `k` is a non-unital algebra with basis indexed
    by the collection of ideal set partitions of `\{1, \ldots, k, -1, \ldots,
    -k\}`. We say a set partition is ideal if its has propogating number is
    less than `k`.

    This algebra is thus a subalgebra of the partition algebra.
    For more information, see :class:`PartitionAlgebra`
```

I don't like this. First of all, it should be "propagating", not "propogating" (fortunately the method name is correct). Second, this should be "The", not "A", propagating ideal. Otherwise it sounds like **some** ideal generated by ideal partitions -- and there are many of those.

Actually I see the "propogating" typo elsewhere too. Also, a "with with" in the definition of `ideal_diagrams`.

Also, typo: "ommitted".

I'm not very happy with the use of floats (as in "2.5") for the "intermediate" partition algebras. Is it safe to assume that, say, `range(1,int(k+0.5))` always ends at k-0.5, or can it happen that k-0.5 is a tad smaller than an integer due to a rounding error and k-0.5 no longer falls in the interval?

There is a more serious issue with the intermediate algebras, and it's this (from your doctest):

```
        sage: da.partition_diagrams(1.5)
        [{{2, -2}, {1, -1}}, {{-1}, {2, -2}, {1}}]
```

If I am to follow the Halverson-Ram conventions, this should contain three more partition diagrams, e. g., {{1, -1, 2, -2}}. Generally, they define a (k+1/2)-partition diagram, for k being an integer, to be any (k+1)-partition diagram in which k+1 and -k-1 lie in the same block (but don't need to be alone there). These are in bijections with set partitions of a fixed (2k+1)-element set. What you define, instead, bijects with set partitions of a 2k-element set, which is boring since these are already the k-partition diagrams.

Moreover, `da.partition_diagrams(2)` returns a combinatorial class whereas `da.partition_diagrams(1.5)` returns a list. I am a bit puzzled because this hardly intended behaviour is doctested for...



---

archive/issue_comments_218923.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-08-10T02:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218923",
    "user": "https://github.com/darijgr"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218924.json:
```json
{
    "body": "<a id='comment:20'></a>\nAnother reason why floats are a bad thing:\n\n```\nsage: da.PartitionAlgebra(3+1/2, 1, QQ, 'part') == da.PartitionAlgebra(3+1/2, 1, QQ, 'part')\nTrue\nsage: da.PartitionAlgebra(3+1/2, 1, QQ, 'part') == da.PartitionAlgebra(3.5, 1, QQ, 'part')  \nFalse\n```\nI think the code should use rationals, and floats in the input should be normalized to the nearest semi-integer.\n\nRemove the word \"with\" from `with propogating number less than`, since there is already a \"with\" on the preceding line.\n\nThere is a typo (\"usualy\") here:\n\n```\n        Returns the product of two basis diagrams. Usually it is not called\n        directly, but indirectly through usualy arithmetic operators.\n```\nbut actually the word can be removed.\n\nI think the docstrings should mention the fact that the partition-to-diagram correspondence is not 1-to-1, and diagrams are usually seen just as intuitive representations of set partitions, with several different diagrams corresponding to the same set partition.\n\nPut \"k\" in backticks in `The Brauer algebra of rank k`.\n\nThe docstring `        ambient returns the partition algebra the Brauer algebra is a sub-algebra of.` should be adjusted as it is defined not just for a Brauer algebra but for any subalgebra.\n\nIt seems to me that the `SubPartitionAlgebra` docstring should say that the subalgebra is spanned by a subset of the basis of the partition algebra. Otherwise the code of the `retract` method makes no sense.",
    "created_at": "2013-08-10T12:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218924",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:20'></a>
Another reason why floats are a bad thing:

```
sage: da.PartitionAlgebra(3+1/2, 1, QQ, 'part') == da.PartitionAlgebra(3+1/2, 1, QQ, 'part')
True
sage: da.PartitionAlgebra(3+1/2, 1, QQ, 'part') == da.PartitionAlgebra(3.5, 1, QQ, 'part')  
False
```
I think the code should use rationals, and floats in the input should be normalized to the nearest semi-integer.

Remove the word "with" from `with propogating number less than`, since there is already a "with" on the preceding line.

There is a typo ("usualy") here:

```
        Returns the product of two basis diagrams. Usually it is not called
        directly, but indirectly through usualy arithmetic operators.
```
but actually the word can be removed.

I think the docstrings should mention the fact that the partition-to-diagram correspondence is not 1-to-1, and diagrams are usually seen just as intuitive representations of set partitions, with several different diagrams corresponding to the same set partition.

Put "k" in backticks in `The Brauer algebra of rank k`.

The docstring `        ambient returns the partition algebra the Brauer algebra is a sub-algebra of.` should be adjusted as it is defined not just for a Brauer algebra but for any subalgebra.

It seems to me that the `SubPartitionAlgebra` docstring should say that the subalgebra is spanned by a subset of the basis of the partition algebra. Otherwise the code of the `retract` method makes no sense.



---

archive/issue_comments_218925.json:
```json
{
    "body": "<a id='comment:21'></a>\nThere are two reasons why I left it as `0.5` instead of `1/2`, the first is that `floor` is being called and it seemed somewhat troublesome to covert it to an integer, and the second is this what the old partition algebras used (which is why I didn't look too hard to getting around the first problem). Also IMO you're abusing the input with your `==` example, so it's an unfair test.\n\nI think that `da.partition_diagrams` is okay since its more of an internal helper function, but I'll change the output to be a list in both cases to match the output of the other such functions.\n\nFor the `0.5 +/- 0.5`, since there is no division being performed and they are specified floating points, their bit representations are the same and it's a power of two, so +/- are both okay (here). If it was say `0.1` added 10 times, then it's slightly more worrisome (but I think it's still okay...)\n\nIn any case, I'll look more deeply into seeing if I can convert this to using rationals, make sure the 1/2's are correct (and fix it if it's not), and fix those typos (including my spelling of propagate `:P`).\n\nThanks for your comments Darij.\n\nBest,\n\nTravis",
    "created_at": "2013-08-10T20:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218925",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
There are two reasons why I left it as `0.5` instead of `1/2`, the first is that `floor` is being called and it seemed somewhat troublesome to covert it to an integer, and the second is this what the old partition algebras used (which is why I didn't look too hard to getting around the first problem). Also IMO you're abusing the input with your `==` example, so it's an unfair test.

I think that `da.partition_diagrams` is okay since its more of an internal helper function, but I'll change the output to be a list in both cases to match the output of the other such functions.

For the `0.5 +/- 0.5`, since there is no division being performed and they are specified floating points, their bit representations are the same and it's a power of two, so +/- are both okay (here). If it was say `0.1` added 10 times, then it's slightly more worrisome (but I think it's still okay...)

In any case, I'll look more deeply into seeing if I can convert this to using rationals, make sure the 1/2's are correct (and fix it if it's not), and fix those typos (including my spelling of propagate `:P`).

Thanks for your comments Darij.

Best,

Travis



---

archive/issue_comments_218926.json:
```json
{
    "body": "Attachment [trac_14234-review-ts.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-review-ts.patch) by @tscrim created at 2013-08-10 23:58:49",
    "created_at": "2013-08-10T23:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218926",
    "user": "https://github.com/tscrim"
}
```

Attachment [trac_14234-review-ts.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-review-ts.patch) by @tscrim created at 2013-08-10 23:58:49



---

archive/issue_comments_218927.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-08-11T00:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218927",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218928.json:
```json
{
    "body": "<a id='comment:22'></a>\nHey Darij,\n\nHere's the new version of the review patch with all of the changes. I wasn't very explicit/detailed with the docstring for `SubPartitionAlgebra` since it's an internal (abstract) class. If you happy with my changes, go ahead and set this to positive review.\n\nBest,\n\nTravis\n\nFor patchbot:\n\nApply: trac_14234_revision_for_5.10_compatibility.patch\u200b, trac_14234-review-ts.patch\u200b",
    "created_at": "2013-08-11T00:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218928",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>
Hey Darij,

Here's the new version of the review patch with all of the changes. I wasn't very explicit/detailed with the docstring for `SubPartitionAlgebra` since it's an internal (abstract) class. If you happy with my changes, go ahead and set this to positive review.

Best,

Travis

For patchbot:

Apply: trac_14234_revision_for_5.10_compatibility.patch​, trac_14234-review-ts.patch​



---

archive/issue_comments_218929.json:
```json
{
    "body": "Attachment [trac_14234-microchange-dg.2.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-microchange-dg.2.patch) by @darijgr created at 2013-08-11 00:35:47",
    "created_at": "2013-08-11T00:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218929",
    "user": "https://github.com/darijgr"
}
```

Attachment [trac_14234-microchange-dg.2.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-microchange-dg.2.patch) by @darijgr created at 2013-08-11 00:35:47



---

archive/issue_comments_218930.json:
```json
{
    "body": "<a id='comment:23'></a>\nAttachment [trac_14234-microchange-dg.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-microchange-dg.patch) by @darijgr created at 2013-08-11 00:37:27\n\nHi Travis,\n\nthanks, the issues are fixed. I've suggested a little improvement on the propagating ideal docstring in [attachment:trac_14234-microchange-dg.patch] which you're free to use or ignore. Basically I think it makes a lot more sense to think of it as an ideal than as a non-unital algebra.\n\nGreets,\\\\\nDarij",
    "created_at": "2013-08-11T00:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218930",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:23'></a>
Attachment [trac_14234-microchange-dg.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-microchange-dg.patch) by @darijgr created at 2013-08-11 00:37:27

Hi Travis,

thanks, the issues are fixed. I've suggested a little improvement on the propagating ideal docstring in [attachment:trac_14234-microchange-dg.patch] which you're free to use or ignore. Basically I think it makes a lot more sense to think of it as an ideal than as a non-unital algebra.

Greets,\\
Darij



---

archive/issue_comments_218931.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-08-11T00:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218931",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218932.json:
```json
{
    "body": "Changing reviewer from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Darij Grinberg\"",
    "created_at": "2013-08-11T04:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218932",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Travis Scrimshaw" to "Travis Scrimshaw, Darij Grinberg"



---

archive/issue_comments_218933.json:
```json
{
    "body": "<a id='comment:25'></a>\nThanks Darij.",
    "created_at": "2013-08-11T04:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218933",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
Thanks Darij.



---

archive/issue_comments_218934.json:
```json
{
    "body": "Attachment [trac_14234_revision_for_5.10_compatibility.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234_revision_for_5.10_compatibility.patch) by @jdemeyer created at 2013-08-15 15:06:36",
    "created_at": "2013-08-15T15:06:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218934",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [trac_14234_revision_for_5.10_compatibility.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234_revision_for_5.10_compatibility.patch) by @jdemeyer created at 2013-08-15 15:06:36



---

archive/issue_comments_218935.json:
```json
{
    "body": "<a id='comment:26'></a>\nFolded both patches since the folded patch is smaller than the original patch and smaller than the reviewer patch! Also added [attachment:trac_14234-microchange-dg.patch] which wasn't mentioned in the \"Apply\" block but I guess was meant to be merged anyway.",
    "created_at": "2013-08-15T15:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218935",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Folded both patches since the folded patch is smaller than the original patch and smaller than the reviewer patch! Also added [attachment:trac_14234-microchange-dg.patch] which wasn't mentioned in the "Apply" block but I guess was meant to be merged anyway.



---

archive/issue_comments_218936.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,4 +7,3 @@\n Apply:\n \n * [attachment:trac_14234_revision_for_5.10_compatibility.patch]\n-* [attachment:trac_14234-review-ts.patch]\n``````\n",
    "created_at": "2013-08-15T15:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218936",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,4 +7,3 @@
 Apply:
 
 * [attachment:trac_14234_revision_for_5.10_compatibility.patch]
-* [attachment:trac_14234-review-ts.patch]
``````




---

archive/issue_comments_218937.json:
```json
{
    "body": "<a id='comment:27'></a>\nThis `AssertionError` should be fixed (you probably want to raise a `ValueError` instead):\n\n```\nsage: sage.combinat.diagram_algebras.to_Brauer_partition([[1,2,3],[-1,-2]])\n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\n<ipython-input-1-8bfe84be2a91> in <module>()\n----> 1 sage.combinat.diagram_algebras.to_Brauer_partition([[Integer(1),Integer(2),Integer(3)],[-Integer(1),-Integer(2)]])\n\n/mazur/release/merger/sage-5.12.beta1/local/lib/python2.7/site-packages/sage/combinat/diagram_algebras.pyc in to_Brauer_partition(l, k)\n   1419         L2.append(list(i))\n   1420     for i in L2:\n-> 1421         assert len(i) < 3\n   1422         if (len(i) == 2):\n   1423             paired.append(i)\n\nAssertionError: \n```",
    "created_at": "2013-08-15T15:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218937",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
This `AssertionError` should be fixed (you probably want to raise a `ValueError` instead):

```
sage: sage.combinat.diagram_algebras.to_Brauer_partition([[1,2,3],[-1,-2]])
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-8bfe84be2a91> in <module>()
----> 1 sage.combinat.diagram_algebras.to_Brauer_partition([[Integer(1),Integer(2),Integer(3)],[-Integer(1),-Integer(2)]])

/mazur/release/merger/sage-5.12.beta1/local/lib/python2.7/site-packages/sage/combinat/diagram_algebras.pyc in to_Brauer_partition(l, k)
   1419         L2.append(list(i))
   1420     for i in L2:
-> 1421         assert len(i) < 3
   1422         if (len(i) == 2):
   1423             paired.append(i)

AssertionError: 
```



---

archive/issue_comments_218938.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-08-15T15:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218938",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218939.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n Apply:\n \n-* [attachment:trac_14234_revision_for_5.10_compatibility.patch]\n+* [attachment:trac_14234-folded-ts.patch]\n``````\n",
    "created_at": "2013-08-15T17:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218939",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
 Apply:
 
-* [attachment:trac_14234_revision_for_5.10_compatibility.patch]
+* [attachment:trac_14234-folded-ts.patch]
``````




---

archive/issue_comments_218940.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-08-15T17:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218940",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_218941.json:
```json
{
    "body": "<a id='comment:28'></a>\nAttachment [trac_14234-folded-ts.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-folded-ts.patch) by @tscrim created at 2013-08-15 17:04:22\n\nHere's the folded patch which replaces asserts with raising `ValueError`s.\n\nSorry for not noticing that the microchange patch was not listed in the apply section.\n\nFor patchbot:\n\nApply: trac_14234-folded-ts.patch",
    "created_at": "2013-08-15T17:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218941",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>
Attachment [trac_14234-folded-ts.patch](tarball://root/attachments/some-uuid/ticket14234/trac_14234-folded-ts.patch) by @tscrim created at 2013-08-15 17:04:22

Here's the folded patch which replaces asserts with raising `ValueError`s.

Sorry for not noticing that the microchange patch was not listed in the apply section.

For patchbot:

Apply: trac_14234-folded-ts.patch



---

archive/issue_comments_218942.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-20T12:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218942",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_218943.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.12.beta3\"",
    "created_at": "2013-08-20T12:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14234#issuecomment-218943",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.12.beta3"



---

archive/issue_events_040242.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-20T12:55:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14234",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14234#event-40242"
}
```
