# Issue 14846: CycleIndexSeries derivative, integral, exponential methods are not combinatorial

archive/issues_014642.json:
```json
{
    "body": "The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are not combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!\n\nIn addition to being confusing, this discrepancy has the potential to hinder work using the *CycleIndexSeries* class. The combinatorial operation of cycle index differentiation is very useful in enumerative work.\n\nAll that said, the existing *exponential* and *derivative* methods are used for algebraic magic tricks in some of the existing code, so it's important not to take it away altogether.\n\nThe attached patch makes the following changes:\n\n* Adds *_lps_derivative*, *_lps_integral*, and *_lps_exponential* methods to *CycleIndexSeries* which call up using *super*.\n\n* Refactors the internal code which previously used *exponential* and *derivative* to use *_lps_exponential* and *_lps_derivative* instead.\n\n* Implements a new *derivative* method which computes the combinatorial derivative of a cycle index series.\n\n* Implements a new *pointing* method which implements a related combinatorial operation.\n\n* Implements a new *integral* method which raises a *NotImplementedError* to prevent any user confusion (since, as explained in the docstring, there may be infinitely many very distinct cycle indices with a given derivative).\n\n* Implements a new *exponential* method which returns the composition E(self) for E the cycle index series of *SetSpecies*. \n\n* Implements a new *logarithm* method which returns the composition \u03a9(self) for \u03a9 the cycle index series implemented in *CombinatorialLogarithmSeries*.\n\nDocstrings and doctests are included for everything but the _lps_* methods, which just call up to ``super``. I'm not sure what a doctest for these would even look like, but I'm open to suggestions.\n\n**Assignee:** agd\n\n**Keywords:** LazyPowerSeries, species\n\n**Branch/Commit:** [ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)\n\n**Work Issues:** documentation\n\n**Reviewer:** Martin Rubey\n\n**Author:** Andrew Gainer-Dewar\n\nIssue created by migration from https://trac.sagemath.org/ticket/14846\n\n",
    "closed_at": "2015-08-13T18:35:25Z",
    "created_at": "2013-07-01T16:13:26Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "title": "CycleIndexSeries derivative, integral, exponential methods are not combinatorial",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/14846",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```
The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are not combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!

In addition to being confusing, this discrepancy has the potential to hinder work using the *CycleIndexSeries* class. The combinatorial operation of cycle index differentiation is very useful in enumerative work.

All that said, the existing *exponential* and *derivative* methods are used for algebraic magic tricks in some of the existing code, so it's important not to take it away altogether.

The attached patch makes the following changes:

* Adds *_lps_derivative*, *_lps_integral*, and *_lps_exponential* methods to *CycleIndexSeries* which call up using *super*.

* Refactors the internal code which previously used *exponential* and *derivative* to use *_lps_exponential* and *_lps_derivative* instead.

* Implements a new *derivative* method which computes the combinatorial derivative of a cycle index series.

* Implements a new *pointing* method which implements a related combinatorial operation.

* Implements a new *integral* method which raises a *NotImplementedError* to prevent any user confusion (since, as explained in the docstring, there may be infinitely many very distinct cycle indices with a given derivative).

* Implements a new *exponential* method which returns the composition E(self) for E the cycle index series of *SetSpecies*. 

* Implements a new *logarithm* method which returns the composition Ω(self) for Ω the cycle index series implemented in *CombinatorialLogarithmSeries*.

Docstrings and doctests are included for everything but the _lps_* methods, which just call up to ``super``. I'm not sure what a doctest for these would even look like, but I'm open to suggestions.

**Assignee:** agd

**Keywords:** LazyPowerSeries, species

**Branch/Commit:** [ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)

**Work Issues:** documentation

**Reviewer:** Martin Rubey

**Author:** Andrew Gainer-Dewar

Issue created by migration from https://trac.sagemath.org/ticket/14846





---

archive/issue_comments_184271.json:
```json
{
    "body": "<a id='comment:1'></a>\nFor the patchbot:\n\napply trac_14846_cis_deriv_int_exp_methods.patch",
    "created_at": "2013-07-01T16:15:02Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184271",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:1'></a>
For the patchbot:

apply trac_14846_cis_deriv_int_exp_methods.patch



---

archive/issue_events_130108.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-07-01T16:15:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130108"
}
```



---

archive/issue_comments_184272.json:
```json
{
    "body": "<a id='comment:3'></a>\nI have uploaded a new version of the patch which makes a small change: rather than building the terms of the *derivative* of a *CycleIndexSeries* using an opaque list concatenation, I have used the *CycleIndexSeriesRing.term* method.",
    "created_at": "2013-07-17T17:44:50Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184272",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:3'></a>
I have uploaded a new version of the patch which makes a small change: rather than building the terms of the *derivative* of a *CycleIndexSeries* using an opaque list concatenation, I have used the *CycleIndexSeriesRing.term* method.



---

archive/issue_comments_184273.json:
```json
{
    "body": "**Branch:** [u/agd/cis_deriv_int_exp_methods](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis_deriv_int_exp_methods)",
    "created_at": "2013-07-22T03:29:17Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184273",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Branch:** [u/agd/cis_deriv_int_exp_methods](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis_deriv_int_exp_methods)



---

archive/issue_comments_184274.json:
```json
{
    "body": "<a id='comment:5'></a>\nPlease make it clear whether the patch or the git branch should be merged. In the latter case, change the milestone to sage-6.0.",
    "created_at": "2013-08-19T06:37:14Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184274",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Please make it clear whether the patch or the git branch should be merged. In the latter case, change the milestone to sage-6.0.



---

archive/issue_comments_184275.json:
```json
{
    "body": "**Changing branch** from \"[u/agd/cis_deriv_int_exp_methods](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis_deriv_int_exp_methods)\" to \"\".",
    "created_at": "2013-08-20T21:23:53Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184275",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Changing branch** from "[u/agd/cis_deriv_int_exp_methods](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis_deriv_int_exp_methods)" to "".



---

archive/issue_comments_184276.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!\n+The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are not combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!\n \n In addition to being confusing, this discrepancy has the potential to hinder work using the *CycleIndexSeries* class. The combinatorial operation of cycle index differentiation is very useful in enumerative work.\n \n``````\n",
    "created_at": "2013-08-29T15:33:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184276",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!
+The *CycleIndexSeries* class inherits *derivative*, *integral*, and *exponential* methods from its parent class *LazyPowerSeries*. However, these operations (which are perfectly reasonable at the *LazyPowerSeries* level) are not combinatorially natural. In fact, there is a differentiation operator on cycle index series, but it's something entirely different, and anti-differentiation is in general impossible!
 
 In addition to being confusing, this discrepancy has the potential to hinder work using the *CycleIndexSeries* class. The combinatorial operation of cycle index differentiation is very useful in enumerative work.
 
``````




---

archive/issue_comments_184277.json:
```json
{
    "body": "<a id='comment:8'></a>\nRebased patch to apply over 5.12.beta4.",
    "created_at": "2013-09-03T16:51:59Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184277",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:8'></a>
Rebased patch to apply over 5.12.beta4.



---

archive/issue_comments_184278.json:
```json
{
    "body": "**Author:** Andrew Gainer-Dewar",
    "created_at": "2013-09-03T16:51:59Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184278",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Author:** Andrew Gainer-Dewar



---

archive/attachments_020650.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14846_cis_deriv_int_exp_methods.patch",
    "asset_url": "tarball://root/attachments/ticket14846/trac_14846_cis_deriv_int_exp_methods.patch",
    "created_at": "2013-10-24T10:14:31Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket14846/trac_14846_cis_deriv_int_exp_methods.patch",
    "user": "https://github.com/fchapoton"
}
```



---

archive/issue_comments_184279.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Attachment:** [trac_14846_cis_deriv_int_exp_methods.patch](https://github.com/sagemath/sage/files/ticket14846/trac_14846_cis_deriv_int_exp_methods.patch)\n\nCould you please add doctests to the three _lps functions ?",
    "created_at": "2013-10-24T10:14:31Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184279",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
**Attachment:** [trac_14846_cis_deriv_int_exp_methods.patch](https://github.com/sagemath/sage/files/ticket14846/trac_14846_cis_deriv_int_exp_methods.patch)

Could you please add doctests to the three _lps functions ?



---

archive/issue_events_130109.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-10-24T10:14:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130109"
}
```



---

archive/issue_events_130110.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-10-24T10:14:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130110"
}
```



---

archive/issue_comments_184280.json:
```json
{
    "body": "**Work Issues:** documentation",
    "created_at": "2013-10-24T10:14:31Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184280",
    "user": "https://github.com/fchapoton"
}
```

**Work Issues:** documentation



---

archive/issue_comments_184281.json:
```json
{
    "body": "<a id='comment:10'></a>\nSkeletal doctests added for the three _lps_* functions. I have no idea whether this is the *right* way to test this sort of method, but at least it's *a* test.\n\nAdditionally, I've switched back over to using Git to manage this\u2014the old Mercurial workflow is just too confusing. How do I tell the build bot to ignore the attachments and only use the branch?",
    "created_at": "2013-11-23T17:01:42Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184281",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:10'></a>
Skeletal doctests added for the three _lps_* functions. I have no idea whether this is the *right* way to test this sort of method, but at least it's *a* test.

Additionally, I've switched back over to using Git to manage this—the old Mercurial workflow is just too confusing. How do I tell the build bot to ignore the attachments and only use the branch?



---

archive/issue_comments_184282.json:
```json
{
    "body": "**Branch:** [u/agd/cis/deriv](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis/deriv)",
    "created_at": "2013-11-23T17:01:42Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184282",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Branch:** [u/agd/cis/deriv](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis/deriv)



---

archive/issue_events_130111.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:01:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130111"
}
```



---

archive/issue_events_130112.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:01:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130112"
}
```



---

archive/issue_events_130113.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:01:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130113"
}
```



---

archive/issue_events_130114.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2013-11-23T17:01:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130114"
}
```



---

archive/issue_comments_184283.json:
```json
{
    "body": "**Commit:** [5ce33898e941771132cdf94837a4baf16a2cfddb](https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb)",
    "created_at": "2013-11-23T17:01:42Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184283",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Commit:** [5ce33898e941771132cdf94837a4baf16a2cfddb](https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb)



---

archive/issue_events_130115.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130115"
}
```



---

archive/issue_events_130116.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2013-12-17T18:39:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130116"
}
```



---

archive/issue_comments_184284.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5547d74\">5547d74</a></td><td><code>Merge branch 'develop' into cis/deriv</code></td></tr></table>\n",
    "created_at": "2013-12-25T19:54:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5547d74">5547d74</a></td><td><code>Merge branch 'develop' into cis/deriv</code></td></tr></table>




---

archive/issue_comments_184285.json:
```json
{
    "body": "**Changing commit** from \"[5ce33898e941771132cdf94837a4baf16a2cfddb](https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb)\" to \"[5547d749d9136f0eddf4400237183b78245e3f51](https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51)\".",
    "created_at": "2013-12-25T19:54:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184285",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5ce33898e941771132cdf94837a4baf16a2cfddb](https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb)" to "[5547d749d9136f0eddf4400237183b78245e3f51](https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51)".



---

archive/issue_comments_184286.json:
```json
{
    "body": "**Reviewer:** mantepse",
    "created_at": "2013-12-31T22:33:54Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184286",
    "user": "https://github.com/mantepse"
}
```

**Reviewer:** mantepse



---

archive/issue_comments_184287.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi Andrew,\n\nI'd suggest to really remove access to the three inherited methods, and rewrite the methods that use _lps_exponential accordingly:\n\n* in set_species, we really want to return the \"true\" exponential cycle index series\n* in partition_species, the \"true\" exponential of the \"true\" exponential - 1\n* in subset_species, the square of the \"true\" exponential\n\nFinally, the implementation of the \"true\" exponential can be taken from what's in set_species in sage 6.0.\n\nAs far as I can see, the other two methods _lps_derivative and _lps_integral are not used anywhere.\n\nThis might have a speed penalty, but I'd worry about that only if it's serious.  I think it's not a good idea to make the cycle index series depend on the species code, as in the proposed patch.\n\nI would perhaps also put the definition for the combinatorial logarithm into the same file.  I think at some point we should reorganise the files in the species directory..\n\nMartin",
    "created_at": "2013-12-31T22:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184287",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:14'></a>
Hi Andrew,

I'd suggest to really remove access to the three inherited methods, and rewrite the methods that use _lps_exponential accordingly:

* in set_species, we really want to return the "true" exponential cycle index series
* in partition_species, the "true" exponential of the "true" exponential - 1
* in subset_species, the square of the "true" exponential

Finally, the implementation of the "true" exponential can be taken from what's in set_species in sage 6.0.

As far as I can see, the other two methods _lps_derivative and _lps_integral are not used anywhere.

This might have a speed penalty, but I'd worry about that only if it's serious.  I think it's not a good idea to make the cycle index series depend on the species code, as in the proposed patch.

I would perhaps also put the definition for the combinatorial logarithm into the same file.  I think at some point we should reorganise the files in the species directory..

Martin



---

archive/issue_comments_184288.json:
```json
{
    "body": "**Changing commit** from \"[5547d749d9136f0eddf4400237183b78245e3f51](https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51)\" to \"[dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2](https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2)\".",
    "created_at": "2014-01-01T02:14:38Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184288",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5547d749d9136f0eddf4400237183b78245e3f51](https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51)" to "[dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2](https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2)".



---

archive/issue_comments_184289.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd77e4a\">dd77e4a</a></td><td><code>Move log and exp series code to generating_series.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca21d87\">ca21d87</a></td><td><code>Redesign patch to eliminate _lps_* methods and bad dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1998f2\">c1998f2</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis/deriv</code></td></tr></table>\n",
    "created_at": "2014-01-01T02:14:38Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184289",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd77e4a">dd77e4a</a></td><td><code>Move log and exp series code to generating_series.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca21d87">ca21d87</a></td><td><code>Redesign patch to eliminate _lps_* methods and bad dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1998f2">c1998f2</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis/deriv</code></td></tr></table>




---

archive/issue_comments_184290.json:
```json
{
    "body": "<a id='comment:16'></a>\nThanks for the suggestions!\n\nReplying to [@mantepse](#comment%3A14):\n> I'd suggest to really remove access to the three inherited methods, and rewrite the methods that use _lps_exponential accordingly:\n\nSounds good to me. Done, in the latest push.\n\n> * in set_species, we really want to return the \"true\" exponential cycle index series\n> * in partition_species, the \"true\" exponential of the \"true\" exponential - 1\n> * in subset_species, the square of the \"true\" exponential\n\nI have rewritten all of these to use algebraic operations on the exponential CIS.\n\n> As far as I can see, the other two methods _lps_derivative and _lps_integral are not used anywhere.\n\nSeems to be true. I just included them for completeness. They're gone now.\n \n> This might have a speed penalty, but I'd worry about that only if it's serious.  I think it's not a good idea to make the cycle index series depend on the species code, as in the proposed patch.\n\nActually, I think the new way should actually be *faster*, there's just one instance of the exponential series which gets cached and handed around.\n\n> I would perhaps also put the definition for the combinatorial logarithm into the same file.\n\nOnce I wrote the other stuff, this seemed very reasonable, so I've done that as well.",
    "created_at": "2014-01-01T02:17:21Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184290",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:16'></a>
Thanks for the suggestions!

Replying to [@mantepse](#comment%3A14):
> I'd suggest to really remove access to the three inherited methods, and rewrite the methods that use _lps_exponential accordingly:

Sounds good to me. Done, in the latest push.

> * in set_species, we really want to return the "true" exponential cycle index series
> * in partition_species, the "true" exponential of the "true" exponential - 1
> * in subset_species, the square of the "true" exponential

I have rewritten all of these to use algebraic operations on the exponential CIS.

> As far as I can see, the other two methods _lps_derivative and _lps_integral are not used anywhere.

Seems to be true. I just included them for completeness. They're gone now.
 
> This might have a speed penalty, but I'd worry about that only if it's serious.  I think it's not a good idea to make the cycle index series depend on the species code, as in the proposed patch.

Actually, I think the new way should actually be *faster*, there's just one instance of the exponential series which gets cached and handed around.

> I would perhaps also put the definition for the combinatorial logarithm into the same file.

Once I wrote the other stuff, this seemed very reasonable, so I've done that as well.



---

archive/issue_events_130117.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2014-01-01T21:26:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130117"
}
```



---

archive/issue_events_130118.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2014-01-01T21:26:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130118"
}
```



---

archive/issue_comments_184291.json:
```json
{
    "body": "<a id='comment:18'></a>\nReviewer name must be full name. Also please fill in your name on the trac.sagemath.org homepage.",
    "created_at": "2014-01-06T04:44:31Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184291",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>
Reviewer name must be full name. Also please fill in your name on the trac.sagemath.org homepage.



---

archive/issue_comments_184292.json:
```json
{
    "body": "**Changing reviewer** from \"mantepse\" to \"Martin Rubey\".",
    "created_at": "2014-01-06T17:32:53Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184292",
    "user": "https://github.com/mantepse"
}
```

**Changing reviewer** from "mantepse" to "Martin Rubey".



---

archive/issue_comments_184293.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"LazyPowerSeries, species\".",
    "created_at": "2014-01-14T20:24:55Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184293",
    "user": "https://github.com/mantepse"
}
```

**Changing keywords** from "" to "LazyPowerSeries, species".



---

archive/issue_comments_184294.json:
```json
{
    "body": "<a id='comment:21'></a>\nOne (minor) issue is the removal of combinatorial_logarithm.py which might need to be deprecated.  I've also done a \"rebase\" of this on top of #15673 which makes the code a little bit cleaner.  This is in branch \"u/mhansen/ticket/14846\" .  Ideally, I'd prefer to have #15673 go in first since the rebase/merge of this ticket is easier than the other way around.\n\nSee https://github.com/sagemath/sagetrac-mirror/commits/u/mhansen/ticket/14846",
    "created_at": "2014-01-15T16:19:11Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184294",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:21'></a>
One (minor) issue is the removal of combinatorial_logarithm.py which might need to be deprecated.  I've also done a "rebase" of this on top of #15673 which makes the code a little bit cleaner.  This is in branch "u/mhansen/ticket/14846" .  Ideally, I'd prefer to have #15673 go in first since the rebase/merge of this ticket is easier than the other way around.

See https://github.com/sagemath/sagetrac-mirror/commits/u/mhansen/ticket/14846



---

archive/issue_events_130119.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2014-01-15T16:19:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130119"
}
```



---

archive/issue_events_130120.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2014-01-15T16:19:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130120"
}
```



---

archive/issue_events_130121.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130121"
}
```



---

archive/issue_events_130122.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130122"
}
```



---

archive/issue_comments_184295.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30fcfde6b4d0a04bb2b626286c474aff651c1e75\">30fcfde</a></td><td><code>Initial work on new streams</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96e4ea3f73149f7ad76dfaeca306bc70c72546ff\">96e4ea3</a></td><td><code>Make streams know about their order / aorder</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a076622b8346499b325b31e0dbd0e298e0c487f2\">a076622</a></td><td><code>Move generating_series over to new streams format</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e56173decdf3d2cfd3adbcea6b976a0a28d875a\">9e56173</a></td><td><code>Fix issue in LazyPowerSeries.__repr__ with (eventually) constant streams</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa83cccb267b6da8909a6a537b85e9c9a6dfae91\">fa83ccc</a></td><td><code>More work on moving generating_series over to new format</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b566203e09ffdbf8b8814cdc543d605158fc768\">3b56620</a></td><td><code>Fix repr in recursive species</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea1902a464939da66b48f9171b1c2e5195051c2a\">ea1902a</a></td><td><code>Fix cycle species cis</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/458bdafe64adca10a42ef91bc46859c3fd4af6c7\">458bdaf</a></td><td><code>Fix bug in generating_series</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b038bb76fd41518391edbe7b2ee21d45704748b\">9b038bb</a></td><td><code>Clean up order_operation and make the default to return 0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fefaacf595b499f33c5a9694dbf330af4966dfbe\">fefaacf</a></td><td><code>Start making the basic species use Streams directly</code></td></tr></table>\n",
    "created_at": "2014-02-09T19:48:14Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30fcfde6b4d0a04bb2b626286c474aff651c1e75">30fcfde</a></td><td><code>Initial work on new streams</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96e4ea3f73149f7ad76dfaeca306bc70c72546ff">96e4ea3</a></td><td><code>Make streams know about their order / aorder</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a076622b8346499b325b31e0dbd0e298e0c487f2">a076622</a></td><td><code>Move generating_series over to new streams format</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e56173decdf3d2cfd3adbcea6b976a0a28d875a">9e56173</a></td><td><code>Fix issue in LazyPowerSeries.__repr__ with (eventually) constant streams</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa83cccb267b6da8909a6a537b85e9c9a6dfae91">fa83ccc</a></td><td><code>More work on moving generating_series over to new format</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b566203e09ffdbf8b8814cdc543d605158fc768">3b56620</a></td><td><code>Fix repr in recursive species</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea1902a464939da66b48f9171b1c2e5195051c2a">ea1902a</a></td><td><code>Fix cycle species cis</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/458bdafe64adca10a42ef91bc46859c3fd4af6c7">458bdaf</a></td><td><code>Fix bug in generating_series</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b038bb76fd41518391edbe7b2ee21d45704748b">9b038bb</a></td><td><code>Clean up order_operation and make the default to return 0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fefaacf595b499f33c5a9694dbf330af4966dfbe">fefaacf</a></td><td><code>Start making the basic species use Streams directly</code></td></tr></table>




---

archive/issue_comments_184296.json:
```json
{
    "body": "**Changing commit** from \"[dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2](https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2)\" to \"[c7d73451550ce689a96668a210ab04b86d3a66ad](https://github.com/sagemath/sagetrac-mirror/commit/c7d73451550ce689a96668a210ab04b86d3a66ad)\".",
    "created_at": "2014-02-09T19:48:14Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184296",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2](https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2)" to "[c7d73451550ce689a96668a210ab04b86d3a66ad](https://github.com/sagemath/sagetrac-mirror/commit/c7d73451550ce689a96668a210ab04b86d3a66ad)".



---

archive/issue_comments_184297.json:
```json
{
    "body": "**Changing commit** from \"[c7d73451550ce689a96668a210ab04b86d3a66ad](https://github.com/sagemath/sagetrac-mirror/commit/c7d73451550ce689a96668a210ab04b86d3a66ad)\" to \"[334c0956250038eae2d6efc915231e650b13be79](https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79)\".",
    "created_at": "2014-02-09T20:18:41Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184297",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c7d73451550ce689a96668a210ab04b86d3a66ad](https://github.com/sagemath/sagetrac-mirror/commit/c7d73451550ce689a96668a210ab04b86d3a66ad)" to "[334c0956250038eae2d6efc915231e650b13be79](https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79)".



---

archive/issue_comments_184298.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a630924f4c3db57234bda14e12ef066f9e9a9dd5\">a630924</a></td><td><code>Implement combinatorial derivative, etc. for CycleIndexSeries</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb\">5ce3389</a></td><td><code>Add doctests for _lps_* methods</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51\">5547d74</a></td><td><code>Merge branch 'develop' into cis/deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1998f2a547d32a220c3c468f926a5fe8b0f3b57\">c1998f2</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis/deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca21d87ab95ddf78372a3ca8b49c67c3e96ea50f\">ca21d87</a></td><td><code>Redesign patch to eliminate _lps_* methods and bad dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2\">dd77e4a</a></td><td><code>Move log and exp series code to generating_series.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6989f3f5240b91bfb3d9cdfe62612bddf5e9adfd\">6989f3f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis-deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d3b46683d9cd567a75a9c737f248fd95b69354b\">2d3b466</a></td><td><code>Merge remote-tracking branch 'origin/u/mhansen/ticket/14846' into cis-deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4efe9b08164bf688e15ef3729858a4eb2996e7c2\">4efe9b0</a></td><td><code>Rename CycleIndexSeriesRing.omega() to logarithm_series</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79\">334c095</a></td><td><code>Rename CycleIndexSeriesRing().exponential() to exponential_series()</code></td></tr></table>\n",
    "created_at": "2014-02-09T20:18:41Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184298",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a630924f4c3db57234bda14e12ef066f9e9a9dd5">a630924</a></td><td><code>Implement combinatorial derivative, etc. for CycleIndexSeries</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ce33898e941771132cdf94837a4baf16a2cfddb">5ce3389</a></td><td><code>Add doctests for _lps_* methods</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5547d749d9136f0eddf4400237183b78245e3f51">5547d74</a></td><td><code>Merge branch 'develop' into cis/deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1998f2a547d32a220c3c468f926a5fe8b0f3b57">c1998f2</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis/deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca21d87ab95ddf78372a3ca8b49c67c3e96ea50f">ca21d87</a></td><td><code>Redesign patch to eliminate _lps_* methods and bad dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd77e4ae6388bd8ad52d7f6a13848fe6490b25d2">dd77e4a</a></td><td><code>Move log and exp series code to generating_series.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6989f3f5240b91bfb3d9cdfe62612bddf5e9adfd">6989f3f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis-deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d3b46683d9cd567a75a9c737f248fd95b69354b">2d3b466</a></td><td><code>Merge remote-tracking branch 'origin/u/mhansen/ticket/14846' into cis-deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4efe9b08164bf688e15ef3729858a4eb2996e7c2">4efe9b0</a></td><td><code>Rename CycleIndexSeriesRing.omega() to logarithm_series</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79">334c095</a></td><td><code>Rename CycleIndexSeriesRing().exponential() to exponential_series()</code></td></tr></table>




---

archive/issue_comments_184299.json:
```json
{
    "body": "**Dependencies:** 15673",
    "created_at": "2014-02-09T20:19:41Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184299",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Dependencies:** 15673



---

archive/issue_comments_184300.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [@mwhansen](#comment%3A21):\n> One (minor) issue is the removal of combinatorial_logarithm.py which might need to be deprecated.  \n\nAh, yes, this is an important point. I sometimes forget that other people might have used my code\u2026 =D\n\n> I've also done a \"rebase\" of this on top of #15673 which makes the code a little bit cleaner.  This is in branch \"u/mhansen/ticket/14846\" .  Ideally, I'd prefer to have #15673 go in first since the rebase/merge of this ticket is easier than the other way around.\n\nI don't yet understand everything that's happening with #15673, but I'm starting to take a look at it. I'm definitely open to the idea, though\u2014better series code will make all our work easier! I've taken a look at your rebased version of this, and have a few thoughts up-front:\n\n* In the docstring for the deprecated `CombinatorialLogarithmSeries()`, you point the reader to `CycleIndexSeriesRing(R).exponential()`, but in fact this should be to `CycleIndexSeriesRing(R).omega()`.\n\n* Relatedly, I'd argue that the `CycleIndexSeriesRing(R).omega()` and `CycleIndexSeriesRing(R).exponential()` methods should instead be named `logarithm_series()` and `exponential_series()`. In the first place, the \u03a9 notation is not totally standard (it's used by Labelle, but other authors have called this virtual species \"Con\" or other things); in the second, I think it's conceptually important to emphasize that these objects are *series* and not *operations*, since the operations are implemented as `CycleIndexSeries().exponential()` and `CycleIndexSeries().logarithm()` respectively. (Of course, the documentation should mention the relationship between the two!)\n\n* `CycleIndexSeriesRing.LogarithmStream` appears to be internal, so the docstring of `CycleIndexSeries.logarithm()` should refer instead to `CycleIndexSeriesRing.logarithm_series`.\n\nI've updated the ticket branch to use your code with these changes. I've also set a dependency on #15673. (Evidently, I bungled the ticket modifications a bit, but I think it's all sorted now.)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6989f3f5240b91bfb3d9cdfe62612bddf5e9adfd\">6989f3f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis-deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d3b46683d9cd567a75a9c737f248fd95b69354b\">2d3b466</a></td><td><code>Merge remote-tracking branch 'origin/u/mhansen/ticket/14846' into cis-deriv</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4efe9b08164bf688e15ef3729858a4eb2996e7c2\">4efe9b0</a></td><td><code>Rename CycleIndexSeriesRing.omega() to logarithm_series</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79\">334c095</a></td><td><code>Rename CycleIndexSeriesRing().exponential() to exponential_series()</code></td></tr></table>\n",
    "created_at": "2014-02-09T20:19:41Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184300",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:25'></a>
Replying to [@mwhansen](#comment%3A21):
> One (minor) issue is the removal of combinatorial_logarithm.py which might need to be deprecated.  

Ah, yes, this is an important point. I sometimes forget that other people might have used my code… =D

> I've also done a "rebase" of this on top of #15673 which makes the code a little bit cleaner.  This is in branch "u/mhansen/ticket/14846" .  Ideally, I'd prefer to have #15673 go in first since the rebase/merge of this ticket is easier than the other way around.

I don't yet understand everything that's happening with #15673, but I'm starting to take a look at it. I'm definitely open to the idea, though—better series code will make all our work easier! I've taken a look at your rebased version of this, and have a few thoughts up-front:

* In the docstring for the deprecated `CombinatorialLogarithmSeries()`, you point the reader to `CycleIndexSeriesRing(R).exponential()`, but in fact this should be to `CycleIndexSeriesRing(R).omega()`.

* Relatedly, I'd argue that the `CycleIndexSeriesRing(R).omega()` and `CycleIndexSeriesRing(R).exponential()` methods should instead be named `logarithm_series()` and `exponential_series()`. In the first place, the Ω notation is not totally standard (it's used by Labelle, but other authors have called this virtual species "Con" or other things); in the second, I think it's conceptually important to emphasize that these objects are *series* and not *operations*, since the operations are implemented as `CycleIndexSeries().exponential()` and `CycleIndexSeries().logarithm()` respectively. (Of course, the documentation should mention the relationship between the two!)

* `CycleIndexSeriesRing.LogarithmStream` appears to be internal, so the docstring of `CycleIndexSeries.logarithm()` should refer instead to `CycleIndexSeriesRing.logarithm_series`.

I've updated the ticket branch to use your code with these changes. I've also set a dependency on #15673. (Evidently, I bungled the ticket modifications a bit, but I think it's all sorted now.)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6989f3f5240b91bfb3d9cdfe62612bddf5e9adfd">6989f3f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into cis-deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d3b46683d9cd567a75a9c737f248fd95b69354b">2d3b466</a></td><td><code>Merge remote-tracking branch 'origin/u/mhansen/ticket/14846' into cis-deriv</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4efe9b08164bf688e15ef3729858a4eb2996e7c2">4efe9b0</a></td><td><code>Rename CycleIndexSeriesRing.omega() to logarithm_series</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79">334c095</a></td><td><code>Rename CycleIndexSeriesRing().exponential() to exponential_series()</code></td></tr></table>




---

archive/issue_comments_184301.json:
```json
{
    "body": "**Changing dependencies** from \"15673\" to \"#15673\".",
    "created_at": "2014-02-09T21:42:43Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184301",
    "user": "https://github.com/mantepse"
}
```

**Changing dependencies** from "15673" to "#15673".



---

archive/issue_comments_184302.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b\">538dde7</a></td><td><code>Fix broken docstring in combinatorial_logarithm.py</code></td></tr></table>\n",
    "created_at": "2014-02-10T15:23:03Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184302",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b">538dde7</a></td><td><code>Fix broken docstring in combinatorial_logarithm.py</code></td></tr></table>




---

archive/issue_comments_184303.json:
```json
{
    "body": "**Changing commit** from \"[334c0956250038eae2d6efc915231e650b13be79](https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79)\" to \"[538dde76d0e116f67e1115337193fe12c48ce62b](https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b)\".",
    "created_at": "2014-02-10T15:23:03Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[334c0956250038eae2d6efc915231e650b13be79](https://github.com/sagemath/sagetrac-mirror/commit/334c0956250038eae2d6efc915231e650b13be79)" to "[538dde76d0e116f67e1115337193fe12c48ce62b](https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b)".



---

archive/issue_comments_184304.json:
```json
{
    "body": "<a id='comment:28'></a>\nCool, your changes look good to me!",
    "created_at": "2014-02-10T15:32:54Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184304",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:28'></a>
Cool, your changes look good to me!



---

archive/issue_events_130123.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130123"
}
```



---

archive/issue_events_130124.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130124"
}
```



---

archive/issue_comments_184305.json:
```json
{
    "body": "<a id='comment:30'></a>\nWhile #15673 looks like it will bring some much-needed improvements to the algebraic machinery of species in Sage, it also looks like it's going to take a while to implement. I've been fielding questions from other researchers who would like to use the code in #14347, which definitely depends on this one, so I'd be very grateful if we could move forward on this one now. I will, of course, be happy to revisit the issue in the context of #15673 once that situation stabilizes!",
    "created_at": "2014-08-01T14:20:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184305",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:30'></a>
While #15673 looks like it will bring some much-needed improvements to the algebraic machinery of species in Sage, it also looks like it's going to take a while to implement. I've been fielding questions from other researchers who would like to use the code in #14347, which definitely depends on this one, so I'd be very grateful if we could move forward on this one now. I will, of course, be happy to revisit the issue in the context of #15673 once that situation stabilizes!



---

archive/issue_comments_184306.json:
```json
{
    "body": "**Changing dependencies** from \"#15673\" to \"\".",
    "created_at": "2014-08-01T14:20:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184306",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

**Changing dependencies** from "#15673" to "".



---

archive/issue_events_130125.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130125"
}
```



---

archive/issue_events_130126.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130126"
}
```



---

archive/issue_comments_184307.json:
```json
{
    "body": "<a id='comment:32'></a>\nI agree.  I wonder what happened to #16137.",
    "created_at": "2014-08-13T09:41:23Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184307",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:32'></a>
I agree.  I wonder what happened to #16137.



---

archive/issue_events_130127.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-23T19:48:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130127"
}
```



---

archive/issue_events_130128.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-23T19:48:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130128"
}
```



---

archive/issue_comments_184308.json:
```json
{
    "body": "**Changing commit** from \"[538dde76d0e116f67e1115337193fe12c48ce62b](https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b)\" to \"[ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)\".",
    "created_at": "2015-05-29T22:39:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184308",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[538dde76d0e116f67e1115337193fe12c48ce62b](https://github.com/sagemath/sagetrac-mirror/commit/538dde76d0e116f67e1115337193fe12c48ce62b)" to "[ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)".



---

archive/issue_comments_184309.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318\">ab9c7d1</a></td><td><code>Rebase #14846 on current mainline Sage</code></td></tr></table>\n",
    "created_at": "2015-05-29T22:39:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184309",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318">ab9c7d1</a></td><td><code>Rebase #14846 on current mainline Sage</code></td></tr></table>




---

archive/issue_comments_184310.json:
```json
{
    "body": "<a id='comment:35'></a>\nSince #15673 seems to have died on the vine, I have rebuilt the code for this commit on top of current mainline Sage 6.7. All doctests in `combinat/species` pass.",
    "created_at": "2015-05-29T22:51:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184310",
    "user": "https://trac.sagemath.org/admin/accounts/users/agd"
}
```

<a id='comment:35'></a>
Since #15673 seems to have died on the vine, I have rebuilt the code for this commit on top of current mainline Sage 6.7. All doctests in `combinat/species` pass.



---

archive/issue_events_130129.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2015-05-31T22:40:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130129"
}
```



---

archive/issue_events_130130.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2015-05-31T22:40:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130130"
}
```



---

archive/issue_events_130131.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2015-05-31T22:40:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130131"
}
```



---

archive/issue_events_130132.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/agd",
    "created_at": "2015-05-31T22:40:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130132"
}
```



---

archive/issue_comments_184311.json:
```json
{
    "body": "<a id='comment:37'></a>\nI played with the code and the examples, and found myself happy.  For example,\n\n```\nsage: T = CombinatorialSpecies()\nsage: X = species.SingletonSpecies()\nsage: E = species.SetSpecies()\nsage: T.define(X*E(T))\nsage: s = T.cycle_index_series()\nsage: oeis(s.logarithm().generating_series().counts(12))\n0: A133297: a(n) = n!*Sum_{k=1..n} (-1)^(k+1)*n^(n-k-1)/(n-k)!.\nsage: oeis(s.pointing().generating_series().counts(12)[1:])\n0: A000312: Number of labeled mappings from n points to themselves (endofunctions): n^n.\n1: A177885: (1-n)^(n-1).\n2: A086783: Discriminant of the polynomial x^n - 1.\nsage: oeis(s.pointing().isotype_generating_series().counts(12)[1:])\n0: A000107: Number of rooted trees with n nodes and a single labeled node; pointed rooted trees; vertebrates.\n```\n\nThanks for the code and thanks for the patience!",
    "created_at": "2015-08-12T15:22:46Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184311",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:37'></a>
I played with the code and the examples, and found myself happy.  For example,

```
sage: T = CombinatorialSpecies()
sage: X = species.SingletonSpecies()
sage: E = species.SetSpecies()
sage: T.define(X*E(T))
sage: s = T.cycle_index_series()
sage: oeis(s.logarithm().generating_series().counts(12))
0: A133297: a(n) = n!*Sum_{k=1..n} (-1)^(k+1)*n^(n-k-1)/(n-k)!.
sage: oeis(s.pointing().generating_series().counts(12)[1:])
0: A000312: Number of labeled mappings from n points to themselves (endofunctions): n^n.
1: A177885: (1-n)^(n-1).
2: A086783: Discriminant of the polynomial x^n - 1.
sage: oeis(s.pointing().isotype_generating_series().counts(12)[1:])
0: A000107: Number of rooted trees with n nodes and a single labeled node; pointed rooted trees; vertebrates.
```

Thanks for the code and thanks for the patience!



---

archive/issue_events_130133.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-08-12T15:22:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130133"
}
```



---

archive/issue_events_130134.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-08-12T15:22:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130134"
}
```



---

archive/issue_comments_184312.json:
```json
{
    "body": "**Changing branch** from \"[u/agd/cis/deriv](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis/deriv)\" to \"[ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)\".",
    "created_at": "2015-08-13T18:35:25Z",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14846#issuecomment-184312",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/agd/cis/deriv](https://github.com/sagemath/sagetrac-mirror/tree/u/agd/cis/deriv)" to "[ab9c7d161b8318bc5edffb3bb3dd66bc5c503318](https://github.com/sagemath/sagetrac-mirror/commit/ab9c7d161b8318bc5edffb3bb3dd66bc5c503318)".



---

archive/issue_events_130135.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-13T18:35:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130135"
}
```



---

archive/issue_events_130136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d845450aceba01f2f4ba1737ade2518e3f34189f",
    "created_at": "2015-08-13T18:35:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14846",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14846#event-130136"
}
```
