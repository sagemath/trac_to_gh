# Issue 14881: Some symmetric group algebra modifications

archive/issues_014677.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @tscrim @mwhansen\n\nKeywords: permutations, symmetric group algebra, combinat,\n\n**UPDATED and ready for review.** The patch does the following:\n\n1) Allows `k = 1` in the construction of the k-th Jucys-Murphy element in both the symmetric group algebra and the Hecke algebra. There is no theoretical reason not to. They're not very interesting elements, but algorithms shouldn't mysteriously fail in corner cases. (Note: I'm treating `k = 1` as a separate case in the Hecke algebra because I want it to return the 1 of the Hecke algebra, not the int 1.)\n\n2) The `algebra_generators()` method on a symmetric group algebra with n being 0 or 1 doesn't throw an error anymore.\n\n3) The `cpi` method should now be a lot faster (checked on S<sub>6</sub> and `[3,2,1]`, where the speedup factor was more than 2).\n\n4) New methods `a` and `b` in `symmetric_group_algebra.py` allow computing the sum of the row-preserving permutations and the alternating sum of the column-preserving permutation of a Young tableau, not just their product. These methods are not exported by default so as not to pollute the namespace.\n\n5) A fix in `tableau.py` ensures that `Tableau([]).row_stabilizer()` behaves as it should. My speed tests are inconclusive, but I don't think this fix has any noticeable impact on overall speed of tableau computations. The assumption I added to the documentation was already needed beforehand; it just wasn't documented.\n\nIssues I'd like the reviewer to look at closely:\n\nA) I removed a \"#################### SEGFAULTS ################\" comment after a doctests since that doctest doesn't even run close to segfaulting (on my machine, that is). If it had a reason to be there, please insert it back.\n\nB) I don't know what the `star` keyword in my methods is for -- I copied it over from the `e` method (which should be similar to `a` and `b` in various regards), where it was undocumented. Apparently it is used internally in other methods. If you think I should remove it from my methods, I will.\n\nC) There are two TODOs which might deserve tickets of their own.\n\n```\n 627    # This all should be over ZZ, not over QQ, but symmetric group \n 628    # algebras don't seem to preserve coercion (the one over ZZ \n 629    # doesn't coerce into the one over QQ even for the same n), \n 630    # and the QQ version of this method is more important, so let \n 631    # me stay with QQ. \n 632    # TODO: Fix this. \n```\n\nand\n\n```\n 637    # Ugly hack for the case of an empty tableau, due to the \n 638    # annoyance of Permutation(Tableau([]).row_stabilizer()[0]) \n 639    # being [1] rather than [] (which seems to have its origins in \n 640    # permutation group code). \n```\n\nIf you agree, I'll open these tickets.\n\nApply:\n\n* [attachment:trac_14881-symmetric_group_algebra_rebased-dg.patch]\n* [attachment:trac_14881-review-ts.patch]\n\n====================================================================\n\nThe following rant is being kept for reference; it now has a ticket of its own (#14885) and a sage-devel discussion ( https://groups.google.com/forum/#!topic/sage-devel/tAAb42Edh9o ). The present ticket changes nothing about it.\n\nWriting this patch made me notice that **Sage is using Herstein's idiotic left-to-right convention for the product of permutations as default**! I think the only reason why I have missed this so far is that I haven't been multiplying permutations very often in the first place. That said, I'm not sure about this, and I feel sorry for the conjectures I have been discarding because I thought I was able to produce counterexamples with Sage. Can we do anything about this or at least document it in such a way that it can't be missed? I will open another ticket for this issue once I've done a quick search to see where these multiplications are being used; I wouldn't be surprised if there are bugs lurking in the code just because people expected that Sage would use the same conventions as everyone else in mathematics. I know about GAP, but part of the reason I've been using Sage is to not have to put up with crappy syntax.\n\nWhen I grep for `PermutationOptions` and `permutation_options`, I only get hits from `permutation.py` and `symmetric_group_algebra.py`, which suggests that all other files are either oblivious to the semantics of a product of permutations depending on a global variable, or they just work around this product method. I'm hoping it's the latter...\n\nIssue created by migration from https://trac.sagemath.org/ticket/14881\n\n",
    "closed_at": "2013-09-02T10:19:52Z",
    "created_at": "2013-07-12T12:58:53Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Some symmetric group algebra modifications",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14881",
    "user": "https://github.com/darijgr"
}
```
Assignee: sage-combinat

CC:  sage-combinat @tscrim @mwhansen

Keywords: permutations, symmetric group algebra, combinat,

**UPDATED and ready for review.** The patch does the following:

1) Allows `k = 1` in the construction of the k-th Jucys-Murphy element in both the symmetric group algebra and the Hecke algebra. There is no theoretical reason not to. They're not very interesting elements, but algorithms shouldn't mysteriously fail in corner cases. (Note: I'm treating `k = 1` as a separate case in the Hecke algebra because I want it to return the 1 of the Hecke algebra, not the int 1.)

2) The `algebra_generators()` method on a symmetric group algebra with n being 0 or 1 doesn't throw an error anymore.

3) The `cpi` method should now be a lot faster (checked on S<sub>6</sub> and `[3,2,1]`, where the speedup factor was more than 2).

4) New methods `a` and `b` in `symmetric_group_algebra.py` allow computing the sum of the row-preserving permutations and the alternating sum of the column-preserving permutation of a Young tableau, not just their product. These methods are not exported by default so as not to pollute the namespace.

5) A fix in `tableau.py` ensures that `Tableau([]).row_stabilizer()` behaves as it should. My speed tests are inconclusive, but I don't think this fix has any noticeable impact on overall speed of tableau computations. The assumption I added to the documentation was already needed beforehand; it just wasn't documented.

Issues I'd like the reviewer to look at closely:

A) I removed a "#################### SEGFAULTS ################" comment after a doctests since that doctest doesn't even run close to segfaulting (on my machine, that is). If it had a reason to be there, please insert it back.

B) I don't know what the `star` keyword in my methods is for -- I copied it over from the `e` method (which should be similar to `a` and `b` in various regards), where it was undocumented. Apparently it is used internally in other methods. If you think I should remove it from my methods, I will.

C) There are two TODOs which might deserve tickets of their own.

```
 627    # This all should be over ZZ, not over QQ, but symmetric group 
 628    # algebras don't seem to preserve coercion (the one over ZZ 
 629    # doesn't coerce into the one over QQ even for the same n), 
 630    # and the QQ version of this method is more important, so let 
 631    # me stay with QQ. 
 632    # TODO: Fix this. 
```

and

```
 637    # Ugly hack for the case of an empty tableau, due to the 
 638    # annoyance of Permutation(Tableau([]).row_stabilizer()[0]) 
 639    # being [1] rather than [] (which seems to have its origins in 
 640    # permutation group code). 
```

If you agree, I'll open these tickets.

Apply:

* [attachment:trac_14881-symmetric_group_algebra_rebased-dg.patch]
* [attachment:trac_14881-review-ts.patch]

====================================================================

The following rant is being kept for reference; it now has a ticket of its own (#14885) and a sage-devel discussion ( https://groups.google.com/forum/#!topic/sage-devel/tAAb42Edh9o ). The present ticket changes nothing about it.

Writing this patch made me notice that **Sage is using Herstein's idiotic left-to-right convention for the product of permutations as default**! I think the only reason why I have missed this so far is that I haven't been multiplying permutations very often in the first place. That said, I'm not sure about this, and I feel sorry for the conjectures I have been discarding because I thought I was able to produce counterexamples with Sage. Can we do anything about this or at least document it in such a way that it can't be missed? I will open another ticket for this issue once I've done a quick search to see where these multiplications are being used; I wouldn't be surprised if there are bugs lurking in the code just because people expected that Sage would use the same conventions as everyone else in mathematics. I know about GAP, but part of the reason I've been using Sage is to not have to put up with crappy syntax.

When I grep for `PermutationOptions` and `permutation_options`, I only get hits from `permutation.py` and `symmetric_group_algebra.py`, which suggests that all other files are either oblivious to the semantics of a product of permutations depending on a global variable, or they just work around this product method. I'm hoping it's the latter...

Issue created by migration from https://trac.sagemath.org/ticket/14881





---

archive/issue_comments_186597.json:
```json
{
    "body": "Attachment [trac_14881-symmetric_group_algebra-dg.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-symmetric_group_algebra-dg.patch) by @darijgr created at 2013-07-12 12:59:30",
    "created_at": "2013-07-12T12:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186597",
    "user": "https://github.com/darijgr"
}
```

Attachment [trac_14881-symmetric_group_algebra-dg.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-symmetric_group_algebra-dg.patch) by @darijgr created at 2013-07-12 12:59:30



---

archive/issue_comments_186598.json:
```json
{
    "body": "Changing assignee from tbd to sage-combinat.",
    "created_at": "2013-07-12T12:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186598",
    "user": "https://github.com/darijgr"
}
```

Changing assignee from tbd to sage-combinat.



---

archive/issue_comments_186599.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2013-07-12T12:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186599",
    "user": "https://github.com/darijgr"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_186600.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2013-07-12T12:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186600",
    "user": "https://github.com/darijgr"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_186601.json:
```json
{
    "body": "For the multiplication, you can at present set the permutation options (if you look in the `permutation.py`, it's in there, I forget how its accessed). However with #14772, this will be a global option accessible by\n\n```\nPermutations.global_options(mult='r2l') # or 'l2r'\n```\nIf the global options in #14772 (which needs another review) isn't well documented enough, I can add some more documentation on it.\n\nI'd recommend starting to work based on #14772 which should be good to go now, if you want to work on permutations. Its dependency #14519 is basically done too, and I'll ask Nicolas to re-review it if he doesn't do so in a few days.\n\nBest,\n\nTravis",
    "created_at": "2013-07-12T13:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186601",
    "user": "https://github.com/tscrim"
}
```

For the multiplication, you can at present set the permutation options (if you look in the `permutation.py`, it's in there, I forget how its accessed). However with #14772, this will be a global option accessible by

```
Permutations.global_options(mult='r2l') # or 'l2r'
```
If the global options in #14772 (which needs another review) isn't well documented enough, I can add some more documentation on it.

I'd recommend starting to work based on #14772 which should be good to go now, if you want to work on permutations. Its dependency #14519 is basically done too, and I'll ask Nicolas to re-review it if he doesn't do so in a few days.

Best,

Travis



---

archive/issue_comments_186602.json:
```json
{
    "body": "Travis -- thank you for reminding me of #14772 (which happened to fix another problem I reported today). I'll rebase my patch atop yours in a couple minutes.\n\nThanks for cleaning up the global options, but I fear I still don't like them. This isn't the right ticket for me to rant about them; I'll open a new one today.",
    "created_at": "2013-07-12T14:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186602",
    "user": "https://github.com/darijgr"
}
```

Travis -- thank you for reminding me of #14772 (which happened to fix another problem I reported today). I'll rebase my patch atop yours in a couple minutes.

Thanks for cleaning up the global options, but I fear I still don't like them. This isn't the right ticket for me to rant about them; I'll open a new one today.



---

archive/issue_comments_186603.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-07-13T13:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186603",
    "user": "https://github.com/darijgr"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_186604.json:
```json
{
    "body": "for the patchbot:\n\napply trac_14881-symmetric_group_algebra_rebased-dg.patch",
    "created_at": "2013-07-13T13:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186604",
    "user": "https://github.com/darijgr"
}
```

for the patchbot:

apply trac_14881-symmetric_group_algebra_rebased-dg.patch



---

archive/issue_comments_186605.json:
```json
{
    "body": "Sorry, one final update. I've slightly changed my own fix for Jucys-Murphy in the Hecke algebra, and modernized all errors.",
    "created_at": "2013-07-13T19:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186605",
    "user": "https://github.com/darijgr"
}
```

Sorry, one final update. I've slightly changed my own fix for Jucys-Murphy in the Hecke algebra, and modernized all errors.



---

archive/issue_comments_186606.json:
```json
{
    "body": "Hey Darij,\n\nI'm starting to take a look at this patch. A question, are the names `a` and `b` standard, in particular, do you have at least 2 references (to show that it is a standard notation)? If they aren't standard, could you rename them? The function names otherwise are not very descriptive. Also could you also remove the commented out lines 292-295?\n\nThanks,\n\nTravis\n\nPS - Sorry for falling behind on this.",
    "created_at": "2013-08-03T11:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186606",
    "user": "https://github.com/tscrim"
}
```

Hey Darij,

I'm starting to take a look at this patch. A question, are the names `a` and `b` standard, in particular, do you have at least 2 references (to show that it is a standard notation)? If they aren't standard, could you rename them? The function names otherwise are not very descriptive. Also could you also remove the commented out lines 292-295?

Thanks,

Travis

PS - Sorry for falling behind on this.



---

archive/issue_comments_186607.json:
```json
{
    "body": "Hi Travis,\n\nI've got the `a` and `b` names from \u00a74.12 of Pavel Etingof et al.'s representation theory notes ( http://www-math.mit.edu/~etingof/replect.pdf ). They also appear in http://en.wikipedia.org/wiki/Young_symmetrizer and in \u00a74.1 of Fulton-Harris (not a good reference if you ask me). Ironically, it seems that most of the deeper-going texts on representations of S_n (James, James-Kerber, Sagan) avoid Young symmetrizers completely, so it's hard to tell what is standard.\n\nI'll make the changes you've asked for in a moment.\n\nBest regards,\nDarij",
    "created_at": "2013-08-03T12:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186607",
    "user": "https://github.com/darijgr"
}
```

Hi Travis,

I've got the `a` and `b` names from §4.12 of Pavel Etingof et al.'s representation theory notes ( http://www-math.mit.edu/~etingof/replect.pdf ). They also appear in http://en.wikipedia.org/wiki/Young_symmetrizer and in §4.1 of Fulton-Harris (not a good reference if you ask me). Ironically, it seems that most of the deeper-going texts on representations of S_n (James, James-Kerber, Sagan) avoid Young symmetrizers completely, so it's hard to tell what is standard.

I'll make the changes you've asked for in a moment.

Best regards,
Darij



---

archive/issue_comments_186608.json:
```json
{
    "body": "Ah okay. Then `a` and `b` are fine. I'll finish the review as soon as I'm able to, but I won't be able to look at it until at least 2 days from now (I'm traveling back from South Korea tomorrow morning [it's 9:15 PM if you're curious] to the US) so there's no rush.\n\nThanks,\n\nTravis",
    "created_at": "2013-08-03T12:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186608",
    "user": "https://github.com/tscrim"
}
```

Ah okay. Then `a` and `b` are fine. I'll finish the review as soon as I'm able to, but I won't be able to look at it until at least 2 days from now (I'm traveling back from South Korea tomorrow morning [it's 9:15 PM if you're curious] to the US) so there's no rush.

Thanks,

Travis



---

archive/issue_comments_186609.json:
```json
{
    "body": "Updated; please review!",
    "created_at": "2013-08-03T12:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186609",
    "user": "https://github.com/darijgr"
}
```

Updated; please review!



---

archive/issue_comments_186610.json:
```json
{
    "body": "Attachment [trac_14881-symmetric_group_algebra_rebased-dg.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-symmetric_group_algebra_rebased-dg.patch) by @darijgr created at 2013-08-03 12:15:22\n\nAdded the Etingof reference; removed the commented-out old code.",
    "created_at": "2013-08-03T12:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186610",
    "user": "https://github.com/darijgr"
}
```

Attachment [trac_14881-symmetric_group_algebra_rebased-dg.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-symmetric_group_algebra_rebased-dg.patch) by @darijgr created at 2013-08-03 12:15:22

Added the Etingof reference; removed the commented-out old code.



---

archive/issue_comments_186611.json:
```json
{
    "body": "Hey Darij,\n\nHere's a small review patch which makes some minor tweaks to the doc and removes two asserts used for input checking. If you're happy with my changes, you can go ahead and set this to positive review.\n\nBest,\n\nTravis\n\nFor patchbot:\n\nApply: trac_14881-symmetric_group_algebra_rebased-dg.patch trac_14881-review-ts.patch",
    "created_at": "2013-08-08T19:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186611",
    "user": "https://github.com/tscrim"
}
```

Hey Darij,

Here's a small review patch which makes some minor tweaks to the doc and removes two asserts used for input checking. If you're happy with my changes, you can go ahead and set this to positive review.

Best,

Travis

For patchbot:

Apply: trac_14881-symmetric_group_algebra_rebased-dg.patch trac_14881-review-ts.patch



---

archive/issue_comments_186612.json:
```json
{
    "body": "Thank you! Only issue now is that \"orders\" should be \"order\" in\n\n```\n         - ``other`` -- a symmetric group algebra with orders `p` \n```\n\nNice syntax for the error messages; I didn't know of it.\n\nPlease set to positive-review once you've fixed the typo.",
    "created_at": "2013-08-08T19:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186612",
    "user": "https://github.com/darijgr"
}
```

Thank you! Only issue now is that "orders" should be "order" in

```
         - ``other`` -- a symmetric group algebra with orders `p` 
```

Nice syntax for the error messages; I didn't know of it.

Please set to positive-review once you've fixed the typo.



---

archive/issue_comments_186613.json:
```json
{
    "body": "Attachment [trac_14881-review-ts.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-review-ts.patch) by @tscrim created at 2013-08-09 21:04:54\n\nIt's the (new) python 2.6+ string formatting and will be replacing the `%` at some point in the near python future (in python 3 it is strongly suggested to not use the `%`).\n\nFor patchbot:\n\nApply: trac_14881-symmetric_group_algebra_rebased-dg.patch, trac_14881-review-ts.patch",
    "created_at": "2013-08-09T21:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186613",
    "user": "https://github.com/tscrim"
}
```

Attachment [trac_14881-review-ts.patch](tarball://root/attachments/some-uuid/ticket14881/trac_14881-review-ts.patch) by @tscrim created at 2013-08-09 21:04:54

It's the (new) python 2.6+ string formatting and will be replacing the `%` at some point in the near python future (in python 3 it is strongly suggested to not use the `%`).

For patchbot:

Apply: trac_14881-symmetric_group_algebra_rebased-dg.patch, trac_14881-review-ts.patch



---

archive/issue_comments_186614.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-08-09T21:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186614",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_042758.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-09-02T10:19:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14881#event-42758"
}
```



---

archive/issue_comments_186615.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-09-02T10:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14881#issuecomment-186615",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
