# Issue 14556: The maxima spkg has cruft dating back to days of clisp use

archive/issues_014352.json:
```json
{
    "body": "The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg) ([spkg diff p2] + [attachment:maxima-5.29.1.p3.diff spkg diff p3](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))\n\n**sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library\n\n**Assignee:** @jdemeyer\n\n**CC:**  @kiwifb\n\n**Keywords:** noreadline\n\n**Reviewer:** Jeroen Demeyer, Julien Puydt\n\n**Author:** Julien Puydt, Jeroen Demeyer\n\n**Merged:** sage-5.10.beta5\n\nIssue created by migration from https://trac.sagemath.org/ticket/14556\n\n",
    "closed_at": "2013-05-26T19:49:02Z",
    "created_at": "2013-05-08T18:57:37Z",
    "labels": [
        "component: packages: standard",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.10",
    "title": "The maxima spkg has cruft dating back to days of clisp use",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/14556",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```
The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg) ([spkg diff p2] + [attachment:maxima-5.29.1.p3.diff spkg diff p3](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))

**sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library

**Assignee:** @jdemeyer

**CC:**  @kiwifb

**Keywords:** noreadline

**Reviewer:** Jeroen Demeyer, Julien Puydt

**Author:** Julien Puydt, Jeroen Demeyer

**Merged:** sage-5.10.beta5

Issue created by migration from https://trac.sagemath.org/ticket/14556





---

archive/issue_comments_178723.json:
```json
{
    "body": "Replying to [ticket:14556 Snark]:\n> I might work on it myself, but first I must ask on which maxima spkg I should base my work on\n\n[http://boxen.math.washington.edu/home/release/sage-5.10.beta2/sage-5.10.beta2/spkg/standard/maxima-5.29.1.p1.spkg](http://boxen.math.washington.edu/home/release/sage-5.10.beta2/sage-5.10.beta2/spkg/standard/maxima-5.29.1.p1.spkg)",
    "created_at": "2013-05-08T21:52:36Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178723",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:14556 Snark]:
> I might work on it myself, but first I must ask on which maxima spkg I should base my work on

[http://boxen.math.washington.edu/home/release/sage-5.10.beta2/sage-5.10.beta2/spkg/standard/maxima-5.29.1.p1.spkg](http://boxen.math.washington.edu/home/release/sage-5.10.beta2/sage-5.10.beta2/spkg/standard/maxima-5.29.1.p1.spkg)



---

archive/issue_comments_178724.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n The maxima spkg creates a maxima-noreadline executable, which is an old hack. This should go away.\n-\n-I might work on it myself, but first I must ask on which maxima spkg I should base my work on (a question which will disappear with the git transition...)\n``````\n",
    "created_at": "2013-05-08T21:52:36Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178724",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1 @@
 The maxima spkg creates a maxima-noreadline executable, which is an old hack. This should go away.
-
-I might work on it myself, but first I must ask on which maxima spkg I should base my work on (a question which will disappear with the git transition...)
``````




---

archive/issue_comments_178725.json:
```json
{
    "body": "Patch to the sage library",
    "created_at": "2013-05-09T12:59:59Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178725",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Patch to the sage library



---

archive/attachments_020316.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14556_sagelib.patch",
    "asset_url": "tarball://root/attachments/ticket14556/trac_14556_sagelib.patch",
    "created_at": "2013-05-09T13:01:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```



---

archive/issue_comments_178726.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Attachment:** [trac_14556_sagelib.patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch)\n\nThe two attached patches should fix this ticket.",
    "created_at": "2013-05-09T13:01:51Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178726",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:3'></a>
**Attachment:** [trac_14556_sagelib.patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch)

The two attached patches should fix this ticket.



---

archive/issue_events_126737.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Snark",
    "created_at": "2013-05-09T13:01:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14556#event-126737"
}
```



---

archive/issue_comments_178727.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"noreadline\".",
    "created_at": "2013-05-11T12:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178727",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "" to "noreadline".



---

archive/issue_comments_178728.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n-The maxima spkg creates a maxima-noreadline executable, which is an old hack. This should go away.\n+The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.\n+\n``````\n",
    "created_at": "2013-05-11T12:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178728",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,2 @@
-The maxima spkg creates a maxima-noreadline executable, which is an old hack. This should go away.
+The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.
+
``````




---

archive/issue_comments_178729.json:
```json
{
    "body": "**Author:** Julien Puydt",
    "created_at": "2013-05-11T12:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178729",
    "user": "https://github.com/nexttime"
}
```

**Author:** Julien Puydt



---

archive/issue_comments_178730.json:
```json
{
    "body": "<a id='comment:4'></a>\nYou should also provide a \"pre-patched\" new spkg, with `SPKG.txt` updated as well.",
    "created_at": "2013-05-11T12:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178730",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
You should also provide a "pre-patched" new spkg, with `SPKG.txt` updated as well.



---

archive/issue_comments_178731.json:
```json
{
    "body": "Patch to the maxima spkg",
    "created_at": "2013-05-11T14:07:17Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178731",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Patch to the maxima spkg



---

archive/attachments_020317.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_14556_maxima.patch",
    "asset_url": "tarball://root/attachments/ticket14556/trac_14556_maxima.patch",
    "created_at": "2013-05-11T14:10:08Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```



---

archive/issue_comments_178732.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Attachment:** [trac_14556_maxima.patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch)\n\nI updated the patch, and the patched spkg can be found [here](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg)",
    "created_at": "2013-05-11T14:10:08Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178732",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:5'></a>
**Attachment:** [trac_14556_maxima.patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch)

I updated the patch, and the patched spkg can be found [here](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg)



---

archive/issue_comments_178733.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,3 @@\n The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.\n \n+**spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))\n``````\n",
    "created_at": "2013-05-16T07:20:33Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178733",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,3 @@
 The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.
 
+**spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))
``````




---

archive/issue_comments_178734.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.\n \n **spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))\n+\n+**sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library\n``````\n",
    "created_at": "2013-05-16T18:14:27Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178734",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.
 
 **spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))
+
+**sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library
``````




---

archive/issue_comments_178735.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.\n \n-**spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg) ([spkg diff p2] + [attachment:maxima-5.29.1.p3.diff spkg diff p3](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))\n \n **sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library\n``````\n",
    "created_at": "2013-05-24T11:47:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178735",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 The maxima spkg creates a `maxima-noreadline` script, which is an old hack. This should go away.
 
-**spkg**: [http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg](http://boxen.math.washington.edu/home/jpuydt/maxima-5.29.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.29.1.p3.spkg) ([spkg diff p2] + [attachment:maxima-5.29.1.p3.diff spkg diff p3](https://github.com/sagemath/sage/files/ticket14556/trac_14556_maxima.patch))
 
 **sagelib**: [patch](https://github.com/sagemath/sage/files/ticket14556/trac_14556_sagelib.patch) for the sage library
``````




---

archive/issue_comments_178736.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2013-05-24T11:47:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178736",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/attachments_020318.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "maxima-5.29.1.p3.diff",
    "asset_url": "tarball://root/attachments/ticket14556/maxima-5.29.1.p3.diff",
    "created_at": "2013-05-24T11:47:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket14556/maxima-5.29.1.p3.diff",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_178737.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Attachment:** [maxima-5.29.1.p3.diff](https://github.com/sagemath/sage/files/ticket14556/maxima-5.29.1.p3.diff)\n\nPositive review to your changes.\n\nHowever, I added some more small changes to the maxima spkg, please review.",
    "created_at": "2013-05-24T11:47:04Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178737",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
**Attachment:** [maxima-5.29.1.p3.diff](https://github.com/sagemath/sage/files/ticket14556/maxima-5.29.1.p3.diff)

Positive review to your changes.

However, I added some more small changes to the maxima spkg, please review.



---

archive/issue_comments_178738.json:
```json
{
    "body": "<a id='comment:9'></a>\nReviewed, with nothing bad to say.",
    "created_at": "2013-05-25T06:58:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178738",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:9'></a>
Reviewed, with nothing bad to say.



---

archive/issue_events_126738.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Snark",
    "created_at": "2013-05-25T06:58:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14556#event-126738"
}
```



---

archive/issue_events_126739.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Snark",
    "created_at": "2013-05-25T06:58:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14556#event-126739"
}
```



---

archive/issue_comments_178739.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Julien Puydt\".",
    "created_at": "2013-05-25T06:58:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178739",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

**Changing reviewer** from "Jeroen Demeyer" to "Jeroen Demeyer, Julien Puydt".



---

archive/issue_comments_178740.json:
```json
{
    "body": "**Changing author** from \"Julien Puydt\" to \"Julien Puydt, Jeroen Demeyer\".",
    "created_at": "2013-05-25T06:58:20Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178740",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

**Changing author** from "Julien Puydt" to "Julien Puydt, Jeroen Demeyer".



---

archive/issue_events_126740.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-26T19:49:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14556#event-126740"
}
```



---

archive/issue_events_126741.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-26T19:49:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14556#event-126741"
}
```



---

archive/issue_comments_178741.json:
```json
{
    "body": "**Merged:** sage-5.10.beta5",
    "created_at": "2013-05-26T19:49:02Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178741",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.10.beta5



---

archive/issue_comments_178742.json:
```json
{
    "body": "<a id='comment:12'></a>\nDid anyone actually try upgrading with this?  From beta4 - and don't try to tell me that was just a beta ;-)\n\n```\ntest -d binary-ecl || mkdir binary-ecl\necl -norc -eval '(progn (load \"../lisp-utils/defsystem.lisp\") (funcall (intern (symbol-name :operate-on-system) :mk) \"maxima\" :compile :verbose t) (build-maxima-lib))' -$\n;;; Loading \"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/../lisp-utils/defsystem.lisp\"\n;;; Loading #P\"/Users/.../sage-5.10.beta3/local/lib/ecl/cmp.fas\"\n;;; Loading \"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima.system\"\n\n;  - Compiling defsystem \"maxima\"\n;    - Compiling module \"package\"\n;      - Compiling source file\n;        \"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp\"\n;;;\n;;; Compiling /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp.\n;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=2\n;;;\n;;; End of Pass 1.\n;;; Internal error:\n;;;   ** Unable to find include directory\n;      - Binary file binary-ecl/maxima-package.fas is old or does not exist.\n;        Compile (and load) source file /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp instead? y\n;      - Should I bother you if this happens again? y\n;      - Compiling source file\n;        \"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp\"\n;;;\n;;; Compiling /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp.\n;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=2\n;;;\n;;; End of Pass 1.\n;;; Internal error:\n;;;   ** Unable to find include directory\n;      - Loading binary file \"binary-ecl/maxima-package.fas\" An error occurred during initialization:\nFilesystem error with pathname #P\"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/maxima-package.fas\".\nEither\n 1) the file does not exist, or\n 2) we are not allowed to access the file, or\n 3) the pathname points to a broken symbolic link..\nmake[3]: *** [binary-ecl/maxima] Error 1\nmake[2]: *** [all-recursive] Error 1\n***********************************************************\nError: Failed to build Maxima.\n***********************************************************\n```",
    "created_at": "2013-05-28T02:03:55Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178742",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Did anyone actually try upgrading with this?  From beta4 - and don't try to tell me that was just a beta ;-)

```
test -d binary-ecl || mkdir binary-ecl
ecl -norc -eval '(progn (load "../lisp-utils/defsystem.lisp") (funcall (intern (symbol-name :operate-on-system) :mk) "maxima" :compile :verbose t) (build-maxima-lib))' -$
;;; Loading "/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/../lisp-utils/defsystem.lisp"
;;; Loading #P"/Users/.../sage-5.10.beta3/local/lib/ecl/cmp.fas"
;;; Loading "/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima.system"

;  - Compiling defsystem "maxima"
;    - Compiling module "package"
;      - Compiling source file
;        "/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp"
;;;
;;; Compiling /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp.
;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=2
;;;
;;; End of Pass 1.
;;; Internal error:
;;;   ** Unable to find include directory
;      - Binary file binary-ecl/maxima-package.fas is old or does not exist.
;        Compile (and load) source file /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp instead? y
;      - Should I bother you if this happens again? y
;      - Compiling source file
;        "/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp"
;;;
;;; Compiling /Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/maxima-package.lisp.
;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=2
;;;
;;; End of Pass 1.
;;; Internal error:
;;;   ** Unable to find include directory
;      - Loading binary file "binary-ecl/maxima-package.fas" An error occurred during initialization:
Filesystem error with pathname #P"/Users/.../sage-5.10.beta3/spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/maxima-package.fas".
Either
 1) the file does not exist, or
 2) we are not allowed to access the file, or
 3) the pathname points to a broken symbolic link..
make[3]: *** [binary-ecl/maxima] Error 1
make[2]: *** [all-recursive] Error 1
***********************************************************
Error: Failed to build Maxima.
***********************************************************
```



---

archive/issue_comments_178743.json:
```json
{
    "body": "<a id='comment:13'></a>\nI'd also be skeptical of removing the OS X workaround unless we're sure that really doesn't cause problems on any Mac platforms.  Though I wouldn't be surprised if it turned out to be unnecessary with the latest ECL - I think that message dates to clisp, maybe that was part of the issue.",
    "created_at": "2013-05-28T02:07:28Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178743",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
I'd also be skeptical of removing the OS X workaround unless we're sure that really doesn't cause problems on any Mac platforms.  Though I wouldn't be surprised if it turned out to be unnecessary with the latest ECL - I think that message dates to clisp, maybe that was part of the issue.



---

archive/issue_comments_178744.json:
```json
{
    "body": "<a id='comment:14'></a>\nI don't think that was a clisp workaround but I could be wrong. So building from scratch on OS X works but upgrading doesn't?",
    "created_at": "2013-05-28T02:10:38Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178744",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
I don't think that was a clisp workaround but I could be wrong. So building from scratch on OS X works but upgrading doesn't?



---

archive/issue_comments_178745.json:
```json
{
    "body": "<a id='comment:15'></a>\n> So building from scratch on OS X works but upgrading doesn't?\n\nI don't know.  I only just now got back online after the US holiday weekend and tried upgrading.  I assume Jeroen built from scratch before merging, however, but he probably only tests upgrades from major to major release on every platform... anyway, it's quite reproducible with this setup on my 10.7 Intel machine.",
    "created_at": "2013-05-28T02:18:25Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178745",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
> So building from scratch on OS X works but upgrading doesn't?

I don't know.  I only just now got back online after the US holiday weekend and tried upgrading.  I assume Jeroen built from scratch before merging, however, but he probably only tests upgrades from major to major release on every platform... anyway, it's quite reproducible with this setup on my 10.7 Intel machine.



---

archive/issue_comments_178746.json:
```json
{
    "body": "<a id='comment:16'></a>\nIt is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.",
    "created_at": "2013-05-28T02:39:25Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178746",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'></a>
It is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.



---

archive/issue_comments_178747.json:
```json
{
    "body": "<a id='comment:17'></a>\nWell, unless something else got (unintentionally) messed up in the spkg , the only relevant change *is* the removal of redirecting `stdout` and `stderr` to files on MacOS X, in Jeroen's `.p3`.",
    "created_at": "2013-05-28T03:14:19Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178747",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>
Well, unless something else got (unintentionally) messed up in the spkg , the only relevant change *is* the removal of redirecting `stdout` and `stderr` to files on MacOS X, in Jeroen's `.p3`.



---

archive/issue_comments_178748.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [kcrisman](#comment%3A13):\n> I'd also be skeptical of removing the OS X workaround\n\nFair enough, but partially the reason for removal was that it was an undocumented fix. I really dislike \"workarounds\" without any reference to a ticket or clues what the problem is. And I even looked on the ticket numbers from the spkg, but couldn't find any reference to this problem on any Trac ticket.",
    "created_at": "2013-05-28T06:49:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178748",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [kcrisman](#comment%3A13):
> I'd also be skeptical of removing the OS X workaround

Fair enough, but partially the reason for removal was that it was an undocumented fix. I really dislike "workarounds" without any reference to a ticket or clues what the problem is. And I even looked on the ticket numbers from the spkg, but couldn't find any reference to this problem on any Trac ticket.



---

archive/issue_comments_178749.json:
```json
{
    "body": "<a id='comment:19'></a>\nI spent some time with hgview to scan the hg repo of the maxima spkg. This is in the initial commit on 23/07/2007 by wstein\n\n```\nif [ `uname` = \"Darwin\" ]; then\n   echo \"Now building maxima; this takes a few minutes\"\n   echo \"Since we're using OS X and there is a very weird\"\n   echo \"bug with buffered output while building maxima,\"\n   echo \"you will not be able to see the output of the build\"\n   echo \"as it occurs.  Don't worry, the build process did\"\n   echo \"not hang.\"\n   make > output.log\nelse\n   make\nfi\n```\nAnd the second commit of the repo has the following change, also by wstein on 2/11/2007\n\n```\n@@ -31,8 +39,10 @@\n    echo \"you will not be able to see the output of the build\"\n    echo \"as it occurs.  Don't worry, the build process did\"\n    echo \"not hang.\"\n-   make > output.log\n+   make >> \"$CUR\"/output.log  2>> \"$CUR\"/error.log\n else\n+\n+\n    make\n fi\n check_error \"Failed to make Maxima.\" \n```\nneither have trac tickets. trac tickets are vaguely mentioned in the commit message on occasion in 2008 and 2009, they are regulary in commit message in 2010 and the first time SPKG.txt quote a trac ticket is 13/02/2011. When did Jeroen become the release manager already???\n\nThat was some archeology. The work around has been in the spkg since 2007. maxima on a gentoo prefix on OS X doesn't have any buffering problems at build time.",
    "created_at": "2013-05-28T09:48:28Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178749",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
I spent some time with hgview to scan the hg repo of the maxima spkg. This is in the initial commit on 23/07/2007 by wstein

```
if [ `uname` = "Darwin" ]; then
   echo "Now building maxima; this takes a few minutes"
   echo "Since we're using OS X and there is a very weird"
   echo "bug with buffered output while building maxima,"
   echo "you will not be able to see the output of the build"
   echo "as it occurs.  Don't worry, the build process did"
   echo "not hang."
   make > output.log
else
   make
fi
```
And the second commit of the repo has the following change, also by wstein on 2/11/2007

```
@@ -31,8 +39,10 @@
    echo "you will not be able to see the output of the build"
    echo "as it occurs.  Don't worry, the build process did"
    echo "not hang."
-   make > output.log
+   make >> "$CUR"/output.log  2>> "$CUR"/error.log
 else
+
+
    make
 fi
 check_error "Failed to make Maxima." 
```
neither have trac tickets. trac tickets are vaguely mentioned in the commit message on occasion in 2008 and 2009, they are regulary in commit message in 2010 and the first time SPKG.txt quote a trac ticket is 13/02/2011. When did Jeroen become the release manager already???

That was some archeology. The work around has been in the spkg since 2007. maxima on a gentoo prefix on OS X doesn't have any buffering problems at build time.



---

archive/issue_comments_178750.json:
```json
{
    "body": "<a id='comment:20'></a>\n> It is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.\n\nThe rest of the log is completely ordinary, same as always.  At this point I'm just asking for someone else to test upgrading for this spkg.\n\nIndeed,\n\n```\n$ ls spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/\nmaxima-package.c\tmaxima-package.data\tmaxima-package.eclh\n```\n\nAs to the removal of the buffering fix thingie, I'm not worried about it as long as Jeroen has indeed tested it on a variety of machines, which sounds like it is the case.  I agree that commits from 2007 made by William are likely to be suspect and undocumented ;-)",
    "created_at": "2013-05-28T12:57:33Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178750",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>
> It is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.

The rest of the log is completely ordinary, same as always.  At this point I'm just asking for someone else to test upgrading for this spkg.

Indeed,

```
$ ls spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/
maxima-package.c	maxima-package.data	maxima-package.eclh
```

As to the removal of the buffering fix thingie, I'm not worried about it as long as Jeroen has indeed tested it on a variety of machines, which sounds like it is the case.  I agree that commits from 2007 made by William are likely to be suspect and undocumented ;-)



---

archive/issue_comments_178751.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [kcrisman](#comment%3A20):\n> > It is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.\n\n> The rest of the log is completely ordinary, same as always.  At this point I'm just asking for someone else to test upgrading for this spkg.\n> \n> Indeed,\n> \n> ```\n> $ ls spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/\n> maxima-package.c\tmaxima-package.data\tmaxima-package.eclh\n> ```\n\nWeirdly, now as I try to reinstall the p1 spkg, I get the same problem! Of course, it doesn't show up on the screen, but in error.log it's there, and the `binary-ecl` folder has the same three files.\n\nIs it possible we have to touch ecl first so that it upgrades when upgrading this?  I don't see why, but I'll try that next.",
    "created_at": "2013-05-28T13:23:05Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178751",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:21'></a>
Replying to [kcrisman](#comment%3A20):
> > It is quite weird. But I assume this is material for a new ticket now, is it the full log for maxima? If you have more before that I think we should inspect it.

> The rest of the log is completely ordinary, same as always.  At this point I'm just asking for someone else to test upgrading for this spkg.
> 
> Indeed,
> 
> ```
> $ ls spkg/build/maxima-5.29.1.p3/src/src/binary-ecl/
> maxima-package.c	maxima-package.data	maxima-package.eclh
> ```

Weirdly, now as I try to reinstall the p1 spkg, I get the same problem! Of course, it doesn't show up on the screen, but in error.log it's there, and the `binary-ecl` folder has the same three files.

Is it possible we have to touch ecl first so that it upgrades when upgrading this?  I don't see why, but I'll try that next.



---

archive/issue_comments_178752.json:
```json
{
    "body": "<a id='comment:22'></a>\n> Weirdly, now as I try to reinstall the p1 spkg, I get the same problem! Of course, it doesn't show up on the screen, but in error.log it's there, and the `binary-ecl` folder has the same three files.\n> \n> Is it possible we have to touch ecl first so that it upgrades when upgrading this?  I don't see why, but I'll try that next.\n\nApparently this (reinstalling ecl) solves the problem.  I strongly suggest that someone else verify this before Sage 5.10 is released.",
    "created_at": "2013-05-28T13:58:55Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178752",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'></a>
> Weirdly, now as I try to reinstall the p1 spkg, I get the same problem! Of course, it doesn't show up on the screen, but in error.log it's there, and the `binary-ecl` folder has the same three files.
> 
> Is it possible we have to touch ecl first so that it upgrades when upgrading this?  I don't see why, but I'll try that next.

Apparently this (reinstalling ecl) solves the problem.  I strongly suggest that someone else verify this before Sage 5.10 is released.



---

archive/issue_comments_178753.json:
```json
{
    "body": "<a id='comment:23'></a>\nThe ecl/maxima building problem again. ecl has been updated in beta2 so it shouldn't have been a problem updating from beta4. Did you move sage at some point before upgrading?",
    "created_at": "2013-05-29T00:16:11Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178753",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
The ecl/maxima building problem again. ecl has been updated in beta2 so it shouldn't have been a problem updating from beta4. Did you move sage at some point before upgrading?



---

archive/issue_comments_178754.json:
```json
{
    "body": "<a id='comment:24'></a>\nYes, because I had upgraded several times in a row and then renamed the folder.\n\nI'll be mostly offline for a few days now, so I won't be able to reproduce this, but I am pretty certain that somehow this was the issue.",
    "created_at": "2013-05-29T00:46:27Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178754",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>
Yes, because I had upgraded several times in a row and then renamed the folder.

I'll be mostly offline for a few days now, so I won't be able to reproduce this, but I am pretty certain that somehow this was the issue.



---

archive/issue_comments_178755.json:
```json
{
    "body": "<a id='comment:25'></a>\necl/maxima build issue confirmed. It seems that the following doesn't work:\n\n1. build `ecl`\n2. move Sage tree\n3. build `maxima`",
    "created_at": "2013-05-30T09:54:19Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178755",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
ecl/maxima build issue confirmed. It seems that the following doesn't work:

1. build `ecl`
2. move Sage tree
3. build `maxima`



---

archive/issue_comments_178756.json:
```json
{
    "body": "<a id='comment:26'></a>\nAgain... we already dealt with that in the past. In any case it shouldn't be related to this ticket. It is really an ecl issue not a maxima one. The maxima bump just made it apparent.",
    "created_at": "2013-05-30T10:48:57Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178756",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>
Again... we already dealt with that in the past. In any case it shouldn't be related to this ticket. It is really an ecl issue not a maxima one. The maxima bump just made it apparent.



---

archive/issue_comments_178757.json:
```json
{
    "body": "<a id='comment:27'></a>\nFollow-up: #11359.",
    "created_at": "2013-05-30T10:49:59Z",
    "issue": "https://github.com/sagemath/sage/issues/14556",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14556#issuecomment-178757",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Follow-up: #11359.
