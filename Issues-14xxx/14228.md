# Issue 14228: Caching of data needed for computations in k_dual

archive/issues_014024.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "#12313 brought a severe slow-down to sage.combinat.sf.k_dual. The purpose of task #13991 is to mitigate this. The purpose of this ticket is to deal with one aspect of the slow-down.\n\nCertain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.\n\nApply\n\n- [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)\n- [attachment: trac_14228-reviewer.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)\n\nDepends on #13605\nDepends on #14225\n\nCC:  @sagetrac-sage-combinat @tscrim @nthiery @nbruin @zabrocki\n\nComponent: **combinatorics**\n\nAuthor: **Travis Scrimshaw**\n\nReviewer: **Simon King**\n\nMerged: **sage-5.8.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14228_\n\n",
    "closed_at": "2013-03-07T18:26:48Z",
    "created_at": "2013-03-05T12:43:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Caching of data needed for computations in k_dual",
    "type": "issue",
    "updated_at": "2013-03-07T18:26:48Z",
    "url": "https://github.com/sagemath/sage/issues/14228",
    "user": "https://github.com/simon-king-jena"
}
```
#12313 brought a severe slow-down to sage.combinat.sf.k_dual. The purpose of task #13991 is to mitigate this. The purpose of this ticket is to deal with one aspect of the slow-down.

Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.

Apply

- [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)
- [attachment: trac_14228-reviewer.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)

Depends on #13605
Depends on #14225

CC:  @sagetrac-sage-combinat @tscrim @nthiery @nbruin @zabrocki

Component: **combinatorics**

Author: **Travis Scrimshaw**

Reviewer: **Simon King**

Merged: **sage-5.8.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/14228_





---

archive/issue_events_198591.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T12:43:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198591"
}
```



---

archive/issue_events_198592.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T12:43:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198592"
}
```



---

archive/issue_events_198593.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T12:43:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198593"
}
```



---

archive/issue_events_198594.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T12:43:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198594"
}
```



---

archive/issue_events_198595.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2013-03-05T12:43:59Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "subject": "https://github.com/simon-king-jena",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198595"
}
```



---

archive/issue_comments_169953.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_14288-partition_caches.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14288-partition_caches.patch.gz)**",
    "created_at": "2013-03-05T12:48:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169953",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_14288-partition_caches.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14288-partition_caches.patch.gz)**



---

archive/issue_events_198596.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T12:48:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198596"
}
```



---

archive/issue_comments_169954.json:
```json
{
    "body": "Dependencies: **#13605**",
    "created_at": "2013-03-05T12:48:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169954",
    "user": "https://github.com/simon-king-jena"
}
```

Dependencies: **#13605**



---

archive/issue_comments_169955.json:
```json
{
    "body": "Attachment: **[trac_14228-partition_caches.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)**\n\nDisregard the first patch, it has a wrong ticket number.",
    "created_at": "2013-03-05T12:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169955",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment: **[trac_14228-partition_caches.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)**

Disregard the first patch, it has a wrong ticket number.



---

archive/issue_comments_169956.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n #12313 brought a severe slow-down to sage.combinat.sf.k_dual. The purpose of task #13991 is to mitigate this. The purpose of this ticket is to deal with one aspect of the slow-down.\n \n Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.\n+\n+Apply [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)\n``````\n",
    "created_at": "2013-03-05T12:51:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169956",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 #12313 brought a severe slow-down to sage.combinat.sf.k_dual. The purpose of task #13991 is to mitigate this. The purpose of this ticket is to deal with one aspect of the slow-down.
 
 Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.
+
+Apply [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)
``````




---

archive/issue_comments_169957.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nSorry for the \"wrong\" patch name.\n\nApply trac_14228-partition_caches.patch",
    "created_at": "2013-03-05T12:51:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169957",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:2" align="right">comment:2</div>

Sorry for the "wrong" patch name.

Apply trac_14228-partition_caches.patch



---

archive/issue_comments_169958.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI'm wondering how much of a speedup we'd get if we made `IntegerListsLex` a cached representation (currently it takes lambda functions as arguments which makes it impossible to hash).\n\n```\nsage: P = Partitions(4, max_part=2)\nsage: P\nPartitions of the integer 4 satisfying constraints max_part=2\nsage: type(P)\nsage.combinat.integer_list.IntegerListsLex_with_category\nsage: P is Partitions(4, max_part=2)\nFalse\n```\nSo we alternatively want to make a new partitions parent specifically for this which just wraps the iterator given by `IntegerListsLex`...\n\nI also restructured it slightly by creating an abstract base class for the actual bases for easier maintenance.\n\nAnyways, I've attached my patch.",
    "created_at": "2013-03-05T13:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169958",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

I'm wondering how much of a speedup we'd get if we made `IntegerListsLex` a cached representation (currently it takes lambda functions as arguments which makes it impossible to hash).

```
sage: P = Partitions(4, max_part=2)
sage: P
Partitions of the integer 4 satisfying constraints max_part=2
sage: type(P)
sage.combinat.integer_list.IntegerListsLex_with_category
sage: P is Partitions(4, max_part=2)
False
```
So we alternatively want to make a new partitions parent specifically for this which just wraps the iterator given by `IntegerListsLex`...

I also restructured it slightly by creating an abstract base class for the actual bases for easier maintenance.

Anyways, I've attached my patch.



---

archive/issue_comments_169959.json:
```json
{
    "body": "Changed author from **Simon King** to **Simon King Travis Scrimshaw**",
    "created_at": "2013-03-05T13:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169959",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Simon King** to **Simon King Travis Scrimshaw**



---

archive/issue_comments_169960.json:
```json
{
    "body": "Changed dependencies from **#13605** to **#13605, #14225**",
    "created_at": "2013-03-05T13:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169960",
    "user": "https://github.com/simon-king-jena"
}
```

Changed dependencies from **#13605** to **#13605, #14225**



---

archive/issue_comments_169961.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThere is one hunk of my patch that only applies with #14225. Hence, new dependency.",
    "created_at": "2013-03-05T13:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169961",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

There is one hunk of my patch that only applies with #14225. Hence, new dependency.



---

archive/issue_comments_169962.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWow. You made a major restructuring of code. It will be difficult to merge the two approaches.",
    "created_at": "2013-03-05T13:17:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169962",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:5" align="right">comment:5</div>

Wow. You made a major restructuring of code. It will be difficult to merge the two approaches.



---

archive/issue_comments_169963.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThere was one failing doctest in the first version of my patch. Because of the structural changes, the error thrown is changed (although it fundamentally is the same error).",
    "created_at": "2013-03-05T13:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169963",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

There was one failing doctest in the first version of my patch. Because of the structural changes, the error thrown is changed (although it fundamentally is the same error).



---

archive/issue_comments_169964.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@simon-king-jena](#comment%3A5):\n> Wow. You made a major restructuring of code. It will be difficult to merge the two approaches.\n\nThe big thing that I did was pulled out the common code for the bases into an ABC. It looks scarier than it is. I also avoided calling `Partition()` directly in case what was being passed in was a list, in which case it should be slower than constructing an element from the appropriate parent. Although it's faster if we are passing in a `Partition` object, but this might be a marginal speed change... I'll do some investigating to see what's being passed around.\n\nI can handle the merging.",
    "created_at": "2013-03-05T13:25:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169964",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@simon-king-jena](#comment%3A5):
> Wow. You made a major restructuring of code. It will be difficult to merge the two approaches.

The big thing that I did was pulled out the common code for the bases into an ABC. It looks scarier than it is. I also avoided calling `Partition()` directly in case what was being passed in was a list, in which case it should be slower than constructing an element from the appropriate parent. Although it's faster if we are passing in a `Partition` object, but this might be a marginal speed change... I'll do some investigating to see what's being passed around.

I can handle the merging.



---

archive/issue_comments_169965.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nArrgh. I tried to post this twice, but trac didn't accept because you posted too. A minute later, trac didn't seem to accept posts at all. Let's try again.\n\nSome timings:\n\n- With #13605 and #14225:\n\n  ```\n  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions\n  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))\n  sage: %time TestSuite(F).run()\n  CPU times: user 11.17 s, sys: 0.09 s, total: 11.26 s\n  Wall time: 11.42 s\n  sage: %time TestSuite(F).run()\n  CPU times: user 9.80 s, sys: 0.09 s, total: 9.89 s\n  Wall time: 9.93 s\n  ```\n- With #13605 and #14225 and [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)\n\n  ```\n  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions\n  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))\n  sage: %time TestSuite(F).run()\n  CPU times: user 9.14 s, sys: 0.04 s, total: 9.18 s\n  Wall time: 9.19 s\n  sage: %time TestSuite(F).run()\n  CPU times: user 7.05 s, sys: 0.02 s, total: 7.08 s\n  Wall time: 7.08 s\n  ```\n- With #13605 and #14225 and [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz):\n\n  ```\n  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions\n  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))\n  sage: %time TestSuite(F).run()\n  CPU times: user 5.94 s, sys: 0.04 s, total: 5.98 s\n  Wall time: 6.09 s\n  sage: %time TestSuite(F).run()\n  CPU times: user 3.49 s, sys: 0.03 s, total: 3.52 s\n  Wall time: 3.52 s\n  ```\n\nUnfortunately, our two patches are incompatible. How to get the best of both worlds?",
    "created_at": "2013-03-05T13:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169965",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Arrgh. I tried to post this twice, but trac didn't accept because you posted too. A minute later, trac didn't seem to accept posts at all. Let's try again.

Some timings:

- With #13605 and #14225:

  ```
  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))
  sage: %time TestSuite(F).run()
  CPU times: user 11.17 s, sys: 0.09 s, total: 11.26 s
  Wall time: 11.42 s
  sage: %time TestSuite(F).run()
  CPU times: user 9.80 s, sys: 0.09 s, total: 9.89 s
  Wall time: 9.93 s
  ```
- With #13605 and #14225 and [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)

  ```
  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))
  sage: %time TestSuite(F).run()
  CPU times: user 9.14 s, sys: 0.04 s, total: 9.18 s
  Wall time: 9.19 s
  sage: %time TestSuite(F).run()
  CPU times: user 7.05 s, sys: 0.02 s, total: 7.08 s
  Wall time: 7.08 s
  ```
- With #13605 and #14225 and [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz):

  ```
  sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
  sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))
  sage: %time TestSuite(F).run()
  CPU times: user 5.94 s, sys: 0.04 s, total: 5.98 s
  Wall time: 6.09 s
  sage: %time TestSuite(F).run()
  CPU times: user 3.49 s, sys: 0.03 s, total: 3.52 s
  Wall time: 3.52 s
  ```

Unfortunately, our two patches are incompatible. How to get the best of both worlds?



---

archive/issue_comments_169966.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@tscrim](#comment%3A7):\n> Replying to [@simon-king-jena](#comment%3A5):\n> > Wow. You made a major restructuring of code. It will be difficult to merge the two approaches.\n\n> \n> The big thing that I did was pulled out the common code for the bases into an ABC. It looks scarier than it is. I also avoided calling `Partition()` directly in case what was being passed in was a list, in which case it should be slower than constructing an element from the appropriate parent. Although it's faster if we are passing in a `Partition` object, but this might be a marginal speed change... I'll do some investigating to see what's being passed around.\n> \n> I can handle the merging.\n\nGreat, thank you. Looking at your patch, it seems that your code includes parts of the changes that I suggested (but differently in the case of the Weyl group), and I think other parts of my code (namely the cached method _Partitions) make sense to be used in your patch, too.",
    "created_at": "2013-03-05T13:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169966",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@tscrim](#comment%3A7):
> Replying to [@simon-king-jena](#comment%3A5):
> > Wow. You made a major restructuring of code. It will be difficult to merge the two approaches.

> 
> The big thing that I did was pulled out the common code for the bases into an ABC. It looks scarier than it is. I also avoided calling `Partition()` directly in case what was being passed in was a list, in which case it should be slower than constructing an element from the appropriate parent. Although it's faster if we are passing in a `Partition` object, but this might be a marginal speed change... I'll do some investigating to see what's being passed around.
> 
> I can handle the merging.

Great, thank you. Looking at your patch, it seems that your code includes parts of the changes that I suggested (but differently in the case of the Weyl group), and I think other parts of my code (namely the cached method _Partitions) make sense to be used in your patch, too.



---

archive/issue_comments_169967.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI'll let you know what happens some of my other possible speedups as well. Expect something within a few hours.",
    "created_at": "2013-03-05T13:40:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169967",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

I'll let you know what happens some of my other possible speedups as well. Expect something within a few hours.



---

archive/issue_comments_169968.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOkay, I've merged the patches (I didn't incorperate the Weyl group) and made `IntegerListsLex` a cached representation (this was desirable anyways). However I realized that `PartitionsGreatestLE` does exactly what `Partitions(n, max_part=k)` does except it already is a unique representation, so I'm using that instead. I saw a very small difference between caching this in a function and just explicitly calling this, but I feel safer not having this be strongly cached (however feel free to ignore my opinion as I'm not a python/sage memory expert).\n\nHere's some data. Without patch (with #14225):\n\n```\nsage: from sage.combinat.sf.k_dual import AffineSchurFunctions\nsage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(4,>\nsage: %time TestSuite(F).run()\nCPU times: user 7.79 s, sys: 0.22 s, total: 8.01 s\nWall time: 8.39 s\nsage: %time TestSuite(F).run()\nCPU times: user 4.82 s, sys: 0.04 s, total: 4.86 s\nWall time: 5.07 s\n```\nWith:\n\n```\nsage: from sage.combinat.sf.k_dual import AffineSchurFunctions\nsage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(4,>\nsage: %time TestSuite(F).run()\nCPU times: user 7.17 s, sys: 0.09 s, total: 7.26 s\nWall time: 7.52 s\nsage: %time TestSuite(F).run()\nCPU times: user 4.26 s, sys: 0.03 s, total: 4.29 s\nWall time: 4.58 s\n```\n\nEdit - I still have not been able to see the approx 2x speedup that you got with just your patch, so I'm still doing something relatively slow...",
    "created_at": "2013-03-05T16:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169968",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Okay, I've merged the patches (I didn't incorperate the Weyl group) and made `IntegerListsLex` a cached representation (this was desirable anyways). However I realized that `PartitionsGreatestLE` does exactly what `Partitions(n, max_part=k)` does except it already is a unique representation, so I'm using that instead. I saw a very small difference between caching this in a function and just explicitly calling this, but I feel safer not having this be strongly cached (however feel free to ignore my opinion as I'm not a python/sage memory expert).

Here's some data. Without patch (with #14225):

```
sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(4,>
sage: %time TestSuite(F).run()
CPU times: user 7.79 s, sys: 0.22 s, total: 8.01 s
Wall time: 8.39 s
sage: %time TestSuite(F).run()
CPU times: user 4.82 s, sys: 0.04 s, total: 4.86 s
Wall time: 5.07 s
```
With:

```
sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(4,>
sage: %time TestSuite(F).run()
CPU times: user 7.17 s, sys: 0.09 s, total: 7.26 s
Wall time: 7.52 s
sage: %time TestSuite(F).run()
CPU times: user 4.26 s, sys: 0.03 s, total: 4.29 s
Wall time: 4.58 s
```

Edit - I still have not been able to see the approx 2x speedup that you got with just your patch, so I'm still doing something relatively slow...



---

archive/issue_comments_169969.json:
```json
{
    "body": "Changed author from **Simon King Travis Scrimshaw** to **Simon King, Travis Scrimshaw**",
    "created_at": "2013-03-05T16:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169969",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Simon King Travis Scrimshaw** to **Simon King, Travis Scrimshaw**



---

archive/issue_comments_169970.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@tscrim](#comment%3A11):\n> ... but I feel safer not having this be strongly cached...\n> ...\n> Edit - I still have not been able to see the approx 2x speedup that you got with just your patch, ...\n\nI suppose that's why...\n\n`UniqueRepresentation` is weakly cached. Hence, if you call the same Partitions, Weyl groups or permutation groups, you will get different instances, unless you keep a strong reference. Since the same Partitions (and Weyl groups or permutation groups, too) occur in *different* methods, it won't help to keep the reference inside of a method. Instead, one needs a cache that is shared by the methods.\n\nIt would probably be bad to have a global cache. That's why in my patch I suggested to have the cache local to the parent that uses the data. In that way, the data can still be garbage collected (it is *not* a global cache!), as soon as the parent using the data is done.\n\nIt seems to me that we will not get up to speed, unless we cache the few partitions that are local to these k-bounded thingies.",
    "created_at": "2013-03-05T17:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169970",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@tscrim](#comment%3A11):
> ... but I feel safer not having this be strongly cached...
> ...
> Edit - I still have not been able to see the approx 2x speedup that you got with just your patch, ...

I suppose that's why...

`UniqueRepresentation` is weakly cached. Hence, if you call the same Partitions, Weyl groups or permutation groups, you will get different instances, unless you keep a strong reference. Since the same Partitions (and Weyl groups or permutation groups, too) occur in *different* methods, it won't help to keep the reference inside of a method. Instead, one needs a cache that is shared by the methods.

It would probably be bad to have a global cache. That's why in my patch I suggested to have the cache local to the parent that uses the data. In that way, the data can still be garbage collected (it is *not* a global cache!), as soon as the parent using the data is done.

It seems to me that we will not get up to speed, unless we cache the few partitions that are local to these k-bounded thingies.



---

archive/issue_comments_169971.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYour patch seems to perform quite well:\n\n```\nsage: from sage.combinat.sf.k_dual import AffineSchurFunctions\nsage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))\nsage: %time TestSuite(F).run()\nCPU times: user 5.78 s, sys: 0.12 s, total: 5.90 s\nWall time: 5.92 s\nsage: %time TestSuite(F).run()\nCPU times: user 3.18 s, sys: 0.03 s, total: 3.21 s\nWall time: 3.22 s\n```\nwith\n\n```\ntrac11490-coercion_tutorial.patch\n14182_whitespace.patch\ntrac_13618-rings_doc_real-ts.patch\ntrac_13618-rings_doc_complex-ts.patch\ntrac_13618-rings_doc_others-ts.patch\ntrac_14040_housekeeping.patch\ntrac_14040_repr_option.patch\ntrac_14040_doctest.patch\ntrac_14040_review.patch\ntrac14054_fast_methods-5.8.patch\ntrac_12313-mono_dict-combined-random-sk.patch\ntrac_13387-combined.patch\ntrac_13387-guard_gc.patch\ntrac_14159_weak_value_triple_dict.patch\ntrac_14159_use_cdef_get.patch\ntrac12951_cached_extension.patch\ntrac_14214-cython_homset.patch\ntrac_14214-backup_cache.patch\ntrac_14063-remove_cc_compositions-ts.patch\ntrac_13688-finite_sets_cardinality_override-ts.patch\ntrac_14138.patch\ntrac_14138-doctests.patch\ntrac_13605-partition_options-ts.patch\ntrac_14011-Sphinx_roles-fh.patch\ntrac_14054-fix-rigged-list.2.patch\ntrac_11410-zero_one_sequence_partitions-pod.v2.patch\ntrac_11410-zero_one_sequence_partitions-review-ts.patch\ntrac_14225-partition_classcall_private.patch\ntrac_14228-sym_speedup-ts.patch\n```\n\nLet's see if caching the few permutations gives us yet some more speed.",
    "created_at": "2013-03-05T17:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169971",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

Your patch seems to perform quite well:

```
sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))
sage: %time TestSuite(F).run()
CPU times: user 5.78 s, sys: 0.12 s, total: 5.90 s
Wall time: 5.92 s
sage: %time TestSuite(F).run()
CPU times: user 3.18 s, sys: 0.03 s, total: 3.21 s
Wall time: 3.22 s
```
with

```
trac11490-coercion_tutorial.patch
14182_whitespace.patch
trac_13618-rings_doc_real-ts.patch
trac_13618-rings_doc_complex-ts.patch
trac_13618-rings_doc_others-ts.patch
trac_14040_housekeeping.patch
trac_14040_repr_option.patch
trac_14040_doctest.patch
trac_14040_review.patch
trac14054_fast_methods-5.8.patch
trac_12313-mono_dict-combined-random-sk.patch
trac_13387-combined.patch
trac_13387-guard_gc.patch
trac_14159_weak_value_triple_dict.patch
trac_14159_use_cdef_get.patch
trac12951_cached_extension.patch
trac_14214-cython_homset.patch
trac_14214-backup_cache.patch
trac_14063-remove_cc_compositions-ts.patch
trac_13688-finite_sets_cardinality_override-ts.patch
trac_14138.patch
trac_14138-doctests.patch
trac_13605-partition_options-ts.patch
trac_14011-Sphinx_roles-fh.patch
trac_14054-fix-rigged-list.2.patch
trac_11410-zero_one_sequence_partitions-pod.v2.patch
trac_11410-zero_one_sequence_partitions-review-ts.patch
trac_14225-partition_classcall_private.patch
trac_14228-sym_speedup-ts.patch
```

Let's see if caching the few permutations gives us yet some more speed.



---

archive/issue_comments_169972.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nQuestion about your merged patch: In partition.py, you've put a cached_method in front of one of the two young_subgroup methods and one of the two young_soubgroup_generator methods.\n\nWas that intended? I thought it would be better to keep a pointer to the resulting permutation groups, not to some lists.",
    "created_at": "2013-03-05T17:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169972",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

Question about your merged patch: In partition.py, you've put a cached_method in front of one of the two young_subgroup methods and one of the two young_soubgroup_generator methods.

Was that intended? I thought it would be better to keep a pointer to the resulting permutation groups, not to some lists.



---

archive/issue_comments_169973.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI tried with the cached method in the parent as well and got approximately the same timings:\n\n```\nsage: %time TestSuite(F).run()\nCPU times: user 7.23 s, sys: 0.10 s, total: 7.33 s\nWall time: 7.46 s\nsage: %time TestSuite(F).run()\nCPU times: user 4.38 s, sys: 0.01 s, total: 4.40 s\nWall time: 4.63 s\n```\nHmm...strange we're getting such different timings. I'm running `5.8.beta1` with the following patches:\n\n```\ntrac_14040_doctest.patch\ntrac_14040_housekeeping.patch\ntrac_14040_repr_option.patch\ntrac_14040_review.patch\ntrac_14085-root_system-ambient_spaces-nt.patch\ntrac_14000.patch\ntrac_14000-doctests.patch\ntrac_14174-coxeter_matrix-type_H.patch\ntrac_14063-remove_cc_compositions-ts.patch\ntrac_8920-alphabet.patch\ntrac_7886_conjugacy_classes_combined.patch\ntrac_7886-conjugacy_classes-review-ts.patch\ntrac_14177-graph-color_by_labels-nt.patch\ntrac_14176-polyhedrons-operators-nt.patch\n14182_whitespace.patch\ntrac_14130-gyw-bs.patch\ntrac_13605-partition_options-ts.patch\ntrac_14111-qsym_tutorial-sb.patch\ntrac_14111-qsym_tutorial-review-ts.patch\ntrac_12543-import_statements-vd.patch\ntrac14054_fast_methods-5.8.patch\ntrac_14054-fix-rigged-list.2.patch\ntrac_2023-dynkin_graphs-ts.patch\ntrac_11410-zero_one_sequence_partitions-pod.v2.patch\ntrac_11410-zero_one_sequence_partitions-review-ts.patch\ntrac_14225-partition_classcall_private.patch\ntrac_14228-sym_speedup-ts.patch\n```\n\nI thought that's what your patch did. Whoops! I'll change it on the next version. There's still a few more things I want to try.",
    "created_at": "2013-03-05T17:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169973",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

I tried with the cached method in the parent as well and got approximately the same timings:

```
sage: %time TestSuite(F).run()
CPU times: user 7.23 s, sys: 0.10 s, total: 7.33 s
Wall time: 7.46 s
sage: %time TestSuite(F).run()
CPU times: user 4.38 s, sys: 0.01 s, total: 4.40 s
Wall time: 4.63 s
```
Hmm...strange we're getting such different timings. I'm running `5.8.beta1` with the following patches:

```
trac_14040_doctest.patch
trac_14040_housekeeping.patch
trac_14040_repr_option.patch
trac_14040_review.patch
trac_14085-root_system-ambient_spaces-nt.patch
trac_14000.patch
trac_14000-doctests.patch
trac_14174-coxeter_matrix-type_H.patch
trac_14063-remove_cc_compositions-ts.patch
trac_8920-alphabet.patch
trac_7886_conjugacy_classes_combined.patch
trac_7886-conjugacy_classes-review-ts.patch
trac_14177-graph-color_by_labels-nt.patch
trac_14176-polyhedrons-operators-nt.patch
14182_whitespace.patch
trac_14130-gyw-bs.patch
trac_13605-partition_options-ts.patch
trac_14111-qsym_tutorial-sb.patch
trac_14111-qsym_tutorial-review-ts.patch
trac_12543-import_statements-vd.patch
trac14054_fast_methods-5.8.patch
trac_14054-fix-rigged-list.2.patch
trac_2023-dynkin_graphs-ts.patch
trac_11410-zero_one_sequence_partitions-pod.v2.patch
trac_11410-zero_one_sequence_partitions-review-ts.patch
trac_14225-partition_classcall_private.patch
trac_14228-sym_speedup-ts.patch
```

I thought that's what your patch did. Whoops! I'll change it on the next version. There's still a few more things I want to try.



---

archive/issue_comments_169974.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDid you do tests with your patch?\n\nI get errors such as\n\n```\n    Traceback (most recent call last):\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[17]>\", line 1, in <module>\n        Partitions(Integer(4), outer=[Integer(3),Integer(1),Integer(1)]).list()###line 138:\n    sage: Partitions(4, outer=[3,1,1]).list()\n      File \"classcall_metaclass.pyx\", line 279, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:932)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/partition.py\", line 4006, in __classcall_private__\n        return IntegerListsLex(n, **kwargs)\n      File \"classcall_metaclass.pyx\", line 279, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:932)\n      File \"cachefunc.pyx\", line 991, in sage.misc.cachefunc.WeakCachedFunction.__call__ (sage/misc/cachefunc.c:5120)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python2.7/weakref.py\", line 56, in __getitem__\n        o = self.data[key]()\n    TypeError: unhashable type: 'list'\n```\nHence, it seems that IntegerListsLex should have a `__classcall_private__` or something like that. `UniqueRepresentation` will only work if the defining data are hashable.",
    "created_at": "2013-03-05T17:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169974",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Did you do tests with your patch?

I get errors such as

```
    Traceback (most recent call last):
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[17]>", line 1, in <module>
        Partitions(Integer(4), outer=[Integer(3),Integer(1),Integer(1)]).list()###line 138:
    sage: Partitions(4, outer=[3,1,1]).list()
      File "classcall_metaclass.pyx", line 279, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:932)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/partition.py", line 4006, in __classcall_private__
        return IntegerListsLex(n, **kwargs)
      File "classcall_metaclass.pyx", line 279, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:932)
      File "cachefunc.pyx", line 991, in sage.misc.cachefunc.WeakCachedFunction.__call__ (sage/misc/cachefunc.c:5120)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python2.7/weakref.py", line 56, in __getitem__
        o = self.data[key]()
    TypeError: unhashable type: 'list'
```
Hence, it seems that IntegerListsLex should have a `__classcall_private__` or something like that. `UniqueRepresentation` will only work if the defining data are hashable.



---

archive/issue_comments_169975.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI just did them and removed the `CachedRepresentation` since that no longer will affect the timing (since I'm using `PartitionsGreatestLE` which already is a `UniqueRepresentation`). I'm also removing the (near) duplicate `young_subgroup`* methods.",
    "created_at": "2013-03-05T17:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169975",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

I just did them and removed the `CachedRepresentation` since that no longer will affect the timing (since I'm using `PartitionsGreatestLE` which already is a `UniqueRepresentation`). I'm also removing the (near) duplicate `young_subgroup`* methods.



---

archive/issue_comments_169976.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOkay, I also added a little micro-optimization by explicitly calling the `element_class` of the stored k bounded partitions parent which circumvents some the additional/duplicate `_element_constructor_` tests and doctests in modified files all pass. I don't know what else to do (or we can do) at this point. With your patches, it seems we're back close to the original speed.",
    "created_at": "2013-03-05T17:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169976",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Okay, I also added a little micro-optimization by explicitly calling the `element_class` of the stored k bounded partitions parent which circumvents some the additional/duplicate `_element_constructor_` tests and doctests in modified files all pass. I don't know what else to do (or we can do) at this point. With your patches, it seems we're back close to the original speed.



---

archive/issue_comments_169977.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.\n \n-Apply [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)\n+Apply [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)\n``````\n",
    "created_at": "2013-03-05T17:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169977",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.
 
-Apply [attachment: trac_14228-partition_caches.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-partition_caches.patch.gz)
+Apply [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)
``````




---

archive/issue_comments_169978.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nWith the patch that you posted last, I get\n\n```\nsage: from sage.combinat.sf.k_dual import AffineSchurFunctions\nsage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))\nsage: %time TestSuite(F).run()\nCPU times: user 5.77 s, sys: 0.06 s, total: 5.83 s\nWall time: 5.87 s\nsage: %time TestSuite(F).run()\nCPU times: user 3.19 s, sys: 0.04 s, total: 3.24 s\nWall time: 3.24 s\n```\nAdditionally using a local cache for Partitions or Weyl group gives no further improvement.\n\nSo, I suggest we use the merged patch as basis for a our reviews. Is it cross review? Does this patch contain my code?",
    "created_at": "2013-03-05T17:53:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169978",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:19" align="right">comment:19</div>

With the patch that you posted last, I get

```
sage: from sage.combinat.sf.k_dual import AffineSchurFunctions
sage: F = AffineSchurFunctions(SymmetricFunctions(QQ['t']).kBoundedQuotient(Integer(4),t=Integer(1)))
sage: %time TestSuite(F).run()
CPU times: user 5.77 s, sys: 0.06 s, total: 5.83 s
Wall time: 5.87 s
sage: %time TestSuite(F).run()
CPU times: user 3.19 s, sys: 0.04 s, total: 3.24 s
Wall time: 3.24 s
```
Additionally using a local cache for Partitions or Weyl group gives no further improvement.

So, I suggest we use the merged patch as basis for a our reviews. Is it cross review? Does this patch contain my code?



---

archive/issue_comments_169979.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI believe only the cached method on `young_subgroup()` and the change in the import statements in `partition.py`.",
    "created_at": "2013-03-05T18:01:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169979",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

I believe only the cached method on `young_subgroup()` and the change in the import statements in `partition.py`.



---

archive/issue_comments_169980.json:
```json
{
    "body": "Reviewer: **Simon King**",
    "created_at": "2013-03-05T18:21:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169980",
    "user": "https://github.com/simon-king-jena"
}
```

Reviewer: **Simon King**



---

archive/issue_comments_169981.json:
```json
{
    "body": "Changed author from **Simon King, Travis Scrimshaw** to **Travis Scrimshaw**",
    "created_at": "2013-03-05T18:21:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169981",
    "user": "https://github.com/simon-king-jena"
}
```

Changed author from **Simon King, Travis Scrimshaw** to **Travis Scrimshaw**



---

archive/issue_comments_169982.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOK. So, I am supposed to review it, then.",
    "created_at": "2013-03-05T18:21:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169982",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:21" align="right">comment:21</div>

OK. So, I am supposed to review it, then.



---

archive/issue_comments_169983.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThe change to `PartitionsGreatestLE` gives the following errors in sage.combinat.sf.kschur. I know that this module is deprecated, but nevertheless, I think the following attribute error (occurring in several tests) should be fixed:\n\n```\nFile \"/home/simon/SAGE/prerelease/sage-5.8.beta0/devel/sage-main/sage/combinat/sf/kschur.py\", line 42:\n    sage: s(ks3([3,2,1]))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[5]>\", line 1, in <module>\n        s(ks3([Integer(3),Integer(2),Integer(1)]))###line 42:\n    sage: s(ks3([3,2,1]))\n      File \"parent.pyx\", line 914, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7826)\n      File \"coerce_maps.pyx\", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3656)\n      File \"coerce_maps.pyx\", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3558)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/free_module.py\", line 1469, in _element_constructor_\n        return self.monomial(self._basis_keys(x))\n      File \"parent.pyx\", line 910, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7772)\n      File \"parent.pyx\", line 2288, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:15651)\n      File \"parent.pyx\", line 2295, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:15816)\n      File \"parent.pyx\", line 2106, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:14358)\n      File \"parent.pyx\", line 2927, in sage.structure.parent._register_pair (sage/structure/parent.c:21520)\n      File \"parent.pyx\", line 2901, in sage.structure.parent.EltPair.__hash__ (sage/structure/parent.c:21168)\n      File \"category_object.pyx\", line 788, in sage.structure.category_object.CategoryObject.__hash__ (sage/structure/category_object.c:8150)\n      File \"sage_object.pyx\", line 154, in sage.structure.sage_object.SageObject.__repr__ (sage/structure/sage_object.c:1769)\n      File \"/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/partition.py\", line 5653, in _repr_\n        return \"Partitions of %s having parts less than or equal to %s\"%(self.n, self.k)\n      File \"parent.pyx\", line 669, in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:6277)\n      File \"misc.pyx\", line 205, in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1406)\n    AttributeError: 'PartitionsGreatestLE_with_category' object has no attribute 'n'\n```\n\n\nFor the patchbot:\n\nApply trac_14228-sym_speedup-ts.patch",
    "created_at": "2013-03-05T21:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169983",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

The change to `PartitionsGreatestLE` gives the following errors in sage.combinat.sf.kschur. I know that this module is deprecated, but nevertheless, I think the following attribute error (occurring in several tests) should be fixed:

```
File "/home/simon/SAGE/prerelease/sage-5.8.beta0/devel/sage-main/sage/combinat/sf/kschur.py", line 42:
    sage: s(ks3([3,2,1]))
Exception raised:
    Traceback (most recent call last):
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[5]>", line 1, in <module>
        s(ks3([Integer(3),Integer(2),Integer(1)]))###line 42:
    sage: s(ks3([3,2,1]))
      File "parent.pyx", line 914, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7826)
      File "coerce_maps.pyx", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3656)
      File "coerce_maps.pyx", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3558)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/free_module.py", line 1469, in _element_constructor_
        return self.monomial(self._basis_keys(x))
      File "parent.pyx", line 910, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7772)
      File "parent.pyx", line 2288, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:15651)
      File "parent.pyx", line 2295, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:15816)
      File "parent.pyx", line 2106, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:14358)
      File "parent.pyx", line 2927, in sage.structure.parent._register_pair (sage/structure/parent.c:21520)
      File "parent.pyx", line 2901, in sage.structure.parent.EltPair.__hash__ (sage/structure/parent.c:21168)
      File "category_object.pyx", line 788, in sage.structure.category_object.CategoryObject.__hash__ (sage/structure/category_object.c:8150)
      File "sage_object.pyx", line 154, in sage.structure.sage_object.SageObject.__repr__ (sage/structure/sage_object.c:1769)
      File "/home/simon/SAGE/prerelease/sage-5.8.beta0/local/lib/python/site-packages/sage/combinat/partition.py", line 5653, in _repr_
        return "Partitions of %s having parts less than or equal to %s"%(self.n, self.k)
      File "parent.pyx", line 669, in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:6277)
      File "misc.pyx", line 205, in sage.structure.misc.getattr_from_other_class (sage/structure/misc.c:1406)
    AttributeError: 'PartitionsGreatestLE_with_category' object has no attribute 'n'
```


For the patchbot:

Apply trac_14228-sym_speedup-ts.patch



---

archive/issue_events_198597.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T21:20:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198597"
}
```



---

archive/issue_events_198598.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-05T21:20:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198598"
}
```



---

archive/issue_comments_169984.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nPS: According to the traceback of this error, it uses the hash of `CategoryObject`---which is extremely slow, as it involves computing the string representation. So, does `PartitionsGreatestLE_with_category` not have a reasonable hash?",
    "created_at": "2013-03-05T21:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169984",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:24" align="right">comment:24</div>

PS: According to the traceback of this error, it uses the hash of `CategoryObject`---which is extremely slow, as it involves computing the string representation. So, does `PartitionsGreatestLE_with_category` not have a reasonable hash?



---

archive/issue_comments_169985.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI'll implement a custom hash for it and fix those attribute errors shortly.",
    "created_at": "2013-03-05T22:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169985",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:25" align="right">comment:25</div>

I'll implement a custom hash for it and fix those attribute errors shortly.



---

archive/issue_comments_169986.json:
```json
{
    "body": "Fixed doctests",
    "created_at": "2013-03-06T02:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169986",
    "user": "https://github.com/tscrim"
}
```

Fixed doctests



---

archive/issue_comments_169987.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[trac_14228-sym_speedup-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)**\n\nSorry that took so long. I went out for dinner in between. I fixed the doctests in `kschur.py`, it was trying to pass in a `NonNegativeIntergers()` (which is currently not really supported by `Partitions` but probably should be), so I just removed that. I also implemented a custom hash which may not generate the best hash values, but it should do the job.",
    "created_at": "2013-03-06T02:34:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169987",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[trac_14228-sym_speedup-ts.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)**

Sorry that took so long. I went out for dinner in between. I fixed the doctests in `kschur.py`, it was trying to pass in a `NonNegativeIntergers()` (which is currently not really supported by `Partitions` but probably should be), so I just removed that. I also implemented a custom hash which may not generate the best hash values, but it should do the job.



---

archive/issue_events_198599.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-03-06T02:34:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198599"
}
```



---

archive/issue_events_198600.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-03-06T02:34:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198600"
}
```



---

archive/issue_comments_169988.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI also forgot:\n\nFor patchbot:\n\nApply: trac_14228-sym_speedup-ts.patch",
    "created_at": "2013-03-06T02:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169988",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

I also forgot:

For patchbot:

Apply: trac_14228-sym_speedup-ts.patch



---

archive/issue_comments_169989.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nIt seems that the coverage script is complaining. Indeed, `KBoundedQuotientBasis.__init__` needs a test, and perhaps documentation what it is doing.\n\nYou now define a hash for `PartitionsGreatestLE`. But I see that it inherits from unique representation. Hence, it should have a blazingly fast hash anyway! So, I wonder where that hash (and comparison!) has disappeared!\n\nI reckon that one should do\n\n```\nclass PartitionsGreatestLE(UniqueRepresentation, IntegerListsLex):\n```\nand not\n\n```\nclass PartitionsGreatestLE(IntegerListsLex, UniqueRepresentation):\n```\nI think it is documented somewhere that `UniqueRepresentation` should be the *first* base class given.\n\nMy plan is to add a reviewer patch, removing the custom hash and bringing `UniqueRepresentation`'s hash forward, and adding documentation plus test for the new base class.",
    "created_at": "2013-03-06T06:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169989",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:28" align="right">comment:28</div>

It seems that the coverage script is complaining. Indeed, `KBoundedQuotientBasis.__init__` needs a test, and perhaps documentation what it is doing.

You now define a hash for `PartitionsGreatestLE`. But I see that it inherits from unique representation. Hence, it should have a blazingly fast hash anyway! So, I wonder where that hash (and comparison!) has disappeared!

I reckon that one should do

```
class PartitionsGreatestLE(UniqueRepresentation, IntegerListsLex):
```
and not

```
class PartitionsGreatestLE(IntegerListsLex, UniqueRepresentation):
```
I think it is documented somewhere that `UniqueRepresentation` should be the *first* base class given.

My plan is to add a reviewer patch, removing the custom hash and bringing `UniqueRepresentation`'s hash forward, and adding documentation plus test for the new base class.



---

archive/issue_comments_169990.json:
```json
{
    "body": "Attachment: **[trac_14228-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)**",
    "created_at": "2013-03-06T08:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169990",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment: **[trac_14228-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)**



---

archive/issue_comments_169991.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,7 @@\n \n Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.\n \n-Apply [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)\n+Apply\n+\n+- [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)\n+- [attachment: trac_14228-reviewer.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)\n``````\n",
    "created_at": "2013-03-06T08:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169991",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,7 @@
 
 Certain data of partitions should be cached, namely `WeylGroup` and the Young subgroup. And sage.combinat.sf.k_dual constructs a couple of partitions, but they are only weakly cached, so that they eventually are created repeatedly. Hence, they should be cached, too.
 
-Apply [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)
+Apply
+
+- [attachment: trac_14228-sym_speedup-ts.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-sym_speedup-ts.patch.gz)
+- [attachment: trac_14228-reviewer.patch](https://github.com/sagemath/sage/files/ticket14228/trac_14228-reviewer.patch.gz)
``````




---

archive/issue_comments_169992.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI added a reviewer patch, as I indicated in my previous post. Hope you agree with my changes. I will finish the review as soon as all tests pass.\n\nApply trac_14228-sym_speedup-ts.patch trac_14228-reviewer.patch",
    "created_at": "2013-03-06T08:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169992",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:30" align="right">comment:30</div>

I added a reviewer patch, as I indicated in my previous post. Hope you agree with my changes. I will finish the review as soon as all tests pass.

Apply trac_14228-sym_speedup-ts.patch trac_14228-reviewer.patch



---

archive/issue_comments_169993.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe tests pass (including the review patch), Travis' patch looks fine to me, and things in k_dual become a lot faster. Hence, it is a positive review here. I will now see how the new timings compare with pre-#12313 and post-#12313, so that hopefully #13991 can be resolved as fixed.",
    "created_at": "2013-03-06T11:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169993",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:31" align="right">comment:31</div>

The tests pass (including the review patch), Travis' patch looks fine to me, and things in k_dual become a lot faster. Hence, it is a positive review here. I will now see how the new timings compare with pre-#12313 and post-#12313, so that hopefully #13991 can be resolved as fixed.



---

archive/issue_events_198601.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-06T11:04:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198601"
}
```



---

archive/issue_events_198602.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-03-06T11:04:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198602"
}
```



---

archive/issue_comments_169994.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nLooks good to me too. Thank you Simon.\n\nBest,\n\nTravis",
    "created_at": "2013-03-06T12:34:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169994",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:33" align="right">comment:33</div>

Looks good to me too. Thank you Simon.

Best,

Travis



---

archive/issue_events_198603.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-07T18:26:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198603"
}
```



---

archive/issue_events_198604.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-07T18:26:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14228#event-198604"
}
```



---

archive/issue_comments_169995.json:
```json
{
    "body": "Merged: **sage-5.8.beta4**",
    "created_at": "2013-03-07T18:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14228#issuecomment-169995",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.8.beta4**
