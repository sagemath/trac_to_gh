# Issue 14880: Compute the p-adic Gamma function

archive/issues_014676.json:
```json
{
    "assignees": [
        "https://github.com/roed314"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nThis function computes the p-adic Gamma function of a p-adic integer. This code is based on Pari code by Fernando Rodriguez-Villegas which uses an expansion due to Dwork. \n\n\nApply [attachment: trac_14880_padic_gamma_v2.patch](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)\n\nComponent: **padics**\n\nKeywords: **p-adic gamma, p-adic functions, dwork, SD53**\n\nAuthor: **Beth Malmskog, Adriana Salerno, Christelle Vincent, Ursula Whitcher**\n\nBranch/Commit: **[u/asalerno/ticket/14880](https://github.com/sagemath/sagetrac-mirror/tree/u/asalerno/ticket/14880) @ [`3b6a841`](https://github.com/sagemath/sagetrac-mirror/commit/3b6a841dc5f6210a9c0d70b4d6cf24e34788c228)**\n\nReviewer: **Volker Braun**\n\nMerged: **sage-5.13.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14880_\n\n",
    "closed_at": "2013-10-02T06:35:34Z",
    "created_at": "2013-07-12T00:57:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20padics",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Compute the p-adic Gamma function",
    "type": "issue",
    "updated_at": "2013-10-02T06:35:34Z",
    "url": "https://github.com/sagemath/sage/issues/14880",
    "user": "https://github.com/sagetrac-asalerno"
}
```
<div id="comment:0"></div>

This function computes the p-adic Gamma function of a p-adic integer. This code is based on Pari code by Fernando Rodriguez-Villegas which uses an expansion due to Dwork. 


Apply [attachment: trac_14880_padic_gamma_v2.patch](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)

Component: **padics**

Keywords: **p-adic gamma, p-adic functions, dwork, SD53**

Author: **Beth Malmskog, Adriana Salerno, Christelle Vincent, Ursula Whitcher**

Branch/Commit: **[u/asalerno/ticket/14880](https://github.com/sagemath/sagetrac-mirror/tree/u/asalerno/ticket/14880) @ [`3b6a841`](https://github.com/sagemath/sagetrac-mirror/commit/3b6a841dc5f6210a9c0d70b4d6cf24e34788c228)**

Reviewer: **Volker Braun**

Merged: **sage-5.13.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/14880_





---

archive/issue_events_209630.json:
```json
{
    "actor": "https://github.com/sagetrac-asalerno",
    "created_at": "2013-07-12T00:57:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209630"
}
```



---

archive/issue_events_209631.json:
```json
{
    "actor": "https://github.com/sagetrac-asalerno",
    "created_at": "2013-07-12T00:57:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20padics",
    "label_color": "0000ff",
    "label_name": "c: padics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209631"
}
```



---

archive/issue_events_209632.json:
```json
{
    "actor": "https://github.com/sagetrac-asalerno",
    "created_at": "2013-07-12T00:57:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209632"
}
```



---

archive/issue_events_209633.json:
```json
{
    "actor": "https://github.com/sagetrac-asalerno",
    "created_at": "2013-07-12T00:57:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209633"
}
```



---

archive/issue_events_209634.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2013-07-12T00:57:05Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "subject": "https://github.com/sagetrac-asalerno",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209634"
}
```



---

archive/issue_events_209635.json:
```json
{
    "actor": "https://github.com/sagetrac-asalerno",
    "created_at": "2013-07-12T01:50:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209635"
}
```



---

archive/issue_comments_182377.json:
```json
{
    "body": "Attachment: **[trac_14880_padic_gamma.patch.gz](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma.patch.gz)**",
    "created_at": "2013-08-02T09:08:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182377",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_14880_padic_gamma.patch.gz](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma.patch.gz)**



---

archive/issue_comments_182378.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n This function computes the p-adic Gamma function of a p-adic integer. This code is based on Pari code by Fernando Rodriguez-Villegas which uses an expansion due to Dwork. \n+\n+\n+Apply [attachment: trac_14880_padic_gamma_v2.patch](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)\n``````\n",
    "created_at": "2013-08-02T09:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182378",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 This function computes the p-adic Gamma function of a p-adic integer. This code is based on Pari code by Fernando Rodriguez-Villegas which uses an expansion due to Dwork. 
+
+
+Apply [attachment: trac_14880_padic_gamma_v2.patch](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)
``````




---

archive/issue_comments_182379.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[trac_14880_padic_gamma_v2.patch.gz](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)**\n\nyour patch did not apply (seems to be some problem with the encoding of carriage returns)\n\nso I used it to make a new one, with some corrections to the documentation formatting\n\nfor the bot:\n\napply only trac_14880_padic_gamma_v2.patch\u200b",
    "created_at": "2013-08-02T09:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182379",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[trac_14880_padic_gamma_v2.patch.gz](https://github.com/sagemath/sage/files/ticket14880/trac_14880_padic_gamma_v2.patch.gz)**

your patch did not apply (seems to be some problem with the encoding of carriage returns)

so I used it to make a new one, with some corrections to the documentation formatting

for the bot:

apply only trac_14880_padic_gamma_v2.patchâ€‹



---

archive/issue_comments_182380.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\napply trac_14880_padic_gamma_v2.patch",
    "created_at": "2013-08-15T08:03:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182380",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

apply trac_14880_padic_gamma_v2.patch



---

archive/issue_comments_182381.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWhen the algorithm is 'pari' it doesn't return an element in the p-adic ring:\n\nsage: R = Zp(3)\n\nsage: x = R(5).padic_gamma()\n\nsage: x.parent()\n\nInterface to the PARI C library\n\nBut coerce seems to work, so maybe just adding a coerce before returning the result will fix it:\n\nsage: R(x).parent()\n\n3-adic Ring with capped relative precision 20",
    "created_at": "2013-09-26T15:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182381",
    "user": "https://github.com/sagetrac-xguitart"
}
```

<div id="comment:4" align="right">comment:4</div>

When the algorithm is 'pari' it doesn't return an element in the p-adic ring:

sage: R = Zp(3)

sage: x = R(5).padic_gamma()

sage: x.parent()

Interface to the PARI C library

But coerce seems to work, so maybe just adding a coerce before returning the result will fix it:

sage: R(x).parent()

3-adic Ring with capped relative precision 20



---

archive/issue_comments_182382.json:
```json
{
    "body": "Branch: **[u/asalerno/ticket/14880](https://github.com/sagemath/sagetrac-mirror/tree/u/asalerno/ticket/14880)**",
    "created_at": "2013-09-28T11:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182382",
    "user": "https://github.com/sagetrac-asalerno"
}
```

Branch: **[u/asalerno/ticket/14880](https://github.com/sagemath/sagetrac-mirror/tree/u/asalerno/ticket/14880)**



---

archive/issue_comments_182383.json:
```json
{
    "body": "Commit: **[`3b6a841`](https://github.com/sagemath/sagetrac-mirror/commit/3b6a841dc5f6210a9c0d70b4d6cf24e34788c228)**",
    "created_at": "2013-09-28T11:11:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182383",
    "user": "https://github.com/vbraun"
}
```

Commit: **[`3b6a841`](https://github.com/sagemath/sagetrac-mirror/commit/3b6a841dc5f6210a9c0d70b4d6cf24e34788c228)**



---

archive/issue_comments_182384.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2013-09-28T11:34:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182384",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_182385.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nLooks good to me",
    "created_at": "2013-09-28T11:34:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182385",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

Looks good to me



---

archive/issue_events_209636.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-09-28T11:34:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209636"
}
```



---

archive/issue_events_209637.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-09-28T11:34:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209637"
}
```



---

archive/issue_comments_182386.json:
```json
{
    "body": "Changed keywords from **p-adic gamma, p-adic functions, dwork** to **p-adic gamma, p-adic functions, dwork, SD53**",
    "created_at": "2013-09-28T15:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182386",
    "user": "https://github.com/vbraun"
}
```

Changed keywords from **p-adic gamma, p-adic functions, dwork** to **p-adic gamma, p-adic functions, dwork, SD53**



---

archive/issue_events_209638.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-09-29T16:20:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209638"
}
```



---

archive/issue_events_209639.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-09-29T16:20:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209639"
}
```



---

archive/issue_comments_182387.json:
```json
{
    "body": "Merged: **sage-5.13.beta0**",
    "created_at": "2013-10-02T06:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14880#issuecomment-182387",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta0**



---

archive/issue_events_209640.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-02T06:35:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209640"
}
```



---

archive/issue_events_209641.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-02T06:35:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14880",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14880#event-209641"
}
```
