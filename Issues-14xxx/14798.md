# Issue 14798: Export graphics objects to PGF/TikZ

archive/issues_014594.json:
```json
{
    "assignees": [],
    "body": "This patch allows  to produce PGF/TikZ output than can than be included in LaTeX documents. It is based on the new pgf backend included in matplotlib-1.2+. \n\nThe backend still has some issues that cripple this patch:\n* the first time that it is run it produce this warning:\n\n```\nsage: line([(0,0), (1,1)],axes=False).save(\"/tmp/sage.pgf\")\n/opt/sage/sage-5.10.rc2/local/lib/python2.7/site-packages/matplotlib/tight_bbox.py:55: UserWarning: bbox_inches option for pgf backend is not implemented yet. \n\"implemented yet.\" % (format))\n```\n\n* closing sage after using save() give this other error:\n\n```\nException AttributeError: \"'NoneType' object has no attribute 'isdir'\" in <bound method LatexManager.__del__ of <matplotlib.backends.backend_pgf.LatexManager instance at 0x7d375a8>> ignored\n```\n\n* finally not all the graphics primitives can be plotted at the moment: printing some text() will trigger \n\n```\nRuntimeError: Cannot get window extent w/o renderer\n```\n\n\nDepends on #19988\n\n**Assignee:** @jasongrout, @williamstein\n\n**Keywords:** matplotlib, plot, TikZ, days49\n\n**Branch/Commit:** [a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)\n\n**Upstream:** Completely fixed; Fix reported upstream\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Salvatore Stella\n\nIssue created by migration from https://trac.sagemath.org/ticket/14798\n\n",
    "closed_at": "2016-03-09T08:29:00Z",
    "created_at": "2013-06-21T16:18:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Export graphics objects to PGF/TikZ",
    "type": "issue",
    "updated_at": "2016-03-09T08:29:00Z",
    "url": "https://github.com/sagemath/sage/issues/14798",
    "user": "https://github.com/etn40ff"
}
```
This patch allows  to produce PGF/TikZ output than can than be included in LaTeX documents. It is based on the new pgf backend included in matplotlib-1.2+. 

The backend still has some issues that cripple this patch:
* the first time that it is run it produce this warning:

```
sage: line([(0,0), (1,1)],axes=False).save("/tmp/sage.pgf")
/opt/sage/sage-5.10.rc2/local/lib/python2.7/site-packages/matplotlib/tight_bbox.py:55: UserWarning: bbox_inches option for pgf backend is not implemented yet. 
"implemented yet." % (format))
```

* closing sage after using save() give this other error:

```
Exception AttributeError: "'NoneType' object has no attribute 'isdir'" in <bound method LatexManager.__del__ of <matplotlib.backends.backend_pgf.LatexManager instance at 0x7d375a8>> ignored
```

* finally not all the graphics primitives can be plotted at the moment: printing some text() will trigger 

```
RuntimeError: Cannot get window extent w/o renderer
```


Depends on #19988

**Assignee:** @jasongrout, @williamstein

**Keywords:** matplotlib, plot, TikZ, days49

**Branch/Commit:** [a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)

**Upstream:** Completely fixed; Fix reported upstream

**Reviewer:** Frédéric Chapoton

**Author:** Salvatore Stella

Issue created by migration from https://trac.sagemath.org/ticket/14798





---

archive/issue_events_178399.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2013-06-21T16:18:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178399"
}
```



---

archive/issue_events_178400.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2013-06-21T16:18:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graphics",
    "label_color": "08517b",
    "label_name": "component: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178400"
}
```



---

archive/issue_events_178401.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2013-06-21T16:18:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178401"
}
```



---

archive/issue_events_178402.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2013-06-21T16:18:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178402"
}
```



---

archive/issue_comments_183233.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nThis doesn't apply cleanly to Sage 5.11.beta3. I would recommend *not* making all of the white space changes: it makes your patch much more likely to lead to conflicts.",
    "created_at": "2013-06-21T21:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183233",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'>**Comment 1:**</a>
This doesn't apply cleanly to Sage 5.11.beta3. I would recommend *not* making all of the white space changes: it makes your patch much more likely to lead to conflicts.



---

archive/issue_comments_183234.json:
```json
{
    "body": "**Attachment:** [trac_14798_pgf_tikz_output.patch.gz](https://github.com/sagemath/sage/files/ticket14798/trac_14798_pgf_tikz_output.patch.gz)\n\nrebased for 5.11beta3",
    "created_at": "2013-06-23T15:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183234",
    "user": "https://github.com/etn40ff"
}
```

**Attachment:** [trac_14798_pgf_tikz_output.patch.gz](https://github.com/sagemath/sage/files/ticket14798/trac_14798_pgf_tikz_output.patch.gz)

rebased for 5.11beta3



---

archive/issue_comments_183235.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nSorry for the issue with the last patch: I was working on 5.10. I also followed your advice on spaces.\n\nI clicked on attach file twice so now there are two copies of the patch; is there a way to remove one of them.",
    "created_at": "2013-06-23T15:55:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183235",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:2'>**Comment 2:**</a>
Sorry for the issue with the last patch: I was working on 5.10. I also followed your advice on spaces.

I clicked on attach file twice so now there are two copies of the patch; is there a way to remove one of them.



---

archive/issue_comments_183236.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nReplying to [@etn40ff](#comment%3A2):\n> I clicked on attach file twice so now there are two copies of the patch; is there a way to remove one of them.\n\nYes, I could delete one of them, or both (as I can't rename attachments, so you could afterwards reupload your current patch without a sequence number).\n\nNext time make sure you check the \"replace existing bla\" box, then the attachment will get updated.",
    "created_at": "2013-06-24T13:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183236",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'>**Comment 3:**</a>
Replying to [@etn40ff](#comment%3A2):
> I clicked on attach file twice so now there are two copies of the patch; is there a way to remove one of them.

Yes, I could delete one of them, or both (as I can't rename attachments, so you could afterwards reupload your current patch without a sequence number).

Next time make sure you check the "replace existing bla" box, then the attachment will get updated.



---

archive/issue_comments_183237.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nthank you! it should be enough to remove  trac_14798_pgf_tikz_output.2.patch since it is identical to the other file",
    "created_at": "2013-06-24T19:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183237",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:4'>**Comment 4:**</a>
thank you! it should be enough to remove  trac_14798_pgf_tikz_output.2.patch since it is identical to the other file



---

archive/issue_comments_183238.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nReplying to [@etn40ff](#comment%3A4):\n> thank you! it should be enough to remove  trac_14798_pgf_tikz_output.2.patch since it is identical to the other file\n\nDone and done.",
    "created_at": "2013-06-24T19:55:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183238",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'>**Comment 5:**</a>
Replying to [@etn40ff](#comment%3A4):
> thank you! it should be enough to remove  trac_14798_pgf_tikz_output.2.patch since it is identical to the other file

Done and done.



---

archive/issue_comments_183239.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,14 +3,21 @@\n The backend still has some issues that cripple this patch:\n * the first time that it is run it produce this warning:\n \n+```\n sage: line([(0,0), (1,1)],axes=False).save(\"/tmp/sage.pgf\")\n /opt/sage/sage-5.10.rc2/local/lib/python2.7/site-packages/matplotlib/tight_bbox.py:55: UserWarning: bbox_inches option for pgf backend is not implemented yet. \n \"implemented yet.\" % (format))\n+```\n \n * closing sage after using save() give this other error:\n \n+```\n Exception AttributeError: \"'NoneType' object has no attribute 'isdir'\" in <bound method LatexManager.__del__ of <matplotlib.backends.backend_pgf.LatexManager instance at 0x7d375a8>> ignored\n+```\n \n * finally not all the graphics primitives can be plotted at the moment: printing some text() will trigger \n+\n+```\n RuntimeError: Cannot get window extent w/o renderer\n+```\n \n``````\n",
    "created_at": "2013-06-24T19:58:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183239",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,14 +3,21 @@
 The backend still has some issues that cripple this patch:
 * the first time that it is run it produce this warning:
 
+```
 sage: line([(0,0), (1,1)],axes=False).save("/tmp/sage.pgf")
 /opt/sage/sage-5.10.rc2/local/lib/python2.7/site-packages/matplotlib/tight_bbox.py:55: UserWarning: bbox_inches option for pgf backend is not implemented yet. 
 "implemented yet." % (format))
+```
 
 * closing sage after using save() give this other error:
 
+```
 Exception AttributeError: "'NoneType' object has no attribute 'isdir'" in <bound method LatexManager.__del__ of <matplotlib.backends.backend_pgf.LatexManager instance at 0x7d375a8>> ignored
+```
 
 * finally not all the graphics primitives can be plotted at the moment: printing some text() will trigger 
+
+```
 RuntimeError: Cannot get window extent w/o renderer
+```
 
``````




---

archive/issue_events_178403.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178403"
}
```



---

archive/issue_events_178404.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178404"
}
```



---

archive/issue_comments_183240.json:
```json
{
    "body": "**Branch:** [u/etn40ff/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/u/etn40ff/ticket/14798)",
    "created_at": "2014-02-14T17:26:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183240",
    "user": "https://github.com/etn40ff"
}
```

**Branch:** [u/etn40ff/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/u/etn40ff/ticket/14798)



---

archive/issue_events_178405.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178405"
}
```



---

archive/issue_events_178406.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178406"
}
```



---

archive/issue_comments_183241.json:
```json
{
    "body": "**Changing branch** from \"[u/etn40ff/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/u/etn40ff/ticket/14798)\" to \"[public/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14798)\".",
    "created_at": "2014-07-18T19:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183241",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[u/etn40ff/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/u/etn40ff/ticket/14798)" to "[public/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14798)".



---

archive/issue_comments_183242.json:
```json
{
    "body": "**Commit:** [bb2589fc207146810d9a17aa19d1a8123c5f30a4](https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4)",
    "created_at": "2014-07-18T19:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183242",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [bb2589fc207146810d9a17aa19d1a8123c5f30a4](https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4)



---

archive/issue_comments_183243.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nI just made a few cosmetic changes.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/766b987bd51ad01aa3ec7a05edf911bb198fc6a7\">766b987</a></td><td><code>Rebased patch; None of the previous issues got solved</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08955652d36e0e66c7b94e22582666f9bc319758\">0895565</a></td><td><code>Merge branch 'u/etn40ff/ticket/14798' of ssh://trac.sagemath.org:22/sage into 14798</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4\">bb2589f</a></td><td><code>trac #14798 minor details</code></td></tr></table>\n",
    "created_at": "2014-07-18T19:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183243",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'>**Comment 10:**</a>
I just made a few cosmetic changes.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/766b987bd51ad01aa3ec7a05edf911bb198fc6a7">766b987</a></td><td><code>Rebased patch; None of the previous issues got solved</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08955652d36e0e66c7b94e22582666f9bc319758">0895565</a></td><td><code>Merge branch 'u/etn40ff/ticket/14798' of ssh://trac.sagemath.org:22/sage into 14798</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4">bb2589f</a></td><td><code>trac #14798 minor details</code></td></tr></table>




---

archive/issue_comments_183244.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nThank you for the cleanup.\nI gave this patch another spin and it looks like both the first and third issue got solved by upgrading to matplotlib 1.3. \n\nThe second one is still present. I looked into it: it depends on the method _cleanup of the class LatexManager in matplotlib (the definition is in src/lib/matplotlib/backends/backend_pgf.py). Apparently when calling _cleanup python/sage does not know any more of the existence of the module os.path. I have no idea of how this is possible.",
    "created_at": "2014-07-19T11:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183244",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:11'>**Comment 11:**</a>
Thank you for the cleanup.
I gave this patch another spin and it looks like both the first and third issue got solved by upgrading to matplotlib 1.3. 

The second one is still present. I looked into it: it depends on the method _cleanup of the class LatexManager in matplotlib (the definition is in src/lib/matplotlib/backends/backend_pgf.py). Apparently when calling _cleanup python/sage does not know any more of the existence of the module os.path. I have no idea of how this is possible.



---

archive/issue_events_178407.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178407"
}
```



---

archive/issue_events_178408.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178408"
}
```



---

archive/issue_comments_183245.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca8028f874e4120822c8227143d878afe18c58a7\">ca8028f</a></td><td><code>Merge with 6.4.beta3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe\">e2757c2</a></td><td><code>trac #14798 a few typos corrected</code></td></tr></table>\n",
    "created_at": "2014-09-22T18:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183245",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>**Comment 13:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca8028f874e4120822c8227143d878afe18c58a7">ca8028f</a></td><td><code>Merge with 6.4.beta3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe">e2757c2</a></td><td><code>trac #14798 a few typos corrected</code></td></tr></table>




---

archive/issue_comments_183246.json:
```json
{
    "body": "**Changing commit** from \"[bb2589fc207146810d9a17aa19d1a8123c5f30a4](https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4)\" to \"[e2757c27aa89cb128bd37d6c7daee74fe03952fe](https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe)\".",
    "created_at": "2014-09-22T18:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183246",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[bb2589fc207146810d9a17aa19d1a8123c5f30a4](https://github.com/sagemath/sagetrac-mirror/commit/bb2589fc207146810d9a17aa19d1a8123c5f30a4)" to "[e2757c27aa89cb128bd37d6c7daee74fe03952fe](https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe)".



---

archive/issue_comments_183247.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b\">ecefc7e</a></td><td><code>Merge branch 'public/ticket/14798' into 6.5.b2</code></td></tr></table>\n",
    "created_at": "2014-12-08T20:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183247",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>**Comment 14:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b">ecefc7e</a></td><td><code>Merge branch 'public/ticket/14798' into 6.5.b2</code></td></tr></table>




---

archive/issue_comments_183248.json:
```json
{
    "body": "**Changing commit** from \"[e2757c27aa89cb128bd37d6c7daee74fe03952fe](https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe)\" to \"[ecefc7e4da76096621c9df3d8901158cd22d141b](https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b)\".",
    "created_at": "2014-12-08T20:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183248",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e2757c27aa89cb128bd37d6c7daee74fe03952fe](https://github.com/sagemath/sagetrac-mirror/commit/e2757c27aa89cb128bd37d6c7daee74fe03952fe)" to "[ecefc7e4da76096621c9df3d8901158cd22d141b](https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b)".



---

archive/issue_comments_183249.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036\">86f3f73</a></td><td><code>Merge branch 'public/ticket/14798' into 6.6.b5</code></td></tr></table>\n",
    "created_at": "2015-03-18T20:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183249",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>**Comment 15:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036">86f3f73</a></td><td><code>Merge branch 'public/ticket/14798' into 6.6.b5</code></td></tr></table>




---

archive/issue_comments_183250.json:
```json
{
    "body": "**Changing commit** from \"[ecefc7e4da76096621c9df3d8901158cd22d141b](https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b)\" to \"[86f3f73a8b4f8ae2179e628834f32e0afa5e4036](https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036)\".",
    "created_at": "2015-03-18T20:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183250",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ecefc7e4da76096621c9df3d8901158cd22d141b](https://github.com/sagemath/sagetrac-mirror/commit/ecefc7e4da76096621c9df3d8901158cd22d141b)" to "[86f3f73a8b4f8ae2179e628834f32e0afa5e4036](https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036)".



---

archive/issue_comments_183251.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nThe cause of the second issue is explained in the Python doc about `__del__` method, which is used in the class `LatexManager` in the `.../lib/matplotlib/backends/backend_pgf.py` file. The method tries to close temporary files whose list is kept in the class attribute `_unclean_instances`, by calling `_cleanup(self)` method,  which in turn uses the `os.path` module. But as Sage is shutting down, the last module is in state of being destroyed. Thus an exception raises (but ignored).\n\nSimply speaking, the `__del__` method is doing too much at a critical moment.\n\nI don't know the appropriate way of dealing with this (bug?). Should it be dealt in Sage or at upstream?",
    "created_at": "2015-09-21T09:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183251",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:16'>**Comment 16:**</a>
The cause of the second issue is explained in the Python doc about `__del__` method, which is used in the class `LatexManager` in the `.../lib/matplotlib/backends/backend_pgf.py` file. The method tries to close temporary files whose list is kept in the class attribute `_unclean_instances`, by calling `_cleanup(self)` method,  which in turn uses the `os.path` module. But as Sage is shutting down, the last module is in state of being destroyed. Thus an exception raises (but ignored).

Simply speaking, the `__del__` method is doing too much at a critical moment.

I don't know the appropriate way of dealing with this (bug?). Should it be dealt in Sage or at upstream?



---

archive/issue_comments_183252.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44\">0fb9808</a></td><td><code>Merge branch 'public/ticket/14798' into 6.9.b7</code></td></tr></table>\n",
    "created_at": "2015-09-24T16:02:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183252",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>**Comment 17:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44">0fb9808</a></td><td><code>Merge branch 'public/ticket/14798' into 6.9.b7</code></td></tr></table>




---

archive/issue_comments_183253.json:
```json
{
    "body": "**Changing commit** from \"[86f3f73a8b4f8ae2179e628834f32e0afa5e4036](https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036)\" to \"[0fb98082cda2a957b79a69f6e74a35b535c56e44](https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44)\".",
    "created_at": "2015-09-24T16:02:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183253",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[86f3f73a8b4f8ae2179e628834f32e0afa5e4036](https://github.com/sagemath/sagetrac-mirror/commit/86f3f73a8b4f8ae2179e628834f32e0afa5e4036)" to "[0fb98082cda2a957b79a69f6e74a35b535c56e44](https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44)".



---

archive/issue_comments_183254.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nI have just rebased the branch.\n\nI have no opinion on how to solve this \"vanishing os\" issue.",
    "created_at": "2015-09-24T16:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183254",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'>**Comment 18:**</a>
I have just rebased the branch.

I have no opinion on how to solve this "vanishing os" issue.



---

archive/issue_events_178409.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-09-24T16:03:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178409"
}
```



---

archive/issue_events_178410.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-09-24T16:03:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178410"
}
```



---

archive/issue_comments_183255.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nReported to the upstream matplotlib community about the second issue. Loaded a patch and requested to pull: https://github.com/matplotlib/matplotlib/pull/5144\n\nWith the patch, the second issue resolves in Sage.",
    "created_at": "2015-09-25T19:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183255",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:19'>**Comment 19:**</a>
Reported to the upstream matplotlib community about the second issue. Loaded a patch and requested to pull: https://github.com/matplotlib/matplotlib/pull/5144

With the patch, the second issue resolves in Sage.



---

archive/issue_comments_183256.json:
```json
{
    "body": "**Upstream:** Reported upstream. No feedback yet.",
    "created_at": "2015-09-25T19:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183256",
    "user": "https://github.com/kwankyu"
}
```

**Upstream:** Reported upstream. No feedback yet.



---

archive/issue_comments_183257.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2015-10-09T16:50:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183257",
    "user": "https://github.com/fchapoton"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_183258.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nThe upstream discussion is now moved to https://github.com/matplotlib/matplotlib/pull/5249",
    "created_at": "2015-11-05T05:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183258",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:22'>**Comment 22:**</a>
The upstream discussion is now moved to https://github.com/matplotlib/matplotlib/pull/5249



---

archive/issue_comments_183259.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nThe upstream patch was merged to matplotlib 1.5.1, which was released recently. So it remains only to upgrade Sage's matplotlib to the latest stable version, before this ticket is ready for a review.",
    "created_at": "2016-01-14T09:43:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183259",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:23'>**Comment 23:**</a>
The upstream patch was merged to matplotlib 1.5.1, which was released recently. So it remains only to upgrade Sage's matplotlib to the latest stable version, before this ticket is ready for a review.



---

archive/issue_comments_183260.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Completely fixed; Fix reported upstream\".",
    "created_at": "2016-02-22T15:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183260",
    "user": "https://github.com/etn40ff"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Completely fixed; Fix reported upstream".



---

archive/issue_comments_183261.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nMatplotlib is now updated to 1.5.1: #19988",
    "created_at": "2016-02-22T15:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183261",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:24'>**Comment 24:**</a>
Matplotlib is now updated to 1.5.1: #19988



---

archive/issue_events_178411.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2016-02-22T15:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178411"
}
```



---

archive/issue_events_178412.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2016-02-22T15:01:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178412"
}
```



---

archive/issue_events_178413.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2016-02-22T15:01:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178413"
}
```



---

archive/issue_comments_183262.json:
```json
{
    "body": "**Dependencies:** #19988",
    "created_at": "2016-02-23T22:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183262",
    "user": "https://github.com/vbraun"
}
```

**Dependencies:** #19988



---

archive/issue_events_178414.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-02-26T13:54:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178414"
}
```



---

archive/issue_events_178415.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-02-26T13:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178415"
}
```



---

archive/issue_comments_183263.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nok, looks good to me. Let it go.\n\nI am just slightly worried about the fact that \"view\" will not work.",
    "created_at": "2016-02-26T13:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183263",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'>**Comment 26:**</a>
ok, looks good to me. Let it go.

I am just slightly worried about the fact that "view" will not work.



---

archive/issue_comments_183264.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2016-02-26T13:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183264",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_183265.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nLooks good to me too. \n\nWhat do you mean by \"view\"?",
    "created_at": "2016-02-26T14:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183265",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'>**Comment 27:**</a>
Looks good to me too. 

What do you mean by "view"?



---

archive/issue_comments_183266.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nwith this ticket:\n\n```\nsage: c=line([(0,0),(1,1)])\nsage: view(c)\n...\n!  ==> Fatal error occurred, no output PDF file produced!\n\nLatex error\n```",
    "created_at": "2016-02-26T14:06:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183266",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'>**Comment 28:**</a>
with this ticket:

```
sage: c=line([(0,0),(1,1)])
sage: view(c)
...
!  ==> Fatal error occurred, no output PDF file produced!

Latex error
```



---

archive/issue_comments_183267.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nBy its doc, \"view\" is supposed to give a latex representation of the object. Did it work somehow for a graphics object?",
    "created_at": "2016-02-26T14:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183267",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:29'>**Comment 29:**</a>
By its doc, "view" is supposed to give a latex representation of the object. Did it work somehow for a graphics object?



---

archive/issue_comments_183268.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nWell, it previously used the repr, so display the text \"Graphics object ..\"\n\nNow it is broken..",
    "created_at": "2016-02-26T14:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183268",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'>**Comment 30:**</a>
Well, it previously used the repr, so display the text "Graphics object .."

Now it is broken..



---

archive/issue_comments_183269.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nI  have no access to a sage install today but I can look into this later on. What would you think is the best option for view? Shall it return repr or shall it return the pgf/latex code?\nS.",
    "created_at": "2016-02-26T14:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183269",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:31'>**Comment 31:**</a>
I  have no access to a sage install today but I can look into this later on. What would you think is the best option for view? Shall it return repr or shall it return the pgf/latex code?
S.



---

archive/issue_comments_183270.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nThe previous behaviour seems not very useful. It would be nice to give the graphic image itself included by latex. This could be done without using the pgf output. Just include .png file. Anyway pgf is limited and cannot represent all graphics, as far as I know.\n\nBy the way, my mac just finished doctesting for Sage 7.1.beta5 with the current patch merged. It reports some failures.\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/structure/sage_object.pyx  # 1 doctest failed\nsage -t src/sage/dev/git_interface.py  # 2 doctests failed\nsage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nI will test again without the patch...",
    "created_at": "2016-02-26T14:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183270",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:32'>**Comment 32:**</a>
The previous behaviour seems not very useful. It would be nice to give the graphic image itself included by latex. This could be done without using the pgf output. Just include .png file. Anyway pgf is limited and cannot represent all graphics, as far as I know.

By the way, my mac just finished doctesting for Sage 7.1.beta5 with the current patch merged. It reports some failures.

```
----------------------------------------------------------------------
sage -t src/sage/structure/sage_object.pyx  # 1 doctest failed
sage -t src/sage/dev/git_interface.py  # 2 doctests failed
sage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
----------------------------------------------------------------------
```

I will test again without the patch...



---

archive/issue_comments_183271.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nwe should rather step back for a moment",
    "created_at": "2016-02-26T14:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183271",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'>**Comment 33:**</a>
we should rather step back for a moment



---

archive/issue_events_178416.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-02-26T14:32:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178416"
}
```



---

archive/issue_events_178417.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-02-26T14:32:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178417"
}
```



---

archive/issue_comments_183272.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nAfter retry, the first and third failures seem to be related with this patch.",
    "created_at": "2016-02-26T14:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183272",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:34'>**Comment 34:**</a>
After retry, the first and third failures seem to be related with this patch.



---

archive/issue_comments_183273.json:
```json
{
    "body": "**Changing commit** from \"[0fb98082cda2a957b79a69f6e74a35b535c56e44](https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44)\" to \"[ca1abf2177f7f1f847323a61f5708b7c797bbb6e](https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e)\".",
    "created_at": "2016-02-28T13:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183273",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[0fb98082cda2a957b79a69f6e74a35b535c56e44](https://github.com/sagemath/sagetrac-mirror/commit/0fb98082cda2a957b79a69f6e74a35b535c56e44)" to "[ca1abf2177f7f1f847323a61f5708b7c797bbb6e](https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e)".



---

archive/issue_comments_183274.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd37828658aad3f78bcfab36cc8beb51949e7b58\">fd37828</a></td><td><code>Merge branch 'public/ticket/14798' into 7.1.b5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e\">ca1abf2</a></td><td><code>trac #14798 correct one easy failing doctest</code></td></tr></table>\n",
    "created_at": "2016-02-28T13:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183274",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>**Comment 35:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd37828658aad3f78bcfab36cc8beb51949e7b58">fd37828</a></td><td><code>Merge branch 'public/ticket/14798' into 7.1.b5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e">ca1abf2</a></td><td><code>trac #14798 correct one easy failing doctest</code></td></tr></table>




---

archive/issue_comments_183275.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nReplying to [@etn40ff](#comment%3A31):\n> I  have no access to a sage install today but I can look into this later on. What would you think is the best option for view? Shall it return repr or shall it return the pgf/latex code?\n\nIt should return the pgf/latex code so the behavior remains consistent.\n\nAlso you have to do some setup for tikz code:\n\n```python\nfrom sage.graphs.graph_latex import setup_latex_preamble\nsetup_latex_preamble()\n```\nThat could be why `view` is broken.",
    "created_at": "2016-02-28T16:57:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183275",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'>**Comment 36:**</a>
Replying to [@etn40ff](#comment%3A31):
> I  have no access to a sage install today but I can look into this later on. What would you think is the best option for view? Shall it return repr or shall it return the pgf/latex code?

It should return the pgf/latex code so the behavior remains consistent.

Also you have to do some setup for tikz code:

```python
from sage.graphs.graph_latex import setup_latex_preamble
setup_latex_preamble()
```
That could be why `view` is broken.



---

archive/issue_comments_183276.json:
```json
{
    "body": "**Changing commit** from \"[ca1abf2177f7f1f847323a61f5708b7c797bbb6e](https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e)\" to \"[86f97279128d38ed9eb526623232e4fe165fad37](https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37)\".",
    "created_at": "2016-02-29T06:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183276",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ca1abf2177f7f1f847323a61f5708b7c797bbb6e](https://github.com/sagemath/sagetrac-mirror/commit/ca1abf2177f7f1f847323a61f5708b7c797bbb6e)" to "[86f97279128d38ed9eb526623232e4fe165fad37](https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37)".



---

archive/issue_comments_183277.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e89161bec69531ccfb439572e7252a11a6ea81d9\">e89161b</a></td><td><code>_latex_ now adds the pgf package to preamble</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/404cb1de272aef00bb8ab68494e6201d24b9cba7\">404cb1d</a></td><td><code>updated pretty_print doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37\">86f9727</a></td><td><code>removed a blank line</code></td></tr></table>\n",
    "created_at": "2016-02-29T06:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183277",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>**Comment 37:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e89161bec69531ccfb439572e7252a11a6ea81d9">e89161b</a></td><td><code>_latex_ now adds the pgf package to preamble</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/404cb1de272aef00bb8ab68494e6201d24b9cba7">404cb1d</a></td><td><code>updated pretty_print doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37">86f9727</a></td><td><code>removed a blank line</code></td></tr></table>




---

archive/issue_comments_183278.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nFixed `_latex_()` method of `Graphics` according to the suggestions by tscrim. No more doctest failures. But check if the output of `view(g)` is satisfying.",
    "created_at": "2016-02-29T06:33:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183278",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:38'>**Comment 38:**</a>
Fixed `_latex_()` method of `Graphics` according to the suggestions by tscrim. No more doctest failures. But check if the output of `view(g)` is satisfying.



---

archive/issue_comments_183279.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\nDear All,\nthank you for dealing with this while I had not sage to play with. \nI am back at it now and I agree with the changes made so far. \n\nOne thing I am not convinced of is how the output of `view` looks like: the\nfigure is all squashed to the right side. \n\nA possible fix to this is to enclose the output of `latex()` into a\n`\\makebox[\\textwidth]{` `}`.  This unfortunately creates some problem with latex\nitself. Somehow if we put things inside a `\\makebox` environment then latex\ncomplains about undefined control sequence `\\pgfsys`. The latex code works\nperfectly without the `\\makebox`. To replicate this do as follows:\n\nWith the current code\n\n```\nsage: c = plot(sin(x))\nsage: view(c)\n```\nworks but the figure is all squashed to the right.\n\nApply this patch then and try again\n\n```\ndiff --git a/src/sage/misc/latex.py b/src/sage/misc/latex.py\nindex de63252..ee62c3e 100644\n--- a/src/sage/misc/latex.py\n+++ b/src/sage/misc/latex.py\n@@ -1768,7 +1768,9 @@ def _latex_file_(objects, title='SAGE', debug=False, \\\n         for i in range(len(objects)):\n             x = objects[i]\n             L = latex(x)\n-            if not '\\\\begin{verbatim}' in L:\n+            if '\\\\begin{pgfpicture}' in L:\n+                s += '\\n\\\\makebox[\\\\textwidth]{\\n%s\\n}\\n'%L\n+            elif not '\\\\begin{verbatim}' in L:\n                 s += '%s%s%s'%(math_left, L, math_right)\n             else:\n                 s += '%s'%L\n```\n\n```\nsage: c = plot(sin(x))\nsage: view(c) #fails with undefined control sequence \\pgfsys\nsage: c._show_axes = False\nsage: view(c) #works and places the figure nicely\n```\nApparently the issue is with the axes.\n\nTo get the code that sages tries to compile you can do\n\n```\nsage: from sage.misc.latex import _latex_file_\nsage: s = _latex_file_(latex(c))\nsage: f = open('/tmp/sage.tex','w'); f.write(s); f.close()\n```\n\nAny idea on how to tackle this?\n\nOne more issue (this, I think, is a bug upstream):\n\n```\nsage: c = text('Hello World!',(1,0))\nsage: latex(c)\n...\nIOError: [Errno 32] Broken pipe\n```",
    "created_at": "2016-02-29T11:39:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183279",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:39'>**Comment 39:**</a>
Dear All,
thank you for dealing with this while I had not sage to play with. 
I am back at it now and I agree with the changes made so far. 

One thing I am not convinced of is how the output of `view` looks like: the
figure is all squashed to the right side. 

A possible fix to this is to enclose the output of `latex()` into a
`\makebox[\textwidth]{` `}`.  This unfortunately creates some problem with latex
itself. Somehow if we put things inside a `\makebox` environment then latex
complains about undefined control sequence `\pgfsys`. The latex code works
perfectly without the `\makebox`. To replicate this do as follows:

With the current code

```
sage: c = plot(sin(x))
sage: view(c)
```
works but the figure is all squashed to the right.

Apply this patch then and try again

```
diff --git a/src/sage/misc/latex.py b/src/sage/misc/latex.py
index de63252..ee62c3e 100644
--- a/src/sage/misc/latex.py
+++ b/src/sage/misc/latex.py
@@ -1768,7 +1768,9 @@ def _latex_file_(objects, title='SAGE', debug=False, \
         for i in range(len(objects)):
             x = objects[i]
             L = latex(x)
-            if not '\\begin{verbatim}' in L:
+            if '\\begin{pgfpicture}' in L:
+                s += '\n\\makebox[\\textwidth]{\n%s\n}\n'%L
+            elif not '\\begin{verbatim}' in L:
                 s += '%s%s%s'%(math_left, L, math_right)
             else:
                 s += '%s'%L
```

```
sage: c = plot(sin(x))
sage: view(c) #fails with undefined control sequence \pgfsys
sage: c._show_axes = False
sage: view(c) #works and places the figure nicely
```
Apparently the issue is with the axes.

To get the code that sages tries to compile you can do

```
sage: from sage.misc.latex import _latex_file_
sage: s = _latex_file_(latex(c))
sage: f = open('/tmp/sage.tex','w'); f.write(s); f.close()
```

Any idea on how to tackle this?

One more issue (this, I think, is a bug upstream):

```
sage: c = text('Hello World!',(1,0))
sage: latex(c)
...
IOError: [Errno 32] Broken pipe
```



---

archive/issue_comments_183280.json:
```json
{
    "body": "**Changing commit** from \"[86f97279128d38ed9eb526623232e4fe165fad37](https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37)\" to \"[be0ecc888817f64a72ab0c7530cc6a66c8622a45](https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45)\".",
    "created_at": "2016-02-29T14:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183280",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[86f97279128d38ed9eb526623232e4fe165fad37](https://github.com/sagemath/sagetrac-mirror/commit/86f97279128d38ed9eb526623232e4fe165fad37)" to "[be0ecc888817f64a72ab0c7530cc6a66c8622a45](https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45)".



---

archive/issue_comments_183281.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45\">be0ecc8</a></td><td><code>Centered output of view()</code></td></tr></table>\n",
    "created_at": "2016-02-29T14:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183281",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>**Comment 40:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45">be0ecc8</a></td><td><code>Centered output of view()</code></td></tr></table>




---

archive/issue_events_178418.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2016-02-29T14:44:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178418"
}
```



---

archive/issue_events_178419.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2016-02-29T14:44:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178419"
}
```



---

archive/issue_comments_183282.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nI managed to fix the alignment issue using the ambient `adjustbox` instead of `\\makebox`; this requires an extra package but at least produces the desired output.\n\nI can't replicate the issue with text after recompiling sage. Running doctest now.",
    "created_at": "2016-02-29T14:44:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183282",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:41'>**Comment 41:**</a>
I managed to fix the alignment issue using the ambient `adjustbox` instead of `\makebox`; this requires an extra package but at least produces the desired output.

I can't replicate the issue with text after recompiling sage. Running doctest now.



---

archive/issue_comments_183283.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nOk doctesting works fine on my machine (and on a couple of instances of patchbot) but one test fails on other patchbots.\nIt looks like something related to the installation of latex on those machines since the error is\n\n```\nLaTeX Error: File `utf8x.def' not found\n```",
    "created_at": "2016-03-01T09:25:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183283",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:42'>**Comment 42:**</a>
Ok doctesting works fine on my machine (and on a couple of instances of patchbot) but one test fails on other patchbots.
It looks like something related to the installation of latex on those machines since the error is

```
LaTeX Error: File `utf8x.def' not found
```



---

archive/issue_comments_183284.json:
```json
{
    "body": "**Changing commit** from \"[be0ecc888817f64a72ab0c7530cc6a66c8622a45](https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45)\" to \"[78202777d556147b6dd1a6166e69420535a89772](https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772)\".",
    "created_at": "2016-03-02T07:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183284",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[be0ecc888817f64a72ab0c7530cc6a66c8622a45](https://github.com/sagemath/sagetrac-mirror/commit/be0ecc888817f64a72ab0c7530cc6a66c8622a45)" to "[78202777d556147b6dd1a6166e69420535a89772](https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772)".



---

archive/issue_comments_183285.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772\">7820277</a></td><td><code>use standard latex commands to resize</code></td></tr></table>\n",
    "created_at": "2016-03-02T07:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183285",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:43'>**Comment 43:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772">7820277</a></td><td><code>use standard latex commands to resize</code></td></tr></table>




---

archive/issue_comments_183286.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nI prefer to avoid the extra package `adjustbox` as it is here used just to resize the figure to the text width, which can be accomplished by standard latex commands and an existing package `graphicx`. The \"standard\" approach has a merit of being faster.",
    "created_at": "2016-03-02T07:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183286",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:44'>**Comment 44:**</a>
I prefer to avoid the extra package `adjustbox` as it is here used just to resize the figure to the text width, which can be accomplished by standard latex commands and an existing package `graphicx`. The "standard" approach has a merit of being faster.



---

archive/issue_comments_183287.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nIf there's no objection, I give positive review.",
    "created_at": "2016-03-07T07:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183287",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:45'>**Comment 45:**</a>
If there's no objection, I give positive review.



---

archive/issue_events_178420.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-07T07:05:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178420"
}
```



---

archive/issue_events_178421.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-07T07:05:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178421"
}
```



---

archive/issue_events_178422.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-07T21:43:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178422"
}
```



---

archive/issue_events_178423.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-07T21:43:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178423"
}
```



---

archive/issue_comments_183288.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\n\n```\nsage -t --long src/sage/repl/rich_output/pretty_print.py\n**********************************************************************\nFile \"src/sage/repl/rich_output/pretty_print.py\", line 224, in sage.repl.rich_output.pretty_print.pretty_print\nFailed example:\n    pretty_print(ZZ, 123, plt)    # latex output\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.pretty_print.pretty_print[7]>\", line 1, in <module>\n        pretty_print(ZZ, Integer(123), plt)    # latex output\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.py\", line 247, in pretty_print\n        SequencePrettyPrinter(*args, **kwds).pretty_print()\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.py\", line 161, in pretty_print\n        get_display_manager().display_immediately(args, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 791, in display_immediately\n        plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 633, in _rich_output_formatter\n        obj, plain_text=plain_text, **rich_repr_kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py\", line 535, in _preferred_text_formatter\n        out = self._backend.latex_formatter(obj, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_base.py\", line 481, in latex_formatter\n        mathjax = MathJax().eval(obj, mode='plain', combine_all=True)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 1950, in eval\n        x = latex(x, combine_all=combine_all)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 924, in __call__\n        return LatexExpr(f(x, combine_all=combine_all))\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 207, in tuple_function\n        return \" \".join([latex(v) for v in x])\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 920, in __call__\n        return LatexExpr(x._latex_())\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 3266, in _latex_\n        self.save(filename=tmpfilename, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 471, in wrapper\n        return func(*args, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 3199, in save\n        raise ValueError(\"Matplotlib requires either xelatex, \"\n    ValueError: Matplotlib requires either xelatex, lualatex, or pdflatex.\n**********************************************************************\n1 item had failures:\n   1 of  10 in sage.repl.rich_output.pretty_print.pretty_print\n    [33 tests, 1 failure, 4.00 s]\n```",
    "created_at": "2016-03-07T21:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183288",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:46'>**Comment 46:**</a>

```
sage -t --long src/sage/repl/rich_output/pretty_print.py
**********************************************************************
File "src/sage/repl/rich_output/pretty_print.py", line 224, in sage.repl.rich_output.pretty_print.pretty_print
Failed example:
    pretty_print(ZZ, 123, plt)    # latex output
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.pretty_print.pretty_print[7]>", line 1, in <module>
        pretty_print(ZZ, Integer(123), plt)    # latex output
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.py", line 247, in pretty_print
        SequencePrettyPrinter(*args, **kwds).pretty_print()
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.py", line 161, in pretty_print
        get_display_manager().display_immediately(args, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 791, in display_immediately
        plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 633, in _rich_output_formatter
        obj, plain_text=plain_text, **rich_repr_kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.py", line 535, in _preferred_text_formatter
        out = self._backend.latex_formatter(obj, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_base.py", line 481, in latex_formatter
        mathjax = MathJax().eval(obj, mode='plain', combine_all=True)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py", line 1950, in eval
        x = latex(x, combine_all=combine_all)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py", line 924, in __call__
        return LatexExpr(f(x, combine_all=combine_all))
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py", line 207, in tuple_function
        return " ".join([latex(v) for v in x])
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/latex.py", line 920, in __call__
        return LatexExpr(x._latex_())
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 3266, in _latex_
        self.save(filename=tmpfilename, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 471, in wrapper
        return func(*args, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 3199, in save
        raise ValueError("Matplotlib requires either xelatex, "
    ValueError: Matplotlib requires either xelatex, lualatex, or pdflatex.
**********************************************************************
1 item had failures:
   1 of  10 in sage.repl.rich_output.pretty_print.pretty_print
    [33 tests, 1 failure, 4.00 s]
```



---

archive/issue_comments_183289.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nThe last failure is just due to the lack of latex on the system as stated in the error output. As the doctest clearly indicates that it produces latex output (and requires latex installed on the system), I think the blame should be on the system or on the doctesting mechanism of Sage, rather than the patch.",
    "created_at": "2016-03-08T00:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183289",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:47'>**Comment 47:**</a>
The last failure is just due to the lack of latex on the system as stated in the error output. As the doctest clearly indicates that it produces latex output (and requires latex installed on the system), I think the blame should be on the system or on the doctesting mechanism of Sage, rather than the patch.



---

archive/issue_comments_183290.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab\">a8eafa7</a></td><td><code>Mark pretty_print test as optional - latex</code></td></tr></table>\n",
    "created_at": "2016-03-08T10:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183290",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:48'>**Comment 48:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab">a8eafa7</a></td><td><code>Mark pretty_print test as optional - latex</code></td></tr></table>




---

archive/issue_comments_183291.json:
```json
{
    "body": "**Changing commit** from \"[78202777d556147b6dd1a6166e69420535a89772](https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772)\" to \"[a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)\".",
    "created_at": "2016-03-08T10:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183291",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[78202777d556147b6dd1a6166e69420535a89772](https://github.com/sagemath/sagetrac-mirror/commit/78202777d556147b6dd1a6166e69420535a89772)" to "[a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)".



---

archive/issue_comments_183292.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\nI do not have a sage install without latex to test this",
    "created_at": "2016-03-08T10:42:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183292",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:49'>**Comment 49:**</a>
I do not have a sage install without latex to test this



---

archive/issue_comments_183293.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nIt would be nice if the poseidon buildbot would come around to this ticket again, but the test will get skipped unless someone specifically adds `latex` to the optional flags. So based on this fact and this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/K1xtiWcNjvw), I'm going to set this back to a positive review.",
    "created_at": "2016-03-08T22:14:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183293",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:50'>**Comment 50:**</a>
It would be nice if the poseidon buildbot would come around to this ticket again, but the test will get skipped unless someone specifically adds `latex` to the optional flags. So based on this fact and this [sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/K1xtiWcNjvw), I'm going to set this back to a positive review.



---

archive/issue_events_178424.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-03-08T22:14:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178424"
}
```



---

archive/issue_events_178425.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-03-08T22:14:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178425"
}
```



---

archive/issue_comments_183294.json:
```json
{
    "body": "**Changing branch** from \"[public/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14798)\" to \"[a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)\".",
    "created_at": "2016-03-09T08:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14798#issuecomment-183294",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/ticket/14798](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/14798)" to "[a8eafa782d2b846b83c4573fff3d0ec57bf93dab](https://github.com/sagemath/sagetrac-mirror/commit/a8eafa782d2b846b83c4573fff3d0ec57bf93dab)".



---

archive/issue_events_178426.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-09T08:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178426"
}
```



---

archive/issue_events_178427.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4fef423acda4c9d26c8a791111147d10a9dbca30",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-03-09T08:29:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14798",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14798#event-178427"
}
```
