# Issue 14754: Update ATLAS to stable version 3.10.1

archive/issues_014550.json:
```json
{
    "assignees": [],
    "body": "* (see also #14781): move untracked files to src/ in preparation for git\n* Added spkg-src\n* Remove the archdef_dir variable, copy our own archdefs into src/ instead\n* Match `isa_ext` level to existing archdefs in order to build atlas faster in the fast/base targets\n\nSpkg diffs:\n* ([p1->p2](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))\n* ([p2->p3](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz))\n\n\nUpdated **spkg** (based on #10508 and #14699):\n1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg) \n\n**Apply** (based on #10508):\n1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.\n3. [attachment: trac_14754-new_opts.patch](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz) to the Sage repository.\n\n**Remove** the lapack and blas packages.\n\nAssignee: **@jdemeyer**\n\nReviewer: **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran\u00e7ois Bissey, John Palmieri, Volker Braun, Jean-Pierre Flori**\n\nAuthor: **Volker Braun, Jeroen Demeyer, Jean-Pierre Flori**\n\nMerged: **sage-5.12.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/14754_\n\n",
    "closed_at": "2013-08-02T14:19:34Z",
    "created_at": "2013-06-17T12:21:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update ATLAS to stable version 3.10.1",
    "type": "issue",
    "updated_at": "2013-08-14T16:17:59Z",
    "url": "https://github.com/sagemath/sage/issues/14754",
    "user": "https://github.com/jdemeyer"
}
```
* (see also #14781): move untracked files to src/ in preparation for git
* Added spkg-src
* Remove the archdef_dir variable, copy our own archdefs into src/ instead
* Match `isa_ext` level to existing archdefs in order to build atlas faster in the fast/base targets

Spkg diffs:
* ([p1->p2](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))
* ([p2->p3](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz))


Updated **spkg** (based on #10508 and #14699):
1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg) 

**Apply** (based on #10508):
1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.
3. [attachment: trac_14754-new_opts.patch](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz) to the Sage repository.

**Remove** the lapack and blas packages.

Assignee: **@jdemeyer**

Reviewer: **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran√ßois Bissey, John Palmieri, Volker Braun, Jean-Pierre Flori**

Author: **Volker Braun, Jeroen Demeyer, Jean-Pierre Flori**

Merged: **sage-5.12.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/14754_





---

archive/issue_events_192300.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:21:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192300"
}
```



---

archive/issue_events_192301.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:21:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192301"
}
```



---

archive/issue_events_192302.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:21:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192302"
}
```



---

archive/issue_events_192303.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-17T12:21:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192303"
}
```



---

archive/issue_comments_182385.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,9 @@\n-Updated **spkg**:\n-1. [http://boxen.math.washington.edu/home/jpflori/spkg/atlas-3.10.1.p0.spkg](http://boxen.math.washington.edu/home/jpflori/spkg/atlas-3.10.1.p0.spkg).\n+There were problems with #10508 with binary distributions, so we need to fix that first before releasing a atlas-3.10.x package.\n \n-**Apply**\n+Updated **spkg** (originally at #14699):\n+1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)\n+\n+**Apply** (originally at #10508):\n 1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository \n 2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.\n \n``````\n",
    "created_at": "2013-06-17T12:23:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182385",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,9 @@
-Updated **spkg**:
-1. [http://boxen.math.washington.edu/home/jpflori/spkg/atlas-3.10.1.p0.spkg](http://boxen.math.washington.edu/home/jpflori/spkg/atlas-3.10.1.p0.spkg).
+There were problems with #10508 with binary distributions, so we need to fix that first before releasing a atlas-3.10.x package.
 
-**Apply**
+Updated **spkg** (originally at #14699):
+1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)
+
+**Apply** (originally at #10508):
 1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository 
 2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.
 
``````




---

archive/issue_comments_182386.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-There were problems with #10508 with binary distributions, so we need to fix that first before releasing a atlas-3.10.x package.\n+There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.\n \n Updated **spkg** (originally at #14699):\n 1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)\n``````\n",
    "created_at": "2013-06-17T12:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182386",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-There were problems with #10508 with binary distributions, so we need to fix that first before releasing a atlas-3.10.x package.
+There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.
 
 Updated **spkg** (originally at #14699):
 1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)
``````




---

archive/issue_comments_182387.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.\n \n-Updated **spkg** (originally at #14699):\n-1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)\n+Updated **spkg** (based on #10508 and #14699):\n+1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg\n \n **Apply** (originally at #10508):\n 1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository \n``````\n",
    "created_at": "2013-06-17T12:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182387",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.
 
-Updated **spkg** (originally at #14699):
-1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p1.spkg)
+Updated **spkg** (based on #10508 and #14699):
+1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg
 
 **Apply** (originally at #10508):
 1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository 
``````




---

archive/issue_comments_182388.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nWhen removing `3DNow`, it starts using `SSE1` and `SSE2`, which shouldn't happen either. But this also happens with the old ATLAS spkg, so at least it's not a regression.",
    "created_at": "2013-06-17T13:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182388",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">Comment 4</div>

When removing `3DNow`, it starts using `SSE1` and `SSE2`, which shouldn't happen either. But this also happens with the old ATLAS spkg, so at least it's not a regression.



---

archive/issue_comments_182389.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nYou should use `isa_ext=('None',)` if you want to explictly disable it, see `ATLAS_ISAEXT`.\n\nThe given extensions are not mandatory but are supposed to let ATLAS try them. Whether or not they end up being used is up to the ATLAS build system and how well they perform. Though it seems that you found a bug with ancient cpus, which is unsurprising since I'm pretty sure that nobody else than us builds ATLAS on museum pieces.",
    "created_at": "2013-06-17T14:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182389",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">Comment 5</div>

You should use `isa_ext=('None',)` if you want to explictly disable it, see `ATLAS_ISAEXT`.

The given extensions are not mandatory but are supposed to let ATLAS try them. Whether or not they end up being used is up to the ATLAS build system and how well they perform. Though it seems that you found a bug with ancient cpus, which is unsurprising since I'm pretty sure that nobody else than us builds ATLAS on museum pieces.



---

archive/issue_comments_182390.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@vbraun](#comment%3A5):\n> You should use `isa_ext=('None',)` if you want to explictly disable it, see `ATLAS_ISAEXT`.\n\nDone in linked spkg, not yet tested.",
    "created_at": "2013-06-17T20:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182390",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@vbraun](#comment%3A5):
> You should use `isa_ext=('None',)` if you want to explictly disable it, see `ATLAS_ISAEXT`.

Done in linked spkg, not yet tested.



---

archive/issue_comments_182391.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,8 +3,8 @@\n Updated **spkg** (based on #10508 and #14699):\n 1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg\n \n-**Apply** (originally at #10508):\n-1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository \n+**Apply** (based on #10508):\n+1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n 2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.\n \n **Remove** the lapack and blas packages.\n``````\n",
    "created_at": "2013-06-18T09:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182391",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,8 +3,8 @@
 Updated **spkg** (based on #10508 and #14699):
 1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg
 
-**Apply** (originally at #10508):
-1. [attachment: 10508_root.patch](https://github.com/sagemath/sage/files/ticket14754/10508_root.patch.gz) to the SAGE_ROOT repository 
+**Apply** (based on #10508):
+1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
 2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.
 
 **Remove** the lapack and blas packages.
``````




---

archive/issue_comments_182392.json:
```json
{
    "body": "Attachment: **[14754_root.patch.gz](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz)**",
    "created_at": "2013-06-18T09:38:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182392",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[14754_root.patch.gz](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz)**



---

archive/issue_comments_182393.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.\n \n Updated **spkg** (based on #10508 and #14699):\n-1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg\n+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))\n \n **Apply** (based on #10508):\n 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n``````\n",
    "created_at": "2013-06-18T09:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182393",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.
 
 Updated **spkg** (based on #10508 and #14699):
-1. http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg
+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))
 
 **Apply** (based on #10508):
 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
``````




---

archive/issue_comments_182394.json:
```json
{
    "body": "Attachment: **[14754_update_atlas_docs.patch.gz](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz)**",
    "created_at": "2013-06-18T10:01:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182394",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[14754_update_atlas_docs.patch.gz](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz)**



---

archive/issue_comments_182395.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,6 @@\n \n **Apply** (based on #10508):\n 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n-2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.\n+2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.\n \n **Remove** the lapack and blas packages.\n``````\n",
    "created_at": "2013-06-18T10:02:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182395",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,6 @@
 
 **Apply** (based on #10508):
 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
-2. [attachment: trac_10508_update_atlas_docs.rebased.patch](https://github.com/sagemath/sage/files/ticket14754/trac_10508_update_atlas_docs.rebased.patch.gz) to the Sage repository.
+2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.
 
 **Remove** the lapack and blas packages.
``````




---

archive/issue_comments_182396.json:
```json
{
    "body": "spkg diff",
    "created_at": "2013-06-18T12:58:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182396",
    "user": "https://github.com/jdemeyer"
}
```

spkg diff



---

archive/issue_events_192304.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-06-19T06:54:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192304"
}
```



---

archive/issue_comments_182397.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nAttachment: **[atlas-3.10.1.p2.diff.gz](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz)**",
    "created_at": "2013-06-19T06:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182397",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">Comment 10</div>

Attachment: **[atlas-3.10.1.p2.diff.gz](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz)**



---

archive/issue_comments_182398.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nOn 64 bit intel chips we should definitely enable SSE2\n\nEdit: misread the patch, the SSE2 is there but there is no 64-bit x86SSE264 archdef. But I guess thats ok, we wil just run through the tuning. There is no 32-bit archdef for ancient 64-bit intel chips",
    "created_at": "2013-06-19T07:18:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182398",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">Comment 11</div>

On 64 bit intel chips we should definitely enable SSE2

Edit: misread the patch, the SSE2 is there but there is no 64-bit x86SSE264 archdef. But I guess thats ok, we wil just run through the tuning. There is no 32-bit archdef for ancient 64-bit intel chips



---

archive/issue_comments_182399.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nAnd the real question: does it improve the build time on ancient i386 chips without SSE? The only real improvement would be if the pure x87 archdef would be used and is actually faster to compile than the full tuning.",
    "created_at": "2013-06-19T07:20:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182399",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">Comment 12</div>

And the real question: does it improve the build time on ancient i386 chips without SSE? The only real improvement would be if the pure x87 archdef would be used and is actually faster to compile than the full tuning.



---

archive/issue_comments_182400.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nVolker, you obviously understand this stuff better than me, so if you want to make a reviewer patch, go ahead.\n\nMy main concern is that `configure_base()` should produce a generic binary, meaning it runs on all processors of a given architecture.\n\n(although note that the oldest i386-architecture processor that we test Sage on is a Pentium 4, which has SSE and SSE2)",
    "created_at": "2013-06-19T07:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182400",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">Comment 13</div>

Volker, you obviously understand this stuff better than me, so if you want to make a reviewer patch, go ahead.

My main concern is that `configure_base()` should produce a generic binary, meaning it runs on all processors of a given architecture.

(although note that the oldest i386-architecture processor that we test Sage on is a Pentium 4, which has SSE and SSE2)



---

archive/issue_comments_182401.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nThere is no way to make a binary that will run on all x86 cpus ever made. For starters, the original x86 didn't even have x87. Its an evolving instruction set, and we should aim at \"everything within the last X years\" and not the most dumb binary that we can possibly build. Otherwise we'll just make false claims since nobody is going to be able to test that the binary actually works.\n\nThe only reason for removing the 3DNow would be if that makes build time faster since the naming scheme for the \"generic i386 archdef\" is without it. Which is why I'm asking if it actually helps. And for that I guess we'll have to time builds on cicero, maybe I'll get around to it after the 22nd when you are gone.",
    "created_at": "2013-06-19T14:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182401",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">Comment 14</div>

There is no way to make a binary that will run on all x86 cpus ever made. For starters, the original x86 didn't even have x87. Its an evolving instruction set, and we should aim at "everything within the last X years" and not the most dumb binary that we can possibly build. Otherwise we'll just make false claims since nobody is going to be able to test that the binary actually works.

The only reason for removing the 3DNow would be if that makes build time faster since the naming scheme for the "generic i386 archdef" is without it. Which is why I'm asking if it actually helps. And for that I guess we'll have to time builds on cicero, maybe I'll get around to it after the 22nd when you are gone.



---

archive/issue_comments_182402.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@vbraun](#comment%3A14):\n> The only reason for removing the 3DNow\n\nAs far as I know, 3DNow is AMD-only, so you would be excluding all Intel chips...",
    "created_at": "2013-06-19T14:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182402",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@vbraun](#comment%3A14):
> The only reason for removing the 3DNow

As far as I know, 3DNow is AMD-only, so you would be excluding all Intel chips...



---

archive/issue_comments_182403.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nIndeed, that's what i found as well, so enabling 3DNow was a bad idea.\nI suggest to use:\n* the x86x87 target with no ISA extension on 32 bits, it should cover most CPUs except for the ones which have been even discarded from museum,\n* x86 plus SSE2 for 64 bits.\nNote ATLAS provide archdefs for the former and Volker added archdefs for the latter.",
    "created_at": "2013-06-19T15:14:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182403",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:16" align="right">Comment 16</div>

Indeed, that's what i found as well, so enabling 3DNow was a bad idea.
I suggest to use:
* the x86x87 target with no ISA extension on 32 bits, it should cover most CPUs except for the ones which have been even discarded from museum,
* x86 plus SSE2 for 64 bits.
Note ATLAS provide archdefs for the former and Volker added archdefs for the latter.



---

archive/issue_comments_182404.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nSo basically I completely agree with what Jeroen did.\n\nHow are the generic and non-generic build going on?",
    "created_at": "2013-06-19T15:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182404",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:17" align="right">Comment 17</div>

So basically I completely agree with what Jeroen did.

How are the generic and non-generic build going on?



---

archive/issue_comments_182405.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\n(About the x86x87 target, ATLAS doc at http://math-atlas.sourceforge.net/atlas_install/node28.html states:\n\n```\n(I believe this is all Intel architectures from PentiumPRO onwards, and any AMD platform since at least the original Athlon)\n```\nI would feel this is quite old enough.",
    "created_at": "2013-06-19T15:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182405",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:18" align="right">Comment 18</div>

(About the x86x87 target, ATLAS doc at http://math-atlas.sourceforge.net/atlas_install/node28.html states:

```
(I believe this is all Intel architectures from PentiumPRO onwards, and any AMD platform since at least the original Athlon)
```
I would feel this is quite old enough.



---

archive/issue_comments_182406.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI agree that the change is correct **if it actually uses the archdef now**. So there is some testing to be done.\n\nIn the absence of archdefs we should still enable 3Dnow (and SSE in a few years). x86x87 is already an isa extension over stone-age x86. And \"enabling\" means: try to build the kernel. Whether or not it is actually used by ATLAS depends on whether it actually compiles, runs, and performs well. Not that I think that there is any particular 3dnow asm in ATLAS, but in the near future this will be important for SSE.",
    "created_at": "2013-06-19T16:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182406",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">Comment 19</div>

I agree that the change is correct **if it actually uses the archdef now**. So there is some testing to be done.

In the absence of archdefs we should still enable 3Dnow (and SSE in a few years). x86x87 is already an isa extension over stone-age x86. And "enabling" means: try to build the kernel. Whether or not it is actually used by ATLAS depends on whether it actually compiles, runs, and performs well. Not that I think that there is any particular 3dnow asm in ATLAS, but in the near future this will be important for SSE.



---

archive/issue_comments_182407.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@vbraun](#comment%3A19):\n> we should still enable 3Dnow (and SSE in a few years).\n\nThat makes no sense at all. Intel Pentium 4 (quite old but not stone-age) has SSE and SSE2 but not 3DNow.\n\n> Not that I think that there is any particular 3dnow asm in ATLAS, but in the near future this will be important for SSE.\n\nThere surely is, otherwise I wouldn't be seeing all those \"Illegal Instruction\" errors.",
    "created_at": "2013-06-20T06:43:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182407",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@vbraun](#comment%3A19):
> we should still enable 3Dnow (and SSE in a few years).

That makes no sense at all. Intel Pentium 4 (quite old but not stone-age) has SSE and SSE2 but not 3DNow.

> Not that I think that there is any particular 3dnow asm in ATLAS, but in the near future this will be important for SSE.

There surely is, otherwise I wouldn't be seeing all those "Illegal Instruction" errors.



---

archive/issue_comments_182408.json:
```json
{
    "body": "Work Issues: **archdef_dir, PATCH_DIR**",
    "created_at": "2013-06-20T16:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182408",
    "user": "https://github.com/sagetrac-jpflori"
}
```

Work Issues: **archdef_dir, PATCH_DIR**



---

archive/issue_events_192305.json:
```json
{
    "actor": "https://github.com/sagetrac-jpflori",
    "created_at": "2013-06-20T16:17:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192305"
}
```



---

archive/issue_events_192306.json:
```json
{
    "actor": "https://github.com/sagetrac-jpflori",
    "created_at": "2013-06-20T16:17:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192306"
}
```



---

archive/issue_comments_182409.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nIn spkg-install, the \"archdef_dir = PATCH_DIR\" line for the base target on x86 64 bits should be removed.\nI've moved the tarballs into a ARCH subdir and reenabled copying of archdefs tarballs into ATLAS proper dir, so it should find them without tweaking archdef_dir.\nOr you could disable the copying and set archdef_dir...\n\nBy the way, for the fast target we could also refactor the archdef_dir setting and isa_ext, potentially setting isa_ext = ('None',) by default as for the base target.\n\nQuestion for Volker, how to tell for sure that archdefs are used? apart from a shorter building time?\n\nApart from this, should we wait for the patchbots reports before putting this to positive_review?\nOr the other way around?",
    "created_at": "2013-06-20T16:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182409",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:21" align="right">Comment 21</div>

In spkg-install, the "archdef_dir = PATCH_DIR" line for the base target on x86 64 bits should be removed.
I've moved the tarballs into a ARCH subdir and reenabled copying of archdefs tarballs into ATLAS proper dir, so it should find them without tweaking archdef_dir.
Or you could disable the copying and set archdef_dir...

By the way, for the fast target we could also refactor the archdef_dir setting and isa_ext, potentially setting isa_ext = ('None',) by default as for the base target.

Question for Volker, how to tell for sure that archdefs are used? apart from a shorter building time?

Apart from this, should we wait for the patchbots reports before putting this to positive_review?
Or the other way around?



---

archive/issue_comments_182410.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@jdemeyer](#comment%3A20):\n> There surely is, otherwise I wouldn't be seeing all those \"Illegal Instruction\" errors.\n\nI don't think so. Unless the build host supports 3dnow there is no way that such a kernel would end up in the atlas library. The illegal instructions are because the previous atlas version (which we are still shipping) erroneously did not respect the given limits to the ISA.",
    "created_at": "2013-06-20T17:35:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182410",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@jdemeyer](#comment%3A20):
> There surely is, otherwise I wouldn't be seeing all those "Illegal Instruction" errors.

I don't think so. Unless the build host supports 3dnow there is no way that such a kernel would end up in the atlas library. The illegal instructions are because the previous atlas version (which we are still shipping) erroneously did not respect the given limits to the ISA.



---

archive/issue_comments_182411.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@sagetrac-jpflori](#comment%3A21):\n> Question for Volker, how to tell for sure that archdefs are used? apart from a shorter building time?\n\nYou can probably read the log, but the only way I would really trust is to measure the build time.",
    "created_at": "2013-06-20T17:37:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182411",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@sagetrac-jpflori](#comment%3A21):
> Question for Volker, how to tell for sure that archdefs are used? apart from a shorter building time?

You can probably read the log, but the only way I would really trust is to measure the build time.



---

archive/issue_comments_182412.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@vbraun](#comment%3A22):\n> I don't think so. Unless the build host supports 3dnow there is no way that such a kernel would end up in the atlas library. The illegal instructions are because the previous atlas version (which we are still shipping) erroneously did not respect the given limits to the ISA.\n\nYou can think what you want, but the fact is that the build of ATLAS-3.10.1 on `cicero` failed with `3DNow` (with `Illegal Instruction` messages in the build log) but succeeded without `3DNow` (without `Illegal Instruction` messages in the build log).",
    "created_at": "2013-06-21T06:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182412",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@vbraun](#comment%3A22):
> I don't think so. Unless the build host supports 3dnow there is no way that such a kernel would end up in the atlas library. The illegal instructions are because the previous atlas version (which we are still shipping) erroneously did not respect the given limits to the ISA.

You can think what you want, but the fact is that the build of ATLAS-3.10.1 on `cicero` failed with `3DNow` (with `Illegal Instruction` messages in the build log) but succeeded without `3DNow` (without `Illegal Instruction` messages in the build log).



---

archive/issue_comments_182413.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nFor the record, I built ATLAS with\n\n```\nSAGE_ATLAS_ARCH=x86x87,3DNow\n```\nand I do get a working install which passes the Sage doctests. So, just to spell it out again, the ISA extension settings just tell ATLAS which ones it is allowed to try, not which ones end up in the ATLAS library. Its normal to get SIGILL during the atlas tuning.\n\nI also verified that it goes through a full tuning which takes a very long time. Presumably that just doesn't work on cicero, or when you tried it the build system couldn't get stable timings.",
    "created_at": "2013-07-07T13:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182413",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">Comment 25</div>

For the record, I built ATLAS with

```
SAGE_ATLAS_ARCH=x86x87,3DNow
```
and I do get a working install which passes the Sage doctests. So, just to spell it out again, the ISA extension settings just tell ATLAS which ones it is allowed to try, not which ones end up in the ATLAS library. Its normal to get SIGILL during the atlas tuning.

I also verified that it goes through a full tuning which takes a very long time. Presumably that just doesn't work on cicero, or when you tried it the build system couldn't get stable timings.



---

archive/issue_events_192307.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-07T13:45:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192307"
}
```



---

archive/issue_events_192308.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-07T13:45:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192308"
}
```



---

archive/issue_comments_182414.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,15 @@\n-There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.\n+* (see also #14781): move untracked files to src/ in preparation for git\n+* Added spkg-src\n+* Remove the archdef_dir variable, copy our own archdefs into src/ instead\n+* Match `isa_ext` level to existing archdefs in order to build atlas faster in the fast/base targets\n+\n+Spkg diffs:\n+* ([p1->p2](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))\n+* ([p2->p3](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz))\n+\n \n Updated **spkg** (based on #10508 and #14699):\n-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))\n+1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg) \n \n **Apply** (based on #10508):\n 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n``````\n",
    "created_at": "2013-07-07T13:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182414",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,15 @@
-There were problems with #10508 with binary distributions (see #14753), so we need to fix that first before releasing a atlas-3.10.x package.
+* (see also #14781): move untracked files to src/ in preparation for git
+* Added spkg-src
+* Remove the archdef_dir variable, copy our own archdefs into src/ instead
+* Match `isa_ext` level to existing archdefs in order to build atlas faster in the fast/base targets
+
+Spkg diffs:
+* ([p1->p2](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))
+* ([p2->p3](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz))
+
 
 Updated **spkg** (based on #10508 and #14699):
-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/atlas-3.10.1.p2.spkg) ([spkg diff](https://github.com/sagemath/sage/files/ticket14754/atlas-3.10.1.p2.diff.gz))
+1. [http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg](http://boxen.math.washington.edu/home/vbraun/spkg/atlas-3.10.1.p3.spkg) 
 
 **Apply** (based on #10508):
 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
``````




---

archive/issue_comments_182415.json:
```json
{
    "body": "Changed work issues from **archdef_dir, PATCH_DIR** to none",
    "created_at": "2013-07-07T13:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182415",
    "user": "https://github.com/vbraun"
}
```

Changed work issues from **archdef_dir, PATCH_DIR** to none



---

archive/issue_comments_182416.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nBoth the fast and base targets for 32-bit intel did not make use of the existing archdefs because of the isa extension mismatch in the filename. Fixed now.",
    "created_at": "2013-07-07T14:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182416",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">Comment 27</div>

Both the fast and base targets for 32-bit intel did not make use of the existing archdefs because of the isa extension mismatch in the filename. Fixed now.



---

archive/issue_comments_182417.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nGreat that you provided a proper spkg-src script.\nI'll try to review the spkg tomorrow.\n\nAnd about 3DNow (I saw you did not put it in back), we don't want to put it in base or fast anyway because it's AMD only, so if you happen to build a dist tarball of Sage, typically by setting the FAT option, on a computer with 3DNow, it will get in and later segfault if you run it on an Intel computer.",
    "created_at": "2013-07-07T17:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182417",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:28" align="right">Comment 28</div>

Great that you provided a proper spkg-src script.
I'll try to review the spkg tomorrow.

And about 3DNow (I saw you did not put it in back), we don't want to put it in base or fast anyway because it's AMD only, so if you happen to build a dist tarball of Sage, typically by setting the FAT option, on a computer with 3DNow, it will get in and later segfault if you run it on an Intel computer.



---

archive/issue_comments_182418.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nReplying to [@sagetrac-jpflori](#comment%3A28):\n> And about 3DNow, we don't want to put it in base or fast anyway because it's AMD only\n\nKind of a moot point since we don't distribute binaries built on such an old machine. Also, `SAGE_FAT_BINARY` is \"base\" so the 3DNow would be fair game for the \"fast\" target. Except that, there, we already require SSE2.",
    "created_at": "2013-07-07T21:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182418",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">Comment 29</div>

Replying to [@sagetrac-jpflori](#comment%3A28):
> And about 3DNow, we don't want to put it in base or fast anyway because it's AMD only

Kind of a moot point since we don't distribute binaries built on such an old machine. Also, `SAGE_FAT_BINARY` is "base" so the 3DNow would be fair game for the "fast" target. Except that, there, we already require SSE2.



---

archive/issue_comments_182419.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nWhen I build the 32-bit base/fast versions in my 32-bit virtual machine then I get doctest errors in Sage. Might be something wrong with my VM, though.",
    "created_at": "2013-07-08T14:16:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182419",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:30" align="right">Comment 30</div>

When I build the 32-bit base/fast versions in my 32-bit virtual machine then I get doctest errors in Sage. Might be something wrong with my VM, though.



---

archive/issue_comments_182420.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nThe doctest failures go away if I disable threading, so perhaps this breaks because I'm building on an quad-core i7. Unless sombody objects, I'd say we disable threading on 32-bit intel base/fast targets. This should probably be done independent of this issue because the \"generic\" library shouldn't have multithreaded thresholds being derived from the latest CPUs with lots of cores.",
    "created_at": "2013-07-08T17:35:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182420",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">Comment 31</div>

The doctest failures go away if I disable threading, so perhaps this breaks because I'm building on an quad-core i7. Unless sombody objects, I'd say we disable threading on 32-bit intel base/fast targets. This should probably be done independent of this issue because the "generic" library shouldn't have multithreaded thresholds being derived from the latest CPUs with lots of cores.



---

archive/issue_comments_182421.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nI don't really like the idea...\nPlease also see #14605, the way threading is dealt with is kindof completely broken right now.",
    "created_at": "2013-07-08T19:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182421",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:32" align="right">Comment 32</div>

I don't really like the idea...
Please also see #14605, the way threading is dealt with is kindof completely broken right now.



---

archive/issue_comments_182422.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nTell me about it.. I took your `threads.patch` to make it build at all.\n\nBut IMHO its much more important to get an ATLAS update in Sage than fixing threading bugs. So if that means we have to disable it on 32-bit then that sucks but is still better than the current state.",
    "created_at": "2013-07-08T19:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182422",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">Comment 33</div>

Tell me about it.. I took your `threads.patch` to make it build at all.

But IMHO its much more important to get an ATLAS update in Sage than fixing threading bugs. So if that means we have to disable it on 32-bit then that sucks but is still better than the current state.



---

archive/issue_comments_182423.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nPS: The updated spkg makes the thread limit configurable via, for example,\n\n```\nSAGE_ATLAS_ARCH=threads=2,fast\n``` \nSetting the limit to 0 disables threading. Specifying the thread limit is completely optional. This is useful for testing.",
    "created_at": "2013-07-08T19:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182423",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:34" align="right">Comment 34</div>

PS: The updated spkg makes the thread limit configurable via, for example,

```
SAGE_ATLAS_ARCH=threads=2,fast
``` 
Setting the limit to 0 disables threading. Specifying the thread limit is completely optional. This is useful for testing.



---

archive/issue_comments_182424.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nIn fact, the threaded ATLAS doesn't work on x86_64 either. I must have run the doctests in the wrong Sage install the other day?",
    "created_at": "2013-07-09T17:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182424",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">Comment 35</div>

In fact, the threaded ATLAS doesn't work on x86_64 either. I must have run the doctests in the wrong Sage install the other day?



---

archive/issue_comments_182425.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nMy bad, liblinbox was linked with the system atlas (version 3.8.4). Mixing its threading symbols with ATLAS-3.10.1 is instant disaster.",
    "created_at": "2013-07-09T17:43:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182425",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:36" align="right">Comment 36</div>

My bad, liblinbox was linked with the system atlas (version 3.8.4). Mixing its threading symbols with ATLAS-3.10.1 is instant disaster.



---

archive/issue_comments_182426.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@vbraun](#comment%3A29):\n> Replying to [@sagetrac-jpflori](#comment%3A28):\n> > And about 3DNow, we don't want to put it in base or fast anyway because it's AMD only\n\n> \n> Kind of a moot point since we don't distribute binaries built on such an old machine. Also, `SAGE_FAT_BINARY` is \"base\" so the 3DNow would be fair game for the \"fast\" target. Except that, there, we already require SSE2. \n\nIt does not tackle the problem that 3DNow is AMD only...\nI could imagine someone wanting to distribute a sage bdist with a \"fast\" but still somehow portable ATLAS.\nYou can still argue that in that case he can very well remove 3DNow himself if he wants ot play with fire...\n\nI just don't like to add non-universal extensions to predifined targets although I completely agree that if we consider that someone who builds with fast should only expect it to work on the machine where it was built then trying 3DNow makes sense.\n\nAnyway, does using 3DNow in addition of SSE or SSE2 gives any speedup?\nI guess not, so let's forget about 3DNow for \"fast\" because we have SSE2 and for \"base\" because we don't want people to end up distributing AMD only binaries (though it's highly unlikely, I agree)...",
    "created_at": "2013-07-09T20:44:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182426",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@vbraun](#comment%3A29):
> Replying to [@sagetrac-jpflori](#comment%3A28):
> > And about 3DNow, we don't want to put it in base or fast anyway because it's AMD only

> 
> Kind of a moot point since we don't distribute binaries built on such an old machine. Also, `SAGE_FAT_BINARY` is "base" so the 3DNow would be fair game for the "fast" target. Except that, there, we already require SSE2. 

It does not tackle the problem that 3DNow is AMD only...
I could imagine someone wanting to distribute a sage bdist with a "fast" but still somehow portable ATLAS.
You can still argue that in that case he can very well remove 3DNow himself if he wants ot play with fire...

I just don't like to add non-universal extensions to predifined targets although I completely agree that if we consider that someone who builds with fast should only expect it to work on the machine where it was built then trying 3DNow makes sense.

Anyway, does using 3DNow in addition of SSE or SSE2 gives any speedup?
I guess not, so let's forget about 3DNow for "fast" because we have SSE2 and for "base" because we don't want people to end up distributing AMD only binaries (though it's highly unlikely, I agree)...



---

archive/issue_comments_182427.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nReplying to [@vbraun](#comment%3A34):\n> PS: The updated spkg makes the thread limit configurable via, for example,\n> \n> ```\n> SAGE_ATLAS_ARCH=threads=2,fast\n> ``` \n> Setting the limit to 0 disables threading. Specifying the thread limit is completely optional. This is useful for testing.\n\nGreat.",
    "created_at": "2013-07-09T20:50:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182427",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:38" align="right">Comment 38</div>

Replying to [@vbraun](#comment%3A34):
> PS: The updated spkg makes the thread limit configurable via, for example,
> 
> ```
> SAGE_ATLAS_ARCH=threads=2,fast
> ``` 
> Setting the limit to 0 disables threading. Specifying the thread limit is completely optional. This is useful for testing.

Great.



---

archive/issue_comments_182428.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nReplying to [@vbraun](#comment%3A33):\n> Tell me about it.. I took your `threads.patch` to make it build at all.\n> \n> But IMHO its much more important to get an ATLAS update in Sage than fixing threading bugs. So if that means we have to disable it on 32-bit then that sucks but is still better than the current state.\n\nIs this really because of the VM (or the OS?) being 32 bits?\nIt seems strange.\nOr did you also get mixed symbols?\n\nAnyway, I agree the base target should disable threading.\nFor the fast one, if we go for \"the \"fast\" target should only run on the machine where it is built\" interpretation, then it's kind of bad. But if threading is indeed broken on all 32 bits OSes, then we don't have a choice.\nIf we want to consider that the \"fast\" build is also \"generic\" and could be redistributed, then disabling threading is completely ok, till we decide that recent enough computers have more than one core :)",
    "created_at": "2013-07-09T20:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182428",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:39" align="right">Comment 39</div>

Replying to [@vbraun](#comment%3A33):
> Tell me about it.. I took your `threads.patch` to make it build at all.
> 
> But IMHO its much more important to get an ATLAS update in Sage than fixing threading bugs. So if that means we have to disable it on 32-bit then that sucks but is still better than the current state.

Is this really because of the VM (or the OS?) being 32 bits?
It seems strange.
Or did you also get mixed symbols?

Anyway, I agree the base target should disable threading.
For the fast one, if we go for "the "fast" target should only run on the machine where it is built" interpretation, then it's kind of bad. But if threading is indeed broken on all 32 bits OSes, then we don't have a choice.
If we want to consider that the "fast" build is also "generic" and could be redistributed, then disabling threading is completely ok, till we decide that recent enough computers have more than one core :)



---

archive/issue_comments_182429.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@vbraun](#comment%3A31):\n> This should probably be done independent of this issue because the \"generic\" library shouldn't have multithreaded thresholds being derived from the latest CPUs with lots of cores.\n\nYou mean reenabling threading on 32 bits intel?\n(In case it was not broken just because of mixed symbols of course.)",
    "created_at": "2013-07-09T21:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182429",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@vbraun](#comment%3A31):
> This should probably be done independent of this issue because the "generic" library shouldn't have multithreaded thresholds being derived from the latest CPUs with lots of cores.

You mean reenabling threading on 32 bits intel?
(In case it was not broken just because of mixed symbols of course.)



---

archive/issue_comments_182430.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nSystem ATLAS is (at least on Fedora) libatlas.so.3 and we install libatlas.so.2. Since I rebuilt various packages mixing system atlas (using SAGE_ATLAS_LIB) and self-compiled atlas, I ended up with a mix of symbols. I've changed our versioning to use .3 as well. Upstream doesn't version the library but since it is ATLAS 3.x most distributors will probably opt for .3.\n\nI agree that there is no point in 3DNow on SSE-enabled processors. Its not used anywhere now.\n\nI think that was the problem with 32-bit, too. But I'm still running tests. Will re-enable \"fast\" threads on 32-bit if it works...\n\nI've changed the threads option to colon\n\n```\nSAGE_ATLAS_ARCH=threads:2,static,fast\n```\nand added the optional \"static\" to also install static libraries (though built with -fPIC, really only useful for debugging)\n\nFinally, I'm also installing upstream's new ATLAS shared library (libsatlas.so / libtatlas.so). Eventually we'll want to switch Sage over to those, so we might just as well install them already.",
    "created_at": "2013-07-09T21:36:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182430",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:41" align="right">Comment 41</div>

System ATLAS is (at least on Fedora) libatlas.so.3 and we install libatlas.so.2. Since I rebuilt various packages mixing system atlas (using SAGE_ATLAS_LIB) and self-compiled atlas, I ended up with a mix of symbols. I've changed our versioning to use .3 as well. Upstream doesn't version the library but since it is ATLAS 3.x most distributors will probably opt for .3.

I agree that there is no point in 3DNow on SSE-enabled processors. Its not used anywhere now.

I think that was the problem with 32-bit, too. But I'm still running tests. Will re-enable "fast" threads on 32-bit if it works...

I've changed the threads option to colon

```
SAGE_ATLAS_ARCH=threads:2,static,fast
```
and added the optional "static" to also install static libraries (though built with -fPIC, really only useful for debugging)

Finally, I'm also installing upstream's new ATLAS shared library (libsatlas.so / libtatlas.so). Eventually we'll want to switch Sage over to those, so we might just as well install them already.



---

archive/issue_comments_182431.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nGreat only good news.\nI also kind of disliked the multiple equal signs to control threading.",
    "created_at": "2013-07-09T21:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182431",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:42" align="right">Comment 42</div>

Great only good news.
I also kind of disliked the multiple equal signs to control threading.



---

archive/issue_comments_182432.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nNote that having a static atlas is useful for Cygwin as libtool won't build the shared library there.",
    "created_at": "2013-07-09T21:43:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182432",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:43" align="right">Comment 43</div>

Note that having a static atlas is useful for Cygwin as libtool won't build the shared library there.



---

archive/issue_comments_182433.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nIn particular, I suggest that if static is enabled, then don't let the whole spkg-install script fail if building the shared library failed, but building (and installing) the static one did not.",
    "created_at": "2013-07-09T21:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182433",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:44" align="right">Comment 44</div>

In particular, I suggest that if static is enabled, then don't let the whole spkg-install script fail if building the shared library failed, but building (and installing) the static one did not.



---

archive/issue_comments_182434.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nDoes the Cygwin build actually get that far? ATLAS configure has a bunch of Cygwin-related settings and we don't touch any of that stuff.",
    "created_at": "2013-07-09T22:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182434",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:45" align="right">Comment 45</div>

Does the Cygwin build actually get that far? ATLAS configure has a bunch of Cygwin-related settings and we don't touch any of that stuff.



---

archive/issue_comments_182435.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nI do get the error reported on #14753\n\n```\nsage -t --long sage/matrix/matrix_double_dense.pyx\n**********************************************************************\nFile \"sage/matrix/matrix_double_dense.pyx\", line 3809, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_positive_definite\nFailed example:\n    H.is_positive_definite()\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```\nalso with Fedora's version of ATLAS-3.8.4. I'm not sure that the test is actually numerically well-conditioned, it does:\n\n```\nsage: R = random_matrix(CDF, 200)\nsage: H = R.conjugate_transpose()*R\nsage: import scipy.linalg\nsage: scipy.linalg.cholesky(H.numpy(), lower=1)\n```\nDepending on the distribution of `random_matrix` this may be ill-conditioned: http://stackoverflow.com/questions/12322431/generating-a-pseduo-random-positive-definite-matrix. Conditioning numbers are around `10^6` - `10^7` so its not great but not terribly bad either.",
    "created_at": "2013-07-10T03:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182435",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:46" align="right">Comment 46</div>

I do get the error reported on #14753

```
sage -t --long sage/matrix/matrix_double_dense.pyx
**********************************************************************
File "sage/matrix/matrix_double_dense.pyx", line 3809, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_positive_definite
Failed example:
    H.is_positive_definite()
Expected:
    True
Got:
    False
**********************************************************************
```
also with Fedora's version of ATLAS-3.8.4. I'm not sure that the test is actually numerically well-conditioned, it does:

```
sage: R = random_matrix(CDF, 200)
sage: H = R.conjugate_transpose()*R
sage: import scipy.linalg
sage: scipy.linalg.cholesky(H.numpy(), lower=1)
```
Depending on the distribution of `random_matrix` this may be ill-conditioned: http://stackoverflow.com/questions/12322431/generating-a-pseduo-random-positive-definite-matrix. Conditioning numbers are around `10^6` - `10^7` so its not great but not terribly bad either.



---

archive/issue_comments_182436.json:
```json
{
    "body": "Attachment: **[test_atlas.sh.gz](https://github.com/sagemath/sage/files/ticket14754/test_atlas.sh.gz)**\n\nScript to build atlas with base, fast, and default settings",
    "created_at": "2013-07-10T03:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182436",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[test_atlas.sh.gz](https://github.com/sagemath/sage/files/ticket14754/test_atlas.sh.gz)**

Script to build atlas with base, fast, and default settings



---

archive/issue_comments_182437.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nReplying to [@vbraun](#comment%3A45):\n> Does the Cygwin build actually get that far? ATLAS configure has a bunch of Cygwin-related settings and we don't touch any of that stuff.\n\nLast time I tried it finished.\n\nI could even build shared libraries by replacing libtool calls to gcc calls for linking.",
    "created_at": "2013-07-10T07:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182437",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:47" align="right">Comment 47</div>

Replying to [@vbraun](#comment%3A45):
> Does the Cygwin build actually get that far? ATLAS configure has a bunch of Cygwin-related settings and we don't touch any of that stuff.

Last time I tried it finished.

I could even build shared libraries by replacing libtool calls to gcc calls for linking.



---

archive/issue_comments_182438.json:
```json
{
    "body": "for review only",
    "created_at": "2013-07-10T12:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182438",
    "user": "https://github.com/vbraun"
}
```

for review only



---

archive/issue_comments_182439.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nAttachment: **[atlas-p2-p3.diff.gz](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz)**\n\nI built base, fast, and the default (no `SAGE_ATLAS_ARCH`) on a variety of machines and `make ptestlong` succeeds in all cases. Wall time to build ATLAS:\n\n```\n                  |    base     |     fast    |    default\n------------------+-------------+-------------+--------------\nMy Thinkpad W530  |  20m52.259s |  14m34.608s |  13m52.420s\nFedora 19 x86_64  |             |             |\n------------------+-------------+-------------+--------------\nVirtual Machine   |  22m16.444s |  22m23.433s | 244m25.015s\nFedora 19 i686    |             |             |\n------------------+-------------+-------------+--------------\ncicero on skynet  |  38m49.345s |  38m50.003s |  38m24.546s\n                  |             |             |\n```",
    "created_at": "2013-07-12T13:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182439",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">Comment 48</div>

Attachment: **[atlas-p2-p3.diff.gz](https://github.com/sagemath/sage/files/ticket14754/atlas-p2-p3.diff.gz)**

I built base, fast, and the default (no `SAGE_ATLAS_ARCH`) on a variety of machines and `make ptestlong` succeeds in all cases. Wall time to build ATLAS:

```
                  |    base     |     fast    |    default
------------------+-------------+-------------+--------------
My Thinkpad W530  |  20m52.259s |  14m34.608s |  13m52.420s
Fedora 19 x86_64  |             |             |
------------------+-------------+-------------+--------------
Virtual Machine   |  22m16.444s |  22m23.433s | 244m25.015s
Fedora 19 i686    |             |             |
------------------+-------------+-------------+--------------
cicero on skynet  |  38m49.345s |  38m50.003s |  38m24.546s
                  |             |             |
```



---

archive/issue_comments_182440.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nThe new patches introduce a typo:\n\n```\nraise ValuError\n```\n\nI guess you could also get rid of \"autom4te.cache\" in spkg-src.\n\nMaybe document the new options threads and static.\n\nOtherwise everything looks fine, I'm testing it right now.",
    "created_at": "2013-07-15T13:19:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182440",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:49" align="right">Comment 49</div>

The new patches introduce a typo:

```
raise ValuError
```

I guess you could also get rid of "autom4te.cache" in spkg-src.

Maybe document the new options threads and static.

Otherwise everything looks fine, I'm testing it right now.



---

archive/issue_comments_182441.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nUpdated spkg, diff is\n\n```\ndiff -r 4c3c4795e2b6 -r d32570dc368b spkg-install\n--- a/spkg-install\tSun Jul 07 01:00:12 2013 -0400\n+++ b/spkg-install\tTue Jul 16 16:13:17 2013 -0400\n@@ -232,7 +232,7 @@\n             INSTALL_STATIC_LIBRARIES = True\n         elif opt in ATLAS_MACHTYPE + ('fast', 'base'):\n             if arch is not None:\n-                raise ValuError('multiple architectures specified: {0} and {1}'.format(arch, opt))\n+                raise ValueError('multiple architectures specified: {0} and {1}'.format(arch, opt))\n             arch = opt\n         elif opt in ATLAS_ISAEXT:\n             if isa_ext is None:\ndiff -r 4c3c4795e2b6 -r d32570dc368b spkg-src\n--- a/spkg-src\tSun Jul 07 01:00:12 2013 -0400\n+++ b/spkg-src\tTue Jul 16 16:13:17 2013 -0400\n@@ -49,6 +49,7 @@\n cp -rp \"$SPKG_ROOT\"/patches/ATLAS-lib .\n cd ATLAS-lib\n autoreconf -fiv\n+rm -rf autom4te.cache\n \n \n ### Finished creating the src/ directory\n```",
    "created_at": "2013-07-16T20:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182441",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">Comment 50</div>

Updated spkg, diff is

```
diff -r 4c3c4795e2b6 -r d32570dc368b spkg-install
--- a/spkg-install	Sun Jul 07 01:00:12 2013 -0400
+++ b/spkg-install	Tue Jul 16 16:13:17 2013 -0400
@@ -232,7 +232,7 @@
             INSTALL_STATIC_LIBRARIES = True
         elif opt in ATLAS_MACHTYPE + ('fast', 'base'):
             if arch is not None:
-                raise ValuError('multiple architectures specified: {0} and {1}'.format(arch, opt))
+                raise ValueError('multiple architectures specified: {0} and {1}'.format(arch, opt))
             arch = opt
         elif opt in ATLAS_ISAEXT:
             if isa_ext is None:
diff -r 4c3c4795e2b6 -r d32570dc368b spkg-src
--- a/spkg-src	Sun Jul 07 01:00:12 2013 -0400
+++ b/spkg-src	Tue Jul 16 16:13:17 2013 -0400
@@ -49,6 +49,7 @@
 cp -rp "$SPKG_ROOT"/patches/ATLAS-lib .
 cd ATLAS-lib
 autoreconf -fiv
+rm -rf autom4te.cache
 
 
 ### Finished creating the src/ directory
```



---

archive/issue_comments_182442.json:
```json
{
    "body": "Document new options.",
    "created_at": "2013-07-18T09:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182442",
    "user": "https://github.com/sagetrac-jpflori"
}
```

Document new options.



---

archive/issue_comments_182443.json:
```json
{
    "body": "Changed reviewer from **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran\u00e7ois Bissey, John Palmieri, Volker Braun** to **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran\u00e7ois Bissey, John Palmieri, Volker Braun, Jean-Pierre Flori**",
    "created_at": "2013-07-18T10:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182443",
    "user": "https://github.com/sagetrac-jpflori"
}
```

Changed reviewer from **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran√ßois Bissey, John Palmieri, Volker Braun** to **Benjamin Jones, Karl-Dieter Crisman, Dmitrii Pasechnik, Georg Weber, Fran√ßois Bissey, John Palmieri, Volker Braun, Jean-Pierre Flori**



---

archive/issue_comments_182444.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nAttachment: **[trac_14754-new_opts.patch.gz](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz)**\n\nI'm happy with Volker changes.\n\nIf he agrees with my changes to the doc, let's put this as positive review.",
    "created_at": "2013-07-18T10:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182444",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<div id="comment:51" align="right">Comment 51</div>

Attachment: **[trac_14754-new_opts.patch.gz](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz)**

I'm happy with Volker changes.

If he agrees with my changes to the doc, let's put this as positive review.



---

archive/issue_comments_182445.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,5 +14,6 @@\n **Apply** (based on #10508):\n 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository \n 2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.\n+3. [attachment: trac_14754-new_opts.patch](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz) to the Sage repository.\n \n **Remove** the lapack and blas packages.\n``````\n",
    "created_at": "2013-07-18T10:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182445",
    "user": "https://github.com/sagetrac-jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,5 +14,6 @@
 **Apply** (based on #10508):
 1. [attachment: 14754_root.patch](https://github.com/sagemath/sage/files/ticket14754/14754_root.patch.gz) to the SAGE_ROOT repository 
 2. [attachment: 14754_update_atlas_docs.patch](https://github.com/sagemath/sage/files/ticket14754/14754_update_atlas_docs.patch.gz) to the Sage repository.
+3. [attachment: trac_14754-new_opts.patch](https://github.com/sagemath/sage/files/ticket14754/trac_14754-new_opts.patch.gz) to the Sage repository.
 
 **Remove** the lapack and blas packages.
``````




---

archive/issue_comments_182446.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nThanks, looks good to me.",
    "created_at": "2013-07-18T13:21:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182446",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">Comment 52</div>

Thanks, looks good to me.



---

archive/issue_events_192309.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-18T13:21:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192309"
}
```



---

archive/issue_events_192310.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-07-18T13:21:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192310"
}
```



---

archive/issue_events_192311.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:11:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192311"
}
```



---

archive/issue_events_192312.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:11:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192312"
}
```



---

archive/issue_events_192313.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:19:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192313"
}
```



---

archive/issue_events_192314.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:19:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/14754#event-192314"
}
```



---

archive/issue_comments_182447.json:
```json
{
    "body": "Merged: **sage-5.12.beta0**",
    "created_at": "2013-08-02T14:19:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182447",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta0**



---

archive/issue_comments_182448.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nSee #15045 for a blocker follow-up.",
    "created_at": "2013-08-14T16:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/14754",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/14754#issuecomment-182448",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">Comment 55</div>

See #15045 for a blocker follow-up.
