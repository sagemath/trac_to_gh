# Issue 28513: another maxima integration bug

Issue created by migration from https://trac.sagemath.org/ticket/28750

Original creator: chapoton

Original creation time: 2019-11-17 13:55:04

CC:  @nasser1 kcrisman slelievre @davewittemorris

Keywords: integrate, maxima


```
var('s,x,y')
q = sqrt(2)
g = (x - y) * sin((x - y) / s)
g1 = integral(g({s:q}), y)
g2 = integral(g({s:q}), y, algorithm='sympy')
g3 = integral(g, y).subs({s:q})
```

Then g2 and g3 have the correct derivative, but not g1.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-05-10 17:42:09

Moving to 9.4, as 9.3 has been released.


---

Comment by chapoton created at 2021-06-05 18:36:17

EDIT:

in sage 9.4.b0, numerically :

the derivative of g1 is wrong ; those of g2 and g3 are ok


---

Comment by chapoton created at 2021-06-06 07:12:00

directly in maxima:

```
maxima: a: sin((x-y)/sqrt(2))*(x-y);                                            
sin((x-y)/sqrt(2))*(x-y)

maxima: g: integrate(a,y);                                                      
((2^(3/2)+2)*sin(y/sqrt(2)-x/sqrt(2))+(((-2^(3/2))-2)*(y/sqrt(2)-x/sqrt(2))+((-sqrt(2))-2)*x)*cos(y/sqrt(2)-x/sqrt(2)))/2+sqrt(2)*x*cos(y/sqrt(2)-x/sqrt(2))
```



---

Comment by chapoton created at 2021-06-07 11:52:47

This should be reported upstream to maxima. Karl-Dieter, would you please do that ?

For info, the correct answer as given by sympy is

```
sqrt(2)*(x - y)*cos(-1/2*sqrt(2)*(x - y)) + 2*sin(-1/2*sqrt(2)*(x - y))
```



---

Comment by kcrisman created at 2021-06-07 14:25:01

https://sourceforge.net/p/maxima/bugs/3795/
