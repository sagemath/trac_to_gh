# Issue 15012: In lazy power series rings, 0 + a and 0 - a return 0

Issue created by migration from Trac.

Original creator: darij

Original creation time: 2013-10-01 23:41:35

CC:  mhansen mantepse tscrim

Keywords: lazy-power-series, species


```
sage: L = LazyPowerSeriesRing(QQ)
sage: x = L.gen()
sage: L.zero().coefficients(4)
[0, 0, 0, 0]
sage: x.coefficients(4)
[0, 1, 0, 0]
```

Correct so far...

```
sage: (L.zero() + x).coefficients(4)
[0, 0, 0, 0]
sage: (L.zero() - x).coefficients(4)
[0, 0, 0, 0]
```


But `x - L.zero()` and `x + L.zero()` return correct results.

See also #15248 for another lazy power series bug.


---

Comment by mantepse created at 2014-01-09 23:50:39

One problem is in series_order.py.  There, a very simple lattice (in fact, a total order) should be implemented: NonNegativeIntegers together with the two special values unknown and infinity.  unknown is the minimal element, infinity the maximal element.

Comparing unknown with another element works, comparing infinity with another element works, but comparing an integer with unknown does not work, because the comparison invoked is from Integer.

How should I create such a lattice really?


---

Comment by mhansen created at 2014-01-10 20:30:49

I've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.


---

Comment by mantepse created at 2014-01-10 20:35:05

Changing keywords from "lazy-power-series, species" to "LazyPowerSeries, species".


---

Comment by mantepse created at 2014-01-10 21:46:54

Replying to [comment:3 mhansen]:
> I've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.

Great! I'm all set to dig into the species code too.  For a start, I looked through the tickets that are related to the lazy power series code and changed the keyword to LazyPowerSeries...

Did you see #10931?  I guess the patch won't apply anymore, but the philosophy should :-)

Best, Martin


---

Comment by mhansen created at 2014-01-14 17:17:59

A fix is in #15673


---

Comment by mantepse created at 2022-09-21 13:44:18

Changing status from new to needs_review.


---

Comment by mantepse created at 2022-09-21 13:44:18

This is fixed in #32367 and it should be tested by the testsuite.


---

Comment by @darijgr created at 2022-09-21 13:47:08

Thanks a lot, Tejasvi, Travis and Martin!


---

Comment by mantepse created at 2022-09-21 14:03:07

Hi Darij!  I am glad you like it!  After #34552, you will like it even more :-)


---

Comment by tscrim created at 2022-09-22 00:58:40

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2022-10-17 09:33:06

Resolution: duplicate
