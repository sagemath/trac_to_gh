# Issue 11501: is_unit not properly implements for algebraic integers

Issue created by migration from https://trac.sagemath.org/ticket/11673

Original creator: bober

Original creation time: 2011-08-09 22:58:45

Assignee: davidloeffler

Here is an example:

```
sage: K.<a> = NumberField(x^2 - x - 1)
sage: OK = K.ring_of_integers()
sage: OK(13).is_unit() # should be false!
True
sage: OK(1/13)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/bober/<ipython console> in <module>()

/home/bober/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7102)()

/home/bober/sage/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3254)()

/home/bober/sage/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3157)()

/home/bober/sage/local/lib/python2.6/site-packages/sage/rings/number_field/order.pyc in _element_constructor_(self, x)
   1049         V, _, embedding = self._K.vector_space()
   1050         if not embedding(x) in self._module_rep:
-> 1051             raise TypeError, "Not an element of the order."
   1052         return self._element_type(self, x)
   1053         

TypeError: Not an element of the order.
```


This does not seem to be limited to quadratic fields.


---

Comment by davidloeffler created at 2011-10-10 08:48:21

This is because order elements are a subclass of number field elements and hence inherit various generic methods from `sage.structure.element.FieldElement` that give total nonsense. E.g.

```
sage: K.<a> = NumberField(x^2 - x - 1)
sage: OK = K.ring_of_integers()
sage: OK(12).divides(OK(13))
True
sage: gcd(OK(12),OK(13))
1
sage: OK(12) // OK(13)
12/13
```


It's not clear to me what the right solution is here, given that we need `OrderElement` to inherit a great deal of its functionality from `NumberFieldElement`.


---

Attachment


---

Comment by johanbosman created at 2011-12-18 23:12:35

Changing status from new to needs_review.


---

Comment by johanbosman created at 2011-12-19 10:09:35

Changing status from needs_review to needs_work.


---

Comment by johanbosman created at 2011-12-19 10:09:35

Perhaps there's a slightly better solution.


---

Comment by johanbosman created at 2011-12-19 10:53:50

Changing status from needs_work to needs_review.


---

Attachment


---

Comment by davidloeffler created at 2011-12-31 15:05:10

This fixes the original issue. Patch applies fine to 4.8.alpha5 (without needing #12185) and all doctests pass. The problems I mentioned in my comment 2 above still need fixing, so I've opened a new ticket #12242 for these.


---

Comment by davidloeffler created at 2011-12-31 15:05:10

Changing status from needs_review to positive_review.


---

Comment by davidloeffler created at 2012-01-05 11:37:49

Changing keywords from "" to "sd35".


---

Comment by jdemeyer created at 2012-01-21 23:37:50

Resolution: fixed
