# Issue 33962: latex_name of a symbol does not unpickle

Issue created by migration from https://trac.sagemath.org/ticket/34199

Original creator: @DaveWitteMorris

Original creation time: 2022-07-19 04:02:16

Keywords: symbolics, pickling, latex_name

As pointed out in [this sage-devel thread](https://groups.google.com/g/sage-devel/c/LX1wJVSaFYQ/m/L8Goa0loAgAJ), if you pickle a symbol that has a custom latex name, this latex name will not be reinstated when the symbol is unpickled in a different sagemath session:

```
sage: logr = SR.symbol('logr', domain='complex', latex_name=r'L_{x/x_0}')
....: latex(logr)
L_{x/x_0}

sage: import pickle
....: path_name = '/home/mark/'
....: pickle_file_name = path_name + 'node.p'
....: pickle_write = open(pickle_file_name, 'wb')
....: pickle.dump(logr, pickle_write)
....: pickle_write.close()

[exit and restart Sage]

sage: import pickle
....: path_name = '/home/mark/'
....: pickle_file_name = path_name + 'node.p'
....: pickle_read = open(pickle_file_name, 'rb')
....: some_expr = pickle.load(pickle_read)
....: pickle_read.close()
....: latex(some_expr)
\mathit{logr}
```



---

Comment by @DaveWitteMorris created at 2022-07-19 04:08:45

Pynac does most of the unpickling. The bug has two ingredients. One is that if a symbol is unpickled, and there is already a symbol with that name, then pynac will simply return the existing symbol, instead of the new symbol that it created with the data from the pickle. The other is that, at the start of the unpickling process, sagemath always creates a new symbol with the specified name, before calling pynac into play. So pynac will always return a symbol that was created by sagemath, and throw away the symbol that it created from the pickle.

I pushed a branch that seems to fix this bug, but I am not convinced that it is the right approach.
----
New commits:


---

Comment by @DaveWitteMorris created at 2022-07-19 04:08:45

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2022-07-19 04:09:28

Changing status from needs_review to needs_work.
