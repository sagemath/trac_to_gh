# Issue 11044: Metaticket - make Sage work with gcc 4.6.0

archive/issues_011044.json:
```json
{
    "body": "Assignee: GeorgSWeber\n\nCC:  gostrc @nexttime\n\nKeywords: gcc\n\nSage will not build with gcc 4.6.0 due to a number of issues. These need to be resolved asap, as Fedora 15 will ship with gcc 4.6.0. \n\nAt least some of the problems that prevent Sage building with gcc 4.6.0 are:\n\n* #10892 (lcalc)\n* #11083 (PolyBoRi)\n* #11084 (Singular)\n* #11168 and #11437 (Rubiks)\n* #11226 (sympow)\n* #11227 (Cliquer)\n\nThere may be others on specific platforms. \n\nWhen all these issues are resolved, the \"Install from Source Code\" section of the Sage Installation Guide needs to be updated to remove the notes about Sage not building with gcc 4.6.0. Also the Wiki at http://wiki.sagemath.org/SupportedPlatforms needs to be updated, as that now mentions that Sage will not build with gcc 4.6.0.\n\nThe lcalc, Singular and PolyBoRi issues have all been reported upstream.\n\n**Apply**: [attachment:trac_11216-doc_installation_source.patch]\n\nIssue created by migration from https://trac.sagemath.org/ticket/11216\n\n",
    "closed_at": "2011-06-15T15:23:40Z",
    "created_at": "2011-04-19T02:56:18Z",
    "labels": [
        "component: build",
        "blocker"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Metaticket - make Sage work with gcc 4.6.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11044",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
Assignee: GeorgSWeber

CC:  gostrc @nexttime

Keywords: gcc

Sage will not build with gcc 4.6.0 due to a number of issues. These need to be resolved asap, as Fedora 15 will ship with gcc 4.6.0. 

At least some of the problems that prevent Sage building with gcc 4.6.0 are:

* #10892 (lcalc)
* #11083 (PolyBoRi)
* #11084 (Singular)
* #11168 and #11437 (Rubiks)
* #11226 (sympow)
* #11227 (Cliquer)

There may be others on specific platforms. 

When all these issues are resolved, the "Install from Source Code" section of the Sage Installation Guide needs to be updated to remove the notes about Sage not building with gcc 4.6.0. Also the Wiki at http://wiki.sagemath.org/SupportedPlatforms needs to be updated, as that now mentions that Sage will not build with gcc 4.6.0.

The lcalc, Singular and PolyBoRi issues have all been reported upstream.

**Apply**: [attachment:trac_11216-doc_installation_source.patch]

Issue created by migration from https://trac.sagemath.org/ticket/11216





---

archive/issue_comments_120166.json:
```json
{
    "body": "Changing type from enhancement to task.",
    "created_at": "2011-04-20T15:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120166",
    "user": "https://github.com/jdemeyer"
}
```

Changing type from enhancement to task.



---

archive/issue_comments_120167.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2011-04-25T09:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120167",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_120168.json:
```json
{
    "body": "Changing keywords from \"\" to \"gcc\".",
    "created_at": "2011-04-25T09:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120168",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "gcc".



---

archive/issue_comments_120169.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-03T17:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120169",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120170.json:
```json
{
    "body": "sage-4.7 was successfully built with gcc-4.6.0 on all the Linux machines on skynet.  I believe this ticket should be closed.",
    "created_at": "2011-06-03T17:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120170",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

sage-4.7 was successfully built with gcc-4.6.0 on all the Linux machines on skynet.  I believe this ticket should be closed.



---

archive/issue_comments_120171.json:
```json
{
    "body": "Replying to [comment:4 mariah]:\n> sage-4.7 was successfully built with gcc-4.6.0 on all the Linux machines on skynet.  I believe this ticket should be closed.\n\n\nI agree with you.  However, we have to undo some changes from #11159.  I propose to do that on this ticket.",
    "created_at": "2011-06-07T07:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120171",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:4 mariah]:
> sage-4.7 was successfully built with gcc-4.6.0 on all the Linux machines on skynet.  I believe this ticket should be closed.


I agree with you.  However, we have to undo some changes from #11159.  I propose to do that on this ticket.



---

archive/issue_comments_120172.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-06-07T07:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120172",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120173.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-06-08T18:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120173",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120174.json:
```json
{
    "body": "Attachment [trac_11216-doc_installation_source.patch](tarball://root/attachments/some-uuid/ticket11216/trac_11216-doc_installation_source.patch) by mariah created at 2011-06-08 18:10:38\n\nI have updated the Wiki at  http://wiki.sagemath.org/SupportedPlatforms.  I believe the patch reverts the changes of #11159 that mention gcc-4.6.0.",
    "created_at": "2011-06-08T18:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120174",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Attachment [trac_11216-doc_installation_source.patch](tarball://root/attachments/some-uuid/ticket11216/trac_11216-doc_installation_source.patch) by mariah created at 2011-06-08 18:10:38

I have updated the Wiki at  http://wiki.sagemath.org/SupportedPlatforms.  I believe the patch reverts the changes of #11159 that mention gcc-4.6.0.



---

archive/issue_events_029052.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-15T15:23:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11044#event-29052"
}
```



---

archive/issue_comments_120175.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-06-15T15:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120175",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_120176.json:
```json
{
    "body": "Looks good!",
    "created_at": "2011-06-15T15:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120176",
    "user": "https://github.com/jdemeyer"
}
```

Looks good!



---

archive/issue_comments_120177.json:
```json
{
    "body": "sage-4.7.1-alpha4 still fails to build on archlinux with gcc-4.6.0\n\n```\nrunning build_ext\nbuilding 'Crypto.PublicKey._fastmath' extension\ncreating build/temp.linux-i686-2.6\ncreating build/temp.linux-i686-2.6/src\ngcc -Wall -Wstrict-prototypes -I/opt/sage-build/sage-4.7.1.alpha4/local/include -L/opt/sage-build/sage-4.7.1.alpha4/local/lib -march=native -mtune=native -pipe -fomit-frame-pointer -fPIC -O3 -fomit-frame-pointer -Isrc/ -I/opt/sage-build/sage-4.7.1.alpha4/local/include/python2.6 -c src/_fastmath.c -o build/temp.linux-i686-2.6/src/_fastmath.o\n/usr/lib/gcc/i686-pc-linux-gnu/4.6.0/cc1: symbol lookup error: /usr/lib/libppl_c.so.4: undefined symbol: _ZN23Parma_Polyhedra_Library13have_sse_unitE\nerror: command 'gcc' failed with exit status 1\nError installing PyCrypto... exiting\n\nreal\t0m0.198s\nuser\t0m0.117s\nsys\t0m0.060s\nsage: An error occurred while installing pycrypto-2.1.0\nPlease email sage-devel http://groups.google.com/group/sage-devel\nexplaining the problem and send the relevant part of\nof /opt/sage-build/sage-4.7.1.alpha4/install.log.  Describe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/opt/sage-build/sage-4.7.1.alpha4/spkg/build/pycrypto-2.1.0 and type 'make check' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n(cd '/opt/sage-build/sage-4.7.1.alpha4/spkg/build/pycrypto-2.1.0' && '/opt/sage-build/sage-4.7.1.alpha4/sage' -sh)\nWhen you are done debugging, you can type \"exit\" to leave the\nsubshell.\nmake[1]: *** [installed/pycrypto-2.1.0] Error 1\nmake[1]: Leaving directory `/opt/sage-build/sage-4.7.1.alpha4/spkg'\n\nreal\t119m10.612s\nuser\t101m4.015s\nsys\t8m34.880s\nError building Sage.\n```\n\nI had the same issue when building sage-4.7.0 with gcc-4.6.0.\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/1fbbc05ae9837c96/80cd305a6e908bf9?lnk=raot&pli=1\nhttps://groups.google.com/forum/#!topic/sage-devel/hLL02U1Q5zU",
    "created_at": "2011-06-15T15:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120177",
    "user": "https://trac.sagemath.org/admin/accounts/users/ryan"
}
```

sage-4.7.1-alpha4 still fails to build on archlinux with gcc-4.6.0

```
running build_ext
building 'Crypto.PublicKey._fastmath' extension
creating build/temp.linux-i686-2.6
creating build/temp.linux-i686-2.6/src
gcc -Wall -Wstrict-prototypes -I/opt/sage-build/sage-4.7.1.alpha4/local/include -L/opt/sage-build/sage-4.7.1.alpha4/local/lib -march=native -mtune=native -pipe -fomit-frame-pointer -fPIC -O3 -fomit-frame-pointer -Isrc/ -I/opt/sage-build/sage-4.7.1.alpha4/local/include/python2.6 -c src/_fastmath.c -o build/temp.linux-i686-2.6/src/_fastmath.o
/usr/lib/gcc/i686-pc-linux-gnu/4.6.0/cc1: symbol lookup error: /usr/lib/libppl_c.so.4: undefined symbol: _ZN23Parma_Polyhedra_Library13have_sse_unitE
error: command 'gcc' failed with exit status 1
Error installing PyCrypto... exiting

real	0m0.198s
user	0m0.117s
sys	0m0.060s
sage: An error occurred while installing pycrypto-2.1.0
Please email sage-devel http://groups.google.com/group/sage-devel
explaining the problem and send the relevant part of
of /opt/sage-build/sage-4.7.1.alpha4/install.log.  Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/opt/sage-build/sage-4.7.1.alpha4/spkg/build/pycrypto-2.1.0 and type 'make check' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
(cd '/opt/sage-build/sage-4.7.1.alpha4/spkg/build/pycrypto-2.1.0' && '/opt/sage-build/sage-4.7.1.alpha4/sage' -sh)
When you are done debugging, you can type "exit" to leave the
subshell.
make[1]: *** [installed/pycrypto-2.1.0] Error 1
make[1]: Leaving directory `/opt/sage-build/sage-4.7.1.alpha4/spkg'

real	119m10.612s
user	101m4.015s
sys	8m34.880s
Error building Sage.
```

I had the same issue when building sage-4.7.0 with gcc-4.6.0.
http://groups.google.com/group/sage-devel/browse_thread/thread/1fbbc05ae9837c96/80cd305a6e908bf9?lnk=raot&pli=1
https://groups.google.com/forum/#!topic/sage-devel/hLL02U1Q5zU



---

archive/issue_comments_120178.json:
```json
{
    "body": "The workaround that I used for sage-4.7.0 was to replace `$SAGE_ROOT/local/lib/libppl.so.9.0.0` with `/usr/lib/libppl.so.9.0.0`",
    "created_at": "2011-06-15T16:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120178",
    "user": "https://trac.sagemath.org/admin/accounts/users/ryan"
}
```

The workaround that I used for sage-4.7.0 was to replace `$SAGE_ROOT/local/lib/libppl.so.9.0.0` with `/usr/lib/libppl.so.9.0.0`



---

archive/issue_comments_120179.json:
```json
{
    "body": "#11391",
    "created_at": "2011-06-15T16:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120179",
    "user": "https://trac.sagemath.org/admin/accounts/users/ryan"
}
```

#11391



---

archive/issue_comments_120180.json:
```json
{
    "body": "Apparently it is only the 32-bit version of sage that fails to build with gcc-4.6 as noted in the ticket referenced above (#11391).",
    "created_at": "2011-06-15T16:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11044#issuecomment-120180",
    "user": "https://trac.sagemath.org/admin/accounts/users/ryan"
}
```

Apparently it is only the 32-bit version of sage that fails to build with gcc-4.6 as noted in the ticket referenced above (#11391).
