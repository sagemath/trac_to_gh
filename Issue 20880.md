# Issue 20880: specialzation for polynomials, schemes, and morphisms

Issue created by migration from https://trac.sagemath.org/ticket/21117

Original creator: bhutz

Original creation time: 2016-07-28 15:09:09

Given a family of polynomials, schemes, or morphisms implement the ability to specialize to a member of the family by substituting a value for one of the parameters


---

Comment by bhutz created at 2016-07-28 20:27:16

New commits:


---

Comment by bhutz created at 2016-07-28 20:27:16

Changing status from new to needs_review.


---

Comment by paulfili created at 2016-07-29 19:50:59

All tests passed. Various examples all work. Looks good.


---

Comment by paulfili created at 2016-07-29 19:50:59

Changing status from needs_review to positive_review.


---

Comment by paulfili created at 2016-07-29 19:59:45

Changing status from positive_review to needs_review.


---

Comment by paulfili created at 2016-07-29 19:59:45

Right now, if the variable comes from a FunctionField instead of PolynomialRing, the specialization will do nothing and return the morphism as is. We may want to issue a warning if the user tries to substitute for a variable from a FunctionField that this is not implemented.


---

Comment by paulfili created at 2016-07-29 20:00:19

Otherwise, so far the functions work on the examples I have tested so far, including on nested PolynomialRings.


---

Comment by vdelecroix created at 2016-07-30 01:49:47

(don't forget the `#` sign in the dependencies)


---

Comment by git created at 2016-08-15 11:24:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by eholmes created at 2016-08-16 03:04:25

Specialization of Dynatomic Polynomials doesn't work:

```
sage: R.<c>=PolynomialRing(QQ)
sage: PS.<x,y> = ProjectiveSpace(1,R); PS
Projective Space of dimension 1 over Univariate Polynomial Ring in c over Rational Field
sage: E = End(PS); E
 
Set of morphisms
  From: Projective Space of dimension 1 over Univariate Polynomial Ring in c over Rational Field
  To:   Projective Space of dimension 1 over Univariate Polynomial Ring in c over Rational Field
sage: Phi5 = f.dynatomic_polynomial(5)
sage: Phi5.specialization({c:0})
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-46-42dcbd8d3b57> in <module>()
----> 1 Phi5.specialization({c:Integer(0)})
 
/projects/d87ce228-3433-4d2c-b150-f16518d5e59a/sage-dev/src/sage/structure/element.pyx in sage.structure.element.Element.__getattr__ (/projects/sage/sage-dev/src/build
/cythonized/sage/structure/element.c:4237)()
    319             dummy_error_message.name = name
    320             raise dummy_attribute_error
--> 321         return getattr_from_other_class(self, P._abstract_element_class, name)
    322
    323     def __dir__(self):
 
/projects/d87ce228-3433-4d2c-b150-f16518d5e59a/sage-dev/src/sage/structure/misc.pyx in sage.structure.misc.getattr_from_other_class (/projects/sage/sage-dev/src/build/
cythonized/sage/structure/misc.c:1879)()
    257         dummy_error_message.cls = type(self)
    258         dummy_error_message.name = name
--> 259         raise dummy_attribute_error
    260     if isinstance(attribute, methodwrapper):
    261         dummy_error_message.cls = type(self)
 
AttributeError: 'MPolynomial_polydict' object has no attribute 'specialization'
```



---

Comment by eholmes created at 2016-08-16 03:04:25

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2016-08-16 14:37:45

Yes, I didn't implement the specialization function for polynomial ring elements. I see no reason not to, so I'll go ahead and add that. I hope to get to it later today.


---

Comment by git created at 2016-08-16 18:37:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-08-16 18:37:32

added functionality for polynomial elements


---

Comment by bhutz created at 2016-08-16 18:37:32

Changing status from needs_work to needs_review.


---

Comment by eholmes created at 2016-08-19 22:56:03

Changing status from needs_review to needs_work.


---

Comment by eholmes created at 2016-08-19 22:56:03

specialization seems to be giving strange errors. 
- when you also specialize x or y below it's fine, but if not we have the following:


```
S.<a,b> = PolynomialRing(QQ)
P.<x,y,z> = PolynomialRing(S)
R.<c,d> = PolynomialRing(P)
f = a*x^2+b*y^3+c*y^2-b*a*d+d^2-a*c*b*z^2
f.specialization(dict({a:2, z:4, d:2}))

Traceback (click to the left of this block for traceback)
...
TypeError: unable to convert x to an element of Univariate Polynomial
Ring in c over Multivariate Polynomial Ring in x, y over Univariate
Polynomial Ring in b over Rational Field


```



---

Comment by git created at 2016-08-20 00:58:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-08-20 01:00:00

Yes, it seems I need to be more careful in the creation of the specialization morphism. I've kept better track of where the variable live now and it corrects your example. Are there any other examples that the new version does not address?


---

Comment by bhutz created at 2016-08-20 01:00:00

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-08-20 01:08:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-08-20 01:10:18

noticed that in my testing I had changed your original example, so I put it back to what you had that failed.


---

Comment by git created at 2016-09-13 21:32:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-09-13 21:36:36

Fixed the merge issue.

What is the status of testing? Did the new fix cover any other failed examples you had?


---

Comment by git created at 2016-12-01 01:18:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-12-01 01:19:24

fixed merge conflict


---

Comment by git created at 2016-12-05 20:51:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2016-12-05 20:52:40

Noticed that the following example failed due to the adding of flatten to quo_rem:


```
R.<z>=PolynomialRing(QQbar,1)
(z^4 + (-3)*z^2)/z^3
```


So I've made the domains match up for multi- versus uni-variate polynomial rings.


---

Comment by git created at 2016-12-19 17:29:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rlmiller created at 2017-01-25 20:47:05

**Errors:**

```
R.<l> = PolynomialRing(QQ,1)
S.<k,j> = PolynomialRing(R)
K.<a> = PolynomialRing(S,1)
J.<x,y> = PolynomialRing(K)
F = x^2 + y^2
G=F.specialization({y:56,j:5})
print G
G.parent()
}}} 
Doesn't distinguish between Multivariate and Univariate, also has this problem in Subschemes.

{{{
R.<l> = PolynomialRing(QQ)
S.<k,j> = PolynomialRing(R)
K.<a,b,c,d> = S[]
P.<x,y> = ProjectiveSpace(K, 1)
H = End(P)
Q=P([a^2,b^2])
Q.specialization({a:2})
}}}
Doesn't like having four variables.

**Questions:**
Should the two examples below work?

{{{
S.<p,q> = QQ[]
A.<r> = AffineSpace(S,1)
F = (r^2 + p*r^2)/(q+p)
G=F.specialization({p:42})
}}}
{{{
A.<i,j,k> = QuaternionAlgebra(QQ, -1,-1)
R.<w,v> = PolynomialRing(A)
F = w^3 + (i+j)*w + 1
G=F.specialization({w:7})
}}}


---

Comment by rlmiller created at 2017-01-25 20:47:30

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-01-26 21:58:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2017-01-26 22:02:11

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2017-01-26 22:02:11

I fixed the two examples that didn't work.

For the other two questionable examples: it would be nice if fraction field elements of polynomial rings could also be specialized, but I think that should be its own ticket. The Quaternion algebra one is not failing in this code, so no on that one.


---

Comment by rlmiller created at 2017-01-27 02:27:08

Looks good to me.


---

Comment by rlmiller created at 2017-01-27 02:27:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-29 12:04:32

Resolution: fixed
