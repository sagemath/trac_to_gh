# Issue 13193: Add semidirect product method for permutation groups

Issue created by migration from https://trac.sagemath.org/ticket/13365

Original creator: khalasz

Original creation time: 2012-08-14 05:53:56

Assignee: joyner

CC:  rbeezer

Adds a semidirect product method.
A generic, top-level method is added to categories/groups.py, which simply raises a `NotImplementedError`. This  is then overridden in permgroup.py. This method wraps GAP's `SemidirectProduct` function. It is implemented so that the calling group is the group acting on an inputted normal subgroup.


---

Comment by khalasz created at 2012-08-14 05:56:58

Changing status from new to needs_review.


---

Attachment


---

Comment by benjaminfjones created at 2012-08-18 23:34:29

Look great! A couple of comments to start:

 * Line 92 `sage/categories/groups.py`: I think the exception message would be more clear if we just say something like "semidirect prodcuct of %s and %s is not yet implemented."

 * Line 1762 `sage/groups/perm_gps/permgroup.py`: I think it would be clearer here to say that `N` is a group which acted on by `self` and which is isomorphic to a normal subgroup of the semidirect product.
 * Line 1803: "where it is generally thought that" --> "where, by convention,"
 * Line 1870: The three tests at the beginning of the method are a good measure, but I wonder if they pose too large a computational cost when the input groups are large? Have you tried constructing any large semidirect products with your code? I would be interested to see how much overhead the three checks cost.

One thing you could do is add an optional parameter, something like `check=True` that defaults to True, but if the user sets it to False then the three checks aren't done and the user takes full responsibility if, e.g. the supplied list of elements of `self` does not generate `self`.


---

Comment by benjaminfjones created at 2012-08-18 23:34:29

Changing keywords from "" to "groups semidirect product GAP".


---

Comment by khalasz created at 2012-08-20 18:02:26

I ran some time tests on the checks. I'll leave it up to you to determine if they are to costly (I don't think they are, but then again, I'm no more than a novice when it comes to sage, or even CS in general).

First, I should note that my computer is kind of slow. For calibrating purposes, see that the following process gave 31.9 ms per loop on RAB's computer:



```
sage: G = DihedralGroup(2000)
sage: gens = G.gens()
sage: timeit("G == PermutationGroup(gens = gens)")
5 loops, best of 3: 127 ms per loop
```



Now, for the semidihedral group tests:

I didn't build actually build a semidirect product with this group, but the following does exactly what the first test does on the calling group:



```
sage: G = SymmetricGroup(15)
<(1,2,6,7,5),(11,1,12,2,13,3,14,4,15,5),(6,7,8,9,10,11,1)]  #this is the end of an initialization of an 8 element list of random permutations that generates Sym(15)
sage: len(gens)
8
sage: timeit("PermutationGroup(gens) == G")         
25 loops, best of 3: 18.2 ms per loop
sage: G.order()
1307674368000
sage: PermutationGroup(gens) == G
True
```


The second test simply compares the length of lists using basic sage commands, which I think is clearly not very costly (though please do tell me if you disagree).

Finally, I have again not built a full product, but rather an isomorphism that would be inputted into the second list of the ``mapping`` input. Obvioulsy, this list could contain more than one isomorphism, but to account for this we can just multiply this time by some small integer factor.


```

sage: direct_product_permgroups([c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5,c5])  
sage: a
Permutation Group with generators [(101,102,103,104,105), (96,97,98,99,100), (91,92,93,94,95), (86,87,88,89,90), (81,82,83,84,85), (76,77,78,79,80), (71,72,73,74,75), (66,67,68,69,70), (61,62,63,64,65), (56,57,58,59,60), (51,52,53,54,55), (46,47,48,49,50), (41,42,43,44,45), (36,37,38,39,40), (31,32,33,34,35), (26,27,28,29,30), (21,22,23,24,25), (16,17,18,19,20), (11,12,13,14,15), (6,7,8,9,10), (1,2,3,4,5)]
sage: a.order()
476837158203125
sage: f = [g.inverse() for g in a.gens()]
sage: alpha = PermutationGroupMorphism(a,a,f)
sage: timeit("alpha.domain() == alpha.codomain()")
625 loops, best of 3: 16.4 Âµs per loop
```


Let me know what you think.


---

Attachment


---

Comment by khalasz created at 2012-08-20 18:12:24

I've also added a new patch with your other suggestions.


---

Attachment


---

Comment by khalasz created at 2012-08-28 20:59:41

I recently realized that my final test only checked whether or not each homomorphism listed in the second component of `mapping` was an endomorphism, but did not test whether or not this homomorphism was indeed a bijection. I have in its place added two tests, one testing whether or not each function is an endomorphism, another testing whether or not this endomorphism is one-one. Together they test whether each function is indeed an automorphism.

Unfortunately, testing whether or not a function is an injection turns out to be quite costly, so I have added a check to the method. An updated patch has been attached.


---

Comment by benjaminfjones created at 2012-08-31 19:04:24

Changing status from needs_review to needs_work.


---

Comment by benjaminfjones created at 2012-08-31 19:04:24

Sorry for the delay, I've been out of town. 

Good catch about the bijection check. I think the `check` optional parameter is a good idea. The only comment I have after reading over your most recent patch is that you should document what the `check` parameter does in the docstring somewhere, preferably under the description of the two required parameters.

Also, the most recent patch applies cleanly to sage-5.3.rc0 but there are a few failing doctests in `sage/groups/perm_gps/permgroup.py`, one of them is just a difference in the text of a thrown exception, but there are others.


---

Comment by khalasz created at 2012-09-05 07:51:34

I added a discussion of the check parameter under INPUTS. Also added another test, and found the source of the errors you were talking about; I accidentally tested for a kernel of order 0 instead of a kernel of order 1. Do you think I should add some sort of example in which the false check is chosen?

Anyway, I've added a new patch with the most recent changes.


---

Attachment


---

Comment by benjaminfjones created at 2012-09-05 15:41:40

More tests are almost always better, especially if they increase the branch coverage or exercise different execution paths in the code.

----

patchbot, apply [attachment:13365_semidirectproduct-v2.1.patch]


---

Attachment


---

Comment by khalasz created at 2012-09-08 17:25:46

I've added a short test where the check parameter is turned off.
Let me know what you think.


---

Comment by khalasz created at 2012-10-16 17:44:51

Changing status from needs_work to needs_review.


---

Comment by benjaminfjones created at 2012-10-16 20:16:52

Thanks for the ping, I lost track of this ticket. Your updates look good. I made a small reviewer patch to address some trivial things that I didn't think were worth bothering you for. If you are OK with my changes, I'll set to positive review.


---

Attachment

reviewer patch addressing trailing whitespace and minor wording changes.


---

Comment by kcrisman created at 2012-10-17 01:44:19

Ben, your reviewer patch needs a proper commit message.  Also, your fixes look good but you happen to have introduced a very small spelling error.  I'll let you find it :-)


---

Comment by rbeezer created at 2012-10-17 04:06:24

With commit message and spell-check


---

Attachment

Added a commit message to the reviewer patch and fixed a spelling mistake.  Maybe it was the same mistake KDC found, but how would we know?

Kevin - three of us have looked at the reviewer patch now.  But you have the final say.  If it looks OK to you, then you can say so here, and flip the ticket to positive review, or wait for Ben to do it.  (Do not add me as a reviewer or anything, just doing a public service on the reviewer patch).


---

Comment by khalasz created at 2012-10-17 04:56:17

The patch looks good IMHO. I'll leave to Ben to make sure he approves of the changes before setting this to a positive review.

Thanks to all of you for your help.


---

Comment by benjaminfjones created at 2012-10-17 05:24:45

Changing status from needs_review to positive_review.


---

Comment by benjaminfjones created at 2012-10-17 05:24:45

Looks good! Thanks for the reviewer patch review.


---

Comment by jdemeyer created at 2012-11-01 12:02:50

Resolution: fixed
