# Issue 20370: bug in LaurentPolynomial.factor

archive/issues_020370.json:
```json
{
    "body": "CC:  rws vdelecroix stumpc5 etn40ff\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/20607\n\n",
    "created_at": "2016-05-13T22:26:10Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "bug in LaurentPolynomial.factor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20370",
    "user": "mmarco"
}
```
CC:  rws vdelecroix stumpc5 etn40ff



Issue created by migration from https://trac.sagemath.org/ticket/20607





---

archive/issue_comments_280835.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2016-05-13T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280835",
    "user": "mmarco"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_280836.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-13T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280836",
    "user": "mmarco"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_280837.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to commutative algebra.",
    "created_at": "2016-05-13T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280837",
    "user": "mmarco"
}
```

Changing component from PLEASE CHANGE to commutative algebra.



---

archive/issue_comments_280838.json:
```json
{
    "body": "Changing keywords from \"\" to \"laurent polynomials\".",
    "created_at": "2016-05-13T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280838",
    "user": "mmarco"
}
```

Changing keywords from "" to "laurent polynomials".



---

archive/issue_comments_280839.json:
```json
{
    "body": "Related to #20214. Wouldn't be better that the unit of the factorization actually belong to the ring?\n----\nNew commits:",
    "created_at": "2016-05-14T18:10:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280839",
    "user": "vdelecroix"
}
```

Related to #20214. Wouldn't be better that the unit of the factorization actually belong to the ring?
----
New commits:



---

archive/issue_comments_280840.json:
```json
{
    "body": "The unit must belong to the LaurentPolynomialRing, since there are units that don't belong to the base ring.",
    "created_at": "2016-05-14T23:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280840",
    "user": "mmarco"
}
```

The unit must belong to the LaurentPolynomialRing, since there are units that don't belong to the base ring.



---

archive/issue_comments_280841.json:
```json
{
    "body": "I am not sure if `must` is appropriate. What about actually fixing this factorization inconsistency instead of introducing these `if/else`?",
    "created_at": "2016-05-17T02:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280841",
    "user": "vdelecroix"
}
```

I am not sure if `must` is appropriate. What about actually fixing this factorization inconsistency instead of introducing these `if/else`?



---

archive/issue_comments_280842.json:
```json
{
    "body": "In the case of Laurent Polynonials, the variables are units. So we cannot enforce the unit to live in the base ring. Consider, for instance, the element `2*L^2 + 2*L` in the LaurentPolynomialRing of 1 variable over the integers. Its factorization is `L * 2 * (L+1)`, where:\n\n- `L` is the unit. It doesn't live in the base ring (which is `ZZ`)\n- `2` is a factor that happens to live in the base ring, but is not a unit.\n- `L + 1` is a factor that doesn't live in the base ring and is not a unit.\n\nAs you say, all these `if/else` wouldn't be necessary if the factorization of polynomials would return the unit as an element of the polynomial ring (and hence, they would have a .dict() method that would prevent this bug. My proposal for #20214 would automatically make this patch unnecessary, but it seems that my opinion is not shared by many people there.",
    "created_at": "2016-05-17T08:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280842",
    "user": "mmarco"
}
```

In the case of Laurent Polynonials, the variables are units. So we cannot enforce the unit to live in the base ring. Consider, for instance, the element `2*L^2 + 2*L` in the LaurentPolynomialRing of 1 variable over the integers. Its factorization is `L * 2 * (L+1)`, where:

- `L` is the unit. It doesn't live in the base ring (which is `ZZ`)
- `2` is a factor that happens to live in the base ring, but is not a unit.
- `L + 1` is a factor that doesn't live in the base ring and is not a unit.

As you say, all these `if/else` wouldn't be necessary if the factorization of polynomials would return the unit as an element of the polynomial ring (and hence, they would have a .dict() method that would prevent this bug. My proposal for #20214 would automatically make this patch unnecessary, but it seems that my opinion is not shared by many people there.



---

archive/issue_comments_280843.json:
```json
{
    "body": "Hi Miguel,\n\nI made a branch at #20214 that correct automatically the bug you had. Please have a look...\n\nVincent",
    "created_at": "2016-06-26T07:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280843",
    "user": "vdelecroix"
}
```

Hi Miguel,

I made a branch at #20214 that correct automatically the bug you had. Please have a look...

Vincent



---

archive/issue_comments_280844.json:
```json
{
    "body": "Is this subsumed by #20214?",
    "created_at": "2017-05-21T02:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280844",
    "user": "tscrim"
}
```

Is this subsumed by #20214?



---

archive/issue_comments_280845.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-05-21T02:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280845",
    "user": "tscrim"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_280846.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> Is this subsumed by #20214?\n\nyes!",
    "created_at": "2019-01-03T09:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280846",
    "user": "vdelecroix"
}
```

Replying to [comment:8 tscrim]:
> Is this subsumed by #20214?

yes!



---

archive/issue_comments_280847.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-01-03T17:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280847",
    "user": "tscrim"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_280848.json:
```json
{
    "body": "Then I propose closing this.",
    "created_at": "2019-01-03T17:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280848",
    "user": "tscrim"
}
```

Then I propose closing this.



---

archive/issue_comments_280849.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-05T08:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280849",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_280850.json:
```json
{
    "body": "Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280850",
    "user": "embray"
}
```

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_280851.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280851",
    "user": "embray"
}
```

Resolution: invalid



---

archive/issue_comments_280852.json:
```json
{
    "body": "Since #20214 is kept open, I took the liberty to reopen this one as #29173.",
    "created_at": "2020-02-09T14:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-280852",
    "user": "vdelecroix"
}
```

Since #20214 is kept open, I took the liberty to reopen this one as #29173.
