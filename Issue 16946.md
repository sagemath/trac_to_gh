# Issue 16946: Yet another abs_integrate trig integral problem

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2014-10-20 13:25:49

See [this ask.sagemath question](http://ask.sagemath.org/question/24532/).  Original report is 

```
F = sqrt((cos(x) - 1)^2 + sin(x)^2)
F.integrate(x, 0, 2*pi)
```



---

Comment by kcrisman created at 2014-10-20 13:35:35

Upstream https://sourceforge.net/p/maxima/bugs/2823/


---

Comment by kcrisman created at 2014-12-08 15:00:58

See also #12731.


---

Comment by jakobkroeker created at 2015-01-30 19:59:33

I  suppose, this ticket needs a stopgap?


---

Comment by kcrisman created at 2015-01-30 20:10:49

Maybe all the `abs_integrate` ones do - see #12731.  But I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.  So there would have to be some way to limit its applicability.  I think that is why I never worked on stopgaps; the stuff I was working on doesn't lend itself to easily pointing that out, other than having Sage itself start with a disclaimer "warning: computer math sometimes has errors".


---

Comment by jakobkroeker created at 2015-01-30 21:27:24

>Sage itself start with a disclaimer "warning: computer math sometimes has errors"

+1

which in additional links to Mathematically Wrong Answers:
http://trac.sagemath.org/query?status=new&status=needs_work&status=needs_review&status=needs_info&type=defect&stopgaps=!&max=0&order=id

I would support that (to warn the greenhorns), or will that have too much opposition?
``

> but I don't think it's appropriate to just raise a warning EVERY TIME someone integrates.

Agree, so what about showing a stopgap warning only once per user+computer+sageVersion or similar?
( otherwise the user has explicitly request regular stopgap warnings)


---

Comment by kcrisman created at 2015-01-31 02:51:26

These are questions above my pay grade, as I did not institute the stopgap system.  Again, if there is a way to invoke this when `abs_integrate` is used, that would be fine - we already have a way to only selectively load packages, but once loaded, I'm not sure we can "unload" it.  But continue that discussion at #12731.


---

Comment by chapoton created at 2019-05-17 17:52:30

Changing keywords from "" to "abs_integrate".


---

Comment by @mwageringel created at 2019-05-18 15:37:47

Possibly related:

```
sage: integrate(sqrt(1/(2-cos(x))), (x, 0, pi))
0
```

According to Mathematica, the correct result should be `2*elliptic_kc(-2)`.


---

Comment by @mwageringel created at 2020-08-06 08:12:36

See also https://groups.google.com/g/sage-devel/c/h50LZVLVQI4.


---

Comment by chapoton created at 2021-06-06 08:26:15

The issue with the primitive of F may come from our choice of "domain: complex" in maxima.

Using `maxima("domain : real;")` gives another answer, that could be better.

EDIT: this seems to give in fact the same wrong primitive.

fricas and giac also gives other wrong primitives, not even continuous ? Sigh :(


---

Comment by kcrisman created at 2021-11-15 11:25:46

Apparently fixed [upstream](https://sourceforge.net/p/maxima/code/ci/3ca4235b8206b44e6670788696e6614b616f8994/).
