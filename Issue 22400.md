# Issue 22400: Fix treatment of tensor field restrictions on parallelizable manifolds

Issue created by migration from https://trac.sagemath.org/ticket/22637

Original creator: egourgoulhon

Original creation time: 2017-03-18 11:06:08

CC:  tscrim

Keywords: tensor field, parallelizable manifold

The following is a bug:

```
sage: S1 = Manifold(1, 'S^1') # the circle
sage: U = S1.open_subset('U') # the complement of one point
sage: Xt.<t> =  U.chart('t:(0,2*pi)') # the standard angle coordinate
sage: V = S1.open_subset('V') # the complement of the point t=pi
sage: Xu.<u> = V.chart('u:(0,2*pi)') # the angle t-pi
sage: S1.declare_union(U, V)
sage: Xt_to_Xu = Xt.transition_map(Xu, (t-pi,), intersection_name='W',
....:                              restrictions1 = t!=pi, restrictions2 = u!=pi)
sage: Xt_to_Xu.inverse()
sage: W = U.intersection(V)
sage: e = S1.vector_frame('e') # a global vector frame (makes S^1 parallelizable)
sage: R2 = Manifold(2, 'R^2', start_index=1) # Euclidean space R^2
sage: X2.<x,y> = R2.chart() # Cartesian coordinates
sage: F = S1.diff_map(R2, {(Xt,X2): [cos(t), sin(t)],
....:                      (Xu,X2): [-cos(u), -sin(u)]}) # embedding S^1 --> R^2
sage: dx = X2.coframe()[1] # the 1-form dx on R^2
sage: a = F.pullback(dx) ; a
1-form on the 1-dimensional differentiable manifold S^1
sage: a.restrict(U).display()
-sin(t) dt
sage: a.restrict(W).display()
...
ValueError: no basis could be found for computing the components in the Coordinate frame (W, (d/dt))
```

The current ticket fixes this, by trying, if possible, to get the restriction from subdomains (here the restriction to `W` will be obtained from that to `U`, `W` being a subset of `U`)


---

Comment by egourgoulhon created at 2017-03-18 11:08:42

Changing status from new to needs_review.


---

Comment by egourgoulhon created at 2017-03-18 11:08:42

New commits:


---

Comment by tscrim created at 2017-03-18 14:34:15

LGTM.


---

Comment by tscrim created at 2017-03-18 14:34:15

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2017-03-19 10:13:16

Replying to [comment:2 tscrim]:
> LGTM.
Thanks for the review!


---

Comment by vbraun created at 2017-04-03 21:00:10

Resolution: fixed
