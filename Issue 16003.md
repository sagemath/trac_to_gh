# Issue 16003: plain wrong results from partial_fraction_decomposition()

Issue created by migration from https://trac.sagemath.org/ticket/16240

Original creator: rws

Original creation time: 2014-04-26 08:00:21

CC:  robertwb

Keywords: partial fractions, polynomials

Note the sign of the denominator:

```
sage: R.<x> = ZZ['x']
sage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)
sage: p.partial_fraction_decomposition()
(0, [6/(x - 1), 3/(x^2 - 2*x + 1), 2/(x^3 - 3*x^2 + 3*x - 1)])
sage: 6/(x - 1) + 3/(x^2 - 2*x + 1) + 2/(x^3 - 3*x^2 + 3*x - 1)
(6*x^2 - 9*x + 5)/(x^3 - 3*x^2 + 3*x - 1)
```

while in SR:

```
sage: var('x')
x
sage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)
sage: p.partial_fraction()
-6/(x - 1) - 3/(x - 1)^2 - 2/(x - 1)^3
```



---

Comment by rws created at 2014-04-26 08:44:08

Changing priority from critical to major.


---

Comment by rws created at 2014-04-26 13:22:10

Before commit https://github.com/sagemath/sage/commit/807f60d859f5481a31896945555dc7e41d627cb6

```
sage: p=1/(-x + 1)
sage: p.partial_fraction_decomposition()
(0, [-1/(x - 1)])
```

After:

```
sage: p=1/(-x + 1)
sage: p.partial_fraction_decomposition()
(0, [1/(x - 1)])
```



---

Comment by rws created at 2014-04-26 14:44:04

New commits:


---

Comment by rws created at 2014-04-26 14:44:04

Changing status from new to needs_review.


---

Comment by pbruin created at 2014-05-05 14:59:43

OK, I convinced myself that if the algorithm is correct in the case where the unit in the factorisation of the denominator is 1 (in which case this patch does not make a difference), then the algorithm is correct for arbitrary units if and only if the patch is applied.

As Knuth said, "I have only proved it correct, not tried it", so now running doctests.


---

Comment by pbruin created at 2014-05-05 15:14:25

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-05-07 08:31:06

Resolution: fixed
