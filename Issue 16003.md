# Issue 16003: plain wrong results from partial_fraction_decomposition()

archive/issues_016003.json:
```json
{
    "body": "CC:  @robertwb\n\nKeywords: partial fractions, polynomials\n\nNote the sign of the denominator:\n\n```\nsage: R.<x> = ZZ['x']\nsage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)\nsage: p.partial_fraction_decomposition()\n(0, [6/(x - 1), 3/(x^2 - 2*x + 1), 2/(x^3 - 3*x^2 + 3*x - 1)])\nsage: 6/(x - 1) + 3/(x^2 - 2*x + 1) + 2/(x^3 - 3*x^2 + 3*x - 1)\n(6*x^2 - 9*x + 5)/(x^3 - 3*x^2 + 3*x - 1)\n```\n\nwhile in SR:\n\n```\nsage: var('x')\nx\nsage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)\nsage: p.partial_fraction()\n-6/(x - 1) - 3/(x - 1)^2 - 2/(x - 1)^3\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16240\n\n",
    "created_at": "2014-04-26T08:00:21Z",
    "labels": [
        "commutative algebra",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "plain wrong results from partial_fraction_decomposition()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16003",
    "user": "@rwst"
}
```
CC:  @robertwb

Keywords: partial fractions, polynomials

Note the sign of the denominator:

```
sage: R.<x> = ZZ['x']
sage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)
sage: p.partial_fraction_decomposition()
(0, [6/(x - 1), 3/(x^2 - 2*x + 1), 2/(x^3 - 3*x^2 + 3*x - 1)])
sage: 6/(x - 1) + 3/(x^2 - 2*x + 1) + 2/(x^3 - 3*x^2 + 3*x - 1)
(6*x^2 - 9*x + 5)/(x^3 - 3*x^2 + 3*x - 1)
```

while in SR:

```
sage: var('x')
x
sage: p=(6*x^2 - 9*x + 5)/(-x^3 + 3*x^2 - 3*x + 1)
sage: p.partial_fraction()
-6/(x - 1) - 3/(x - 1)^2 - 2/(x - 1)^3
```


Issue created by migration from https://trac.sagemath.org/ticket/16240





---

archive/issue_comments_207798.json:
```json
{
    "body": "Changing priority from critical to major.",
    "created_at": "2014-04-26T08:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207798",
    "user": "@rwst"
}
```

Changing priority from critical to major.



---

archive/issue_comments_207799.json:
```json
{
    "body": "Before commit https://github.com/sagemath/sage/commit/807f60d859f5481a31896945555dc7e41d627cb6\n\n```\nsage: p=1/(-x + 1)\nsage: p.partial_fraction_decomposition()\n(0, [-1/(x - 1)])\n```\n\nAfter:\n\n```\nsage: p=1/(-x + 1)\nsage: p.partial_fraction_decomposition()\n(0, [1/(x - 1)])\n```\n",
    "created_at": "2014-04-26T13:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207799",
    "user": "@rwst"
}
```

Before commit https://github.com/sagemath/sage/commit/807f60d859f5481a31896945555dc7e41d627cb6

```
sage: p=1/(-x + 1)
sage: p.partial_fraction_decomposition()
(0, [-1/(x - 1)])
```

After:

```
sage: p=1/(-x + 1)
sage: p.partial_fraction_decomposition()
(0, [1/(x - 1)])
```




---

archive/issue_comments_207800.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-04-26T14:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207800",
    "user": "@rwst"
}
```

New commits:



---

archive/issue_comments_207801.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-26T14:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207801",
    "user": "@rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207802.json:
```json
{
    "body": "OK, I convinced myself that if the algorithm is correct in the case where the unit in the factorisation of the denominator is 1 (in which case this patch does not make a difference), then the algorithm is correct for arbitrary units if and only if the patch is applied.\n\nAs Knuth said, \"I have only proved it correct, not tried it\", so now running doctests.",
    "created_at": "2014-05-05T14:59:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207802",
    "user": "@pjbruin"
}
```

OK, I convinced myself that if the algorithm is correct in the case where the unit in the factorisation of the denominator is 1 (in which case this patch does not make a difference), then the algorithm is correct for arbitrary units if and only if the patch is applied.

As Knuth said, "I have only proved it correct, not tried it", so now running doctests.



---

archive/issue_comments_207803.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-05T15:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207803",
    "user": "@pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207804.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-07T08:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16003#issuecomment-207804",
    "user": "@vbraun"
}
```

Resolution: fixed
