# Issue 28853: configure forgets to check whether ANY Python is available on the system

archive/issues_028853.json:
```json
{
    "body": "CC:  @dimpase @embray @jhpalmieri @vbraun @saraedum @slel @orlitzky\n\nAs tested at https://github.com/mkoeppe/sage/runs/412019418\n\nOnly when trying to download the first package, `sage-system-python` tries to find one, and that fails.\n\n```\nFound local metadata for patch-2.7.5\n/sage/build/bin/sage-system-python: line 24: exec: : not found\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29090\n\n",
    "created_at": "2020-01-28T01:37:52Z",
    "labels": [
        "component: build: configure",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "configure forgets to check whether ANY Python is available on the system",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28853",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @embray @jhpalmieri @vbraun @saraedum @slel @orlitzky

As tested at https://github.com/mkoeppe/sage/runs/412019418

Only when trying to download the first package, `sage-system-python` tries to find one, and that fails.

```
Found local metadata for patch-2.7.5
/sage/build/bin/sage-system-python: line 24: exec: : not found
```


Issue created by migration from https://trac.sagemath.org/ticket/29090





---

archive/issue_comments_407622.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-03-18T01:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407622",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_407623.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-03-18T01:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407623",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_407624.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-03-19T00:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_407625.json:
```json
{
    "body": "Rebased on 9.1.beta8, needs review",
    "created_at": "2020-03-19T00:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407625",
    "user": "https://github.com/mkoeppe"
}
```

Rebased on 9.1.beta8, needs review



---

archive/issue_comments_407626.json:
```json
{
    "body": "It looks okay to me, but others should look, too. I haven't done very thorough testing.",
    "created_at": "2020-03-19T01:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407626",
    "user": "https://github.com/jhpalmieri"
}
```

It looks okay to me, but others should look, too. I haven't done very thorough testing.



---

archive/issue_comments_407627.json:
```json
{
    "body": "I think this eventually does the right thing, but if you're going to record a suitable system python in `configure.ac`, then why should `sage-system-python` try several different versions each time it's run? Couldn't we just move that check into `configure.ac`, and then have `sage-system-python` launch the version that `./configure` found?",
    "created_at": "2020-03-20T00:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407627",
    "user": "https://github.com/orlitzky"
}
```

I think this eventually does the right thing, but if you're going to record a suitable system python in `configure.ac`, then why should `sage-system-python` try several different versions each time it's run? Couldn't we just move that check into `configure.ac`, and then have `sage-system-python` launch the version that `./configure` found?



---

archive/issue_comments_407628.json:
```json
{
    "body": "The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.",
    "created_at": "2020-03-20T00:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407628",
    "user": "https://github.com/mkoeppe"
}
```

The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.



---

archive/issue_comments_407629.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.\n\nI am expecting this all to make sense and I don't think it's going to.\n\nPlacing \"python\" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what \"python\" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.\n\nI would suggest `$()` in configure.ac over backticks again, but other than it looks OK.",
    "created_at": "2020-03-20T00:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407629",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:12 mkoeppe]:
> The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.

I am expecting this all to make sense and I don't think it's going to.

Placing "python" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what "python" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.

I would suggest `$()` in configure.ac over backticks again, but other than it looks OK.



---

archive/issue_comments_407630.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-20T00:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407630",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_407631.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-03-20T00:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407631",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_407632.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-03-20T00:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_407633.json:
```json
{
    "body": "Replying to [comment:13 mjo]:\n> Replying to [comment:12 mkoeppe]:\n> > The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.\n> \n> I am expecting this all to make sense and I don't think it's going to.\n\nRight :)\n\n> Placing \"python\" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what \"python\" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.\n\nThat's fine. The `sage-system-python` -- if not abused (see #29355) -- is used in a very limited context only. \n\n> I would suggest `$()` in configure.ac over backticks again, but other than it looks OK.\n\nThanks, done.",
    "created_at": "2020-03-20T00:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407633",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:13 mjo]:
> Replying to [comment:12 mkoeppe]:
> > The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.
> 
> I am expecting this all to make sense and I don't think it's going to.

Right :)

> Placing "python" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what "python" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.

That's fine. The `sage-system-python` -- if not abused (see #29355) -- is used in a very limited context only. 

> I would suggest `$()` in configure.ac over backticks again, but other than it looks OK.

Thanks, done.



---

archive/issue_comments_407634.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-20T00:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407634",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_026685.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-25T22:48:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28853#event-26685"
}
```



---

archive/issue_comments_407635.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-25T22:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28853",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28853#issuecomment-407635",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
