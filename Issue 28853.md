# Issue 28853: configure forgets to check whether ANY Python is available on the system

Issue created by migration from https://trac.sagemath.org/ticket/29090

Original creator: mkoeppe

Original creation time: 2020-01-28 01:37:52

CC:  dimpase embray jhpalmieri vbraun saraedum slelievre mjo

As tested at https://github.com/mkoeppe/sage/runs/412019418

Only when trying to download the first package, `sage-system-python` tries to find one, and that fails.

```
Found local metadata for patch-2.7.5
/sage/build/bin/sage-system-python: line 24: exec: : not found
```



---

Comment by mkoeppe created at 2020-03-18 01:42:58

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-03-18 01:42:58

New commits:


---

Comment by git created at 2020-03-19 00:18:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2020-03-19 00:18:45

Rebased on 9.1.beta8, needs review


---

Comment by jhpalmieri created at 2020-03-19 01:48:28

It looks okay to me, but others should look, too. I haven't done very thorough testing.


---

Comment by mjo created at 2020-03-20 00:03:53

I think this eventually does the right thing, but if you're going to record a suitable system python in `configure.ac`, then why should `sage-system-python` try several different versions each time it's run? Couldn't we just move that check into `configure.ac`, and then have `sage-system-python` launch the version that `./configure` found?


---

Comment by mkoeppe created at 2020-03-20 00:05:15

The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.


---

Comment by mjo created at 2020-03-20 00:26:00

Replying to [comment:12 mkoeppe]:
> The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.

I am expecting this all to make sense and I don't think it's going to.

Placing "python" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what "python" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.

I would suggest `$()` in configure.ac over backticks again, but other than it looks OK.


---

Comment by mjo created at 2020-03-20 00:26:00

Changing status from needs_review to positive_review.


---

Comment by git created at 2020-03-20 00:31:02

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-03-20 00:31:02

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by mkoeppe created at 2020-03-20 00:35:48

Replying to [comment:13 mjo]:
> Replying to [comment:12 mkoeppe]:
> > The problem is that it needs to work also for bootstrap, at a time when even the configure script is not there.
> 
> I am expecting this all to make sense and I don't think it's going to.

Right :)

> Placing "python" later in the list might do weird things on Gentoo, where `eselect python` is used to select the system python (what "python" does). If someone has selected python-3.6 but happens to have 3.8 installed, the script will choose 3.8 instead. I don't foresee a real problem here, just mentioning it for posterity.

That's fine. The `sage-system-python` -- if not abused (see #29355) -- is used in a very limited context only. 

> I would suggest `$()` in configure.ac over backticks again, but other than it looks OK.

Thanks, done.


---

Comment by mkoeppe created at 2020-03-20 00:36:09

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-03-25 22:48:46

Resolution: fixed
