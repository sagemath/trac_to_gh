# Issue 30495: combinat : changes about != empty list

Issue created by migration from https://trac.sagemath.org/ticket/30732

Original creator: chapoton

Original creation time: 2020-10-06 18:15:14

also removes some doctests taking too long


---

Comment by chapoton created at 2020-10-06 18:15:38

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-10-06 18:15:38

New commits:


---

Comment by slelievre created at 2020-10-06 21:47:51

Suggestions:


```diff
-        m = lambda i: len([1 for r in self.data if r if r[0] == (i-1)%(n+1)])
+        m = lambda i: sum(r[0] == (i - 1) % (n + 1) for r in self.data if r)
```




```diff
         t = [i for i in t if i]
-        if not t:
-            return ''
-        return Tableau(t)._repr_diagram()
+        return Tableau(t)._repr_diagram() if t else ''
```




```diff
         res = [tableau.Tableau([])]
         for i in range(len(self)):
-            res = [x.promotion_operator(self[-i - 1]) for x in res]
+            res = (x.promotion_operator(self[-i - 1]) for x in res)
             res = sum(res, [])
-            res = [y.catabolism_projector(Partition(self[-i - 1:]).k_split(k))
-                   for y in res]
+            res = (y.catabolism_projector(Partition(self[-i - 1:]).k_split(k))
+                   for y in res)
             res = [i for i in res if i]
         return res
```




```diff
-                res.append( part[:p + 1] )
+                res.append(part[:p + 1])
```




```diff
-                if (max(return_lengths) <= i and self[l - i:l] == self[:i]):
+                if max(return_lengths) <= i and self[-i:] == self[:i]:
```



---

Comment by tscrim created at 2020-10-07 04:29:58

Typo: `# lnot tested, too long`


---

Comment by git created at 2020-10-07 06:29:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-10-07 06:39:27

voilà !


---

Comment by slelievre created at 2020-10-07 07:25:26

This

```diff
-        m = lambda i: len([1 for r in self.data if r and r[0] == (i-1)%(n+1)])
```

could be simplified to one of these:

```diff
+        m = lambda i: sum(1 for r in self.data if r and r[0] == (i - 1) % (n + 1))
+        m = lambda i: sum(r and r[0] == (i - 1) % (n + 1) for r in self.data)
+        m = lambda i: sum(r[0] == (i - 1) % (n + 1) for r in self.data if r)
```


And may I suggest to lighten the slicing here:

```diff
-                if max(return_lengths) <= i and self[l - i:l] == self[:i]:
+                if max(return_lengths) <= i and self[-i:] == self[:i]:
```



---

Comment by chapoton created at 2020-10-07 07:49:23

s'il te plait, Samuel, c'est juste un petit ticket sur un sujet précis, et si on commence à corriger le code tout autour, on va pas en voir le bout..


---

Comment by slelievre created at 2020-10-07 08:42:58

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2020-10-07 08:42:58

D'accord.


---

Comment by chapoton created at 2020-10-07 08:55:16

merci !


---

Comment by vbraun created at 2020-11-01 00:42:54

Resolution: fixed
