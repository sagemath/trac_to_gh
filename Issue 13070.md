# Issue 13070: Determine if an edge in a graph is a cut-edge (bridge)

archive/issues_013070.json:
```json
{
    "body": "Assignee: jason, ncohen, rlm\n\nCC:  jeremy.l.martin @nathanncohen @dcoudert\n\nKeywords: days40\n\nis_cut_edge is needed to compute the Tutte polynomial (#1314)\n\nIssue created by migration from https://trac.sagemath.org/ticket/13242\n\n",
    "created_at": "2012-07-12T19:36:00Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "Determine if an edge in a graph is a cut-edge (bridge)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13070",
    "user": "lkeough"
}
```
Assignee: jason, ncohen, rlm

CC:  jeremy.l.martin @nathanncohen @dcoudert

Keywords: days40

is_cut_edge is needed to compute the Tutte polynomial (#1314)

Issue created by migration from https://trac.sagemath.org/ticket/13242





---

archive/issue_comments_158757.json:
```json
{
    "body": "I looked for cut-edge/bridge/isthmus in Sage and in trac tickets, but didn't find anything.  Let me know if you see anything though!",
    "created_at": "2012-07-12T19:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158757",
    "user": "lkeough"
}
```

I looked for cut-edge/bridge/isthmus in Sage and in trac tickets, but didn't find anything.  Let me know if you see anything though!



---

archive/issue_comments_158758.json:
```json
{
    "body": "Apply only trac_13242.patch",
    "created_at": "2012-07-12T20:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158758",
    "user": "lkeough"
}
```

Apply only trac_13242.patch



---

archive/issue_comments_158759.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-12T20:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158759",
    "user": "lkeough"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_158760.json:
```json
{
    "body": "Since this function is working for undirected graphs only, it should not be in generic_graph.py.\n\nThe following function should be way faster and avoids a copy of the graph.\n\n```\ndef is_edge_cut(self,e):\n    if not self.has_edge(e):\n        raise ValueError, 'edge not in graph' \n\n    eu = e[0]\n    ev = e[1]\n\n    visited = dict([(u,False) for u in self.vertex_iterator()])\n    visited[eu] = True\n    s = set(self.neighbors(eu))\n    s.remove(ev)\n    while (len(s) > 0) and not visited[ev]:\n        w = s.pop()\n        visited[w] = True\n        for x in self.neighbor_iterator(w):\n            if not visited[x]:\n                s.add(x)\n\n    return (not visited[ev]) and (self.degree(ev)>1)\n```\n",
    "created_at": "2012-07-13T10:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158760",
    "user": "@dcoudert"
}
```

Since this function is working for undirected graphs only, it should not be in generic_graph.py.

The following function should be way faster and avoids a copy of the graph.

```
def is_edge_cut(self,e):
    if not self.has_edge(e):
        raise ValueError, 'edge not in graph' 

    eu = e[0]
    ev = e[1]

    visited = dict([(u,False) for u in self.vertex_iterator()])
    visited[eu] = True
    s = set(self.neighbors(eu))
    s.remove(ev)
    while (len(s) > 0) and not visited[ev]:
        w = s.pop()
        visited[w] = True
        for x in self.neighbor_iterator(w):
            if not visited[x]:
                s.add(x)

    return (not visited[ev]) and (self.degree(ev)>1)
```




---

archive/issue_comments_158761.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-07-13T10:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158761",
    "user": "@dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_158762.json:
```json
{
    "body": "Above code should be improved to cope with multiple edges.",
    "created_at": "2012-07-13T10:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158762",
    "user": "@dcoudert"
}
```

Above code should be improved to cope with multiple edges.



---

archive/issue_comments_158763.json:
```json
{
    "body": "Thanks, I will move this to graph.py if that is the correct place?\n\nI tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.",
    "created_at": "2012-07-13T12:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158763",
    "user": "lkeough"
}
```

Thanks, I will move this to graph.py if that is the correct place?

I tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.



---

archive/issue_comments_158764.json:
```json
{
    "body": "Replying to [comment:7 lkeough]:\n> Thanks, I will move this to graph.py if that is the correct place?\n\nWell, you can let it in generic_graph since it has also some interest for connectivity in digraphs. \n\n> I tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.\n\nMy fault (last test in the return). \nThis new version is much better. It allows multiple formats of input, solves the pending edge problem, cope with multi-edges. It remains to add examples and tests.\n\n```\ndef is_edge_cut(self, u, v=None, label=None):\n    \"\"\"\n    Returns True if (u,v) is a cut edge, False otherwise.\n\n    INPUT: The following forms are accepted\n\n    - G.is_edge_cut( 1, 2 )\n\n    - G.is_edge_cut( (1, 2) )\n\n    - G.is_edge_cut( 1, 2, 'label' )\n\n    - G.is_edge_cut( (1, 2, 'label') )\n\n \n    \"\"\"\n    if label is None:\n        if v is None:\n            try:\n                u, v, label = u\n            except:\n                u, v = u\n                label = None\n\n    if not self.has_edge(u,v):\n        raise ValueError, 'edge not in graph' \n\n    # If edge (u,v) is a pending edge, it is also a cut edge\n    if self.degree(u) == 1 or self.degree(v) == 1:\n        return True\n    elif self.allows_multiple_edges():\n        # If we have two or more edges between u and v, it is not a cut edge\n        if len([(uu,vv) for uu,vv,ll in self.edges_incident(u) if uu == v or vv == v]) > 1:\n            return False\n\n    # We search for a path from u to v not using edge (u,v). If no such path is\n    # found, edge (u,v) is a cut edge\n    visited = dict([(uu,False) for uu in self.vertex_iterator()])\n    visited[u] = True\n    s = set(self.neighbors(u))\n    s.remove(v)\n    while (len(s) > 0) and not visited[v]:\n        w = s.pop()\n        visited[w] = True\n        for x in self.neighbor_iterator(w):\n            if not visited[x]:\n                s.add(x)\n\n    return not visited[v]\n```\n\n\nLast, I don't know if the function should be named is_edge_cut or is_cut_edge",
    "created_at": "2012-07-13T12:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158764",
    "user": "@dcoudert"
}
```

Replying to [comment:7 lkeough]:
> Thanks, I will move this to graph.py if that is the correct place?

Well, you can let it in generic_graph since it has also some interest for connectivity in digraphs. 

> I tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.

My fault (last test in the return). 
This new version is much better. It allows multiple formats of input, solves the pending edge problem, cope with multi-edges. It remains to add examples and tests.

```
def is_edge_cut(self, u, v=None, label=None):
    """
    Returns True if (u,v) is a cut edge, False otherwise.

    INPUT: The following forms are accepted

    - G.is_edge_cut( 1, 2 )

    - G.is_edge_cut( (1, 2) )

    - G.is_edge_cut( 1, 2, 'label' )

    - G.is_edge_cut( (1, 2, 'label') )

 
    """
    if label is None:
        if v is None:
            try:
                u, v, label = u
            except:
                u, v = u
                label = None

    if not self.has_edge(u,v):
        raise ValueError, 'edge not in graph' 

    # If edge (u,v) is a pending edge, it is also a cut edge
    if self.degree(u) == 1 or self.degree(v) == 1:
        return True
    elif self.allows_multiple_edges():
        # If we have two or more edges between u and v, it is not a cut edge
        if len([(uu,vv) for uu,vv,ll in self.edges_incident(u) if uu == v or vv == v]) > 1:
            return False

    # We search for a path from u to v not using edge (u,v). If no such path is
    # found, edge (u,v) is a cut edge
    visited = dict([(uu,False) for uu in self.vertex_iterator()])
    visited[u] = True
    s = set(self.neighbors(u))
    s.remove(v)
    while (len(s) > 0) and not visited[v]:
        w = s.pop()
        visited[w] = True
        for x in self.neighbor_iterator(w):
            if not visited[x]:
                s.add(x)

    return not visited[v]
```


Last, I don't know if the function should be named is_edge_cut or is_cut_edge



---

archive/issue_comments_158765.json:
```json
{
    "body": "Replying to [comment:8 dcoudert]:\n> Replying to [comment:7 lkeough]:\n> > Thanks, I will move this to graph.py if that is the correct place?\n> \n> Well, you can let it in generic_graph since it has also some interest for connectivity in digraphs. \nSounds good, I do believe your code works on digraphs as well.\n> \n> > I tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.\n> \n> My fault (last test in the return). \n> This new version is much better. It allows multiple formats of input, solves the pending edge problem, cope with multi-edges. It remains to add examples and tests.\n\nThanks!  I'm new to Sage developing so this might take me a bit, but I'll work on it today.\n\n> {{{\n> def is_edge_cut(self, u, v=None, label=None):\n>     \"\"\"\n>     Returns True if (u,v) is a cut edge, False otherwise.\n> \n>     INPUT: The following forms are accepted\n> \n>     - G.is_edge_cut( 1, 2 )\n> \n>     - G.is_edge_cut( (1, 2) )\n> \n>     - G.is_edge_cut( 1, 2, 'label' )\n> \n>     - G.is_edge_cut( (1, 2, 'label') )\n> \n>  \n>     \"\"\"\n>     if label is None:\n>         if v is None:\n>             try:\n>                 u, v, label = u\n>             except:\n>                 u, v = u\n>                 label = None\n> \n>     if not self.has_edge(u,v):\n>         raise ValueError, 'edge not in graph' \n> \n>     # If edge (u,v) is a pending edge, it is also a cut edge\n>     if self.degree(u) == 1 or self.degree(v) == 1:\n>         return True\n>     elif self.allows_multiple_edges():\n>         # If we have two or more edges between u and v, it is not a cut edge\n>         if len([(uu,vv) for uu,vv,ll in self.edges_incident(u) if uu == v or vv == v]) > 1:\n>             return False\n> \n>     # We search for a path from u to v not using edge (u,v). If no such path is\n>     # found, edge (u,v) is a cut edge\n>     visited = dict([(uu,False) for uu in self.vertex_iterator()])\n>     visited[u] = True\n>     s = set(self.neighbors(u))\n>     s.remove(v)\n>     while (len(s) > 0) and not visited[v]:\n>         w = s.pop()\n>         visited[w] = True\n>         for x in self.neighbor_iterator(w):\n>             if not visited[x]:\n>                 s.add(x)\n> \n>     return not visited[v]\n> }}}\n> \n> Last, I don't know if the function should be named is_edge_cut or is_cut_edge\n\nI've always referred to this as either cut-edge or bridge (and it seems Wikipedia does too, for what that is worth).",
    "created_at": "2012-07-13T13:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158765",
    "user": "lkeough"
}
```

Replying to [comment:8 dcoudert]:
> Replying to [comment:7 lkeough]:
> > Thanks, I will move this to graph.py if that is the correct place?
> 
> Well, you can let it in generic_graph since it has also some interest for connectivity in digraphs. 
Sounds good, I do believe your code works on digraphs as well.
> 
> > I tried this code for K_3 with a leaf (G = Graph([[0,1],[0,2],[1,2],[0,3]]) ) and if I ask if the leaf is a cut-edge it returns False, but it should be True.  I haven't been able to figure out why this isn't working - any ideas?  It seems to work with the slower code.
> 
> My fault (last test in the return). 
> This new version is much better. It allows multiple formats of input, solves the pending edge problem, cope with multi-edges. It remains to add examples and tests.

Thanks!  I'm new to Sage developing so this might take me a bit, but I'll work on it today.

> {{{
> def is_edge_cut(self, u, v=None, label=None):
>     """
>     Returns True if (u,v) is a cut edge, False otherwise.
> 
>     INPUT: The following forms are accepted
> 
>     - G.is_edge_cut( 1, 2 )
> 
>     - G.is_edge_cut( (1, 2) )
> 
>     - G.is_edge_cut( 1, 2, 'label' )
> 
>     - G.is_edge_cut( (1, 2, 'label') )
> 
>  
>     """
>     if label is None:
>         if v is None:
>             try:
>                 u, v, label = u
>             except:
>                 u, v = u
>                 label = None
> 
>     if not self.has_edge(u,v):
>         raise ValueError, 'edge not in graph' 
> 
>     # If edge (u,v) is a pending edge, it is also a cut edge
>     if self.degree(u) == 1 or self.degree(v) == 1:
>         return True
>     elif self.allows_multiple_edges():
>         # If we have two or more edges between u and v, it is not a cut edge
>         if len([(uu,vv) for uu,vv,ll in self.edges_incident(u) if uu == v or vv == v]) > 1:
>             return False
> 
>     # We search for a path from u to v not using edge (u,v). If no such path is
>     # found, edge (u,v) is a cut edge
>     visited = dict([(uu,False) for uu in self.vertex_iterator()])
>     visited[u] = True
>     s = set(self.neighbors(u))
>     s.remove(v)
>     while (len(s) > 0) and not visited[v]:
>         w = s.pop()
>         visited[w] = True
>         for x in self.neighbor_iterator(w):
>             if not visited[x]:
>                 s.add(x)
> 
>     return not visited[v]
> }}}
> 
> Last, I don't know if the function should be named is_edge_cut or is_cut_edge

I've always referred to this as either cut-edge or bridge (and it seems Wikipedia does too, for what that is worth).



---

archive/issue_comments_158766.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-13T14:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158766",
    "user": "lkeough"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_158767.json:
```json
{
    "body": "I believe it should be called is_cut_edge, as \"edge cut\" means a *set* of edges whose deletion disconnects the graph.",
    "created_at": "2012-07-13T14:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158767",
    "user": "jeremy.l.martin"
}
```

I believe it should be called is_cut_edge, as "edge cut" means a *set* of edges whose deletion disconnects the graph.



---

archive/issue_comments_158768.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-07-13T15:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158768",
    "user": "@dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_158769.json:
```json
{
    "body": "Install OK, long tests OK, functionality OK.\n\nHowever I'm unable to test docbuild (working remote today), and I saw a small alignment problem line 4024.\n\nAlso, I'm not sure of the behavior of 'EXAMPLES' versus 'TESTS'. Are examples also considered as tests for 'sage -t'? Is anyone able to answer?",
    "created_at": "2012-07-13T15:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158769",
    "user": "@dcoudert"
}
```

Install OK, long tests OK, functionality OK.

However I'm unable to test docbuild (working remote today), and I saw a small alignment problem line 4024.

Also, I'm not sure of the behavior of 'EXAMPLES' versus 'TESTS'. Are examples also considered as tests for 'sage -t'? Is anyone able to answer?



---

archive/issue_comments_158770.json:
```json
{
    "body": "Replying to [comment:12 dcoudert]:\n> Install OK, long tests OK, functionality OK.\n> \n> However I'm unable to test docbuild (working remote today), and I saw a small alignment problem line 4024.\nI tested docbuild and it looks fine.  Is your issue at 4024 that \"\"\" should be 4 spaces back.  I fixed that and uploaded again.\n> \n> Also, I'm not sure of the behavior of 'EXAMPLES' versus 'TESTS'. Are examples also considered as tests for 'sage -t'? Is anyone able to answer?\nI'm at Sage Days 40 and was told that examples are tested, but are different from tests in that they show up if the user asks for documentation.",
    "created_at": "2012-07-13T16:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158770",
    "user": "lkeough"
}
```

Replying to [comment:12 dcoudert]:
> Install OK, long tests OK, functionality OK.
> 
> However I'm unable to test docbuild (working remote today), and I saw a small alignment problem line 4024.
I tested docbuild and it looks fine.  Is your issue at 4024 that """ should be 4 spaces back.  I fixed that and uploaded again.
> 
> Also, I'm not sure of the behavior of 'EXAMPLES' versus 'TESTS'. Are examples also considered as tests for 'sage -t'? Is anyone able to answer?
I'm at Sage Days 40 and was told that examples are tested, but are different from tests in that they show up if the user asks for documentation.



---

archive/issue_comments_158771.json:
```json
{
    "body": "For me the patch is now OK so I give positive review.\n\nEnjoy the Sage Days.",
    "created_at": "2012-07-13T16:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158771",
    "user": "@dcoudert"
}
```

For me the patch is now OK so I give positive review.

Enjoy the Sage Days.



---

archive/issue_comments_158772.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-07-13T16:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158772",
    "user": "@dcoudert"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_158773.json:
```json
{
    "body": "Hello,\n\nI had some discussions with Nathann, and he said that the following should be faster:\n\n```\n    self.delete_edge(u,v,label)\n    ans = self.distance(u,v) < self.order()\n    self.add_edge(u,v,label)\n    return ans\n```\n\n\nI tried it on large graphs and it is definitively faster (10x to 100x). It is in fact the same algorithm behind, but the distance function is in cython, so it's fast.\n\nSorry for the extra work, but it would be better to replace the lines from **# We search for a path from** till the end with above code.",
    "created_at": "2012-07-14T11:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158773",
    "user": "@dcoudert"
}
```

Hello,

I had some discussions with Nathann, and he said that the following should be faster:

```
    self.delete_edge(u,v,label)
    ans = self.distance(u,v) < self.order()
    self.add_edge(u,v,label)
    return ans
```


I tried it on large graphs and it is definitively faster (10x to 100x). It is in fact the same algorithm behind, but the distance function is in cython, so it's fast.

Sorry for the extra work, but it would be better to replace the lines from **# We search for a path from** till the end with above code.



---

archive/issue_comments_158774.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-07-14T11:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158774",
    "user": "@dcoudert"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_158775.json:
```json
{
    "body": "Faster is certainly better so I don't mind.  When I replace this and run the tests it fails the very first example - if an edge in K_4 is a cut edge.  I messed around in the Sage notebook and it also seems to be a problem there.  The algorithm is correct so I'm probably just implementing this wrong.  All I did was replace the lines  after #We search for a path..",
    "created_at": "2012-07-14T14:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158775",
    "user": "lkeough"
}
```

Faster is certainly better so I don't mind.  When I replace this and run the tests it fails the very first example - if an edge in K_4 is a cut edge.  I messed around in the Sage notebook and it also seems to be a problem there.  The algorithm is correct so I'm probably just implementing this wrong.  All I did was replace the lines  after #We search for a path..



---

archive/issue_comments_158776.json:
```json
{
    "body": "Replying to [comment:16 lkeough]:\n> Faster is certainly better so I don't mind.  When I replace this and run the tests it fails the very first example - if an edge in K_4 is a cut edge.  I messed around in the Sage notebook and it also seems to be a problem there.  The algorithm is correct so I'm probably just implementing this wrong.  All I did was replace the lines  after #We search for a path..\n\nI see now..we want return not ans.  Because if self.distance(u,v) < self.order()  then (u,v) is not a cut-edge.",
    "created_at": "2012-07-14T15:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158776",
    "user": "lkeough"
}
```

Replying to [comment:16 lkeough]:
> Faster is certainly better so I don't mind.  When I replace this and run the tests it fails the very first example - if an edge in K_4 is a cut edge.  I messed around in the Sage notebook and it also seems to be a problem there.  The algorithm is correct so I'm probably just implementing this wrong.  All I did was replace the lines  after #We search for a path..

I see now..we want return not ans.  Because if self.distance(u,v) < self.order()  then (u,v) is not a cut-edge.



---

archive/issue_comments_158777.json:
```json
{
    "body": "This no longer works for digraphs.  It returns that an edge in a directed cycle is a cut edge because if we remove that edge there is no *directed* path between those two vertices.  There is a connected_components_number function for digraphs, but comparing connected_components_number(G) and connected_components_number(G-e) is probably not the fastest way to make it work for digraphs.",
    "created_at": "2012-07-14T15:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158777",
    "user": "lkeough"
}
```

This no longer works for digraphs.  It returns that an edge in a directed cycle is a cut edge because if we remove that edge there is no *directed* path between those two vertices.  There is a connected_components_number function for digraphs, but comparing connected_components_number(G) and connected_components_number(G-e) is probably not the fastest way to make it work for digraphs.



---

archive/issue_comments_158778.json:
```json
{
    "body": "Another option is:\n\n```\n    self.delete_edge(u,v,label)\n    if self.is_directed():\n        ans = self.is_connected()\n    else:\n        ans = self.distance(u,v) < self.order()\n    self.add_edge(u,v,label)\n    return not ans\n```\n\n\nthe self.is_connected() function would be sufficient, but the distance function is faster for undirected graphs.\n\nDon't forget to explain the behavior for directed graphs in the description of the function.",
    "created_at": "2012-07-14T18:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158778",
    "user": "@dcoudert"
}
```

Another option is:

```
    self.delete_edge(u,v,label)
    if self.is_directed():
        ans = self.is_connected()
    else:
        ans = self.distance(u,v) < self.order()
    self.add_edge(u,v,label)
    return not ans
```


the self.is_connected() function would be sufficient, but the distance function is faster for undirected graphs.

Don't forget to explain the behavior for directed graphs in the description of the function.



---

archive/issue_comments_158779.json:
```json
{
    "body": "I need connected_components_number since an edge is a cut-edge if it increases the number of connected components. So you may be trying to figure out if an edge in an already disconnected graph is a cut edge.  I used this:\n\n```  \nif self.is_directed():\n            H = self.copy()\n            H.delete_edge(u,v,label)\n            sol = self.connected_components_number() == H.connected_components_number()\n            return not sol\n```\n\n\nI ran tests and built the documentation and it looks fine.  I'm going to upload a new patch, but I'm willing to change it if this is a terrible algorithm.",
    "created_at": "2012-07-15T00:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158779",
    "user": "lkeough"
}
```

I need connected_components_number since an edge is a cut-edge if it increases the number of connected components. So you may be trying to figure out if an edge in an already disconnected graph is a cut edge.  I used this:

```  
if self.is_directed():
            H = self.copy()
            H.delete_edge(u,v,label)
            sol = self.connected_components_number() == H.connected_components_number()
            return not sol
```


I ran tests and built the documentation and it looks fine.  I'm going to upload a new patch, but I'm willing to change it if this is a terrible algorithm.



---

archive/issue_comments_158780.json:
```json
{
    "body": "Apparently you did something wrong when updating the patch. It contains only parts of the function (last modifications).\n\nYour proposition for directed graphs can be improved because you don't need to copy the graph. It is sufficient to remove edge (u,v), and to later restore it. For instance, you can do:\n\n```\nself.delete_edge(u,v,label)\nif self.is_directed():\n    # (u,v) is a cut edge if u is not in the connected component \n    # containing v of self-(u,v), \n    sol = not u in self.connected_component_containing_vertex(v)\nelse:\n    # (u,v) is a cut edge if there is no path from u to v in self-(u,v) \n    sol = not self.distance(u,v) < self.order()\n\nself.add_edge(u,v,label)\nreturn sol\n```\n\nIn fact, the connected_components_number function uses the connected_component_containing_vertex function. So it is easier that way.",
    "created_at": "2012-07-15T09:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158780",
    "user": "@dcoudert"
}
```

Apparently you did something wrong when updating the patch. It contains only parts of the function (last modifications).

Your proposition for directed graphs can be improved because you don't need to copy the graph. It is sufficient to remove edge (u,v), and to later restore it. For instance, you can do:

```
self.delete_edge(u,v,label)
if self.is_directed():
    # (u,v) is a cut edge if u is not in the connected component 
    # containing v of self-(u,v), 
    sol = not u in self.connected_component_containing_vertex(v)
else:
    # (u,v) is a cut edge if there is no path from u to v in self-(u,v) 
    sol = not self.distance(u,v) < self.order()

self.add_edge(u,v,label)
return sol
```

In fact, the connected_components_number function uses the connected_component_containing_vertex function. So it is easier that way.



---

archive/issue_comments_158781.json:
```json
{
    "body": "Use this one.",
    "created_at": "2012-07-15T16:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158781",
    "user": "lkeough"
}
```

Use this one.



---

archive/issue_comments_158782.json:
```json
{
    "body": "Attachment [trac_13242.patch](tarball://root/attachments/some-uuid/ticket13242/trac_13242.patch) by lkeough created at 2012-07-15 16:41:57\n\nI think I fixed the patch updating problem and used your code for the directed graph.",
    "created_at": "2012-07-15T16:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158782",
    "user": "lkeough"
}
```

Attachment [trac_13242.patch](tarball://root/attachments/some-uuid/ticket13242/trac_13242.patch) by lkeough created at 2012-07-15 16:41:57

I think I fixed the patch updating problem and used your code for the directed graph.



---

archive/issue_comments_158783.json:
```json
{
    "body": "Attachment [trac_13242-rev.patch](tarball://root/attachments/some-uuid/ticket13242/trac_13242-rev.patch) by @dcoudert created at 2012-07-15 18:01:56",
    "created_at": "2012-07-15T18:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158783",
    "user": "@dcoudert"
}
```

Attachment [trac_13242-rev.patch](tarball://root/attachments/some-uuid/ticket13242/trac_13242-rev.patch) by @dcoudert created at 2012-07-15 18:01:56



---

archive/issue_comments_158784.json:
```json
{
    "body": "I did some minor edit (removal of useless spaces, alignments, etc.) in the complementary patch trac_13242-rev.patch (you have to apply both files).\n\nIf it is OK for you, I will give a positive review to this patch. For me everything is fine (install, tests, docbuild, functionality, etc.).",
    "created_at": "2012-07-15T18:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158784",
    "user": "@dcoudert"
}
```

I did some minor edit (removal of useless spaces, alignments, etc.) in the complementary patch trac_13242-rev.patch (you have to apply both files).

If it is OK for you, I will give a positive review to this patch. For me everything is fine (install, tests, docbuild, functionality, etc.).



---

archive/issue_comments_158785.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-15T18:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158785",
    "user": "@dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_158786.json:
```json
{
    "body": "All these things worked for me as well.\n\nThanks for all of your help!",
    "created_at": "2012-07-15T19:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158786",
    "user": "lkeough"
}
```

All these things worked for me as well.

Thanks for all of your help!



---

archive/issue_comments_158787.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-07-16T06:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158787",
    "user": "@dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_158788.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-07-27T20:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158788",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_158789.json:
```json
{
    "body": "[attachment:trac_13242.patch] needs a proper commit message.",
    "created_at": "2012-07-27T20:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158789",
    "user": "@jdemeyer"
}
```

[attachment:trac_13242.patch] needs a proper commit message.



---

archive/issue_comments_158790.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-08-01T12:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158790",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_158791.json:
```json
{
    "body": "Attachment [13242_cutedge.patch](tarball://root/attachments/some-uuid/ticket13242/13242_cutedge.patch) by @jdemeyer created at 2012-08-01 12:16:52\n\nFixed myself (and put both patches together).",
    "created_at": "2012-08-01T12:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158791",
    "user": "@jdemeyer"
}
```

Attachment [13242_cutedge.patch](tarball://root/attachments/some-uuid/ticket13242/13242_cutedge.patch) by @jdemeyer created at 2012-08-01 12:16:52

Fixed myself (and put both patches together).



---

archive/issue_comments_158792.json:
```json
{
    "body": "Sorry, had been away from a computer for a few days.  Thank you for fixing this!",
    "created_at": "2012-08-01T16:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158792",
    "user": "lkeough"
}
```

Sorry, had been away from a computer for a few days.  Thank you for fixing this!



---

archive/issue_comments_158793.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-08-12T19:01:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13070",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13070#issuecomment-158793",
    "user": "@jdemeyer"
}
```

Resolution: fixed
