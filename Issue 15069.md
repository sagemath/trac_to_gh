# Issue 15069: partial_fraction v.s. partial_fraction_decomposition

Issue created by migration from Trac.

Original creator: pong

Original creation time: 2013-10-19 14:52:12

CC:  robertwb dkrenn rws

The method partial_fraction_decomposition() does not work correctly. 

Compare this 

```
sage: p = 2*x; q = x^2 + 6*x +9; r = p/q 
sage: r.partial_fraction() 
Out[2]: 2/(x + 3) - 6/(x + 3)^2 
```


with

```
sage: R.<x> = PolynomialRing(QQ)
sage: p = 2*x; q = x^2 + 6*x +9; r = p/q
sage: r.partial_fraction_decomposition()
Out[5]: (0, [2*x/(x^2 + 6*x + 9)])
```






---

Comment by rws created at 2014-01-23 09:47:46

Can you please elaborate on what output is expected? The output is correct in ZZ, and I don't see it different in QQ.


---

Comment by rws created at 2014-01-23 09:47:46

Changing status from new to needs_info.


---

Comment by pong created at 2014-01-23 14:41:35

Hum... I don't understand, shouldn't the output of r.partial_fraction() and r.partial_fraction_decomposition() be "equivalent"?
They are not in the example that I gave. For the rational function 2x/(x<sup>2</sup> +6*x +9), the method partial_fraction() gives the correct answer while partial_fraction_decomposition() does not.


---

Comment by mmezzarobba created at 2014-01-27 15:28:40

It looks like `partial_fraction_decomposition` does not even attempt to return numerators of degree smaller than that of the irreducible polynomial in the denominator. The reason for that (I guess) is that `partial_fraction_decomposition` is defined for all elements of parents belonging to `QuotientFields()`, "the category of quotient fields over an integral domain".

But while trying to fix the issue I realized that I am a bit confused:
* Is partial fraction decomposition really defined over the field of fractions of any integral domain R? (I agree that it is when R is a PID, but what about other cases?)
* In any case, isn't its _computation_ going to require a Euclidean domain?
* But in the Euclidean case, the stronger partial fraction decomposition pong asks for is always defined, isn't it?
* What is the correct way to define methods that apply to all elements of the field of fractions of a _Euclidean_ domain? Conversely, should there be a category of quotient fields over an integral (as opposed to Euclidean) domain in Sage at all?...


---

Comment by rws created at 2014-01-27 18:15:37

Please ignore my previous comment.


---

Comment by git created at 2014-01-28 08:24:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by robertwb created at 2014-01-28 08:25:10

Changing status from needs_info to needs_review.


---

Comment by robertwb created at 2014-01-28 08:25:10

I've updated the implementation of partial_fraction_decomposition to do the full decomposition into prime powers. I also uncovered and fixed a bug in the case of non-unqiue remainders satisfying the Euclidean function inequality (e.g. ZZ).


---

Comment by git created at 2014-01-30 07:47:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2014-02-14 21:31:09

New commits:


---

Comment by mmezzarobba created at 2014-02-15 09:58:57

Replying to [comment:11 robertwb]:
> I've updated the implementation of partial_fraction_decomposition to do the full decomposition into prime powers. I also uncovered and fixed a bug in the case of non-unqiue remainders satisfying the Euclidean function inequality (e.g. ZZ).

Positive review to your changes. (They do not answer my metaphysical questions, but they do fix the bug.) I prepared a small reviewer patch, though: can you have a quick look? Thanks.


---

Comment by robertwb created at 2014-03-06 20:01:54

Your patch looks fine.


---

Comment by robertwb created at 2014-03-06 20:01:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-13 02:38:44

Resolution: fixed
