# Issue 11036: Remove numpy warnings in slope field

archive/issues_011036.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @jasongrout @novoselt\n\nHaving no arrows in an arrow plot (i.e., vector field that is a slope field) now causes warnings from matplotlib.\n\n```\ny = var('y') \ng = 1 \nP=plot_slope_field(g,(x,3,4),(y,-1,1)) \nP \n<two sets of warnings> \n```\n\nDSM has a diagnosis at [this sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/49471ab062fcb8e9)\n\n```\nP=plot_slope_field(g,(x,3,4),(y,-1,1),headlength=1e-8) \nworks for me.  FYI, it's the following few lines in Quiver._h_arrows at fault: \n        minsh = self.minshaft * self.headlength \n        [....] \n        shrink = length/minsh \n        X0 = shrink * X0[np.newaxis,:] \n        Y0 = shrink * Y0[np.newaxis,:] \nProbably we should change the defaults and/or (if it's not done \nalready) ask our matplotlib friends to special-case 0 for no \narrowheads.\n```\n\nSo maybe this should be reported upstream?  See also #2922, which is also about the mpl quivers.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11208\n\n",
    "created_at": "2011-04-17T00:22:26Z",
    "labels": [
        "graphics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Remove numpy warnings in slope field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11036",
    "user": "@kcrisman"
}
```
Assignee: jason, was

CC:  @jasongrout @novoselt

Having no arrows in an arrow plot (i.e., vector field that is a slope field) now causes warnings from matplotlib.

```
y = var('y') 
g = 1 
P=plot_slope_field(g,(x,3,4),(y,-1,1)) 
P 
<two sets of warnings> 
```

DSM has a diagnosis at [this sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/49471ab062fcb8e9)

```
P=plot_slope_field(g,(x,3,4),(y,-1,1),headlength=1e-8) 
works for me.  FYI, it's the following few lines in Quiver._h_arrows at fault: 
        minsh = self.minshaft * self.headlength 
        [....] 
        shrink = length/minsh 
        X0 = shrink * X0[np.newaxis,:] 
        Y0 = shrink * Y0[np.newaxis,:] 
Probably we should change the defaults and/or (if it's not done 
already) ask our matplotlib friends to special-case 0 for no 
arrowheads.
```

So maybe this should be reported upstream?  See also #2922, which is also about the mpl quivers.

Issue created by migration from https://trac.sagemath.org/ticket/11208





---

archive/issue_comments_120246.json:
```json
{
    "body": "This should be reported upstream, right?",
    "created_at": "2011-04-17T00:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120246",
    "user": "@jasongrout"
}
```

This should be reported upstream, right?



---

archive/issue_comments_120247.json:
```json
{
    "body": "Probably, and I say so on sage-support, but I don't know how to make this pure matplotlib, and maybe they would say it's user error?  But you are almost certainly right.",
    "created_at": "2011-04-17T00:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120247",
    "user": "@kcrisman"
}
```

Probably, and I say so on sage-support, but I don't know how to make this pure matplotlib, and maybe they would say it's user error?  But you are almost certainly right.



---

archive/issue_comments_120248.json:
```json
{
    "body": "I don't think this was ever reported upstream.  And now it's going to cause a problem for our PREP calculus tutorial... grumble, grumble.",
    "created_at": "2011-05-24T02:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120248",
    "user": "@kcrisman"
}
```

I don't think this was ever reported upstream.  And now it's going to cause a problem for our PREP calculus tutorial... grumble, grumble.



---

archive/issue_comments_120249.json:
```json
{
    "body": "For the moment it seems OK to use Doug McNeil's hack of setting: headlength=1e-8\nIts better than leaving this problem around any longer in my opinion.",
    "created_at": "2011-09-08T18:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120249",
    "user": "mhampton"
}
```

For the moment it seems OK to use Doug McNeil's hack of setting: headlength=1e-8
Its better than leaving this problem around any longer in my opinion.



---

archive/issue_comments_120250.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-02-27T22:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120250",
    "user": "dsm"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120251.json:
```json
{
    "body": "Patch attached.  Wasn't sure of the idiom for doctesting the warnings; went with what I would have done in a non-Sage project.",
    "created_at": "2012-02-27T22:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120251",
    "user": "dsm"
}
```

Patch attached.  Wasn't sure of the idiom for doctesting the warnings; went with what I would have done in a non-Sage project.



---

archive/issue_comments_120252.json:
```json
{
    "body": "headlength = epsilon hack",
    "created_at": "2012-02-27T22:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120252",
    "user": "dsm"
}
```

headlength = epsilon hack



---

archive/issue_comments_120253.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-11T15:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120253",
    "user": "@loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120254.json:
```json
{
    "body": "Attachment [trac_11208_avoid_headless_quiver_warning.patch](tarball://root/attachments/some-uuid/ticket11208/trac_11208_avoid_headless_quiver_warning.patch) by @loefflerd created at 2012-03-11 15:45:21\n\nThis doesn't apply to the current Sage dev version -- it seems to conflict with #10489. Can you rebase it?",
    "created_at": "2012-03-11T15:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120254",
    "user": "@loefflerd"
}
```

Attachment [trac_11208_avoid_headless_quiver_warning.patch](tarball://root/attachments/some-uuid/ticket11208/trac_11208_avoid_headless_quiver_warning.patch) by @loefflerd created at 2012-03-11 15:45:21

This doesn't apply to the current Sage dev version -- it seems to conflict with #10489. Can you rebase it?



---

archive/issue_comments_120255.json:
```json
{
    "body": "On the plus side, it works!  DSM, just be sure to *not* replace the previous patch so that we can compare the two, but the rebase should be nearly trivial (I almost did it just now, but decided you were probably in the midst).  The only thing I could possibly say is that I would put the \"(trac #11208)::\" on the next line, but it's not really that important.\n\nSo positive review, modulo rebase.",
    "created_at": "2012-03-12T01:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120255",
    "user": "@kcrisman"
}
```

On the plus side, it works!  DSM, just be sure to *not* replace the previous patch so that we can compare the two, but the rebase should be nearly trivial (I almost did it just now, but decided you were probably in the midst).  The only thing I could possibly say is that I would put the "(trac #11208)::" on the next line, but it's not really that important.

So positive review, modulo rebase.



---

archive/issue_comments_120256.json:
```json
{
    "body": "headlength = epsilon hack, rebased to 5.0.beta7",
    "created_at": "2012-03-12T02:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120256",
    "user": "dsm"
}
```

headlength = epsilon hack, rebased to 5.0.beta7



---

archive/issue_comments_120257.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-12T02:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120257",
    "user": "dsm"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120258.json:
```json
{
    "body": "Attachment [trac_11208_avoid_headless_quiver_warning_v2.patch](tarball://root/attachments/some-uuid/ticket11208/trac_11208_avoid_headless_quiver_warning_v2.patch) by dsm created at 2012-03-12 02:21:05\n\nDropped a message on matplotlib-devel; at least one dev thought special-casing zero was a good idea, so I'll work up a matplotlib patch if I get some time.  Not much pressure to do it on our end now, though.  [PS `@`kcrisman -- not only was I in the midst, I was typing things like 'hg export tip' as you were writing that..]",
    "created_at": "2012-03-12T02:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120258",
    "user": "dsm"
}
```

Attachment [trac_11208_avoid_headless_quiver_warning_v2.patch](tarball://root/attachments/some-uuid/ticket11208/trac_11208_avoid_headless_quiver_warning_v2.patch) by dsm created at 2012-03-12 02:21:05

Dropped a message on matplotlib-devel; at least one dev thought special-casing zero was a good idea, so I'll work up a matplotlib patch if I get some time.  Not much pressure to do it on our end now, though.  [PS `@`kcrisman -- not only was I in the midst, I was typing things like 'hg export tip' as you were writing that..]



---

archive/issue_comments_120259.json:
```json
{
    "body": "Changing priority from minor to major.",
    "created_at": "2012-03-12T02:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120259",
    "user": "@kcrisman"
}
```

Changing priority from minor to major.



---

archive/issue_comments_120260.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-12T02:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120260",
    "user": "@kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_120261.json:
```json
{
    "body": "Great, make sure to post a link to the discussion on matplotlib-devel.  This applies to beta7 and fixes something we REALLY should have fixed a long time ago.\n\nBy the way, it turns out we now have this nice `:trac:` thing for documentation... not needed here, but just fyi for next time, I just found out about five minutes ago.",
    "created_at": "2012-03-12T02:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120261",
    "user": "@kcrisman"
}
```

Great, make sure to post a link to the discussion on matplotlib-devel.  This applies to beta7 and fixes something we REALLY should have fixed a long time ago.

By the way, it turns out we now have this nice `:trac:` thing for documentation... not needed here, but just fyi for next time, I just found out about five minutes ago.



---

archive/issue_comments_120262.json:
```json
{
    "body": "Apply trac_11208_avoid_headless_quiver_warning_v2.patch\n\n(for patchbot)",
    "created_at": "2012-03-12T07:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120262",
    "user": "@loefflerd"
}
```

Apply trac_11208_avoid_headless_quiver_warning_v2.patch

(for patchbot)



---

archive/issue_comments_120263.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-03-21T22:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120263",
    "user": "@jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_120264.json:
```json
{
    "body": "Upstream report is [here](http://sourceforge.net/mailarchive/forum.php?thread_name=4F5D4707.3010209%40hawaii.edu&forum_name=matplotlib-devel).",
    "created_at": "2012-03-22T02:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11036#issuecomment-120264",
    "user": "@kcrisman"
}
```

Upstream report is [here](http://sourceforge.net/mailarchive/forum.php?thread_name=4F5D4707.3010209%40hawaii.edu&forum_name=matplotlib-devel).
