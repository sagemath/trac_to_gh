# Issue 33678: inseparable elliptic-curve isogenies

Issue created by migration from https://trac.sagemath.org/ticket/33915

Original creator: lorenz

Original creation time: 2022-05-27 17:14:07

CC:  defeo cremona wuthrich tscrim vdelecroix chapoton klee

We implement an `EllipticCurveHom` child class `EllipticCurveHom_frobenius` encapsulating purely inseparable _Frobenius isogenies_. As every isogeny decomposes into a separable and a purely inseparable part, we can (together with `EllipticCurveHom_composite`) now express any isogeny between two elliptic curves in Sage.

One immediate application (also implemented in the patch) is that separable isogenies of degree divisible by the characteristic now have a working `.dual()` method. Other than that, changes to the existing codebase are kept minimal.

This is one of the items on the "isogeny wish-list" #7368. It is also an important step towards implementing endomorphism rings later; cf. comment:3:ticket:32826.

Diff without the dependency: https://git.sagemath.org/sage.git/diff?id2=838429ee7773ce30f866ac1c77a94395228cbc34&id=0c22e35054f7c1bfbf1a9a4460ca4633d4ca12d2


---

Comment by git created at 2022-05-27 17:18:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-05-27 17:21:32

Changing status from new to needs_review.


---

Comment by git created at 2022-05-31 14:31:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-06-24 06:07:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-07-26 14:12:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-08-17 22:29:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-25 10:24:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-10-17 16:00:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-10-17 21:28:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-11-08 14:52:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-11-30 08:07:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-12-21 08:32:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-12-22 05:57:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-12-22 06:05:39

Similar remarks as comment:24:ticket:32826 apply here. Hoping someone can spare a few minutes for a review.


---

Comment by cremona created at 2022-12-22 09:20:57

Replying to [comment:20 Lorenz Panny]:
> Similar remarks as comment:24:ticket:32826 apply here. Hoping someone can spare a few minutes for a review.
I'm on it


---

Comment by cremona created at 2022-12-22 10:24:17

(I have been looking at the diffs excluding the dependency now that #32826 has positive review :))

   1. In `find_post_isomorphism()` the 'else' on the line after the break looks wrong, is this a syntax error?  Apologies if my python is inadequate.

   2. (apologies) As in #32826 `scaling_factor()` returns an integer (0 or 1 here), and should more properly be coerced into the base field.

   3. Good to have the method `frobenius_isogeny()` added to the generic elliptic curve class.  Should we also have a mthod `frobenius_endomorphism()` or just `frobenius()` as a special case too?  Either for generic elliptic curves (with an error if the base field is not finite), or only when the base field is finite?


---

Comment by git created at 2022-12-22 10:56:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-12-22 11:08:26

Replying to [comment:22 John Cremona]:
>    1. In `find_post_isomorphism()` the 'else' on the line after the break looks wrong, is this a syntax error?  Apologies if my python is inadequate.

This is indeed a less well-known Pythonism: `else` after `for` means "if we did not `break` out of the loop". It can often be used in situations where you'd have to use a flag boolean ("`found`", "`done`") in other languages.

>    3. Good to have the method `frobenius_isogeny()` added to the generic elliptic curve class.  Should we also have a mthod `frobenius_endomorphism()` or just `frobenius()` as a special case too?  Either for generic elliptic curves (with an error if the base field is not finite), or only when the base field is finite?

Done, for curves over finite fields. Good idea! (`.frobenius()` already exists, by the way, and returns a quadratic integer.)


---

Comment by cremona created at 2022-12-22 11:21:28

Thanks for explaining that Pythonism to me!  Ah, the hidden benefits of reviewing trac tickets...   I'm sure my own python code is littered with things I don't need, as is my C++ code.

Just looking over the latest changes...


---

Comment by cremona created at 2022-12-22 11:27:27

All good!

I think it was me (years ago) who wrote the existing `frobenius()` method.  We'll have to work out at some point exactly when an endomorphism is an actual map from the curve to itself, and when it is an element of the abstract endomorphism ring.  But that's for another day.


---

Comment by cremona created at 2022-12-22 11:27:27

Changing status from needs_review to positive_review.


---

Comment by lorenz created at 2022-12-22 12:00:39

Great, thanks so much for your time!
