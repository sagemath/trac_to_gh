# Issue 22214: developer guide: Explain merging in new SageMath version without triggering many recompilations

Issue created by migration from https://trac.sagemath.org/ticket/22451

Original creator: dkrenn

Original creation time: 2017-02-26 16:10:34

Write a section in Advanced Git of the developer guide


---

Comment by dkrenn created at 2017-02-26 16:11:35

Changing status from new to needs_review.


---

Comment by dkrenn created at 2017-02-26 16:11:35

New commits:


---

Comment by defeo created at 2017-02-26 19:30:09

> Being on some new [SageMath](SageMath) (e.g. on branch `develop`) which runs
> successfully, it would be possible to merge in our branch
> `some/code` into develop. This would produce the same source files
> and avoid unnecessary recompilations. However, it destroys git's
> history. Thus, for example, it is hard to keep track of changes etc.,
> as one cannot simply persue the first parent of each git commit.

Isn't *"destroys"* a bit of an overstatement?


---

Comment by paulmasson created at 2017-02-27 00:54:00

> We first create a new working tree in a directory ``merge`` and switch to this directory::
I find it a bit confusing to have a directory with the same name as a command. How about using `new_copy` for the directory name instead of `merge`?

Also, having a branch name with slashes looks to me like a subfolder in the branch. How about calling it `some_code` instead of `some/code`?


---

Comment by novoselt created at 2017-02-27 15:36:29

This is quite convoluted for a non-initiate... Would be nice to have some 

```
 git trac upgrade_to_latest old_branch
```

command or similar.


---

Comment by git created at 2017-03-05 07:09:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2017-03-05 07:10:27

Replying to [comment:3 defeo]:
> > Being on some new [SageMath](SageMath) (e.g. on branch `develop`) which runs
> > successfully, it would be possible to merge in our branch
> > `some/code` into develop. This would produce the same source files
> > and avoid unnecessary recompilations. However, it destroys git's
> > history. Thus, for example, it is hard to keep track of changes etc.,
> > as one cannot simply persue the first parent of each git commit.
> 
> Isn't *"destroys"* a bit of an overstatement?

Fair enough; rewritten.


---

Comment by dkrenn created at 2017-03-05 07:11:56

Replying to [comment:4 paulmasson]:
> > We first create a new working tree in a directory ``merge`` and switch to this directory::
> I find it a bit confusing to have a directory with the same name as a command. How about using `new_copy` for the directory name instead of `merge`?

Changed, but to "new_worktree", as I find "new_copy" ambiguous. 

> Also, having a branch name with slashes looks to me like a subfolder in the branch. How about calling it `some_code` instead of `some/code`?

Changed.


---

Comment by dkrenn created at 2017-03-05 07:19:53

Replying to [comment:5 novoselt]:
> This is quite convoluted for a non-initiate... Would be nice to have some 
> {{{
>  git trac upgrade_to_latest old_branch
> }}}
> command or similar.

Propose this to
  https://github.com/sagemath/git-trac-command


---

Comment by mkoeppe created at 2017-03-05 09:52:41

The trick with the worktree is quite useful, +1 on including it. But shouldn't it also show instructions on how to get rid of the worktree after this is done?


---

Comment by git created at 2017-03-05 11:07:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-03-05 11:08:46

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dkrenn created at 2017-03-05 11:09:28

Replying to [comment:10 mkoeppe]:
> The trick with the worktree is quite useful, +1 on including it. But shouldn't it also show instructions on how to get rid of the worktree after this is done?

Yes; added instructions for this.


---

Comment by mkoeppe created at 2017-03-05 11:44:24

typo "persue"


---

Comment by git created at 2017-03-07 13:03:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2017-03-07 13:03:38

Replying to [comment:14 mkoeppe]:
> typo "persue"

Corrected. Thanks.


---

Comment by mkoeppe created at 2017-03-07 13:21:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-03-10 23:13:16

Resolution: fixed
