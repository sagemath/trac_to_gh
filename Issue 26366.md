# Issue 26366: Bugfix in bruhat_lower_covers

Issue created by migration from https://trac.sagemath.org/ticket/26603

Original creator: bump

Original creation time: 2018-10-30 15:23:53

CC:  nthiery tscrim sage-combinat

Creating a Weyl group with the option `implementation="permutation"` is much faster, but unfortunately the Kazhdan-Lusztig polynomials are not computed correctly. Debugging this led to the discovery that the side of a descent is implemented inconsistently in the `bruhat_lower_covers` Element method of Coxeter groups. The culprit is the `has_descent` method that has different default sides that occurs in the code for this method.


```
sage: W = WeylGroup("A2",prefix="s")
sage: [s1,s2]=W.simple_reflections()
sage: (s1*s2).has_descent(1)
False
sage: 
sage: W = WeylGroup("A2",prefix="s",implementation="permutation")
sage: [s1,s2]=W.simple_reflections()
sage: (s1*s2).has_descent(1)
True
```


The patch fixes Kazhdan Lusztig polynomials by mandating `side="right"` where needed but doesn't address the underlying inconsistency.


---

Comment by tscrim created at 2018-10-30 15:47:10

See #23299.


---

Comment by bump created at 2018-10-30 19:34:22

New commits:


---

Comment by git created at 2018-10-30 19:38:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bump created at 2018-10-30 19:47:03

Replying to [comment:1 tscrim]:
> See #23299.

So there is already a patch to fix this problem. It would be good if it can get merged.


---

Comment by tscrim created at 2018-10-30 19:53:51

I would not mind merging this portion first. Although we probably should do the same fix for the upper Bruhat covers.


---

Comment by git created at 2018-10-30 22:21:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bump created at 2018-10-30 22:25:57

Changing status from new to needs_review.


---

Comment by git created at 2018-10-30 22:58:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-11-04 12:23:28

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-11-04 12:23:28

This fixes the immediate bug, so let us get this in. Thank you.


---

Comment by vbraun created at 2018-11-07 11:28:07

Resolution: fixed
