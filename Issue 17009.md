# Issue 17009: FreeGroup(0)([]) broken

Issue created by migration from https://trac.sagemath.org/ticket/17246

Original creator: darij

Original creation time: 2014-10-28 20:50:45

CC:  tscrim

Keywords: gap, group, free group, border case

This is a border case, but I'd still prefer it to work:

```
sage: F = FreeGroup(0)
sage: F([])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-47-49d58f580ab1> in <module>()
----> 1 F([])

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9603)()

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4256)()

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4163)()

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/groups/free_group.pyc in _element_constructor_(self, *args, **kwds)
    808             P = x.parent()
    809         except AttributeError:
--> 810             return self.element_class(self, x, **kwds)
    811         if isinstance(P, FreeGroup_class):
    812             names = set(P._names[abs(i)-1] for i in x.Tietze())

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/groups/free_group.pyc in __init__(self, parent, x)
    225                     i=i+1
    226             AbstractWordTietzeWord = libgap.eval('AbstractWordTietzeWord')
--> 227             x = AbstractWordTietzeWord(l, parent._gap_gens())
    228         ElementLibGAP.__init__(self, parent, x)
    229 

/scratch/sage-6.4.beta2/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement_Function.__call__ (build/cythonized/sage/libs/gap/element.c:15598)()

ValueError: libGAP: Error, List Element: <list>[1] must have an assigned value
```



---

Comment by tscrim created at 2014-10-29 14:37:01

I will get a fix in a day or two.


---

Comment by tscrim created at 2014-11-04 19:37:36

I made the input to element construct just return the identity anytime a `bool(x)` is `False` (which includes empty lists and tuples), so it fixes the issue (and possibly slightly faster than before).
----
New commits:


---

Comment by tscrim created at 2014-11-04 19:37:36

Changing status from new to needs_review.


---

Comment by darij created at 2014-11-07 17:58:58

Looks good to *me*, though a shade of doubt remains about whether `not x` doesn't encompass a few cases too many. Can you run this by someone who knows Sage's free groups well?


---

Comment by git created at 2014-11-07 19:56:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-11-07 20:03:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-11-07 20:03:40

It did overextend to include `0` going to the identity. However the input is suppose to be a list or tuple whose entries correspond to (inverse) generators, so I've changed it to explicitly check `x == [] or x == ()`.


---

Comment by darij created at 2014-11-07 20:53:34

Changing status from needs_review to positive_review.


---

Comment by darij created at 2014-11-07 20:53:34

Thanks!


---

Comment by tscrim created at 2014-11-07 22:22:37

NP. Thanks for doing the review.


---

Comment by vbraun created at 2014-11-15 16:17:49

Resolution: fixed
